# Comparing `tmp/Simba-UW-tf-dev-1.90.4.tar.gz` & `tmp/Simba-UW-tf-dev-1.90.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/Simba-UW-tf-dev-1.90.4.tar", last modified: Wed Apr 17 20:00:43 2024, max compression
+gzip compressed data, was "dist/Simba-UW-tf-dev-1.90.5.tar", last modified: Thu Apr 25 17:45:46 2024, max compression
```

## Comparing `Simba-UW-tf-dev-1.90.4.tar` & `Simba-UW-tf-dev-1.90.5.tar`

### file list

```diff
@@ -1,641 +1,651 @@
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/
--rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/PKG-INFO
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/ui/
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.90.4/simba/ui/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/
--rw-r--r--   0 simon      (501) staff       (20)    11467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/mutual_exclusivity_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4070 2024-03-29 20:30:28.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1676 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/csv_2_parquet_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2566 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/quick_path_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2873 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/batch_preprocess_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     8835 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/heatmap_location_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9734 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_probability_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/movement_analysis_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4631 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    11362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    25835 2024-04-17 19:20:44.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/path_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1184 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/remove_roi_features_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6692 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/smoothing_interpolation_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2174 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_size_standardizer_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     6997 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     5068 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_analysis_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     7898 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/outlier_settings_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9048 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/gantt_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_validation_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     8529 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/severity_analysis_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3221 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/fsttc_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4231 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/kleinberg_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     7979 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9785 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/spontaneous_alternation_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6076 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/pose_reorganizer_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3437 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3402 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/append_roi_features_animals_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3468 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_by_timebins_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9154 2024-04-12 00:32:53.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/heatmap_clf_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9235 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/data_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    11785 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_features_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9118 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/pup_retrieval_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     5577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py
--rw-r--r--   0 simon      (501) staff       (20)      584 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/about_simba_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     5451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    10747 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_tracking_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1795 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/append_roi_features_bodypart_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     7312 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6546 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_add_remove_print_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    81527 2024-04-15 18:43:27.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/video_processing_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     7800 2024-04-04 16:47:32.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/validation_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6160 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_by_roi_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     2741 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/make_path_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3622 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     6166 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1072 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/archive_files_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/pose_bp_drop_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    12174 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/distance_plot_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4673 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/subset_feature_extractor_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     3290 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     4134 2024-03-31 17:07:13.000000 Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)    16701 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.90.4/simba/ui/video_info_ui.py
--rw-r--r--   0 simon      (501) staff       (20)     6573 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.4/simba/ui/user_defined_pose_creator.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/ui/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    14374 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.4/simba/ui/create_project_ui.py
--rw-r--r--   0 simon      (501) staff       (20)    14487 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.90.4/simba/ui/tkinter_functions.py
--rw-r--r--   0 simon      (501) staff       (20)    38871 2024-04-16 13:37:42.000000 Simba-UW-tf-dev-1.90.4/simba/ui/machine_model_settings_ui.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/labelling/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/labelling/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    24423 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/labelling/labelling_interface.py
--rw-r--r--   0 simon      (501) staff       (20)     2362 2024-02-21 02:33:04.000000 Simba-UW-tf-dev-1.90.4/simba/labelling/targeted_annotations_clips.py
--rw-r--r--   0 simon      (501) staff       (20)     3974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/labelling/extract_labelled_frames.py
--rw-r--r--   0 simon      (501) staff       (20)    31269 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/labelling/labelling_advanced_interface.py
--rw-r--r--   0 simon      (501) staff       (20)    10012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/labelling/play_annotation_video.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/
--rw-r--r--   0 simon      (501) staff       (20)    15004 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/dbcv_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5077 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_validation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     3645 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/enums.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:33:55.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     9036 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_video_visualizer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/
--rw-r--r--   0 simon      (501) staff       (20)     4642 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/cluster_videos_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     4027 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/transform_cluster_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     5048 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/embedding_correlations_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-02 14:39:26.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     4070 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py
--rw-r--r--   0 simon      (501) staff       (20)    11182 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     2546 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/data_extractor_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     4536 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/cluster_validation_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     9305 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/fit_cluster_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     2574 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/clusterer_comparison_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     6527 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     4332 2024-03-28 20:02:59.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/cluster_xai_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     3820 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/cluster_frequentist_stats_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     2355 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/print_embedding_info_popup.py
--rw-r--r--   0 simon      (501) staff       (20)     9946 2024-04-02 18:34:25.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/dataset_creator.py
--rw-r--r--   0 simon      (501) staff       (20)    12982 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/unsupervised_main.py
--rw-r--r--   0 simon      (501) staff       (20)    10175 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/grid_search_visualizers.py
--rw-r--r--   0 simon      (501) staff       (20)    16005 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/data_extractor.py
--rw-r--r--   0 simon      (501) staff       (20)     5241 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/outlier_detector.py
--rw-r--r--   0 simon      (501) staff       (20)    10397 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_frequentist_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5798 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/embedding_correlation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    18194 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_xai_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    15581 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/umap_embedder.py
--rw-r--r--   0 simon      (501) staff       (20)     5582 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/clusterer_comparison_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     4652 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/bout_aggregator.py
--rw-r--r--   0 simon      (501) staff       (20)     2188 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/data_map.yaml
--rw-r--r--   0 simon      (501) staff       (20)    14765 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/hdbscan_clusterer.py
--rw-r--r--   0 simon      (501) staff       (20)     3862 2024-02-15 21:37:53.000000 Simba-UW-tf-dev-1.90.4/simba/unsupervised/tsne.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     8511 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/agg_boundary_stats.py
--rw-r--r--   0 simon      (501) staff       (20)    27255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/boundary_menus.py
--rw-r--r--   0 simon      (501) staff       (20)    10064 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/boundary_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)     7146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/find_boundaries.py
--rw-r--r--   0 simon      (501) staff       (20)    12066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/visualize_boundaries.py
--rw-r--r--   0 simon      (501) staff       (20)    18436 2024-04-10 01:59:19.000000 Simba-UW-tf-dev-1.90.4/simba/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/
--rw-r--r--   0 simon      (501) staff       (20)    57052 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_14bp.py
--rw-r--r--   0 simon      (501) staff       (20)    28094 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_7bp.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/
--rw-r--r--   0 simon      (501) staff       (20)     1757 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/doctests.py
--rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py
--rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/read_in_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/peaks.py
--rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2022.py
--rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/convex_hull_3_scratch_3.py
--rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/convex_hull_scratch_1.py
--rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py
--rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/egocentrical_aligner.py
--rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/count_values_in_range.py
--rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/graph_creator.py
--rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/termite_rois.csv
--rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/mutual_exclusive.py
--rw-r--r--   0 simon      (501) staff       (20)     2883 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/video_color.py
--rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/graph_3d_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/video_rotator.py
--rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/add_probability_cnt_features.py
--rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/make_splash.py
--rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py
--rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/time_stamp_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/video_rotator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py
--rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/convex_hull_scratch_2.py
--rw-r--r--   0 simon      (501) staff       (20)    36307 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_8bps_2_animals.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-02-21 02:05:27.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     4091 2024-02-16 21:14:07.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/perimeter_jit.py
--rw-r--r--   0 simon      (501) staff       (20)    26471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_subsets.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    10043 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_user_defined.py
--rw-r--r--   0 simon      (501) staff       (20)    61607 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_16bp.py
--rw-r--r--   0 simon      (501) staff       (20)    37328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_9bp.py
--rw-r--r--   0 simon      (501) staff       (20)    31163 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_8bp.py
--rw-r--r--   0 simon      (501) staff       (20)    21427 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_4bp.py
--rw-r--r--   0 simon      (501) staff       (20)    65534 2024-03-01 16:55:51.000000 Simba-UW-tf-dev-1.90.4/simba/feature_extractors/amber_feature_extractor.py
--rw-r--r--   0 simon      (501) staff       (20)     1033 2024-04-11 12:52:35.000000 Simba-UW-tf-dev-1.90.4/simba/requirements.txt
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/
--rw-r--r--   0 simon      (501) staff       (20)    40917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/annotator_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    84153 2024-04-15 18:43:27.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/timeseries_features_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:38:30.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    53232 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/pop_up_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    48428 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/config_reader.py
--rw-r--r--   0 simon      (501) staff       (20)    56305 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/circular_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)    32080 2024-03-14 19:32:58.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/network_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    24046 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/pose_importer_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     3020 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/video_processing_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    35642 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/feature_extraction_supplement_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)   154174 2024-04-16 14:45:49.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/statistics_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    44711 2024-03-14 19:32:58.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/feature_extraction_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    88755 2024-04-17 19:28:51.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/plotting_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)      391 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/abstract_classes.py
--rw-r--r--   0 simon      (501) staff       (20)    56822 2024-04-15 18:43:27.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/image_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)      880 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/unsupervised_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)   132883 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/train_model_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)   166028 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/geometry_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)    24978 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/mixins/feature_extraction_circular_mixin.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/
--rw-r--r--   0 simon      (501) staff       (20)     6639 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/deepethogram_importer.py
--rw-r--r--   0 simon      (501) staff       (20)    12306 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/BORIS_appender.py
--rw-r--r--   0 simon      (501) staff       (20)     9739 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/observer_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     5508 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/boris_source_cleaner.py
--rw-r--r--   0 simon      (501) staff       (20)    18982 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/tools.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    18852 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/third_party_appender.py
--rw-r--r--   0 simon      (501) staff       (20)     9215 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/ethovision_import.py
--rw-r--r--   0 simon      (501) staff       (20)     7456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/BENTO_appender.py
--rw-r--r--   0 simon      (501) staff       (20)     5662 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/solomon_importer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/
--rw-r--r--   0 simon      (501) staff       (20)     8841 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_clf_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)    14451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)    18274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_menues.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_tools.py
--rw-r--r--   0 simon      (501) staff       (20)    19237 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    15278 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_movement_statistics.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/__init__.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/utils/
--rw-r--r--   0 simon      (501) staff       (20)    13211 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.90.4/simba/utils/config_creator.py
--rw-r--r--   0 simon      (501) staff       (20)    26038 2024-03-27 13:42:19.000000 Simba-UW-tf-dev-1.90.4/simba/utils/enums.py
--rw-r--r--   0 simon      (501) staff       (20)    10420 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.4/simba/utils/custom_feature_extractor.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.90.4/simba/utils/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     7737 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/utils/warnings.py
--rw-r--r--   0 simon      (501) staff       (20)    49882 2024-04-15 15:19:23.000000 Simba-UW-tf-dev-1.90.4/simba/utils/checks.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/utils/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    77633 2024-04-15 16:29:01.000000 Simba-UW-tf-dev-1.90.4/simba/utils/read_write.py
--rw-r--r--   0 simon      (501) staff       (20)    15355 2024-04-16 18:54:43.000000 Simba-UW-tf-dev-1.90.4/simba/utils/lookups.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/utils/cli/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/utils/cli/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     7129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/utils/cli/cli_tools.py
--rw-r--r--   0 simon      (501) staff       (20)    17086 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/utils/errors.py
--rw-r--r--   0 simon      (501) staff       (20)    44962 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/utils/data.py
--rw-r--r--   0 simon      (501) staff       (20)      717 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.4/simba/utils/keyboard_listener.py
--rw-r--r--   0 simon      (501) staff       (20)     4205 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/utils/printing.py
--rw-r--r--   0 simon      (501) staff       (20)   243998 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/SimBA_logo.ico
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_processors/
--rw-r--r--   0 simon      (501) staff       (20)     8626 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_processors/reorganize_keypoint.py
--rw-r--r--   0 simon      (501) staff       (20)     5840 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_processors/remove_keypoints.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_processors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     2872 2024-02-15 23:39:58.000000 Simba-UW-tf-dev-1.90.4/simba/pose_processors/pose_reset.py
--rw-r--r--   0 simon      (501) staff       (20)     6313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_processors/reverse_pose.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/
--rw-r--r--   0 simon      (501) staff       (20)      786 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/doctests.py
--rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_3.py
--rw-r--r--   0 simon      (501) staff       (20)     2387 2024-03-08 14:35:02.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/dprime.py
--rw-r--r--   0 simon      (501) staff       (20)     2516 2024-03-18 17:01:43.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/linear_fretchet.py
--rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/read_in_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     2391 2024-03-14 12:45:59.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324 3.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     2036 2024-03-28 18:29:59.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/dunn_index.py
--rw-r--r--   0 simon      (501) staff       (20)     3640 2024-04-08 13:30:56.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/hausdorff.py
--rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/peaks.py
--rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2022.py
--rw-r--r--   0 simon      (501) staff       (20)     3494 2024-04-03 13:42:02.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/colinear_features.py
--rw-r--r--   0 simon      (501) staff       (20)     8921 2024-03-22 13:56:46.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/spontaneous_alternation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    21658 2024-04-10 16:31:38.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/horizontal_videos_concat.py
--rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/convex_hull_3_scratch_3.py
--rw-r--r--   0 simon      (501) staff       (20)     1103 2024-03-29 16:26:34.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/silhouette_score.py
--rw-r--r--   0 simon      (501) staff       (20)     3607 2024-04-09 14:21:58.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/two_fish_feature_extractor_040924.py.zip
--rw-r--r--   0 simon      (501) staff       (20)    33092 2024-02-22 15:57:45.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/cuda_jit.ipynb
--rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/convex_hull_scratch_1.py
--rw-r--r--   0 simon      (501) staff       (20)     1867 2024-03-12 19:23:40.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/directed_hausdorff.py
--rw-r--r--   0 simon      (501) staff       (20)      963 2024-03-13 18:20:52.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/shannon_diversity_index.py
--rw-r--r--   0 simon      (501) staff       (20)     3726 2024-03-12 13:31:58.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/sequential_lag_analysis.py
--rw-r--r--   0 simon      (501) staff       (20)     1254 2024-03-13 16:09:50.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/wilcoxon.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-09 15:37:24.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     3328 2024-03-08 15:05:36.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/data.npy
--rw-r--r--   0 simon      (501) staff       (20)    12626 2024-03-25 20:59:27.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/distances.py
--rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_2.py
--rw-r--r--   0 simon      (501) staff       (20)     2699 2024-03-10 16:29:57.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/cohens_kappa.py
--rw-r--r--   0 simon      (501) staff       (20)     2465 2024-03-08 17:38:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/paths.py
--rw-r--r--   0 simon      (501) staff       (20)     1048 2024-03-13 14:41:23.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/outliers_tietjen.py
--rw-r--r--   0 simon      (501) staff       (20)     1424 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/train_model.py
--rw-r--r--   0 simon      (501) staff       (20)     3171 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/amber_tests.py
--rw-r--r--   0 simon      (501) staff       (20)     3590 2024-03-11 17:05:31.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/line_locate_point.py
--rw-r--r--   0 simon      (501) staff       (20)     3182 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/multifrm_to_points.py
--rw-r--r--   0 simon      (501) staff       (20)       69 2024-03-18 18:17:24.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/lcs.py
--rw-r--r--   0 simon      (501) staff       (20)    12448 2024-04-09 14:14:37.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/two_fish_feature_extractor_040924.py
--rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/egocentrical_aligner.py
--rw-r--r--   0 simon      (501) staff       (20)     2350 2024-03-12 17:58:33.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/add_body_part.py
--rw-r--r--   0 simon      (501) staff       (20)     1008 2024-03-12 13:29:20.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/grubbs_test.py
--rw-r--r--   0 simon      (501) staff       (20)     3399 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/slide_circ_mean.py
--rw-r--r--   0 simon      (501) staff       (20)     1835 2024-03-28 22:56:59.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/calinski_harabasz.py
--rw-r--r--   0 simon      (501) staff       (20)     1282 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_feature_visualizer_example.py
--rw-r--r--   0 simon      (501) staff       (20)    10076 2024-03-22 16:51:40.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/spontaneuous_alternation_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)      895 2024-03-12 14:09:55.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/runs_test.py
--rw-r--r--   0 simon      (501) staff       (20)     2516 2024-04-06 11:33:24.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/pct_counts_in_top_N.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:46:33.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     2287 2024-03-25 16:45:04.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/total_variation_distance.py
--rw-r--r--   0 simon      (501) staff       (20)     3056 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/crop_single_polygon.py
--rw-r--r--   0 simon      (501) staff       (20)     8010 2024-03-24 19:48:22.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/joint_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    11145 2024-04-15 15:02:56.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/clip_multiple_videos_by_frame_numbers.py
--rw-r--r--   0 simon      (501) staff       (20)     2552 2024-04-02 14:48:59.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/elliptic_envelope.py
--rw-r--r--   0 simon      (501) staff       (20)     1016 2024-03-14 14:57:29.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_definition_csvs_to_h5.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     1276 2024-03-12 17:58:38.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/add_body_part.py.zip
--rw-r--r--   0 simon      (501) staff       (20)      921 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_feature_visualizer_example.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     2631 2024-04-05 16:23:07.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/sliding_crosscorrelation.py
--rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/count_values_in_range.py
--rw-r--r--   0 simon      (501) staff       (20)     2174 2024-03-14 14:56:26.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_definition_csvs_to_h5.py
--rw-r--r--   0 simon      (501) staff       (20)     1656 2024-03-30 18:32:44.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/distance_velocity.py
--rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/graph_creator.py
--rw-r--r--   0 simon      (501) staff       (20)     5666 2024-04-11 15:28:58.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/line_plot_plotly.py
--rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/termite_rois.csv
--rw-r--r--   0 simon      (501) staff       (20)     1351 2024-03-26 21:10:40.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/unsupervised_lof.py
--rw-r--r--   0 simon      (501) staff       (20)     2553 2024-03-11 15:09:38.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/siegel_tukey.py
--rw-r--r--   0 simon      (501) staff       (20)      958 2024-03-13 18:05:08.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/berger_parker.py
--rw-r--r--   0 simon      (501) staff       (20)     4177 2024-04-10 01:56:43.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/isolation_forest.py
--rw-r--r--   0 simon      (501) staff       (20)     2845 2024-03-28 19:23:54.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/davis_bouldin.py
--rw-r--r--   0 simon      (501) staff       (20)     4094 2024-04-10 14:09:54.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/vertical_video_concatenator.py
--rw-r--r--   0 simon      (501) staff       (20)     2770 2024-04-07 19:14:13.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/batch_video_to_greyscale.py
--rw-r--r--   0 simon      (501) staff       (20)     7215 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/crop_circles_pop_up.py
--rw-r--r--   0 simon      (501) staff       (20)     1410 2024-03-19 12:49:24.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/heading.py
--rw-r--r--   0 simon      (501) staff       (20)     2243 2024-03-13 18:35:02.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324 2.py.zip
--rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/mutual_exclusive.py
--rw-r--r--   0 simon      (501) staff       (20)     2907 2024-03-14 19:31:25.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/grangercausalitytests.py
--rw-r--r--   0 simon      (501) staff       (20)     2432 2024-03-19 20:48:43.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/multiframe_is_shape_covered.py
--rw-r--r--   0 simon      (501) staff       (20)      592 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/redis.py
--rw-r--r--   0 simon      (501) staff       (20)     2893 2024-02-26 20:49:33.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/video_color.py
--rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/graph_3d_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)     6186 2024-03-18 12:44:45.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/video_rotator.py
--rw-r--r--   0 simon      (501) staff       (20)     1004 2024-03-12 13:11:45.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/hartley_fmax.py
--rw-r--r--   0 simon      (501) staff       (20)       84 2024-04-03 17:05:23.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/calc_N_degree_direction_switches.py
--rw-r--r--   0 simon      (501) staff       (20)     2307 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/fix_clahe.py
--rw-r--r--   0 simon      (501) staff       (20)     1836 2024-03-10 15:38:46.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/cochran_q.py
--rw-r--r--   0 simon      (501) staff       (20)      682 2024-03-13 19:19:43.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/menhinicks_index.py
--rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/add_probability_cnt_features.py
--rw-r--r--   0 simon      (501) staff       (20)    13575 2024-03-20 11:47:11.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/spontanous_alternations.py
--rw-r--r--   0 simon      (501) staff       (20)     2268 2024-03-13 13:59:07.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     4655 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/velocity_aggregator.py
--rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/make_splash.py
--rw-r--r--   0 simon      (501) staff       (20)     4478 2024-04-08 20:43:42.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/abod.py
--rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_5.py
--rw-r--r--   0 simon      (501) staff       (20)     1073 2024-03-13 16:46:16.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/simpson_diversity_index.py
--rw-r--r--   0 simon      (501) staff       (20)     4485 2024-04-14 19:07:54.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/clip_videos_by_frm.py
--rw-r--r--   0 simon      (501) staff       (20)     2396 2024-03-17 16:55:38.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324 4.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     5336 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/geometry_ex.py
--rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/time_stamp_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     1505 2024-03-28 14:36:24.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/line_plot.py
--rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/video_rotator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    15996 2024-04-09 13:41:30.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/unsupervised_outliers.py
--rw-r--r--   0 simon      (501) staff       (20)     5690 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/statistics_ex.py
--rw-r--r--   0 simon      (501) staff       (20)     1391 2024-03-18 23:21:46.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/sliding_displacement.py
--rw-r--r--   0 simon      (501) staff       (20)      925 2024-03-11 13:06:04.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/wald_wolfowitz.py
--rw-r--r--   0 simon      (501) staff       (20)     1814 2024-04-05 14:36:58.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/sliding_autoc.py
--rw-r--r--   0 simon      (501) staff       (20)     2369 2024-03-14 17:07:10.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/linestring_path.py
--rw-r--r--   0 simon      (501) staff       (20)     2233 2024-03-18 15:20:48.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/cronbach_alpha.py
--rw-r--r--   0 simon      (501) staff       (20)     2809 2024-03-08 21:15:58.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/mcnamar.py
--rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_4.py
--rw-r--r--   0 simon      (501) staff       (20)     6220 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/AmberFeatureExtractor.py.zip
--rw-r--r--   0 simon      (501) staff       (20)     1933 2024-04-10 15:09:25.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/mosaic.py
--rw-r--r--   0 simon      (501) staff       (20)      441 2024-04-12 17:03:24.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/bouts_df
--rw-r--r--   0 simon      (501) staff       (20)    69423 2024-02-20 14:30:23.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/amber_featurizer.py
--rw-r--r--   0 simon      (501) staff       (20)     6286 2024-04-17 19:28:51.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/make_path_plot.py
--rw-r--r--   0 simon      (501) staff       (20)      837 2024-03-13 18:56:21.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/margalef_diversification_index.py
--rw-r--r--   0 simon      (501) staff       (20)      997 2024-03-17 17:49:00.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/biweight_midcorrelation.py
--rw-r--r--   0 simon      (501) staff       (20)     2186 2024-03-18 15:31:23.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/madmedianrule.py
--rw-r--r--   0 simon      (501) staff       (20)     2915 2024-04-01 14:12:59.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/adjusted_rand_score.py
--rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/convex_hull_scratch_2.py
--rw-r--r--   0 simon      (501) staff       (20)     1957 2024-04-12 14:55:03.000000 Simba-UW-tf-dev-1.90.4/simba/sandbox/plotly_gantt.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/
--rw-r--r--   0 simon      (501) staff       (20)     8538 2024-02-23 18:25:51.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/directing_animals_to_bodypart_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    10127 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/gantt_creator.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/tools/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:43:56.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     5946 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/tools/tkinter_tools.py
--rw-r--r--   0 simon      (501) staff       (20)    17927 2024-04-04 16:23:22.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/ROI_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    19270 2024-03-31 17:21:01.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/shap_agg_stats_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    11843 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/gantt_creator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    15819 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_clf_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    10376 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/probability_plot_creator.py
--rw-r--r--   0 simon      (501) staff       (20)     8467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/circular_plotting.py
--rw-r--r--   0 simon      (501) staff       (20)    16868 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/plot_clf_results.py
--rw-r--r--   0 simon      (501) staff       (20)    17433 2024-04-15 16:29:01.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/plot_clf_results_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    22893 2024-02-21 04:33:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/ROI_feature_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    13622 2024-02-21 04:25:14.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_location.py
--rw-r--r--   0 simon      (501) staff       (20)    12949 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/probability_plot_creator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     5253 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/interactive_probability_grapher.py
--rw-r--r--   0 simon      (501) staff       (20)     6517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/plot_pose_in_dir.py
--rw-r--r--   0 simon      (501) staff       (20)    20950 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/single_run_model_validation_video.py
--rw-r--r--   0 simon      (501) staff       (20)     8732 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/frame_mergerer_ffmpeg.py
--rw-r--r--   0 simon      (501) staff       (20)    10667 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/pose_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)     9368 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/directing_animals_visualizer_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    14389 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/clf_validator.py
--rw-r--r--   0 simon      (501) staff       (20)    22069 2024-04-17 19:37:05.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/path_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    14075 2024-02-24 20:34:51.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/ROI_feature_visualizer_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    11824 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/data_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    13091 2024-03-26 23:49:10.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/spontaneous_alternation_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    19312 2024-04-17 19:37:05.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/path_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)     9311 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/ez_lineplot.py
--rw-r--r--   0 simon      (501) staff       (20)    16812 2024-04-16 15:02:05.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/distance_plotter_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    22994 2024-02-21 04:08:15.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/ROI_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    10034 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/geometry_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    16661 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/clf_validator_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    14224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_clf.py
--rw-r--r--   0 simon      (501) staff       (20)    11994 2024-04-11 22:38:54.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/distance_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    19073 2024-04-11 20:26:33.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/single_run_model_validation_video_mp.py
--rw-r--r--   0 simon      (501) staff       (20)    12286 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/directing_animals_visualizer.py
--rw-r--r--   0 simon      (501) staff       (20)    11453 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/circular_feature_overlay_plotter.py
--rw-r--r--   0 simon      (501) staff       (20)    14576 2024-02-21 04:11:21.000000 Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_location_mp.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/dash_app/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:15.000000 Simba-UW-tf-dev-1.90.4/simba/dash_app/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    72715 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/dash_app/SimBA_dash_app.py
--rw-r--r--   0 simon      (501) staff       (20)     4965 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/dash_app/run_dash_tkinter.py
--rw-r--r--   0 simon      (501) staff       (20)    47546 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/dash_app/dash_app.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/
--rw-r--r--   0 simon      (501) staff       (20)    14926 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/spontaneous_alternation_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    11813 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/agg_clf_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    13224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/severity_bout_based_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    39110 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/interpolation_smoothing.py
--rw-r--r--   0 simon      (501) staff       (20)    10968 2024-02-21 19:10:40.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/directing_animal_to_bodypart.py
--rw-r--r--   0 simon      (501) staff       (20)     9580 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/timebins_clf_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    20288 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/fsttc_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     4793 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/boolean_conditional_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     7117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/interpolate_pose.py
--rw-r--r--   0 simon      (501) staff       (20)    16335 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/directing_other_animals_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     8957 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/gibbs_sampler.py
--rw-r--r--   0 simon      (501) staff       (20)    10054 2024-04-04 16:23:22.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/timebins_movement_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     5255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/severity_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    18517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/pup_retrieval_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     3118 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/pybursts_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    13660 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/severity_frame_based_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     8738 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/mutual_exclusivity_corrector.py
--rw-r--r--   0 simon      (501) staff       (20)    12919 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/kleinberg_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    10196 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/data_processors/movement_calculator.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/model/
--rw-r--r--   0 simon      (501) staff       (20)    23782 2024-04-16 15:02:05.000000 Simba-UW-tf-dev-1.90.4/simba/model/train_rf.py
--rw-r--r--   0 simon      (501) staff       (20)     4969 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/model/inference_batch.py
--rw-r--r--   0 simon      (501) staff       (20)    14036 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/model/train_multiclass_rf.py
--rw-r--r--   0 simon      (501) staff       (20)     3937 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/model/inference_multiclass_batch.py
--rw-r--r--   0 simon      (501) staff       (20)    15931 2024-02-20 14:30:06.000000 Simba-UW-tf-dev-1.90.4/simba/model/grid_search_multiclass_rf.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:19.000000 Simba-UW-tf-dev-1.90.4/simba/model/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    16987 2024-02-22 11:58:09.000000 Simba-UW-tf-dev-1.90.4/simba/model/grid_search_rf.py
--rw-r--r--   0 simon      (501) staff       (20)     3768 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/model/inference_validation.py
--rw-r--r--   0 simon      (501) staff       (20)     6872 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/model/train_multilabel_rf.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/
--rw-r--r--   0 simon      (501) staff       (20)    12190 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_time_bin_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)     1803 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_movement_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    50018 2024-03-11 20:20:39.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_define.py
--rw-r--r--   0 simon      (501) staff       (20)     3616 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_reset.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     9876 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_size_standardizer.py
--rw-r--r--   0 simon      (501) staff       (20)    30615 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)    15704 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_feature_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)     4386 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_multiply.py
--rw-r--r--   0 simon      (501) staff       (20)     2313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_size_calculations.py
--rw-r--r--   0 simon      (501) staff       (20)     3716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_zoom.py
--rw-r--r--   0 simon      (501) staff       (20)    13394 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_directing_analyzer.py
--rw-r--r--   0 simon      (501) staff       (20)    11974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_move_shape.py
--rw-r--r--   0 simon      (501) staff       (20)     5470 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_menus.py
--rw-r--r--   0 simon      (501) staff       (20)    16129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_clf_calculator.py
--rw-r--r--   0 simon      (501) staff       (20)    29730 2024-03-14 14:41:12.000000 Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_image.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/
--rw-r--r--   0 simon      (501) staff       (20)    10711 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/sleap_csv_importer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/misc/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:31.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/misc/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     8084 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/misc/apt_trk_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     2577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/read_DANNCE_mat.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)    14268 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/sleap_h5_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     8161 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/madlc_importer.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/sleap_slp_importer.py
--rw-r--r--   0 simon      (501) staff       (20)     8645 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/import_mars.py
--rw-r--r--   0 simon      (501) staff       (20)     7464 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/dlc_importer_csv.py
--rw-r--r--   0 simon      (501) staff       (20)     8417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_importers/trk_importer.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/
--rw-r--r--   0 simon      (501) staff       (20)     8196 2024-03-19 18:18:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/bp_names/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:10.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/bp_names/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     4485 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/bp_names/bp_names.csv
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/no_animals/
--rw-r--r--   0 simon      (501) staff       (20)       27 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/no_animals/no_animals.csv
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:18.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/no_animals/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:05.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/__init__.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/configuration_names/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:14.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/configuration_names/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)      273 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/configuration_names/pose_config_names.csv
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/
--rw-r--r--   0 simon      (501) staff       (20)    39805 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/8.png
--rw-r--r--   0 simon      (501) staff       (20)    62501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/9.png
--rw-r--r--   0 simon      (501) staff       (20)     6172 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/12.png
--rw-r--r--   0 simon      (501) staff       (20)    34231 2024-02-20 18:50:39.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/13.png
--rw-r--r--   0 simon      (501) staff       (20)    69501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/11.png
--rw-r--r--   0 simon      (501) staff       (20)    69410 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/10.png
--rw-r--r--   0 simon      (501) staff       (20)    16000 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/4.png
--rw-r--r--   0 simon      (501) staff       (20)    28150 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/5.png
--rw-r--r--   0 simon      (501) staff       (20)    31140 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/7.png
--rw-r--r--   0 simon      (501) staff       (20)    30634 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/6.png
--rw-r--r--   0 simon      (501) staff       (20)    15417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/2.png
--rw-r--r--   0 simon      (501) staff       (20)    15786 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/3.png
--rw-r--r--   0 simon      (501) staff       (20)    18939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/1.png
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/
--rw-r--r--   0 simon      (501) staff       (20)   119697 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/video_processing.py
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-26 15:01:23.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     5577 2024-04-08 11:29:52.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/roi_selector_circle.py
--rw-r--r--   0 simon      (501) staff       (20)     9073 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/px_to_mm.py
--rw-r--r--   0 simon      (501) staff       (20)    35053 2024-02-26 15:42:07.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/batch_process_menus.py
--rw-r--r--   0 simon      (501) staff       (20)    11439 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/multi_cropper.py
--rw-r--r--   0 simon      (501) staff       (20)     3066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/extract_frames.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     6598 2024-02-26 21:50:01.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/roi_selector.py
--rw-r--r--   0 simon      (501) staff       (20)    10007 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/calculate_px_dist.py
--rw-r--r--   0 simon      (501) staff       (20)     5963 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/roi_selector_polygon.py
--rw-r--r--   0 simon      (501) staff       (20)     4926 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/extract_seqframes.py
--rw-r--r--   0 simon      (501) staff       (20)    15117 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.4/simba/video_processors/batch_process_create_ffmpeg_commands.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/outlier_tools/
--rw-r--r--   0 simon      (501) staff       (20)     7837 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/outlier_tools/outlier_corrector_movement.py
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/outlier_tools/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    14462 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/outlier_tools/outlier_corrector_location_advanced.py
--rw-r--r--   0 simon      (501) staff       (20)    13117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/outlier_tools/outlier_corrector_movement_advanced.py
--rw-r--r--   0 simon      (501) staff       (20)    10396 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/outlier_tools/outlier_corrector_location.py
--rw-r--r--   0 simon      (501) staff       (20)     2751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/outlier_tools/skip_outlier_correction.py
--rw-r--r--   0 simon      (501) staff       (20)    82082 2024-04-15 18:43:27.000000 Simba-UW-tf-dev-1.90.4/simba/SimBA.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/unsupervised/
--rw-r--r--   0 simon      (501) staff       (20)   109483 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/unsupervised/model_names.parquet
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:36.000000 Simba-UW-tf-dev-1.90.4/simba/assets/unsupervised/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/unsupervised/features.csv
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/
--rw-r--r--   0 simon      (501) staff       (20)     1177 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/down_arrow.jpg
--rw-r--r--   0 simon      (501) staff       (20)     1733 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/intruder_shape.jpg
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/feature_categories/
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:25.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/feature_categories/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    17420 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/feature_categories/shap_feature_categories.csv
--rw-r--r--   0 simon      (501) staff       (20)     1665 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_shape.jpg
--rw-r--r--   0 simon      (501) staff       (20)     2415 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_intruder_shape.jpg
--rw-r--r--   0 simon      (501) staff       (20)     2012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/animal_distances.jpg
--rw-r--r--   0 simon      (501) staff       (20)     4422 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/baseline_scale.jpg
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:21.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)   353824 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/ubuntu.regular.ttf
--rw-r--r--   0 simon      (501) staff       (20)     6672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/side_scale.jpg
--rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/UbuntuMono-Regular.ttf
--rw-r--r--   0 simon      (501) staff       (20)     2737 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/side_scale_5.jpg
--rw-r--r--   0 simon      (501) staff       (20)     1785 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/intruder_movement.jpg
--rw-r--r--   0 simon      (501) staff       (20)     1435 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_movement.jpg
--rw-r--r--   0 simon      (501) staff       (20)     3134 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/color_bar.jpg
--rw-r--r--   0 simon      (501) staff       (20)     2120 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_intruder_movement.jpg
--rw-r--r--   0 simon      (501) staff       (20)    10244 2024-04-09 23:07:16.000000 Simba-UW-tf-dev-1.90.4/simba/assets/.DS_Store
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/lookups/
--rw-r--r--   0 simon      (501) staff       (20)   270783 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/lookups/model_names.parquet
--rw-r--r--   0 simon      (501) staff       (20)     2987 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/lookups/feature_extraction_headers.csv
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:11.000000 Simba-UW-tf-dev-1.90.4/simba/assets/lookups/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    26256 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/lookups/critical_values_05.pickle
--rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/lookups/features.csv
--rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/lookups/unsupervised_example_x.csv
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:54.000000 Simba-UW-tf-dev-1.90.4/simba/assets/__init__.py
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/stl/
--rw-r--r--   0 simon      (501) staff       (20)   551576 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/stl/operant_tray.stl
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:31.000000 Simba-UW-tf-dev-1.90.4/simba/assets/stl/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)    67647 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/stl/operant_lever.stl
--rw-r--r--   0 simon      (501) staff       (20)    92896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/stl/operant_walls.stl
--rw-r--r--   0 simon      (501) staff       (20)  4759984 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/stl/grid_floor.stl
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/
--rw-r--r--   0 simon      (501) staff       (20)   489479 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/splash_2024.mp4
--rw-r--r--   0 simon      (501) staff       (20)    79863 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/bg_2024.png
--rw-r--r--   0 simon      (501) staff       (20)   399272 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/about_me.png
--rw-r--r--   0 simon      (501) staff       (20)   117108 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/splash.mp4
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:02.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)   322242 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/bg_2.png
--rw-r--r--   0 simon      (501) staff       (20)      165 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/~$splash.pptx
--rw-r--r--   0 simon      (501) staff       (20)    69267 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/splash.pptx
--rw-r--r--   0 simon      (501) staff       (20)   204362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/img/bg.png
--rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/UbuntuMono-Regular.ttf
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/
--rw-r--r--   0 simon      (501) staff       (20)     1350 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/factory.png
--rw-r--r--   0 simon      (501) staff       (20)     1413 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/cluster.png
--rw-r--r--   0 simon      (501) staff       (20)     1340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/load.png
--rw-r--r--   0 simon      (501) staff       (20)     4507 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/gif.png
--rw-r--r--   0 simon      (501) staff       (20)     4566 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/pose.png
--rw-r--r--   0 simon      (501) staff       (20)     1943 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/features.png
--rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-09 15:42:22.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/.DS_Store
--rw-r--r--   0 simon      (501) staff       (20)     4896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/settings.png
--rw-r--r--   0 simon      (501) staff       (20)     2090 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/stopwatch.png
--rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/link.png
--rw-r--r--   0 simon      (501) staff       (20)    14250 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/dash_simba.css
--rw-r--r--   0 simon      (501) staff       (20)      917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/documentation.png
--rw-r--r--   0 simon      (501) staff       (20)     4503 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/fps.png
--rw-r--r--   0 simon      (501) staff       (20)     1299 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/dimensionality_reduction.png
--rw-r--r--   0 simon      (501) staff       (20)     4823 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/roi.png
--rw-r--r--   0 simon      (501) staff       (20)   171446 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/simba_logo_2.png
--rw-r--r--   0 simon      (501) staff       (20)      920 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/superimpose.png
--rw-r--r--   0 simon      (501) staff       (20)     1136 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/label.png
--rw-r--r--   0 simon      (501) staff       (20)     1016 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/change.png
--rw-r--r--   0 simon      (501) staff       (20)    59896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/readthedocs_logo.png
--rw-r--r--   0 simon      (501) staff       (20)     1124 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/crop.png
--rw-r--r--   0 simon      (501) staff       (20)     2146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/rotate.png
--rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-26 14:29:54.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/circle.png
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:37.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     1057 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/path.png
--rw-r--r--   0 simon      (501) staff       (20)     1148 2024-02-26 20:39:14.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/polygon.png
--rw-r--r--   0 simon      (501) staff       (20)      950 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/clip.png
--rw-r--r--   0 simon      (501) staff       (20)     2121 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/restart.png
--rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/calipher.png
--rw-r--r--   0 simon      (501) staff       (20)     1291 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/add_on.png
--rw-r--r--   0 simon      (501) staff       (20)     4695 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/create.png
--rw-r--r--   0 simon      (501) staff       (20)    78182 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/SimBA_logo.ico
--rw-r--r--   0 simon      (501) staff       (20)     1067 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/print.png
--rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/clf.png
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/
--rw-r--r--   0 simon      (501) staff       (20)     6027 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/mosaic.png
--rw-r--r--   0 simon      (501) staff       (20)     5654 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/vertical.png
--rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:45.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/__init__.py
--rw-r--r--   0 simon      (501) staff       (20)     5542 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/horizontal.png
--rw-r--r--   0 simon      (501) staff       (20)     5939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/mixed_mosaic.png
--rw-r--r--   0 simon      (501) staff       (20)     2060 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/merge.png
--rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/clean.png
--rw-r--r--   0 simon      (501) staff       (20)     4725 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/clf_2.png
--rw-r--r--   0 simon      (501) staff       (20)     4795 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/visualize.png
--rw-r--r--   0 simon      (501) staff       (20)     2142 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat.png
--rw-r--r--   0 simon      (501) staff       (20)     1474 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/boris.png
--rw-r--r--   0 simon      (501) staff       (20)     4804 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/frames.png
--rw-r--r--   0 simon      (501) staff       (20)     2425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/video.png
--rw-r--r--   0 simon      (501) staff       (20)     2089 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/sample.png
--rw-r--r--   0 simon      (501) staff       (20)     1471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/metrics.png
--rw-r--r--   0 simon      (501) staff       (20)     4555 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/grey.png
--rw-r--r--   0 simon      (501) staff       (20)      930 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/exit.png
--rw-r--r--   0 simon      (501) staff       (20)     4751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/outlier.png
--rw-r--r--   0 simon      (501) staff       (20)     4392 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/clahe.png
--rw-r--r--   0 simon      (501) staff       (20)     4637 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/trash.png
--rw-r--r--   0 simon      (501) staff       (20)     1239 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/about.png
--rw-r--r--   0 simon      (501) staff       (20)     4666 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/convert.png
--rw-r--r--   0 simon      (501) staff       (20)    93229 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/SimBA_logo.icns
--rw-r--r--   0 simon      (501) staff       (20)      991 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/reorganize.png
--rw-r--r--   0 simon      (501) staff       (20)     4784 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/browse.png
--rw-r--r--   0 simon      (501) staff       (20)    30707 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/SimBA_logo.png
--rw-r--r--   0 simon      (501) staff       (20)     2293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/ethovision.png
--rw-r--r--   0 simon      (501) staff       (20)     1018 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/icons/close.png
--rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/dash_simba_base.css
--rw-r--r--   0 simon      (501) staff       (20)    31812 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.4/simba/assets/TheGoldenLab.PNG
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/
--rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-17 20:00:42.000000 Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/PKG-INFO
--rw-r--r--   0 simon      (501) staff       (20)    23176 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/SOURCES.txt
--rw-r--r--   0 simon      (501) staff       (20)       44 2024-04-17 20:00:42.000000 Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/entry_points.txt
--rw-r--r--   0 simon      (501) staff       (20)      797 2024-04-17 20:00:42.000000 Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/requires.txt
--rw-r--r--   0 simon      (501) staff       (20)        6 2024-04-17 20:00:42.000000 Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/top_level.txt
--rw-r--r--   0 simon      (501) staff       (20)        1 2024-04-17 20:00:42.000000 Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/dependency_links.txt
--rw-r--r--   0 simon      (501) staff       (20)    35127 2024-02-07 18:56:10.000000 Simba-UW-tf-dev-1.90.4/LICENSE
-drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/tests/
--rw-r--r--   0 simon      (501) staff       (20)     4753 2024-04-11 20:40:04.000000 Simba-UW-tf-dev-1.90.4/tests/test_data_processors.py
--rw-r--r--   0 simon      (501) staff       (20)    13415 2024-03-01 16:43:04.000000 Simba-UW-tf-dev-1.90.4/tests/test_circlular_stats.py
--rw-r--r--   0 simon      (501) staff       (20)    13399 2024-04-11 20:36:51.000000 Simba-UW-tf-dev-1.90.4/tests/test_stats.py
--rw-r--r--   0 simon      (501) staff       (20)    11863 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_train_model_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     6525 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_feature_extraction_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     1739 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_utils_data.py
--rw-r--r--   0 simon      (501) staff       (20)     8120 2024-03-01 19:06:25.000000 Simba-UW-tf-dev-1.90.4/tests/test_config_reader_mixin.py
--rw-r--r--   0 simon      (501) staff       (20)     1070 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_outlier_correctors.py
--rw-r--r--   0 simon      (501) staff       (20)     4435 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_visualize_directing_animals.py
--rw-r--r--   0 simon      (501) staff       (20)     1596 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_featurizers.py
--rw-r--r--   0 simon      (501) staff       (20)     8570 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_video_processors.py
--rw-r--r--   0 simon      (501) staff       (20)     3554 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_thirdparty_appenders.py
--rw-r--r--   0 simon      (501) staff       (20)     3021 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_validation_clips.py
--rw-r--r--   0 simon      (501) staff       (20)     3992 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.4/tests/test_roi_tools.py
--rw-r--r--   0 simon      (501) staff       (20)      318 2024-03-04 20:16:28.000000 Simba-UW-tf-dev-1.90.4/MANIFEST.in
--rw-r--r--   0 simon      (501) staff       (20)    18478 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.4/README.md
--rw-r--r--   0 simon      (501) staff       (20)     1426 2024-04-17 19:59:45.000000 Simba-UW-tf-dev-1.90.4/setup.py
--rw-r--r--   0 simon      (501) staff       (20)       38 2024-04-17 20:00:43.000000 Simba-UW-tf-dev-1.90.4/setup.cfg
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/
+-rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/PKG-INFO
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/ui/
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-28 13:50:53.000000 Simba-UW-tf-dev-1.90.5/simba/ui/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/
+-rw-r--r--   0 simon      (501) staff       (20)    11467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/mutual_exclusivity_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4070 2024-03-29 20:30:28.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1676 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/csv_2_parquet_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     5883 2024-04-22 13:59:07.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/quick_path_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     2873 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/batch_preprocess_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     8835 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/heatmap_location_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9734 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_probability_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/movement_analysis_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4631 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    11362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    25598 2024-04-17 23:32:48.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/path_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1184 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/remove_roi_features_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6692 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/smoothing_interpolation_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     2174 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_size_standardizer_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     6997 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4682 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_analysis_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     7898 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/outlier_settings_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9048 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/gantt_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_validation_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     8529 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/severity_analysis_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3221 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/fsttc_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4231 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/kleinberg_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     8376 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9785 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/spontaneous_alternation_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6076 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/pose_reorganizer_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3437 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3351 2024-04-25 16:26:59.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/append_roi_features_animals_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3468 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_by_timebins_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9154 2024-04-12 00:32:53.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/heatmap_clf_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9235 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/data_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    10787 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_features_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9121 2024-04-25 13:46:55.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/pup_retrieval_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     5577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py
+-rw-r--r--   0 simon      (501) staff       (20)      584 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/about_simba_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     5451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9419 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_tracking_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1821 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/append_roi_features_bodypart_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     7312 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6546 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_add_remove_print_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    81527 2024-04-15 18:43:27.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/video_processing_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     7800 2024-04-04 16:47:32.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/validation_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6160 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_by_roi_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4470 2024-04-22 13:59:07.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/make_path_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3622 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     6166 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1072 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/archive_files_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/pose_bp_drop_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    12174 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/distance_plot_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4673 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/subset_feature_extractor_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     3290 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     4134 2024-03-31 17:07:13.000000 Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)    16701 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.90.5/simba/ui/video_info_ui.py
+-rw-r--r--   0 simon      (501) staff       (20)     6573 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.5/simba/ui/user_defined_pose_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/ui/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    14374 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.5/simba/ui/create_project_ui.py
+-rw-r--r--   0 simon      (501) staff       (20)    14487 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.90.5/simba/ui/tkinter_functions.py
+-rw-r--r--   0 simon      (501) staff       (20)    38871 2024-04-16 13:37:42.000000 Simba-UW-tf-dev-1.90.5/simba/ui/machine_model_settings_ui.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/labelling/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/labelling/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    24423 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/labelling/labelling_interface.py
+-rw-r--r--   0 simon      (501) staff       (20)     2362 2024-02-21 02:33:04.000000 Simba-UW-tf-dev-1.90.5/simba/labelling/targeted_annotations_clips.py
+-rw-r--r--   0 simon      (501) staff       (20)     3974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/labelling/extract_labelled_frames.py
+-rw-r--r--   0 simon      (501) staff       (20)    31269 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/labelling/labelling_advanced_interface.py
+-rw-r--r--   0 simon      (501) staff       (20)    10012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/labelling/play_annotation_video.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/
+-rw-r--r--   0 simon      (501) staff       (20)    15004 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/dbcv_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5077 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_validation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     3645 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/enums.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:33:55.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     9036 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_video_visualizer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/
+-rw-r--r--   0 simon      (501) staff       (20)     4642 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_videos_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     4027 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/transform_cluster_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     5048 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/embedding_correlations_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-02 14:39:26.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     4070 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)    11182 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     2546 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/data_extractor_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     4536 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_validation_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     9305 2024-02-15 23:45:22.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/fit_cluster_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     2574 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/clusterer_comparison_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     6527 2024-03-26 23:50:53.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     4332 2024-03-28 20:02:59.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_xai_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     3820 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_frequentist_stats_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     2355 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/print_embedding_info_popup.py
+-rw-r--r--   0 simon      (501) staff       (20)     9946 2024-04-02 18:34:25.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/dataset_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)    12982 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/unsupervised_main.py
+-rw-r--r--   0 simon      (501) staff       (20)    10175 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/grid_search_visualizers.py
+-rw-r--r--   0 simon      (501) staff       (20)    16005 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/data_extractor.py
+-rw-r--r--   0 simon      (501) staff       (20)     5241 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/outlier_detector.py
+-rw-r--r--   0 simon      (501) staff       (20)    10397 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_frequentist_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5798 2024-03-27 12:56:51.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/embedding_correlation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    18194 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_xai_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    15581 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/umap_embedder.py
+-rw-r--r--   0 simon      (501) staff       (20)     5582 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/clusterer_comparison_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     4652 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/bout_aggregator.py
+-rw-r--r--   0 simon      (501) staff       (20)     2188 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/data_map.yaml
+-rw-r--r--   0 simon      (501) staff       (20)    14765 2024-03-26 19:09:58.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/hdbscan_clusterer.py
+-rw-r--r--   0 simon      (501) staff       (20)     3862 2024-02-15 21:37:53.000000 Simba-UW-tf-dev-1.90.5/simba/unsupervised/tsne.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     8511 2024-02-08 00:53:55.000000 Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/agg_boundary_stats.py
+-rw-r--r--   0 simon      (501) staff       (20)    27255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/boundary_menus.py
+-rw-r--r--   0 simon      (501) staff       (20)    10064 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/boundary_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)     7146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/find_boundaries.py
+-rw-r--r--   0 simon      (501) staff       (20)    12066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/visualize_boundaries.py
+-rw-r--r--   0 simon      (501) staff       (20)    18436 2024-04-25 14:48:22.000000 Simba-UW-tf-dev-1.90.5/simba/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/
+-rw-r--r--   0 simon      (501) staff       (20)    57052 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_14bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    28094 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_7bp.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/
+-rw-r--r--   0 simon      (501) staff       (20)     1757 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/doctests.py
+-rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/read_in_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/peaks.py
+-rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2022.py
+-rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/convex_hull_3_scratch_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/convex_hull_scratch_1.py
+-rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py
+-rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/egocentrical_aligner.py
+-rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/count_values_in_range.py
+-rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/graph_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/termite_rois.csv
+-rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/mutual_exclusive.py
+-rw-r--r--   0 simon      (501) staff       (20)     2883 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/video_color.py
+-rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/graph_3d_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/video_rotator.py
+-rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/add_probability_cnt_features.py
+-rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/make_splash.py
+-rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py
+-rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/time_stamp_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 20:55:52.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/video_rotator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py
+-rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 20:55:43.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/convex_hull_scratch_2.py
+-rw-r--r--   0 simon      (501) staff       (20)    36307 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_8bps_2_animals.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-02-21 02:05:27.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     4091 2024-02-16 21:14:07.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/perimeter_jit.py
+-rw-r--r--   0 simon      (501) staff       (20)    26471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_subsets.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    10043 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_user_defined.py
+-rw-r--r--   0 simon      (501) staff       (20)    61607 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_16bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    37328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_9bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    31163 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_8bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    21427 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_4bp.py
+-rw-r--r--   0 simon      (501) staff       (20)    65534 2024-03-01 16:55:51.000000 Simba-UW-tf-dev-1.90.5/simba/feature_extractors/amber_feature_extractor.py
+-rw-r--r--   0 simon      (501) staff       (20)     1033 2024-04-11 12:52:35.000000 Simba-UW-tf-dev-1.90.5/simba/requirements.txt
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/
+-rw-r--r--   0 simon      (501) staff       (20)    40917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/annotator_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    84153 2024-04-15 18:43:27.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/timeseries_features_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-03 14:38:30.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    53232 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/pop_up_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    48035 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/config_reader.py
+-rw-r--r--   0 simon      (501) staff       (20)    56304 2024-04-17 23:32:32.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/circular_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)    38770 2024-04-21 12:08:55.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/network_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    24040 2024-04-18 18:35:47.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/pose_importer_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     3020 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/video_processing_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    36231 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/feature_extraction_supplement_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)   169619 2024-04-22 13:26:42.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/statistics_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    44711 2024-04-22 19:40:36.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/feature_extraction_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    75996 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/plotting_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)      391 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/abstract_classes.py
+-rw-r--r--   0 simon      (501) staff       (20)    61924 2024-04-21 12:08:55.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/image_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)      880 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/unsupervised_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)   132883 2024-03-29 19:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/train_model_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)   166028 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/geometry_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)    24978 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/mixins/feature_extraction_circular_mixin.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/
+-rw-r--r--   0 simon      (501) staff       (20)     6639 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/deepethogram_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)    12306 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/BORIS_appender.py
+-rw-r--r--   0 simon      (501) staff       (20)     9739 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/observer_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     5508 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/boris_source_cleaner.py
+-rw-r--r--   0 simon      (501) staff       (20)    18982 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/tools.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    18852 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/third_party_appender.py
+-rw-r--r--   0 simon      (501) staff       (20)     9215 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/ethovision_import.py
+-rw-r--r--   0 simon      (501) staff       (20)     7456 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/BENTO_appender.py
+-rw-r--r--   0 simon      (501) staff       (20)     5662 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/solomon_importer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/
+-rw-r--r--   0 simon      (501) staff       (20)     8841 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_clf_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)    14451 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)    18274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_menues.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)    19237 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    15281 2024-04-25 13:46:55.000000 Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_movement_statistics.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/__init__.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/utils/
+-rw-r--r--   0 simon      (501) staff       (20)    13211 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.90.5/simba/utils/config_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)    26038 2024-03-27 13:42:19.000000 Simba-UW-tf-dev-1.90.5/simba/utils/enums.py
+-rw-r--r--   0 simon      (501) staff       (20)    10420 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.5/simba/utils/custom_feature_extractor.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-25 13:44:34.000000 Simba-UW-tf-dev-1.90.5/simba/utils/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     7737 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/utils/warnings.py
+-rw-r--r--   0 simon      (501) staff       (20)    52821 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/utils/checks.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/utils/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    79462 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/utils/read_write.py
+-rw-r--r--   0 simon      (501) staff       (20)    15355 2024-04-16 18:54:43.000000 Simba-UW-tf-dev-1.90.5/simba/utils/lookups.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/utils/cli/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/utils/cli/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     7129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/utils/cli/cli_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)    17086 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/utils/errors.py
+-rw-r--r--   0 simon      (501) staff       (20)    46271 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/utils/data.py
+-rw-r--r--   0 simon      (501) staff       (20)     4205 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/utils/printing.py
+-rw-r--r--   0 simon      (501) staff       (20)   243998 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/SimBA_logo.ico
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_processors/
+-rw-r--r--   0 simon      (501) staff       (20)     8626 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_processors/reorganize_keypoint.py
+-rw-r--r--   0 simon      (501) staff       (20)     5840 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_processors/remove_keypoints.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_processors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     2872 2024-02-15 23:39:58.000000 Simba-UW-tf-dev-1.90.5/simba/pose_processors/pose_reset.py
+-rw-r--r--   0 simon      (501) staff       (20)     6313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_processors/reverse_pose.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/
+-rw-r--r--   0 simon      (501) staff       (20)      786 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/doctests.py
+-rw-r--r--   0 simon      (501) staff       (20)    29328 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     2387 2024-03-08 14:35:02.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/dprime.py
+-rw-r--r--   0 simon      (501) staff       (20)     2516 2024-03-18 17:01:43.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/linear_fretchet.py
+-rw-r--r--   0 simon      (501) staff       (20)     2705 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/read_in_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     2391 2024-03-14 12:45:59.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324 3.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     2036 2024-03-28 18:29:59.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/dunn_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     3640 2024-04-08 13:30:56.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/hausdorff.py
+-rw-r--r--   0 simon      (501) staff       (20)     2689 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/peaks.py
+-rw-r--r--   0 simon      (501) staff       (20)    16727 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2022.py
+-rw-r--r--   0 simon      (501) staff       (20)     3494 2024-04-03 13:42:02.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/colinear_features.py
+-rw-r--r--   0 simon      (501) staff       (20)     8921 2024-03-22 13:56:46.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/spontaneous_alternation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    21658 2024-04-10 16:31:38.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/horizontal_videos_concat.py
+-rw-r--r--   0 simon      (501) staff       (20)     2144 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/convex_hull_3_scratch_3.py
+-rw-r--r--   0 simon      (501) staff       (20)     1103 2024-03-29 16:26:34.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/silhouette_score.py
+-rw-r--r--   0 simon      (501) staff       (20)     3607 2024-04-09 14:21:58.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/two_fish_feature_extractor_040924.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)    33092 2024-02-22 15:57:45.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/cuda_jit.ipynb
+-rw-r--r--   0 simon      (501) staff       (20)     5762 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/convex_hull_scratch_1.py
+-rw-r--r--   0 simon      (501) staff       (20)     1867 2024-03-12 19:23:40.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/directed_hausdorff.py
+-rw-r--r--   0 simon      (501) staff       (20)      963 2024-03-13 18:20:52.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/shannon_diversity_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     3726 2024-03-12 13:31:58.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/sequential_lag_analysis.py
+-rw-r--r--   0 simon      (501) staff       (20)     1254 2024-03-13 16:09:50.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/wilcoxon.py
+-rw-r--r--   0 simon      (501) staff       (20)    21599 2024-04-22 16:40:51.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/ROI_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-25 14:48:22.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     3328 2024-03-08 15:05:36.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/data.npy
+-rw-r--r--   0 simon      (501) staff       (20)    12626 2024-03-25 20:59:27.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/distances.py
+-rw-r--r--   0 simon      (501) staff       (20)    26425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_2.py
+-rw-r--r--   0 simon      (501) staff       (20)     2699 2024-03-10 16:29:57.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/cohens_kappa.py
+-rw-r--r--   0 simon      (501) staff       (20)     2465 2024-03-08 17:38:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/paths.py
+-rw-r--r--   0 simon      (501) staff       (20)     1048 2024-03-13 14:41:23.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/outliers_tietjen.py
+-rw-r--r--   0 simon      (501) staff       (20)     1424 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/train_model.py
+-rw-r--r--   0 simon      (501) staff       (20)     2346 2024-04-19 14:10:16.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/img_stack_to_bw.py
+-rw-r--r--   0 simon      (501) staff       (20)     3171 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/amber_tests.py
+-rw-r--r--   0 simon      (501) staff       (20)     3590 2024-03-11 17:05:31.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/line_locate_point.py
+-rw-r--r--   0 simon      (501) staff       (20)     1841 2024-04-19 16:19:10.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/sorensen_dice_coefficient.py
+-rw-r--r--   0 simon      (501) staff       (20)     3182 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/multifrm_to_points.py
+-rw-r--r--   0 simon      (501) staff       (20)       69 2024-03-18 18:17:24.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/lcs.py
+-rw-r--r--   0 simon      (501) staff       (20)    12448 2024-04-09 14:14:37.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/two_fish_feature_extractor_040924.py
+-rw-r--r--   0 simon      (501) staff       (20)     6119 2024-04-20 17:58:22.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/ez_path_plot.py
+-rw-r--r--   0 simon      (501) staff       (20)     7535 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/egocentrical_aligner.py
+-rw-r--r--   0 simon      (501) staff       (20)     2350 2024-03-12 17:58:33.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/add_body_part.py
+-rw-r--r--   0 simon      (501) staff       (20)     1008 2024-03-12 13:29:20.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/grubbs_test.py
+-rw-r--r--   0 simon      (501) staff       (20)     3399 2024-02-16 01:12:37.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/slide_circ_mean.py
+-rw-r--r--   0 simon      (501) staff       (20)     1835 2024-03-28 22:56:59.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/calinski_harabasz.py
+-rw-r--r--   0 simon      (501) staff       (20)     1282 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_feature_visualizer_example.py
+-rw-r--r--   0 simon      (501) staff       (20)    10076 2024-03-22 16:51:40.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/spontaneuous_alternation_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)      895 2024-03-12 14:09:55.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/runs_test.py
+-rw-r--r--   0 simon      (501) staff       (20)     2516 2024-04-06 11:33:24.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/pct_counts_in_top_N.py
+-rw-r--r--   0 simon      (501) staff       (20)     1095 2024-04-19 18:37:50.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/concordance_ratio.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:46:33.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     2287 2024-03-25 16:45:04.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/total_variation_distance.py
+-rw-r--r--   0 simon      (501) staff       (20)     3056 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/crop_single_polygon.py
+-rw-r--r--   0 simon      (501) staff       (20)    15977 2024-04-23 22:52:42.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/ROI_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)     8010 2024-03-24 19:48:22.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/joint_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     1529 2024-04-19 15:08:24.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/segment_image_horizontal.py
+-rw-r--r--   0 simon      (501) staff       (20)    11145 2024-04-15 15:02:56.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/clip_multiple_videos_by_frame_numbers.py
+-rw-r--r--   0 simon      (501) staff       (20)     2552 2024-04-02 14:48:59.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/elliptic_envelope.py
+-rw-r--r--   0 simon      (501) staff       (20)     1016 2024-03-14 14:57:29.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_definition_csvs_to_h5.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     1276 2024-03-12 17:58:38.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/add_body_part.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)      921 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_feature_visualizer_example.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     2631 2024-04-05 16:23:07.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/sliding_crosscorrelation.py
+-rw-r--r--   0 simon      (501) staff       (20)     1274 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/count_values_in_range.py
+-rw-r--r--   0 simon      (501) staff       (20)     2174 2024-03-14 14:56:26.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_definition_csvs_to_h5.py
+-rw-r--r--   0 simon      (501) staff       (20)     1656 2024-03-30 18:32:44.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/distance_velocity.py
+-rw-r--r--   0 simon      (501) staff       (20)     5011 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/graph_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5666 2024-04-11 15:28:58.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/line_plot_plotly.py
+-rw-r--r--   0 simon      (501) staff       (20)     3954 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/termite_rois.csv
+-rw-r--r--   0 simon      (501) staff       (20)     1351 2024-03-26 21:10:40.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/unsupervised_lof.py
+-rw-r--r--   0 simon      (501) staff       (20)     2553 2024-03-11 15:09:38.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/siegel_tukey.py
+-rw-r--r--   0 simon      (501) staff       (20)      958 2024-03-13 18:05:08.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/berger_parker.py
+-rw-r--r--   0 simon      (501) staff       (20)     4177 2024-04-10 01:56:43.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/isolation_forest.py
+-rw-r--r--   0 simon      (501) staff       (20)     2845 2024-03-28 19:23:54.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/davis_bouldin.py
+-rw-r--r--   0 simon      (501) staff       (20)     4094 2024-04-10 14:09:54.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/vertical_video_concatenator.py
+-rw-r--r--   0 simon      (501) staff       (20)     2770 2024-04-07 19:14:13.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/batch_video_to_greyscale.py
+-rw-r--r--   0 simon      (501) staff       (20)     7215 2024-02-26 15:46:14.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/crop_circles_pop_up.py
+-rw-r--r--   0 simon      (501) staff       (20)     1410 2024-03-19 12:49:24.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/heading.py
+-rw-r--r--   0 simon      (501) staff       (20)     2243 2024-03-13 18:35:02.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324 2.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)      736 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/mutual_exclusive.py
+-rw-r--r--   0 simon      (501) staff       (20)     2907 2024-03-14 19:31:25.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/grangercausalitytests.py
+-rw-r--r--   0 simon      (501) staff       (20)     2432 2024-03-19 20:48:43.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/multiframe_is_shape_covered.py
+-rw-r--r--   0 simon      (501) staff       (20)      592 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/redis.py
+-rw-r--r--   0 simon      (501) staff       (20)     2893 2024-02-26 20:49:33.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/video_color.py
+-rw-r--r--   0 simon      (501) staff       (20)     2055 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/graph_3d_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     6186 2024-03-18 12:44:45.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/video_rotator.py
+-rw-r--r--   0 simon      (501) staff       (20)     1004 2024-03-12 13:11:45.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/hartley_fmax.py
+-rw-r--r--   0 simon      (501) staff       (20)       84 2024-04-03 17:05:23.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/calc_N_degree_direction_switches.py
+-rw-r--r--   0 simon      (501) staff       (20)     2307 2024-02-27 21:31:33.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/fix_clahe.py
+-rw-r--r--   0 simon      (501) staff       (20)     1836 2024-03-10 15:38:46.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/cochran_q.py
+-rw-r--r--   0 simon      (501) staff       (20)      682 2024-03-13 19:19:43.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/menhinicks_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     2932 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/add_probability_cnt_features.py
+-rw-r--r--   0 simon      (501) staff       (20)     1559 2024-04-19 15:50:37.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/brillouins_index.py
+-rw-r--r--   0 simon      (501) staff       (20)    13575 2024-03-20 11:47:11.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/spontanous_alternations.py
+-rw-r--r--   0 simon      (501) staff       (20)     2268 2024-03-13 13:59:07.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     4655 2024-03-06 18:18:27.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/velocity_aggregator.py
+-rw-r--r--   0 simon      (501) staff       (20)     1619 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/make_splash.py
+-rw-r--r--   0 simon      (501) staff       (20)     4478 2024-04-08 20:43:42.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/abod.py
+-rw-r--r--   0 simon      (501) staff       (20)    37024 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_5.py
+-rw-r--r--   0 simon      (501) staff       (20)     1374 2024-04-18 13:56:20.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/violin.py
+-rw-r--r--   0 simon      (501) staff       (20)     1073 2024-03-13 16:46:16.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/simpson_diversity_index.py
+-rw-r--r--   0 simon      (501) staff       (20)     4485 2024-04-14 19:07:54.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/clip_videos_by_frm.py
+-rw-r--r--   0 simon      (501) staff       (20)     2396 2024-03-17 16:55:38.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324 4.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     1106 2024-04-18 13:46:43.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/rotate image.py
+-rw-r--r--   0 simon      (501) staff       (20)     5336 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/geometry_ex.py
+-rw-r--r--   0 simon      (501) staff       (20)     1613 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/time_stamp_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     1505 2024-03-28 14:36:24.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/line_plot.py
+-rw-r--r--   0 simon      (501) staff       (20)     5515 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/video_rotator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    15996 2024-04-09 13:41:30.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/unsupervised_outliers.py
+-rw-r--r--   0 simon      (501) staff       (20)     5690 2024-02-10 20:28:08.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/statistics_ex.py
+-rw-r--r--   0 simon      (501) staff       (20)    16646 2024-04-22 16:43:10.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/ROI_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)     1391 2024-03-18 23:21:46.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/sliding_displacement.py
+-rw-r--r--   0 simon      (501) staff       (20)     7819 2024-04-18 14:47:28.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/path_plots.py
+-rw-r--r--   0 simon      (501) staff       (20)      925 2024-03-11 13:06:04.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/wald_wolfowitz.py
+-rw-r--r--   0 simon      (501) staff       (20)     1814 2024-04-05 14:36:58.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/sliding_autoc.py
+-rw-r--r--   0 simon      (501) staff       (20)     2369 2024-03-14 17:07:10.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/linestring_path.py
+-rw-r--r--   0 simon      (501) staff       (20)     2233 2024-03-18 15:20:48.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/cronbach_alpha.py
+-rw-r--r--   0 simon      (501) staff       (20)     2809 2024-03-08 21:15:58.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/mcnamar.py
+-rw-r--r--   0 simon      (501) staff       (20)    37022 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_4.py
+-rw-r--r--   0 simon      (501) staff       (20)     6220 2024-02-24 20:57:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/AmberFeatureExtractor.py.zip
+-rw-r--r--   0 simon      (501) staff       (20)     1933 2024-04-10 15:09:25.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/mosaic.py
+-rw-r--r--   0 simon      (501) staff       (20)      441 2024-04-12 17:03:24.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/bouts_df
+-rw-r--r--   0 simon      (501) staff       (20)    69423 2024-02-20 14:30:23.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/amber_featurizer.py
+-rw-r--r--   0 simon      (501) staff       (20)     6286 2024-04-17 19:28:51.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/make_path_plot.py
+-rw-r--r--   0 simon      (501) staff       (20)      837 2024-03-13 18:56:21.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/margalef_diversification_index.py
+-rw-r--r--   0 simon      (501) staff       (20)      997 2024-03-17 17:49:00.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/biweight_midcorrelation.py
+-rw-r--r--   0 simon      (501) staff       (20)     2186 2024-03-18 15:31:23.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/madmedianrule.py
+-rw-r--r--   0 simon      (501) staff       (20)     2915 2024-04-01 14:12:59.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/adjusted_rand_score.py
+-rw-r--r--   0 simon      (501) staff       (20)     2068 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/convex_hull_scratch_2.py
+-rw-r--r--   0 simon      (501) staff       (20)     1957 2024-04-12 14:55:03.000000 Simba-UW-tf-dev-1.90.5/simba/sandbox/plotly_gantt.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/
+-rw-r--r--   0 simon      (501) staff       (20)     8538 2024-02-23 18:25:51.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/directing_animals_to_bodypart_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    10127 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/gantt_creator.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/tools/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:43:56.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     5946 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/tools/tkinter_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)    22770 2024-04-25 16:23:17.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/ROI_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-25 14:48:22.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    19270 2024-03-31 17:21:01.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/shap_agg_stats_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    11843 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/gantt_creator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    15819 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_clf_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    10376 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/probability_plot_creator.py
+-rw-r--r--   0 simon      (501) staff       (20)     8467 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/circular_plotting.py
+-rw-r--r--   0 simon      (501) staff       (20)    16868 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/plot_clf_results.py
+-rw-r--r--   0 simon      (501) staff       (20)    10328 2024-04-25 15:48:10.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/ez_path_plot.py
+-rw-r--r--   0 simon      (501) staff       (20)    17432 2024-04-17 23:57:27.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/plot_clf_results_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    21805 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/ROI_feature_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    13622 2024-02-21 04:25:14.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_location.py
+-rw-r--r--   0 simon      (501) staff       (20)    12949 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/probability_plot_creator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     5253 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/interactive_probability_grapher.py
+-rw-r--r--   0 simon      (501) staff       (20)     6517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/plot_pose_in_dir.py
+-rw-r--r--   0 simon      (501) staff       (20)    20950 2024-04-11 20:25:55.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/single_run_model_validation_video.py
+-rw-r--r--   0 simon      (501) staff       (20)     8732 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/frame_mergerer_ffmpeg.py
+-rw-r--r--   0 simon      (501) staff       (20)    10667 2024-04-03 23:24:04.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/pose_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    16490 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/directing_animals_visualizer_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    14389 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/clf_validator.py
+-rw-r--r--   0 simon      (501) staff       (20)    23374 2024-04-17 23:32:48.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/path_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    24604 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/ROI_feature_visualizer_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    11824 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/data_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    13091 2024-03-26 23:49:10.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/spontaneous_alternation_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    21806 2024-04-22 13:26:42.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/path_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    16812 2024-04-16 15:02:05.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/distance_plotter_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    17350 2024-04-25 16:23:17.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/ROI_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    10034 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/geometry_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    16661 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/clf_validator_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    14224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_clf.py
+-rw-r--r--   0 simon      (501) staff       (20)    11994 2024-04-11 22:38:54.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/distance_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    19073 2024-04-11 20:26:33.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/single_run_model_validation_video_mp.py
+-rw-r--r--   0 simon      (501) staff       (20)    12469 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/directing_animals_visualizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    11453 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/circular_feature_overlay_plotter.py
+-rw-r--r--   0 simon      (501) staff       (20)    14576 2024-02-21 04:11:21.000000 Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_location_mp.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/dash_app/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:15.000000 Simba-UW-tf-dev-1.90.5/simba/dash_app/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    72715 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/dash_app/SimBA_dash_app.py
+-rw-r--r--   0 simon      (501) staff       (20)     4965 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/dash_app/run_dash_tkinter.py
+-rw-r--r--   0 simon      (501) staff       (20)    47546 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/dash_app/dash_app.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/
+-rw-r--r--   0 simon      (501) staff       (20)    14926 2024-03-29 16:15:58.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/spontaneous_alternation_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    11813 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/agg_clf_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-21 11:48:06.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    13224 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/severity_bout_based_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    39110 2024-03-19 12:54:07.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/interpolation_smoothing.py
+-rw-r--r--   0 simon      (501) staff       (20)    10968 2024-02-21 19:10:40.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/directing_animal_to_bodypart.py
+-rw-r--r--   0 simon      (501) staff       (20)     9580 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/timebins_clf_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    20617 2024-04-18 21:13:37.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/fsttc_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     4793 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/boolean_conditional_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     7117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/interpolate_pose.py
+-rw-r--r--   0 simon      (501) staff       (20)    15989 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/directing_other_animals_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     8957 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/gibbs_sampler.py
+-rw-r--r--   0 simon      (501) staff       (20)    10054 2024-04-04 16:23:22.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/timebins_movement_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     5255 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/severity_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    18517 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/pup_retrieval_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     3118 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/pybursts_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    13660 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/severity_frame_based_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     8738 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/mutual_exclusivity_corrector.py
+-rw-r--r--   0 simon      (501) staff       (20)    12919 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/kleinberg_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    10196 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/data_processors/movement_calculator.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/model/
+-rw-r--r--   0 simon      (501) staff       (20)    23782 2024-04-16 15:02:05.000000 Simba-UW-tf-dev-1.90.5/simba/model/train_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)     4969 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/model/inference_batch.py
+-rw-r--r--   0 simon      (501) staff       (20)    14036 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/model/train_multiclass_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)     3937 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/model/inference_multiclass_batch.py
+-rw-r--r--   0 simon      (501) staff       (20)    15931 2024-02-20 14:30:06.000000 Simba-UW-tf-dev-1.90.5/simba/model/grid_search_multiclass_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:19.000000 Simba-UW-tf-dev-1.90.5/simba/model/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    16987 2024-02-22 11:58:09.000000 Simba-UW-tf-dev-1.90.5/simba/model/grid_search_rf.py
+-rw-r--r--   0 simon      (501) staff       (20)     3768 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/model/inference_validation.py
+-rw-r--r--   0 simon      (501) staff       (20)     6872 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/model/train_multilabel_rf.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/
+-rw-r--r--   0 simon      (501) staff       (20)    11164 2024-04-25 16:23:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_time_bin_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-25 14:48:22.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    50018 2024-04-24 14:43:27.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_define.py
+-rw-r--r--   0 simon      (501) staff       (20)     3616 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_reset.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     9876 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_size_standardizer.py
+-rw-r--r--   0 simon      (501) staff       (20)    20511 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)    15408 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_feature_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)     4386 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_multiply.py
+-rw-r--r--   0 simon      (501) staff       (20)     2313 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_size_calculations.py
+-rw-r--r--   0 simon      (501) staff       (20)     3716 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_zoom.py
+-rw-r--r--   0 simon      (501) staff       (20)    12313 2024-04-25 16:23:13.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_directing_analyzer.py
+-rw-r--r--   0 simon      (501) staff       (20)    11974 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_move_shape.py
+-rw-r--r--   0 simon      (501) staff       (20)     5470 2024-02-21 03:51:46.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_menus.py
+-rw-r--r--   0 simon      (501) staff       (20)    16129 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_clf_calculator.py
+-rw-r--r--   0 simon      (501) staff       (20)    29612 2024-04-24 14:39:14.000000 Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_image.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/
+-rw-r--r--   0 simon      (501) staff       (20)    10711 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/sleap_csv_importer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/misc/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:31.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/misc/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     8084 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/misc/apt_trk_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     2577 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/read_DANNCE_mat.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-22 19:49:42.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)    14268 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/sleap_h5_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     8161 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/madlc_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-20 21:35:22.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/sleap_slp_importer.py
+-rw-r--r--   0 simon      (501) staff       (20)     8645 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/import_mars.py
+-rw-r--r--   0 simon      (501) staff       (20)     7464 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/dlc_importer_csv.py
+-rw-r--r--   0 simon      (501) staff       (20)     8417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_importers/trk_importer.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/
+-rw-r--r--   0 simon      (501) staff       (20)     8196 2024-03-19 18:18:43.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/bp_names/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:10.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/bp_names/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     4485 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/bp_names/bp_names.csv
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/no_animals/
+-rw-r--r--   0 simon      (501) staff       (20)       27 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/no_animals/no_animals.csv
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:18.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/no_animals/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:05.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/__init__.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/configuration_names/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:47:14.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/configuration_names/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)      273 2024-03-04 19:10:54.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/configuration_names/pose_config_names.csv
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/
+-rw-r--r--   0 simon      (501) staff       (20)    39805 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/8.png
+-rw-r--r--   0 simon      (501) staff       (20)    62501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/9.png
+-rw-r--r--   0 simon      (501) staff       (20)     6172 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/12.png
+-rw-r--r--   0 simon      (501) staff       (20)    34231 2024-02-20 18:50:39.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/13.png
+-rw-r--r--   0 simon      (501) staff       (20)    69501 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/11.png
+-rw-r--r--   0 simon      (501) staff       (20)    69410 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/10.png
+-rw-r--r--   0 simon      (501) staff       (20)    16000 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/4.png
+-rw-r--r--   0 simon      (501) staff       (20)    28150 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/5.png
+-rw-r--r--   0 simon      (501) staff       (20)    31140 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/7.png
+-rw-r--r--   0 simon      (501) staff       (20)    30634 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/6.png
+-rw-r--r--   0 simon      (501) staff       (20)    15417 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/2.png
+-rw-r--r--   0 simon      (501) staff       (20)    15786 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/3.png
+-rw-r--r--   0 simon      (501) staff       (20)    18939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/1.png
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/
+-rw-r--r--   0 simon      (501) staff       (20)   119697 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/video_processing.py
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-03-26 15:01:23.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     5577 2024-04-08 11:29:52.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/roi_selector_circle.py
+-rw-r--r--   0 simon      (501) staff       (20)     9073 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/px_to_mm.py
+-rw-r--r--   0 simon      (501) staff       (20)    35053 2024-02-26 15:42:07.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/batch_process_menus.py
+-rw-r--r--   0 simon      (501) staff       (20)    11439 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/multi_cropper.py
+-rw-r--r--   0 simon      (501) staff       (20)     3066 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/extract_frames.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     6598 2024-02-26 21:50:01.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/roi_selector.py
+-rw-r--r--   0 simon      (501) staff       (20)    10007 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/calculate_px_dist.py
+-rw-r--r--   0 simon      (501) staff       (20)     5963 2024-02-27 21:31:05.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/roi_selector_polygon.py
+-rw-r--r--   0 simon      (501) staff       (20)     4926 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/extract_seqframes.py
+-rw-r--r--   0 simon      (501) staff       (20)    15117 2024-04-11 20:42:04.000000 Simba-UW-tf-dev-1.90.5/simba/video_processors/batch_process_create_ffmpeg_commands.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/outlier_tools/
+-rw-r--r--   0 simon      (501) staff       (20)     7837 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_movement.py
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/outlier_tools/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    14462 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_location_advanced.py
+-rw-r--r--   0 simon      (501) staff       (20)    13117 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_movement_advanced.py
+-rw-r--r--   0 simon      (501) staff       (20)    10396 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_location.py
+-rw-r--r--   0 simon      (501) staff       (20)     2751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/outlier_tools/skip_outlier_correction.py
+-rw-r--r--   0 simon      (501) staff       (20)    82082 2024-04-15 18:43:27.000000 Simba-UW-tf-dev-1.90.5/simba/SimBA.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/unsupervised/
+-rw-r--r--   0 simon      (501) staff       (20)   109483 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/unsupervised/model_names.parquet
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:36.000000 Simba-UW-tf-dev-1.90.5/simba/assets/unsupervised/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/unsupervised/features.csv
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/
+-rw-r--r--   0 simon      (501) staff       (20)     1177 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/down_arrow.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     1733 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/intruder_shape.jpg
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/feature_categories/
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:25.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/feature_categories/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    17420 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/feature_categories/shap_feature_categories.csv
+-rw-r--r--   0 simon      (501) staff       (20)     1665 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_shape.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     2415 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_intruder_shape.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     2012 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/animal_distances.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     4422 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/baseline_scale.jpg
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:21.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)   353824 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/ubuntu.regular.ttf
+-rw-r--r--   0 simon      (501) staff       (20)     6672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/side_scale.jpg
+-rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/UbuntuMono-Regular.ttf
+-rw-r--r--   0 simon      (501) staff       (20)     2737 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/side_scale_5.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     1785 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/intruder_movement.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     1435 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_movement.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     3134 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/color_bar.jpg
+-rw-r--r--   0 simon      (501) staff       (20)     2120 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_intruder_movement.jpg
+-rw-r--r--   0 simon      (501) staff       (20)    10244 2024-04-09 23:07:16.000000 Simba-UW-tf-dev-1.90.5/simba/assets/.DS_Store
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/lookups/
+-rw-r--r--   0 simon      (501) staff       (20)   270783 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/lookups/model_names.parquet
+-rw-r--r--   0 simon      (501) staff       (20)     2987 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/lookups/feature_extraction_headers.csv
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:11.000000 Simba-UW-tf-dev-1.90.5/simba/assets/lookups/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    26256 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/lookups/critical_values_05.pickle
+-rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/lookups/features.csv
+-rw-r--r--   0 simon      (501) staff       (20)    14175 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/lookups/unsupervised_example_x.csv
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:41:54.000000 Simba-UW-tf-dev-1.90.5/simba/assets/__init__.py
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/stl/
+-rw-r--r--   0 simon      (501) staff       (20)   551576 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/stl/operant_tray.stl
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:31.000000 Simba-UW-tf-dev-1.90.5/simba/assets/stl/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)    67647 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/stl/operant_lever.stl
+-rw-r--r--   0 simon      (501) staff       (20)    92896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/stl/operant_walls.stl
+-rw-r--r--   0 simon      (501) staff       (20)  4759984 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/stl/grid_floor.stl
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/
+-rw-r--r--   0 simon      (501) staff       (20)   489479 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/splash_2024.mp4
+-rw-r--r--   0 simon      (501) staff       (20)    79863 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/bg_2024.png
+-rw-r--r--   0 simon      (501) staff       (20)   399272 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/about_me.png
+-rw-r--r--   0 simon      (501) staff       (20)   117108 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/splash.mp4
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:45:02.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)   322242 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/bg_2.png
+-rw-r--r--   0 simon      (501) staff       (20)      165 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/~$splash.pptx
+-rw-r--r--   0 simon      (501) staff       (20)    69267 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/splash.pptx
+-rw-r--r--   0 simon      (501) staff       (20)   204362 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/img/bg.png
+-rw-r--r--   0 simon      (501) staff       (20)   189004 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/UbuntuMono-Regular.ttf
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/
+-rw-r--r--   0 simon      (501) staff       (20)     1350 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/factory.png
+-rw-r--r--   0 simon      (501) staff       (20)     1413 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/cluster.png
+-rw-r--r--   0 simon      (501) staff       (20)     1340 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/load.png
+-rw-r--r--   0 simon      (501) staff       (20)     4507 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/gif.png
+-rw-r--r--   0 simon      (501) staff       (20)     4566 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/pose.png
+-rw-r--r--   0 simon      (501) staff       (20)     1943 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/features.png
+-rw-r--r--   0 simon      (501) staff       (20)     6148 2024-04-09 15:42:22.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/.DS_Store
+-rw-r--r--   0 simon      (501) staff       (20)     4896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/settings.png
+-rw-r--r--   0 simon      (501) staff       (20)     2090 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/stopwatch.png
+-rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/link.png
+-rw-r--r--   0 simon      (501) staff       (20)    14250 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/dash_simba.css
+-rw-r--r--   0 simon      (501) staff       (20)      917 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/documentation.png
+-rw-r--r--   0 simon      (501) staff       (20)     4503 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/fps.png
+-rw-r--r--   0 simon      (501) staff       (20)     1299 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/dimensionality_reduction.png
+-rw-r--r--   0 simon      (501) staff       (20)     4823 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/roi.png
+-rw-r--r--   0 simon      (501) staff       (20)   171446 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/simba_logo_2.png
+-rw-r--r--   0 simon      (501) staff       (20)      920 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/superimpose.png
+-rw-r--r--   0 simon      (501) staff       (20)     1136 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/label.png
+-rw-r--r--   0 simon      (501) staff       (20)     1016 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/change.png
+-rw-r--r--   0 simon      (501) staff       (20)    59896 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/readthedocs_logo.png
+-rw-r--r--   0 simon      (501) staff       (20)     1124 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/crop.png
+-rw-r--r--   0 simon      (501) staff       (20)     2146 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/rotate.png
+-rw-r--r--   0 simon      (501) staff       (20)     1921 2024-02-26 14:29:54.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/circle.png
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:37.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     1057 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/path.png
+-rw-r--r--   0 simon      (501) staff       (20)     1148 2024-02-26 20:39:14.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/polygon.png
+-rw-r--r--   0 simon      (501) staff       (20)      950 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/clip.png
+-rw-r--r--   0 simon      (501) staff       (20)     2121 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/restart.png
+-rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/calipher.png
+-rw-r--r--   0 simon      (501) staff       (20)     1291 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/add_on.png
+-rw-r--r--   0 simon      (501) staff       (20)     4695 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/create.png
+-rw-r--r--   0 simon      (501) staff       (20)    78182 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/SimBA_logo.ico
+-rw-r--r--   0 simon      (501) staff       (20)     1067 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/print.png
+-rw-r--r--   0 simon      (501) staff       (20)     4653 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/clf.png
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/
+-rw-r--r--   0 simon      (501) staff       (20)     6027 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/mosaic.png
+-rw-r--r--   0 simon      (501) staff       (20)     5654 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/vertical.png
+-rw-r--r--   0 simon      (501) staff       (20)        0 2024-02-07 19:44:45.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/__init__.py
+-rw-r--r--   0 simon      (501) staff       (20)     5542 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/horizontal.png
+-rw-r--r--   0 simon      (501) staff       (20)     5939 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/mixed_mosaic.png
+-rw-r--r--   0 simon      (501) staff       (20)     2060 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/merge.png
+-rw-r--r--   0 simon      (501) staff       (20)     1252 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/clean.png
+-rw-r--r--   0 simon      (501) staff       (20)     4725 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/clf_2.png
+-rw-r--r--   0 simon      (501) staff       (20)     4795 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/visualize.png
+-rw-r--r--   0 simon      (501) staff       (20)     2142 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat.png
+-rw-r--r--   0 simon      (501) staff       (20)     1474 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/boris.png
+-rw-r--r--   0 simon      (501) staff       (20)     4804 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/frames.png
+-rw-r--r--   0 simon      (501) staff       (20)     2425 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/video.png
+-rw-r--r--   0 simon      (501) staff       (20)     2089 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/sample.png
+-rw-r--r--   0 simon      (501) staff       (20)     1471 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/metrics.png
+-rw-r--r--   0 simon      (501) staff       (20)     4555 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/grey.png
+-rw-r--r--   0 simon      (501) staff       (20)      930 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/exit.png
+-rw-r--r--   0 simon      (501) staff       (20)     4751 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/outlier.png
+-rw-r--r--   0 simon      (501) staff       (20)     4392 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/clahe.png
+-rw-r--r--   0 simon      (501) staff       (20)     4637 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/trash.png
+-rw-r--r--   0 simon      (501) staff       (20)     1239 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/about.png
+-rw-r--r--   0 simon      (501) staff       (20)     4666 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/convert.png
+-rw-r--r--   0 simon      (501) staff       (20)    93229 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/SimBA_logo.icns
+-rw-r--r--   0 simon      (501) staff       (20)      991 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/reorganize.png
+-rw-r--r--   0 simon      (501) staff       (20)     4784 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/browse.png
+-rw-r--r--   0 simon      (501) staff       (20)    30707 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/SimBA_logo.png
+-rw-r--r--   0 simon      (501) staff       (20)     2293 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/ethovision.png
+-rw-r--r--   0 simon      (501) staff       (20)     1018 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/icons/close.png
+-rw-r--r--   0 simon      (501) staff       (20)    13672 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/dash_simba_base.css
+-rw-r--r--   0 simon      (501) staff       (20)    31812 2024-02-07 18:56:19.000000 Simba-UW-tf-dev-1.90.5/simba/assets/TheGoldenLab.PNG
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/
+-rw-r--r--   0 simon      (501) staff       (20)     2797 2024-04-25 17:45:45.000000 Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/PKG-INFO
+-rw-r--r--   0 simon      (501) staff       (20)    23493 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/SOURCES.txt
+-rw-r--r--   0 simon      (501) staff       (20)       44 2024-04-25 17:45:45.000000 Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/entry_points.txt
+-rw-r--r--   0 simon      (501) staff       (20)      797 2024-04-25 17:45:45.000000 Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/requires.txt
+-rw-r--r--   0 simon      (501) staff       (20)        6 2024-04-25 17:45:45.000000 Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/top_level.txt
+-rw-r--r--   0 simon      (501) staff       (20)        1 2024-04-25 17:45:45.000000 Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/dependency_links.txt
+-rw-r--r--   0 simon      (501) staff       (20)    35127 2024-02-07 18:56:10.000000 Simba-UW-tf-dev-1.90.5/LICENSE
+drwxr-xr-x   0 simon      (501) staff       (20)        0 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/tests/
+-rw-r--r--   0 simon      (501) staff       (20)     4753 2024-04-11 20:40:04.000000 Simba-UW-tf-dev-1.90.5/tests/test_data_processors.py
+-rw-r--r--   0 simon      (501) staff       (20)    13415 2024-03-01 16:43:04.000000 Simba-UW-tf-dev-1.90.5/tests/test_circlular_stats.py
+-rw-r--r--   0 simon      (501) staff       (20)    13399 2024-04-11 20:36:51.000000 Simba-UW-tf-dev-1.90.5/tests/test_stats.py
+-rw-r--r--   0 simon      (501) staff       (20)    11863 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_train_model_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     6525 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_feature_extraction_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     1739 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_utils_data.py
+-rw-r--r--   0 simon      (501) staff       (20)     8120 2024-03-01 19:06:25.000000 Simba-UW-tf-dev-1.90.5/tests/test_config_reader_mixin.py
+-rw-r--r--   0 simon      (501) staff       (20)     1070 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_outlier_correctors.py
+-rw-r--r--   0 simon      (501) staff       (20)     4435 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_visualize_directing_animals.py
+-rw-r--r--   0 simon      (501) staff       (20)     1596 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_featurizers.py
+-rw-r--r--   0 simon      (501) staff       (20)     8570 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_video_processors.py
+-rw-r--r--   0 simon      (501) staff       (20)     3554 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_thirdparty_appenders.py
+-rw-r--r--   0 simon      (501) staff       (20)     3021 2024-02-07 18:56:20.000000 Simba-UW-tf-dev-1.90.5/tests/test_validation_clips.py
+-rw-r--r--   0 simon      (501) staff       (20)     3910 2024-04-25 13:56:16.000000 Simba-UW-tf-dev-1.90.5/tests/test_roi_tools.py
+-rw-r--r--   0 simon      (501) staff       (20)      318 2024-03-04 20:16:28.000000 Simba-UW-tf-dev-1.90.5/MANIFEST.in
+-rw-r--r--   0 simon      (501) staff       (20)    18478 2024-04-17 19:58:21.000000 Simba-UW-tf-dev-1.90.5/README.md
+-rw-r--r--   0 simon      (501) staff       (20)     1426 2024-04-25 17:45:44.000000 Simba-UW-tf-dev-1.90.5/setup.py
+-rw-r--r--   0 simon      (501) staff       (20)       38 2024-04-25 17:45:46.000000 Simba-UW-tf-dev-1.90.5/setup.cfg
```

### Comparing `Simba-UW-tf-dev-1.90.4/PKG-INFO` & `Simba-UW-tf-dev-1.90.5/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Simba-UW-tf-dev
-Version: 1.90.4
+Version: 1.90.5
 Summary: Toolkit for computer classification of behaviors in experimental animals
 Home-page: https://github.com/sgoldenlab/simba
 Author: Simon Nilsson, Jia Jie Choong, Sophia Hwang
 Author-email: sronilsson@gmail.com
 License: GNU Lesser General Public License v3 (LGPLv3)
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/ui/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/mutual_exclusivity_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/mutual_exclusivity_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/movement_analysis_time_bins_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/csv_2_parquet_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/csv_2_parquet_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/quick_path_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/append_roi_features_animals_pop_up.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,60 +1,82 @@
+__author__ = "Simon Nilsson"
+
 import os
+import threading
 from tkinter import *
+from typing import Union
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
-from simba.plotting.ez_lineplot import draw_line_plot
-from simba.utils.errors import NoFilesFoundError
-from simba.utils.read_write import find_all_videos_in_directory
-
+from simba.roi_tools.ROI_feature_analyzer import ROIFeatureCreator
+from simba.ui.tkinter_functions import CreateLabelFrameWithIcon, DropDownMenu
+from simba.utils.enums import Formats, Keys, Links
+from simba.utils.errors import NoROIDataError
 
-class QuickLineplotPopup(PopUpMixin, ConfigReader):
-    def __init__(self, config_path: str):
-        PopUpMixin.__init__(self, title="SIMPLE LINE PLOT")
+class AppendROIFeaturesByAnimalPopUp(ConfigReader, PopUpMixin):
+    def __init__(self, config_path: Union[str, os.PathLike]):
         ConfigReader.__init__(self, config_path=config_path)
-        video_filepaths = find_all_videos_in_directory(
-            directory=os.path.join(self.project_path, "videos")
-        )
-        self.video_files = [os.path.basename(x) for x in video_filepaths]
-        if len(self.video_files) == 0:
-            raise NoFilesFoundError(
-                msg="SIMBA ERROR: No files detected in the project_folder/videos directory.",
+        if not os.path.isfile(self.roi_coordinates_path):
+            raise NoROIDataError(
+                msg=f"SIMBA ERROR: No ROIs have been defined. Please define ROIs before appending ROI-based features (no data file found at path {self.roi_coordinates_path})",
                 source=self.__class__.__name__,
             )
 
-        self.all_body_parts = []
-        for animal, bp_cords in self.animal_bp_dict.items():
-            for bp_dim, bp_data in bp_cords.items():
-                self.all_body_parts.extend(([x[:-2] for x in bp_data]))
-
-        self.settings_frm = LabelFrame(self.main_frm, text="Settings")
-        self.settings_frm.grid(row=0, column=0, sticky=NW)
-
-        self.video_lbl = Label(self.settings_frm, text="Video: ")
-        self.chosen_video_val = StringVar(value=self.video_files[0])
-        self.chosen_video_dropdown = OptionMenu(
-            self.settings_frm, self.chosen_video_val, *self.video_files
-        )
-        self.video_lbl.grid(row=0, column=0, sticky=NW)
-        self.chosen_video_dropdown.grid(row=0, column=1, sticky=NW)
-
-        self.body_part_lbl = Label(self.settings_frm, text="Body-part: ")
-        self.chosen_bp_val = StringVar(value=self.all_body_parts[0])
-        self.choose_bp_dropdown = OptionMenu(
-            self.settings_frm, self.chosen_bp_val, *self.all_body_parts
-        )
-        self.body_part_lbl.grid(row=1, column=0, sticky=NW)
-        self.choose_bp_dropdown.grid(row=1, column=1, sticky=NW)
-
-        run_btn = Button(
-            self.settings_frm,
-            text="Create path plot",
-            command=lambda: draw_line_plot(
-                self.config_path, self.chosen_video_val.get(), self.chosen_bp_val.get()
-            ),
+        PopUpMixin.__init__(
+            self, title="APPEND ROI FEATURES: BY ANIMALS", size=(400, 400)
+        )
+        self.animal_cnt_frm = CreateLabelFrameWithIcon(
+            parent=self.main_frm,
+            header="SELECT NUMBER OF ANIMALS",
+            icon_name=Keys.DOCUMENTATION.value,
+            icon_link=Links.ROI_FEATURES.value,
         )
-        run_btn.grid(row=2, column=1, pady=10)
+        self.animal_cnt_dropdown = DropDownMenu(
+            self.animal_cnt_frm,
+            "# of animals",
+            list(range(1, self.animal_cnt + 1)),
+            labelwidth=20,
+        )
+        self.animal_cnt_dropdown.setChoices(1)
+        self.animal_cnt_confirm_btn = Button(
+            self.animal_cnt_frm,
+            text="Confirm",
+            command=lambda: self.create_settings_frm(),
+        )
+        self.animal_cnt_frm.grid(row=0, column=0, sticky=NW)
+        self.animal_cnt_dropdown.grid(row=0, column=0, sticky=NW)
+        self.animal_cnt_confirm_btn.grid(row=0, column=1, sticky=NW)
         self.main_frm.mainloop()
 
+    def create_settings_frm(self):
+        if hasattr(self, "setting_frm"):
+            self.setting_frm.destroy()
+            self.body_part_frm.destroy()
+        self.setting_frm = LabelFrame(
+            self.main_frm, text="SETTINGS", font=Formats.LABELFRAME_HEADER_FORMAT.value
+        )
+        self.choose_bp_frm(parent=self.setting_frm, bp_options=self.body_parts_lst)
+        self.setting_frm.grid(row=1, column=0, sticky=NW)
+        self.create_run_frm(run_function=self.run)
+
+    def run(self):
+        body_parts = []
+        for bp_cnt, bp_dropdown in self.body_parts_dropdowns.items():
+            body_parts.append(bp_dropdown.getChoices())
+
+        roi_feature_creator = ROIFeatureCreator(
+            config_path=self.config_path,
+            body_parts=body_parts,
+            data_path=None,
+            append_data=True,
+        )
+        threading.Thread(target=roi_feature_creator.run()).start()
+        self.root.destroy()
+
+
+# AppendROIFeaturesByAnimalPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/open_field_below/project_folder/project_config.ini')
+
+
+# AppendROIFeaturesByAnimalPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/locomotion/project_folder/project_config.ini')
+
 
-# _ = QuickLineplotPopup(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+# AppendROIFeaturesByAnimalPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/batch_preprocess_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/batch_preprocess_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/heatmap_location_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/heatmap_location_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_probability_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_probability_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/movement_analysis_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/movement_analysis_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/set_machine_model_parameters_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/path_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/path_plot_pop_up.py`

 * *Files 2% similar despite different names*

```diff
@@ -14,17 +14,16 @@
                                         Entry_Box)
 from simba.utils.checks import (check_if_filepath_list_is_empty,
                                 check_if_string_value_is_valid_video_timestamp,
                                 check_if_valid_rgb_str, check_int,
                                 check_that_hhmmss_start_is_before_end)
 from simba.utils.enums import Formats, Keys, Links, Paths
 from simba.utils.errors import FrameRangeError
-from simba.utils.read_write import get_file_name_info_in_directory
 from simba.utils.lookups import get_color_dict
-
+from simba.utils.read_write import get_file_name_info_in_directory
 
 
 class PathPlotPopUp(PopUpMixin, ConfigReader):
     def __init__(self, config_path: Union[str, os.PathLike]):
         ConfigReader.__init__(self, config_path=config_path)
         self.data_path = os.path.join(
             self.project_path, Paths.MACHINE_RESULTS_DIR.value
@@ -459,15 +458,19 @@
             check_int(
                 name="PATH FONT SIZE", value=self.font_size.entry_get, min_value=1
             )
             check_int(
                 name="FONT THICKNESS", value=self.font_thickness.entry_get, min_value=1
             )
             if self.bg_clr_dropdown.getChoices() == "Video - static frame":
-                check_int(name="Static frame index", value=self.static_frm_index_eb.entry_get, min_value=0,)
+                check_int(
+                    name="Static frame index",
+                    value=self.static_frm_index_eb.entry_get,
+                    min_value=0,
+                )
                 bg_clr = {
                     "type": "static",
                     "opacity": int(
                         "".join(
                             c
                             for c in self.bg_opacity_dropdown.getChoices()
                             if c.isdigit()
@@ -499,35 +502,46 @@
                 "bg color": bg_clr,
                 "clf locations": self.include_clf_locations_var.get(),
             }
 
             if self.max_prior_lines_dropdown.getChoices() == "Entire video":
                 style_attr["max lines"] = "entire video"
             else:
-                check_int(name="PATH MAX LINES", value=self.max_lines_entry.entry_get, min_value=1)
+                check_int(
+                    name="PATH MAX LINES",
+                    value=self.max_lines_entry.entry_get,
+                    min_value=1,
+                )
                 style_attr["max lines"] = int(self.max_lines_entry.entry_get)
 
         animal_attr = {}
         for cnt, (key, value) in enumerate(self.bp_colors.items()):
-            if cnt not in animal_attr.keys(): animal_attr[cnt] = {}
+            if cnt not in animal_attr.keys():
+                animal_attr[cnt] = {}
             clr = value.getChoices()
             if clr == "Custom":
                 clr = self.custom_rgb_selections[cnt].entry_get
                 clr = check_if_valid_rgb_str(input=clr)
-                animal_attr[cnt]['color'] = clr
+                animal_attr[cnt]["color"] = clr
             else:
-                animal_attr[cnt]['color'] = get_color_dict()[value.getChoices()]
+                animal_attr[cnt]["color"] = get_color_dict()[value.getChoices()]
         for cnt, (key, value) in enumerate(self.bp_dropdowns.items()):
-            if cnt not in animal_attr.keys(): animal_attr[cnt] = {}
-            animal_attr[cnt]['bp'] = value.getChoices()
+            if cnt not in animal_attr.keys():
+                animal_attr[cnt] = {}
+            animal_attr[cnt]["bp"] = value.getChoices()
 
         self.slicing = None
         if self.slice_var.get():
-            check_if_string_value_is_valid_video_timestamp(value=self.video_start_time_entry.entry_get, name="Video slicing START TIME")
-            check_if_string_value_is_valid_video_timestamp(value=self.video_end_time_entry.entry_get, name="Video slicing END TIME")
+            check_if_string_value_is_valid_video_timestamp(
+                value=self.video_start_time_entry.entry_get,
+                name="Video slicing START TIME",
+            )
+            check_if_string_value_is_valid_video_timestamp(
+                value=self.video_end_time_entry.entry_get, name="Video slicing END TIME"
+            )
             if (
                 self.video_start_time_entry.entry_get
                 == self.video_end_time_entry.entry_get
             ):
                 raise FrameRangeError(
                     msg="The sliced start and end times cannot be identical",
                     source=self.__class__.__name__,
@@ -543,50 +557,56 @@
             }
 
         clf_attr = None
         if self.include_clf_locations_var.get():
             clf_attr = {}
             for cnt, (key, value) in enumerate(self.clf_name.items()):
                 clf_attr[value.getChoices()] = {}
-                clf_attr[value.getChoices()]['color'] = get_color_dict()[self.clf_clr[cnt].getChoices()]
+                clf_attr[value.getChoices()]["color"] = get_color_dict()[
+                    self.clf_clr[cnt].getChoices()
+                ]
                 size = "".join(filter(str.isdigit, self.clf_size[cnt].getChoices()))
-                clf_attr[value.getChoices()]['size'] = int(size)
+                clf_attr[value.getChoices()]["size"] = int(size)
 
         if multiple_videos:
             data_paths = list(self.files_found_dict.values())
         else:
-            data_paths = [self.files_found_dict[self.single_video_dropdown.getChoices()]]
+            data_paths = [
+                self.files_found_dict[self.single_video_dropdown.getChoices()]
+            ]
 
         if not self.multiprocessing_var.get():
-            path_plotter = PathPlotterSingleCore(config_path=self.config_path,
-                                                 frame_setting=self.path_frames_var.get(),
-                                                 video_setting=self.path_videos_var.get(),
-                                                 last_frame=self.path_last_frm_var.get(),
-                                                 files_found=data_paths,
-                                                 input_style_attr=style_attr,
-                                                 print_animal_names=self.include_animal_names_var.get(),
-                                                 animal_attr=animal_attr,
-                                                 clf_attr=clf_attr,
-                                                 slicing=self.slicing)
+            path_plotter = PathPlotterSingleCore(
+                config_path=self.config_path,
+                frame_setting=self.path_frames_var.get(),
+                video_setting=self.path_videos_var.get(),
+                last_frame=self.path_last_frm_var.get(),
+                files_found=data_paths,
+                input_style_attr=style_attr,
+                print_animal_names=self.include_animal_names_var.get(),
+                animal_attr=animal_attr,
+                clf_attr=clf_attr,
+                slicing=self.slicing,
+            )
         else:
-            path_plotter = PathPlotterMulticore(config_path=self.config_path,
-                                                frame_setting=self.path_frames_var.get(),
-                                                video_setting=self.path_videos_var.get(),
-                                                last_frame=self.path_last_frm_var.get(),
-                                                files_found=data_paths,
-                                                input_style_attr=style_attr,
-                                                print_animal_names=self.include_animal_names_var.get(),
-                                                animal_attr=animal_attr,
-                                                clf_attr=clf_attr,
-                                                cores=int(self.multiprocess_dropdown.getChoices()),
-                                                slicing=self.slicing,
+            path_plotter = PathPlotterMulticore(
+                config_path=self.config_path,
+                frame_setting=self.path_frames_var.get(),
+                video_setting=self.path_videos_var.get(),
+                last_frame=self.path_last_frm_var.get(),
+                files_found=data_paths,
+                input_style_attr=style_attr,
+                print_animal_names=self.include_animal_names_var.get(),
+                animal_attr=animal_attr,
+                clf_attr=clf_attr,
+                cores=int(self.multiprocess_dropdown.getChoices()),
+                slicing=self.slicing,
             )
 
         threading.Thread(target=path_plotter.run()).start()
 
 
-
 # _ = PathPlotPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/beepboop174/project_folder/project_config.ini')
 
 # _ = PathPlotPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
 
 # _ = PathPlotPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/dorian_2/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/remove_roi_features_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/remove_roi_features_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/targeted_annotation_clips_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/smoothing_interpolation_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/smoothing_interpolation_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_size_standardizer_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_size_standardizer_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/visualize_pose_in_dir_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_analysis_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_analysis_pop_up.py`

 * *Files 9% similar despite different names*

```diff
@@ -86,39 +86,29 @@
         check_float(
             name="Probability threshold",
             value=self.probability_entry.entry_get,
             min_value=0.00,
             max_value=1.00,
         )
         settings["threshold"] = float(self.probability_entry.entry_get)
-        settings["body_parts"] = {}
-        self.config.set(
-            ConfigKey.ROI_SETTINGS.value,
-            ConfigKey.ROI_ANIMAL_CNT.value,
-            str(self.animal_cnt_dropdown.getChoices()),
-        )
-        self.config.set(
-            ConfigKey.ROI_SETTINGS.value,
-            ConfigKey.PROBABILITY_THRESHOLD.value,
-            str(self.probability_entry.entry_get),
-        )
+        body_parts = []
         for cnt, dropdown in self.body_parts_dropdowns.items():
-            settings["body_parts"][f"animal_{cnt + 1}_bp"] = dropdown.getChoices()
-            self.config.set(
-                "ROI settings", f"animal_{cnt + 1}_bp", str(dropdown.getChoices())
-            )
-        self.update_config()
+            body_parts.append(dropdown.getChoices())
         roi_analyzer = ROIAnalyzer(
-            ini_path=self.config_path,
-            data_path="outlier_corrected_movement_location",
+            config_path=self.config_path,
+            data_path=None,
             calculate_distances=self.calculate_distance_moved_var.get(),
             detailed_bout_data=self.detailed_roi_var.get(),
-            settings=settings,
+            threshold=float(self.probability_entry.entry_get),
+            body_parts=body_parts,
         )
         roi_analyzer.run()
         roi_analyzer.save()
         self.root.destroy()
 
 
+# _ = ROIAnalysisPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/project_config.ini')
+
+
 # ROIAnalysisPopUp(config_path='/Users/simon/Desktop/envs/simba_dev/tests/data/test_projects/mouse_open_field/project_folder/project_config.ini')
 
 # ROIAnalysisPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/outlier_settings_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/outlier_settings_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/gantt_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/gantt_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_validation_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_validation_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/severity_analysis_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/severity_analysis_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/fsttc_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/fsttc_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/kleinberg_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/kleinberg_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,62 +1,53 @@
-__author__ = "Simon Nilsson"
+__author__ = "Tzuk Polinsky"
 
 import os
 from tkinter import *
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
+from simba.plotting.directing_animals_to_bodypart_visualizer import \
+    DirectingAnimalsToBodyPartVisualizer
 from simba.plotting.directing_animals_visualizer import \
     DirectingOtherAnimalsVisualizer
 from simba.plotting.directing_animals_visualizer_mp import \
     DirectingOtherAnimalsVisualizerMultiprocess
 from simba.ui.tkinter_functions import CreateLabelFrameWithIcon, DropDownMenu
 from simba.utils.enums import Formats, Keys, Links, Paths
 from simba.utils.errors import AnimalNumberError
 from simba.utils.read_write import get_file_name_info_in_directory
 
 
-class DirectingOtherAnimalsVisualizerPopUp(PopUpMixin, ConfigReader):
+class DirectingAnimalToBodyPartVisualizerPopUp(PopUpMixin, ConfigReader):
     def __init__(self, config_path: str):
         ConfigReader.__init__(self, config_path=config_path)
-        if self.animal_cnt == 1:
-            raise AnimalNumberError(
-                msg="Cannot visualize directionality between animals in a 1 animal project.",
-                source=self.__class__.__name__,
-            )
-        PopUpMixin.__init__(self, title="CREATE ANIMAL DIRECTION VIDEOS")
+        PopUpMixin.__init__(self, title="CREATE ANIMAL DIRECTION TO BODY PART VIDEOS")
         self.color_lst = list(self.colors_dict.keys())
         self.color_lst.insert(0, "Random")
         self.size_lst = list(range(1, 11))
         self.data_path = os.path.join(self.project_path, Paths.OUTLIER_CORRECTED.value)
         self.files_found_dict = get_file_name_info_in_directory(
             directory=self.data_path, file_type=self.file_type
         )
 
         self.show_pose_var = BooleanVar(value=True)
-        self.highlight_direction_endpoints_var = BooleanVar(value=True)
         self.merge_directionality_lines_var = BooleanVar(value=False)
         self.multiprocess_var = BooleanVar(value=False)
 
         self.style_settings_frm = CreateLabelFrameWithIcon(
             parent=self.main_frm,
             header="STYLE SETTINGS",
             icon_name=Keys.DOCUMENTATION.value,
             icon_link=Links.DIRECTING_ANIMALS_PLOTS.value,
         )
         self.show_pose_cb = Checkbutton(
             self.style_settings_frm,
             text="Show pose-estimated body-parts",
             variable=self.show_pose_var,
         )
-        self.highlight_direction_endpoints_cb = Checkbutton(
-            self.style_settings_frm,
-            text="Highlight direction end-points",
-            variable=self.highlight_direction_endpoints_var,
-        )
         self.merge_directionality_lines_cb = Checkbutton(
             self.style_settings_frm,
             text="Polyfill direction lines",
             variable=self.merge_directionality_lines_var,
         )
         self.direction_clr_dropdown = DropDownMenu(
             self.style_settings_frm, "Direction color:", self.color_lst, "16"
@@ -66,28 +57,28 @@
         )
         self.line_thickness = DropDownMenu(
             self.style_settings_frm, "Line thickness:", self.size_lst, "16"
         )
         self.line_thickness.setChoices(choice=4)
         self.pose_size_dropdown.setChoices(choice=3)
         self.direction_clr_dropdown.setChoices(choice="Random")
-        multiprocess_cb = Checkbutton(
-            self.style_settings_frm,
-            text="Multi-process (faster)",
-            variable=self.multiprocess_var,
-            command=lambda: self.enable_dropdown_from_checkbox(
-                check_box_var=self.multiprocess_var,
-                dropdown_menus=[self.multiprocess_dropdown],
-            ),
-        )
-        self.multiprocess_dropdown = DropDownMenu(
-            self.style_settings_frm, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
-        )
-        self.multiprocess_dropdown.setChoices(2)
-        self.multiprocess_dropdown.disable()
+        # multiprocess_cb = Checkbutton(
+        #     self.style_settings_frm,
+        #     text="Multi-process (faster)",
+        #     variable=self.multiprocess_var,
+        #     command=lambda: self.enable_dropdown_from_checkbox(
+        #         check_box_var=self.multiprocess_var,
+        #         dropdown_menus=[self.multiprocess_dropdown],
+        #     ),
+        # )
+        # self.multiprocess_dropdown = DropDownMenu(
+        #     self.style_settings_frm, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
+        # )
+        # self.multiprocess_dropdown.setChoices(2)
+        # self.multiprocess_dropdown.disable()
 
         self.run_frm = LabelFrame(
             self.main_frm,
             text="RUN",
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             pady=5,
             padx=5,
@@ -129,21 +120,20 @@
             ),
             fg="blue",
             command=lambda: self.__create_directionality_plots(multiple_videos=True),
         )
 
         self.style_settings_frm.grid(row=0, column=0, sticky=NW)
         self.show_pose_cb.grid(row=0, column=0, sticky=NW)
-        self.highlight_direction_endpoints_cb.grid(row=1, column=0, sticky=NW)
         self.merge_directionality_lines_cb.grid(row=2, column=0, sticky=NW)
         self.direction_clr_dropdown.grid(row=3, column=0, sticky=NW)
         self.pose_size_dropdown.grid(row=4, column=0, sticky=NW)
         self.line_thickness.grid(row=5, column=0, sticky=NW)
-        multiprocess_cb.grid(row=6, column=0, sticky=NW)
-        self.multiprocess_dropdown.grid(row=6, column=1, sticky=NW)
+        # multiprocess_cb.grid(row=6, column=0, sticky=NW)
+        # self.multiprocess_dropdown.grid(row=6, column=1, sticky=NW)
 
         self.run_frm.grid(row=1, column=0, sticky=NW)
         self.run_single_video_frm.grid(row=0, column=0, sticky=NW)
         self.run_single_video_btn.grid(row=0, column=0, sticky=NW)
         self.single_video_dropdown.grid(row=0, column=1, sticky=NW)
         self.run_multiple_videos.grid(row=1, column=0, sticky=NW)
         self.run_multiple_video_btn.grid(row=0, column=0, sticky=NW)
@@ -157,31 +147,27 @@
             ]
 
         style_attr = {
             "Show_pose": self.show_pose_var.get(),
             "Pose_circle_size": int(self.pose_size_dropdown.getChoices()),
             "Direction_color": self.direction_clr_dropdown.getChoices(),
             "Direction_thickness": int(self.line_thickness.getChoices()),
-            "Highlight_endpoints": self.highlight_direction_endpoints_var.get(),
             "Polyfill": self.merge_directionality_lines_var.get(),
         }
 
         for data_path in data_paths:
-            if not self.multiprocess_var.get():
-                directing_other_animal_visualizer = DirectingOtherAnimalsVisualizer(
-                    config_path=self.config_path,
-                    data_path=data_path,
-                    style_attr=style_attr,
-                )
-            else:
-                directing_other_animal_visualizer = (
-                    DirectingOtherAnimalsVisualizerMultiprocess(
-                        config_path=self.config_path,
-                        data_path=data_path,
-                        style_attr=style_attr,
-                        core_cnt=int(self.multiprocess_dropdown.getChoices()),
-                    )
-                )
+            # if not self.multiprocess_var.get():
+            directing_other_animal_visualizer = DirectingAnimalsToBodyPartVisualizer(
+                config_path=self.config_path,
+                data_path=data_path,
+                style_attr=style_attr,
+            )
+            # else:
+            #     directing_other_animal_visualizer = (
+            #         DirectingOtherAnimalsVisualizerMultiprocess(
+            #             config_path=self.config_path,
+            #             data_path=data_path,
+            #             style_attr=style_attr,
+            #             core_cnt=int(self.multiprocess_dropdown.getChoices()),
+            #         )
+            #     )
             directing_other_animal_visualizer.run()
-
-
-# _ = DirectingOtherAnimalsVisualizerPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Two_animals_16bps/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/spontaneous_alternation_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/spontaneous_alternation_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/pose_reorganizer_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/pose_reorganizer_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/animal_directing_other_animals_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/append_roi_features_animals_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_frequentist_stats_popup.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,80 +1,101 @@
+__author__ = "Simon Nilsson"
+
 import os
 from tkinter import *
+from typing import Union
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
-from simba.roi_tools.ROI_feature_analyzer import ROIFeatureCreator
-from simba.ui.tkinter_functions import (CreateLabelFrameWithIcon, DropDownMenu,
-                                        Entry_Box)
-from simba.utils.enums import ConfigKey, Formats, Keys, Links
-from simba.utils.errors import NoROIDataError
+from simba.ui.tkinter_functions import FileSelect
+from simba.unsupervised.cluster_frequentist_calculator import \
+    ClusterFrequentistCalculator
+from simba.utils.checks import check_file_exist_and_readable
+from simba.utils.enums import Formats
 
 
-class AppendROIFeaturesByAnimalPopUp(ConfigReader, PopUpMixin):
-    def __init__(self, config_path: str):
+class ClusterFrequentistStatisticsPopUp(PopUpMixin, ConfigReader):
+    def __init__(self, config_path: Union[str, os.PathLike]):
+        PopUpMixin.__init__(self, title="CLUSTER FREQUENTIST STATISTICS")
         ConfigReader.__init__(self, config_path=config_path)
-        if not os.path.isfile(self.roi_coordinates_path):
-            raise NoROIDataError(
-                msg=f"SIMBA ERROR: No ROIs have been defined. Please define ROIs before appending ROI-based features (no data file found at path {self.roi_coordinates_path})",
-                source=self.__class__.__name__,
-            )
-        PopUpMixin.__init__(
-            self, title="APPEND ROI FEATURES: BY ANIMALS", size=(400, 400)
-        )
-        self.animal_cnt_frm = CreateLabelFrameWithIcon(
-            parent=self.main_frm,
-            header="SELECT NUMBER OF ANIMALS",
-            icon_name=Keys.DOCUMENTATION.value,
-            icon_link=Links.ROI_FEATURES.value,
-        )
-        self.animal_cnt_dropdown = DropDownMenu(
-            self.animal_cnt_frm,
-            "# of animals",
-            list(range(1, self.animal_cnt + 1)),
-            labelwidth=20,
-        )
-        self.animal_cnt_dropdown.setChoices(1)
-        self.animal_cnt_confirm_btn = Button(
-            self.animal_cnt_frm,
-            text="Confirm",
-            command=lambda: self.create_settings_frm(),
-        )
-        self.animal_cnt_frm.grid(row=0, column=0, sticky=NW)
-        self.animal_cnt_dropdown.grid(row=0, column=0, sticky=NW)
-        self.animal_cnt_confirm_btn.grid(row=0, column=1, sticky=NW)
-        self.main_frm.mainloop()
-
-    def create_settings_frm(self):
-        if hasattr(self, "setting_frm"):
-            self.setting_frm.destroy()
-            self.body_part_frm.destroy()
-        self.setting_frm = LabelFrame(
-            self.main_frm, text="SETTINGS", font=Formats.LABELFRAME_HEADER_FORMAT.value
+        self.descriptive_stats_var = BooleanVar(value=True)
+        self.kruskal_wallis_var = BooleanVar(value=True)
+        self.oneway_anova_var = BooleanVar(value=True)
+        self.tukey_var = BooleanVar(value=True)
+        self.use_scaled_var = BooleanVar(value=False)
+
+        self.data_frm = LabelFrame(
+            self.main_frm,
+            text="DATA",
+            font=Formats.LABELFRAME_HEADER_FORMAT.value,
+            fg="black",
         )
-        self.choose_bp_frm(parent=self.setting_frm, bp_options=self.body_parts_lst)
-        self.setting_frm.grid(row=1, column=0, sticky=NW)
-        self.create_run_frm(run_function=self.run)
-
-    def run(self):
-        if self.config.has_section(ConfigKey.ROI_SETTINGS.value):
-            self.config.remove_section(ConfigKey.ROI_SETTINGS.value)
-        self.config.add_section(ConfigKey.ROI_SETTINGS.value)
+        self.model_select = FileSelect(
+            self.data_frm,
+            "CLUSTERER PATH:",
+            lblwidth=25,
+            initialdir=self.project_path,
+            file_types=[("Cluster model pickle", f"*.{Formats.PICKLE.value}")],
+        )
+        self.data_frm.grid(row=0, column=0, sticky=NW)
+        self.model_select.grid(row=0, column=0, sticky=NW)
 
-        for bp_cnt, bp_dropdown in self.body_parts_dropdowns.items():
-            self.config.set(
-                ConfigKey.ROI_SETTINGS.value,
-                f"animal_{bp_cnt+1}_bp",
-                bp_dropdown.getChoices(),
-            )
-        with open(self.config_path, "w") as f:
-            self.config.write(f)
+        self.stats_frm = LabelFrame(
+            self.main_frm,
+            text="STATISTICS",
+            font=Formats.LABELFRAME_HEADER_FORMAT.value,
+            fg="black",
+        )
+        self.descriptive_stats_cb = Checkbutton(
+            self.stats_frm,
+            text="CLUSTER DESCRIPTIVE STATISTICS",
+            variable=self.descriptive_stats_var,
+        )
+        self.oneway_anova_cb = Checkbutton(
+            self.stats_frm,
+            text="CLUSTER FEATURE ONE-WAY ANOVA",
+            variable=self.oneway_anova_var,
+        )
+        self.feature_tukey_posthoc_cb = Checkbutton(
+            self.stats_frm,
+            text="CLUSTER FEATURE POST-HOC (TUKEY)",
+            variable=self.tukey_var,
+        )
+        self.use_scaled_cb = Checkbutton(
+            self.stats_frm,
+            text="USE SCALED FEATURE VALUES",
+            variable=self.use_scaled_var,
+        )
 
-        roi_feature_creator = ROIFeatureCreator(config_path=self.config_path)
-        roi_feature_creator.run()
-        roi_feature_creator.save()
+        self.kruskal_wallis_cb = Checkbutton(
+            self.stats_frm,
+            text="KRUSKAL-WALLIS",
+            variable=self.kruskal_wallis_var,
+        )
 
+        self.stats_frm.grid(row=1, column=0, sticky=NW)
+        self.descriptive_stats_cb.grid(row=0, column=0, sticky=NW)
+        self.oneway_anova_cb.grid(row=1, column=0, sticky=NW)
+        self.kruskal_wallis_cb.grid(row=2, column=0, sticky=NW)
+        self.feature_tukey_posthoc_cb.grid(row=3, column=0, sticky=NW)
+        self.use_scaled_cb.grid(row=4, column=0, sticky=NW)
+        self.create_run_frm(run_function=self.run)
+        self.main_frm.mainloop()
 
-# AppendROIFeaturesByAnimalPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/locomotion/project_folder/project_config.ini')
+    def run(self):
+        check_file_exist_and_readable(self.model_select.file_path)
+        settings = {
+            "scaled": self.use_scaled_var.get(),
+            "anova": self.oneway_anova_var.get(),
+            "tukey_posthoc": self.tukey_var.get(),
+            "kruskal_wallis": self.kruskal_wallis_var.get(),
+            "descriptive_statistics": self.descriptive_stats_var.get(),
+        }
+        calculator = ClusterFrequentistCalculator(
+            config_path=self.config_path,
+            data_path=self.model_select.file_path,
+            settings=settings,
+        )
+        calculator.run()
 
 
-# AppendROIFeaturesByAnimalPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+# _ = ClusterFrequentistStatisticsPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/NG_Unsupervised/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_by_timebins_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_by_timebins_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/heatmap_clf_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/heatmap_clf_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/data_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/data_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_features_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_features_plot_pop_up.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,37 +1,44 @@
 __author__ = "Simon Nilsson"
 
-import multiprocessing
+
+import threading
 from tkinter import *
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
 from simba.plotting.ROI_feature_visualizer import ROIfeatureVisualizer
 from simba.plotting.ROI_feature_visualizer_mp import \
     ROIfeatureVisualizerMultiprocess
 from simba.ui.tkinter_functions import (CreateLabelFrameWithIcon, DropDownMenu,
                                         Entry_Box)
 from simba.utils.checks import check_float
 from simba.utils.enums import ConfigKey, Formats, Keys, Links
 from simba.utils.errors import NoFilesFoundError
-from simba.utils.read_write import (find_files_of_filetypes_in_directory,
+from simba.utils.read_write import (find_all_videos_in_directory,
+                                    find_files_of_filetypes_in_directory,
                                     get_fn_ext)
 
+ROI_CENTERS = "roi_centers"
+ROI_EAR_TAGS = "roi_ear_tags"
+DIRECTIONALITY = "directionality"
+DIRECTIONALITY_STYLE = "directionality_style"
+BORDER_COLOR = "border_color"
+POSE = "pose_estimation"
+ANIMAL_NAMES = "animal_names"
+
 
 class VisualizeROIFeaturesPopUp(PopUpMixin, ConfigReader):
     def __init__(self, config_path: str):
         PopUpMixin.__init__(self, title="VISUALIZE ROI FEATURES", size=(400, 500))
         ConfigReader.__init__(self, config_path=config_path)
-        self.video_list = []
-        video_file_paths = find_files_of_filetypes_in_directory(
-            directory=self.video_dir, extensions=[".mp4", ".avi"]
-        )
-        for file_path in video_file_paths:
-            _, video_name, ext = get_fn_ext(filepath=file_path)
-            self.video_list.append(video_name + ext)
+        self.video_file_paths = find_all_videos_in_directory(
+            directory=self.video_dir, as_dict=True
+        )
+        self.video_list = [k for k in self.video_file_paths.keys()]
 
         if len(self.video_list) == 0:
             raise NoFilesFoundError(
                 msg="SIMBA ERROR: No videos in SimBA project. Import videos into you SimBA project to visualize ROI features.",
                 source=self.__class__.__name__,
             )
 
@@ -54,27 +61,35 @@
             self.settings_frm, "Border color:", list(self.colors_dict.keys()), "12"
         )
         self.border_clr_dropdown.setChoices("Black")
 
         self.show_pose_var = BooleanVar(value=True)
         self.show_ROI_centers_var = BooleanVar(value=True)
         self.show_ROI_tags_var = BooleanVar(value=True)
+        self.show_animal_names_var = BooleanVar(value=False)
         self.show_direction_var = BooleanVar(value=False)
         self.multiprocess_var = BooleanVar(value=False)
         show_pose_cb = Checkbutton(
             self.settings_frm, text="Show pose", variable=self.show_pose_var
         )
         show_roi_center_cb = Checkbutton(
             self.settings_frm,
             text="Show ROI centers",
             variable=self.show_ROI_centers_var,
         )
         show_roi_tags_cb = Checkbutton(
             self.settings_frm, text="Show ROI ear tags", variable=self.show_ROI_tags_var
         )
+
+        show_animal_names_cb = Checkbutton(
+            self.settings_frm,
+            text="Show animal names",
+            variable=self.show_animal_names_var,
+        )
+
         show_roi_directionality_cb = Checkbutton(
             self.settings_frm,
             text="Show directionality",
             variable=self.show_direction_var,
             command=lambda: self.enable_dropdown_from_checkbox(
                 check_box_var=self.show_direction_var,
                 dropdown_menus=[self.directionality_type_dropdown],
@@ -93,17 +108,17 @@
         self.multiprocess_dropdown = DropDownMenu(
             self.settings_frm, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
         )
         self.multiprocess_dropdown.setChoices(2)
         self.multiprocess_dropdown.disable()
 
         self.directionality_type_dropdown = DropDownMenu(
-            self.settings_frm, "Direction type:", ["Funnel", "Lines"], "12"
+            self.settings_frm, "Direction type:", ["funnel", "Lines"], "12"
         )
-        self.directionality_type_dropdown.setChoices(choice="Funnel")
+        self.directionality_type_dropdown.setChoices(choice="funnel")
         self.directionality_type_dropdown.disable()
 
         self.body_parts_frm = LabelFrame(
             self.main_frm,
             text="SELECT BODY-PARTS",
             pady=10,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
@@ -115,15 +130,14 @@
             list(range(1, self.animal_cnt + 1)),
             "20",
             com=lambda x: self.__populate_bp_dropdown(bp_cnt=x),
         )
         self.animal_cnt_dropdown.setChoices(1)
         self.__populate_bp_dropdown(bp_cnt=1)
         self.animal_cnt_dropdown.grid(row=0, column=0, sticky=NW)
-
         self.single_video_frm = LabelFrame(
             self.main_frm,
             text="Visualize ROI features on SINGLE video",
             pady=10,
             padx=10,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
@@ -142,31 +156,32 @@
             self.main_frm,
             text="Visualize ROI features on ALL videos",
             pady=10,
             padx=10,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
         )
+
         self.all_videos_btn = Button(
             self.all_videos_frm,
             text="Generate ROI visualization on ALL videos",
             command=lambda: self.run(multiple=True),
         )
-
         self.settings_frm.grid(row=0, column=0, sticky=NW)
         self.threshold_entry_box.grid(row=0, sticky=NW)
         threshold_label.grid(row=1, sticky=NW)
         self.border_clr_dropdown.grid(row=2, sticky=NW)
         show_pose_cb.grid(row=3, sticky=NW)
         show_roi_center_cb.grid(row=4, sticky=NW)
         show_roi_tags_cb.grid(row=5, sticky=NW)
-        show_roi_directionality_cb.grid(row=6, sticky=NW)
-        self.directionality_type_dropdown.grid(row=6, column=1, sticky=NW)
-        multiprocess_cb.grid(row=7, column=0, sticky=NW)
-        self.multiprocess_dropdown.grid(row=7, column=1, sticky=NW)
+        show_animal_names_cb.grid(row=6, sticky=NW)
+        show_roi_directionality_cb.grid(row=7, sticky=NW)
+        self.directionality_type_dropdown.grid(row=7, column=1, sticky=NW)
+        multiprocess_cb.grid(row=8, column=0, sticky=NW)
+        self.multiprocess_dropdown.grid(row=8, column=1, sticky=NW)
         self.body_parts_frm.grid(row=1, column=0, sticky=NW)
         self.single_video_frm.grid(row=2, sticky=W)
         self.single_video_dropdown.grid(row=0, sticky=W)
         self.single_video_btn.grid(row=1, pady=12)
         self.all_videos_frm.grid(row=3, sticky=W, pady=10)
         self.all_videos_btn.grid(row=0, sticky=W)
 
@@ -192,87 +207,51 @@
     def run(self, multiple: bool):
         check_float(
             name="Body-part probability threshold",
             value=self.threshold_entry_box.entry_get,
             min_value=0.0,
             max_value=1.0,
         )
-        self.config.set(
-            "ROI settings",
-            "probability_threshold",
-            str(self.threshold_entry_box.entry_get),
-        )
-        with open(self.config_path, "w") as f:
-            self.config.write(f)
-
-        if self.config.has_section(ConfigKey.ROI_SETTINGS.value):
-            self.config.remove_section(ConfigKey.ROI_SETTINGS.value)
-        self.config.add_section(ConfigKey.ROI_SETTINGS.value)
-        for i, v in enumerate(self.bp_dropdown_dict.values()):
-            self.config[ConfigKey.ROI_SETTINGS.value][
-                f"animal_{i+1}_bp"
-            ] = v.getChoices()
-        with open(self.config_path, "w") as configfile:
-            self.config.write(configfile)
-
-        style_attr = {}
-        style_attr["ROI_centers"] = self.show_ROI_centers_var.get()
-        style_attr["ROI_ear_tags"] = self.show_ROI_tags_var.get()
-        style_attr["Directionality"] = self.show_direction_var.get()
-        style_attr["Border_color"] = self.colors_dict[
-            self.border_clr_dropdown.getChoices()
-        ]
-        style_attr["Pose_estimation"] = self.show_pose_var.get()
-        style_attr["Directionality_style"] = (
-            self.directionality_type_dropdown.getChoices()
-        )
-
-        if not multiple:
+        style_attr = {
+            ROI_CENTERS: self.show_ROI_centers_var.get(),
+            ROI_EAR_TAGS: self.show_ROI_tags_var.get(),
+            POSE: self.show_pose_var.get(),
+            ANIMAL_NAMES: self.show_animal_names_var.get(),
+            DIRECTIONALITY: self.show_direction_var.get(),
+            BORDER_COLOR: self.colors_dict[self.border_clr_dropdown.getChoices()],
+            DIRECTIONALITY_STYLE: self.directionality_type_dropdown.getChoices(),
+        }
+        if multiple:
+            video_paths = [v for k, v in self.video_file_paths.items()]
+        else:
+            video_paths = [
+                self.video_file_paths[self.single_video_dropdown.getChoices()]
+            ]
+        body_parts = [v.getChoices() for v in self.bp_dropdown_dict.values()]
+        for video_path in video_paths:
             if not self.multiprocess_var.get():
                 roi_feature_visualizer = ROIfeatureVisualizer(
                     config_path=self.config_path,
-                    video_name=self.single_video_dropdown.getChoices(),
+                    video_path=video_path,
+                    body_parts=body_parts,
                     style_attr=style_attr,
                 )
-                roi_feature_visualizer.run()
             else:
+                core_cnt = int(self.multiprocess_dropdown.getChoices())
                 roi_feature_visualizer = ROIfeatureVisualizerMultiprocess(
                     config_path=self.config_path,
-                    video_name=self.single_video_dropdown.getChoices(),
+                    video_path=video_path,
+                    body_parts=body_parts,
                     style_attr=style_attr,
-                    core_cnt=int(self.multiprocess_dropdown.getChoices()),
-                )
-                roi_feature_visualizer_mp = multiprocessing.Process(
-                    target=roi_feature_visualizer.run()
+                    core_cnt=core_cnt,
                 )
-                roi_feature_visualizer_mp.start()
-        else:
-            if not self.multiprocess_var.get():
-                for video_name in self.video_list:
-                    roi_feature_visualizer = ROIfeatureVisualizer(
-                        config_path=self.config_path,
-                        video_name=video_name,
-                        style_attr=style_attr,
-                    )
-                    roi_feature_visualizer.run()
-            else:
-                for video_name in self.video_list:
-                    roi_feature_visualizer = ROIfeatureVisualizerMultiprocess(
-                        config_path=self.config_path,
-                        video_name=video_name,
-                        style_attr=style_attr,
-                        core_cnt=int(self.multiprocess_dropdown.getChoices()),
-                    )
-                    roi_feature_visualizer_mp = multiprocessing.Process(
-                        target=roi_feature_visualizer.run()
-                    )
-                    roi_feature_visualizer_mp.start()
-        self.root.destroy()
+            threading.Thread(target=roi_feature_visualizer.run()).start()
 
 
-# _ = VisualizeROIFeaturesPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Two_animals_16bps/project_folder/project_config.ini')
+# _ = VisualizeROIFeaturesPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/project_config.ini')
 
-# _ = VisualizeROIFeaturesPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini')
 
+# _ = VisualizeROIFeaturesPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Two_animals_16bps/project_folder/project_config.ini')
+# _ = VisualizeROIFeaturesPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini')
 # ROIAnalysisPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini')
 
 # _ = VisualizeROIFeaturesPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/pup_retrieval_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/pup_retrieval_pop_up.py`

 * *Files 0% similar despite different names*

```diff
@@ -28,15 +28,15 @@
         self.ROI_path = os.path.join(self.project_path, Paths.ROI_DEFINITIONS.value)
         if not os.path.isfile(self.ROI_path):
             raise NoFilesFoundError(
                 msg=f"Requires ROI definitions: no file found at {self.ROI_path}",
                 source=self.__class__.__name__,
             )
 
-        self.roi_analyzer = ROIAnalyzer(ini_path=config_path, data_path=None)
+        self.roi_analyzer = ROIAnalyzer(config_path=config_path, data_path=None)
         self.roi_analyzer.run()
         self.shape_names = self.roi_analyzer.shape_names
         self.animal_names = self.roi_analyzer.multi_animal_id_list
         self.clf_names = get_all_clf_names(
             config=self.config, target_cnt=self.roi_analyzer.clf_cnt
         )
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/boolean_conditional_slicer_pup_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/about_simba_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/about_simba_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_descriptive_statistics_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_tracking_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_tracking_plot_pop_up.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,63 +1,53 @@
 __author__ = "Simon Nilsson"
 
-import multiprocessing
 import os
+import threading
 from tkinter import *
+from typing import Union
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
 from simba.plotting.ROI_plotter import ROIPlot
 from simba.plotting.ROI_plotter_mp import ROIPlotMultiprocess
 from simba.ui.tkinter_functions import (CreateLabelFrameWithIcon, DropDownMenu,
                                         Entry_Box, FileSelect)
-from simba.utils.checks import check_float, check_if_filepath_list_is_empty
+from simba.utils.checks import check_file_exist_and_readable, check_float
 from simba.utils.enums import Formats, Keys, Links, Options
-from simba.utils.printing import stdout_success
-from simba.utils.read_write import (find_files_of_filetypes_in_directory,
-                                    get_fn_ext)
+from simba.utils.read_write import find_all_videos_in_directory
 
 
 class VisualizeROITrackingPopUp(PopUpMixin, ConfigReader):
-    def __init__(self, config_path: str):
-        PopUpMixin.__init__(self, title="VISUALIZE ROI TRACKING", size=(800, 500))
-        ConfigReader.__init__(self, config_path=config_path)
-        self.video_list = []
-        video_file_paths = find_files_of_filetypes_in_directory(
-            directory=self.video_dir, extensions=[".mp4", ".avi"]
-        )
-
-        for file_path in video_file_paths:
-            _, video_name, ext = get_fn_ext(filepath=file_path)
-            self.video_list.append(video_name + ext)
-
-        check_if_filepath_list_is_empty(
-            filepaths=self.video_list,
-            error_msg="No videos in SimBA project. Import videos into you SimBA project to visualize ROI tracking.",
+    def __init__(self, config_path: Union[str, os.PathLike]):
+        check_file_exist_and_readable(file_path=config_path)
+        ConfigReader.__init__(self, config_path=config_path, read_video_info=False)
+        self.read_roi_data()
+        self.video_file_paths = find_all_videos_in_directory(
+            directory=self.video_dir, as_dict=True, raise_error=True
         )
+        self.video_names = list(self.video_file_paths.keys())
+        PopUpMixin.__init__(self, title="VISUALIZE ROI TRACKING", size=(800, 500))
         self.multiprocess_var = BooleanVar()
         self.show_pose_var = BooleanVar(value=True)
         self.animal_name_var = BooleanVar(value=True)
-
         self.settings_frm = CreateLabelFrameWithIcon(
             parent=self.main_frm,
             header="SETTINGS",
             icon_name=Keys.DOCUMENTATION.value,
             icon_link=Links.ROI_DATA_PLOT.value,
         )
         self.threshold_entry_box = Entry_Box(
             self.settings_frm, "Body-part probability threshold", "30"
         )
         self.threshold_entry_box.entry_set(0.0)
         threshold_label = Label(
             self.settings_frm,
-            text="Note: body-part locations detected with probabilities below this threshold is removed from visualization.",
+            text="Note: body-part locations detected with probabilities \n below this threshold is removed from the visualization(s).",
             font=("Helvetica", 10, "italic"),
         )
-
         self.show_pose_cb = Checkbutton(
             self.settings_frm,
             text="Show pose-estimated location",
             variable=self.show_pose_var,
         )
         self.show_animal_name_cb = Checkbutton(
             self.settings_frm, text="Show animal names", variable=self.animal_name_var
@@ -72,32 +62,30 @@
             ),
         )
         self.multiprocess_dropdown = DropDownMenu(
             self.settings_frm, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
         )
         self.multiprocess_dropdown.setChoices(2)
         self.multiprocess_dropdown.disable()
-
         self.body_parts_frm = LabelFrame(
             self.main_frm,
             text="SELECT BODY-PARTS",
             pady=10,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
         )
         self.animal_cnt_dropdown = DropDownMenu(
             self.body_parts_frm,
-            "Number of animals",
+            "NUMBER OF ANIMALS",
             list(range(1, self.animal_cnt + 1)),
             "20",
             com=lambda x: self.__populate_bp_dropdown(bp_cnt=x),
         )
         self.animal_cnt_dropdown.setChoices(1)
         self.__populate_bp_dropdown(bp_cnt=1)
-
         self.run_frm = LabelFrame(
             self.main_frm,
             text="RUN VISUALIZATION",
             pady=10,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
         )
@@ -107,52 +95,48 @@
             pady=10,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
         )
         self.single_video_dropdown = DropDownMenu(
             self.single_video_frm,
             "Select video",
-            self.video_list,
+            self.video_names,
             "15",
             com=lambda x: self.update_file_select_box_from_dropdown(
                 filename=x, fileselectbox=self.select_video_file_select
             ),
         )
-        self.single_video_dropdown.setChoices(self.video_list[0])
+        self.single_video_dropdown.setChoices(self.video_names[0])
         self.select_video_file_select = FileSelect(
             self.single_video_frm,
             "",
             lblwidth="1",
             file_types=[("VIDEO FILE", Options.ALL_VIDEO_FORMAT_STR_OPTIONS.value)],
             dropdown=self.single_video_dropdown,
         )
-        self.select_video_file_select.filePath.set(self.video_list[0])
+        self.select_video_file_select.filePath.set(self.video_names[0])
         self.single_video_btn = Button(
             self.single_video_frm,
             text="Create SINGLE ROI video",
             fg="blue",
-            command=lambda: self.run_visualize(multiple=False),
+            command=lambda: self.run(multiple=False),
         )
-
         self.all_videos_frm = LabelFrame(
             self.run_frm,
             text="ALL videos",
             pady=10,
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
             fg="black",
         )
         self.all_videos_btn = Button(
             self.all_videos_frm,
-            text="Create ALL ROI videos ({} videos found)".format(
-                str(len(self.video_list))
-            ),
+            text=f"Create ALL ROI videos ({len(self.video_names)} videos found)",
             fg="red",
-            command=lambda: self.run_visualize(multiple=True),
+            command=lambda: self.run(multiple=True),
         )
-
         self.settings_frm.grid(row=0, column=0, sticky=NW)
         self.threshold_entry_box.grid(row=0, column=0, sticky=NW)
         threshold_label.grid(row=1, column=0, sticky=NW)
         self.show_pose_cb.grid(row=2, column=0, sticky=NW)
         self.show_animal_name_cb.grid(row=3, column=0, sticky=NW)
         self.multiprocess_cb.grid(row=4, column=0, sticky=NW)
         self.multiprocess_dropdown.grid(row=4, column=1, sticky=NW)
@@ -167,99 +151,67 @@
         self.single_video_btn.grid(row=1, column=0, sticky=NW)
         self.all_videos_frm.grid(row=1, column=0, sticky=NW)
         self.all_videos_btn.grid(row=0, column=0, sticky=NW)
         self.main_frm.mainloop()
 
     def __populate_bp_dropdown(self, bp_cnt: int):
         if hasattr(self, "bp_dropdown_dict"):
-            if len(self.bp_dropdown_dict.keys()) != bp_cnt:
-                for k, v in self.bp_dropdown_dict.items():
-                    v.destroy()
+            for k, v in self.bp_dropdown_dict.items():
+                v.destroy()
 
         self.bp_dropdown_dict = {}
         for cnt in range(int(self.animal_cnt_dropdown.getChoices())):
             self.bp_dropdown_dict[cnt] = DropDownMenu(
                 self.body_parts_frm,
                 self.multi_animal_id_list[cnt],
                 self.body_parts_lst,
                 "20",
             )
             self.bp_dropdown_dict[cnt].setChoices(self.body_parts_lst[cnt])
             self.bp_dropdown_dict[cnt].grid(row=cnt + 1, column=0, sticky=NW)
 
-    def run_visualize(self, multiple: bool):
+    def run(self, multiple: bool):
         if multiple:
-            videos = self.video_list
+            videos = list(self.video_file_paths.values())
         else:
-            videos = [self.single_video_dropdown.getChoices()]
+            videos = [self.video_file_paths[self.single_video_dropdown.getChoices()]]
+        for video_path in videos:
+            self.check_if_selected_video_path_exist_in_project(video_path=video_path)
 
         check_float(
             name="Body-part probability threshold",
             value=self.threshold_entry_box.entry_get,
             min_value=0.0,
             max_value=1.0,
         )
-        style_attr = {}
-        style_attr["Show_body_part"] = False
-        style_attr["Show_animal_name"] = False
-        if self.show_pose_var.get():
-            style_attr["Show_body_part"] = True
-        if self.animal_name_var.get():
-            style_attr["Show_animal_name"] = True
-
-        body_parts = {}
-        for k, v in self.bp_dropdown_dict.items():
-            body_parts[self.multi_animal_id_list[k]] = v.getChoices()
-
-        if not self.multiprocess_var.get():
-            selected_video_path = os.path.join(
-                self.video_dir, self.single_video_dropdown.getChoices()
-            )
-            self.check_if_selected_video_path_exist_in_project(
-                video_path=selected_video_path
-            )
-            self.config.set(
-                "ROI settings",
-                "probability_threshold",
-                str(self.threshold_entry_box.entry_get),
-            )
-            with open(self.config_path, "w") as f:
-                self.config.write(f)
-            for video in videos:
+        style_attr = {
+            "show_body_part": self.show_pose_var.get(),
+            "show_animal_name": self.animal_name_var.get(),
+        }
+        body_parts = [v.getChoices() for k, v in self.bp_dropdown_dict.items()]
+        for video_path in videos:
+            if not self.multiprocess_var.get():
                 roi_plotter = ROIPlot(
-                    ini_path=self.config_path,
-                    video_path=video,
+                    config_path=self.config_path,
+                    video_path=video_path,
                     style_attr=style_attr,
                     threshold=float(self.threshold_entry_box.entry_get),
                     body_parts=body_parts,
                 )
-                roi_plotter.insert_data()
-                roi_plotter_multiprocessor = multiprocessing.Process(
-                    target=roi_plotter.run()
-                )
-                roi_plotter_multiprocessor.start()
-
-        else:
-            with open(self.config_path, "w") as f:
-                self.config.write(f)
-            core_cnt = self.multiprocess_dropdown.getChoices()
-            for video in videos:
+            else:
+                core_cnt = self.multiprocess_dropdown.getChoices()
                 roi_plotter = ROIPlotMultiprocess(
-                    ini_path=self.config_path,
-                    video_path=video,
+                    config_path=self.config_path,
+                    video_path=video_path,
                     core_cnt=int(core_cnt),
                     style_attr=style_attr,
                     threshold=float(self.threshold_entry_box.entry_get),
                     body_parts=body_parts,
                 )
-                roi_plotter.run()
-
-        stdout_success(
-            msg="All ROI videos created and saved in project_folder/frames/output/ROI_analysis directory",
-            source=self.__class__.__name__,
-        )
+            threading.Thread(target=roi_plotter.run()).start()
 
 
+# _ = VisualizeROITrackingPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/project_config.ini')
 # _ = VisualizeROITrackingPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini')
 # _ = VisualizeROITrackingPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
 # _ = VisualizeROITrackingPopUp(config_path='/Users/simon/Desktop/envs/simba_dev/tests/data/test_projects/mouse_open_field/project_folder/project_config.ini')
 # _ = VisualizeROITrackingPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/dorian_2/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/directing_animal_to_bodypart_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/validation_plot_pop_up.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,173 +1,178 @@
-__author__ = "Tzuk Polinsky"
+__author__ = "Simon Nilsson"
 
-import os
+import threading
 from tkinter import *
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
-from simba.plotting.directing_animals_to_bodypart_visualizer import \
-    DirectingAnimalsToBodyPartVisualizer
-from simba.plotting.directing_animals_visualizer import \
-    DirectingOtherAnimalsVisualizer
-from simba.plotting.directing_animals_visualizer_mp import \
-    DirectingOtherAnimalsVisualizerMultiprocess
-from simba.ui.tkinter_functions import CreateLabelFrameWithIcon, DropDownMenu
-from simba.utils.enums import Formats, Keys, Links, Paths
-from simba.utils.errors import AnimalNumberError
-from simba.utils.read_write import get_file_name_info_in_directory
+from simba.plotting.single_run_model_validation_video import \
+    ValidateModelOneVideo
+from simba.plotting.single_run_model_validation_video_mp import \
+    ValidateModelOneVideoMultiprocess
+from simba.ui.tkinter_functions import (CreateLabelFrameWithIcon, DropDownMenu,
+                                        Entry_Box)
+from simba.utils.checks import check_float, check_int
+from simba.utils.enums import Formats, Keys, Links, Options
+from simba.utils.read_write import check_file_exist_and_readable, str_2_bool
 
 
-class DirectingAnimalToBodyPartVisualizerPopUp(PopUpMixin, ConfigReader):
-    def __init__(self, config_path: str):
+class ValidationVideoPopUp(PopUpMixin, ConfigReader):
+    def __init__(self, config_path: str, simba_main_frm: object):
+        PopUpMixin.__init__(self, title="CREATE VALIDATION VIDEO")
         ConfigReader.__init__(self, config_path=config_path)
-        PopUpMixin.__init__(self, title="CREATE ANIMAL DIRECTION TO BODY PART VIDEOS")
-        self.color_lst = list(self.colors_dict.keys())
-        self.color_lst.insert(0, "Random")
-        self.size_lst = list(range(1, 11))
-        self.data_path = os.path.join(self.project_path, Paths.OUTLIER_CORRECTED.value)
-        self.files_found_dict = get_file_name_info_in_directory(
-            directory=self.data_path, file_type=self.file_type
-        )
-
-        self.show_pose_var = BooleanVar(value=True)
-        self.merge_directionality_lines_var = BooleanVar(value=False)
-        self.multiprocess_var = BooleanVar(value=False)
+        self.feature_file_path = simba_main_frm.csvfile.file_path
+        self.model_path = simba_main_frm.modelfile.file_path
+        self.discrimination_threshold = simba_main_frm.dis_threshold.entry_get
+        self.shortest_bout = simba_main_frm.min_behaviorbout.entry_get
 
-        self.style_settings_frm = CreateLabelFrameWithIcon(
+        style_frm = CreateLabelFrameWithIcon(
             parent=self.main_frm,
             header="STYLE SETTINGS",
             icon_name=Keys.DOCUMENTATION.value,
-            icon_link=Links.DIRECTING_ANIMALS_PLOTS.value,
+            icon_link=Links.OUT_OF_SAMPLE_VALIDATION.value,
+        )
+        self.default_style_var = BooleanVar(value=True)
+        default_style_cb = Checkbutton(
+            style_frm,
+            text="AUTO-COMPUTE STYLES",
+            variable=self.default_style_var,
+            command=lambda: self.enable_entrybox_from_checkbox(
+                check_box_var=self.default_style_var,
+                entry_boxes=[self.font_size_eb, self.spacing_eb, self.circle_size],
+                reverse=True,
+            ),
+        )
+        self.font_size_eb = Entry_Box(
+            style_frm, "Font size: ", "25", validation="numeric"
+        )
+        self.spacing_eb = Entry_Box(
+            style_frm, "Text spacing: ", "25", validation="numeric"
+        )
+        self.circle_size = Entry_Box(
+            style_frm, "Circle size: ", "25", validation="numeric"
+        )
+        self.font_size_eb.entry_set(val=1)
+        self.spacing_eb.entry_set(val=10)
+        self.circle_size.entry_set(val=5)
+        self.enable_entrybox_from_checkbox(
+            check_box_var=self.default_style_var,
+            entry_boxes=[self.font_size_eb, self.spacing_eb, self.circle_size],
+            reverse=True,
         )
-        self.show_pose_cb = Checkbutton(
-            self.style_settings_frm,
-            text="Show pose-estimated body-parts",
-            variable=self.show_pose_var,
-        )
-        self.merge_directionality_lines_cb = Checkbutton(
-            self.style_settings_frm,
-            text="Polyfill direction lines",
-            variable=self.merge_directionality_lines_var,
-        )
-        self.direction_clr_dropdown = DropDownMenu(
-            self.style_settings_frm, "Direction color:", self.color_lst, "16"
-        )
-        self.pose_size_dropdown = DropDownMenu(
-            self.style_settings_frm, "Pose circle size:", self.size_lst, "16"
-        )
-        self.line_thickness = DropDownMenu(
-            self.style_settings_frm, "Line thickness:", self.size_lst, "16"
-        )
-        self.line_thickness.setChoices(choice=4)
-        self.pose_size_dropdown.setChoices(choice=3)
-        self.direction_clr_dropdown.setChoices(choice="Random")
-        # multiprocess_cb = Checkbutton(
-        #     self.style_settings_frm,
-        #     text="Multi-process (faster)",
-        #     variable=self.multiprocess_var,
-        #     command=lambda: self.enable_dropdown_from_checkbox(
-        #         check_box_var=self.multiprocess_var,
-        #         dropdown_menus=[self.multiprocess_dropdown],
-        #     ),
-        # )
-        # self.multiprocess_dropdown = DropDownMenu(
-        #     self.style_settings_frm, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
-        # )
-        # self.multiprocess_dropdown.setChoices(2)
-        # self.multiprocess_dropdown.disable()
 
-        self.run_frm = LabelFrame(
+        tracking_frm = LabelFrame(
             self.main_frm,
-            text="RUN",
-            font=Formats.LABELFRAME_HEADER_FORMAT.value,
-            pady=5,
-            padx=5,
-            fg="black",
-        )
-        self.run_single_video_frm = LabelFrame(
-            self.run_frm,
-            text="SINGLE VIDEO",
+            text="TRACKING OPTIONS",
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
-            pady=5,
-            padx=5,
-            fg="black",
-        )
-        self.run_single_video_btn = Button(
-            self.run_single_video_frm,
-            text="Create single video",
-            fg="blue",
-            command=lambda: self.__create_directionality_plots(multiple_videos=False),
-        )
-        self.single_video_dropdown = DropDownMenu(
-            self.run_single_video_frm,
-            "Video:",
-            list(self.files_found_dict.keys()),
-            "12",
-        )
-        self.single_video_dropdown.setChoices(list(self.files_found_dict.keys())[0])
-        self.run_multiple_videos = LabelFrame(
-            self.run_frm,
-            text="MULTIPLE VIDEO",
+        )
+        self.show_pose_dropdown = DropDownMenu(
+            tracking_frm, "Show pose:", Options.BOOL_STR_OPTIONS.value, "20"
+        )
+        self.show_animal_names_dropdown = DropDownMenu(
+            tracking_frm, "Show animal names:", Options.BOOL_STR_OPTIONS.value, "20"
+        )
+        self.show_pose_dropdown.setChoices(Options.BOOL_STR_OPTIONS.value[0])
+        self.show_animal_names_dropdown.setChoices(Options.BOOL_STR_OPTIONS.value[1])
+
+        multiprocess_frame = LabelFrame(
+            self.main_frm,
+            text="MULTI-PROCESS SETTINGS",
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
-            pady=5,
-            padx=5,
-            fg="black",
-        )
-        self.run_multiple_video_btn = Button(
-            self.run_multiple_videos,
-            text="Create multiple videos ({} video(s) found)".format(
-                str(len(list(self.files_found_dict.keys())))
+        )
+        self.multiprocess_var = BooleanVar(value=False)
+        self.multiprocess_cb = Checkbutton(
+            multiprocess_frame,
+            text="Multiprocess videos (faster)",
+            variable=self.multiprocess_var,
+            command=lambda: self.enable_dropdown_from_checkbox(
+                check_box_var=self.multiprocess_var,
+                dropdown_menus=[self.multiprocess_dropdown],
             ),
-            fg="blue",
-            command=lambda: self.__create_directionality_plots(multiple_videos=True),
         )
+        self.multiprocess_dropdown = DropDownMenu(
+            multiprocess_frame, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
+        )
+        self.multiprocess_dropdown.setChoices(2)
+        self.multiprocess_dropdown.disable()
 
-        self.style_settings_frm.grid(row=0, column=0, sticky=NW)
-        self.show_pose_cb.grid(row=0, column=0, sticky=NW)
-        self.merge_directionality_lines_cb.grid(row=2, column=0, sticky=NW)
-        self.direction_clr_dropdown.grid(row=3, column=0, sticky=NW)
-        self.pose_size_dropdown.grid(row=4, column=0, sticky=NW)
-        self.line_thickness.grid(row=5, column=0, sticky=NW)
-        # multiprocess_cb.grid(row=6, column=0, sticky=NW)
-        # self.multiprocess_dropdown.grid(row=6, column=1, sticky=NW)
-
-        self.run_frm.grid(row=1, column=0, sticky=NW)
-        self.run_single_video_frm.grid(row=0, column=0, sticky=NW)
-        self.run_single_video_btn.grid(row=0, column=0, sticky=NW)
-        self.single_video_dropdown.grid(row=0, column=1, sticky=NW)
-        self.run_multiple_videos.grid(row=1, column=0, sticky=NW)
-        self.run_multiple_video_btn.grid(row=0, column=0, sticky=NW)
-
-    def __create_directionality_plots(self, multiple_videos: bool):
-        if multiple_videos:
-            data_paths = list(self.files_found_dict.values())
-        else:
-            data_paths = [
-                self.files_found_dict[self.single_video_dropdown.getChoices()]
-            ]
-
-        style_attr = {
-            "Show_pose": self.show_pose_var.get(),
-            "Pose_circle_size": int(self.pose_size_dropdown.getChoices()),
-            "Direction_color": self.direction_clr_dropdown.getChoices(),
-            "Direction_thickness": int(self.line_thickness.getChoices()),
-            "Polyfill": self.merge_directionality_lines_var.get(),
+        gantt_frm = LabelFrame(
+            self.main_frm,
+            text="GANTT SETTINGS",
+            font=Formats.LABELFRAME_HEADER_FORMAT.value,
+        )
+        self.gantt_dropdown = DropDownMenu(
+            gantt_frm, "GANTT TYPE:", Options.GANTT_VALIDATION_OPTIONS.value, "12"
+        )
+        self.gantt_dropdown.setChoices(Options.GANTT_VALIDATION_OPTIONS.value[0])
+
+        style_frm.grid(row=0, column=0, sticky=NW)
+        default_style_cb.grid(row=0, column=0, sticky=NW)
+        self.font_size_eb.grid(row=1, column=0, sticky=NW)
+        self.spacing_eb.grid(row=2, column=0, sticky=NW)
+        self.circle_size.grid(row=3, column=0, sticky=NW)
+
+        tracking_frm.grid(row=1, column=0, sticky=NW)
+        self.show_pose_dropdown.grid(row=0, column=0, sticky=NW)
+        self.show_animal_names_dropdown.grid(row=1, column=0, sticky=NW)
+
+        multiprocess_frame.grid(row=2, column=0, sticky=NW)
+        self.multiprocess_cb.grid(row=0, column=0, sticky=NW)
+        self.multiprocess_dropdown.grid(row=0, column=1, sticky=NW)
+        gantt_frm.grid(row=3, column=0, sticky=NW)
+        self.gantt_dropdown.grid(row=0, column=0, sticky=NW)
+
+        self.create_run_frm(run_function=self.run)
+        self.main_frm.mainloop()
+
+    def run(self):
+        settings = {
+            "pose": str_2_bool(self.show_pose_dropdown.getChoices()),
+            "animal_names": str_2_bool(self.show_animal_names_dropdown.getChoices()),
         }
+        settings["styles"] = None
+        if not self.default_style_var.get():
+            settings["styles"] = {}
+            check_float(name="FONT SIZE", value=self.font_size_eb.entry_get)
+            check_float(name="CIRCLE SIZE", value=self.circle_size.entry_get)
+            check_float(name="SPACE SCALE", value=self.spacing_eb.entry_get)
+            settings["styles"]["circle size"] = int(self.circle_size.entry_get)
+            settings["styles"]["font size"] = int(self.font_size_eb.entry_get)
+            settings["styles"]["space_scale"] = int(self.spacing_eb.entry_get)
+        check_int(name="MINIMUM BOUT LENGTH", value=self.shortest_bout)
+        check_float(
+            name="DISCRIMINATION THRESHOLD", value=self.discrimination_threshold
+        )
+        check_file_exist_and_readable(file_path=self.feature_file_path)
+        check_file_exist_and_readable(file_path=self.model_path)
+
+        create_gantt = self.gantt_dropdown.getChoices()
+        if create_gantt.strip() == "Gantt chart: final frame only (slightly faster)":
+            create_gantt = 1
+        elif create_gantt.strip() == "Gantt chart: video":
+            create_gantt = 2
+        else:
+            create_gantt = None
 
-        for data_path in data_paths:
-            # if not self.multiprocess_var.get():
-            directing_other_animal_visualizer = DirectingAnimalsToBodyPartVisualizer(
+        if not self.multiprocess_var.get():
+            validation_video_creator = ValidateModelOneVideo(
+                config_path=self.config_path,
+                feature_file_path=self.feature_file_path,
+                model_path=self.model_path,
+                discrimination_threshold=float(self.discrimination_threshold),
+                shortest_bout=int(self.shortest_bout),
+                settings=settings,
+                create_gantt=create_gantt,
+            )
+
+        else:
+            validation_video_creator = ValidateModelOneVideoMultiprocess(
                 config_path=self.config_path,
-                data_path=data_path,
-                style_attr=style_attr,
+                feature_file_path=self.feature_file_path,
+                model_path=self.model_path,
+                discrimination_threshold=float(self.discrimination_threshold),
+                shortest_bout=int(self.shortest_bout),
+                cores=int(self.multiprocess_dropdown.getChoices()),
+                settings=settings,
+                create_gantt=create_gantt,
             )
-            # else:
-            #     directing_other_animal_visualizer = (
-            #         DirectingOtherAnimalsVisualizerMultiprocess(
-            #             config_path=self.config_path,
-            #             data_path=data_path,
-            #             style_attr=style_attr,
-            #             core_cnt=int(self.multiprocess_dropdown.getChoices()),
-            #         )
-            #     )
-            directing_other_animal_visualizer.run()
+        threading.Thread(target=validation_video_creator.run()).start()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_add_remove_print_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_add_remove_print_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/video_processing_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/video_processing_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/validation_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/directing_other_animals_plot_pop_up.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,178 +1,201 @@
 __author__ = "Simon Nilsson"
 
+import os
 import threading
 from tkinter import *
+from typing import Union
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.pop_up_mixin import PopUpMixin
-from simba.plotting.single_run_model_validation_video import \
-    ValidateModelOneVideo
-from simba.plotting.single_run_model_validation_video_mp import \
-    ValidateModelOneVideoMultiprocess
-from simba.ui.tkinter_functions import (CreateLabelFrameWithIcon, DropDownMenu,
-                                        Entry_Box)
-from simba.utils.checks import check_float, check_int
-from simba.utils.enums import Formats, Keys, Links, Options
-from simba.utils.read_write import check_file_exist_and_readable, str_2_bool
+from simba.plotting.directing_animals_visualizer import \
+    DirectingOtherAnimalsVisualizer
+from simba.plotting.directing_animals_visualizer_mp import \
+    DirectingOtherAnimalsVisualizerMultiprocess
+from simba.ui.tkinter_functions import CreateLabelFrameWithIcon, DropDownMenu
+from simba.utils.enums import Formats, Keys, Links
+from simba.utils.errors import AnimalNumberError
+from simba.utils.lookups import get_color_dict
+from simba.utils.read_write import find_all_videos_in_directory
+
+DIRECTION_THICKNESS = "direction_thickness"
+DIRECTIONALITY_COLOR = "directionality_color"
+CIRCLE_SIZE = "circle_size"
+HIGHLIGHT_ENDPOINTS = "highlight_endpoints"
+SHOW_POSE = "show_pose"
+ANIMAL_NAMES = "animal_names"
 
 
-class ValidationVideoPopUp(PopUpMixin, ConfigReader):
-    def __init__(self, config_path: str, simba_main_frm: object):
-        PopUpMixin.__init__(self, title="CREATE VALIDATION VIDEO")
+class DirectingOtherAnimalsVisualizerPopUp(PopUpMixin, ConfigReader):
+    def __init__(self, config_path: Union[str, os.PathLike]):
         ConfigReader.__init__(self, config_path=config_path)
-        self.feature_file_path = simba_main_frm.csvfile.file_path
-        self.model_path = simba_main_frm.modelfile.file_path
-        self.discrimination_threshold = simba_main_frm.dis_threshold.entry_get
-        self.shortest_bout = simba_main_frm.min_behaviorbout.entry_get
+        if self.animal_cnt == 1:
+            raise AnimalNumberError(
+                msg="Cannot visualize directionality between animals in a 1 animal project.",
+                source=self.__class__.__name__,
+            )
+        PopUpMixin.__init__(self, title="CREATE ANIMAL DIRECTION VIDEOS")
+        self.color_dict = get_color_dict()
+        self.color_lst = list(self.color_dict.keys())
+        self.color_lst.insert(0, "random")
+        self.size_lst = list(range(1, 11))
+        self.files_found_dict = find_all_videos_in_directory(
+            directory=self.video_dir, as_dict=True
+        )
+        self.show_pose_var = BooleanVar(value=True)
+        self.show_animal_names_var = BooleanVar(value=True)
+        self.highlight_direction_endpoints_var = BooleanVar(value=True)
+        self.multiprocess_var = BooleanVar(value=False)
 
-        style_frm = CreateLabelFrameWithIcon(
+        self.style_settings_frm = CreateLabelFrameWithIcon(
             parent=self.main_frm,
             header="STYLE SETTINGS",
             icon_name=Keys.DOCUMENTATION.value,
-            icon_link=Links.OUT_OF_SAMPLE_VALIDATION.value,
-        )
-        self.default_style_var = BooleanVar(value=True)
-        default_style_cb = Checkbutton(
-            style_frm,
-            text="AUTO-COMPUTE STYLES",
-            variable=self.default_style_var,
-            command=lambda: self.enable_entrybox_from_checkbox(
-                check_box_var=self.default_style_var,
-                entry_boxes=[self.font_size_eb, self.spacing_eb, self.circle_size],
-                reverse=True,
-            ),
-        )
-        self.font_size_eb = Entry_Box(
-            style_frm, "Font size: ", "25", validation="numeric"
-        )
-        self.spacing_eb = Entry_Box(
-            style_frm, "Text spacing: ", "25", validation="numeric"
-        )
-        self.circle_size = Entry_Box(
-            style_frm, "Circle size: ", "25", validation="numeric"
-        )
-        self.font_size_eb.entry_set(val=1)
-        self.spacing_eb.entry_set(val=10)
-        self.circle_size.entry_set(val=5)
-        self.enable_entrybox_from_checkbox(
-            check_box_var=self.default_style_var,
-            entry_boxes=[self.font_size_eb, self.spacing_eb, self.circle_size],
-            reverse=True,
+            icon_link=Links.DIRECTING_ANIMALS_PLOTS.value,
         )
-
-        tracking_frm = LabelFrame(
-            self.main_frm,
-            text="TRACKING OPTIONS",
-            font=Formats.LABELFRAME_HEADER_FORMAT.value,
-        )
-        self.show_pose_dropdown = DropDownMenu(
-            tracking_frm, "Show pose:", Options.BOOL_STR_OPTIONS.value, "20"
-        )
-        self.show_animal_names_dropdown = DropDownMenu(
-            tracking_frm, "Show animal names:", Options.BOOL_STR_OPTIONS.value, "20"
-        )
-        self.show_pose_dropdown.setChoices(Options.BOOL_STR_OPTIONS.value[0])
-        self.show_animal_names_dropdown.setChoices(Options.BOOL_STR_OPTIONS.value[1])
-
-        multiprocess_frame = LabelFrame(
-            self.main_frm,
-            text="MULTI-PROCESS SETTINGS",
-            font=Formats.LABELFRAME_HEADER_FORMAT.value,
-        )
-        self.multiprocess_var = BooleanVar(value=False)
-        self.multiprocess_cb = Checkbutton(
-            multiprocess_frame,
-            text="Multiprocess videos (faster)",
+        self.show_pose_cb = Checkbutton(
+            self.style_settings_frm,
+            text="Show pose-estimated body-parts",
+            variable=self.show_pose_var,
+        )
+        self.highlight_direction_endpoints_cb = Checkbutton(
+            self.style_settings_frm,
+            text="Highlight direction end-points",
+            variable=self.highlight_direction_endpoints_var,
+        )
+        self.show_animal_names_cb = Checkbutton(
+            self.style_settings_frm,
+            text="Show animal names",
+            variable=self.show_animal_names_var,
+        )
+
+        self.direction_clr_dropdown = DropDownMenu(
+            self.style_settings_frm, "Direction color:", self.color_lst, "16"
+        )
+        self.pose_size_dropdown = DropDownMenu(
+            self.style_settings_frm, "Pose circle size:", self.size_lst, "16"
+        )
+        self.line_thickness = DropDownMenu(
+            self.style_settings_frm, "Line thickness:", self.size_lst, "16"
+        )
+        self.line_thickness.setChoices(choice=4)
+        self.pose_size_dropdown.setChoices(choice=3)
+        self.direction_clr_dropdown.setChoices(choice="random")
+        multiprocess_cb = Checkbutton(
+            self.style_settings_frm,
+            text="Multi-process (faster)",
             variable=self.multiprocess_var,
             command=lambda: self.enable_dropdown_from_checkbox(
                 check_box_var=self.multiprocess_var,
                 dropdown_menus=[self.multiprocess_dropdown],
             ),
         )
         self.multiprocess_dropdown = DropDownMenu(
-            multiprocess_frame, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
+            self.style_settings_frm, "CPU cores:", list(range(2, self.cpu_cnt)), "12"
         )
         self.multiprocess_dropdown.setChoices(2)
         self.multiprocess_dropdown.disable()
 
-        gantt_frm = LabelFrame(
+        self.run_frm = LabelFrame(
             self.main_frm,
-            text="GANTT SETTINGS",
+            text="RUN",
             font=Formats.LABELFRAME_HEADER_FORMAT.value,
-        )
-        self.gantt_dropdown = DropDownMenu(
-            gantt_frm, "GANTT TYPE:", Options.GANTT_VALIDATION_OPTIONS.value, "12"
-        )
-        self.gantt_dropdown.setChoices(Options.GANTT_VALIDATION_OPTIONS.value[0])
-
-        style_frm.grid(row=0, column=0, sticky=NW)
-        default_style_cb.grid(row=0, column=0, sticky=NW)
-        self.font_size_eb.grid(row=1, column=0, sticky=NW)
-        self.spacing_eb.grid(row=2, column=0, sticky=NW)
-        self.circle_size.grid(row=3, column=0, sticky=NW)
-
-        tracking_frm.grid(row=1, column=0, sticky=NW)
-        self.show_pose_dropdown.grid(row=0, column=0, sticky=NW)
-        self.show_animal_names_dropdown.grid(row=1, column=0, sticky=NW)
-
-        multiprocess_frame.grid(row=2, column=0, sticky=NW)
-        self.multiprocess_cb.grid(row=0, column=0, sticky=NW)
-        self.multiprocess_dropdown.grid(row=0, column=1, sticky=NW)
-        gantt_frm.grid(row=3, column=0, sticky=NW)
-        self.gantt_dropdown.grid(row=0, column=0, sticky=NW)
+            pady=5,
+            padx=5,
+            fg="black",
+        )
+        self.run_single_video_frm = LabelFrame(
+            self.run_frm,
+            text="SINGLE VIDEO",
+            font=Formats.LABELFRAME_HEADER_FORMAT.value,
+            pady=5,
+            padx=5,
+            fg="black",
+        )
+        self.run_single_video_btn = Button(
+            self.run_single_video_frm,
+            text="Create single video",
+            fg="blue",
+            command=lambda: self.__create_directionality_plots(multiple_videos=False),
+        )
+        self.single_video_dropdown = DropDownMenu(
+            self.run_single_video_frm,
+            "Video:",
+            list(self.files_found_dict.keys()),
+            "12",
+        )
+        self.single_video_dropdown.setChoices(list(self.files_found_dict.keys())[0])
+        self.run_multiple_videos = LabelFrame(
+            self.run_frm,
+            text="MULTIPLE VIDEO",
+            font=Formats.LABELFRAME_HEADER_FORMAT.value,
+            pady=5,
+            padx=5,
+            fg="black",
+        )
+        self.run_multiple_video_btn = Button(
+            self.run_multiple_videos,
+            text=f"Create multiple videos ({len(list(self.files_found_dict.keys()))} video(s) found)",
+            fg="blue",
+            command=lambda: self.__create_directionality_plots(multiple_videos=True),
+        )
+
+        self.style_settings_frm.grid(row=0, column=0, sticky=NW)
+        self.show_pose_cb.grid(row=0, column=0, sticky=NW)
+        self.highlight_direction_endpoints_cb.grid(row=1, column=0, sticky=NW)
+        self.show_animal_names_cb.grid(row=2, column=0, sticky=NW)
+        self.direction_clr_dropdown.grid(row=3, column=0, sticky=NW)
+        self.pose_size_dropdown.grid(row=4, column=0, sticky=NW)
+        self.line_thickness.grid(row=5, column=0, sticky=NW)
+        multiprocess_cb.grid(row=6, column=0, sticky=NW)
+        self.multiprocess_dropdown.grid(row=6, column=1, sticky=NW)
+
+        self.run_frm.grid(row=1, column=0, sticky=NW)
+        self.run_single_video_frm.grid(row=0, column=0, sticky=NW)
+        self.run_single_video_btn.grid(row=0, column=0, sticky=NW)
+        self.single_video_dropdown.grid(row=0, column=1, sticky=NW)
+        self.run_multiple_videos.grid(row=1, column=0, sticky=NW)
+        self.run_multiple_video_btn.grid(row=0, column=0, sticky=NW)
 
-        self.create_run_frm(run_function=self.run)
         self.main_frm.mainloop()
 
-    def run(self):
-        settings = {
-            "pose": str_2_bool(self.show_pose_dropdown.getChoices()),
-            "animal_names": str_2_bool(self.show_animal_names_dropdown.getChoices()),
-        }
-        settings["styles"] = None
-        if not self.default_style_var.get():
-            settings["styles"] = {}
-            check_float(name="FONT SIZE", value=self.font_size_eb.entry_get)
-            check_float(name="CIRCLE SIZE", value=self.circle_size.entry_get)
-            check_float(name="SPACE SCALE", value=self.spacing_eb.entry_get)
-            settings["styles"]["circle size"] = int(self.circle_size.entry_get)
-            settings["styles"]["font size"] = int(self.font_size_eb.entry_get)
-            settings["styles"]["space_scale"] = int(self.spacing_eb.entry_get)
-        check_int(name="MINIMUM BOUT LENGTH", value=self.shortest_bout)
-        check_float(
-            name="DISCRIMINATION THRESHOLD", value=self.discrimination_threshold
-        )
-        check_file_exist_and_readable(file_path=self.feature_file_path)
-        check_file_exist_and_readable(file_path=self.model_path)
-
-        create_gantt = self.gantt_dropdown.getChoices()
-        if create_gantt.strip() == "Gantt chart: final frame only (slightly faster)":
-            create_gantt = 1
-        elif create_gantt.strip() == "Gantt chart: video":
-            create_gantt = 2
+    def __create_directionality_plots(self, multiple_videos: bool):
+        if multiple_videos:
+            video_paths = list(self.files_found_dict.values())
         else:
-            create_gantt = None
+            video_paths = [
+                self.files_found_dict[self.single_video_dropdown.getChoices()]
+            ]
+
+        direction_clr = self.direction_clr_dropdown.getChoices()
+        if direction_clr != "random":
+            direction_clr = self.color_dict[direction_clr]
+
+        style_attr = {
+            SHOW_POSE: self.show_pose_var.get(),
+            CIRCLE_SIZE: int(self.pose_size_dropdown.getChoices()),
+            DIRECTIONALITY_COLOR: direction_clr,
+            DIRECTION_THICKNESS: int(self.line_thickness.getChoices()),
+            HIGHLIGHT_ENDPOINTS: self.highlight_direction_endpoints_var.get(),
+            ANIMAL_NAMES: self.show_animal_names_var.get(),
+        }
 
-        if not self.multiprocess_var.get():
-            validation_video_creator = ValidateModelOneVideo(
-                config_path=self.config_path,
-                feature_file_path=self.feature_file_path,
-                model_path=self.model_path,
-                discrimination_threshold=float(self.discrimination_threshold),
-                shortest_bout=int(self.shortest_bout),
-                settings=settings,
-                create_gantt=create_gantt,
-            )
+        for video_path in video_paths:
+            if not self.multiprocess_var.get():
+                visualizer = DirectingOtherAnimalsVisualizer(
+                    config_path=self.config_path,
+                    video_path=video_path,
+                    style_attr=style_attr,
+                )
+            else:
+                visualizer = DirectingOtherAnimalsVisualizerMultiprocess(
+                    config_path=self.config_path,
+                    video_path=video_path,
+                    style_attr=style_attr,
+                    core_cnt=int(self.multiprocess_dropdown.getChoices()),
+                )
 
-        else:
-            validation_video_creator = ValidateModelOneVideoMultiprocess(
-                config_path=self.config_path,
-                feature_file_path=self.feature_file_path,
-                model_path=self.model_path,
-                discrimination_threshold=float(self.discrimination_threshold),
-                shortest_bout=int(self.shortest_bout),
-                cores=int(self.multiprocess_dropdown.getChoices()),
-                settings=settings,
-                create_gantt=create_gantt,
-            )
-        threading.Thread(target=validation_video_creator.run()).start()
+            threading.Thread(target=visualizer.run()).start()
+
+
+# _ = DirectingOtherAnimalsVisualizerPopUp(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+# _ = DirectingOtherAnimalsVisualizerPopUp(config_path='/Users/simon/Desktop/envs/troubleshooting/Two_animals_16bps/project_folder/project_config.ini')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/clf_by_roi_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/clf_by_roi_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/direction_animal_to_bodypart_settings_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/create_user_defined_pose_configuration_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/archive_files_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/archive_files_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/pose_bp_drop_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/pose_bp_drop_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/distance_plot_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/distance_plot_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/subset_feature_extractor_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/subset_feature_extractor_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/third_party_annotator_appender_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/pop_ups/roi_analysis_time_bins_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/video_info_ui.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/video_info_ui.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/user_defined_pose_creator.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/user_defined_pose_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/create_project_ui.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/create_project_ui.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/tkinter_functions.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/tkinter_functions.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/ui/machine_model_settings_ui.py` & `Simba-UW-tf-dev-1.90.5/simba/ui/machine_model_settings_ui.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/labelling/labelling_interface.py` & `Simba-UW-tf-dev-1.90.5/simba/labelling/labelling_interface.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/labelling/targeted_annotations_clips.py` & `Simba-UW-tf-dev-1.90.5/simba/labelling/targeted_annotations_clips.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/labelling/extract_labelled_frames.py` & `Simba-UW-tf-dev-1.90.5/simba/labelling/extract_labelled_frames.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/labelling/labelling_advanced_interface.py` & `Simba-UW-tf-dev-1.90.5/simba/labelling/labelling_advanced_interface.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/labelling/play_annotation_video.py` & `Simba-UW-tf-dev-1.90.5/simba/labelling/play_annotation_video.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/dbcv_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/dbcv_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_validation_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_validation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/enums.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/enums.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_video_visualizer.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_video_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/cluster_videos_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_videos_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/transform_cluster_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/transform_cluster_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/embedding_correlations_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/embedding_correlations_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/transform_dim_reduction_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/fit_dim_reduction_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/data_extractor_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/data_extractor_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/cluster_validation_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_validation_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/fit_cluster_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/fit_cluster_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/clusterer_comparison_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/clusterer_comparison_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/grid_search_visualizer_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/cluster_xai_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/cluster_xai_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/pop_ups/print_embedding_info_popup.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/pop_ups/print_embedding_info_popup.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/dataset_creator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/dataset_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/unsupervised_main.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/unsupervised_main.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/grid_search_visualizers.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/grid_search_visualizers.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/data_extractor.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/data_extractor.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/outlier_detector.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/outlier_detector.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_frequentist_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_frequentist_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/embedding_correlation_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/embedding_correlation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/cluster_xai_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/cluster_xai_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/umap_embedder.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/umap_embedder.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/clusterer_comparison_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/clusterer_comparison_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/bout_aggregator.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/bout_aggregator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/data_map.yaml` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/data_map.yaml`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/hdbscan_clusterer.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/hdbscan_clusterer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/unsupervised/tsne.py` & `Simba-UW-tf-dev-1.90.5/simba/unsupervised/tsne.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/agg_boundary_stats.py` & `Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/agg_boundary_stats.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/boundary_menus.py` & `Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/boundary_menus.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/boundary_statistics.py` & `Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/boundary_statistics.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/find_boundaries.py` & `Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/find_boundaries.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/bounding_box_tools/visualize_boundaries.py` & `Simba-UW-tf-dev-1.90.5/simba/bounding_box_tools/visualize_boundaries.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/.DS_Store`

 * *Files 7% similar despite different names*

```diff
@@ -110,27 +110,27 @@
 000006d0: 0154 0156 0157 0158 0161 0169 016b 016c  .T.V.W.X.a.i.k.l
 000006e0: 016d 0176 017f 0182 0183 0184 018d 019c  .m.v............
 000006f0: 019e 019f 01a0 01a9 01b3 01b4 01b5 01be  ................
 00000700: 01bf 01c1 01c2 01cd 01d6 01d7 01d8 01ea  ................
 00000710: 01f3 01f4 01f5 0208 0209 0212 021f 0220  ............... 
 00000720: 0000 0000 0000 0201 0000 0000 0000 0057  ...............W
 00000730: 0000 0000 0000 0000 0000 0000 0000 0222  ..............."
-00000740: 1061 0809 d40f 1011 122b 2c0c 0c54 6b69  .a.......+,..Tki
-00000750: 6e64 1073 0909 d40f 1011 1230 310c 1a55  nd.s.......01..U
-00000760: 6c61 6265 6c10 6409 08d4 0f10 1112 3536  label.d.......56
-00000770: 0c1a 5776 6572 7369 6f6e 104b 0908 d40f  ..Wversion.K....
-00000780: 1011 123a 140c 1a58 636f 6d6d 656e 7473  ...:...Xcomments
-00000790: 0908 d40f 1011 123e 3f1a 1a5e 6461 7465  .......>?..^date
-000007a0: 4c61 7374 4f70 656e 6564 10c8 0808 d40f  LastOpened......
-000007b0: 1011 1243 1e1a 1a59 6461 7465 4164 6465  ...C...YdateAdde
-000007c0: 6408 08d4 1210 110f 1a48 1a4a 0810 d208  d........H.J....
-000007d0: 5a73 6861 7265 4f77 6e65 72d4 1210 110f  ZshareOwner.....
-000007e0: 1a48 1a4e 0808 5f10 0f73 6861 7265 4c61  .H.N.._..shareLa
-000007f0: 7374 4564 6974 6f72 d412 1011 0f1a 481a  stEditor......H.
-00000800: 5208 085f 0000 0001 0000 0000 0000 080b  R.._............
+00000740: 1011 122b 2c0c 0c54 6b69 6e64 1073 0909  ...+,..Tkind.s..
+00000750: d40f 1011 1230 310c 1a55 6c61 6265 6c10  .....01..Ulabel.
+00000760: 6409 08d4 0f10 1112 3536 0c1a 5776 6572  d.......56..Wver
+00000770: 7369 6f6e 104b 0908 d40f 1011 123a 140c  sion.K.......:..
+00000780: 1a58 636f 6d6d 656e 7473 0908 d40f 1011  .Xcomments......
+00000790: 123e 3f1a 1a5e 6461 7465 4c61 7374 4f70  .>?..^dateLastOp
+000007a0: 656e 6564 10c8 0808 d40f 1011 1243 1e1a  ened.........C..
+000007b0: 1a59 6461 7465 4164 6465 6408 08d4 1210  .YdateAdded.....
+000007c0: 110f 1a48 1a4a 0810 d208 5a73 6861 7265  ...H.J....Zshare
+000007d0: 4f77 6e65 72d4 1210 110f 1a48 1a4e 0808  Owner......H.N..
+000007e0: 5f10 0f73 6861 7265 4c61 7374 4564 6974  _..shareLastEdit
+000007f0: 6f72 d412 1011 0f1a 481a 5208 085f 1010  or......H.R.._..
+00000800: 696e 7669 0000 0001 0000 0000 0000 080b  invi............
 00000810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -292,20 +292,20 @@
 00001230: 4c01 4d01 4f01 5001 5201 5b01 5c01 5e01  L.M.O.P.R.[.\.^.
 00001240: 5f01 6101 6a01 6b01 6c01 6e01 7701 7801  _.a.j.k.l.n.w.x.
 00001250: 7a01 7b01 7d01 8601 8701 8901 8a01 8c01  z.{.}...........
 00001260: 9501 9601 9801 9901 9b01 9c01 a501 b200  ................
 00001270: 0000 0000 0002 0100 0000 0000 0000 4900  ..............I.
 00001280: 0000 0000 0000 0000 0000 0000 0001 b300  ................
 00001290: 0000 0700 7300 6100 6e00 6400 6200 6f00  ....s.a.n.d.b.o.
-000012a0: 786d 6f44 4462 6c6f 6200 0000 0854 90ea  xmoDDblob....T..
-000012b0: ad14 e3c5 4100 0000 0700 7300 6100 6e00  ....A.....s.a.n.
+000012a0: 786d 6f44 4462 6c6f 6200 0000 0853 8931  xmoDDblob....S.1
+000012b0: 9d39 ecc5 4100 0000 0700 7300 6100 6e00  .9..A.....s.a.n.
 000012c0: 6400 6200 6f00 786d 6f64 4462 6c6f 6200  d.b.o.xmodDblob.
-000012d0: 0000 0854 90ea ad14 e3c5 4100 0000 0700  ...T......A.....
+000012d0: 0000 0853 8931 9d39 ecc5 4100 0000 0700  ...S.1.9..A.....
 000012e0: 7300 6100 6e00 6400 6200 6f00 7870 6831  s.a.n.d.b.o.xph1
-000012f0: 5363 6f6d 7000 0000 0000 0da0 0000 0000  Scomp...........
+000012f0: 5363 6f6d 7000 0000 0000 1140 0000 0000  Scomp......@....
 00001300: 0700 7300 6100 6e00 6400 6200 6f00 7876  ..s.a.n.d.b.o.xv
 00001310: 5372 6e6c 6f6e 6700 0000 0100 0000 1b00  Srnlong.........
 00001320: 7400 6800 6900 7200 6400 5f00 7000 6100  t.h.i.r.d._.p.a.
 00001330: 7200 7400 7900 5f00 6c00 6100 6200 6500  r.t.y._.l.a.b.e.
 00001340: 6c00 5f00 6100 7000 7000 6500 6e00 6400  l._.a.p.p.e.n.d.
 00001350: 6500 7200 736c 6731 5363 6f6d 7000 0000  e.r.slg1Scomp...
 00001360: 0000 034f 3f00 0000 1b00 7400 6800 6900  ...O?.....t.h.i.
@@ -320,20 +320,20 @@
 000013f0: 4462 6c6f 6200 0000 088e 6402 d844 c7c5  Dblob.....d..D..
 00001400: 4100 0000 1b00 7400 6800 6900 7200 6400  A.....t.h.i.r.d.
 00001410: 5f00 7000 6100 7200 7400 7900 5f00 6c00  _.p.a.r.t.y._.l.
 00001420: 6100 6200 6500 6c00 5f00 6100 7000 7000  a.b.e.l._.a.p.p.
 00001430: 6500 6e00 6400 6500 7200 7370 6831 5363  e.n.d.e.r.sph1Sc
 00001440: 6f6d 7000 0000 0000 0440 0000 0000 0200  omp......@......
 00001450: 7500 696c 6731 5363 6f6d 7000 0000 0000  u.ilg1Scomp.....
-00001460: 0c5d 3700 0000 0200 7500 696d 6f44 4462  .]7.....u.imoDDb
-00001470: 6c6f 6200 0000 08ed 1d48 4118 e0c5 4100  lob......HA...A.
+00001460: 0cd0 3c00 0000 0200 7500 696d 6f44 4462  ..<.....u.imoDDb
+00001470: 6c6f 6200 0000 0874 394b 535b e7c5 4100  lob....t9KS[..A.
 00001480: 0000 0200 7500 696d 6f64 4462 6c6f 6200  ....u.imodDblob.
-00001490: 0000 08ed 1d48 4118 e0c5 4100 0000 0200  .....HA...A.....
+00001490: 0000 0874 394b 535b e7c5 4100 0000 0200  ...t9KS[..A.....
 000014a0: 7500 6970 6831 5363 6f6d 7000 0000 0000  u.iph1Scomp.....
-000014b0: 0ff0 0000 0000 0c00 7500 6e00 7300 7500  ........u.n.s.u.
+000014b0: 1070 0000 0000 0c00 7500 6e00 7300 7500  .p......u.n.s.u.
 000014c0: 7000 6500 7200 7600 6900 7300 6500 6462  p.e.r.v.i.s.e.db
 000014d0: 7773 7062 6c6f 6200 0000 b862 706c 6973  wspblob....bplis
 000014e0: 7430 30d6 0102 0304 0506 0708 0708 0b08  t00.............
 000014f0: 5d53 686f 7753 7461 7475 7342 6172 5b53  ]ShowStatusBar[S
 00001500: 686f 7754 6f6f 6c62 6172 5b53 686f 7754  howToolbar[ShowT
 00001510: 6162 5669 6577 5f10 1443 6f6e 7461 696e  abView_..Contain
 00001520: 6572 5368 6f77 5369 6465 6261 725c 5769  erShowSidebar\Wi
@@ -453,27 +453,27 @@
 00001c40: 626c 6f62 0000 00b8 6270 6c69 7374 3030  blob....bplist00
 00001c50: d601 0203 0405 0607 0807 080b 085d 5368  .............]Sh
 00001c60: 6f77 5374 6174 7573 4261 725b 5368 6f77  owStatusBar[Show
 00001c70: 546f 6f6c 6261 725b 5368 6f77 5461 6256  Toolbar[ShowTabV
 00001c80: 6965 775f 1014 436f 6e74 6169 6e65 7253  iew_..ContainerS
 00001c90: 686f 7753 6964 6562 6172 5c57 696e 646f  howSidebar\Windo
 00001ca0: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
-00001cb0: 6261 7208 0908 095f 1018 7b7b 3333 392c  bar...._..{{339,
-00001cc0: 2033 3532 7d2c 207b 3932 302c 2034 3336   352}, {920, 436
+00001cb0: 6261 7208 0908 095f 1018 7b7b 3135 312c  bar...._..{{151,
+00001cc0: 2039 367d 2c20 7b31 3138 302c 2035 3638   96}, {1180, 568
 00001cd0: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8a  }}...#/;R_klmno.
 00001ce0: 0000 0000 0000 0101 0000 0000 0000 000d  ................
 00001cf0: 0000 0000 0000 0000 0000 0000 0000 008b  ................
 00001d00: 0000 0005 0075 0074 0069 006c 0073 6c67  .....u.t.i.l.slg
-00001d10: 3153 636f 6d70 0000 0000 0007 e52f 0000  1Scomp......./..
+00001d10: 3153 636f 6d70 0000 0000 0008 0f47 0000  1Scomp.......G..
 00001d20: 0005 0075 0074 0069 006c 0073 6d6f 4444  ...u.t.i.l.smoDD
-00001d30: 626c 6f62 0000 0008 6589 25de 0fe3 c541  blob....e.%....A
+00001d30: 626c 6f62 0000 0008 b23a 48d8 4aed c541  blob.....:H.J..A
 00001d40: 0000 0005 0075 0074 0069 006c 0073 6d6f  .....u.t.i.l.smo
-00001d50: 6444 626c 6f62 0000 0008 6589 25de 0fe3  dDblob....e.%...
+00001d50: 6444 626c 6f62 0000 0008 b23a 48d8 4aed  dDblob.....:H.J.
 00001d60: c541 0000 0005 0075 0074 0069 006c 0073  .A.....u.t.i.l.s
-00001d70: 7068 3153 636f 6d70 0000 0000 0008 f000  ph1Scomp........
+00001d70: 7068 3153 636f 6d70 0000 0000 0009 2000  ph1Scomp...... .
 00001d80: 0000 0005 0075 0074 0069 006c 0073 7653  .....u.t.i.l.svS
 00001d90: 726e 6c6f 6e67 0000 0001 0000 0010 0076  rnlong.........v
 00001da0: 0069 0064 0065 006f 005f 0070 0072 006f  .i.d.e.o._.p.r.o
 00001db0: 0063 0065 0073 0073 006f 0072 0073 6277  .c.e.s.s.o.r.sbw
 00001dc0: 7370 626c 6f62 0000 00b8 6270 6c69 7374  spblob....bplist
 00001dd0: 3030 d601 0203 0405 0607 0807 080b 085d  00.............]
 00001de0: 5368 6f77 5374 6174 7573 4261 725b 5368  ShowStatusBar[Sh
@@ -485,47 +485,47 @@
 00001e40: 392c 2033 3532 7d2c 207b 3932 302c 2034  9, 352}, {920, 4
 00001e50: 3336 7d7d 0908 1523 2f3b 525f 6b6c 6d6e  36}}...#/;R_klmn
 00001e60: 6f8a 0000 0000 0000 0101 0000 0000 0000  o...............
 00001e70: 000d 0000 0000 0000 0000 0000 0000 0000  ................
 00001e80: 008b 0000 0010 0076 0069 0064 0065 006f  .......v.i.d.e.o
 00001e90: 005f 0070 0072 006f 0063 0065 0073 0073  ._.p.r.o.c.e.s.s
 00001ea0: 006f 0072 0073 6c67 3153 636f 6d70 0000  .o.r.slg1Scomp..
-00001eb0: 0000 0005 cb2d 0000 0010 0076 0069 0064  .....-.....v.i.d
+00001eb0: 0000 0005 e7c5 0000 0010 0076 0069 0064  ...........v.i.d
 00001ec0: 0065 006f 005f 0070 0072 006f 0063 0065  .e.o._.p.r.o.c.e
 00001ed0: 0073 0073 006f 0072 0073 6d6f 4444 626c  .s.s.o.r.smoDDbl
-00001ee0: 6f62 0000 0008 08d1 aa9f 0fe3 c541 0000  ob...........A..
+00001ee0: 6f62 0000 0008 3801 a3ae 30e8 c541 0000  ob....8...0..A..
 00001ef0: 0010 0076 0069 0064 0065 006f 005f 0070  ...v.i.d.e.o._.p
 00001f00: 0072 006f 0063 0065 0073 0073 006f 0072  .r.o.c.e.s.s.o.r
-00001f10: 0073 6d6f 6444 626c 6f62 0000 0008 08d1  .smodDblob......
-00001f20: aa9f 0fe3 c541 0000 0010 0076 0069 0064  .....A.....v.i.d
+00001f10: 0073 6d6f 6444 626c 6f62 0000 0008 3801  .smodDblob....8.
+00001f20: a3ae 30e8 c541 0000 0010 0076 0069 0064  ..0..A.....v.i.d
 00001f30: 0065 006f 005f 0070 0072 006f 0063 0065  .e.o._.p.r.o.c.e
 00001f40: 0073 0073 006f 0072 0073 7068 3153 636f  .s.s.o.r.sph1Sco
-00001f50: 6d70 0000 0000 0006 a000 0000 0010 0076  mp.............v
+00001f50: 6d70 0000 0000 0006 c000 0000 0010 0076  mp.............v
 00001f60: 0069 0064 0065 006f 005f 0070 0072 006f  .i.d.e.o._.p.r.o
 00001f70: 0063 0065 0073 0073 006f 0072 0073 7653  .c.e.s.s.o.r.svS
 00001f80: 726e 6c6f 6e67 0000 0001 0000 0000 0000  rnlong..........
 00001f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002000: 0000 0000 0000 0000 0000 002f 0000 000b  .........../....
 00002010: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00002020: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00002030: 0000 0000 e07d 0000 000b 005f 005f 0070  .....}....._._.p
+00002030: 0000 0000 e28b 0000 000b 005f 005f 0070  ..........._._.p
 00002040: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00002050: 6d6f 4444 626c 6f62 0000 0008 4db3 b752  moDDblob....M..R
-00002060: 18e0 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
+00002050: 6d6f 4444 626c 6f62 0000 0008 e6a6 3675  moDDblob......6u
+00002060: d7e6 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
 00002070: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00002080: 6444 626c 6f62 0000 0008 4db3 b752 18e0  dDblob....M..R..
+00002080: 6444 626c 6f62 0000 0008 e6a6 3675 d7e6  dDblob......6u..
 00002090: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000020a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
-000020b0: 636f 6d70 0000 0000 0000 f000 0000 0006  comp............
+000020b0: 636f 6d70 0000 0000 0001 0000 0000 0006  comp............
 000020c0: 0061 0073 0073 0065 0074 0073 6277 7370  .a.s.s.e.t.sbwsp
 000020d0: 626c 6f62 0000 00b7 6270 6c69 7374 3030  blob....bplist00
 000020e0: d601 0203 0405 0607 0807 080b 085d 5368  .............]Sh
 000020f0: 6f77 5374 6174 7573 4261 725b 5368 6f77  owStatusBar[Show
 00002100: 546f 6f6c 6261 725b 5368 6f77 5461 6256  Toolbar[ShowTabV
 00002110: 6965 775f 1014 436f 6e74 6169 6e65 7253  iew_..ContainerS
 00002120: 686f 7753 6964 6562 6172 5c57 696e 646f  howSidebar\Windo
@@ -558,19 +558,19 @@
 000022d0: 6f64 4462 6c6f 6200 0000 08ac 91fa d12e  odDblob.........
 000022e0: bac5 4100 0000 1200 6200 6f00 7500 6e00  ..A.....b.o.u.n.
 000022f0: 6400 6900 6e00 6700 5f00 6200 6f00 7800  d.i.n.g._.b.o.x.
 00002300: 5f00 7400 6f00 6f00 6c00 7370 6831 5363  _.t.o.o.l.sph1Sc
 00002310: 6f6d 7000 0000 0000 03d0 0000 0000 0f00  omp.............
 00002320: 6300 7500 6500 5f00 6c00 6900 6700 6800  c.u.e._.l.i.g.h.
 00002330: 7400 5f00 7400 6f00 6f00 6c00 736c 6731  t._.t.o.o.l.slg1
-00002340: 5363 6f6d 7000 0000 0000 02b2 7a00 0000  Scomp.......z...
+00002340: 5363 6f6d 7000 0000 0000 02b2 7d00 0000  Scomp.......}...
 00002350: 0f00 6300 7500 6500 5f00 6c00 6900 6700  ..c.u.e._.l.i.g.
 00002360: 6800 7400 5f00 7400 6f00 6f00 6c00 736d  h.t._.t.o.o.l.sm
-00002370: 6f44 4462 6c6f 6200 0000 08ee a3af e904  oDDblob.........
-00002380: bac5 4100 0000 0f00 6300 7500 6500 5f00  ..A.....c.u.e._.
+00002370: 6f44 4462 6c6f 6200 0000 08e8 2ad1 274b  oDDblob.....*.'K
+00002380: edc5 4100 0000 0f00 6300 7500 6500 5f00  ..A.....c.u.e._.
 00002390: 6c00 6900 6700 6800 7400 5f00 7400 6f00  l.i.g.h.t._.t.o.
 000023a0: 6f00 6c00 736d 6f64 4462 6c6f 6200 0000  o.l.smodDblob...
 000023b0: 08ee a3af e904 bac5 4100 0000 0f00 6300  ........A.....c.
 000023c0: 7500 6500 5f00 6c00 6900 6700 6800 7400  u.e._.l.i.g.h.t.
 000023d0: 5f00 7400 6f00 6f00 6c00 7370 6831 5363  _.t.o.o.l.sph1Sc
 000023e0: 6f6d 7000 0000 0000 0380 0000 0000 0800  omp.............
 000023f0: 6400 6100 7300 6800 5f00 6100 7000 706c  d.a.s.h._.a.p.pl
@@ -581,25 +581,25 @@
 00002440: 7300 6800 5f00 6100 7000 706d 6f64 4462  s.h._.a.p.pmodDb
 00002450: 6c6f 6200 0000 08de 5fc4 870a bac5 4100  lob....._.....A.
 00002460: 0000 0800 6400 6100 7300 6800 5f00 6100  ....d.a.s.h._.a.
 00002470: 7000 7070 6831 5363 6f6d 7000 0000 0000  p.pph1Scomp.....
 00002480: 0200 0000 0000 0f00 6400 6100 7400 6100  ........d.a.t.a.
 00002490: 5f00 7000 7200 6f00 6300 6500 7300 7300  _.p.r.o.c.e.s.s.
 000024a0: 6f00 7200 736c 6731 5363 6f6d 7000 0000  o.r.slg1Scomp...
-000024b0: 0000 073c 1400 0000 0f00 6400 6100 7400  ...<......d.a.t.
+000024b0: 0000 072b b500 0000 0f00 6400 6100 7400  ...+......d.a.t.
 000024c0: 6100 5f00 7000 7200 6f00 6300 6500 7300  a._.p.r.o.c.e.s.
 000024d0: 7300 6f00 7200 736d 6f44 4462 6c6f 6200  s.o.r.smoDDblob.
-000024e0: 0000 0893 9d02 bd85 dfc5 4100 0000 0f00  ..........A.....
+000024e0: 0000 08a4 dba8 7fc7 ecc5 4100 0000 0f00  ..........A.....
 000024f0: 6400 6100 7400 6100 5f00 7000 7200 6f00  d.a.t.a._.p.r.o.
 00002500: 6300 6500 7300 7300 6f00 7200 736d 6f64  c.e.s.s.o.r.smod
-00002510: 4462 6c6f 6200 0000 0893 9d02 bd85 dfc5  Dblob...........
+00002510: 4462 6c6f 6200 0000 0867 018f 40e2 e8c5  Dblob....g..@...
 00002520: 4100 0000 0f00 6400 6100 7400 6100 5f00  A.....d.a.t.a._.
 00002530: 7000 7200 6f00 6300 6500 7300 7300 6f00  p.r.o.c.e.s.s.o.
 00002540: 7200 7370 6831 5363 6f6d 7000 0000 0000  r.sph1Scomp.....
-00002550: 0900 0000 0000 1200 6600 6500 6100 7400  ........f.e.a.t.
+00002550: 0910 0000 0000 1200 6600 6500 6100 7400  ........f.e.a.t.
 00002560: 7500 7200 6500 5f00 6500 7800 7400 7200  u.r.e._.e.x.t.r.
 00002570: 6100 6300 7400 6f00 7200 7362 7773 7062  a.c.t.o.r.sbwspb
 00002580: 6c6f 6200 0000 b962 706c 6973 7430 30d6  lob....bplist00.
 00002590: 0102 0304 0506 0708 0708 0b08 5d53 686f  ............]Sho
 000025a0: 7753 7461 7475 7342 6172 5b53 686f 7754  wStatusBar[ShowT
 000025b0: 6f6f 6c62 6172 5b53 686f 7754 6162 5669  oolbar[ShowTabVi
 000025c0: 6577 5f10 1443 6f6e 7461 696e 6572 5368  ew_..ContainerSh
@@ -648,15 +648,15 @@
 00002870: 7742 6f75 6e64 735b 5368 6f77 5369 6465  wBounds[ShowSide
 00002880: 6261 7208 0908 095f 1018 7b7b 3238 392c  bar...._..{{289,
 00002890: 2033 3030 7d2c 207b 3932 302c 2034 3336   300}, {920, 436
 000028a0: 7d7d 0908 1523 2f3b 525f 6b6c 6d6e 6f8a  }}...#/;R_klmno.
 000028b0: 0000 0000 0000 0101 0000 0000 0000 000d  ................
 000028c0: 0000 0000 0000 0000 0000 0000 0000 008b  ................
 000028d0: 0000 0006 006d 0069 0078 0069 006e 0073  .....m.i.x.i.n.s
-000028e0: 6c67 3153 636f 6d70 0000 0000 0191 a7a5  lg1Scomp........
+000028e0: 6c67 3153 636f 6d70 0000 0000 01b3 917a  lg1Scomp.......z
 000028f0: 0000 0006 006d 0069 0078 0069 006e 0073  .....m.i.x.i.n.s
 00002900: 6c73 7643 626c 6f62 0000 030a 6270 6c69  lsvCblob....bpli
 00002910: 7374 3030 d801 0203 0405 0607 0809 0a0b  st00............
 00002920: 1b55 560a 5858 6963 6f6e 5369 7a65 5f10  .UV.XXiconSize_.
 00002930: 0f73 686f 7749 636f 6e50 7265 7669 6577  .showIconPreview
 00002940: 5763 6f6c 756d 6e73 5f10 1163 616c 6375  Wcolumns_..calcu
 00002950: 6c61 7465 416c 6c53 697a 6573 5874 6578  lateAllSizesXtex
@@ -740,28 +740,28 @@
 00002e30: 4101 4201 4301 4c01 4e01 5001 5101 5201  A.B.C.L.N.P.Q.R.
 00002e40: 5b01 5d01 5f01 6001 6101 6a01 6c01 6d01  [.]._.`.a.j.l.m.
 00002e50: 6e01 7701 7901 7b01 7c01 7d01 8601 8801  n.w.y.{.|.}.....
 00002e60: 8901 8a01 9301 9501 9701 9801 9901 9a01  ................
 00002e70: a301 b000 0000 0000 0002 0100 0000 0000  ................
 00002e80: 0000 4800 0000 0000 0000 0000 0000 0000  ..H.............
 00002e90: 0001 b100 0000 0600 6d00 6900 7800 6900  ........m.i.x.i.
-00002ea0: 6e00 736d 6f44 4462 6c6f 6200 0000 084b  n.smoDDblob....K
-00002eb0: c8be cede e2c5 4100 0000 0600 6d00 6900  ......A.....m.i.
+00002ea0: 6e00 736d 6f44 4462 6c6f 6200 0000 087f  n.smoDDblob.....
+00002eb0: 69d4 ed49 edc5 4100 0000 0600 6d00 6900  i..I..A.....m.i.
 00002ec0: 7800 6900 6e00 736d 6f64 4462 6c6f 6200  x.i.n.smodDblob.
-00002ed0: 0000 084b c8be cede e2c5 4100 0000 0600  ...K......A.....
+00002ed0: 0000 087f 69d4 ed49 edc5 4100 0000 0600  ....i..I..A.....
 00002ee0: 6d00 6900 7800 6900 6e00 7370 6831 5363  m.i.x.i.n.sph1Sc
-00002ef0: 6f6d 7000 0000 0001 a260 0000 0000 0600  omp......`......
+00002ef0: 6f6d 7000 0000 0001 c5a0 0000 0000 0600  omp.............
 00002f00: 6d00 6900 7800 6900 6e00 7376 5372 6e6c  m.i.x.i.n.svSrnl
 00002f10: 6f6e 6700 0000 0100 0000 0500 6d00 6f00  ong.........m.o.
 00002f20: 6400 6500 6c6c 6731 5363 6f6d 7000 0000  d.e.llg1Scomp...
-00002f30: 0000 022a bc00 0000 0500 6d00 6f00 6400  ...*......m.o.d.
-00002f40: 6500 6c6d 6f44 4462 6c6f 6200 0000 0895  e.lmoDDblob.....
-00002f50: a698 57bf e2c5 4100 0000 0500 6d00 6f00  ..W...A.....m.o.
+00002f30: 0000 022a cc00 0000 0500 6d00 6f00 6400  ...*......m.o.d.
+00002f40: 6500 6c6d 6f44 4462 6c6f 6200 0000 08a7  e.lmoDDblob.....
+00002f50: 66df 3665 e7c5 4100 0000 0500 6d00 6f00  f.6e..A.....m.o.
 00002f60: 6400 6500 6c6d 6f64 4462 6c6f 6200 0000  d.e.lmodDblob...
-00002f70: 0895 a698 57bf e2c5 416f 0072 0073 7653  ....W...Ao.r.svS
+00002f70: 08a7 66df 3665 e7c5 416f 0072 0073 7653  ..f.6e..Ao.r.svS
 00002f80: 726e 6c6f 6e67 0000 0001 0000 0000 0000  rnlong..........
 00002f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00002fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -776,253 +776,253 @@
 00003070: 006f 0075 0074 006c 0069 0065 0072 005f  .o.u.t.l.i.e.r._
 00003080: 0074 006f 006f 006c 0073 6d6f 6444 626c  .t.o.o.l.smodDbl
 00003090: 6f62 0000 0008 f9a3 b7e9 04ba c541 0000  ob...........A..
 000030a0: 000d 006f 0075 0074 006c 0069 0065 0072  ...o.u.t.l.i.e.r
 000030b0: 005f 0074 006f 006f 006c 0073 7068 3153  ._.t.o.o.l.sph1S
 000030c0: 636f 6d70 0000 0000 0002 4000 0000 0008  comp......@.....
 000030d0: 0070 006c 006f 0074 0074 0069 006e 0067  .p.l.o.t.t.i.n.g
-000030e0: 6277 7370 626c 6f62 0000 00b8 6270 6c69  bwspblob....bpli
+000030e0: 6277 7370 626c 6f62 0000 00b9 6270 6c69  bwspblob....bpli
 000030f0: 7374 3030 d601 0203 0405 0607 0807 080b  st00............
 00003100: 085d 5368 6f77 5374 6174 7573 4261 725b  .]ShowStatusBar[
 00003110: 5368 6f77 546f 6f6c 6261 725b 5368 6f77  ShowToolbar[Show
 00003120: 5461 6256 6965 775f 1014 436f 6e74 6169  TabView_..Contai
 00003130: 6e65 7253 686f 7753 6964 6562 6172 5c57  nerShowSidebar\W
 00003140: 696e 646f 7742 6f75 6e64 735b 5368 6f77  indowBounds[Show
-00003150: 5369 6465 6261 7208 0908 095f 1018 7b7b  Sidebar...._..{{
-00003160: 3333 392c 2033 3532 7d2c 207b 3932 302c  339, 352}, {920,
-00003170: 2034 3336 7d7d 0908 1523 2f3b 525f 6b6c   436}}...#/;R_kl
-00003180: 6d6e 6f8a 0000 0000 0000 0101 0000 0000  mno.............
-00003190: 0000 000d 0000 0000 0000 0000 0000 0000  ................
-000031a0: 0000 008b 0000 0008 0070 006c 006f 0074  .........p.l.o.t
-000031b0: 0074 0069 006e 0067 6c67 3153 636f 6d70  .t.i.n.glg1Scomp
-000031c0: 0000 0000 000f bd3d 0000 0008 0070 006c  .......=.....p.l
-000031d0: 006f 0074 0074 0069 006e 0067 6c73 7643  .o.t.t.i.n.glsvC
-000031e0: 626c 6f62 0000 0326 6270 6c69 7374 3030  blob...&bplist00
-000031f0: da01 0203 0405 0607 0809 0a0b 0c0d 1a54  ...............T
-00003200: 5556 570c 5958 6963 6f6e 5369 7a65 5f10  UVW.YXiconSize_.
-00003210: 0f73 686f 7749 636f 6e50 7265 7669 6577  .showIconPreview
-00003220: 5763 6f6c 756d 6e73 5f10 1163 616c 6375  Wcolumns_..calcu
-00003230: 6c61 7465 416c 6c53 697a 6573 5f10 0f73  lateAllSizes_..s
-00003240: 6372 6f6c 6c50 6f73 6974 696f 6e59 5874  crollPositionYXt
-00003250: 6578 7453 697a 655f 100f 7363 726f 6c6c  extSize_..scroll
-00003260: 506f 7369 7469 6f6e 585a 736f 7274 436f  PositionXZsortCo
-00003270: 6c75 6d6e 5f10 1075 7365 5265 6c61 7469  lumn_..useRelati
-00003280: 7665 4461 7465 735f 1012 7669 6577 4f70  veDates_..viewOp
-00003290: 7469 6f6e 7356 6572 7369 6f6e 2340 3000  tionsVersion#@0.
-000032a0: 0000 0000 0009 ae0e 171c 2125 2a2f 3439  ..........!%*/49
-000032b0: 3d42 464b 4fd4 0f10 1112 1314 0c0c 5a69  =BFKO.........Zi
-000032c0: 6465 6e74 6966 6965 7255 7769 6474 6859  dentifierUwidthY
-000032d0: 6173 6365 6e64 696e 6757 7669 7369 626c  ascendingWvisibl
-000032e0: 6554 6e61 6d65 1101 2c09 09d4 0f10 1112  eTname..,.......
-000032f0: 1819 1a1a 5875 6269 7175 6974 7910 2308  ....Xubiquity.#.
-00003300: 08d4 0f10 1112 1d1e 1a0c 5c64 6174 654d  ..........\dateM
-00003310: 6f64 6966 6965 6410 b508 09d4 0f10 1112  odified.........
-00003320: 221e 1a1a 5b64 6174 6543 7265 6174 6564  "...[dateCreated
-00003330: 0808 d40f 1011 1226 271a 0c54 7369 7a65  .......&'..Tsize
-00003340: 1061 0809 d40f 1011 122b 2c0c 0c54 6b69  .a.......+,..Tki
-00003350: 6e64 1073 0909 d40f 1011 1230 310c 1a55  nd.s.......01..U
-00003360: 6c61 6265 6c10 6409 08d4 0f10 1112 3536  label.d.......56
-00003370: 0c1a 5776 6572 7369 6f6e 104b 0908 d40f  ..Wversion.K....
-00003380: 1011 123a 140c 1a58 636f 6d6d 656e 7473  ...:...Xcomments
-00003390: 0908 d40f 1011 123e 3f1a 1a5e 6461 7465  .......>?..^date
-000033a0: 4c61 7374 4f70 656e 6564 10c8 0808 d40f  LastOpened......
-000033b0: 1011 1243 1e1a 1a59 6461 7465 4164 6465  ...C...YdateAdde
-000033c0: 6408 08d4 1210 110f 1a48 1a4a 0810 d208  d........H.J....
-000033d0: 5a73 6861 7265 4f77 6e65 72d4 1210 110f  ZshareOwner.....
-000033e0: 1a48 1a4e 0808 5f10 0f73 6861 7265 4c61  .H.N.._..shareLa
-000033f0: 7374 4564 6974 6f72 d412 1011 0f1a 481a  stEditor......H.
-00003400: 5208 085f 1010 696e 7669 7461 7469 6f6e  R.._..invitation
-00003410: 5374 6174 7573 0823 4078 f000 0000 0000  Status.#@x......
-00003420: 2340 2800 0000 0000 0023 0000 0000 0000  #@(......#......
-00003430: 0000 546e 616d 6509 1001 0008 001d 0026  ..Tname........&
-00003440: 0038 0040 0054 0066 006f 0081 008c 009f  .8.@.T.f.o......
-00003450: 00b4 00bd 00be 00cd 00d6 00e1 00e7 00f1  ................
-00003460: 00f9 00fe 0101 0102 0103 010c 0115 0117  ................
-00003470: 0118 0119 0122 012f 0131 0132 0133 013c  ....."./.1.2.3.<
-00003480: 0148 0149 014a 0153 0158 015a 015b 015c  .H.I.J.S.X.Z.[.\
-00003490: 0165 016a 016c 016d 016e 0177 017d 017f  .e.j.l.m.n.w.}..
-000034a0: 0180 0181 018a 0192 0194 0195 0196 019f  ................
-000034b0: 01a8 01a9 01aa 01b3 01c2 01c4 01c5 01c6  ................
-000034c0: 01cf 01d9 01da 01db 01e4 01e5 01e7 01e8  ................
-000034d0: 01f3 01fc 01fd 01fe 0210 0219 021a 021b  ................
-000034e0: 022e 022f 0238 0241 024a 024f 0250 0000  .../.8.A.J.O.P..
-000034f0: 0000 0000 0201 0000 0000 0000 005a 0000  .............Z..
-00003500: 0000 0000 0000 0000 0000 0000 0252 0000  .............R..
-00003510: 0008 0070 006c 006f 0074 0074 0069 006e  ...p.l.o.t.t.i.n
-00003520: 0067 6c73 7670 626c 6f62 0000 029b 6270  .glsvpblob....bp
-00003530: 6c69 7374 3030 da01 0203 0405 0607 0809  list00..........
-00003540: 0a0b 0c0d 1c47 4849 4a0c 3758 6963 6f6e  .....GHIJ.7Xicon
-00003550: 5369 7a65 5f10 0f73 686f 7749 636f 6e50  Size_..showIconP
-00003560: 7265 7669 6577 5763 6f6c 756d 6e73 5f10  reviewWcolumns_.
-00003570: 1163 616c 6375 6c61 7465 416c 6c53 697a  .calculateAllSiz
-00003580: 6573 5f10 0f73 6372 6f6c 6c50 6f73 6974  es_..scrollPosit
-00003590: 696f 6e59 5874 6578 7453 697a 655f 100f  ionYXtextSize_..
-000035a0: 7363 726f 6c6c 506f 7369 7469 6f6e 585a  scrollPositionXZ
-000035b0: 736f 7274 436f 6c75 6d6e 5f10 1075 7365  sortColumn_..use
-000035c0: 5265 6c61 7469 7665 4461 7465 735f 1012  RelativeDates_..
-000035d0: 7669 6577 4f70 7469 6f6e 7356 6572 7369  viewOptionsVersi
-000035e0: 6f6e 2340 3000 0000 0000 0009 d90e 0f10  on#@0...........
-000035f0: 1112 1314 1516 1720 252a 2f34 383d 4158  ....... %*/48=AX
-00003600: 636f 6d6d 656e 7473 556c 6162 656c 5776  commentsUlabelWv
-00003610: 6572 7369 6f6e 5b64 6174 6543 7265 6174  ersion[dateCreat
-00003620: 6564 5473 697a 655c 6461 7465 4d6f 6469  edTsize\dateModi
-00003630: 6669 6564 546b 696e 6454 6e61 6d65 5e64  fiedTkindTname^d
-00003640: 6174 654c 6173 744f 7065 6e65 64d4 1819  ateLastOpened...
-00003650: 1a1b 1c1d 0c1f 5776 6973 6962 6c65 5577  ......WvisibleUw
-00003660: 6964 7468 5961 7363 656e 6469 6e67 5569  idthYascendingUi
-00003670: 6e64 6578 0811 012c 0910 07d4 1819 1a1b  ndex...,........
-00003680: 1c22 0c24 0810 6409 1005 d418 191a 1b1c  .".$..d.........
-00003690: 270c 2908 104b 0910 06d4 1819 1a1b 1c2c  '.)..K.........,
-000036a0: 1c2e 0810 b508 1002 d418 191a 1b0c 311c  ..............1.
-000036b0: 3309 1061 0810 03d4 1819 1a1b 0c2c 1c37  3..a.........,.7
-000036c0: 0908 1001 d418 191a 1b0c 3a0c 3c09 1073  ..........:.<..s
-000036d0: 0910 04d4 1819 1a1b 0c1d 0c40 0909 1000  ...........@....
-000036e0: d418 191a 1b1c 431c 4508 10c8 0810 0808  ......C.E.......
-000036f0: 2340 78f0 0000 0000 0023 4028 0000 0000  #@x......#@(....
-00003700: 0000 2300 0000 0000 0000 0054 6e61 6d65  ..#........Tname
-00003710: 0900 0800 1d00 2600 3800 4000 5400 6600  ......&.8.@.T.f.
-00003720: 6f00 8100 8c00 9f00 b400 bd00 be00 d100  o...............
-00003730: da00 e000 e800 f400 f901 0601 0b01 1001  ................
-00003740: 1f01 2801 3001 3601 4001 4601 4701 4a01  ..(.0.6.@.F.G.J.
-00003750: 4b01 4d01 5601 5701 5901 5a01 5c01 6501  K.M.V.W.Y.Z.\.e.
-00003760: 6601 6801 6901 6b01 7401 7501 7701 7801  f.h.i.k.t.u.w.x.
-00003770: 7a01 8301 8401 8601 8701 8901 9201 9301  z...............
-00003780: 9401 9601 9f01 a001 a201 a301 a501 ae01  ................
-00003790: af01 b001 b201 bb01 bc01 be01 bf01 c101  ................
-000037a0: c201 cb01 d401 dd01 e200 0000 0000 0002  ................
-000037b0: 0100 0000 0000 0000 4c00 0000 0000 0000  ........L.......
-000037c0: 0000 0000 0000 0001 e300 0000 0800 7000  ..............p.
-000037d0: 6c00 6f00 7400 7400 6900 6e00 676d 6f44  l.o.t.t.i.n.gmoD
-000037e0: 4462 6c6f 6200 0000 0837 24ea ed0f e3c5  Dblob....7$.....
-000037f0: 4100 0000 0800 7000 6c00 6f00 7400 7400  A.....p.l.o.t.t.
-00003800: 6900 6e00 676d 6f64 4462 6c6f 6200 0000  i.n.gmodDblob...
-00003810: 0837 24ea ed0f e3c5 4100 0000 0800 7000  .7$.....A.....p.
-00003820: 6c00 6f00 7400 7400 6900 6e00 6770 6831  l.o.t.t.i.n.gph1
-00003830: 5363 6f6d 7000 0000 0000 1330 0000 0000  Scomp......0....
-00003840: 0800 7000 6c00 6f00 7400 7400 6900 6e00  ..p.l.o.t.t.i.n.
-00003850: 6776 5372 6e6c 6f6e 6700 0000 0100 0000  gvSrnlong.......
-00003860: 1300 7000 6f00 7300 6500 5f00 6300 6f00  ..p.o.s.e._.c.o.
-00003870: 6e00 6600 6900 6700 7500 7200 6100 7400  n.f.i.g.u.r.a.t.
-00003880: 6900 6f00 6e00 7362 7773 7062 6c6f 6200  i.o.n.sbwspblob.
-00003890: 0000 b862 706c 6973 7430 30d6 0102 0304  ...bplist00.....
-000038a0: 0506 0708 0708 0b08 5d53 686f 7753 7461  ........]ShowSta
-000038b0: 7475 7342 6172 5b53 686f 7754 6f6f 6c62  tusBar[ShowToolb
-000038c0: 6172 5b53 686f 7754 6162 5669 6577 5f10  ar[ShowTabView_.
-000038d0: 1443 6f6e 7461 696e 6572 5368 6f77 5369  .ContainerShowSi
-000038e0: 6465 6261 725c 5769 6e64 6f77 426f 756e  debar\WindowBoun
-000038f0: 6473 5b53 686f 7753 6964 6562 6172 0809  ds[ShowSidebar..
-00003900: 0809 5f10 187b 7b33 3436 2c20 3234 337d  .._..{{346, 243}
-00003910: 2c20 7b39 3230 2c20 3433 367d 7d09 0815  , {920, 436}}...
-00003920: 232f 3b52 5f6b 6c6d 6e6f 8a00 0000 0000  #/;R_klmno......
-00003930: 0001 0100 0000 0000 0000 0d00 0000 0000  ................
-00003940: 0000 0000 0000 0000 0000 8b00 0000 1300  ................
-00003950: 7000 6f00 7300 6500 5f00 6300 6f00 6e00  p.o.s.e._.c.o.n.
-00003960: 6600 6900 6700 7500 7200 6100 7400 6900  f.i.g.u.r.a.t.i.
-00003970: 6f00 6e00 736c 6731 5363 6f6d 7000 0000  o.n.slg1Scomp...
-00003980: 0000 06e0 6b00 0000 1300 7000 6f00 7300  ....k.....p.o.s.
-00003990: 6500 5f00 6300 6f00 6e00 6600 6900 6700  e._.c.o.n.f.i.g.
-000039a0: 7500 7200 6100 7400 6900 6f00 6e00 736d  u.r.a.t.i.o.n.sm
-000039b0: 6f44 4462 6c6f 6200 0000 08e3 628e c8ab  oDDblob.....b...
-000039c0: bac5 4100 0000 1300 7000 6f00 7300 6500  ..A.....p.o.s.e.
-000039d0: 5f00 6300 6f00 6e00 6600 6900 6700 7500  _.c.o.n.f.i.g.u.
-000039e0: 7200 6100 7400 6900 6f00 6e00 736d 6f64  r.a.t.i.o.n.smod
-000039f0: 4462 6c6f 6200 0000 08e3 628e c8ab bac5  Dblob.....b.....
-00003a00: 4100 0000 1300 7000 6f00 7300 6500 5f00  A.....p.o.s.e._.
-00003a10: 6300 6f00 6e00 6600 6900 6700 7500 7200  c.o.n.f.i.g.u.r.
-00003a20: 6100 7400 6900 6f00 6e00 7370 6831 5363  a.t.i.o.n.sph1Sc
-00003a30: 6f6d 7000 0000 0000 0760 0000 0000 1300  omp......`......
-00003a40: 7000 6f00 7300 6500 5f00 6300 6f00 6e00  p.o.s.e._.c.o.n.
-00003a50: 6600 6900 6700 7500 7200 6100 7400 6900  f.i.g.u.r.a.t.i.
-00003a60: 6f00 6e00 7376 5372 6e6c 6f6e 6700 0000  o.n.svSrnlong...
-00003a70: 0100 0000 1b00 7000 6f00 7300 6500 5f00  ......p.o.s.e._.
-00003a80: 6300 6f00 6e00 6600 6900 6700 7500 7200  c.o.n.f.i.g.u.r.
-00003a90: 6100 7400 6900 6f00 6e00 7300 5f00 6100  a.t.i.o.n.s._.a.
-00003aa0: 7200 6300 6800 6900 7600 656c 6731 5363  r.c.h.i.v.elg1Sc
-00003ab0: 6f6d 7000 0000 0000 2f03 8a00 0000 1b00  omp...../.......
-00003ac0: 7000 6f00 7300 6500 5f00 6300 6f00 6e00  p.o.s.e._.c.o.n.
-00003ad0: 6600 6900 6700 7500 7200 6100 7400 6900  f.i.g.u.r.a.t.i.
-00003ae0: 6f00 6e00 7300 5f00 6100 7200 6300 6800  o.n.s._.a.r.c.h.
-00003af0: 6900 7600 656d 6f44 4462 6c6f 6200 0000  i.v.emoDDblob...
-00003b00: 08be 0c19 2b0c d7c5 4100 0000 1b00 7000  ....+...A.....p.
-00003b10: 6f00 7300 6500 5f00 6300 6f00 6e00 6600  o.s.e._.c.o.n.f.
-00003b20: 6900 6700 7500 7200 6100 7400 6900 6f00  i.g.u.r.a.t.i.o.
-00003b30: 6e00 7300 5f00 6100 7200 6300 6800 6900  n.s._.a.r.c.h.i.
-00003b40: 7600 656d 6f64 4462 6c6f 6200 0000 08be  v.emodDblob.....
-00003b50: 0c19 2b0c d7c5 4100 0000 1b00 7000 6f00  ..+...A.....p.o.
-00003b60: 7300 6500 5f00 6300 6f00 6e00 6600 6900  s.e._.c.o.n.f.i.
-00003b70: 6700 7500 7200 6100 7400 6900 6f00 6e00  g.u.r.a.t.i.o.n.
-00003b80: 7300 5f00 6100 7200 6300 6800 6900 7600  s._.a.r.c.h.i.v.
-00003b90: 6570 6831 5363 6f6d 7000 0000 0000 3240  eph1Scomp.....2@
-00003ba0: 0000 0000 0e00 7000 6f00 7300 6500 5f00  ......p.o.s.e._.
-00003bb0: 6900 6d00 7000 6f00 7200 7400 6500 7200  i.m.p.o.r.t.e.r.
-00003bc0: 736c 6731 5363 6f6d 7000 0000 0000 0403  slg1Scomp.......
-00003bd0: 8100 0000 0e00 7000 6f00 7300 6500 5f00  ......p.o.s.e._.
-00003be0: 6900 6d00 7000 6f00 7200 7400 6500 7200  i.m.p.o.r.t.e.r.
-00003bf0: 736d 6f44 4462 6c6f 6200 0000 0839 ed30  smoDDblob....9.0
-00003c00: 4da9 c2c5 4100 0000 0e00 7000 6f00 7300  M...A.....p.o.s.
-00003c10: 6500 5f00 6900 6d00 7000 6f00 7200 7400  e._.i.m.p.o.r.t.
-00003c20: 6500 7200 736d 6f64 4462 6c6f 6200 0000  e.r.smodDblob...
-00003c30: 0839 ed30 4da9 c2c5 4100 0000 0e00 7000  .9.0M...A.....p.
-00003c40: 6f00 7300 6500 5f00 6900 6d00 7000 6f00  o.s.e._.i.m.p.o.
-00003c50: 7200 7400 6500 7200 7370 6831 5363 6f6d  r.t.e.r.sph1Scom
-00003c60: 7000 0000 0000 0510 0000 0000 0f00 7000  p.............p.
-00003c70: 6f00 7300 6500 5f00 7000 7200 6f00 6300  o.s.e._.p.r.o.c.
-00003c80: 6500 7300 7300 6f00 7200 736c 6731 5363  e.s.s.o.r.slg1Sc
-00003c90: 6f6d 7000 0000 0000 00e1 e500 0000 0f00  omp.............
-00003ca0: 7000 6f00 7300 6500 5f00 7000 7200 6f00  p.o.s.e._.p.r.o.
-00003cb0: 6300 6500 7300 7300 6f00 7200 736d 6f44  c.e.s.s.o.r.smoD
-00003cc0: 4462 6c6f 6200 0000 0888 9843 276c bfc5  Dblob......C'l..
-00003cd0: 4100 0000 0f00 7000 6f00 7300 6500 5f00  A.....p.o.s.e._.
-00003ce0: 7000 7200 6f00 6300 6500 7300 7300 6f00  p.r.o.c.e.s.s.o.
-00003cf0: 7200 736d 6f64 4462 6c6f 6200 0000 0888  r.smodDblob.....
-00003d00: 9843 276c bfc5 4100 0000 0f00 7000 6f00  .C'l..A.....p.o.
-00003d10: 7300 6500 5f00 7000 7200 6f00 6300 6500  s.e._.p.r.o.c.e.
-00003d20: 7300 7300 6f00 7200 7370 6831 5363 6f6d  s.s.o.r.sph1Scom
-00003d30: 7000 0000 0000 0180 0000 0000 0900 7200  p.............r.
-00003d40: 6f00 6900 5f00 7400 6f00 6f00 6c00 7362  o.i._.t.o.o.l.sb
-00003d50: 7773 7062 6c6f 6200 0000 b862 706c 6973  wspblob....bplis
-00003d60: 7430 30d6 0102 0304 0506 0708 0708 0b08  t00.............
-00003d70: 5d53 686f 7753 7461 7475 7342 6172 5b53  ]ShowStatusBar[S
-00003d80: 686f 7754 6f6f 6c62 6172 5b53 686f 7754  howToolbar[ShowT
-00003d90: 6162 5669 6577 5f10 1443 6f6e 7461 696e  abView_..Contain
-00003da0: 6572 5368 6f77 5369 6465 6261 725c 5769  erShowSidebar\Wi
-00003db0: 6e64 6f77 426f 756e 6473 5b53 686f 7753  ndowBounds[ShowS
-00003dc0: 6964 6562 6172 0809 0809 5f10 187b 7b31  idebar...._..{{1
-00003dd0: 3232 2c20 3735 7d2c 207b 3132 3833 2c20  22, 75}, {1283, 
-00003de0: 3638 397d 7d09 0815 232f 3b52 5f6b 6c6d  689}}...#/;R_klm
-00003df0: 6e6f 8a00 0000 0000 0001 0100 0000 0000  no..............
-00003e00: 0000 0d00 0000 0000 0000 0000 0000 0000  ................
-00003e10: 0000 8b00 0000 0900 7200 6f00 6900 5f00  ........r.o.i._.
-00003e20: 7400 6f00 6f00 6c00 736c 6731 5363 6f6d  t.o.o.l.slg1Scom
-00003e30: 7000 0000 0000 06ef 1100 0000 0900 7200  p.............r.
-00003e40: 6f00 6900 5f00 7400 6f00 6f00 6c00 736d  o.i._.t.o.o.l.sm
-00003e50: 6f44 4462 6c6f 6200 0000 08e1 a42a 4a0e  oDDblob......*J.
-00003e60: dfc5 4100 0000 0900 7200 6f00 6900 5f00  ..A.....r.o.i._.
-00003e70: 7400 6f00 6f00 6c00 736d 6f64 4462 6c6f  t.o.o.l.smodDblo
-00003e80: 6200 0000 08e1 a42a 4a0e dfc5 4100 0000  b......*J...A...
-00003e90: 0900 7200 6f00 6900 5f00 7400 6f00 6f00  ..r.o.i._.t.o.o.
-00003ea0: 6c00 7370 6831 5363 6f6d 7000 0000 0000  l.sph1Scomp.....
-00003eb0: 0860 0000 0000 0900 7200 6f00 6900 5f00  .`......r.o.i._.
-00003ec0: 7400 6f00 6f00 6c00 7376 5372 6e6c 6f6e  t.o.o.l.svSrnlon
-00003ed0: 6700 0000 0100 0000 0700 7300 6100 6e00  g.........s.a.n.
-00003ee0: 6400 6200 6f00 7862 7773 7062 6c6f 6200  d.b.o.xbwspblob.
-00003ef0: 0000 b762 706c 6973 7430 30d6 0102 0304  ...bplist00.....
-00003f00: 0506 0708 0708 0b08 5d53 686f 7753 7461  ........]ShowSta
-00003f10: 7475 7342 6172 5b53 686f 7754 6f6f 6c62  tusBar[ShowToolb
-00003f20: 6172 5b53 686f 7754 6162 5669 6577 5f10  ar[ShowTabView_.
-00003f30: 1443 6f6e 7461 696e 6572 5368 6f77 5369  .ContainerShowSi
-00003f40: 6465 6261 725c 5769 6e64 6f77 426f 756e  debar\WindowBoun
-00003f50: 6473 5b53 686f 7753 6964 6562 6172 0809  ds[ShowSidebar..
-00003f60: 0809 5f10 177b 7b34 332c 2038 347d 2c20  .._..{{43, 84}, 
-00003f70: 7b31 3138 302c 2035 3638 7d7d 0908 1523  {1180, 568}}...#
-00003f80: 2f3b 525f 6b6c 6d6e 6f89 0000 0000 0000  /;R_klmno.......
-00003f90: 0101 0000 0000 0000 000d 0000 0000 0000  ................
-00003fa0: 0000 0000 0000 0000 008a 0000 0007 0073  ...............s
-00003fb0: 0061 006e 0064 0062 006f 0078 6c67 3153  .a.n.d.b.o.xlg1S
-00003fc0: 636f 6d70 0000 0000 0009 c561 0000 0000  comp.......a....
+00003150: 5369 6465 6261 7208 0908 095f 1019 7b7b  Sidebar...._..{{
+00003160: 3938 352c 2033 3830 7d2c 207b 3131 3830  985, 380}, {1180
+00003170: 2c20 3536 387d 7d09 0815 232f 3b52 5f6b  , 568}}...#/;R_k
+00003180: 6c6d 6e6f 8b00 0000 0000 0001 0100 0000  lmno............
+00003190: 0000 0000 0d00 0000 0000 0000 0000 0000  ................
+000031a0: 0000 0000 8c00 0000 0800 7000 6c00 6f00  ..........p.l.o.
+000031b0: 7400 7400 6900 6e00 676c 6731 5363 6f6d  t.t.i.n.glg1Scom
+000031c0: 7000 0000 0000 1036 6200 0000 0800 7000  p......6b.....p.
+000031d0: 6c00 6f00 7400 7400 6900 6e00 676c 7376  l.o.t.t.i.n.glsv
+000031e0: 4362 6c6f 6200 0003 2662 706c 6973 7430  Cblob...&bplist0
+000031f0: 30da 0102 0304 0506 0708 090a 0b0c 0d1a  0...............
+00003200: 5455 5657 0c59 5f10 1276 6965 774f 7074  TUVW.Y_..viewOpt
+00003210: 696f 6e73 5665 7273 696f 6e5f 100f 7368  ionsVersion_..sh
+00003220: 6f77 4963 6f6e 5072 6576 6965 7757 636f  owIconPreviewWco
+00003230: 6c75 6d6e 735f 1011 6361 6c63 756c 6174  lumns_..calculat
+00003240: 6541 6c6c 5369 7a65 735f 100f 7363 726f  eAllSizes_..scro
+00003250: 6c6c 506f 7369 7469 6f6e 5958 7465 7874  llPositionYXtext
+00003260: 5369 7a65 5f10 0f73 6372 6f6c 6c50 6f73  Size_..scrollPos
+00003270: 6974 696f 6e58 5a73 6f72 7443 6f6c 756d  itionXZsortColum
+00003280: 6e5f 1010 7573 6552 656c 6174 6976 6544  n_..useRelativeD
+00003290: 6174 6573 5869 636f 6e53 697a 6510 0109  atesXiconSize...
+000032a0: ae0e 171c 2125 2a2f 3439 3d42 464b 4fd4  ....!%*/49=BFKO.
+000032b0: 0f10 1112 1314 0c0c 5a69 6465 6e74 6966  ........Zidentif
+000032c0: 6965 7255 7769 6474 6859 6173 6365 6e64  ierUwidthYascend
+000032d0: 696e 6757 7669 7369 626c 6554 6e61 6d65  ingWvisibleTname
+000032e0: 1101 2c09 09d4 0f10 1112 1819 1a1a 5875  ..,...........Xu
+000032f0: 6269 7175 6974 7910 2308 08d4 0f10 1112  biquity.#.......
+00003300: 1d1e 1a0c 5c64 6174 654d 6f64 6966 6965  ....\dateModifie
+00003310: 6410 b508 09d4 0f10 1112 221e 1a1a 5b64  d........."...[d
+00003320: 6174 6543 7265 6174 6564 0808 d40f 1011  ateCreated......
+00003330: 1226 271a 0c54 7369 7a65 1061 0809 d40f  .&'..Tsize.a....
+00003340: 1011 122b 2c0c 0c54 6b69 6e64 1073 0909  ...+,..Tkind.s..
+00003350: d40f 1011 1230 310c 1a55 6c61 6265 6c10  .....01..Ulabel.
+00003360: 6409 08d4 0f10 1112 3536 0c1a 5776 6572  d.......56..Wver
+00003370: 7369 6f6e 104b 0908 d40f 1011 123a 140c  sion.K.......:..
+00003380: 1a58 636f 6d6d 656e 7473 0908 d40f 1011  .Xcomments......
+00003390: 123e 3f1a 1a5e 6461 7465 4c61 7374 4f70  .>?..^dateLastOp
+000033a0: 656e 6564 10c8 0808 d40f 1011 1243 1e1a  ened.........C..
+000033b0: 1a59 6461 7465 4164 6465 6408 08d4 1210  .YdateAdded.....
+000033c0: 110f 1a48 1a4a 0810 d208 5a73 6861 7265  ...H.J....Zshare
+000033d0: 4f77 6e65 72d4 1210 110f 1a48 1a4e 0808  Owner......H.N..
+000033e0: 5f10 0f73 6861 7265 4c61 7374 4564 6974  _..shareLastEdit
+000033f0: 6f72 d412 1011 0f1a 481a 5208 085f 1010  or......H.R.._..
+00003400: 696e 7669 7461 7469 6f6e 5374 6174 7573  invitationStatus
+00003410: 0823 4073 3000 0000 0000 2340 2800 0000  .#@s0.....#@(...
+00003420: 0000 0023 0000 0000 0000 0000 546e 616d  ...#........Tnam
+00003430: 6509 2340 3000 0000 0000 0000 0800 1d00  e.#@0...........
+00003440: 3200 4400 4c00 6000 7200 7b00 8d00 9800  2.D.L.`.r.{.....
+00003450: ab00 b400 b600 b700 c600 cf00 da00 e000  ................
+00003460: ea00 f200 f700 fa00 fb00 fc01 0501 0e01  ................
+00003470: 1001 1101 1201 1b01 2801 2a01 2b01 2c01  ........(.*.+.,.
+00003480: 3501 4101 4201 4301 4c01 5101 5301 5401  5.A.B.C.L.Q.S.T.
+00003490: 5501 5e01 6301 6501 6601 6701 7001 7601  U.^.c.e.f.g.p.v.
+000034a0: 7801 7901 7a01 8301 8b01 8d01 8e01 8f01  x.y.z...........
+000034b0: 9801 a101 a201 a301 ac01 bb01 bd01 be01  ................
+000034c0: bf01 c801 d201 d301 d401 dd01 de01 e001  ................
+000034d0: e101 ec01 f501 f601 f702 0902 1202 1302  ................
+000034e0: 1402 2702 2802 3102 3a02 4302 4802 4900  ..'.(.1.:.C.H.I.
+000034f0: 0000 0000 0002 0100 0000 0000 0000 5a00  ..............Z.
+00003500: 0000 0000 0000 0000 0000 0000 0002 5200  ..............R.
+00003510: 0000 0800 7000 6c00 6f00 7400 7400 6900  ....p.l.o.t.t.i.
+00003520: 6e00 676c 7376 7062 6c6f 6200 0002 9b62  n.glsvpblob....b
+00003530: 706c 6973 7430 30da 0102 0304 0506 0708  plist00.........
+00003540: 090a 0b0c 0d1c 4647 4849 0c4b 5f10 1276  ......FGHI.K_..v
+00003550: 6965 774f 7074 696f 6e73 5665 7273 696f  iewOptionsVersio
+00003560: 6e5f 100f 7368 6f77 4963 6f6e 5072 6576  n_..showIconPrev
+00003570: 6965 7757 636f 6c75 6d6e 735f 1011 6361  iewWcolumns_..ca
+00003580: 6c63 756c 6174 6541 6c6c 5369 7a65 735f  lculateAllSizes_
+00003590: 100f 7363 726f 6c6c 506f 7369 7469 6f6e  ..scrollPosition
+000035a0: 5958 7465 7874 5369 7a65 5f10 0f73 6372  YXtextSize_..scr
+000035b0: 6f6c 6c50 6f73 6974 696f 6e58 5a73 6f72  ollPositionXZsor
+000035c0: 7443 6f6c 756d 6e5f 1010 7573 6552 656c  tColumn_..useRel
+000035d0: 6174 6976 6544 6174 6573 5869 636f 6e53  ativeDatesXiconS
+000035e0: 697a 6510 0109 d90e 0f10 1112 1314 1516  ize.............
+000035f0: 1720 252a 2f34 373c 4058 636f 6d6d 656e  . %*/47<@Xcommen
+00003600: 7473 556c 6162 656c 5776 6572 7369 6f6e  tsUlabelWversion
+00003610: 5b64 6174 6543 7265 6174 6564 5473 697a  [dateCreatedTsiz
+00003620: 655c 6461 7465 4d6f 6469 6669 6564 546b  e\dateModifiedTk
+00003630: 696e 6454 6e61 6d65 5e64 6174 654c 6173  indTname^dateLas
+00003640: 744f 7065 6e65 64d4 1819 1a1b 1c1d 0c1f  tOpened.........
+00003650: 5776 6973 6962 6c65 5577 6964 7468 5961  WvisibleUwidthYa
+00003660: 7363 656e 6469 6e67 5569 6e64 6578 0811  scendingUindex..
+00003670: 012c 0910 07d4 1819 1a1b 1c22 0c24 0810  .,.........".$..
+00003680: 6409 1005 d418 191a 1b1c 270c 2908 104b  d.........'.)..K
+00003690: 0910 06d4 1819 1a1b 1c2c 1c2e 0810 b508  .........,......
+000036a0: 1002 d418 191a 1b0c 311c 3309 1061 0810  ........1.3..a..
+000036b0: 03d4 1819 1a1b 0c2c 1c0b 0908 d418 191a  .......,........
+000036c0: 1b0c 390c 3b09 1073 0910 04d4 1819 1a1b  ..9.;..s........
+000036d0: 0c1d 0c3f 0909 1000 d418 191a 1b1c 421c  ...?..........B.
+000036e0: 4408 10c8 0810 0808 2340 7330 0000 0000  D.......#@s0....
+000036f0: 0023 4028 0000 0000 0000 2300 0000 0000  .#@(......#.....
+00003700: 0000 0054 6e61 6d65 0923 4030 0000 0000  ...Tname.#@0....
+00003710: 0000 0008 001d 0032 0044 004c 0060 0072  .......2.D.L.`.r
+00003720: 007b 008d 0098 00ab 00b4 00b6 00b7 00ca  .{..............
+00003730: 00d3 00d9 00e1 00ed 00f2 00ff 0104 0109  ................
+00003740: 0118 0121 0129 012f 0139 013f 0140 0143  ...!.)./.9.?.@.C
+00003750: 0144 0146 014f 0150 0152 0153 0155 015e  .D.F.O.P.R.S.U.^
+00003760: 015f 0161 0162 0164 016d 016e 0170 0171  ._.a.b.d.m.n.p.q
+00003770: 0173 017c 017d 017f 0180 0182 018b 018c  .s.|.}..........
+00003780: 018d 0196 0197 0199 019a 019c 01a5 01a6  ................
+00003790: 01a7 01a9 01b2 01b3 01b5 01b6 01b8 01b9  ................
+000037a0: 01c2 01cb 01d4 01d9 01da 0000 0000 0000  ................
+000037b0: 0201 0000 0000 0000 004c 0000 0000 0000  .........L......
+000037c0: 0000 0000 0000 0000 01e3 0000 0008 0070  ...............p
+000037d0: 006c 006f 0074 0074 0069 006e 0067 6d6f  .l.o.t.t.i.n.gmo
+000037e0: 4444 626c 6f62 0000 0008 9a16 4957 52ed  DDblob......IWR.
+000037f0: c541 0000 0008 0070 006c 006f 0074 0074  .A.....p.l.o.t.t
+00003800: 0069 006e 0067 6d6f 6444 626c 6f62 0000  .i.n.gmodDblob..
+00003810: 0008 e107 6f34 3ded c541 0000 0008 0070  ....o4=..A.....p
+00003820: 006c 006f 0074 0074 0069 006e 0067 7068  .l.o.t.t.i.n.gph
+00003830: 3153 636f 6d70 0000 0000 0013 a000 0000  1Scomp..........
+00003840: 0008 0070 006c 006f 0074 0074 0069 006e  ...p.l.o.t.t.i.n
+00003850: 0067 7653 726e 6c6f 6e67 0000 0001 0000  .gvSrnlong......
+00003860: 0013 0070 006f 0073 0065 005f 0063 006f  ...p.o.s.e._.c.o
+00003870: 006e 0066 0069 0067 0075 0072 0061 0074  .n.f.i.g.u.r.a.t
+00003880: 0069 006f 006e 0073 6277 7370 626c 6f62  .i.o.n.sbwspblob
+00003890: 0000 00b8 6270 6c69 7374 3030 d601 0203  ....bplist00....
+000038a0: 0405 0607 0807 080b 085d 5368 6f77 5374  .........]ShowSt
+000038b0: 6174 7573 4261 725b 5368 6f77 546f 6f6c  atusBar[ShowTool
+000038c0: 6261 725b 5368 6f77 5461 6256 6965 775f  bar[ShowTabView_
+000038d0: 1014 436f 6e74 6169 6e65 7253 686f 7753  ..ContainerShowS
+000038e0: 6964 6562 6172 5c57 696e 646f 7742 6f75  idebar\WindowBou
+000038f0: 6e64 735b 5368 6f77 5369 6465 6261 7208  nds[ShowSidebar.
+00003900: 0908 095f 1018 7b7b 3334 362c 2032 3433  ..._..{{346, 243
+00003910: 7d2c 207b 3932 302c 2034 3336 7d7d 0908  }, {920, 436}}..
+00003920: 1523 2f3b 525f 6b6c 6d6e 6f8a 0000 0000  .#/;R_klmno.....
+00003930: 0000 0101 0000 0000 0000 000d 0000 0000  ................
+00003940: 0000 0000 0000 0000 0000 008b 0000 0013  ................
+00003950: 0070 006f 0073 0065 005f 0063 006f 006e  .p.o.s.e._.c.o.n
+00003960: 0066 0069 0067 0075 0072 0061 0074 0069  .f.i.g.u.r.a.t.i
+00003970: 006f 006e 0073 6c67 3153 636f 6d70 0000  .o.n.slg1Scomp..
+00003980: 0000 0006 e06b 0000 0013 0070 006f 0073  .....k.....p.o.s
+00003990: 0065 005f 0063 006f 006e 0066 0069 0067  .e._.c.o.n.f.i.g
+000039a0: 0075 0072 0061 0074 0069 006f 006e 0073  .u.r.a.t.i.o.n.s
+000039b0: 6d6f 4444 626c 6f62 0000 0008 e362 8ec8  moDDblob.....b..
+000039c0: abba c541 0000 0013 0070 006f 0073 0065  ...A.....p.o.s.e
+000039d0: 005f 0063 006f 006e 0066 0069 0067 0075  ._.c.o.n.f.i.g.u
+000039e0: 0072 0061 0074 0069 006f 006e 0073 6d6f  .r.a.t.i.o.n.smo
+000039f0: 6444 626c 6f62 0000 0008 e362 8ec8 abba  dDblob.....b....
+00003a00: c541 0000 0013 0070 006f 0073 0065 005f  .A.....p.o.s.e._
+00003a10: 0063 006f 006e 0066 0069 0067 0075 0072  .c.o.n.f.i.g.u.r
+00003a20: 0061 0074 0069 006f 006e 0073 7068 3153  .a.t.i.o.n.sph1S
+00003a30: 636f 6d70 0000 0000 0007 6000 0000 0013  comp......`.....
+00003a40: 0070 006f 0073 0065 005f 0063 006f 006e  .p.o.s.e._.c.o.n
+00003a50: 0066 0069 0067 0075 0072 0061 0074 0069  .f.i.g.u.r.a.t.i
+00003a60: 006f 006e 0073 7653 726e 6c6f 6e67 0000  .o.n.svSrnlong..
+00003a70: 0001 0000 001b 0070 006f 0073 0065 005f  .......p.o.s.e._
+00003a80: 0063 006f 006e 0066 0069 0067 0075 0072  .c.o.n.f.i.g.u.r
+00003a90: 0061 0074 0069 006f 006e 0073 005f 0061  .a.t.i.o.n.s._.a
+00003aa0: 0072 0063 0068 0069 0076 0065 6c67 3153  .r.c.h.i.v.elg1S
+00003ab0: 636f 6d70 0000 0000 002f 038a 0000 001b  comp...../......
+00003ac0: 0070 006f 0073 0065 005f 0063 006f 006e  .p.o.s.e._.c.o.n
+00003ad0: 0066 0069 0067 0075 0072 0061 0074 0069  .f.i.g.u.r.a.t.i
+00003ae0: 006f 006e 0073 005f 0061 0072 0063 0068  .o.n.s._.a.r.c.h
+00003af0: 0069 0076 0065 6d6f 4444 626c 6f62 0000  .i.v.emoDDblob..
+00003b00: 0008 be0c 192b 0cd7 c541 0000 001b 0070  .....+...A.....p
+00003b10: 006f 0073 0065 005f 0063 006f 006e 0066  .o.s.e._.c.o.n.f
+00003b20: 0069 0067 0075 0072 0061 0074 0069 006f  .i.g.u.r.a.t.i.o
+00003b30: 006e 0073 005f 0061 0072 0063 0068 0069  .n.s._.a.r.c.h.i
+00003b40: 0076 0065 6d6f 6444 626c 6f62 0000 0008  .v.emodDblob....
+00003b50: be0c 192b 0cd7 c541 0000 001b 0070 006f  ...+...A.....p.o
+00003b60: 0073 0065 005f 0063 006f 006e 0066 0069  .s.e._.c.o.n.f.i
+00003b70: 0067 0075 0072 0061 0074 0069 006f 006e  .g.u.r.a.t.i.o.n
+00003b80: 0073 005f 0061 0072 0063 0068 0069 0076  .s._.a.r.c.h.i.v
+00003b90: 0065 7068 3153 636f 6d70 0000 0000 0032  .eph1Scomp.....2
+00003ba0: 4000 0000 000e 0070 006f 0073 0065 005f  @......p.o.s.e._
+00003bb0: 0069 006d 0070 006f 0072 0074 0065 0072  .i.m.p.o.r.t.e.r
+00003bc0: 0073 6c67 3153 636f 6d70 0000 0000 0004  .slg1Scomp......
+00003bd0: 0381 0000 000e 0070 006f 0073 0065 005f  .......p.o.s.e._
+00003be0: 0069 006d 0070 006f 0072 0074 0065 0072  .i.m.p.o.r.t.e.r
+00003bf0: 0073 6d6f 4444 626c 6f62 0000 0008 39ed  .smoDDblob....9.
+00003c00: 304d a9c2 c541 0000 000e 0070 006f 0073  0M...A.....p.o.s
+00003c10: 0065 005f 0069 006d 0070 006f 0072 0074  .e._.i.m.p.o.r.t
+00003c20: 0065 0072 0073 6d6f 6444 626c 6f62 0000  .e.r.smodDblob..
+00003c30: 0008 39ed 304d a9c2 c541 0000 000e 0070  ..9.0M...A.....p
+00003c40: 006f 0073 0065 005f 0069 006d 0070 006f  .o.s.e._.i.m.p.o
+00003c50: 0072 0074 0065 0072 0073 7068 3153 636f  .r.t.e.r.sph1Sco
+00003c60: 6d70 0000 0000 0005 1000 0000 000f 0070  mp.............p
+00003c70: 006f 0073 0065 005f 0070 0072 006f 0063  .o.s.e._.p.r.o.c
+00003c80: 0065 0073 0073 006f 0072 0073 6c67 3153  .e.s.s.o.r.slg1S
+00003c90: 636f 6d70 0000 0000 0000 e1e5 0000 000f  comp............
+00003ca0: 0070 006f 0073 0065 005f 0070 0072 006f  .p.o.s.e._.p.r.o
+00003cb0: 0063 0065 0073 0073 006f 0072 0073 6d6f  .c.e.s.s.o.r.smo
+00003cc0: 4444 626c 6f62 0000 0008 8898 4327 6cbf  DDblob......C'l.
+00003cd0: c541 0000 000f 0070 006f 0073 0065 005f  .A.....p.o.s.e._
+00003ce0: 0070 0072 006f 0063 0065 0073 0073 006f  .p.r.o.c.e.s.s.o
+00003cf0: 0072 0073 6d6f 6444 626c 6f62 0000 0008  .r.smodDblob....
+00003d00: 8898 4327 6cbf c541 0000 000f 0070 006f  ..C'l..A.....p.o
+00003d10: 0073 0065 005f 0070 0072 006f 0063 0065  .s.e._.p.r.o.c.e
+00003d20: 0073 0073 006f 0072 0073 7068 3153 636f  .s.s.o.r.sph1Sco
+00003d30: 6d70 0000 0000 0001 8000 0000 0009 0072  mp.............r
+00003d40: 006f 0069 005f 0074 006f 006f 006c 0073  .o.i._.t.o.o.l.s
+00003d50: 6277 7370 626c 6f62 0000 00b8 6270 6c69  bwspblob....bpli
+00003d60: 7374 3030 d601 0203 0405 0607 0807 080b  st00............
+00003d70: 085d 5368 6f77 5374 6174 7573 4261 725b  .]ShowStatusBar[
+00003d80: 5368 6f77 546f 6f6c 6261 725b 5368 6f77  ShowToolbar[Show
+00003d90: 5461 6256 6965 775f 1014 436f 6e74 6169  TabView_..Contai
+00003da0: 6e65 7253 686f 7753 6964 6562 6172 5c57  nerShowSidebar\W
+00003db0: 696e 646f 7742 6f75 6e64 735b 5368 6f77  indowBounds[Show
+00003dc0: 5369 6465 6261 7208 0908 095f 1018 7b7b  Sidebar...._..{{
+00003dd0: 3135 312c 2039 367d 2c20 7b31 3138 302c  151, 96}, {1180,
+00003de0: 2035 3638 7d7d 0908 1523 2f3b 525f 6b6c   568}}...#/;R_kl
+00003df0: 6d6e 6f8a 0000 0000 0000 0101 0000 0000  mno.............
+00003e00: 0000 000d 0000 0000 0000 0000 0000 0000  ................
+00003e10: 0000 008b 0000 0009 0072 006f 0069 005f  .........r.o.i._
+00003e20: 0074 006f 006f 006c 0073 6c67 3153 636f  .t.o.o.l.slg1Sco
+00003e30: 6d70 0000 0000 0006 7ede 0000 0009 0072  mp......~......r
+00003e40: 006f 0069 005f 0074 006f 006f 006c 0073  .o.i._.t.o.o.l.s
+00003e50: 6d6f 4444 626c 6f62 0000 0008 7ab9 3fc5  moDDblob....z.?.
+00003e60: 4fed c541 0000 0009 0072 006f 0069 005f  O..A.....r.o.i._
+00003e70: 0074 006f 006f 006c 0073 6d6f 6444 626c  .t.o.o.l.smodDbl
+00003e80: 6f62 0000 0008 7ab9 3fc5 4fed c541 0000  ob....z.?.O..A..
+00003e90: 0009 0072 006f 0069 005f 0074 006f 006f  ...r.o.i._.t.o.o
+00003ea0: 006c 0073 7068 3153 636f 6d70 0000 0000  .l.sph1Scomp....
+00003eb0: 0008 0000 0000 0009 0072 006f 0069 005f  .........r.o.i._
+00003ec0: 0074 006f 006f 006c 0073 7653 726e 6c6f  .t.o.o.l.svSrnlo
+00003ed0: 6e67 0000 0001 0000 0007 0073 0061 006e  ng.........s.a.n
+00003ee0: 0064 0062 006f 0078 6277 7370 626c 6f62  .d.b.o.xbwspblob
+00003ef0: 0000 00b8 6270 6c69 7374 3030 d601 0203  ....bplist00....
+00003f00: 0405 0607 0807 080b 085d 5368 6f77 5374  .........]ShowSt
+00003f10: 6174 7573 4261 725b 5368 6f77 546f 6f6c  atusBar[ShowTool
+00003f20: 6261 725b 5368 6f77 5461 6256 6965 775f  bar[ShowTabView_
+00003f30: 1014 436f 6e74 6169 6e65 7253 686f 7753  ..ContainerShowS
+00003f40: 6964 6562 6172 5c57 696e 646f 7742 6f75  idebar\WindowBou
+00003f50: 6e64 735b 5368 6f77 5369 6465 6261 7208  nds[ShowSidebar.
+00003f60: 0908 095f 1018 7b7b 3135 312c 2039 367d  ..._..{{151, 96}
+00003f70: 2c20 7b31 3138 302c 2035 3638 7d7d 0908  , {1180, 568}}..
+00003f80: 1523 2f3b 525f 6b6c 6d6e 6f8a 0000 0000  .#/;R_klmno.....
+00003f90: 0000 0101 0000 0000 0000 000d 0000 0000  ................
+00003fa0: 0000 0000 0000 0000 0000 008b 0000 0007  ................
+00003fb0: 0073 0061 006e 0064 0062 006f 0078 6c67  .s.a.n.d.b.o.xlg
+00003fc0: 3153 636f 6d70 0000 0000 000c 828c 0000  1Scomp..........
 00003fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004000: 0000 0000 0000 0006 0000 0000 0000 400b  ..............@.
 00004010: 0000 0045 0000 100c 0000 040a 0000 200c  ...E.......... .
 00004020: 0000 300c 0000 0000 0000 0000 0000 0000  ..0.............
 00004030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1097,57 +1097,57 @@
 00004480: 0000 0000 0100 0100 0000 0000 0100 0200  ................
 00004490: 0000 0000 0100 0400 0000 0000 0100 0800  ................
 000044a0: 0000 0000 0100 1000 0000 0000 0100 2000  .............. .
 000044b0: 0000 0000 0100 4000 0000 0000 0100 8000  ......@.........
 000044c0: 0000 0000 0101 0000 0000 0000 0102 0000  ................
 000044d0: 0000 0000 0104 0000 0000 0000 0108 0000  ................
 000044e0: 0000 0000 0110 0000 0000 0000 0120 0000  ............. ..
-000044f0: 0000 0000 0140 0000 0000 0000 005a 0000  .....@.......Z..
-00004500: 0000 0000 0000 0000 0000 0000 0252 0000  .............R..
-00004510: 0008 0070 006c 006f 0074 0074 0069 006e  ...p.l.o.t.t.i.n
-00004520: 0067 6c73 7670 626c 6f62 0000 029b 6270  .glsvpblob....bp
-00004530: 6c69 7374 3030 da01 0203 0405 0607 0809  list00..........
-00004540: 0a0b 0c0d 1c47 4849 4a0c 3758 6963 6f6e  .....GHIJ.7Xicon
-00004550: 5369 7a65 5f10 0f73 686f 7749 636f 6e50  Size_..showIconP
-00004560: 7265 7669 6577 5763 6f6c 756d 6e73 5f10  reviewWcolumns_.
-00004570: 1163 616c 6375 6c61 7465 416c 6c53 697a  .calculateAllSiz
-00004580: 6573 5f10 0f73 6372 6f6c 6c50 6f73 6974  es_..scrollPosit
-00004590: 696f 6e59 5874 6578 7453 697a 655f 100f  ionYXtextSize_..
-000045a0: 7363 726f 6c6c 506f 7369 7469 6f6e 585a  scrollPositionXZ
-000045b0: 736f 7274 436f 6c75 6d6e 5f10 1075 7365  sortColumn_..use
-000045c0: 5265 6c61 7469 7665 4461 7465 735f 1012  RelativeDates_..
-000045d0: 7669 6577 4f70 7469 6f6e 7356 6572 7369  viewOptionsVersi
-000045e0: 6f6e 2340 3000 0000 0000 0009 d90e 0f10  on#@0...........
-000045f0: 1112 1314 1516 1720 252a 2f34 383d 4158  ....... %*/48=AX
-00004600: 636f 6d6d 656e 7473 556c 6162 656c 5776  commentsUlabelWv
-00004610: 6572 7369 6f6e 5b64 6174 6543 7265 6174  ersion[dateCreat
-00004620: 6564 5473 697a 655c 6461 7465 4d6f 6469  edTsize\dateModi
-00004630: 6669 6564 546b 696e 6454 6e61 6d65 5e64  fiedTkindTname^d
-00004640: 6174 654c 6173 744f 7065 6e65 64d4 1819  ateLastOpened...
-00004650: 1a1b 1c1d 0c1f 5776 6973 6962 6c65 5577  ......WvisibleUw
-00004660: 6964 7468 5961 7363 656e 6469 6e67 5569  idthYascendingUi
-00004670: 6e64 6578 0811 012c 0910 07d4 1819 1a1b  ndex...,........
-00004680: 1c22 0c24 0810 6409 1005 d418 191a 1b1c  .".$..d.........
-00004690: 270c 2908 104b 0910 06d4 1819 1a1b 1c2c  '.)..K.........,
-000046a0: 1c2e 0810 b508 1002 d418 191a 1b0c 311c  ..............1.
-000046b0: 3309 1061 0810 03d4 1819 1a1b 0c2c 1c37  3..a.........,.7
-000046c0: 0908 1001 d418 191a 1b0c 3a0c 3c09 1073  ..........:.<..s
-000046d0: 0910 04d4 1819 1a1b 0c1d 0c40 0909 1000  ...........@....
-000046e0: d418 191a 1b1c 431c 4508 10c8 0810 0808  ......C.E.......
-000046f0: 2340 78f0 0000 0000 0023 4028 0000 0000  #@x......#@(....
-00004700: 0000 2300 0000 0000 0000 0054 6e61 6d65  ..#........Tname
-00004710: 0900 0800 1d00 2600 3800 4000 5400 6600  ......&.8.@.T.f.
-00004720: 6f00 8100 8c00 9f00 b400 bd00 be00 d100  o...............
-00004730: da00 e000 e800 f400 f901 0601 0b01 1001  ................
-00004740: 1f01 2801 3001 3601 4001 4601 4701 4a01  ..(.0.6.@.F.G.J.
-00004750: 4b01 4d01 5601 5701 5901 5a01 5c01 6501  K.M.V.W.Y.Z.\.e.
-00004760: 6601 6801 6901 6b01 7401 7501 7701 7801  f.h.i.k.t.u.w.x.
-00004770: 7a01 8301 8401 8601 8701 8901 9201 9301  z...............
-00004780: 9401 9601 9f01 a001 a201 a301 a501 ae01  ................
-00004790: af01 b001 b201 bb01 bc01 be01 bf01 c101  ................
-000047a0: c201 cb01 d401 dd01 e200 0000 0000 0002  ................
-000047b0: 0100 0000 0000 0000 4c00 0000 0000 0000  ........L.......
-000047c0: 0000 0000 0000 0001 e300 0000 0800 7000  ..............p.
-000047d0: 6c00 6f00 7400 7400 6900 6e00 676d 6f44  l.o.t.t.i.n.gmoD
-000047e0: 4462 6c6f 6200 0000 0837 24ea ed0f e3c5  Dblob....7$.....
-000047f0: 4100 0000 0800 7000 6c00 6f00 7400 7400  A.....p.l.o.t.t.
-00004800: 6900 6e00                                i.n.
+000044f0: 0000 0000 0140 0000 0000 0000 0000 5a00  .....@........Z.
+00004500: 0000 0000 0000 0000 0000 0000 0002 5200  ..............R.
+00004510: 0000 0800 7000 6c00 6f00 7400 7400 6900  ....p.l.o.t.t.i.
+00004520: 6e00 676c 7376 7062 6c6f 6200 0002 9b62  n.glsvpblob....b
+00004530: 706c 6973 7430 30da 0102 0304 0506 0708  plist00.........
+00004540: 090a 0b0c 0d1c 4647 4849 0c4b 5f10 1276  ......FGHI.K_..v
+00004550: 6965 774f 7074 696f 6e73 5665 7273 696f  iewOptionsVersio
+00004560: 6e5f 100f 7368 6f77 4963 6f6e 5072 6576  n_..showIconPrev
+00004570: 6965 7757 636f 6c75 6d6e 735f 1011 6361  iewWcolumns_..ca
+00004580: 6c63 756c 6174 6541 6c6c 5369 7a65 735f  lculateAllSizes_
+00004590: 100f 7363 726f 6c6c 506f 7369 7469 6f6e  ..scrollPosition
+000045a0: 5958 7465 7874 5369 7a65 5f10 0f73 6372  YXtextSize_..scr
+000045b0: 6f6c 6c50 6f73 6974 696f 6e58 5a73 6f72  ollPositionXZsor
+000045c0: 7443 6f6c 756d 6e5f 1010 7573 6552 656c  tColumn_..useRel
+000045d0: 6174 6976 6544 6174 6573 5869 636f 6e53  ativeDatesXiconS
+000045e0: 697a 6510 0109 d90e 0f10 1112 1314 1516  ize.............
+000045f0: 1720 252a 2f34 373c 4058 636f 6d6d 656e  . %*/47<@Xcommen
+00004600: 7473 556c 6162 656c 5776 6572 7369 6f6e  tsUlabelWversion
+00004610: 5b64 6174 6543 7265 6174 6564 5473 697a  [dateCreatedTsiz
+00004620: 655c 6461 7465 4d6f 6469 6669 6564 546b  e\dateModifiedTk
+00004630: 696e 6454 6e61 6d65 5e64 6174 654c 6173  indTname^dateLas
+00004640: 744f 7065 6e65 64d4 1819 1a1b 1c1d 0c1f  tOpened.........
+00004650: 5776 6973 6962 6c65 5577 6964 7468 5961  WvisibleUwidthYa
+00004660: 7363 656e 6469 6e67 5569 6e64 6578 0811  scendingUindex..
+00004670: 012c 0910 07d4 1819 1a1b 1c22 0c24 0810  .,.........".$..
+00004680: 6409 1005 d418 191a 1b1c 270c 2908 104b  d.........'.)..K
+00004690: 0910 06d4 1819 1a1b 1c2c 1c2e 0810 b508  .........,......
+000046a0: 1002 d418 191a 1b0c 311c 3309 1061 0810  ........1.3..a..
+000046b0: 03d4 1819 1a1b 0c2c 1c0b 0908 d418 191a  .......,........
+000046c0: 1b0c 390c 3b09 1073 0910 04d4 1819 1a1b  ..9.;..s........
+000046d0: 0c1d 0c3f 0909 1000 d418 191a 1b1c 421c  ...?..........B.
+000046e0: 4408 10c8 0810 0808 2340 7330 0000 0000  D.......#@s0....
+000046f0: 0023 4028 0000 0000 0000 2300 0000 0000  .#@(......#.....
+00004700: 0000 0054 6e61 6d65 0923 4030 0000 0000  ...Tname.#@0....
+00004710: 0000 0008 001d 0032 0044 004c 0060 0072  .......2.D.L.`.r
+00004720: 007b 008d 0098 00ab 00b4 00b6 00b7 00ca  .{..............
+00004730: 00d3 00d9 00e1 00ed 00f2 00ff 0104 0109  ................
+00004740: 0118 0121 0129 012f 0139 013f 0140 0143  ...!.)./.9.?.@.C
+00004750: 0144 0146 014f 0150 0152 0153 0155 015e  .D.F.O.P.R.S.U.^
+00004760: 015f 0161 0162 0164 016d 016e 0170 0171  ._.a.b.d.m.n.p.q
+00004770: 0173 017c 017d 017f 0180 0182 018b 018c  .s.|.}..........
+00004780: 018d 0196 0197 0199 019a 019c 01a5 01a6  ................
+00004790: 01a7 01a9 01b2 01b3 01b5 01b6 01b8 01b9  ................
+000047a0: 01c2 01cb 01d4 01d9 01da 0000 0000 0000  ................
+000047b0: 0201 0000 0000 0000 004c 0000 0000 0000  .........L......
+000047c0: 0000 0000 0000 0000 01e3 0000 0008 0070  ...............p
+000047d0: 006c 006f 0074 0074 0069 006e 0067 6d6f  .l.o.t.t.i.n.gmo
+000047e0: 4444 626c 6f62 0000 0008 9a16 4957 52ed  DDblob......IWR.
+000047f0: c541 0000 0008 0070 006c 006f 0074 0074  .A.....p.l.o.t.t
+00004800: 0069 006e                                .i.n
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_14bp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_14bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_7bp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_7bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/doctests.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/doctests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/read_in_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/read_in_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/peaks.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/peaks.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2022.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2022.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/convex_hull_3_scratch_3.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/convex_hull_3_scratch_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/convex_hull_scratch_1.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/convex_hull_scratch_1.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/egocentrical_aligner.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/egocentrical_aligner.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/count_values_in_range.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/count_values_in_range.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/graph_creator.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/graph_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/termite_rois.csv` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/termite_rois.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/mutual_exclusive.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/mutual_exclusive.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/video_color.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/video_color.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/graph_3d_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/graph_3d_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/video_rotator.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/video_rotator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/add_probability_cnt_features.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/add_probability_cnt_features.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/make_splash.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/make_splash.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_5.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/time_stamp_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/time_stamp_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/video_rotator_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/video_rotator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/fish_feature_extractor_2023_version_4.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/misc/convex_hull_scratch_2.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/misc/convex_hull_scratch_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_8bps_2_animals.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_8bps_2_animals.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/perimeter_jit.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/perimeter_jit.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_subsets.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_subsets.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_user_defined.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_user_defined.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_16bp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_16bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_9bp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_9bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_8bp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_8bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/feature_extractor_4bp.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/feature_extractor_4bp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/feature_extractors/amber_feature_extractor.py` & `Simba-UW-tf-dev-1.90.5/simba/feature_extractors/amber_feature_extractor.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/requirements.txt` & `Simba-UW-tf-dev-1.90.5/simba/requirements.txt`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/annotator_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/annotator_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/timeseries_features_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/timeseries_features_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/mixins/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/pop_up_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/pop_up_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/config_reader.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/config_reader.py`

 * *Files 0% similar despite different names*

```diff
@@ -221,15 +221,14 @@
 
         if not os.path.isfile(self.roi_coordinates_path):
             raise NoROIDataError(
                 msg="SIMBA ERROR: No ROI definitions were found in your SimBA project. Please draw some ROIs before analyzing your ROI data",
                 source=self.__class__.__name__,
             )
         else:
-
             self.rectangles_df = pd.read_hdf(
                 self.roi_coordinates_path, key=Keys.ROI_RECTANGLES.value
             )
             if ("Center_X" in self.rectangles_df.columns) and (
                 self.rectangles_df["Center_X"].isnull().values.any()
             ):
                 for idx, row in self.rectangles_df.iterrows():
@@ -247,15 +246,14 @@
             )
             if "Center_XCenter_Y" in self.polygon_df.columns:
                 self.polygon_df = self.polygon_df.drop(["Center_XCenter_Y"], axis=1)
             self.polygon_df = self.polygon_df.dropna(how="any")
             self.shape_names = list(
                 itertools.chain(
                     self.rectangles_df["Name"].unique(),
-                    self.circles_df["Name"].unique(),
                     self.polygon_df["Name"].unique(),
                 )
             )
             self.roi_dict = {
                 Keys.ROI_RECTANGLES.value: self.rectangles_df,
                 Keys.ROI_CIRCLES.value: self.circles_df,
                 Keys.ROI_POLYGONS.value: self.polygon_df,
@@ -276,28 +274,20 @@
                     self.roi_dict[Keys.ROI_CIRCLES.value]["Center_Y"] = self.roi_dict[
                         Keys.ROI_CIRCLES.value
                     ]["centerY"]
                 elif shape_type == Keys.ROI_RECTANGLES.value:
                     self.roi_dict[Keys.ROI_RECTANGLES.value][
                         "Center_X"
                     ] = self.roi_dict[Keys.ROI_RECTANGLES.value]["Bottom_right_X"] - (
-                        (
-                            self.roi_dict[Keys.ROI_RECTANGLES.value]["Bottom_right_X"]
-                            - self.roi_dict[Keys.ROI_RECTANGLES.value]["width"]
-                        )
-                        / 2
+                        self.roi_dict[Keys.ROI_RECTANGLES.value]["width"] / 2
                     )
                     self.roi_dict[Keys.ROI_RECTANGLES.value][
                         "Center_Y"
                     ] = self.roi_dict[Keys.ROI_RECTANGLES.value]["Bottom_right_Y"] - (
-                        (
-                            self.roi_dict[Keys.ROI_RECTANGLES.value]["Bottom_right_Y"]
-                            - self.roi_dict[Keys.ROI_RECTANGLES.value]["height"]
-                        )
-                        / 2
+                        self.roi_dict[Keys.ROI_RECTANGLES.value]["height"] / 2
                     )
                 elif shape_type == Keys.ROI_POLYGONS.value:
                     try:
                         self.roi_dict[Keys.ROI_POLYGONS.value]["Center_X"] = (
                             self.roi_dict[Keys.ROI_POLYGONS.value]["Center_X"]
                         )
                         self.roi_dict[Keys.ROI_POLYGONS.value]["Center_Y"] = (
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/circular_statistics.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/circular_statistics.py`

 * *Files 0% similar despite different names*

```diff
@@ -1155,15 +1155,14 @@
 
         .. image:: _static/img/fit_circle.png
            :width: 600
            :align: center
 
         References
         ----------
-
         .. [1] Kanatani, Rangarajan, Hyper least squares fitting of circles and ellipses, `Computational Statistics & Data Analysis`,
                vol. 55, pp. 2197-2208, 2011.
         .. [2] Lapp, Salazar, Champagne. Automated maternal behavior during early life in rodents (AMBER) pipeline, `Scientific Reports`,
                13:18277, 2023.
 
         :parameter np.ndarray data: A 3D NumPy array with shape (N, M, 2). N represent frames, M represents the number of body-parts, and 2 represents x and y coordinates.
         :parameter int max_iterations: The maximum number of iterations for fitting the circle.
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/network_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/network_mixin.py`

 * *Files 20% similar despite different names*

```diff
@@ -495,18 +495,29 @@
     @staticmethod
     @jit(nopython=True)
     def simpson_index(x: np.ndarray) -> float:
         """
         Calculate Simpson's diversity index for a given array of values.
 
         Simpson's diversity index is a measure of diversity that takes into account the number of different categories
-        present in the input data as well as the relative abundance of each category.
+        present in the input data as well as the relative abundance of each category. Answer how homogenous a cluster or community is
+        for categorical input variable.
+
+        .. math::
+
+           D = \frac{\sum(n(n-1))}{N(N-1)}
+
+        where:
+        - \( n \) is the number of individuals of a particular category,
+        - \( N \) is the total number of individuals,
+        - \( \sum \) represents the sum over all categories.
 
         :param np.ndarray x: 1-dimensional numpy array containing the values representing categories for which Simpson's index is calculated.
         :return float: Simpson's diversity index value for the input array `x`
+
         """
 
         unique_v = np.unique(x)
         n_unique = np.unique(x).shape[0]
         results = np.full((n_unique, 3), np.nan)
         for i in range(unique_v.shape[0]):
             v = unique_v[i]
@@ -516,15 +527,29 @@
         return (np.sum(results[:, 2])) / (x.shape[0] * (x.shape[0] - 1))
 
     @staticmethod
     def berger_parker(x: np.ndarray) -> float:
         """
         Berger-Parker index for the given one-dimensional array.
         The Berger-Parker index is a measure of category dominance, calculated as the ratio of
-        the frequency of the most abundant category to the total number of observations
+        the frequency of the most abundant category to the total number of observations. Answer how dominated a cluster or community is
+        by categorical variable.
+
+        The Berger-Parker index (BP) is calculated using the formula:
+
+        .. math::
+
+           BP = \\frac{f_{\max}}{N}
+
+        where:
+        - \( f_{\max} \) is the frequency of the most abundant category,
+        - \( N \) is the total number of observations.
+
+        :param np.ndarray x: One-dimensional numpy array containing the values for which the Berger-Parker index is calculated.
+        :return float: Berger-Parker index value for the input array `x`
 
         :example:
         >>> x = np.random.randint(0, 25, (100,)).astype(np.float32)
         >>> z = NetworkMixin.berger_parker(x=x)
         """
         check_valid_array(
             source=f"{NetworkMixin.berger_parker.__name__} x",
@@ -536,15 +561,27 @@
 
     @staticmethod
     @jit(nopython=True)
     def shannon_diversity_index(x: np.ndarray) -> float:
         """
         Calculate the Shannon Diversity Index for a given array of categories. The Shannon Diversity Index is a measure of diversity in a
         categorical feature, taking into account both the number of different categories (richness)
-        and their relative abundances (evenness).
+        and their relative abundances (evenness). Answer how homogenous a cluster or community is
+        for categorical variable. A low value indicates that one or a few categories dominate.
+
+        .. math::
+
+           H = -\sum_{i=1}^{n} (p_i \cdot \log(p_i))
+
+        where:
+        - \( p_i \) is the proportion of individuals belonging to the i-th category,
+        - \( n \) is the total number of categories.
+
+        :param np.ndarray x: One-dimensional numpy array containing the categories for which the Shannon Diversity Index is calculated.
+        :return float: Shannon Diversity Index value for the input array `x`
 
         :example:
         >>> x = np.random.randint(0, 100, (100, ))
         >>> NetworkMixin.shannon_diversity_index(x=x)
         """
 
         unique_v = np.unique(x)
@@ -558,16 +595,31 @@
         return np.sum(np.abs(results))
 
     @staticmethod
     def margalef_diversification_index(x: np.array) -> float:
         """
         Calculate the Margalef Diversification Index for a given array of values.
 
-        The Margalef Diversification Index is a measure of category diversity. It quantifies the richness of a community
-        relative to the number of individuals.
+        The Margalef Diversification Index is a measure of category diversity. It quantifies the richness of a community/cluster
+        relative to the number of individuals. A high Margalef Diversification Index indicates a high diversity of categories relative to the number of observations.
+        A low Margalef Diversification Index suggests a lower diversity of categories relative to the number of observations.
+
+        The Margalef Diversification Index (D) is calculated using the formula:
+
+        .. math::
+
+           D = \\frac{(S - 1)}{\\log(N)}
+
+        where:
+        - \( S \) is the number of unique categories,
+        - \( N \) is the total number of individuals.
+
+        :param np.array x: One-dimensional numpy array containing nominal values for which the Margalef Diversification Index is calculated.
+        :return float: Margalef Diversification Index value for the input array `x`
+
 
         :example:
         >>> x = np.random.randint(0, 100, (100,))
         >>> NetworkMixin.margalef_diversification_index(x=x)
         """
         check_valid_array(
             source=f"{NetworkMixin.margalef_diversification_index.__name__} x",
@@ -580,30 +632,139 @@
         return (n_unique - 1) / np.log(x.shape[0])
 
     @staticmethod
     def menhinicks_index(x: np.array) -> float:
         """
         Calculate the Menhinick's Index for a given array of values.
 
-        Menhinick's Index is a measure of category richness.
-        It quantifies the number of categories relative to the square root of the total number of observations.
+        Menhinick's Index is a measure of category richness. It quantifies the number of categories relative to the square root of the total number of observations.
+        A high Menhinick's Index suggests a high diversity of categories relative to the number of observations.
+        A low Menhinick's Index indicates a lower diversity of categories relative to the number of observations.
+
+        Menhinick's Index (D) is calculated using the formula:
+
+        .. math::
+
+           D = \\frac{S}{\\sqrt{N}}
+
+        where:
+        - \( S \) is the number of unique categories,
+        - \( N \) is the total number of observations.
+
+         :param np.array x: One-dimensional numpy array containing the integer values representing nominal values for which Menhinick's Index is calculated.
+         :return float: Menhinick's Index value for the input array `x`
 
         :example:
         >>> x = np.random.randint(0, 5, (1000,))
         >>> NetworkMixin.menhinicks_index(x=x)
         """
         check_valid_array(
             source=f"{NetworkMixin.menhinicks_index.__name__} x",
             accepted_ndims=(1,),
             data=x,
             accepted_dtypes=(np.float32, np.float64, np.int32, np.int64, np.int8),
             min_axis_0=2,
         )
         return np.unique(x).shape[0] / np.sqrt(x.shape[0])
 
+    @staticmethod
+    def brillouins_index(x: np.array) -> float:
+        """
+        Calculate Brillouin's Diversity Index for a given array of values.
+
+        Brillouin's Diversity Index is a measure of cluster/community diversity that accounts for both richness
+        and evenness of distribution.
+
+        Brillouin's Diversity Index (H) is calculated using the formula:
+
+        .. math::
+
+           H = \\frac{1}{\\log(S)} \\sum_{i=1}^{S} \\frac{N_i(N_i - 1)}{n(n-1)}
+
+        where:
+        - \( H \) is Brillouin's Diversity Index,
+        - \( S \) is the total number of unique species,
+        - \( N_i \) is the count of individuals in the i-th species,
+        - \( n \) is the total number of individuals.
+
+        :param np.array x: One-dimensional numpy array containing the values for which Brillouin's Index is calculated.
+        :return float: Brillouin's Diversity Index value for the input array `x`
+
+        :example:
+        >>> x = np.random.randint(0, 10, (100,))
+        >>> NetworkMixin.brillouins_index(x)
+        """
+
+        check_valid_array(
+            source=f"{NetworkMixin.brillouins_index.__name__} x",
+            accepted_ndims=(1,),
+            data=x,
+            accepted_dtypes=(np.float32, np.float64, np.int32, np.int64, np.int8),
+            min_axis_0=2,
+        )
+        n_total = x.shape[0]
+        n_unique = np.unique(x, return_counts=True)[1]
+        if n_unique.shape[0] == 1:
+            return 1.0
+        else:
+            S = len(n_unique)
+            h = 0
+            for count in n_unique:
+                h += count * (count - 1)
+            h /= n_total * (n_total - 1)
+            h /= np.log(S)
+            return h
+
+    @staticmethod
+    def sorensen_dice_coefficient(x: np.ndarray, y: np.ndarray) -> float:
+        """
+        Calculate Srensen's Similarity Index between two communities/clusters.
+
+        The Srensen similarity index, also known as the overlap index, quantifies the overlap between two populations by comparing the number of shared categories to the total number of categories in both populations. It ranges from zero, indicating no overlap, to one, representing perfect overlap
+
+        Srensen's Similarity Index (S) is calculated using the formula:
+
+        .. math::
+
+            S = \\frac{2 \times |X \cap Y|}{|X| + |Y|}
+
+        where:
+        - \( S \) is Srensen's Similarity Index,
+        - \( X \) and \( Y \) are the sets representing the categories in the first and second communities, respectively,
+        - \( |X \cap Y| \) is the number of shared categories between the two communities,
+        - \( |X| \) and \( |Y| \) are the total number of categories in the first and second communities, respectively.
+
+
+        :param x: 1D numpy array with nominal values for the first cluster/community.
+        :param y: 1D numpy array with nominal values for the second cluster/community.
+        :return: Srensen's Similarity Index between x and y.
+
+        :example:
+        >>> x = np.random.randint(0, 10, (100,))
+        >>> y = np.random.randint(0, 10, (100,))
+        >>> NetworkMixin.sorensen_dice_coefficient(x=x, y=y)
+        """
+
+        check_valid_array(
+            source=f"{NetworkMixin.sorensen_dice_coefficient.__name__} x",
+            accepted_ndims=(1,),
+            data=x,
+            accepted_dtypes=(np.int32, np.int64, np.int8, int),
+            min_axis_0=2,
+        )
+        check_valid_array(
+            source=f"{NetworkMixin.sorensen_dice_coefficient.__name__} y",
+            accepted_ndims=(1,),
+            data=y,
+            accepted_dtypes=(np.int32, np.int64, np.int8, int),
+            min_axis_0=2,
+        )
+        x, y = set(x), set(y)
+        return 2 * len(x.intersection(y)) / (len(x) + len(y))
+
 
 # graph = NetworkMixin.create_graph(
 #     {
 #         ("Animal_1", "Animal_2"): 0.0,
 #         ("Animal_1", "Animal_3"): 0.0,
 #         ("Animal_1", "Animal_4"): 0.0,
 #         ("Animal_1", "Animal_5"): 0.1,
```

#### encoding

```diff
@@ -1 +1 @@
-us-ascii
+utf-8
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/pose_importer_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/pose_importer_mixin.py`

 * *Files 1% similar despite different names*

```diff
@@ -118,15 +118,15 @@
             results[video_name] = {
                 "DATA": data_path,
                 "VIDEO": video_paths[video_idx[0]],
             }
         return results
 
     def get_x_y_loc_of_mouse_click(self, event, x, y, flags, param):
-        if event == 7:
+        if event == cv2.EVENT_LBUTTONDOWN:
             self.click_loc = (x, y)
             self.id_cords[self.cnt] = {}
             self.id_cords[self.cnt]["cord"] = self.click_loc
             self.id_cords[self.cnt]["name"] = self.animal_name
 
     def insert_all_bodyparts_into_img(self, img: np.ndarray, body_parts: dict):
         for animal, bp_data in body_parts.items():
@@ -244,26 +244,25 @@
             elif (k == ord("c")) or (k == ord("C")):
                 cv2.destroyWindow("Define animal IDs")
                 cv2.waitKey(0)
                 self.choose_animal_ui()
                 break
 
     def choose_animal_ui(self):
-        print("s")
         self.id_cords = {}
         for cnt, animal in enumerate(self.animal_bp_dict.keys()):
             self.animal_name, self.cnt = animal, cnt
             self.new_overlay = deepcopy(self.img_overlay)
             cv2.namedWindow("Define animal IDs", cv2.WINDOW_NORMAL)
             self.side_img = np.ones(
                 (int(self.video_info["height"] / 2), self.video_info["width"], 3)
             )
             cv2.putText(
                 self.side_img,
-                "Double left mouse click on:",
+                "Left mouse click on:",
                 (10, self.scalers["space"]),
                 cv2.FONT_HERSHEY_SIMPLEX,
                 self.scalers["font"],
                 (255, 255, 255),
                 3,
             )
             cv2.putText(
@@ -362,21 +361,21 @@
             if (k == ord("x")) or (k == ord("X")):
                 if self.frame_no + 50 > len(self.data_df):
                     FrameRangeWarning(
                         msg=f"Cannot proceed to new frame: the frame {self.frame_no+50} does not exist in video {self.video_name}. The video {self.video_name} has {len(self.data_df)} frames."
                     )
                 else:
                     cv2.destroyWindow("Define animal IDs")
-                    cv2.waitKey(0)
+                    cv2.waitKey(1)
                     self.frame_no += 50
                     self.multianimal_identification()
                     break
             elif (k == ord("c")) or (k == ord("C")):
                 cv2.destroyAllWindows()
-                cv2.waitKey(0)
+                cv2.waitKey(1)
                 self.cap.release()
                 self.find_closest_animals()
                 break
 
     def find_closest_animals(self):
         self.animal_order = {}
         for animal_number, animal_click_data in self.id_cords.items():
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/video_processing_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/video_processing_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/feature_extraction_supplement_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/feature_extraction_supplement_mixin.py`

 * *Files 2% similar despite different names*

```diff
@@ -728,47 +728,63 @@
     ) -> Tuple[float, float]:
         """
         Calculate total movement and mean velocity from a sequence of position data.
 
         :param x: Array containing movement data. For example, created by ``simba.mixins.FeatureExtractionMixin.framewise_euclidean_distance``.
         :param fps: Frames per second of the data.
         :param pixels_per_mm: Conversion factor from pixels to millimeters.
-        :param Optional[bool] centimeters: If True, results are returned in centimeters. Defaults to True.
+        :param Optional[bool] centimeters: If True, results are returned in centimeters and centimeters per second. Defaults to True.
         :return Tuple[float, float]: A tuple containing total movement and mean velocity.
 
         :example:
-        >>> x = np.random.randint(0, 100, (100, 2))
+        >>> x = np.random.randint(0, 100, (100,))
         >>> sum_movement, avg_velocity = FeatureExtractionSupplemental.distance_and_velocity(x=x, fps=10, pixels_per_mm=10, centimeters=True)
         """
 
         check_valid_array(
             data=x,
             source=FeatureExtractionSupplemental.distance_and_velocity.__name__,
-            accepted_ndims=(1,),
+            accepted_ndims=(1, 2),
             accepted_dtypes=(np.float32, np.float64, np.int32, np.int64, int, float),
-            min_axis_0=1,
         )
         check_float(
             name=f"{FeatureExtractionSupplemental.distance_and_velocity.__name__} fps",
             value=fps,
             min_value=1,
         )
         check_float(
             name=f"{FeatureExtractionSupplemental.distance_and_velocity.__name__} pixels_per_mm",
             value=pixels_per_mm,
             min_value=10e-6,
         )
+        if x.ndim == 2:
+            check_valid_array(
+                data=x,
+                source=FeatureExtractionSupplemental.distance_and_velocity.__name__,
+                accepted_axis_1_shape=(2,),
+            )
+            t = np.full((x.shape[0]), 0.0)
+            for i in range(1, x.shape[0]):
+                t[i] = np.linalg.norm(x[i] - x[i - 1])
+            x = np.copy(t) / pixels_per_mm
         movement = np.sum(x) / pixels_per_mm
         v = []
         for i in range(0, x.shape[0], int(fps)):
             w = x[i : (i + int(fps))]
             v.append((np.sum(w) / pixels_per_mm) * (1 / (w.shape[0] / int(fps))))
         if centimeters:
             v = [vi / 10 for vi in v]
             movement = movement / 10
         return movement, np.mean(v)
 
 
+x = np.random.randint(0, 100, (100, 2))
+FeatureExtractionSupplemental.distance_and_velocity(
+    x=x, fps=10, pixels_per_mm=10, centimeters=True
+)
+# # sum_movement, avg_velocity =
+
+
 # df = read_df(file_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/csv/targets_inserted/Together_1.csv', file_type='csv')
 #
 # df = pd.DataFrame(np.random.randint(0, 2, (100, 2)), columns=['Attack', 'Sniffing'])
 # FeatureExtractionSupplemental.sequential_lag_analysis(data=df, criterion='Attack', target='Sniffing', fps=5, time_window=2.0)
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/statistics_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/statistics_mixin.py`

 * *Files 4% similar despite different names*

```diff
@@ -387,9250 +387,10216 @@
 00001820: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
 00001830: 636f 6d70 7574 6520 696e 6465 7065 6e64  compute independ
 00001840: 656e 742d 7361 6d70 6c65 7320 742d 7465  ent-samples t-te
 00001850: 7374 2073 7461 7469 7374 6963 2061 6e64  st statistic and
 00001860: 2062 6f6f 6c65 616e 2073 6967 6e69 6669   boolean signifi
 00001870: 6361 6e63 6520 6265 7477 6565 6e20 7477  cance between tw
 00001880: 6f20 6469 7374 7269 6275 7469 6f6e 732e  o distributions.
-00001890: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000018a0: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
-000018b0: 706c 655f 313a 2046 6972 7374 2031 6420  ple_1: First 1d 
-000018c0: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
-000018d0: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
-000018e0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-000018f0: 6d65 7465 7220 6e64 6172 7261 7920 7361  meter ndarray sa
-00001900: 6d70 6c65 5f32 3a20 5365 636f 6e64 2031  mple_2: Second 1
-00001910: 6420 6172 7261 7920 7265 7072 6573 656e  d array represen
-00001920: 7469 6e67 2066 6561 7475 7265 2076 616c  ting feature val
-00001930: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
-00001940: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
-00001950: 6372 6974 6963 616c 5f76 616c 7565 733a  critical_values:
-00001960: 2032 6420 6172 7261 7920 7768 6572 6520   2d array where 
-00001970: 7468 6520 6669 7273 7420 636f 6c75 6d6e  the first column
-00001980: 2072 6570 7265 7365 6e74 7320 6465 6772   represents degr
-00001990: 6565 7320 6f66 2066 7265 6564 6f6d 2061  ees of freedom a
-000019a0: 6e64 2073 6563 6f6e 6420 636f 6c75 6d6e  nd second column
-000019b0: 2072 6570 7265 7365 6e74 7320 6372 6974   represents crit
-000019c0: 6963 616c 2076 616c 7565 732e 0a20 2020  ical values..   
-000019d0: 2020 2020 203a 7265 7475 726e 7320 2866       :returns (f
-000019e0: 6c6f 6174 2055 6e69 6f6e 5b4e 6f6e 652c  loat Union[None,
-000019f0: 2062 6f6f 6c5d 2920 745f 7374 6174 6973   bool]) t_statis
-00001a00: 7469 632c 2070 5f76 616c 7565 3a20 5265  tic, p_value: Re
-00001a10: 7072 6573 656e 7469 6e67 2074 2d73 7461  presenting t-sta
-00001a20: 7469 7374 6963 2061 6e64 2061 7373 6f63  tistic and assoc
-00001a30: 6961 7465 6420 7072 6f62 6162 696c 6974  iated probabilit
-00001a40: 7920 7661 6c75 652e 2070 5f76 616c 7565  y value. p_value
-00001a50: 2069 7320 6060 4e6f 6e65 6060 2069 6620   is ``None`` if 
-00001a60: 6372 6974 6963 616c 5f76 616c 7565 7320  critical_values 
-00001a70: 6973 204e 6f6e 652e 2045 6c73 6520 5472  is None. Else Tr
-00001a80: 7565 206f 7220 4661 6c73 6520 7769 7468  ue or False with
-00001a90: 2054 7275 6520 7265 7072 6573 656e 7469   True representi
-00001aa0: 6e67 2073 6967 6e69 6669 6361 6e74 2e0a  ng significant..
-00001ab0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
-00001ac0: 3a3a 0a20 2020 2020 2020 2020 2020 4372  ::.           Cr
-00001ad0: 6974 6963 616c 2076 616c 7565 7320 6172  itical values ar
-00001ae0: 6520 7374 6f72 6564 2069 6e20 7369 6d62  e stored in simb
-00001af0: 612e 6173 7365 7473 2e6c 6f6f 6b75 7073  a.assets.lookups
-00001b00: 2e63 7269 7469 6361 6c5f 7661 6c75 6573  .critical_values
-00001b10: 5f2a 2a2e 7069 636b 6c65 0a0a 2020 2020  _**.pickle..    
-00001b20: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00001b30: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-00001b40: 5f31 203d 206e 702e 6172 7261 7928 5b31  _1 = np.array([1
-00001b50: 2c20 322c 2033 2c20 312c 2033 2c20 322c  , 2, 3, 1, 3, 2,
-00001b60: 2031 2c20 3130 2c20 382c 2034 2c20 3130   1, 10, 8, 4, 10
-00001b70: 5d29 0a20 2020 2020 2020 203e 3e3e 2073  ]).        >>> s
-00001b80: 616d 706c 655f 3220 3d20 6e70 2e61 7272  ample_2 = np.arr
-00001b90: 6179 285b 322c 2035 2c20 3130 2c20 342c  ay([2, 5, 10, 4,
-00001ba0: 2038 2c20 3130 2c20 372c 2031 302c 2037   8, 10, 7, 10, 7
-00001bb0: 2c20 3130 2c20 3130 5d29 0a20 2020 2020  , 10, 10]).     
-00001bc0: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
-00001bd0: 7328 292e 696e 6465 7065 6e64 656e 745f  s().independent_
-00001be0: 7361 6d70 6c65 735f 7428 7361 6d70 6c65  samples_t(sample
-00001bf0: 5f31 3d73 616d 706c 655f 312c 2073 616d  _1=sample_1, sam
-00001c00: 706c 655f 323d 7361 6d70 6c65 5f32 290a  ple_2=sample_2).
-00001c10: 2020 2020 2020 2020 3e3e 3e20 282d 322e          >>> (-2.
-00001c20: 3532 3636 3034 3638 3034 3539 3031 3833  5266046804590183
-00001c30: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00001c40: 3e3e 3e20 6372 6974 6963 616c 5f76 616c  >>> critical_val
-00001c50: 7565 7320 3d20 7069 636b 6c65 2e6c 6f61  ues = pickle.loa
-00001c60: 6428 6f70 656e 2822 7369 6d62 612f 6173  d(open("simba/as
-00001c70: 7365 7473 2f6c 6f6f 6b75 7073 2f63 7269  sets/lookups/cri
-00001c80: 7469 6361 6c5f 7661 6c75 6573 5f30 352e  tical_values_05.
-00001c90: 7069 636b 6c65 222c 2272 6222 2929 5b27  pickle","rb"))['
-00001ca0: 696e 6465 7065 6e64 656e 745f 745f 7465  independent_t_te
-00001cb0: 7374 275d 5b27 6f6e 655f 7461 696c 275d  st']['one_tail']
-00001cc0: 2e76 616c 7565 730a 2020 2020 2020 2020  .values.        
-00001cd0: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
-00001ce0: 2e69 6e64 6570 656e 6465 6e74 5f73 616d  .independent_sam
-00001cf0: 706c 6573 5f74 2873 616d 706c 655f 313d  ples_t(sample_1=
-00001d00: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
-00001d10: 5f32 3d73 616d 706c 655f 322c 2063 7269  _2=sample_2, cri
-00001d20: 7469 6361 6c5f 7661 6c75 6573 3d63 7269  tical_values=cri
-00001d30: 7469 6361 6c5f 7661 6c75 6573 290a 2020  tical_values).  
-00001d40: 2020 2020 2020 3e3e 3e20 282d 322e 3532        >>> (-2.52
-00001d50: 3636 3034 3638 3034 3539 3031 3833 2c20  66046804590183, 
-00001d60: 5472 7565 290a 2020 2020 2020 2020 2222  True).        ""
-00001d70: 220a 0a20 2020 2020 2020 2073 6967 6e69  "..        signi
-00001d80: 6669 6361 6e63 655f 626f 6f6c 203d 204e  ficance_bool = N
-00001d90: 6f6e 650a 2020 2020 2020 2020 6d31 2c20  one.        m1, 
-00001da0: 6d32 203d 206e 702e 6d65 616e 2873 616d  m2 = np.mean(sam
-00001db0: 706c 655f 3129 2c20 6e70 2e6d 6561 6e28  ple_1), np.mean(
-00001dc0: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
-00001dd0: 2020 7374 645f 3120 3d20 6e70 2e73 7172    std_1 = np.sqr
-00001de0: 7428 6e70 2e73 756d 2828 7361 6d70 6c65  t(np.sum((sample
-00001df0: 5f31 202d 206d 3129 202a 2a20 3229 202f  _1 - m1) ** 2) /
-00001e00: 2028 6c65 6e28 7361 6d70 6c65 5f31 2920   (len(sample_1) 
-00001e10: 2d20 3129 290a 2020 2020 2020 2020 7374  - 1)).        st
-00001e20: 645f 3220 3d20 6e70 2e73 7172 7428 6e70  d_2 = np.sqrt(np
-00001e30: 2e73 756d 2828 7361 6d70 6c65 5f32 202d  .sum((sample_2 -
-00001e40: 206d 3229 202a 2a20 3229 202f 2028 6c65   m2) ** 2) / (le
-00001e50: 6e28 7361 6d70 6c65 5f32 2920 2d20 3129  n(sample_2) - 1)
-00001e60: 290a 2020 2020 2020 2020 706f 6f6c 6564  ).        pooled
-00001e70: 5f73 7464 203d 206e 702e 7371 7274 280a  _std = np.sqrt(.
-00001e80: 2020 2020 2020 2020 2020 2020 2828 6c65              ((le
-00001e90: 6e28 7361 6d70 6c65 5f31 2920 2d20 3129  n(sample_1) - 1)
-00001ea0: 202a 2073 7464 5f31 2a2a 3220 2b20 286c   * std_1**2 + (l
-00001eb0: 656e 2873 616d 706c 655f 3229 202d 2031  en(sample_2) - 1
-00001ec0: 2920 2a20 7374 645f 322a 2a32 290a 2020  ) * std_2**2).  
-00001ed0: 2020 2020 2020 2020 2020 2f20 286c 656e            / (len
-00001ee0: 2873 616d 706c 655f 3129 202b 206c 656e  (sample_1) + len
-00001ef0: 2873 616d 706c 655f 3229 202d 2032 290a  (sample_2) - 2).
-00001f00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00001f10: 2020 745f 7374 6174 6973 7469 6320 3d20    t_statistic = 
-00001f20: 286d 3120 2d20 6d32 2920 2f20 280a 2020  (m1 - m2) / (.  
-00001f30: 2020 2020 2020 2020 2020 706f 6f6c 6564            pooled
-00001f40: 5f73 7464 202a 206e 702e 7371 7274 2831  _std * np.sqrt(1
-00001f50: 202f 206c 656e 2873 616d 706c 655f 3129   / len(sample_1)
-00001f60: 202b 2031 202f 206c 656e 2873 616d 706c   + 1 / len(sampl
-00001f70: 655f 3229 290a 2020 2020 2020 2020 290a  e_2)).        ).
-00001f80: 2020 2020 2020 2020 6966 2063 7269 7469          if criti
-00001f90: 6361 6c5f 7661 6c75 6573 2069 7320 6e6f  cal_values is no
-00001fa0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00001fb0: 2020 2020 646f 6620 3d20 2873 616d 706c      dof = (sampl
-00001fc0: 655f 312e 7368 6170 655b 305d 202b 2073  e_1.shape[0] + s
-00001fd0: 616d 706c 655f 322e 7368 6170 655b 305d  ample_2.shape[0]
-00001fe0: 2920 2d20 320a 2020 2020 2020 2020 2020  ) - 2.          
-00001ff0: 2020 6372 6974 6963 616c 5f76 616c 7565    critical_value
-00002000: 203d 206e 702e 696e 7465 7270 280a 2020   = np.interp(.  
-00002010: 2020 2020 2020 2020 2020 2020 2020 646f                do
-00002020: 662c 2063 7269 7469 6361 6c5f 7661 6c75  f, critical_valu
-00002030: 6573 5b3a 2c20 305d 2c20 6372 6974 6963  es[:, 0], critic
-00002040: 616c 5f76 616c 7565 735b 3a2c 2031 5d0a  al_values[:, 1].
-00002050: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00002060: 2020 2020 2020 2020 2020 6966 2063 7269            if cri
-00002070: 7469 6361 6c5f 7661 6c75 6520 3c20 6162  tical_value < ab
-00002080: 7328 745f 7374 6174 6973 7469 6329 3a0a  s(t_statistic):.
-00002090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000020a0: 7369 676e 6966 6963 616e 6365 5f62 6f6f  significance_boo
-000020b0: 6c20 3d20 5472 7565 0a20 2020 2020 2020  l = True.       
-000020c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000020d0: 2020 2020 2020 2020 2020 2073 6967 6e69             signi
-000020e0: 6669 6361 6e63 655f 626f 6f6c 203d 2046  ficance_bool = F
-000020f0: 616c 7365 0a0a 2020 2020 2020 2020 7265  alse..        re
-00002100: 7475 726e 2074 5f73 7461 7469 7374 6963  turn t_statistic
-00002110: 2c20 7369 676e 6966 6963 616e 6365 5f62  , significance_b
-00002120: 6f6f 6c0a 0a20 2020 2040 7374 6174 6963  ool..    @static
-00002130: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
-00002140: 2822 2866 6c6f 6174 3634 5b3a 5d2c 2066  ("(float64[:], f
-00002150: 6c6f 6174 3634 5b3a 5d29 222c 2063 6163  loat64[:])", cac
-00002160: 6865 3d54 7275 6529 0a20 2020 2064 6566  he=True).    def
-00002170: 2063 6f68 656e 735f 6428 7361 6d70 6c65   cohens_d(sample
-00002180: 5f31 3a20 6e70 2e6e 6461 7272 6179 2c20  _1: np.ndarray, 
-00002190: 7361 6d70 6c65 5f32 3a20 6e70 2e6e 6461  sample_2: np.nda
-000021a0: 7272 6179 2920 2d3e 2066 6c6f 6174 3a0a  rray) -> float:.
-000021b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000021c0: 2020 2020 4a69 7474 6564 2063 6f6d 7075      Jitted compu
-000021d0: 7465 206f 6620 436f 6865 6e27 7320 6420  te of Cohen's d 
-000021e0: 6265 7477 6565 6e20 7477 6f20 6469 7374  between two dist
-000021f0: 7269 6275 7469 6f6e 730a 0a20 2020 2020  ributions..     
-00002200: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
-00002210: 6172 7261 7920 7361 6d70 6c65 5f31 3a20  array sample_1: 
-00002220: 4669 7273 7420 3164 2061 7272 6179 2072  First 1d array r
-00002230: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
-00002240: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-00002250: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-00002260: 6461 7272 6179 2073 616d 706c 655f 323a  darray sample_2:
-00002270: 2053 6563 6f6e 6420 3164 2061 7272 6179   Second 1d array
-00002280: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
-00002290: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
-000022a0: 2020 2020 2020 3a72 6574 7572 6e73 2066        :returns f
-000022b0: 6c6f 6174 3a20 436f 6865 6e73 2044 2073  loat: Cohens D s
-000022c0: 7461 7469 7374 6963 2e0a 0a20 2020 2020  tatistic...     
-000022d0: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
-000022e0: 2020 2020 203e 3e3e 2073 616d 706c 655f       >>> sample_
-000022f0: 3120 3d20 5b32 2c20 342c 2037 2c20 332c  1 = [2, 4, 7, 3,
-00002300: 2037 2c20 3335 2c20 382c 2039 5d0a 2020   7, 35, 8, 9].  
-00002310: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-00002320: 5f32 203d 205b 342c 2038 2c20 3134 2c20  _2 = [4, 8, 14, 
-00002330: 362c 2031 342c 2037 302c 2031 362c 2031  6, 14, 70, 16, 1
-00002340: 385d 0a20 2020 2020 2020 203e 3e3e 2053  8].        >>> S
-00002350: 7461 7469 7374 6963 7328 292e 636f 6865  tatistics().cohe
-00002360: 6e73 5f64 2873 616d 706c 655f 313d 7361  ns_d(sample_1=sa
-00002370: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
-00002380: 3d73 616d 706c 655f 3229 0a20 2020 2020  =sample_2).     
-00002390: 2020 203e 3e3e 202d 302e 3539 3532 3039     >>> -0.595209
-000023a0: 3937 3735 3137 3035 3436 0a20 2020 2020  9775170546.     
-000023b0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-000023c0: 6574 7572 6e20 286e 702e 6d65 616e 2873  eturn (np.mean(s
-000023d0: 616d 706c 655f 3129 202d 206e 702e 6d65  ample_1) - np.me
-000023e0: 616e 2873 616d 706c 655f 3229 2920 2f20  an(sample_2)) / 
-000023f0: 280a 2020 2020 2020 2020 2020 2020 6e70  (.            np
-00002400: 2e73 7172 7428 286e 702e 7374 6428 7361  .sqrt((np.std(sa
-00002410: 6d70 6c65 5f31 2920 2a2a 2032 202b 206e  mple_1) ** 2 + n
-00002420: 702e 7374 6428 7361 6d70 6c65 5f32 2920  p.std(sample_2) 
-00002430: 2a2a 2032 2920 2f20 3229 0a20 2020 2020  ** 2) / 2).     
-00002440: 2020 2029 0a0a 2020 2020 4073 7461 7469     )..    @stati
-00002450: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
-00002460: 7428 2228 666c 6f61 7436 345b 3a5d 2c20  t("(float64[:], 
-00002470: 666c 6f61 7436 345b 3a5d 2c20 666c 6f61  float64[:], floa
-00002480: 7436 3429 222c 2063 6163 6865 3d54 7275  t64)", cache=Tru
-00002490: 6529 0a20 2020 2064 6566 2072 6f6c 6c69  e).    def rolli
-000024a0: 6e67 5f63 6f68 656e 735f 6428 0a20 2020  ng_cohens_d(.   
-000024b0: 2020 2020 2064 6174 613a 206e 702e 6e64       data: np.nd
-000024c0: 6172 7261 792c 2074 696d 655f 7769 6e64  array, time_wind
-000024d0: 6f77 733a 206e 702e 6e64 6172 7261 792c  ows: np.ndarray,
-000024e0: 2066 7073 3a20 666c 6f61 740a 2020 2020   fps: float.    
-000024f0: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
-00002500: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00002510: 2020 2020 204a 6974 7465 6420 636f 6d70       Jitted comp
-00002520: 7574 6520 6f66 2072 6f6c 6c69 6e67 2043  ute of rolling C
-00002530: 6f68 656e 2773 2044 2073 7461 7469 7374  ohen's D statist
-00002540: 6963 2063 6f6d 7061 7269 6e67 2074 6865  ic comparing the
-00002550: 2063 7572 7265 6e74 2074 696d 652d 7769   current time-wi
-00002560: 6e64 6f77 206f 660a 2020 2020 2020 2020  ndow of.        
-00002570: 7369 7a65 204e 2074 6f20 7468 6520 7072  size N to the pr
-00002580: 6563 6564 696e 6720 7769 6e64 6f77 206f  eceding window o
-00002590: 6620 7369 7a65 204e 2e0a 0a20 2020 2020  f size N...     
-000025a0: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
-000025b0: 6172 7261 7920 6461 7461 3a20 3144 2061  array data: 1D a
-000025c0: 7272 6179 206f 6620 7369 7a65 206c 656e  rray of size len
-000025d0: 2866 7261 6d65 7329 2072 6570 7265 7365  (frames) represe
-000025e0: 6e74 696e 6720 6665 6174 7572 6520 7661  nting feature va
-000025f0: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
-00002600: 6172 616d 6574 6572 206e 702e 6e64 6172  arameter np.ndar
-00002610: 7261 795b 696e 7473 5d20 7469 6d65 5f77  ray[ints] time_w
-00002620: 696e 646f 773a 2054 696d 6520 7769 6e64  indow: Time wind
-00002630: 6f77 7320 746f 2063 6f6d 7075 7465 2041  ows to compute A
-00002640: 4e4f 5641 7320 666f 7220 696e 2073 6563  NOVAs for in sec
-00002650: 6f6e 6473 2e0a 2020 2020 2020 2020 3a70  onds..        :p
-00002660: 6172 616d 6574 6572 2069 6e74 2066 7073  arameter int fps
-00002670: 3a20 4672 616d 652d 7261 7465 206f 6620  : Frame-rate of 
-00002680: 7265 636f 7264 6564 2076 6964 656f 2e0a  recorded video..
-00002690: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-000026a0: 206e 702e 6e64 6172 7261 793a 2041 7272   np.ndarray: Arr
-000026b0: 6179 206f 6620 7369 7a65 2064 6174 612e  ay of size data.
-000026c0: 7368 6170 655b 305d 2078 2077 696e 646f  shape[0] x windo
-000026d0: 775f 7369 7a65 732e 7368 6170 655b 315d  w_sizes.shape[1]
-000026e0: 2077 6974 6820 436f 6865 6e73 2044 2e0a   with Cohens D..
-000026f0: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-00002700: 653a 0a20 2020 2020 2020 203e 3e3e 2073  e:.        >>> s
-00002710: 616d 706c 655f 312c 2073 616d 706c 655f  ample_1, sample_
-00002720: 3220 3d20 6e70 2e72 616e 646f 6d2e 6e6f  2 = np.random.no
-00002730: 726d 616c 286c 6f63 3d31 302c 2073 6361  rmal(loc=10, sca
-00002740: 6c65 3d31 2c20 7369 7a65 3d34 292c 206e  le=1, size=4), n
-00002750: 702e 7261 6e64 6f6d 2e6e 6f72 6d61 6c28  p.random.normal(
-00002760: 6c6f 633d 3131 2c20 7363 616c 653d 322c  loc=11, scale=2,
-00002770: 2073 697a 653d 3429 0a20 2020 2020 2020   size=4).       
-00002780: 203e 3e3e 2073 616d 706c 6520 3d20 6e70   >>> sample = np
-00002790: 2e68 7374 6163 6b28 2873 616d 706c 655f  .hstack((sample_
-000027a0: 312c 2073 616d 706c 655f 3229 290a 2020  1, sample_2)).  
-000027b0: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
-000027c0: 7469 6373 2829 2e72 6f6c 6c69 6e67 5f63  tics().rolling_c
-000027d0: 6f68 656e 735f 6428 6461 7461 3d73 616d  ohens_d(data=sam
-000027e0: 706c 652c 2077 696e 646f 775f 7369 7a65  ple, window_size
-000027f0: 733d 6e70 2e61 7272 6179 285b 315d 292c  s=np.array([1]),
-00002800: 2066 7073 3d34 290a 2020 2020 2020 2020   fps=4).        
-00002810: 3e3e 3e20 5b5b 302e 5d2c 5b30 2e5d 2c5b  >>> [[0.],[0.],[
-00002820: 302e 5d2c 5b30 2e5d 2c5b 302e 3134 3731  0.],[0.],[0.1471
-00002830: 3833 3032 5d2c 5b30 2e31 3437 3138 3330  8302],[0.1471830
-00002840: 325d 2c5b 302e 3134 3731 3833 3032 5d2c  2],[0.14718302],
-00002850: 5b30 2e31 3437 3138 3330 325d 5d29 0a20  [0.14718302]]). 
-00002860: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00002870: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
-00002880: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
-00002890: 655b 305d 2c20 7469 6d65 5f77 696e 646f  e[0], time_windo
-000028a0: 7773 2e73 6861 7065 5b30 5d29 2c20 302e  ws.shape[0]), 0.
-000028b0: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
-000028c0: 2069 6e20 7072 616e 6765 2874 696d 655f   in prange(time_
-000028d0: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
-000028e0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-000028f0: 696e 646f 775f 7369 7a65 203d 2069 6e74  indow_size = int
-00002900: 2874 696d 655f 7769 6e64 6f77 735b 695d  (time_windows[i]
-00002910: 202a 2066 7073 290a 2020 2020 2020 2020   * fps).        
-00002920: 2020 2020 6461 7461 5f73 706c 6974 203d      data_split =
-00002930: 206e 702e 7370 6c69 7428 0a20 2020 2020   np.split(.     
-00002940: 2020 2020 2020 2020 2020 2064 6174 612c             data,
-00002950: 206c 6973 7428 7261 6e67 6528 7769 6e64   list(range(wind
-00002960: 6f77 5f73 697a 652c 2064 6174 612e 7368  ow_size, data.sh
-00002970: 6170 655b 305d 2c20 7769 6e64 6f77 5f73  ape[0], window_s
-00002980: 697a 6529 290a 2020 2020 2020 2020 2020  ize)).          
-00002990: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000029a0: 666f 7220 6a20 696e 2070 7261 6e67 6528  for j in prange(
-000029b0: 312c 206c 656e 2864 6174 615f 7370 6c69  1, len(data_spli
-000029c0: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
-000029d0: 2020 2020 2077 696e 646f 775f 7374 6172       window_star
-000029e0: 7420 3d20 696e 7428 7769 6e64 6f77 5f73  t = int(window_s
-000029f0: 697a 6520 2a20 6a29 0a20 2020 2020 2020  ize * j).       
-00002a00: 2020 2020 2020 2020 2077 696e 646f 775f           window_
-00002a10: 656e 6420 3d20 696e 7428 7769 6e64 6f77  end = int(window
-00002a20: 5f73 7461 7274 202b 2077 696e 646f 775f  _start + window_
-00002a30: 7369 7a65 290a 2020 2020 2020 2020 2020  size).          
-00002a40: 2020 2020 2020 7361 6d70 6c65 5f31 2c20        sample_1, 
-00002a50: 7361 6d70 6c65 5f32 203d 2064 6174 615f  sample_2 = data_
-00002a60: 7370 6c69 745b 6a20 2d20 315d 2e61 7374  split[j - 1].ast
-00002a70: 7970 6528 6e70 2e66 6c6f 6174 3332 292c  ype(np.float32),
-00002a80: 2064 6174 615f 7370 6c69 745b 0a20 2020   data_split[.   
-00002a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002aa0: 206a 0a20 2020 2020 2020 2020 2020 2020   j.             
-00002ab0: 2020 205d 2e61 7374 7970 6528 6e70 2e66     ].astype(np.f
-00002ac0: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
-00002ad0: 2020 2020 2020 2020 6420 3d20 286e 702e          d = (np.
-00002ae0: 6d65 616e 2873 616d 706c 655f 3129 202d  mean(sample_1) -
-00002af0: 206e 702e 6d65 616e 2873 616d 706c 655f   np.mean(sample_
-00002b00: 3229 2920 2f20 280a 2020 2020 2020 2020  2)) / (.        
-00002b10: 2020 2020 2020 2020 2020 2020 6e70 2e73              np.s
-00002b20: 7172 7428 286e 702e 7374 6428 7361 6d70  qrt((np.std(samp
-00002b30: 6c65 5f31 2920 2a2a 2032 202b 206e 702e  le_1) ** 2 + np.
-00002b40: 7374 6428 7361 6d70 6c65 5f32 2920 2a2a  std(sample_2) **
-00002b50: 2032 2920 2f20 3229 0a20 2020 2020 2020   2) / 2).       
-00002b60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00002b70: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00002b80: 7473 5b77 696e 646f 775f 7374 6172 743a  ts[window_start:
-00002b90: 7769 6e64 6f77 5f65 6e64 2c20 695d 203d  window_end, i] =
-00002ba0: 2064 0a20 2020 2020 2020 2072 6574 7572   d.        retur
-00002bb0: 6e20 7265 7375 6c74 730a 0a20 2020 2040  n results..    @
-00002bc0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00002bd0: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
-00002be0: 5b3a 5d2c 2066 6c6f 6174 3634 2c20 666c  [:], float64, fl
-00002bf0: 6f61 7436 3429 2229 0a20 2020 2064 6566  oat64)").    def
-00002c00: 2072 6f6c 6c69 6e67 5f74 776f 5f73 616d   rolling_two_sam
-00002c10: 706c 655f 6b73 280a 2020 2020 2020 2020  ple_ks(.        
-00002c20: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00002c30: 2c20 7469 6d65 5f77 696e 646f 773a 2066  , time_window: f
-00002c40: 6c6f 6174 2c20 6670 733a 2066 6c6f 6174  loat, fps: float
-00002c50: 0a20 2020 2029 202d 3e20 6e70 2e6e 6461  .    ) -> np.nda
-00002c60: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
-00002c70: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
-00002c80: 2063 6f6d 7075 7465 204b 6f6c 6d6f 676f   compute Kolmogo
-00002c90: 726f 7620 7477 6f2d 7361 6d70 6c65 2073  rov two-sample s
-00002ca0: 7461 7469 7374 6963 7320 666f 7220 7365  tatistics for se
-00002cb0: 7175 656e 7469 616c 6c79 2062 696e 6e65  quentially binne
-00002cc0: 6420 7661 6c75 6573 2069 6e20 6120 7469  d values in a ti
-00002cd0: 6d65 2d73 6572 6965 732e 0a20 2020 2020  me-series..     
-00002ce0: 2020 2045 2e67 2e2c 2063 6f6d 7075 7465     E.g., compute
-00002cf0: 204b 5320 7374 6174 6973 7469 6373 2077   KS statistics w
-00002d00: 6865 6e20 636f 6d70 6172 696e 6720 6060  hen comparing ``
-00002d10: 4665 6174 7572 6520 4e60 6020 696e 2074  Feature N`` in t
-00002d20: 6865 2063 7572 7265 6e74 2031 7320 7469  he current 1s ti
-00002d30: 6d65 2d77 696e 646f 772c 2076 6572 7375  me-window, versu
-00002d40: 7320 6060 4665 6174 7572 6520 4e60 6020  s ``Feature N`` 
-00002d50: 696e 2074 6865 2070 7265 7669 6f75 7320  in the previous 
-00002d60: 3173 2074 696d 652d 7769 6e64 6f77 2e0a  1s time-window..
-00002d70: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-00002d80: 7465 7220 6e64 6172 7261 7920 6461 7461  ter ndarray data
-00002d90: 3a20 3144 2061 7272 6179 206f 6620 7369  : 1D array of si
-00002da0: 7a65 206c 656e 2866 7261 6d65 7329 2072  ze len(frames) r
-00002db0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
-00002dc0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-00002dd0: 2020 2020 3a70 6172 616d 6574 6572 2066      :parameter f
-00002de0: 6c6f 6174 2074 696d 655f 7769 6e64 6f77  loat time_window
-00002df0: 3a20 5468 6520 7369 7a65 206f 6620 7468  : The size of th
-00002e00: 6520 6275 636b 6574 7320 696e 2073 6563  e buckets in sec
-00002e10: 6f6e 6473 2e0a 2020 2020 2020 2020 3a70  onds..        :p
-00002e20: 6172 616d 6574 6572 2069 6e74 2066 7073  arameter int fps
-00002e30: 3a20 4672 616d 652d 7261 7465 206f 6620  : Frame-rate of 
-00002e40: 7265 636f 7264 6564 2076 6964 656f 2e0a  recorded video..
-00002e50: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-00002e60: 6e70 2e6e 6461 7272 6179 3a20 4172 7261  np.ndarray: Arra
-00002e70: 7920 6f66 2073 697a 6520 6461 7461 2e73  y of size data.s
-00002e80: 6861 7065 5b30 5d20 7769 7468 204b 5320  hape[0] with KS 
-00002e90: 7374 6174 6973 7469 6373 0a0a 2020 2020  statistics..    
-00002ea0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00002eb0: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-00002ec0: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-00002ed0: 6e74 286c 6f77 3d30 2c20 6869 6768 3d31  nt(low=0, high=1
-00002ee0: 3030 2c20 7369 7a65 3d28 3230 3029 292e  00, size=(200)).
-00002ef0: 6173 7479 7065 2827 666c 6f61 7433 3227  astype('float32'
-00002f00: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-00002f10: 7375 6c74 7320 3d20 5374 6174 6973 7469  sults = Statisti
-00002f20: 6373 2829 2e72 6f6c 6c69 6e67 5f74 776f  cs().rolling_two
-00002f30: 5f73 616d 706c 655f 6b73 2864 6174 613d  _sample_ks(data=
-00002f40: 6461 7461 2c20 7469 6d65 5f77 696e 646f  data, time_windo
-00002f50: 773d 312c 2066 7073 3d33 3029 0a20 2020  w=1, fps=30).   
-00002f60: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00002f70: 2020 7769 6e64 6f77 5f73 697a 652c 2072    window_size, r
-00002f80: 6573 756c 7473 203d 2069 6e74 2874 696d  esults = int(tim
-00002f90: 655f 7769 6e64 6f77 202a 2066 7073 292c  e_window * fps),
-00002fa0: 206e 702e 6675 6c6c 2828 6461 7461 2e73   np.full((data.s
-00002fb0: 6861 7065 5b30 5d29 2c20 2d31 2e30 290a  hape[0]), -1.0).
-00002fc0: 2020 2020 2020 2020 6461 7461 203d 206e          data = n
-00002fd0: 702e 7370 6c69 7428 6461 7461 2c20 6c69  p.split(data, li
-00002fe0: 7374 2872 616e 6765 2877 696e 646f 775f  st(range(window_
-00002ff0: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
-00003000: 5b30 5d2c 2077 696e 646f 775f 7369 7a65  [0], window_size
-00003010: 2929 290a 2020 2020 2020 2020 666f 7220  ))).        for 
-00003020: 636e 742c 2069 2069 6e20 656e 756d 6572  cnt, i in enumer
-00003030: 6174 6528 7072 616e 6765 2831 2c20 6c65  ate(prange(1, le
-00003040: 6e28 6461 7461 2929 293a 0a20 2020 2020  n(data))):.     
-00003050: 2020 2020 2020 2073 7461 7274 2c20 656e         start, en
-00003060: 6420 3d20 696e 7428 2863 6e74 202b 2031  d = int((cnt + 1
-00003070: 2920 2a20 7769 6e64 6f77 5f73 697a 6529  ) * window_size)
-00003080: 2c20 696e 7428 0a20 2020 2020 2020 2020  , int(.         
-00003090: 2020 2020 2020 2028 2863 6e74 202b 2031         ((cnt + 1
-000030a0: 2920 2a20 7769 6e64 6f77 5f73 697a 6529  ) * window_size)
-000030b0: 202b 2077 696e 646f 775f 7369 7a65 0a20   + window_size. 
-000030c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000030d0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-000030e0: 312c 2073 616d 706c 655f 3220 3d20 6461  1, sample_2 = da
-000030f0: 7461 5b69 202d 2031 5d2c 2064 6174 615b  ta[i - 1], data[
-00003100: 695d 0a20 2020 2020 2020 2020 2020 2063  i].            c
-00003110: 6f6d 6269 6e65 645f 7361 6d70 6c65 7320  ombined_samples 
-00003120: 3d20 6e70 2e73 6f72 7428 6e70 2e63 6f6e  = np.sort(np.con
-00003130: 6361 7465 6e61 7465 2828 7361 6d70 6c65  catenate((sample
-00003140: 5f31 2c20 7361 6d70 6c65 5f32 2929 290a  _1, sample_2))).
-00003150: 2020 2020 2020 2020 2020 2020 6563 6466              ecdf
-00003160: 5f73 616d 706c 655f 3120 3d20 6e70 2e73  _sample_1 = np.s
-00003170: 6561 7263 6873 6f72 7465 6428 0a20 2020  earchsorted(.   
-00003180: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-00003190: 706c 655f 312c 2063 6f6d 6269 6e65 645f  ple_1, combined_
-000031a0: 7361 6d70 6c65 732c 2073 6964 653d 2272  samples, side="r
-000031b0: 6967 6874 220a 2020 2020 2020 2020 2020  ight".          
-000031c0: 2020 2920 2f20 6c65 6e28 7361 6d70 6c65    ) / len(sample
-000031d0: 5f31 290a 2020 2020 2020 2020 2020 2020  _1).            
-000031e0: 6563 6466 5f73 616d 706c 655f 3220 3d20  ecdf_sample_2 = 
-000031f0: 6e70 2e73 6561 7263 6873 6f72 7465 6428  np.searchsorted(
-00003200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003210: 2073 616d 706c 655f 322c 2063 6f6d 6269   sample_2, combi
-00003220: 6e65 645f 7361 6d70 6c65 732c 2073 6964  ned_samples, sid
-00003230: 653d 2272 6967 6874 220a 2020 2020 2020  e="right".      
-00003240: 2020 2020 2020 2920 2f20 6c65 6e28 7361        ) / len(sa
-00003250: 6d70 6c65 5f32 290a 2020 2020 2020 2020  mple_2).        
-00003260: 2020 2020 6b73 203d 206e 702e 6d61 7828      ks = np.max(
-00003270: 6e70 2e61 6273 2865 6364 665f 7361 6d70  np.abs(ecdf_samp
-00003280: 6c65 5f31 202d 2065 6364 665f 7361 6d70  le_1 - ecdf_samp
-00003290: 6c65 5f32 2929 0a20 2020 2020 2020 2020  le_2)).         
-000032a0: 2020 2072 6573 756c 7473 5b73 7461 7274     results[start
-000032b0: 3a65 6e64 5d20 3d20 6b73 0a20 2020 2020  :end] = ks.     
-000032c0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-000032d0: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
-000032e0: 7468 6f64 0a20 2020 2040 6e6a 6974 280a  thod.    @njit(.
-000032f0: 2020 2020 2020 2020 5b0a 2020 2020 2020          [.      
-00003300: 2020 2020 2020 2866 6c6f 6174 3332 5b3a        (float32[:
-00003310: 5d2c 2066 6c6f 6174 3332 5b3a 5d2c 2066  ], float32[:], f
-00003320: 6c6f 6174 3634 5b3a 2c20 3a5d 292c 0a20  loat64[:, :]),. 
-00003330: 2020 2020 2020 2020 2020 2028 666c 6f61             (floa
-00003340: 7433 325b 3a5d 2c20 666c 6f61 7433 325b  t32[:], float32[
-00003350: 3a5d 2c20 7479 7065 732e 6d69 7363 2e4f  :], types.misc.O
-00003360: 6d69 7474 6564 284e 6f6e 6529 292c 0a20  mitted(None)),. 
-00003370: 2020 2020 2020 205d 0a20 2020 2029 0a20         ].    ). 
-00003380: 2020 2064 6566 2074 776f 5f73 616d 706c     def two_sampl
-00003390: 655f 6b73 280a 2020 2020 2020 2020 7361  e_ks(.        sa
-000033a0: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
-000033b0: 6179 2c0a 2020 2020 2020 2020 7361 6d70  ay,.        samp
-000033c0: 6c65 5f32 3a20 6e70 2e6e 6461 7272 6179  le_2: np.ndarray
-000033d0: 2c0a 2020 2020 2020 2020 6372 6974 6963  ,.        critic
-000033e0: 616c 5f76 616c 7565 733a 204f 7074 696f  al_values: Optio
-000033f0: 6e61 6c5b 666c 6f61 7436 345b 3a2c 203a  nal[float64[:, :
-00003400: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
-00003410: 202d 3e20 2866 6c6f 6174 2c20 556e 696f   -> (float, Unio
-00003420: 6e5b 626f 6f6c 2c20 4e6f 6e65 5d29 3a0a  n[bool, None]):.
-00003430: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00003440: 2020 2020 436f 6d70 7574 6520 7468 6520      Compute the 
-00003450: 7477 6f2d 7361 6d70 6c65 204b 6f6c 6d6f  two-sample Kolmo
-00003460: 676f 726f 762d 536d 6972 6e6f 7620 284b  gorov-Smirnov (K
-00003470: 5329 2074 6573 7420 7374 6174 6973 7469  S) test statisti
-00003480: 6320 616e 642c 206f 7074 696f 6e61 6c6c  c and, optionall
-00003490: 792c 2074 6573 7420 666f 7220 7374 6174  y, test for stat
-000034a0: 6973 7469 6361 6c20 7369 676e 6966 6963  istical signific
-000034b0: 616e 6365 2e0a 0a20 2020 2020 2020 2054  ance...        T
-000034c0: 6865 2074 776f 2d73 616d 706c 6520 4b53  he two-sample KS
-000034d0: 2074 6573 7420 6973 2061 206e 6f6e 2d70   test is a non-p
-000034e0: 6172 616d 6574 7269 6320 7465 7374 2074  arametric test t
-000034f0: 6861 7420 636f 6d70 6172 6573 2074 6865  hat compares the
-00003500: 2063 756d 756c 6174 6976 6520 6469 7374   cumulative dist
-00003510: 7269 6275 7469 6f6e 2066 756e 6374 696f  ribution functio
-00003520: 6e73 2028 4543 4446 7329 206f 6620 7477  ns (ECDFs) of tw
-00003530: 6f20 696e 6465 7065 6e64 656e 7420 7361  o independent sa
-00003540: 6d70 6c65 7320 746f 2061 7373 6573 7320  mples to assess 
-00003550: 7768 6574 6865 7220 7468 6579 2063 6f6d  whether they com
-00003560: 6520 6672 6f6d 2074 6865 2073 616d 6520  e from the same 
-00003570: 6469 7374 7269 6275 7469 6f6e 2e0a 0a20  distribution... 
-00003580: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
-00003590: 2e6e 6461 7272 6179 2064 6174 613a 2054  .ndarray data: T
-000035a0: 6865 2066 6972 7374 2073 616d 706c 6520  he first sample 
-000035b0: 6172 7261 7920 666f 7220 7468 6520 4b53  array for the KS
-000035c0: 2074 6573 742e 0a20 2020 2020 2020 203a   test..        :
-000035d0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-000035e0: 2064 6174 613a 2054 6865 2073 6563 6f6e   data: The secon
-000035f0: 6420 7361 6d70 6c65 2061 7272 6179 2066  d sample array f
-00003600: 6f72 2074 6865 204b 5320 7465 7374 2e0a  or the KS test..
-00003610: 2020 2020 2020 2020 3a70 6172 616d 204f          :param O
-00003620: 7074 696f 6e61 6c5b 626f 6f6c 5d20 7469  ptional[bool] ti
-00003630: 6d65 5f77 696e 646f 7773 3a20 416e 2061  me_windows: An a
-00003640: 7272 6179 206f 6620 6372 6974 6963 616c  rray of critical
-00003650: 2076 616c 7565 7320 666f 7220 7468 6520   values for the 
-00003660: 4b53 2074 6573 742e 2049 6620 7072 6f76  KS test. If prov
-00003670: 6964 6564 2c20 7468 6520 6675 6e63 7469  ided, the functi
-00003680: 6f6e 2077 696c 6c20 616c 736f 2063 6865  on will also che
-00003690: 636b 2074 6865 2073 6967 6e69 6669 6361  ck the significa
-000036a0: 6e63 6520 6f66 2074 6865 204b 5320 7374  nce of the KS st
-000036b0: 6174 6973 7469 6320 6167 6169 6e73 7420  atistic against 
-000036c0: 7468 6520 6372 6974 6963 616c 2076 616c  the critical val
-000036d0: 7565 732e 2044 6566 6175 6c74 3a20 4e6f  ues. Default: No
-000036e0: 6e65 2e0a 2020 2020 2020 2020 3a72 6574  ne..        :ret
-000036f0: 7572 6e73 2028 666c 6f61 7420 556e 696f  urns (float Unio
-00003700: 6e5b 626f 6f6c 2c20 4e6f 6e65 5d29 3a20  n[bool, None]): 
-00003710: 5265 7475 726e 7320 6120 7475 706c 6520  Returns a tuple 
-00003720: 636f 6e74 6169 6e69 6e67 2074 6865 204b  containing the K
-00003730: 5320 7374 6174 6973 7469 6320 616e 6420  S statistic and 
-00003740: 6120 626f 6f6c 6561 6e20 696e 6469 6361  a boolean indica
-00003750: 7469 6e67 2077 6865 7468 6572 2074 6865  ting whether the
-00003760: 2074 6573 7420 6973 2073 7461 7469 7374   test is statist
-00003770: 6963 616c 6c79 2073 6967 6e69 6669 6361  ically significa
-00003780: 6e74 2e0a 0a20 2020 2020 2020 203a 6578  nt...        :ex
-00003790: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-000037a0: 3e3e 2073 616d 706c 655f 3120 3d20 6e70  >> sample_1 = np
-000037b0: 2e61 7272 6179 285b 312c 2032 2c20 332c  .array([1, 2, 3,
-000037c0: 2031 2c20 332c 2032 2c20 312c 2031 302c   1, 3, 2, 1, 10,
-000037d0: 2038 2c20 342c 2031 305d 292e 6173 7479   8, 4, 10]).asty
-000037e0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-000037f0: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-00003800: 655f 3220 3d20 6e70 2e61 7272 6179 285b  e_2 = np.array([
-00003810: 3130 2c20 352c 2031 302c 2034 2c20 382c  10, 5, 10, 4, 8,
-00003820: 2031 302c 2037 2c20 3130 2c20 372c 2031   10, 7, 10, 7, 1
-00003830: 302c 2031 305d 292e 6173 7479 7065 286e  0, 10]).astype(n
-00003840: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-00003850: 2020 203e 3e3e 2063 7269 7469 6361 6c5f     >>> critical_
-00003860: 7661 6c75 6573 203d 2070 6963 6b6c 652e  values = pickle.
-00003870: 6c6f 6164 286f 7065 6e28 2273 696d 6261  load(open("simba
-00003880: 2f61 7373 6574 732f 6c6f 6f6b 7570 732f  /assets/lookups/
-00003890: 6372 6974 6963 616c 5f76 616c 7565 735f  critical_values_
-000038a0: 352e 7069 636b 6c65 222c 2022 7262 2229  5.pickle", "rb")
-000038b0: 295b 2774 776f 5f73 616d 706c 655f 4b53  )['two_sample_KS
-000038c0: 275d 5b27 6f6e 655f 7461 696c 275d 2e76  ']['one_tail'].v
-000038d0: 616c 7565 730a 2020 2020 2020 2020 3e3e  alues.        >>
-000038e0: 3e20 7477 6f5f 7361 6d70 6c65 5f6b 7328  > two_sample_ks(
-000038f0: 7361 6d70 6c65 5f31 3d73 616d 706c 655f  sample_1=sample_
-00003900: 312c 2073 616d 706c 655f 323d 7361 6d70  1, sample_2=samp
-00003910: 6c65 5f32 2c20 6372 6974 6963 616c 5f76  le_2, critical_v
-00003920: 616c 7565 733d 6372 6974 6963 616c 5f76  alues=critical_v
-00003930: 616c 7565 7329 0a20 2020 2020 2020 203e  alues).        >
-00003940: 3e3e 2028 302e 3732 3732 3732 3732 3732  >> (0.7272727272
-00003950: 3732 3732 3733 2c20 5472 7565 290a 2020  727273, True).  
-00003960: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00003970: 2020 7369 676e 6966 6963 616e 6365 5f62    significance_b
-00003980: 6f6f 6c20 3d20 4e6f 6e65 0a20 2020 2020  ool = None.     
-00003990: 2020 2063 6f6d 6269 6e65 645f 7361 6d70     combined_samp
-000039a0: 6c65 7320 3d20 6e70 2e73 6f72 7428 6e70  les = np.sort(np
-000039b0: 2e63 6f6e 6361 7465 6e61 7465 2828 7361  .concatenate((sa
-000039c0: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
-000039d0: 2929 290a 2020 2020 2020 2020 6563 6466  ))).        ecdf
-000039e0: 5f73 616d 706c 655f 3120 3d20 6e70 2e73  _sample_1 = np.s
-000039f0: 6561 7263 6873 6f72 7465 6428 7361 6d70  earchsorted(samp
-00003a00: 6c65 5f31 2c20 636f 6d62 696e 6564 5f73  le_1, combined_s
-00003a10: 616d 706c 6573 2c20 7369 6465 3d22 7269  amples, side="ri
-00003a20: 6768 7422 2920 2f20 6c65 6e28 0a20 2020  ght") / len(.   
-00003a30: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00003a40: 310a 2020 2020 2020 2020 290a 2020 2020  1.        ).    
-00003a50: 2020 2020 6563 6466 5f73 616d 706c 655f      ecdf_sample_
-00003a60: 3220 3d20 6e70 2e73 6561 7263 6873 6f72  2 = np.searchsor
-00003a70: 7465 6428 7361 6d70 6c65 5f32 2c20 636f  ted(sample_2, co
-00003a80: 6d62 696e 6564 5f73 616d 706c 6573 2c20  mbined_samples, 
-00003a90: 7369 6465 3d22 7269 6768 7422 2920 2f20  side="right") / 
-00003aa0: 6c65 6e28 0a20 2020 2020 2020 2020 2020  len(.           
-00003ab0: 2073 616d 706c 655f 320a 2020 2020 2020   sample_2.      
-00003ac0: 2020 290a 2020 2020 2020 2020 6b73 203d    ).        ks =
-00003ad0: 206e 702e 6d61 7828 6e70 2e61 6273 2865   np.max(np.abs(e
-00003ae0: 6364 665f 7361 6d70 6c65 5f31 202d 2065  cdf_sample_1 - e
-00003af0: 6364 665f 7361 6d70 6c65 5f32 2929 0a20  cdf_sample_2)). 
-00003b00: 2020 2020 2020 2069 6620 6372 6974 6963         if critic
-00003b10: 616c 5f76 616c 7565 7320 6973 206e 6f74  al_values is not
-00003b20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00003b30: 2020 2063 6f6d 6269 6e65 645f 7361 6d70     combined_samp
-00003b40: 6c65 5f73 697a 6520 3d20 6c65 6e28 7361  le_size = len(sa
-00003b50: 6d70 6c65 5f31 2920 2b20 6c65 6e28 7361  mple_1) + len(sa
-00003b60: 6d70 6c65 5f32 290a 2020 2020 2020 2020  mple_2).        
-00003b70: 2020 2020 6372 6974 6963 616c 5f76 616c      critical_val
-00003b80: 7565 203d 206e 702e 696e 7465 7270 280a  ue = np.interp(.
-00003b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ba0: 636f 6d62 696e 6564 5f73 616d 706c 655f  combined_sample_
-00003bb0: 7369 7a65 2c20 6372 6974 6963 616c 5f76  size, critical_v
-00003bc0: 616c 7565 735b 3a2c 2030 5d2c 2063 7269  alues[:, 0], cri
-00003bd0: 7469 6361 6c5f 7661 6c75 6573 5b3a 2c20  tical_values[:, 
-00003be0: 315d 0a20 2020 2020 2020 2020 2020 2029  1].            )
-00003bf0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00003c00: 6372 6974 6963 616c 5f76 616c 7565 203c  critical_value <
-00003c10: 2061 6273 286b 7329 3a0a 2020 2020 2020   abs(ks):.      
-00003c20: 2020 2020 2020 2020 2020 7369 676e 6966            signif
-00003c30: 6963 616e 6365 5f62 6f6f 6c20 3d20 5472  icance_bool = Tr
-00003c40: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
-00003c50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00003c60: 2020 2020 2073 6967 6e69 6669 6361 6e63       significanc
-00003c70: 655f 626f 6f6c 203d 2046 616c 7365 0a20  e_bool = False. 
-00003c80: 2020 2020 2020 2072 6574 7572 6e20 286b         return (k
-00003c90: 732c 2073 6967 6e69 6669 6361 6e63 655f  s, significance_
-00003ca0: 626f 6f6c 290a 0a20 2020 2040 7374 6174  bool)..    @stat
-00003cb0: 6963 6d65 7468 6f64 0a20 2020 2040 6a69  icmethod.    @ji
-00003cc0: 7428 6e6f 7079 7468 6f6e 3d54 7275 6529  t(nopython=True)
-00003cd0: 0a20 2020 2064 6566 206f 6e65 5f77 6179  .    def one_way
-00003ce0: 5f61 6e6f 7661 280a 2020 2020 2020 2020  _anova(.        
-00003cf0: 7361 6d70 6c65 5f31 3a20 6e70 2e6e 6461  sample_1: np.nda
-00003d00: 7272 6179 2c0a 2020 2020 2020 2020 7361  rray,.        sa
-00003d10: 6d70 6c65 5f32 3a20 6e70 2e6e 6461 7272  mple_2: np.ndarr
-00003d20: 6179 2c0a 2020 2020 2020 2020 6372 6974  ay,.        crit
-00003d30: 6963 616c 5f76 616c 7565 733a 204f 7074  ical_values: Opt
-00003d40: 696f 6e61 6c5b 6e70 2e6e 6461 7272 6179  ional[np.ndarray
-00003d50: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-00003d60: 2d3e 2028 666c 6f61 742c 2066 6c6f 6174  -> (float, float
-00003d70: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00003d80: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
-00003d90: 6d70 7574 6520 6f66 206f 6e65 2d77 6179  mpute of one-way
-00003da0: 2041 4e4f 5641 2046 2073 7461 7469 7374   ANOVA F statist
-00003db0: 6963 7320 616e 6420 6173 736f 6369 6174  ics and associat
-00003dc0: 6564 2070 2d76 616c 7565 2066 6f72 2074  ed p-value for t
-00003dd0: 776f 2064 6973 7472 6962 7574 696f 6e73  wo distributions
-00003de0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00003df0: 6d65 7465 7220 6e64 6172 7261 7920 7361  meter ndarray sa
-00003e00: 6d70 6c65 5f31 3a20 4669 7273 7420 3164  mple_1: First 1d
-00003e10: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
-00003e20: 696e 6720 6665 6174 7572 6520 7661 6c75  ing feature valu
-00003e30: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
-00003e40: 616d 6574 6572 206e 6461 7272 6179 2073  ameter ndarray s
-00003e50: 616d 706c 655f 323a 2053 6563 6f6e 6420  ample_2: Second 
-00003e60: 3164 2061 7272 6179 2072 6570 7265 7365  1d array represe
-00003e70: 6e74 696e 6720 6665 6174 7572 6520 7661  nting feature va
-00003e80: 6c75 6573 2e0a 2020 2020 2020 2020 3a72  lues..        :r
-00003e90: 6574 7572 6e73 2028 666c 6f61 7420 666c  eturns (float fl
-00003ea0: 6f61 7429 3a20 5265 7072 6573 656e 7469  oat): Representi
-00003eb0: 6e67 2041 4e4f 5641 2046 2073 7461 7469  ng ANOVA F stati
-00003ec0: 7374 6963 2061 6e64 2061 7373 6f63 6961  stic and associa
-00003ed0: 7465 6420 7072 6f62 6162 696c 6974 7920  ted probability 
-00003ee0: 7661 6c75 652e 0a0a 2020 2020 2020 2020  value...        
-00003ef0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-00003f00: 2020 3e3e 3e20 7361 6d70 6c65 5f31 203d    >>> sample_1 =
-00003f10: 206e 702e 6172 7261 7928 5b31 2c20 322c   np.array([1, 2,
-00003f20: 2033 2c20 312c 2033 2c20 322c 2031 2c20   3, 1, 3, 2, 1, 
-00003f30: 3130 2c20 382c 2034 2c20 3130 5d29 0a20  10, 8, 4, 10]). 
-00003f40: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-00003f50: 655f 3220 3d20 6e70 2e61 7272 6179 285b  e_2 = np.array([
-00003f60: 382c 2035 2c20 352c 2038 2c20 382c 2039  8, 5, 5, 8, 8, 9
-00003f70: 2c20 3130 2c20 312c 2037 2c20 3130 2c20  , 10, 1, 7, 10, 
-00003f80: 3130 5d29 0a20 2020 2020 2020 203e 3e3e  10]).        >>>
-00003f90: 2053 7461 7469 7374 6963 7328 292e 6f6e   Statistics().on
-00003fa0: 655f 7761 795f 616e 6f76 6128 7361 6d70  e_way_anova(samp
-00003fb0: 6c65 5f31 3d73 616d 706c 655f 322c 2073  le_1=sample_2, s
-00003fc0: 616d 706c 655f 323d 7361 6d70 6c65 5f31  ample_2=sample_1
-00003fd0: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
-00003fe0: 2020 2020 2020 2073 6967 6e69 6669 6361         significa
-00003ff0: 6e63 655f 626f 6f6c 203d 204e 6f6e 650a  nce_bool = None.
-00004000: 2020 2020 2020 2020 6e31 2c20 6e32 203d          n1, n2 =
-00004010: 206c 656e 2873 616d 706c 655f 3129 2c20   len(sample_1), 
-00004020: 6c65 6e28 7361 6d70 6c65 5f32 290a 2020  len(sample_2).  
-00004030: 2020 2020 2020 6d31 2c20 6d32 203d 206e        m1, m2 = n
-00004040: 702e 6d65 616e 2873 616d 706c 655f 3129  p.mean(sample_1)
-00004050: 2c20 6e70 2e6d 6561 6e28 7361 6d70 6c65  , np.mean(sample
-00004060: 5f32 290a 2020 2020 2020 2020 7373 5f62  _2).        ss_b
-00004070: 6574 7765 656e 203d 2028 0a20 2020 2020  etween = (.     
-00004080: 2020 2020 2020 206e 3120 2a20 286d 3120         n1 * (m1 
-00004090: 2d20 6e70 2e6d 6561 6e28 6e70 2e63 6f6e  - np.mean(np.con
-000040a0: 6361 7465 6e61 7465 2828 7361 6d70 6c65  catenate((sample
-000040b0: 5f31 2c20 7361 6d70 6c65 5f32 2929 2929  _1, sample_2))))
-000040c0: 202a 2a20 320a 2020 2020 2020 2020 2020   ** 2.          
-000040d0: 2020 2b20 6e32 202a 2028 6d32 202d 206e    + n2 * (m2 - n
-000040e0: 702e 6d65 616e 286e 702e 636f 6e63 6174  p.mean(np.concat
-000040f0: 656e 6174 6528 2873 616d 706c 655f 312c  enate((sample_1,
-00004100: 2073 616d 706c 655f 3229 2929 2920 2a2a   sample_2)))) **
-00004110: 2032 0a20 2020 2020 2020 2029 0a20 2020   2.        ).   
-00004120: 2020 2020 2073 735f 7769 7468 696e 203d       ss_within =
-00004130: 206e 702e 7375 6d28 2873 616d 706c 655f   np.sum((sample_
-00004140: 3120 2d20 6d31 2920 2a2a 2032 2920 2b20  1 - m1) ** 2) + 
-00004150: 6e70 2e73 756d 2828 7361 6d70 6c65 5f32  np.sum((sample_2
-00004160: 202d 206d 3229 202a 2a20 3229 0a20 2020   - m2) ** 2).   
-00004170: 2020 2020 2064 665f 6265 7477 6565 6e2c       df_between,
-00004180: 2064 665f 7769 7468 696e 203d 2031 2c20   df_within = 1, 
-00004190: 6e31 202b 206e 3220 2d20 320a 2020 2020  n1 + n2 - 2.    
-000041a0: 2020 2020 6d73 5f62 6574 7765 656e 2c20      ms_between, 
-000041b0: 6d73 5f77 6974 6869 6e20 3d20 7373 5f62  ms_within = ss_b
-000041c0: 6574 7765 656e 202f 2064 665f 6265 7477  etween / df_betw
-000041d0: 6565 6e2c 2073 735f 7769 7468 696e 202f  een, ss_within /
-000041e0: 2064 665f 7769 7468 696e 0a20 2020 2020   df_within.     
-000041f0: 2020 2066 203d 206d 735f 6265 7477 6565     f = ms_betwee
-00004200: 6e20 2f20 6d73 5f77 6974 6869 6e0a 2020  n / ms_within.  
-00004210: 2020 2020 2020 6966 2063 7269 7469 6361        if critica
-00004220: 6c5f 7661 6c75 6573 2069 7320 6e6f 7420  l_values is not 
-00004230: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00004240: 2020 6372 6974 6963 616c 5f76 616c 7565    critical_value
-00004250: 7320 3d20 6372 6974 6963 616c 5f76 616c  s = critical_val
-00004260: 7565 735b 3a2c 206e 702e 6172 7261 7928  ues[:, np.array(
-00004270: 5b30 2c20 6466 5f62 6574 7765 656e 5d29  [0, df_between])
-00004280: 5d0a 2020 2020 2020 2020 2020 2020 6372  ].            cr
-00004290: 6974 6963 616c 5f76 616c 7565 203d 206e  itical_value = n
-000042a0: 702e 696e 7465 7270 280a 2020 2020 2020  p.interp(.      
-000042b0: 2020 2020 2020 2020 2020 6466 5f77 6974            df_wit
-000042c0: 6869 6e2c 2063 7269 7469 6361 6c5f 7661  hin, critical_va
-000042d0: 6c75 6573 5b3a 2c20 305d 2c20 6372 6974  lues[:, 0], crit
-000042e0: 6963 616c 5f76 616c 7565 735b 3a2c 2031  ical_values[:, 1
-000042f0: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
-00004300: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-00004310: 203e 2063 7269 7469 6361 6c5f 7661 6c75   > critical_valu
-00004320: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00004330: 2020 2073 6967 6e69 6669 6361 6e63 655f     significance_
-00004340: 626f 6f6c 203d 2054 7275 650a 2020 2020  bool = True.    
-00004350: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00004360: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00004370: 676e 6966 6963 616e 6365 5f62 6f6f 6c20  gnificance_bool 
-00004380: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-00004390: 2072 6574 7572 6e20 2866 2c20 7369 676e   return (f, sign
-000043a0: 6966 6963 616e 6365 5f62 6f6f 6c29 0a0a  ificance_bool)..
-000043b0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-000043c0: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
-000043d0: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
-000043e0: 345b 3a5d 2c20 666c 6f61 7436 3429 222c  4[:], float64)",
-000043f0: 2063 6163 6865 3d54 7275 6529 0a20 2020   cache=True).   
-00004400: 2064 6566 2072 6f6c 6c69 6e67 5f6f 6e65   def rolling_one
-00004410: 5f77 6179 5f61 6e6f 7661 280a 2020 2020  _way_anova(.    
-00004420: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
-00004430: 7272 6179 2c20 7469 6d65 5f77 696e 646f  rray, time_windo
-00004440: 7773 3a20 6e70 2e6e 6461 7272 6179 2c20  ws: np.ndarray, 
-00004450: 6670 733a 2069 6e74 0a20 2020 2029 202d  fps: int.    ) -
-00004460: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
-00004470: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004480: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
-00004490: 206f 6620 726f 6c6c 696e 6720 6f6e 652d   of rolling one-
-000044a0: 7761 7920 414e 4f56 4120 462d 7374 6174  way ANOVA F-stat
-000044b0: 6973 7469 6320 636f 6d70 6172 696e 6720  istic comparing 
-000044c0: 7468 6520 6375 7272 656e 7420 7469 6d65  the current time
-000044d0: 2d77 696e 646f 7720 6f66 0a20 2020 2020  -window of.     
-000044e0: 2020 2073 697a 6520 4e20 746f 2074 6865     size N to the
-000044f0: 2070 7265 6365 6469 6e67 2077 696e 646f   preceding windo
-00004500: 7720 6f66 2073 697a 6520 4e2e 0a0a 2020  w of size N...  
-00004510: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-00004520: 206e 6461 7272 6179 2064 6174 613a 2031   ndarray data: 1
-00004530: 4420 6172 7261 7920 6f66 2073 697a 6520  D array of size 
-00004540: 6c65 6e28 6672 616d 6573 2920 7265 7072  len(frames) repr
-00004550: 6573 656e 7469 6e67 2066 6561 7475 7265  esenting feature
-00004560: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
-00004570: 203a 7061 7261 6d65 7465 7220 6e70 2e6e   :parameter np.n
-00004580: 6461 7272 6179 5b69 6e74 735d 2074 696d  darray[ints] tim
-00004590: 655f 7769 6e64 6f77 733a 2054 696d 6520  e_windows: Time 
-000045a0: 7769 6e64 6f77 7320 746f 2063 6f6d 7075  windows to compu
-000045b0: 7465 2041 4e4f 5641 7320 666f 7220 696e  te ANOVAs for in
-000045c0: 2073 6563 6f6e 6473 2e0a 2020 2020 2020   seconds..      
-000045d0: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
-000045e0: 2066 7073 3a20 4672 616d 652d 7261 7465   fps: Frame-rate
-000045f0: 206f 6620 7265 636f 7264 6564 2076 6964   of recorded vid
-00004600: 656f 2e0a 0a20 2020 2020 2020 202e 2e20  eo...        .. 
-00004610: 696d 6167 653a 3a20 5f73 7461 7469 632f  image:: _static/
-00004620: 696d 672f 726f 6c6c 696e 675f 616e 6f76  img/rolling_anov
-00004630: 612e 706e 670a 2020 2020 2020 2020 2020  a.png.          
-00004640: 203a 7769 6474 683a 2036 3030 0a20 2020   :width: 600.   
-00004650: 2020 2020 2020 2020 3a61 6c69 676e 3a20          :align: 
-00004660: 6365 6e74 6572 0a0a 2020 2020 2020 2020  center..        
-00004670: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-00004680: 2020 3e3e 3e20 7361 6d70 6c65 203d 206e    >>> sample = n
-00004690: 702e 7261 6e64 6f6d 2e6e 6f72 6d61 6c28  p.random.normal(
-000046a0: 6c6f 633d 3130 2c20 7363 616c 653d 312c  loc=10, scale=1,
-000046b0: 2073 697a 653d 3130 292e 6173 7479 7065   size=10).astype
-000046c0: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
-000046d0: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-000046e0: 6963 7328 292e 726f 6c6c 696e 675f 6f6e  ics().rolling_on
-000046f0: 655f 7761 795f 616e 6f76 6128 6461 7461  e_way_anova(data
-00004700: 3d73 616d 706c 652c 2074 696d 655f 7769  =sample, time_wi
-00004710: 6e64 6f77 733d 6e70 2e61 7272 6179 285b  ndows=np.array([
-00004720: 312e 305d 292c 2066 7073 3d32 290a 2020  1.0]), fps=2).  
-00004730: 2020 2020 2020 3e3e 3e20 5b5b 302e 3030        >>> [[0.00
-00004740: 3030 3030 3030 652b 3030 5d5b 302e 3030  000000e+00][0.00
-00004750: 3030 3030 3030 652b 3030 5d5b 322e 3236  000000e+00][2.26
-00004760: 3232 3132 3633 652d 3036 5d5b 322e 3236  221263e-06][2.26
-00004770: 3232 3132 3633 652d 3036 5d5b 352e 3339  221263e-06][5.39
-00004780: 3131 3939 3530 652d 3033 5d5b 352e 3339  119950e-03][5.39
-00004790: 3131 3939 3530 652d 3033 5d5b 312e 3436  119950e-03][1.46
-000047a0: 3732 3534 3836 652d 3033 5d5b 312e 3436  725486e-03][1.46
-000047b0: 3732 3534 3836 652d 3033 5d5b 312e 3136  725486e-03][1.16
-000047c0: 3339 3231 3131 652d 3032 5d5b 312e 3136  392111e-02][1.16
-000047d0: 3339 3231 3131 652d 3032 5d5d 0a20 2020  392111e-02]].   
-000047e0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-000047f0: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
-00004800: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
-00004810: 305d 2c20 7469 6d65 5f77 696e 646f 7773  0], time_windows
-00004820: 2e73 6861 7065 5b30 5d29 2c20 302e 3029  .shape[0]), 0.0)
-00004830: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00004840: 6e20 7072 616e 6765 2874 696d 655f 7769  n prange(time_wi
-00004850: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
-00004860: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00004870: 646f 775f 7369 7a65 203d 2069 6e74 2874  dow_size = int(t
-00004880: 696d 655f 7769 6e64 6f77 735b 695d 202a  ime_windows[i] *
-00004890: 2066 7073 290a 2020 2020 2020 2020 2020   fps).          
-000048a0: 2020 6461 7461 5f73 706c 6974 203d 206e    data_split = n
-000048b0: 702e 7370 6c69 7428 0a20 2020 2020 2020  p.split(.       
-000048c0: 2020 2020 2020 2020 2064 6174 612c 206c           data, l
-000048d0: 6973 7428 7261 6e67 6528 7769 6e64 6f77  ist(range(window
-000048e0: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
-000048f0: 655b 305d 2c20 7769 6e64 6f77 5f73 697a  e[0], window_siz
-00004900: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-00004910: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-00004920: 7220 6a20 696e 2070 7261 6e67 6528 312c  r j in prange(1,
-00004930: 206c 656e 2864 6174 615f 7370 6c69 7429   len(data_split)
-00004940: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00004950: 2020 2077 696e 646f 775f 7374 6172 7420     window_start 
-00004960: 3d20 696e 7428 7769 6e64 6f77 5f73 697a  = int(window_siz
-00004970: 6520 2a20 6a29 0a20 2020 2020 2020 2020  e * j).         
-00004980: 2020 2020 2020 2077 696e 646f 775f 656e         window_en
-00004990: 6420 3d20 696e 7428 7769 6e64 6f77 5f73  d = int(window_s
-000049a0: 7461 7274 202b 2077 696e 646f 775f 7369  tart + window_si
-000049b0: 7a65 290a 2020 2020 2020 2020 2020 2020  ze).            
-000049c0: 2020 2020 7361 6d70 6c65 5f31 2c20 7361      sample_1, sa
-000049d0: 6d70 6c65 5f32 203d 2064 6174 615f 7370  mple_2 = data_sp
-000049e0: 6c69 745b 6a20 2d20 315d 2e61 7374 7970  lit[j - 1].astyp
-000049f0: 6528 6e70 2e66 6c6f 6174 3332 292c 2064  e(np.float32), d
-00004a00: 6174 615f 7370 6c69 745b 0a20 2020 2020  ata_split[.     
-00004a10: 2020 2020 2020 2020 2020 2020 2020 206a                 j
-00004a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004a30: 205d 2e61 7374 7970 6528 6e70 2e66 6c6f   ].astype(np.flo
-00004a40: 6174 3332 290a 2020 2020 2020 2020 2020  at32).          
-00004a50: 2020 2020 2020 6e31 2c20 6e32 203d 206c        n1, n2 = l
-00004a60: 656e 2873 616d 706c 655f 3129 2c20 6c65  en(sample_1), le
-00004a70: 6e28 7361 6d70 6c65 5f32 290a 2020 2020  n(sample_2).    
-00004a80: 2020 2020 2020 2020 2020 2020 6d31 2c20              m1, 
-00004a90: 6d32 203d 206e 702e 6d65 616e 2873 616d  m2 = np.mean(sam
-00004aa0: 706c 655f 3129 2c20 6e70 2e6d 6561 6e28  ple_1), np.mean(
-00004ab0: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
-00004ac0: 2020 2020 2020 2020 2020 7373 5f62 6574            ss_bet
-00004ad0: 7765 656e 203d 2028 0a20 2020 2020 2020  ween = (.       
-00004ae0: 2020 2020 2020 2020 2020 2020 206e 3120               n1 
-00004af0: 2a20 286d 3120 2d20 6e70 2e6d 6561 6e28  * (m1 - np.mean(
-00004b00: 6e70 2e63 6f6e 6361 7465 6e61 7465 2828  np.concatenate((
-00004b10: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
-00004b20: 5f32 2929 2929 202a 2a20 320a 2020 2020  _2)))) ** 2.    
-00004b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004b40: 2b20 6e32 202a 2028 6d32 202d 206e 702e  + n2 * (m2 - np.
-00004b50: 6d65 616e 286e 702e 636f 6e63 6174 656e  mean(np.concaten
-00004b60: 6174 6528 2873 616d 706c 655f 312c 2073  ate((sample_1, s
-00004b70: 616d 706c 655f 3229 2929 2920 2a2a 2032  ample_2)))) ** 2
-00004b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004b90: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00004ba0: 2020 2073 735f 7769 7468 696e 203d 206e     ss_within = n
-00004bb0: 702e 7375 6d28 2873 616d 706c 655f 3120  p.sum((sample_1 
-00004bc0: 2d20 6d31 2920 2a2a 2032 2920 2b20 6e70  - m1) ** 2) + np
-00004bd0: 2e73 756d 2828 7361 6d70 6c65 5f32 202d  .sum((sample_2 -
-00004be0: 206d 3229 202a 2a20 3229 0a20 2020 2020   m2) ** 2).     
-00004bf0: 2020 2020 2020 2020 2020 2064 665f 6265             df_be
-00004c00: 7477 6565 6e2c 2064 665f 7769 7468 696e  tween, df_within
-00004c10: 203d 2031 2c20 6e31 202b 206e 3220 2d20   = 1, n1 + n2 - 
-00004c20: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-00004c30: 2020 6d73 5f62 6574 7765 656e 2c20 6d73    ms_between, ms
-00004c40: 5f77 6974 6869 6e20 3d20 7373 5f62 6574  _within = ss_bet
-00004c50: 7765 656e 202f 2064 665f 6265 7477 6565  ween / df_betwee
-00004c60: 6e2c 2073 735f 7769 7468 696e 202f 2064  n, ss_within / d
-00004c70: 665f 7769 7468 696e 0a20 2020 2020 2020  f_within.       
-00004c80: 2020 2020 2020 2020 2066 203d 206d 735f           f = ms_
-00004c90: 6265 7477 6565 6e20 2f20 6d73 5f77 6974  between / ms_wit
-00004ca0: 6869 6e0a 2020 2020 2020 2020 2020 2020  hin.            
-00004cb0: 2020 2020 7265 7375 6c74 735b 7769 6e64      results[wind
-00004cc0: 6f77 5f73 7461 7274 3a77 696e 646f 775f  ow_start:window_
-00004cd0: 656e 642c 2069 5d20 3d20 660a 0a20 2020  end, i] = f..   
-00004ce0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-00004cf0: 6c74 730a 0a20 2020 2064 6566 206b 756c  lts..    def kul
-00004d00: 6c62 6163 6b5f 6c65 6962 6c65 725f 6469  lback_leibler_di
-00004d10: 7665 7267 656e 6365 280a 2020 2020 2020  vergence(.      
-00004d20: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00004d30: 7361 6d70 6c65 5f31 3a20 6e70 2e6e 6461  sample_1: np.nda
-00004d40: 7272 6179 2c0a 2020 2020 2020 2020 7361  rray,.        sa
-00004d50: 6d70 6c65 5f32 3a20 6e70 2e6e 6461 7272  mple_2: np.ndarr
-00004d60: 6179 2c0a 2020 2020 2020 2020 6669 6c6c  ay,.        fill
-00004d70: 5f76 616c 7565 3a20 4f70 7469 6f6e 616c  _value: Optional
-00004d80: 5b69 6e74 5d20 3d20 312c 0a20 2020 2020  [int] = 1,.     
-00004d90: 2020 2062 7563 6b65 745f 6d65 7468 6f64     bucket_method
-00004da0: 3a20 4c69 7465 7261 6c5b 0a20 2020 2020  : Literal[.     
-00004db0: 2020 2020 2020 2022 6664 222c 2022 646f         "fd", "do
-00004dc0: 616e 6522 2c20 2261 7574 6f22 2c20 2273  ane", "auto", "s
-00004dd0: 636f 7474 222c 2022 7374 6f6e 6522 2c20  cott", "stone", 
-00004de0: 2272 6963 6522 2c20 2273 7475 7267 6573  "rice", "sturges
-00004df0: 222c 2022 7371 7274 220a 2020 2020 2020  ", "sqrt".      
-00004e00: 2020 5d20 3d20 2261 7574 6f22 2c0a 2020    ] = "auto",.  
-00004e10: 2020 2920 2d3e 2066 6c6f 6174 3a0a 2020    ) -> float:.  
-00004e20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004e30: 2020 436f 6d70 7574 6520 4b75 6c6c 6261    Compute Kullba
-00004e40: 636b 2d4c 6569 626c 6572 2064 6976 6572  ck-Leibler diver
-00004e50: 6765 6e63 6520 6265 7477 6565 6e20 7477  gence between tw
-00004e60: 6f20 6469 7374 7269 6275 7469 6f6e 732e  o distributions.
-00004e70: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
-00004e80: 653a 3a0a 2020 2020 2020 2020 2020 2045  e::.           E
-00004e90: 6d70 7479 2062 696e 7320 2830 206f 6273  mpty bins (0 obs
-00004ea0: 6572 7661 7469 6f6e 7320 696e 2062 696e  ervations in bin
-00004eb0: 2920 696e 2069 7320 7265 706c 6163 6564  ) in is replaced
-00004ec0: 2077 6974 6820 7061 7373 6564 2060 6066   with passed ``f
-00004ed0: 696c 6c5f 7661 6c75 6560 602e 0a0a 2020  ill_value``...  
-00004ee0: 2020 2020 2020 2020 2049 7473 2072 616e           Its ran
-00004ef0: 6765 2069 7320 6672 6f6d 2030 2074 6f20  ge is from 0 to 
-00004f00: 706f 7369 7469 7665 2069 6e66 696e 6974  positive infinit
-00004f10: 792e 2057 6865 6e20 7468 6520 4b4c 2064  y. When the KL d
-00004f20: 6976 6572 6765 6e63 6520 6973 207a 6572  ivergence is zer
-00004f30: 6f2c 2069 7420 696e 6469 6361 7465 7320  o, it indicates 
-00004f40: 7468 6174 2074 6865 2074 776f 2064 6973  that the two dis
-00004f50: 7472 6962 7574 696f 6e73 2061 7265 2069  tributions are i
-00004f60: 6465 6e74 6963 616c 2e20 4173 2074 6865  dentical. As the
-00004f70: 204b 4c20 6469 7665 7267 656e 6365 2069   KL divergence i
-00004f80: 6e63 7265 6173 6573 2c20 6974 2073 6967  ncreases, it sig
-00004f90: 6e69 6669 6573 2061 6e20 696e 6372 6561  nifies an increa
-00004fa0: 7369 6e67 2064 6966 6665 7265 6e63 6520  sing difference 
-00004fb0: 6265 7477 6565 6e20 7468 6520 6469 7374  between the dist
-00004fc0: 7269 6275 7469 6f6e 732e 0a0a 2020 2020  ributions...    
-00004fd0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-00004fe0: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
-00004ff0: 2046 6972 7374 2031 6420 6172 7261 7920   First 1d array 
-00005000: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
-00005010: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
-00005020: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-00005030: 6e64 6172 7261 7920 7361 6d70 6c65 5f32  ndarray sample_2
-00005040: 3a20 5365 636f 6e64 2031 6420 6172 7261  : Second 1d arra
-00005050: 7920 7265 7072 6573 656e 7469 6e67 2066  y representing f
-00005060: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
-00005070: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-00005080: 7220 4f70 7469 6f6e 616c 5b69 6e74 5d20  r Optional[int] 
-00005090: 6669 6c6c 5f76 616c 7565 3a20 4f70 7469  fill_value: Opti
-000050a0: 6f6e 616c 2070 7365 7564 6f2d 7661 6c75  onal pseudo-valu
-000050b0: 6520 746f 2075 7365 2074 6f20 6669 6c6c  e to use to fill
-000050c0: 2065 6d70 7479 2062 7563 6b65 7473 2069   empty buckets i
-000050d0: 6e20 6060 7361 6d70 6c65 5f32 6060 2068  n ``sample_2`` h
-000050e0: 6973 746f 6772 616d 0a20 2020 2020 2020  istogram.       
-000050f0: 203a 7061 7261 6d65 7465 7220 4c69 7465   :parameter Lite
-00005100: 7261 6c20 6275 636b 6574 5f6d 6574 686f  ral bucket_metho
-00005110: 643a 2045 7374 696d 6174 6f72 2064 6574  d: Estimator det
-00005120: 6572 6d69 6e69 6e67 206f 7074 696d 616c  ermining optimal
-00005130: 2062 7563 6b65 7420 636f 756e 7420 616e   bucket count an
-00005140: 6420 6275 636b 6574 2077 6964 7468 2e20  d bucket width. 
-00005150: 4465 6661 756c 743a 2054 6865 206d 6178  Default: The max
-00005160: 696d 756d 206f 6620 7468 6520 5374 7572  imum of the Stur
-00005170: 6765 7320 616e 6420 4672 6565 646d 616e  ges and Freedman
-00005180: 2d44 6961 636f 6e69 7320 6573 7469 6d61  -Diaconis estima
-00005190: 746f 7273 0a20 2020 2020 2020 203a 7265  tors.        :re
-000051a0: 7475 726e 7320 666c 6f61 743a 204b 756c  turns float: Kul
-000051b0: 6c62 6163 6b2d 4c65 6962 6c65 7220 6469  lback-Leibler di
-000051c0: 7665 7267 656e 6365 2062 6574 7765 656e  vergence between
-000051d0: 2060 6073 616d 706c 655f 3160 6020 616e   ``sample_1`` an
-000051e0: 6420 6060 7361 6d70 6c65 5f32 6060 0a20  d ``sample_2``. 
-000051f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00005200: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-00005210: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00005220: 2020 6461 7461 3d73 616d 706c 655f 312c    data=sample_1,
-00005230: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00005240: 7263 653d 5374 6174 6973 7469 6373 2e6a  rce=Statistics.j
-00005250: 656e 7365 6e5f 7368 616e 6e6f 6e5f 6469  ensen_shannon_di
-00005260: 7665 7267 656e 6365 2e5f 5f6e 616d 655f  vergence.__name_
-00005270: 5f2c 0a20 2020 2020 2020 2020 2020 2061  _,.            a
-00005280: 6363 6570 7465 645f 6e64 696d 733d 2831  ccepted_ndims=(1
-00005290: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
-000052a0: 6163 6365 7074 6564 5f64 7479 7065 733d  accepted_dtypes=
-000052b0: 286e 702e 666c 6f61 7433 322c 206e 702e  (np.float32, np.
-000052c0: 666c 6f61 7436 342c 206e 702e 696e 7433  float64, np.int3
-000052d0: 322c 206e 702e 696e 7436 342c 2069 6e74  2, np.int64, int
-000052e0: 2c20 666c 6f61 7429 2c0a 2020 2020 2020  , float),.      
-000052f0: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
-00005300: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-00005310: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00005320: 7361 6d70 6c65 5f32 2c0a 2020 2020 2020  sample_2,.      
-00005330: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-00005340: 7469 7374 6963 732e 6a65 6e73 656e 5f73  tistics.jensen_s
-00005350: 6861 6e6e 6f6e 5f64 6976 6572 6765 6e63  hannon_divergenc
-00005360: 652e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  e.__name__,.    
-00005370: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00005380: 5f6e 6469 6d73 3d28 312c 292c 0a20 2020  _ndims=(1,),.   
-00005390: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-000053a0: 645f 6474 7970 6573 3d28 6e70 2e66 6c6f  d_dtypes=(np.flo
-000053b0: 6174 3332 2c20 6e70 2e66 6c6f 6174 3634  at32, np.float64
-000053c0: 2c20 6e70 2e69 6e74 3332 2c20 6e70 2e69  , np.int32, np.i
-000053d0: 6e74 3634 2c20 696e 742c 2066 6c6f 6174  nt64, int, float
-000053e0: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
-000053f0: 2020 2020 2063 6865 636b 5f73 7472 280a       check_str(.
-00005400: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00005410: 3d66 227b 7365 6c66 2e5f 5f63 6c61 7373  =f"{self.__class
-00005420: 5f5f 2e5f 5f6e 616d 655f 5f7d 2062 7563  __.__name__} buc
-00005430: 6b65 745f 6d65 7468 6f64 222c 0a20 2020  ket_method",.   
-00005440: 2020 2020 2020 2020 2076 616c 7565 3d62           value=b
-00005450: 7563 6b65 745f 6d65 7468 6f64 2c0a 2020  ucket_method,.  
-00005460: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00005470: 733d 4f70 7469 6f6e 732e 4255 434b 4554  s=Options.BUCKET
-00005480: 5f4d 4554 484f 4453 2e76 616c 7565 2c0a  _METHODS.value,.
-00005490: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000054a0: 2020 6368 6563 6b5f 696e 7428 0a20 2020    check_int(.   
-000054b0: 2020 2020 2020 2020 206e 616d 653d 6622           name=f"
-000054c0: 7b73 656c 662e 5f5f 636c 6173 735f 5f2e  {self.__class__.
-000054d0: 5f5f 6e61 6d65 5f5f 7d20 6669 6c6c 2076  __name__} fill v
-000054e0: 616c 7565 222c 2076 616c 7565 3d66 696c  alue", value=fil
-000054f0: 6c5f 7661 6c75 652c 206d 696e 5f76 616c  l_value, min_val
-00005500: 7565 3d31 0a20 2020 2020 2020 2029 0a20  ue=1.        ). 
-00005510: 2020 2020 2020 2062 696e 5f77 6964 7468         bin_width
-00005520: 2c20 6269 6e5f 636f 756e 7420 3d20 6275  , bin_count = bu
-00005530: 636b 6574 5f64 6174 6128 6461 7461 3d73  cket_data(data=s
-00005540: 616d 706c 655f 312c 206d 6574 686f 643d  ample_1, method=
-00005550: 6275 636b 6574 5f6d 6574 686f 6429 0a20  bucket_method). 
-00005560: 2020 2020 2020 2073 616d 706c 655f 315f         sample_1_
-00005570: 6869 7374 203d 2073 656c 662e 5f68 6973  hist = self._his
-00005580: 745f 3164 280a 2020 2020 2020 2020 2020  t_1d(.          
-00005590: 2020 6461 7461 3d73 616d 706c 655f 312c    data=sample_1,
-000055a0: 0a20 2020 2020 2020 2020 2020 2062 696e  .            bin
-000055b0: 5f63 6f75 6e74 3d62 696e 5f63 6f75 6e74  _count=bin_count
-000055c0: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
-000055d0: 6e67 653d 6e70 2e61 7272 6179 285b 302c  nge=np.array([0,
-000055e0: 2069 6e74 2862 696e 5f77 6964 7468 202a   int(bin_width *
-000055f0: 2062 696e 5f63 6f75 6e74 295d 292c 0a20   bin_count)]),. 
-00005600: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00005610: 2073 616d 706c 655f 325f 6869 7374 203d   sample_2_hist =
-00005620: 2073 656c 662e 5f68 6973 745f 3164 280a   self._hist_1d(.
-00005630: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00005640: 3d73 616d 706c 655f 322c 0a20 2020 2020  =sample_2,.     
-00005650: 2020 2020 2020 2062 696e 5f63 6f75 6e74         bin_count
-00005660: 3d62 696e 5f63 6f75 6e74 2c0a 2020 2020  =bin_count,.    
-00005670: 2020 2020 2020 2020 7261 6e67 653d 6e70          range=np
-00005680: 2e61 7272 6179 285b 302c 2069 6e74 2862  .array([0, int(b
-00005690: 696e 5f77 6964 7468 202a 2062 696e 5f63  in_width * bin_c
-000056a0: 6f75 6e74 295d 292c 0a20 2020 2020 2020  ount)]),.       
-000056b0: 2029 0a20 2020 2020 2020 2073 616d 706c   ).        sampl
-000056c0: 655f 315f 6869 7374 5b73 616d 706c 655f  e_1_hist[sample_
-000056d0: 315f 6869 7374 203d 3d20 305d 203d 2066  1_hist == 0] = f
-000056e0: 696c 6c5f 7661 6c75 650a 2020 2020 2020  ill_value.      
-000056f0: 2020 7361 6d70 6c65 5f32 5f68 6973 745b    sample_2_hist[
-00005700: 7361 6d70 6c65 5f32 5f68 6973 7420 3d3d  sample_2_hist ==
-00005710: 2030 5d20 3d20 6669 6c6c 5f76 616c 7565   0] = fill_value
-00005720: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
-00005730: 315f 6869 7374 2c20 7361 6d70 6c65 5f32  1_hist, sample_2
-00005740: 5f68 6973 7420 3d20 7361 6d70 6c65 5f31  _hist = sample_1
-00005750: 5f68 6973 7420 2f20 6e70 2e73 756d 280a  _hist / np.sum(.
-00005760: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-00005770: 6c65 5f31 5f68 6973 740a 2020 2020 2020  le_1_hist.      
-00005780: 2020 292c 2073 616d 706c 655f 325f 6869    ), sample_2_hi
-00005790: 7374 202f 206e 702e 7375 6d28 7361 6d70  st / np.sum(samp
-000057a0: 6c65 5f32 5f68 6973 7429 0a20 2020 2020  le_2_hist).     
-000057b0: 2020 2072 6574 7572 6e20 7374 6174 732e     return stats.
-000057c0: 656e 7472 6f70 7928 706b 3d73 616d 706c  entropy(pk=sampl
-000057d0: 655f 315f 6869 7374 2c20 716b 3d73 616d  e_1_hist, qk=sam
-000057e0: 706c 655f 325f 6869 7374 290a 0a20 2020  ple_2_hist)..   
-000057f0: 2064 6566 2072 6f6c 6c69 6e67 5f6b 756c   def rolling_kul
-00005800: 6c62 6163 6b5f 6c65 6962 6c65 725f 6469  lback_leibler_di
-00005810: 7665 7267 656e 6365 280a 2020 2020 2020  vergence(.      
-00005820: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00005830: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00005840: 2c0a 2020 2020 2020 2020 7469 6d65 5f77  ,.        time_w
-00005850: 696e 646f 7773 3a20 6e70 2e6e 6461 7272  indows: np.ndarr
-00005860: 6179 2c0a 2020 2020 2020 2020 6670 733a  ay,.        fps:
-00005870: 2069 6e74 2c0a 2020 2020 2020 2020 6669   int,.        fi
-00005880: 6c6c 5f76 616c 7565 3a20 696e 7420 3d20  ll_value: int = 
-00005890: 312c 0a20 2020 2020 2020 2062 7563 6b65  1,.        bucke
-000058a0: 745f 6d65 7468 6f64 3a20 4c69 7465 7261  t_method: Litera
-000058b0: 6c5b 0a20 2020 2020 2020 2020 2020 2022  l[.            "
-000058c0: 6664 222c 2022 646f 616e 6522 2c20 2261  fd", "doane", "a
-000058d0: 7574 6f22 2c20 2273 636f 7474 222c 2022  uto", "scott", "
-000058e0: 7374 6f6e 6522 2c20 2272 6963 6522 2c20  stone", "rice", 
-000058f0: 2273 7475 7267 6573 222c 2022 7371 7274  "sturges", "sqrt
-00005900: 220a 2020 2020 2020 2020 5d20 3d20 2261  ".        ] = "a
-00005910: 7574 6f22 2c0a 2020 2020 2920 2d3e 206e  uto",.    ) -> n
-00005920: 702e 6e64 6172 7261 793a 0a20 2020 2020  p.ndarray:.     
-00005930: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00005940: 6f6d 7075 7465 2072 6f6c 6c69 6e67 204b  ompute rolling K
-00005950: 756c 6c62 6163 6b2d 4c65 6962 6c65 7220  ullback-Leibler 
-00005960: 6469 7665 7267 656e 6365 2063 6f6d 7061  divergence compa
-00005970: 7269 6e67 2074 6865 2063 7572 7265 6e74  ring the current
-00005980: 2074 696d 652d 7769 6e64 6f77 206f 660a   time-window of.
-00005990: 2020 2020 2020 2020 7369 7a65 204e 2074          size N t
-000059a0: 6f20 7468 6520 7072 6563 6564 696e 6720  o the preceding 
-000059b0: 7769 6e64 6f77 206f 6620 7369 7a65 204e  window of size N
-000059c0: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
-000059d0: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
-000059e0: 456d 7074 7920 6269 6e73 2028 3020 6f62  Empty bins (0 ob
-000059f0: 7365 7276 6174 696f 6e73 2069 6e20 6269  servations in bi
-00005a00: 6e29 2069 6e20 6973 2072 6570 6c61 6365  n) in is replace
-00005a10: 6420 7769 7468 2060 6066 696c 6c5f 7661  d with ``fill_va
-00005a20: 6c75 6560 602e 0a0a 2020 2020 2020 2020  lue``...        
-00005a30: 3a70 6172 616d 6574 6572 206e 6461 7272  :parameter ndarr
-00005a40: 6179 2073 616d 706c 655f 313a 2031 6420  ay sample_1: 1d 
-00005a50: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
-00005a60: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
-00005a70: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00005a80: 6d65 7465 7220 4c69 7465 7261 6c20 6275  meter Literal bu
-00005a90: 636b 6574 5f6d 6574 686f 643a 2045 7374  cket_method: Est
-00005aa0: 696d 6174 6f72 2064 6574 6572 6d69 6e69  imator determini
-00005ab0: 6e67 206f 7074 696d 616c 2062 7563 6b65  ng optimal bucke
-00005ac0: 7420 636f 756e 7420 616e 6420 6275 636b  t count and buck
-00005ad0: 6574 2077 6964 7468 2e20 4465 6661 756c  et width. Defaul
-00005ae0: 743a 2054 6865 206d 6178 696d 756d 206f  t: The maximum o
-00005af0: 6620 7468 6520 5374 7572 6765 7320 616e  f the Sturges an
-00005b00: 6420 4672 6565 646d 616e 2d44 6961 636f  d Freedman-Diaco
-00005b10: 6e69 7320 6573 7469 6d61 746f 7273 0a20  nis estimators. 
-00005b20: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-00005b30: 7220 6e70 2e6e 6461 7272 6179 5b66 6c6f  r np.ndarray[flo
-00005b40: 6174 735d 2074 696d 655f 7769 6e64 6f77  ats] time_window
-00005b50: 733a 2054 696d 6520 7769 6e64 6f77 7320  s: Time windows 
-00005b60: 746f 2063 6f6d 7075 7465 204a 5320 666f  to compute JS fo
-00005b70: 7220 696e 2073 6563 6f6e 6473 2e0a 2020  r in seconds..  
-00005b80: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-00005b90: 2069 6e74 2066 7073 3a20 4672 616d 652d   int fps: Frame-
-00005ba0: 7261 7465 206f 6620 7265 636f 7264 6564  rate of recorded
-00005bb0: 2076 6964 656f 2e0a 2020 2020 2020 2020   video..        
-00005bc0: 3a72 6574 7572 6e73 206e 702e 6e64 6172  :returns np.ndar
-00005bd0: 7261 793a 2053 697a 6520 6461 7461 2e73  ray: Size data.s
-00005be0: 6861 7065 5b30 5d20 7820 7769 6e64 6f77  hape[0] x window
-00005bf0: 5f73 697a 6573 2e73 6861 7065 2077 6974  _sizes.shape wit
-00005c00: 6820 4b75 6c6c 6261 636b 2d4c 6569 626c  h Kullback-Leibl
-00005c10: 6572 2064 6976 6572 6765 6e63 652e 2043  er divergence. C
-00005c20: 6f6c 756d 6e73 2072 6570 7265 7365 6e74  olumns represent
-00005c30: 7320 6469 6666 6572 656e 7420 7469 656d  s different tiem
-00005c40: 2077 696e 646f 7773 2e0a 0a20 2020 2020   windows...     
-00005c50: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
-00005c60: 2020 2020 203e 3e3e 2073 616d 706c 655f       >>> sample_
-00005c70: 312c 2073 616d 706c 655f 3220 3d20 6e70  1, sample_2 = np
-00005c80: 2e72 616e 646f 6d2e 6e6f 726d 616c 286c  .random.normal(l
-00005c90: 6f63 3d31 302c 2073 6361 6c65 3d37 3030  oc=10, scale=700
-00005ca0: 2c20 7369 7a65 3d35 292c 206e 702e 7261  , size=5), np.ra
-00005cb0: 6e64 6f6d 2e6e 6f72 6d61 6c28 6c6f 633d  ndom.normal(loc=
-00005cc0: 3530 2c20 7363 616c 653d 3730 302c 2073  50, scale=700, s
-00005cd0: 697a 653d 3529 0a20 2020 2020 2020 203e  ize=5).        >
-00005ce0: 3e3e 2064 6174 6120 3d20 6e70 2e68 7374  >> data = np.hst
-00005cf0: 6163 6b28 2873 616d 706c 655f 312c 2073  ack((sample_1, s
-00005d00: 616d 706c 655f 3229 290a 2020 2020 2020  ample_2)).      
-00005d10: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
-00005d20: 2829 2e72 6f6c 6c69 6e67 5f6b 756c 6c62  ().rolling_kullb
-00005d30: 6163 6b5f 6c65 6962 6c65 725f 6469 7665  ack_leibler_dive
-00005d40: 7267 656e 6365 2864 6174 613d 6461 7461  rgence(data=data
-00005d50: 2c20 7469 6d65 5f77 696e 646f 7773 3d6e  , time_windows=n
-00005d60: 702e 6172 7261 7928 5b31 5d29 2c20 6670  p.array([1]), fp
-00005d70: 733d 3229 0a20 2020 2020 2020 2022 2222  s=2).        """
-00005d80: 0a0a 2020 2020 2020 2020 6368 6563 6b5f  ..        check_
-00005d90: 7661 6c69 645f 6172 7261 7928 6461 7461  valid_array(data
-00005da0: 3d64 6174 612c 2073 6f75 7263 653d 7365  =data, source=se
-00005db0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-00005dc0: 616d 655f 5f2c 2061 6363 6570 7465 645f  ame__, accepted_
-00005dd0: 7369 7a65 733d 5b31 5d29 0a20 2020 2020  sizes=[1]).     
-00005de0: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-00005df0: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00005e00: 2020 6461 7461 3d74 696d 655f 7769 6e64    data=time_wind
-00005e10: 6f77 732c 2073 6f75 7263 653d 7365 6c66  ows, source=self
-00005e20: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00005e30: 655f 5f2c 2061 6363 6570 7465 645f 7369  e__, accepted_si
-00005e40: 7a65 733d 5b31 5d0a 2020 2020 2020 2020  zes=[1].        
-00005e50: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
-00005e60: 696e 7428 6e61 6d65 3d66 227b 7365 6c66  int(name=f"{self
-00005e70: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00005e80: 655f 5f7d 2066 7073 222c 2076 616c 7565  e__} fps", value
-00005e90: 3d66 7073 2c20 6d69 6e5f 7661 6c75 653d  =fps, min_value=
-00005ea0: 3129 0a20 2020 2020 2020 2063 6865 636b  1).        check
-00005eb0: 5f73 7472 280a 2020 2020 2020 2020 2020  _str(.          
-00005ec0: 2020 6e61 6d65 3d66 227b 7365 6c66 2e5f    name=f"{self._
-00005ed0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-00005ee0: 5f7d 2062 7563 6b65 745f 6d65 7468 6f64  _} bucket_method
-00005ef0: 222c 0a20 2020 2020 2020 2020 2020 2076  ",.            v
-00005f00: 616c 7565 3d62 7563 6b65 745f 6d65 7468  alue=bucket_meth
-00005f10: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-00005f20: 6f70 7469 6f6e 733d 4f70 7469 6f6e 732e  options=Options.
-00005f30: 4255 434b 4554 5f4d 4554 484f 4453 2e76  BUCKET_METHODS.v
-00005f40: 616c 7565 2c0a 2020 2020 2020 2020 290a  alue,.        ).
-00005f50: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
-00005f60: 203d 206e 702e 6675 6c6c 2828 6461 7461   = np.full((data
-00005f70: 2e73 6861 7065 5b30 5d2c 2074 696d 655f  .shape[0], time_
-00005f80: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
-00005f90: 292c 2030 2e30 290a 2020 2020 2020 2020  ), 0.0).        
-00005fa0: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
-00005fb0: 7469 6d65 5f77 696e 646f 7773 2e73 6861  time_windows.sha
-00005fc0: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
-00005fd0: 2020 2020 7769 6e64 6f77 5f73 697a 6520      window_size 
-00005fe0: 3d20 696e 7428 7469 6d65 5f77 696e 646f  = int(time_windo
-00005ff0: 7773 5b69 5d20 2a20 6670 7329 0a20 2020  ws[i] * fps).   
-00006000: 2020 2020 2020 2020 2064 6174 615f 7370           data_sp
-00006010: 6c69 7420 3d20 6e70 2e73 706c 6974 280a  lit = np.split(.
-00006020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006030: 6461 7461 2c20 6c69 7374 2872 616e 6765  data, list(range
-00006040: 2877 696e 646f 775f 7369 7a65 2c20 6461  (window_size, da
-00006050: 7461 2e73 6861 7065 5b30 5d2c 2077 696e  ta.shape[0], win
-00006060: 646f 775f 7369 7a65 2929 0a20 2020 2020  dow_size)).     
-00006070: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00006080: 2020 2020 2066 6f72 206a 2069 6e20 7072       for j in pr
-00006090: 616e 6765 2831 2c20 6c65 6e28 6461 7461  ange(1, len(data
-000060a0: 5f73 706c 6974 2929 3a0a 2020 2020 2020  _split)):.      
-000060b0: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
-000060c0: 5f73 7461 7274 203d 2069 6e74 2877 696e  _start = int(win
-000060d0: 646f 775f 7369 7a65 202a 206a 290a 2020  dow_size * j).  
-000060e0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-000060f0: 6e64 6f77 5f65 6e64 203d 2069 6e74 2877  ndow_end = int(w
-00006100: 696e 646f 775f 7374 6172 7420 2b20 7769  indow_start + wi
-00006110: 6e64 6f77 5f73 697a 6529 0a20 2020 2020  ndow_size).     
-00006120: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-00006130: 655f 312c 2073 616d 706c 655f 3220 3d20  e_1, sample_2 = 
-00006140: 6461 7461 5f73 706c 6974 5b6a 202d 2031  data_split[j - 1
-00006150: 5d2e 6173 7479 7065 286e 702e 666c 6f61  ].astype(np.floa
-00006160: 7433 3229 2c20 6461 7461 5f73 706c 6974  t32), data_split
-00006170: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00006180: 2020 2020 2020 6a0a 2020 2020 2020 2020        j.        
-00006190: 2020 2020 2020 2020 5d2e 6173 7479 7065          ].astype
-000061a0: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
-000061b0: 2020 2020 2020 2020 2020 2020 2062 696e               bin
-000061c0: 5f77 6964 7468 2c20 6269 6e5f 636f 756e  _width, bin_coun
-000061d0: 7420 3d20 6275 636b 6574 5f64 6174 6128  t = bucket_data(
-000061e0: 6461 7461 3d73 616d 706c 655f 312c 206d  data=sample_1, m
-000061f0: 6574 686f 643d 6275 636b 6574 5f6d 6574  ethod=bucket_met
-00006200: 686f 6429 0a20 2020 2020 2020 2020 2020  hod).           
-00006210: 2020 2020 2073 616d 706c 655f 315f 6869       sample_1_hi
-00006220: 7374 203d 2073 656c 662e 5f68 6973 745f  st = self._hist_
-00006230: 3164 280a 2020 2020 2020 2020 2020 2020  1d(.            
-00006240: 2020 2020 2020 2020 6461 7461 3d73 616d          data=sam
-00006250: 706c 655f 312c 0a20 2020 2020 2020 2020  ple_1,.         
-00006260: 2020 2020 2020 2020 2020 2062 696e 5f63             bin_c
-00006270: 6f75 6e74 3d62 696e 5f63 6f75 6e74 2c0a  ount=bin_count,.
-00006280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006290: 2020 2020 7261 6e67 653d 6e70 2e61 7272      range=np.arr
-000062a0: 6179 285b 302c 2069 6e74 2862 696e 5f77  ay([0, int(bin_w
-000062b0: 6964 7468 202a 2062 696e 5f63 6f75 6e74  idth * bin_count
-000062c0: 295d 292c 0a20 2020 2020 2020 2020 2020  )]),.           
-000062d0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000062e0: 2020 2020 2020 2073 616d 706c 655f 325f         sample_2_
-000062f0: 6869 7374 203d 2073 656c 662e 5f68 6973  hist = self._his
-00006300: 745f 3164 280a 2020 2020 2020 2020 2020  t_1d(.          
-00006310: 2020 2020 2020 2020 2020 6461 7461 3d73            data=s
-00006320: 616d 706c 655f 322c 0a20 2020 2020 2020  ample_2,.       
-00006330: 2020 2020 2020 2020 2020 2020 2062 696e               bin
-00006340: 5f63 6f75 6e74 3d62 696e 5f63 6f75 6e74  _count=bin_count
-00006350: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006360: 2020 2020 2020 7261 6e67 653d 6e70 2e61        range=np.a
-00006370: 7272 6179 285b 302c 2069 6e74 2862 696e  rray([0, int(bin
-00006380: 5f77 6964 7468 202a 2062 696e 5f63 6f75  _width * bin_cou
-00006390: 6e74 295d 292c 0a20 2020 2020 2020 2020  nt)]),.         
-000063a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000063b0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-000063c0: 315f 6869 7374 5b73 616d 706c 655f 315f  1_hist[sample_1_
-000063d0: 6869 7374 203d 3d20 305d 203d 2066 696c  hist == 0] = fil
-000063e0: 6c5f 7661 6c75 650a 2020 2020 2020 2020  l_value.        
-000063f0: 2020 2020 2020 2020 7361 6d70 6c65 5f32          sample_2
-00006400: 5f68 6973 745b 7361 6d70 6c65 5f32 5f68  _hist[sample_2_h
-00006410: 6973 7420 3d3d 2030 5d20 3d20 6669 6c6c  ist == 0] = fill
-00006420: 5f76 616c 7565 0a20 2020 2020 2020 2020  _value.         
-00006430: 2020 2020 2020 2073 616d 706c 655f 315f         sample_1_
-00006440: 6869 7374 2c20 7361 6d70 6c65 5f32 5f68  hist, sample_2_h
-00006450: 6973 7420 3d20 7361 6d70 6c65 5f31 5f68  ist = sample_1_h
-00006460: 6973 7420 2f20 6e70 2e73 756d 280a 2020  ist / np.sum(.  
-00006470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006480: 2020 7361 6d70 6c65 5f31 5f68 6973 740a    sample_1_hist.
-00006490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000064a0: 292c 2073 616d 706c 655f 325f 6869 7374  ), sample_2_hist
-000064b0: 202f 206e 702e 7375 6d28 7361 6d70 6c65   / np.sum(sample
-000064c0: 5f32 5f68 6973 7429 0a20 2020 2020 2020  _2_hist).       
-000064d0: 2020 2020 2020 2020 206b 6c20 3d20 7374           kl = st
-000064e0: 6174 732e 656e 7472 6f70 7928 706b 3d73  ats.entropy(pk=s
-000064f0: 616d 706c 655f 315f 6869 7374 2c20 716b  ample_1_hist, qk
-00006500: 3d73 616d 706c 655f 325f 6869 7374 290a  =sample_2_hist).
-00006510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006520: 7265 7375 6c74 735b 7769 6e64 6f77 5f73  results[window_s
-00006530: 7461 7274 3a77 696e 646f 775f 656e 642c  tart:window_end,
-00006540: 2069 5d20 3d20 6b6c 0a20 2020 2020 2020   i] = kl.       
-00006550: 2072 6574 7572 6e20 7265 7375 6c74 730a   return results.
-00006560: 0a20 2020 2064 6566 206a 656e 7365 6e5f  .    def jensen_
-00006570: 7368 616e 6e6f 6e5f 6469 7665 7267 656e  shannon_divergen
-00006580: 6365 280a 2020 2020 2020 2020 7365 6c66  ce(.        self
-00006590: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
-000065a0: 5f31 3a20 6e70 2e6e 6461 7272 6179 2c0a  _1: np.ndarray,.
-000065b0: 2020 2020 2020 2020 7361 6d70 6c65 5f32          sample_2
-000065c0: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
-000065d0: 2020 2020 2020 6275 636b 6574 5f6d 6574        bucket_met
-000065e0: 686f 643a 204c 6974 6572 616c 5b0a 2020  hod: Literal[.  
-000065f0: 2020 2020 2020 2020 2020 2266 6422 2c20            "fd", 
-00006600: 2264 6f61 6e65 222c 2022 6175 746f 222c  "doane", "auto",
-00006610: 2022 7363 6f74 7422 2c20 2273 746f 6e65   "scott", "stone
-00006620: 222c 2022 7269 6365 222c 2022 7374 7572  ", "rice", "stur
-00006630: 6765 7322 2c20 2273 7172 7422 0a20 2020  ges", "sqrt".   
-00006640: 2020 2020 205d 203d 2022 6175 746f 222c       ] = "auto",
-00006650: 0a20 2020 2029 202d 3e20 666c 6f61 743a  .    ) -> float:
-00006660: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00006670: 2020 2020 2043 6f6d 7075 7465 204a 656e       Compute Jen
-00006680: 7365 6e2d 5368 616e 6e6f 6e20 6469 7665  sen-Shannon dive
-00006690: 7267 656e 6365 2062 6574 7765 656e 2074  rgence between t
-000066a0: 776f 2064 6973 7472 6962 7574 696f 6e73  wo distributions
-000066b0: 2e20 5573 6566 756c 2066 6f72 2028 6929  . Useful for (i)
-000066c0: 206d 6561 7375 7265 2064 7269 6674 2069   measure drift i
-000066d0: 6e20 6461 7461 7365 7473 2c20 616e 6420  n datasets, and 
-000066e0: 2869 6929 2066 6561 7475 7269 7a61 7469  (ii) featurizati
-000066f0: 6f6e 206f 6620 6469 7374 7269 6275 7469  on of distributi
-00006700: 6f6e 2073 6869 6674 7320 6163 726f 7373  on shifts across
-00006710: 0a20 2020 2020 2020 2073 6571 7565 6e74  .        sequent
-00006720: 6961 6c20 7469 6d65 2d62 696e 732e 0a0a  ial time-bins...
-00006730: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-00006740: 3a0a 2020 2020 2020 2020 2020 204a 5344  :.           JSD
-00006750: 203d 2030 3a20 496e 6469 6361 7465 7320   = 0: Indicates 
-00006760: 7468 6174 2074 6865 2074 776f 2064 6973  that the two dis
-00006770: 7472 6962 7574 696f 6e73 2061 7265 2069  tributions are i
-00006780: 6465 6e74 6963 616c 2e0a 2020 2020 2020  dentical..      
-00006790: 2020 2020 2030 203c 204a 5344 203c 2031       0 < JSD < 1
-000067a0: 3a20 496e 6469 6361 7465 7320 6120 6465  : Indicates a de
-000067b0: 6772 6565 206f 6620 6469 7373 696d 696c  gree of dissimil
-000067c0: 6172 6974 7920 6265 7477 6565 6e20 7468  arity between th
-000067d0: 6520 6469 7374 7269 6275 7469 6f6e 732c  e distributions,
-000067e0: 2077 6974 6820 7661 6c75 6573 2063 6c6f   with values clo
-000067f0: 7365 7220 746f 2031 2069 6e64 6963 6174  ser to 1 indicat
-00006800: 696e 6720 6772 6561 7465 7220 6469 7373  ing greater diss
-00006810: 696d 696c 6172 6974 792e 0a20 2020 2020  imilarity..     
-00006820: 2020 2020 2020 4a53 4420 3d20 313a 2049        JSD = 1: I
-00006830: 6e64 6963 6174 6573 2074 6861 7420 7468  ndicates that th
-00006840: 6520 7477 6f20 6469 7374 7269 6275 7469  e two distributi
-00006850: 6f6e 7320 6172 6520 6d61 7869 6d61 6c6c  ons are maximall
-00006860: 7920 6469 7373 696d 696c 6172 2e0a 0a20  y dissimilar... 
-00006870: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-00006880: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
-00006890: 5f31 3a20 4669 7273 7420 3164 2061 7272  _1: First 1d arr
-000068a0: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
-000068b0: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
-000068c0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-000068d0: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
-000068e0: 655f 323a 2053 6563 6f6e 6420 3164 2061  e_2: Second 1d a
-000068f0: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
-00006900: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
-00006910: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00006920: 6574 6572 204c 6974 6572 616c 2062 7563  eter Literal buc
-00006930: 6b65 745f 6d65 7468 6f64 3a20 4573 7469  ket_method: Esti
-00006940: 6d61 746f 7220 6465 7465 726d 696e 696e  mator determinin
-00006950: 6720 6f70 7469 6d61 6c20 6275 636b 6574  g optimal bucket
-00006960: 2063 6f75 6e74 2061 6e64 2062 7563 6b65   count and bucke
-00006970: 7420 7769 6474 682e 2044 6566 6175 6c74  t width. Default
-00006980: 3a20 5468 6520 6d61 7869 6d75 6d20 6f66  : The maximum of
-00006990: 2074 6865 2053 7475 7267 6573 2061 6e64   the Sturges and
-000069a0: 2046 7265 6564 6d61 6e2d 4469 6163 6f6e   Freedman-Diacon
-000069b0: 6973 2065 7374 696d 6174 6f72 732e 0a20  is estimators.. 
-000069c0: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
-000069d0: 666c 6f61 743a 204a 656e 7365 6e2d 5368  float: Jensen-Sh
-000069e0: 616e 6e6f 6e20 6469 7665 7267 656e 6365  annon divergence
-000069f0: 2062 6574 7765 656e 2060 6073 616d 706c   between ``sampl
-00006a00: 655f 3160 6020 616e 6420 6060 7361 6d70  e_1`` and ``samp
-00006a10: 6c65 5f32 6060 0a0a 2020 2020 2020 2020  le_2``..        
-00006a20: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-00006a30: 2020 3e3e 3e20 7361 6d70 6c65 5f31 2c20    >>> sample_1, 
-00006a40: 7361 6d70 6c65 5f32 203d 206e 702e 6172  sample_2 = np.ar
-00006a50: 7261 7928 5b31 2c20 322c 2033 2c20 342c  ray([1, 2, 3, 4,
-00006a60: 2035 2c20 3130 2c20 312c 2032 2c20 335d   5, 10, 1, 2, 3]
-00006a70: 292c 206e 702e 6172 7261 7928 5b31 2c20  ), np.array([1, 
-00006a80: 352c 2031 302c 2039 2c20 3130 2c20 312c  5, 10, 9, 10, 1,
-00006a90: 2031 302c 2036 2c20 375d 290a 2020 2020   10, 6, 7]).    
-00006aa0: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
-00006ab0: 6373 2829 2e6a 656e 7365 6e5f 7368 616e  cs().jensen_shan
-00006ac0: 6e6f 6e5f 6469 7665 7267 656e 6365 2873  non_divergence(s
-00006ad0: 616d 706c 655f 313d 7361 6d70 6c65 5f31  ample_1=sample_1
-00006ae0: 2c20 7361 6d70 6c65 5f32 3d73 616d 706c  , sample_2=sampl
-00006af0: 655f 322c 2062 7563 6b65 745f 6d65 7468  e_2, bucket_meth
-00006b00: 6f64 3d27 6664 2729 0a20 2020 2020 2020  od='fd').       
-00006b10: 203e 3e3e 2030 2e33 3038 3036 3534 3133   >>> 0.308065413
-00006b20: 3538 3231 3937 3836 0a20 2020 2020 2020  58219786.       
-00006b30: 2022 2222 0a0a 2020 2020 2020 2020 6368   """..        ch
-00006b40: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
-00006b50: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00006b60: 613d 7361 6d70 6c65 5f31 2c0a 2020 2020  a=sample_1,.    
-00006b70: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
-00006b80: 7461 7469 7374 6963 732e 6a65 6e73 656e  tatistics.jensen
-00006b90: 5f73 6861 6e6e 6f6e 5f64 6976 6572 6765  _shannon_diverge
-00006ba0: 6e63 652e 5f5f 6e61 6d65 5f5f 2c0a 2020  nce.__name__,.  
-00006bb0: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-00006bc0: 6564 5f6e 6469 6d73 3d28 312c 292c 0a20  ed_ndims=(1,),. 
-00006bd0: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-00006be0: 7465 645f 6474 7970 6573 3d28 6e70 2e66  ted_dtypes=(np.f
-00006bf0: 6c6f 6174 3332 2c20 6e70 2e66 6c6f 6174  loat32, np.float
-00006c00: 3634 2c20 6e70 2e69 6e74 3332 2c20 6e70  64, np.int32, np
-00006c10: 2e69 6e74 3634 2c20 696e 742c 2066 6c6f  .int64, int, flo
-00006c20: 6174 292c 0a20 2020 2020 2020 2029 0a20  at),.        ). 
-00006c30: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
-00006c40: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
-00006c50: 2020 2020 2020 6461 7461 3d73 616d 706c        data=sampl
-00006c60: 655f 322c 0a20 2020 2020 2020 2020 2020  e_2,.           
-00006c70: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
-00006c80: 6373 2e6a 656e 7365 6e5f 7368 616e 6e6f  cs.jensen_shanno
-00006c90: 6e5f 6469 7665 7267 656e 6365 2e5f 5f6e  n_divergence.__n
-00006ca0: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-00006cb0: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
-00006cc0: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
-00006cd0: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
-00006ce0: 7065 733d 286e 702e 666c 6f61 7433 322c  pes=(np.float32,
-00006cf0: 206e 702e 666c 6f61 7436 342c 206e 702e   np.float64, np.
-00006d00: 696e 7433 322c 206e 702e 696e 7436 342c  int32, np.int64,
-00006d10: 2069 6e74 2c20 666c 6f61 7429 2c0a 2020   int, float),.  
-00006d20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00006d30: 6368 6563 6b5f 7374 7228 0a20 2020 2020  check_str(.     
-00006d40: 2020 2020 2020 206e 616d 653d 6622 7b73         name=f"{s
-00006d50: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-00006d60: 6e61 6d65 5f5f 7d20 6275 636b 6574 5f6d  name__} bucket_m
-00006d70: 6574 686f 6422 2c0a 2020 2020 2020 2020  ethod",.        
-00006d80: 2020 2020 7661 6c75 653d 6275 636b 6574      value=bucket
-00006d90: 5f6d 6574 686f 642c 0a20 2020 2020 2020  _method,.       
-00006da0: 2020 2020 206f 7074 696f 6e73 3d4f 7074       options=Opt
-00006db0: 696f 6e73 2e42 5543 4b45 545f 4d45 5448  ions.BUCKET_METH
-00006dc0: 4f44 532e 7661 6c75 652c 0a20 2020 2020  ODS.value,.     
-00006dd0: 2020 2029 0a20 2020 2020 2020 2062 696e     ).        bin
-00006de0: 5f77 6964 7468 2c20 6269 6e5f 636f 756e  _width, bin_coun
-00006df0: 7420 3d20 6275 636b 6574 5f64 6174 6128  t = bucket_data(
-00006e00: 6461 7461 3d73 616d 706c 655f 312c 206d  data=sample_1, m
-00006e10: 6574 686f 643d 6275 636b 6574 5f6d 6574  ethod=bucket_met
-00006e20: 686f 6429 0a20 2020 2020 2020 2073 616d  hod).        sam
-00006e30: 706c 655f 315f 6869 7374 203d 2073 656c  ple_1_hist = sel
-00006e40: 662e 5f68 6973 745f 3164 280a 2020 2020  f._hist_1d(.    
-00006e50: 2020 2020 2020 2020 6461 7461 3d73 616d          data=sam
-00006e60: 706c 655f 312c 0a20 2020 2020 2020 2020  ple_1,.         
-00006e70: 2020 2062 696e 5f63 6f75 6e74 3d62 696e     bin_count=bin
-00006e80: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
-00006e90: 2020 2020 7261 6e67 653d 6e70 2e61 7272      range=np.arr
-00006ea0: 6179 285b 302c 2069 6e74 2862 696e 5f77  ay([0, int(bin_w
-00006eb0: 6964 7468 202a 2062 696e 5f63 6f75 6e74  idth * bin_count
-00006ec0: 295d 292c 0a20 2020 2020 2020 2029 0a20  )]),.        ). 
-00006ed0: 2020 2020 2020 2073 616d 706c 655f 325f         sample_2_
-00006ee0: 6869 7374 203d 2073 656c 662e 5f68 6973  hist = self._his
-00006ef0: 745f 3164 280a 2020 2020 2020 2020 2020  t_1d(.          
-00006f00: 2020 6461 7461 3d73 616d 706c 655f 322c    data=sample_2,
-00006f10: 0a20 2020 2020 2020 2020 2020 2062 696e  .            bin
-00006f20: 5f63 6f75 6e74 3d62 696e 5f63 6f75 6e74  _count=bin_count
-00006f30: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
-00006f40: 6e67 653d 6e70 2e61 7272 6179 285b 302c  nge=np.array([0,
-00006f50: 2069 6e74 2862 696e 5f77 6964 7468 202a   int(bin_width *
-00006f60: 2062 696e 5f63 6f75 6e74 295d 292c 0a20   bin_count)]),. 
-00006f70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00006f80: 206d 6561 6e5f 6869 7374 203d 206e 702e   mean_hist = np.
-00006f90: 6d65 616e 285b 7361 6d70 6c65 5f31 5f68  mean([sample_1_h
-00006fa0: 6973 742c 2073 616d 706c 655f 325f 6869  ist, sample_2_hi
-00006fb0: 7374 5d2c 2061 7869 733d 3029 0a20 2020  st], axis=0).   
-00006fc0: 2020 2020 206b 6c5f 7361 6d70 6c65 5f31       kl_sample_1
-00006fd0: 2c20 6b6c 5f73 616d 706c 655f 3220 3d20  , kl_sample_2 = 
-00006fe0: 7374 6174 732e 656e 7472 6f70 7928 0a20  stats.entropy(. 
-00006ff0: 2020 2020 2020 2020 2020 2070 6b3d 7361             pk=sa
-00007000: 6d70 6c65 5f31 5f68 6973 742c 2071 6b3d  mple_1_hist, qk=
-00007010: 6d65 616e 5f68 6973 740a 2020 2020 2020  mean_hist.      
-00007020: 2020 292c 2073 7461 7473 2e65 6e74 726f    ), stats.entro
-00007030: 7079 2870 6b3d 7361 6d70 6c65 5f32 5f68  py(pk=sample_2_h
-00007040: 6973 742c 2071 6b3d 6d65 616e 5f68 6973  ist, qk=mean_his
-00007050: 7429 0a20 2020 2020 2020 2072 6574 7572  t).        retur
-00007060: 6e20 286b 6c5f 7361 6d70 6c65 5f31 202b  n (kl_sample_1 +
-00007070: 206b 6c5f 7361 6d70 6c65 5f32 2920 2f20   kl_sample_2) / 
-00007080: 320a 0a20 2020 2064 6566 2072 6f6c 6c69  2..    def rolli
-00007090: 6e67 5f6a 656e 7365 6e5f 7368 616e 6e6f  ng_jensen_shanno
-000070a0: 6e5f 6469 7665 7267 656e 6365 280a 2020  n_divergence(.  
-000070b0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000070c0: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
-000070d0: 7272 6179 2c0a 2020 2020 2020 2020 7469  rray,.        ti
-000070e0: 6d65 5f77 696e 646f 7773 3a20 6e70 2e6e  me_windows: np.n
-000070f0: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
-00007100: 6670 733a 2069 6e74 2c0a 2020 2020 2020  fps: int,.      
-00007110: 2020 6275 636b 6574 5f6d 6574 686f 643a    bucket_method:
-00007120: 204c 6974 6572 616c 5b0a 2020 2020 2020   Literal[.      
-00007130: 2020 2020 2020 2266 6422 2c20 2264 6f61        "fd", "doa
-00007140: 6e65 222c 2022 6175 746f 222c 2022 7363  ne", "auto", "sc
-00007150: 6f74 7422 2c20 2273 746f 6e65 222c 2022  ott", "stone", "
-00007160: 7269 6365 222c 2022 7374 7572 6765 7322  rice", "sturges"
-00007170: 2c20 2273 7172 7422 0a20 2020 2020 2020  , "sqrt".       
-00007180: 205d 203d 2022 6175 746f 222c 0a20 2020   ] = "auto",.   
-00007190: 2029 202d 3e20 6e70 2e6e 6461 7272 6179   ) -> np.ndarray
-000071a0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000071b0: 2020 2020 2020 436f 6d70 7574 6520 726f        Compute ro
-000071c0: 6c6c 696e 6720 4a65 6e73 656e 2d53 6861  lling Jensen-Sha
-000071d0: 6e6e 6f6e 2064 6976 6572 6765 6e63 6520  nnon divergence 
-000071e0: 636f 6d70 6172 696e 6720 7468 6520 6375  comparing the cu
-000071f0: 7272 656e 7420 7469 6d65 2d77 696e 646f  rrent time-windo
-00007200: 7720 6f66 2073 697a 6520 4e20 746f 2074  w of size N to t
-00007210: 6865 2070 7265 6365 6469 6e67 2077 696e  he preceding win
-00007220: 646f 7720 6f66 2073 697a 6520 4e2e 0a0a  dow of size N...
-00007230: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-00007240: 6572 206e 6461 7272 6179 2064 6174 613a  er ndarray data:
-00007250: 2031 4420 6172 7261 7920 6f66 2073 697a   1D array of siz
-00007260: 6520 6c65 6e28 6672 616d 6573 2920 7265  e len(frames) re
-00007270: 7072 6573 656e 7469 6e67 2066 6561 7475  presenting featu
-00007280: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
-00007290: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
-000072a0: 2e6e 6461 7272 6179 5b69 6e74 735d 2074  .ndarray[ints] t
-000072b0: 696d 655f 7769 6e64 6f77 733a 2054 696d  ime_windows: Tim
-000072c0: 6520 7769 6e64 6f77 7320 746f 2063 6f6d  e windows to com
-000072d0: 7075 7465 204a 5320 666f 7220 696e 2073  pute JS for in s
-000072e0: 6563 6f6e 6473 2e0a 2020 2020 2020 2020  econds..        
-000072f0: 3a70 6172 616d 6574 6572 2069 6e74 2066  :parameter int f
-00007300: 7073 3a20 4672 616d 652d 7261 7465 206f  ps: Frame-rate o
-00007310: 6620 7265 636f 7264 6564 2076 6964 656f  f recorded video
-00007320: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00007330: 6574 6572 204c 6974 6572 616c 2062 7563  eter Literal buc
-00007340: 6b65 745f 6d65 7468 6f64 3a20 4573 7469  ket_method: Esti
-00007350: 6d61 746f 7220 6465 7465 726d 696e 696e  mator determinin
-00007360: 6720 6f70 7469 6d61 6c20 6275 636b 6574  g optimal bucket
-00007370: 2063 6f75 6e74 2061 6e64 2062 7563 6b65   count and bucke
-00007380: 7420 7769 6474 682e 2044 6566 6175 6c74  t width. Default
-00007390: 3a20 5468 6520 6d61 7869 6d75 6d20 6f66  : The maximum of
-000073a0: 2074 6865 2053 7475 7267 6573 2061 6e64   the Sturges and
-000073b0: 2046 7265 6564 6d61 6e2d 4469 6163 6f6e   Freedman-Diacon
-000073c0: 6973 2065 7374 696d 6174 6f72 730a 2020  is estimators.  
-000073d0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-000073e0: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-000073f0: 7272 6179 2864 6174 613d 6461 7461 2c20  rray(data=data, 
-00007400: 736f 7572 6365 3d73 656c 662e 5f5f 636c  source=self.__cl
-00007410: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c20  ass__.__name__, 
-00007420: 6163 6365 7074 6564 5f73 697a 6573 3d5b  accepted_sizes=[
-00007430: 315d 290a 2020 2020 2020 2020 6368 6563  1]).        chec
-00007440: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-00007450: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00007460: 7469 6d65 5f77 696e 646f 7773 2c20 736f  time_windows, so
-00007470: 7572 6365 3d73 656c 662e 5f5f 636c 6173  urce=self.__clas
-00007480: 735f 5f2e 5f5f 6e61 6d65 5f5f 2c20 6163  s__.__name__, ac
-00007490: 6365 7074 6564 5f73 697a 6573 3d5b 315d  cepted_sizes=[1]
-000074a0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000074b0: 2020 2063 6865 636b 5f69 6e74 286e 616d     check_int(nam
-000074c0: 653d 6622 7b73 656c 662e 5f5f 636c 6173  e=f"{self.__clas
-000074d0: 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20 6670  s__.__name__} fp
-000074e0: 7322 2c20 7661 6c75 653d 6670 732c 206d  s", value=fps, m
-000074f0: 696e 5f76 616c 7565 3d31 290a 2020 2020  in_value=1).    
-00007500: 2020 2020 6368 6563 6b5f 7374 7228 0a20      check_str(. 
-00007510: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-00007520: 6622 7b73 656c 662e 5f5f 636c 6173 735f  f"{self.__class_
-00007530: 5f2e 5f5f 6e61 6d65 5f5f 7d20 6275 636b  _.__name__} buck
-00007540: 6574 5f6d 6574 686f 6422 2c0a 2020 2020  et_method",.    
-00007550: 2020 2020 2020 2020 7661 6c75 653d 6275          value=bu
-00007560: 636b 6574 5f6d 6574 686f 642c 0a20 2020  cket_method,.   
-00007570: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00007580: 3d4f 7074 696f 6e73 2e42 5543 4b45 545f  =Options.BUCKET_
-00007590: 4d45 5448 4f44 532e 7661 6c75 652c 0a20  METHODS.value,. 
-000075a0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000075b0: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
-000075c0: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
-000075d0: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-000075e0: 7368 6170 655b 305d 292c 2030 2e30 290a  shape[0]), 0.0).
-000075f0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00007600: 2070 7261 6e67 6528 7469 6d65 5f77 696e   prange(time_win
-00007610: 646f 7773 2e73 6861 7065 5b30 5d29 3a0a  dows.shape[0]):.
-00007620: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-00007630: 6f77 5f73 697a 6520 3d20 696e 7428 7469  ow_size = int(ti
-00007640: 6d65 5f77 696e 646f 7773 5b69 5d20 2a20  me_windows[i] * 
-00007650: 6670 7329 0a20 2020 2020 2020 2020 2020  fps).           
-00007660: 2064 6174 615f 7370 6c69 7420 3d20 6e70   data_split = np
-00007670: 2e73 706c 6974 280a 2020 2020 2020 2020  .split(.        
-00007680: 2020 2020 2020 2020 6461 7461 2c20 6c69          data, li
-00007690: 7374 2872 616e 6765 2877 696e 646f 775f  st(range(window_
-000076a0: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
-000076b0: 5b30 5d2c 2077 696e 646f 775f 7369 7a65  [0], window_size
-000076c0: 2929 0a20 2020 2020 2020 2020 2020 2029  )).            )
-000076d0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000076e0: 206a 2069 6e20 7072 616e 6765 2831 2c20   j in prange(1, 
-000076f0: 6c65 6e28 6461 7461 5f73 706c 6974 2929  len(data_split))
-00007700: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00007710: 2020 7769 6e64 6f77 5f73 7461 7274 203d    window_start =
-00007720: 2069 6e74 2877 696e 646f 775f 7369 7a65   int(window_size
-00007730: 202a 206a 290a 2020 2020 2020 2020 2020   * j).          
-00007740: 2020 2020 2020 7769 6e64 6f77 5f65 6e64        window_end
-00007750: 203d 2069 6e74 2877 696e 646f 775f 7374   = int(window_st
-00007760: 6172 7420 2b20 7769 6e64 6f77 5f73 697a  art + window_siz
-00007770: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00007780: 2020 2073 616d 706c 655f 312c 2073 616d     sample_1, sam
-00007790: 706c 655f 3220 3d20 6461 7461 5f73 706c  ple_2 = data_spl
-000077a0: 6974 5b6a 202d 2031 5d2e 6173 7479 7065  it[j - 1].astype
-000077b0: 286e 702e 666c 6f61 7433 3229 2c20 6461  (np.float32), da
-000077c0: 7461 5f73 706c 6974 5b0a 2020 2020 2020  ta_split[.      
-000077d0: 2020 2020 2020 2020 2020 2020 2020 6a0a                j.
-000077e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077f0: 5d2e 6173 7479 7065 286e 702e 666c 6f61  ].astype(np.floa
-00007800: 7433 3229 0a20 2020 2020 2020 2020 2020  t32).           
-00007810: 2020 2020 2062 696e 5f77 6964 7468 2c20       bin_width, 
-00007820: 6269 6e5f 636f 756e 7420 3d20 6275 636b  bin_count = buck
-00007830: 6574 5f64 6174 6128 6461 7461 3d73 616d  et_data(data=sam
-00007840: 706c 655f 312c 206d 6574 686f 643d 6275  ple_1, method=bu
-00007850: 636b 6574 5f6d 6574 686f 6429 0a20 2020  cket_method).   
-00007860: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-00007870: 706c 655f 315f 6869 7374 203d 2073 656c  ple_1_hist = sel
-00007880: 662e 5f68 6973 745f 3164 280a 2020 2020  f._hist_1d(.    
-00007890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000078a0: 6461 7461 3d73 616d 706c 655f 312c 0a20  data=sample_1,. 
-000078b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000078c0: 2020 2062 696e 5f63 6f75 6e74 3d62 696e     bin_count=bin
-000078d0: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
-000078e0: 2020 2020 2020 2020 2020 2020 7261 6e67              rang
-000078f0: 653d 6e70 2e61 7272 6179 285b 302c 2069  e=np.array([0, i
-00007900: 6e74 2862 696e 5f77 6964 7468 202a 2062  nt(bin_width * b
-00007910: 696e 5f63 6f75 6e74 295d 292c 0a20 2020  in_count)]),.   
-00007920: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00007930: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00007940: 616d 706c 655f 325f 6869 7374 203d 2073  ample_2_hist = s
-00007950: 656c 662e 5f68 6973 745f 3164 280a 2020  elf._hist_1d(.  
-00007960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007970: 2020 6461 7461 3d73 616d 706c 655f 322c    data=sample_2,
-00007980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007990: 2020 2020 2062 696e 5f63 6f75 6e74 3d62       bin_count=b
-000079a0: 696e 5f63 6f75 6e74 2c0a 2020 2020 2020  in_count,.      
-000079b0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000079c0: 6e67 653d 6e70 2e61 7272 6179 285b 302c  nge=np.array([0,
-000079d0: 2069 6e74 2862 696e 5f77 6964 7468 202a   int(bin_width *
-000079e0: 2062 696e 5f63 6f75 6e74 295d 292c 0a20   bin_count)]),. 
-000079f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00007a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007a10: 2073 616d 706c 655f 315f 6869 7374 2c20   sample_1_hist, 
-00007a20: 7361 6d70 6c65 5f32 5f68 6973 7420 3d20  sample_2_hist = 
-00007a30: 7361 6d70 6c65 5f31 5f68 6973 7420 2f20  sample_1_hist / 
-00007a40: 6e70 2e73 756d 280a 2020 2020 2020 2020  np.sum(.        
-00007a50: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-00007a60: 6c65 5f31 5f68 6973 740a 2020 2020 2020  le_1_hist.      
-00007a70: 2020 2020 2020 2020 2020 292c 2073 616d            ), sam
-00007a80: 706c 655f 325f 6869 7374 202f 206e 702e  ple_2_hist / np.
-00007a90: 7375 6d28 7361 6d70 6c65 5f32 5f68 6973  sum(sample_2_his
-00007aa0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-00007ab0: 2020 206d 6561 6e5f 6869 7374 203d 206e     mean_hist = n
-00007ac0: 702e 6d65 616e 285b 7361 6d70 6c65 5f31  p.mean([sample_1
-00007ad0: 5f68 6973 742c 2073 616d 706c 655f 325f  _hist, sample_2_
-00007ae0: 6869 7374 5d2c 2061 7869 733d 3029 0a20  hist], axis=0). 
-00007af0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-00007b00: 6c5f 7361 6d70 6c65 5f31 2c20 6b6c 5f73  l_sample_1, kl_s
-00007b10: 616d 706c 655f 3220 3d20 7374 6174 732e  ample_2 = stats.
-00007b20: 656e 7472 6f70 7928 0a20 2020 2020 2020  entropy(.       
-00007b30: 2020 2020 2020 2020 2020 2020 2070 6b3d               pk=
-00007b40: 7361 6d70 6c65 5f31 5f68 6973 742c 2071  sample_1_hist, q
-00007b50: 6b3d 6d65 616e 5f68 6973 740a 2020 2020  k=mean_hist.    
-00007b60: 2020 2020 2020 2020 2020 2020 292c 2073              ), s
-00007b70: 7461 7473 2e65 6e74 726f 7079 2870 6b3d  tats.entropy(pk=
-00007b80: 7361 6d70 6c65 5f32 5f68 6973 742c 2071  sample_2_hist, q
-00007b90: 6b3d 6d65 616e 5f68 6973 7429 0a20 2020  k=mean_hist).   
-00007ba0: 2020 2020 2020 2020 2020 2020 206a 7320               js 
-00007bb0: 3d20 286b 6c5f 7361 6d70 6c65 5f31 202b  = (kl_sample_1 +
-00007bc0: 206b 6c5f 7361 6d70 6c65 5f32 2920 2f20   kl_sample_2) / 
-00007bd0: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-00007be0: 2020 7265 7375 6c74 735b 7769 6e64 6f77    results[window
-00007bf0: 5f73 7461 7274 3a77 696e 646f 775f 656e  _start:window_en
-00007c00: 642c 2069 5d20 3d20 6a73 0a20 2020 2020  d, i] = js.     
-00007c10: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-00007c20: 730a 0a20 2020 2064 6566 2077 6173 7365  s..    def wasse
-00007c30: 7273 7465 696e 5f64 6973 7461 6e63 6528  rstein_distance(
-00007c40: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00007c50: 2020 2020 2020 2073 616d 706c 655f 313a         sample_1:
-00007c60: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
-00007c70: 2020 2020 2073 616d 706c 655f 323a 206e       sample_2: n
-00007c80: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
-00007c90: 2020 2062 7563 6b65 745f 6d65 7468 6f64     bucket_method
-00007ca0: 3a20 4c69 7465 7261 6c5b 0a20 2020 2020  : Literal[.     
-00007cb0: 2020 2020 2020 2022 6664 222c 2022 646f         "fd", "do
-00007cc0: 616e 6522 2c20 2261 7574 6f22 2c20 2273  ane", "auto", "s
-00007cd0: 636f 7474 222c 2022 7374 6f6e 6522 2c20  cott", "stone", 
-00007ce0: 2272 6963 6522 2c20 2273 7475 7267 6573  "rice", "sturges
-00007cf0: 222c 2022 7371 7274 220a 2020 2020 2020  ", "sqrt".      
-00007d00: 2020 5d20 3d20 2261 7574 6f22 2c0a 2020    ] = "auto",.  
-00007d10: 2020 2920 2d3e 2066 6c6f 6174 3a0a 2020    ) -> float:.  
-00007d20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00007d30: 2020 436f 6d70 7574 6520 5761 7373 6572    Compute Wasser
-00007d40: 7374 6569 6e20 6469 7374 616e 6365 2062  stein distance b
-00007d50: 6574 7765 656e 2074 776f 2064 6973 7472  etween two distr
-00007d60: 6962 7574 696f 6e73 2e0a 0a20 2020 2020  ibutions...     
-00007d70: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
-00007d80: 2020 2020 2020 2020 5573 6573 2060 6073          Uses ``s
-00007d90: 7461 7473 2e77 6173 7365 7273 7465 696e  tats.wasserstein
-00007da0: 5f64 6973 7461 6e63 6560 602e 2049 2068  _distance``. I h
-00007db0: 6176 6520 7472 6965 6420 746f 206d 6f76  ave tried to mov
-00007dc0: 6520 6060 7374 6174 732e 7761 7373 6572  e ``stats.wasser
-00007dd0: 7374 6569 6e5f 6469 7374 616e 6365 6060  stein_distance``
-00007de0: 2074 6f20 6a69 7474 6564 206d 6574 686f   to jitted metho
-00007df0: 6420 6578 7465 6e73 6976 656c 792c 0a20  d extensively,. 
-00007e00: 2020 2020 2020 2020 2020 6275 7420 7468            but th
-00007e10: 6973 2064 6f65 736e 2774 2067 6976 6520  is doesn't give 
-00007e20: 7369 676e 6966 6963 616e 7420 7275 6e74  significant runt
-00007e30: 696d 6520 696d 7072 6f76 656d 656e 742e  ime improvement.
-00007e40: 2052 6174 652d 6c69 6d69 7465 7220 6170   Rate-limiter ap
-00007e50: 7065 6172 7320 746f 2062 6520 7468 6520  pears to be the 
-00007e60: 5f68 6973 745f 3164 2e0a 0a20 2020 2020  _hist_1d...     
-00007e70: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
-00007e80: 6172 7261 7920 7361 6d70 6c65 5f31 3a20  array sample_1: 
-00007e90: 4669 7273 7420 3164 2061 7272 6179 2072  First 1d array r
-00007ea0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
-00007eb0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-00007ec0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-00007ed0: 6461 7272 6179 2073 616d 706c 655f 323a  darray sample_2:
-00007ee0: 2053 6563 6f6e 6420 3164 2061 7272 6179   Second 1d array
-00007ef0: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
-00007f00: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
-00007f10: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-00007f20: 204c 6974 6572 616c 2062 7563 6b65 745f   Literal bucket_
-00007f30: 6d65 7468 6f64 3a20 4573 7469 6d61 746f  method: Estimato
-00007f40: 7220 6465 7465 726d 696e 696e 6720 6f70  r determining op
-00007f50: 7469 6d61 6c20 6275 636b 6574 2063 6f75  timal bucket cou
-00007f60: 6e74 2061 6e64 2062 7563 6b65 7420 7769  nt and bucket wi
-00007f70: 6474 682e 2044 6566 6175 6c74 3a20 5468  dth. Default: Th
-00007f80: 6520 6d61 7869 6d75 6d20 6f66 2074 6865  e maximum of the
-00007f90: 2053 7475 7267 6573 2061 6e64 2046 7265   Sturges and Fre
-00007fa0: 6564 6d61 6e2d 4469 6163 6f6e 6973 2065  edman-Diaconis e
-00007fb0: 7374 696d 6174 6f72 730a 2020 2020 2020  stimators.      
-00007fc0: 2020 3a72 6574 7572 6e73 2066 6c6f 6174    :returns float
-00007fd0: 3a20 5761 7373 6572 7374 6569 6e20 6469  : Wasserstein di
-00007fe0: 7374 616e 6365 2062 6574 7765 656e 2060  stance between `
-00007ff0: 6073 616d 706c 655f 3160 6020 616e 6420  `sample_1`` and 
-00008000: 6060 7361 6d70 6c65 5f32 6060 0a0a 2020  ``sample_2``..  
-00008010: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
-00008020: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
-00008030: 706c 655f 3120 3d20 6e70 2e72 616e 646f  ple_1 = np.rando
-00008040: 6d2e 6e6f 726d 616c 286c 6f63 3d31 302c  m.normal(loc=10,
-00008050: 2073 6361 6c65 3d32 2c20 7369 7a65 3d31   scale=2, size=1
-00008060: 3029 0a20 2020 2020 2020 203e 3e3e 2073  0).        >>> s
-00008070: 616d 706c 655f 3220 3d20 6e70 2e72 616e  ample_2 = np.ran
-00008080: 646f 6d2e 6e6f 726d 616c 286c 6f63 3d31  dom.normal(loc=1
-00008090: 302c 2073 6361 6c65 3d33 2c20 7369 7a65  0, scale=3, size
-000080a0: 3d31 3029 0a20 2020 2020 2020 203e 3e3e  =10).        >>>
-000080b0: 2053 7461 7469 7374 6963 7328 292e 7761   Statistics().wa
-000080c0: 7373 6572 7374 6569 6e5f 6469 7374 616e  sserstein_distan
-000080d0: 6365 2873 616d 706c 655f 313d 7361 6d70  ce(sample_1=samp
-000080e0: 6c65 5f31 2c20 7361 6d70 6c65 5f32 3d73  le_1, sample_2=s
-000080f0: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
-00008100: 203e 3e3e 2030 2e30 3230 3833 3333 3333   >>> 0.020833333
-00008110: 3333 3333 3333 3333 320a 2020 2020 2020  333333332.      
-00008120: 2020 2222 220a 2020 2020 2020 2020 6368    """.        ch
-00008130: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
-00008140: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00008150: 613d 7361 6d70 6c65 5f31 2c0a 2020 2020  a=sample_1,.    
-00008160: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
-00008170: 7461 7469 7374 6963 732e 6a65 6e73 656e  tatistics.jensen
-00008180: 5f73 6861 6e6e 6f6e 5f64 6976 6572 6765  _shannon_diverge
-00008190: 6e63 652e 5f5f 6e61 6d65 5f5f 2c0a 2020  nce.__name__,.  
-000081a0: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-000081b0: 6564 5f6e 6469 6d73 3d28 312c 292c 0a20  ed_ndims=(1,),. 
-000081c0: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-000081d0: 7465 645f 6474 7970 6573 3d28 6e70 2e66  ted_dtypes=(np.f
-000081e0: 6c6f 6174 3332 2c20 6e70 2e66 6c6f 6174  loat32, np.float
-000081f0: 3634 2c20 6e70 2e69 6e74 3332 2c20 6e70  64, np.int32, np
-00008200: 2e69 6e74 3634 2c20 696e 742c 2066 6c6f  .int64, int, flo
-00008210: 6174 292c 0a20 2020 2020 2020 2029 0a20  at),.        ). 
-00008220: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
-00008230: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
-00008240: 2020 2020 2020 6461 7461 3d73 616d 706c        data=sampl
-00008250: 655f 322c 0a20 2020 2020 2020 2020 2020  e_2,.           
-00008260: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
-00008270: 6373 2e6a 656e 7365 6e5f 7368 616e 6e6f  cs.jensen_shanno
-00008280: 6e5f 6469 7665 7267 656e 6365 2e5f 5f6e  n_divergence.__n
-00008290: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-000082a0: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
-000082b0: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
-000082c0: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
-000082d0: 7065 733d 286e 702e 666c 6f61 7433 322c  pes=(np.float32,
-000082e0: 206e 702e 666c 6f61 7436 342c 206e 702e   np.float64, np.
-000082f0: 696e 7433 322c 206e 702e 696e 7436 342c  int32, np.int64,
-00008300: 2069 6e74 2c20 666c 6f61 7429 2c0a 2020   int, float),.  
-00008310: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00008320: 6368 6563 6b5f 7374 7228 0a20 2020 2020  check_str(.     
-00008330: 2020 2020 2020 206e 616d 653d 6622 7b73         name=f"{s
-00008340: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-00008350: 6e61 6d65 5f5f 7d20 6275 636b 6574 5f6d  name__} bucket_m
-00008360: 6574 686f 6422 2c0a 2020 2020 2020 2020  ethod",.        
-00008370: 2020 2020 7661 6c75 653d 6275 636b 6574      value=bucket
-00008380: 5f6d 6574 686f 642c 0a20 2020 2020 2020  _method,.       
-00008390: 2020 2020 206f 7074 696f 6e73 3d4f 7074       options=Opt
-000083a0: 696f 6e73 2e42 5543 4b45 545f 4d45 5448  ions.BUCKET_METH
-000083b0: 4f44 532e 7661 6c75 652c 0a20 2020 2020  ODS.value,.     
-000083c0: 2020 2029 0a20 2020 2020 2020 2062 696e     ).        bin
-000083d0: 5f77 6964 7468 2c20 6269 6e5f 636f 756e  _width, bin_coun
-000083e0: 7420 3d20 6275 636b 6574 5f64 6174 6128  t = bucket_data(
-000083f0: 6461 7461 3d73 616d 706c 655f 312c 206d  data=sample_1, m
-00008400: 6574 686f 643d 6275 636b 6574 5f6d 6574  ethod=bucket_met
-00008410: 686f 6429 0a20 2020 2020 2020 2073 616d  hod).        sam
-00008420: 706c 655f 315f 6869 7374 203d 2073 656c  ple_1_hist = sel
-00008430: 662e 5f68 6973 745f 3164 280a 2020 2020  f._hist_1d(.    
-00008440: 2020 2020 2020 2020 6461 7461 3d73 616d          data=sam
-00008450: 706c 655f 312c 0a20 2020 2020 2020 2020  ple_1,.         
-00008460: 2020 2062 696e 5f63 6f75 6e74 3d62 696e     bin_count=bin
-00008470: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
-00008480: 2020 2020 7261 6e67 653d 6e70 2e61 7272      range=np.arr
-00008490: 6179 285b 302c 2069 6e74 2862 696e 5f77  ay([0, int(bin_w
-000084a0: 6964 7468 202a 2062 696e 5f63 6f75 6e74  idth * bin_count
-000084b0: 295d 292c 0a20 2020 2020 2020 2029 0a20  )]),.        ). 
-000084c0: 2020 2020 2020 2073 616d 706c 655f 325f         sample_2_
-000084d0: 6869 7374 203d 2073 656c 662e 5f68 6973  hist = self._his
-000084e0: 745f 3164 280a 2020 2020 2020 2020 2020  t_1d(.          
-000084f0: 2020 6461 7461 3d73 616d 706c 655f 322c    data=sample_2,
-00008500: 0a20 2020 2020 2020 2020 2020 2062 696e  .            bin
-00008510: 5f63 6f75 6e74 3d62 696e 5f63 6f75 6e74  _count=bin_count
-00008520: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
-00008530: 6e67 653d 6e70 2e61 7272 6179 285b 302c  nge=np.array([0,
-00008540: 2069 6e74 2862 696e 5f77 6964 7468 202a   int(bin_width *
-00008550: 2062 696e 5f63 6f75 6e74 295d 292c 0a20   bin_count)]),. 
-00008560: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00008570: 2073 616d 706c 655f 315f 6869 7374 2c20   sample_1_hist, 
-00008580: 7361 6d70 6c65 5f32 5f68 6973 7420 3d20  sample_2_hist = 
-00008590: 7361 6d70 6c65 5f31 5f68 6973 7420 2f20  sample_1_hist / 
-000085a0: 6e70 2e73 756d 280a 2020 2020 2020 2020  np.sum(.        
-000085b0: 2020 2020 7361 6d70 6c65 5f31 5f68 6973      sample_1_his
-000085c0: 740a 2020 2020 2020 2020 292c 2073 616d  t.        ), sam
-000085d0: 706c 655f 325f 6869 7374 202f 206e 702e  ple_2_hist / np.
-000085e0: 7375 6d28 7361 6d70 6c65 5f32 5f68 6973  sum(sample_2_his
-000085f0: 7429 0a20 2020 2020 2020 2072 6574 7572  t).        retur
-00008600: 6e20 7374 6174 732e 7761 7373 6572 7374  n stats.wasserst
-00008610: 6569 6e5f 6469 7374 616e 6365 280a 2020  ein_distance(.  
-00008620: 2020 2020 2020 2020 2020 755f 7661 6c75            u_valu
-00008630: 6573 3d73 616d 706c 655f 315f 6869 7374  es=sample_1_hist
-00008640: 2c20 765f 7661 6c75 6573 3d73 616d 706c  , v_values=sampl
-00008650: 655f 325f 6869 7374 0a20 2020 2020 2020  e_2_hist.       
-00008660: 2029 0a0a 2020 2020 6465 6620 726f 6c6c   )..    def roll
-00008670: 696e 675f 7761 7373 6572 7374 6569 6e5f  ing_wasserstein_
-00008680: 6469 7374 616e 6365 280a 2020 2020 2020  distance(.      
-00008690: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000086a0: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-000086b0: 2c0a 2020 2020 2020 2020 7469 6d65 5f77  ,.        time_w
-000086c0: 696e 646f 7773 3a20 6e70 2e6e 6461 7272  indows: np.ndarr
-000086d0: 6179 2c0a 2020 2020 2020 2020 6670 733a  ay,.        fps:
-000086e0: 2069 6e74 2c0a 2020 2020 2020 2020 6275   int,.        bu
-000086f0: 636b 6574 5f6d 6574 686f 643a 204c 6974  cket_method: Lit
-00008700: 6572 616c 5b0a 2020 2020 2020 2020 2020  eral[.          
-00008710: 2020 2266 6422 2c20 2264 6f61 6e65 222c    "fd", "doane",
-00008720: 2022 6175 746f 222c 2022 7363 6f74 7422   "auto", "scott"
-00008730: 2c20 2273 746f 6e65 222c 2022 7269 6365  , "stone", "rice
-00008740: 222c 2022 7374 7572 6765 7322 2c20 2273  ", "sturges", "s
-00008750: 7172 7422 0a20 2020 2020 2020 205d 203d  qrt".        ] =
-00008760: 2022 6175 746f 222c 0a20 2020 2029 202d   "auto",.    ) -
-00008770: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
-00008780: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00008790: 2020 436f 6d70 7574 6520 726f 6c6c 696e    Compute rollin
-000087a0: 6720 5761 7373 6572 7374 6569 6e20 6469  g Wasserstein di
-000087b0: 7374 616e 6365 2063 6f6d 7061 7269 6e67  stance comparing
-000087c0: 2074 6865 2063 7572 7265 6e74 2074 696d   the current tim
-000087d0: 652d 7769 6e64 6f77 206f 6620 7369 7a65  e-window of size
-000087e0: 204e 2074 6f20 7468 6520 7072 6563 6564   N to the preced
-000087f0: 696e 6720 7769 6e64 6f77 206f 6620 7369  ing window of si
-00008800: 7a65 204e 2e0a 0a20 2020 2020 2020 203a  ze N...        :
-00008810: 7061 7261 6d65 7465 7220 6e64 6172 7261  parameter ndarra
-00008820: 7920 6461 7461 3a20 3144 2061 7272 6179  y data: 1D array
-00008830: 206f 6620 7369 7a65 206c 656e 2866 7261   of size len(fra
-00008840: 6d65 7329 2072 6570 7265 7365 6e74 696e  mes) representin
-00008850: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
-00008860: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00008870: 6574 6572 206e 702e 6e64 6172 7261 795b  eter np.ndarray[
-00008880: 696e 7473 5d20 7469 6d65 5f77 696e 646f  ints] time_windo
-00008890: 7773 3a20 5469 6d65 2077 696e 646f 7773  ws: Time windows
-000088a0: 2074 6f20 636f 6d70 7574 6520 4a53 2066   to compute JS f
-000088b0: 6f72 2069 6e20 7365 636f 6e64 732e 0a20  or in seconds.. 
-000088c0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-000088d0: 7220 696e 7420 6670 733a 2046 7261 6d65  r int fps: Frame
-000088e0: 2d72 6174 6520 6f66 2072 6563 6f72 6465  -rate of recorde
-000088f0: 6420 7669 6465 6f2e 0a20 2020 2020 2020  d video..       
-00008900: 203a 7061 7261 6d65 7465 7220 4c69 7465   :parameter Lite
-00008910: 7261 6c20 6275 636b 6574 5f6d 6574 686f  ral bucket_metho
-00008920: 643a 2045 7374 696d 6174 6f72 2064 6574  d: Estimator det
-00008930: 6572 6d69 6e69 6e67 206f 7074 696d 616c  ermining optimal
-00008940: 2062 7563 6b65 7420 636f 756e 7420 616e   bucket count an
-00008950: 6420 6275 636b 6574 2077 6964 7468 2e20  d bucket width. 
-00008960: 4465 6661 756c 743a 2054 6865 206d 6178  Default: The max
-00008970: 696d 756d 206f 6620 7468 6520 5374 7572  imum of the Stur
-00008980: 6765 7320 616e 6420 4672 6565 646d 616e  ges and Freedman
-00008990: 2d44 6961 636f 6e69 7320 6573 7469 6d61  -Diaconis estima
-000089a0: 746f 7273 0a20 2020 2020 2020 203a 7265  tors.        :re
-000089b0: 7475 726e 7320 6e70 2e6e 6461 7272 6179  turns np.ndarray
-000089c0: 3a20 5369 7a65 2064 6174 612e 7368 6170  : Size data.shap
-000089d0: 655b 305d 2078 2077 696e 646f 775f 7369  e[0] x window_si
-000089e0: 7a65 732e 7368 6170 6520 7769 7468 2057  zes.shape with W
-000089f0: 6173 7365 7273 7465 696e 2064 6973 7461  asserstein dista
-00008a00: 6e63 652e 2043 6f6c 756d 6e73 2072 6570  nce. Columns rep
-00008a10: 7265 7365 6e74 2064 6966 6665 7265 6e74  resent different
-00008a20: 2074 696d 6520 7769 6e64 6f77 732e 0a0a   time windows...
-00008a30: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-00008a40: 3a0a 2020 2020 2020 2020 3e3e 3e20 6461  :.        >>> da
-00008a50: 7461 203d 206e 702e 7261 6e64 6f6d 2e72  ta = np.random.r
-00008a60: 616e 6469 6e74 2830 2c20 3130 302c 2028  andint(0, 100, (
-00008a70: 3130 302c 2929 0a20 2020 2020 2020 203e  100,)).        >
-00008a80: 3e3e 2053 7461 7469 7374 6963 7328 292e  >> Statistics().
-00008a90: 726f 6c6c 696e 675f 7761 7373 6572 7374  rolling_wasserst
-00008aa0: 6569 6e5f 6469 7374 616e 6365 2864 6174  ein_distance(dat
-00008ab0: 613d 6461 7461 2c20 7469 6d65 5f77 696e  a=data, time_win
-00008ac0: 646f 7773 3d6e 702e 6172 7261 7928 5b31  dows=np.array([1
-00008ad0: 2c20 325d 292c 2066 7073 3d33 3029 0a20  , 2]), fps=30). 
-00008ae0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00008af0: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
-00008b00: 6172 7261 7928 6461 7461 3d64 6174 612c  array(data=data,
-00008b10: 2073 6f75 7263 653d 7365 6c66 2e5f 5f63   source=self.__c
-00008b20: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f2c  lass__.__name__,
-00008b30: 2061 6363 6570 7465 645f 7369 7a65 733d   accepted_sizes=
-00008b40: 5b31 5d29 0a20 2020 2020 2020 2063 6865  [1]).        che
-00008b50: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
-00008b60: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00008b70: 3d74 696d 655f 7769 6e64 6f77 732c 2073  =time_windows, s
-00008b80: 6f75 7263 653d 7365 6c66 2e5f 5f63 6c61  ource=self.__cla
-00008b90: 7373 5f5f 2e5f 5f6e 616d 655f 5f2c 2061  ss__.__name__, a
-00008ba0: 6363 6570 7465 645f 7369 7a65 733d 5b31  ccepted_sizes=[1
-00008bb0: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
-00008bc0: 2020 2020 6368 6563 6b5f 696e 7428 6e61      check_int(na
-00008bd0: 6d65 3d66 227b 7365 6c66 2e5f 5f63 6c61  me=f"{self.__cla
-00008be0: 7373 5f5f 2e5f 5f6e 616d 655f 5f7d 2066  ss__.__name__} f
-00008bf0: 7073 222c 2076 616c 7565 3d66 7073 2c20  ps", value=fps, 
-00008c00: 6d69 6e5f 7661 6c75 653d 3129 0a20 2020  min_value=1).   
-00008c10: 2020 2020 2063 6865 636b 5f73 7472 280a       check_str(.
-00008c20: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00008c30: 3d66 227b 7365 6c66 2e5f 5f63 6c61 7373  =f"{self.__class
-00008c40: 5f5f 2e5f 5f6e 616d 655f 5f7d 2062 7563  __.__name__} buc
-00008c50: 6b65 745f 6d65 7468 6f64 222c 0a20 2020  ket_method",.   
-00008c60: 2020 2020 2020 2020 2076 616c 7565 3d62           value=b
-00008c70: 7563 6b65 745f 6d65 7468 6f64 2c0a 2020  ucket_method,.  
-00008c80: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00008c90: 733d 4f70 7469 6f6e 732e 4255 434b 4554  s=Options.BUCKET
-00008ca0: 5f4d 4554 484f 4453 2e76 616c 7565 2c0a  _METHODS.value,.
-00008cb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00008cc0: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
-00008cd0: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
-00008ce0: 305d 2c20 7469 6d65 5f77 696e 646f 7773  0], time_windows
-00008cf0: 2e73 6861 7065 5b30 5d29 2c20 302e 3029  .shape[0]), 0.0)
-00008d00: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00008d10: 6e20 7072 616e 6765 2874 696d 655f 7769  n prange(time_wi
-00008d20: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
-00008d30: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00008d40: 646f 775f 7369 7a65 203d 2069 6e74 2874  dow_size = int(t
-00008d50: 696d 655f 7769 6e64 6f77 735b 695d 202a  ime_windows[i] *
-00008d60: 2066 7073 290a 2020 2020 2020 2020 2020   fps).          
-00008d70: 2020 6461 7461 5f73 706c 6974 203d 206e    data_split = n
-00008d80: 702e 7370 6c69 7428 0a20 2020 2020 2020  p.split(.       
-00008d90: 2020 2020 2020 2020 2064 6174 612c 206c           data, l
-00008da0: 6973 7428 7261 6e67 6528 7769 6e64 6f77  ist(range(window
-00008db0: 5f73 697a 652c 2064 6174 612e 7368 6170  _size, data.shap
-00008dc0: 655b 305d 2c20 7769 6e64 6f77 5f73 697a  e[0], window_siz
-00008dd0: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-00008de0: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-00008df0: 7220 6a20 696e 2070 7261 6e67 6528 312c  r j in prange(1,
-00008e00: 206c 656e 2864 6174 615f 7370 6c69 7429   len(data_split)
-00008e10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00008e20: 2020 2077 696e 646f 775f 7374 6172 7420     window_start 
-00008e30: 3d20 696e 7428 7769 6e64 6f77 5f73 697a  = int(window_siz
-00008e40: 6520 2a20 6a29 0a20 2020 2020 2020 2020  e * j).         
-00008e50: 2020 2020 2020 2077 696e 646f 775f 656e         window_en
-00008e60: 6420 3d20 696e 7428 7769 6e64 6f77 5f73  d = int(window_s
-00008e70: 7461 7274 202b 2077 696e 646f 775f 7369  tart + window_si
-00008e80: 7a65 290a 2020 2020 2020 2020 2020 2020  ze).            
-00008e90: 2020 2020 7361 6d70 6c65 5f31 2c20 7361      sample_1, sa
-00008ea0: 6d70 6c65 5f32 203d 2064 6174 615f 7370  mple_2 = data_sp
-00008eb0: 6c69 745b 6a20 2d20 315d 2e61 7374 7970  lit[j - 1].astyp
-00008ec0: 6528 6e70 2e66 6c6f 6174 3332 292c 2064  e(np.float32), d
-00008ed0: 6174 615f 7370 6c69 745b 0a20 2020 2020  ata_split[.     
-00008ee0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
-00008ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008f00: 205d 2e61 7374 7970 6528 6e70 2e66 6c6f   ].astype(np.flo
-00008f10: 6174 3332 290a 2020 2020 2020 2020 2020  at32).          
-00008f20: 2020 2020 2020 6269 6e5f 7769 6474 682c        bin_width,
-00008f30: 2062 696e 5f63 6f75 6e74 203d 2062 7563   bin_count = buc
-00008f40: 6b65 745f 6461 7461 2864 6174 613d 7361  ket_data(data=sa
-00008f50: 6d70 6c65 5f31 2c20 6d65 7468 6f64 3d62  mple_1, method=b
-00008f60: 7563 6b65 745f 6d65 7468 6f64 290a 2020  ucket_method).  
-00008f70: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00008f80: 6d70 6c65 5f31 5f68 6973 7420 3d20 7365  mple_1_hist = se
-00008f90: 6c66 2e5f 6869 7374 5f31 6428 0a20 2020  lf._hist_1d(.   
-00008fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fb0: 2064 6174 613d 7361 6d70 6c65 5f31 2c0a   data=sample_1,.
-00008fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fd0: 2020 2020 6269 6e5f 636f 756e 743d 6269      bin_count=bi
-00008fe0: 6e5f 636f 756e 742c 0a20 2020 2020 2020  n_count,.       
-00008ff0: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-00009000: 6765 3d6e 702e 6172 7261 7928 5b30 2c20  ge=np.array([0, 
-00009010: 696e 7428 6269 6e5f 7769 6474 6820 2a20  int(bin_width * 
-00009020: 6269 6e5f 636f 756e 7429 5d29 2c0a 2020  bin_count)]),.  
-00009030: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00009040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009050: 7361 6d70 6c65 5f32 5f68 6973 7420 3d20  sample_2_hist = 
-00009060: 7365 6c66 2e5f 6869 7374 5f31 6428 0a20  self._hist_1d(. 
-00009070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009080: 2020 2064 6174 613d 7361 6d70 6c65 5f32     data=sample_2
-00009090: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000090a0: 2020 2020 2020 6269 6e5f 636f 756e 743d        bin_count=
-000090b0: 6269 6e5f 636f 756e 742c 0a20 2020 2020  bin_count,.     
-000090c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000090d0: 616e 6765 3d6e 702e 6172 7261 7928 5b30  ange=np.array([0
-000090e0: 2c20 696e 7428 6269 6e5f 7769 6474 6820  , int(bin_width 
-000090f0: 2a20 6269 6e5f 636f 756e 7429 5d29 2c0a  * bin_count)]),.
-00009100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009110: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00009120: 2020 7361 6d70 6c65 5f31 5f68 6973 742c    sample_1_hist,
-00009130: 2073 616d 706c 655f 325f 6869 7374 203d   sample_2_hist =
-00009140: 2073 616d 706c 655f 315f 6869 7374 202f   sample_1_hist /
-00009150: 206e 702e 7375 6d28 0a20 2020 2020 2020   np.sum(.       
-00009160: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-00009170: 706c 655f 315f 6869 7374 0a20 2020 2020  ple_1_hist.     
-00009180: 2020 2020 2020 2020 2020 2029 2c20 7361             ), sa
-00009190: 6d70 6c65 5f32 5f68 6973 7420 2f20 6e70  mple_2_hist / np
-000091a0: 2e73 756d 2873 616d 706c 655f 325f 6869  .sum(sample_2_hi
-000091b0: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-000091c0: 2020 2020 7720 3d20 7374 6174 732e 7761      w = stats.wa
-000091d0: 7373 6572 7374 6569 6e5f 6469 7374 616e  sserstein_distan
-000091e0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-000091f0: 2020 2020 2020 2020 755f 7661 6c75 6573          u_values
-00009200: 3d73 616d 706c 655f 315f 6869 7374 2c20  =sample_1_hist, 
-00009210: 765f 7661 6c75 6573 3d73 616d 706c 655f  v_values=sample_
-00009220: 325f 6869 7374 0a20 2020 2020 2020 2020  2_hist.         
-00009230: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00009240: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00009250: 5b77 696e 646f 775f 7374 6172 743a 7769  [window_start:wi
-00009260: 6e64 6f77 5f65 6e64 2c20 695d 203d 2077  ndow_end, i] = w
-00009270: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00009280: 2072 6573 756c 7473 0a0a 2020 2020 4073   results..    @s
-00009290: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
-000092a0: 6465 6620 746f 7461 6c5f 7661 7269 6174  def total_variat
-000092b0: 696f 6e5f 6469 7374 616e 6365 280a 2020  ion_distance(.  
-000092c0: 2020 2020 2020 783a 206e 702e 6e64 6172        x: np.ndar
-000092d0: 7261 792c 0a20 2020 2020 2020 2079 3a20  ray,.        y: 
-000092e0: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
-000092f0: 2020 2020 6275 636b 6574 5f6d 6574 686f      bucket_metho
-00009300: 643a 204f 7074 696f 6e61 6c5b 0a20 2020  d: Optional[.   
-00009310: 2020 2020 2020 2020 204c 6974 6572 616c           Literal
-00009320: 5b22 6664 222c 2022 646f 616e 6522 2c20  ["fd", "doane", 
-00009330: 2261 7574 6f22 2c20 2273 636f 7474 222c  "auto", "scott",
-00009340: 2022 7374 6f6e 6522 2c20 2272 6963 6522   "stone", "rice"
-00009350: 2c20 2273 7475 7267 6573 222c 2022 7371  , "sturges", "sq
-00009360: 7274 225d 0a20 2020 2020 2020 205d 203d  rt"].        ] =
-00009370: 2022 6175 746f 222c 0a20 2020 2029 3a0a   "auto",.    ):.
-00009380: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00009390: 2020 2020 4361 6c63 756c 6174 6520 7468      Calculate th
-000093a0: 6520 746f 7461 6c20 7661 7269 6174 696f  e total variatio
-000093b0: 6e20 6469 7374 616e 6365 2062 6574 7765  n distance betwe
-000093c0: 656e 2074 776f 2070 726f 6261 6269 6c69  en two probabili
-000093d0: 7479 2064 6973 7472 6962 7574 696f 6e73  ty distributions
-000093e0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-000093f0: 6d20 6e70 2e6e 6461 7272 6179 2078 3a20  m np.ndarray x: 
-00009400: 4120 312d 4420 6172 7261 7920 7265 7072  A 1-D array repr
-00009410: 6573 656e 7469 6e67 2074 6865 2066 6972  esenting the fir
-00009420: 7374 2073 616d 706c 652e 0a20 2020 2020  st sample..     
-00009430: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00009440: 7272 6179 2079 3a20 4120 312d 4420 6172  rray y: A 1-D ar
-00009450: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
-00009460: 2074 6865 2073 6563 6f6e 6420 7361 6d70   the second samp
-00009470: 6c65 2e0a 2020 2020 2020 2020 3a70 6172  le..        :par
-00009480: 616d 204f 7074 696f 6e61 6c5b 7374 725d  am Optional[str]
-00009490: 2062 7563 6b65 745f 6d65 7468 6f64 3a20   bucket_method: 
-000094a0: 5468 6520 6d65 7468 6f64 2075 7365 6420  The method used 
-000094b0: 746f 2064 6574 6572 6d69 6e65 2074 6865  to determine the
-000094c0: 206e 756d 6265 7220 6f66 2062 696e 7320   number of bins 
-000094d0: 666f 7220 6869 7374 6f67 7261 6d20 636f  for histogram co
-000094e0: 6d70 7574 6174 696f 6e2e 2053 7570 706f  mputation. Suppo
-000094f0: 7274 6564 206d 6574 686f 6473 2061 7265  rted methods are
-00009500: 2027 6664 2720 2846 7265 6564 6d61 6e2d   'fd' (Freedman-
-00009510: 4469 6163 6f6e 6973 292c 2027 646f 616e  Diaconis), 'doan
-00009520: 6527 2c20 2761 7574 6f27 2c20 2773 636f  e', 'auto', 'sco
-00009530: 7474 272c 2027 7374 6f6e 6527 2c20 2772  tt', 'stone', 'r
-00009540: 6963 6527 2c20 2773 7475 7267 6573 272c  ice', 'sturges',
-00009550: 2061 6e64 2027 7371 7274 272e 2044 6566   and 'sqrt'. Def
-00009560: 6175 6c74 7320 746f 2027 6175 746f 272e  aults to 'auto'.
-00009570: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00009580: 2066 6c6f 6174 3a20 5468 6520 746f 7461   float: The tota
-00009590: 6c20 7661 7269 6174 696f 6e20 6469 7374  l variation dist
-000095a0: 616e 6365 2062 6574 7765 656e 2074 6865  ance between the
-000095b0: 2074 776f 2064 6973 7472 6962 7574 696f   two distributio
-000095c0: 6e73 2e0a 0a20 2020 2020 2020 202e 2e20  ns...        .. 
-000095d0: 6d61 7468 3a3a 0a0a 2020 2020 2020 2020  math::..        
-000095e0: 2020 2054 5628 502c 2051 2920 3d20 302e     TV(P, Q) = 0.
-000095f0: 3520 5c73 756d 5f69 207c 505f 6920 2d20  5 \sum_i |P_i - 
-00009600: 515f 697c 0a0a 2020 2020 2020 2020 7768  Q_i|..        wh
-00009610: 6572 6520 3a6d 6174 683a 6050 5f69 6020  ere :math:`P_i` 
-00009620: 616e 6420 3a6d 6174 683a 6051 5f69 6020  and :math:`Q_i` 
-00009630: 6172 6520 7468 6520 7072 6f62 6162 696c  are the probabil
-00009640: 6974 6965 7320 6173 7369 676e 6564 2062  ities assigned b
-00009650: 7920 7468 6520 6469 7374 7269 6275 7469  y the distributi
-00009660: 6f6e 7320 3a6d 6174 683a 6050 6020 616e  ons :math:`P` an
-00009670: 6420 3a6d 6174 683a 6051 600a 2020 2020  d :math:`Q`.    
-00009680: 2020 2020 746f 2074 6865 2073 616d 6520      to the same 
-00009690: 6576 656e 7420 3a6d 6174 683a 6069 602c  event :math:`i`,
-000096a0: 2072 6573 7065 6374 6976 656c 792e 0a0a   respectively...
-000096b0: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-000096c0: 3a0a 2020 2020 2020 2020 3e3e 3e20 746f  :.        >>> to
-000096d0: 7461 6c5f 7661 7269 6174 696f 6e5f 6469  tal_variation_di
-000096e0: 7374 616e 6365 2878 3d6e 702e 6172 7261  stance(x=np.arra
-000096f0: 7928 5b31 2c20 352c 2031 302c 2032 302c  y([1, 5, 10, 20,
-00009700: 2035 305d 292c 2079 3d6e 702e 6172 7261   50]), y=np.arra
-00009710: 7928 5b31 2c20 352c 2031 302c 2031 3030  y([1, 5, 10, 100
-00009720: 2c20 3131 305d 2929 0a20 2020 2020 2020  , 110])).       
-00009730: 203e 3e3e 2030 2e33 3939 3939 3939 3736   >>> 0.399999976
-00009740: 3135 3831 3432 310a 2020 2020 2020 2020  1581421.        
-00009750: 2222 220a 0a20 2020 2020 2020 2063 6865  """..        che
-00009760: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
-00009770: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00009780: 3d78 2c0a 2020 2020 2020 2020 2020 2020  =x,.            
-00009790: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
-000097a0: 732e 746f 7461 6c5f 7661 7269 6174 696f  s.total_variatio
-000097b0: 6e5f 6469 7374 616e 6365 2e5f 5f6e 616d  n_distance.__nam
-000097c0: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
-000097d0: 2061 6363 6570 7465 645f 6e64 696d 733d   accepted_ndims=
-000097e0: 2831 2c29 2c0a 2020 2020 2020 2020 2020  (1,),.          
-000097f0: 2020 6163 6365 7074 6564 5f64 7479 7065    accepted_dtype
-00009800: 733d 280a 2020 2020 2020 2020 2020 2020  s=(.            
-00009810: 2020 2020 6e70 2e69 6e74 3634 2c0a 2020      np.int64,.  
-00009820: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-00009830: 2e69 6e74 3332 2c0a 2020 2020 2020 2020  .int32,.        
-00009840: 2020 2020 2020 2020 6e70 2e69 6e74 382c          np.int8,
-00009850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009860: 206e 702e 666c 6f61 7433 322c 0a20 2020   np.float32,.   
-00009870: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-00009880: 666c 6f61 7436 342c 0a20 2020 2020 2020  float64,.       
-00009890: 2020 2020 2020 2020 2069 6e74 2c0a 2020           int,.  
-000098a0: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-000098b0: 6f61 742c 0a20 2020 2020 2020 2020 2020  oat,.           
-000098c0: 2029 2c0a 2020 2020 2020 2020 290a 2020   ),.        ).  
-000098d0: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
-000098e0: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
-000098f0: 2020 2020 2064 6174 613d 792c 0a20 2020       data=y,.   
-00009900: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-00009910: 5374 6174 6973 7469 6373 2e74 6f74 616c  Statistics.total
-00009920: 5f76 6172 6961 7469 6f6e 5f64 6973 7461  _variation_dista
-00009930: 6e63 652e 5f5f 6e61 6d65 5f5f 2c0a 2020  nce.__name__,.  
-00009940: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-00009950: 6564 5f6e 6469 6d73 3d28 312c 292c 0a20  ed_ndims=(1,),. 
-00009960: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-00009970: 7465 645f 6474 7970 6573 3d28 0a20 2020  ted_dtypes=(.   
-00009980: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-00009990: 696e 7436 342c 0a20 2020 2020 2020 2020  int64,.         
-000099a0: 2020 2020 2020 206e 702e 696e 7433 322c         np.int32,
-000099b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000099c0: 206e 702e 696e 7438 2c0a 2020 2020 2020   np.int8,.      
-000099d0: 2020 2020 2020 2020 2020 6e70 2e66 6c6f            np.flo
-000099e0: 6174 3332 2c0a 2020 2020 2020 2020 2020  at32,.          
-000099f0: 2020 2020 2020 6e70 2e66 6c6f 6174 3634        np.float64
-00009a00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009a10: 2020 696e 742c 0a20 2020 2020 2020 2020    int,.         
-00009a20: 2020 2020 2020 2066 6c6f 6174 2c0a 2020         float,.  
-00009a30: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-00009a40: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
-00009a50: 6865 636b 5f73 7472 280a 2020 2020 2020  heck_str(.      
-00009a60: 2020 2020 2020 6e61 6d65 3d66 227b 5374        name=f"{St
-00009a70: 6174 6973 7469 6373 2e74 6f74 616c 5f76  atistics.total_v
-00009a80: 6172 6961 7469 6f6e 5f64 6973 7461 6e63  ariation_distanc
-00009a90: 652e 5f5f 6e61 6d65 5f5f 7d20 6d65 7468  e.__name__} meth
-00009aa0: 6f64 222c 0a20 2020 2020 2020 2020 2020  od",.           
-00009ab0: 2076 616c 7565 3d62 7563 6b65 745f 6d65   value=bucket_me
-00009ac0: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
-00009ad0: 2020 6f70 7469 6f6e 733d 4f70 7469 6f6e    options=Option
-00009ae0: 732e 4255 434b 4554 5f4d 4554 484f 4453  s.BUCKET_METHODS
-00009af0: 2e76 616c 7565 2c0a 2020 2020 2020 2020  .value,.        
-00009b00: 290a 2020 2020 2020 2020 6269 6e5f 7769  ).        bin_wi
-00009b10: 6474 682c 2062 696e 5f63 6f75 6e74 203d  dth, bin_count =
-00009b20: 2062 7563 6b65 745f 6461 7461 2864 6174   bucket_data(dat
-00009b30: 613d 782c 206d 6574 686f 643d 6275 636b  a=x, method=buck
-00009b40: 6574 5f6d 6574 686f 6429 0a20 2020 2020  et_method).     
-00009b50: 2020 2073 315f 6820 3d20 5374 6174 6973     s1_h = Statis
-00009b60: 7469 6373 2e5f 6869 7374 5f31 6428 0a20  tics._hist_1d(. 
-00009b70: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00009b80: 782c 0a20 2020 2020 2020 2020 2020 2062  x,.            b
-00009b90: 696e 5f63 6f75 6e74 3d62 696e 5f63 6f75  in_count=bin_cou
-00009ba0: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00009bb0: 7261 6e67 653d 6e70 2e61 7272 6179 285b  range=np.array([
-00009bc0: 302c 2069 6e74 2862 696e 5f77 6964 7468  0, int(bin_width
-00009bd0: 202a 2062 696e 5f63 6f75 6e74 295d 292c   * bin_count)]),
-00009be0: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
-00009bf0: 6d61 6c69 7a65 3d54 7275 652c 0a20 2020  malize=True,.   
-00009c00: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-00009c10: 325f 6820 3d20 5374 6174 6973 7469 6373  2_h = Statistics
-00009c20: 2e5f 6869 7374 5f31 6428 0a20 2020 2020  ._hist_1d(.     
-00009c30: 2020 2020 2020 2064 6174 613d 792c 0a20         data=y,. 
-00009c40: 2020 2020 2020 2020 2020 2062 696e 5f63             bin_c
-00009c50: 6f75 6e74 3d62 696e 5f63 6f75 6e74 2c0a  ount=bin_count,.
-00009c60: 2020 2020 2020 2020 2020 2020 7261 6e67              rang
-00009c70: 653d 6e70 2e61 7272 6179 285b 302c 2069  e=np.array([0, i
-00009c80: 6e74 2862 696e 5f77 6964 7468 202a 2062  nt(bin_width * b
-00009c90: 696e 5f63 6f75 6e74 295d 292c 0a20 2020  in_count)]),.   
-00009ca0: 2020 2020 2020 2020 206e 6f72 6d61 6c69           normali
-00009cb0: 7a65 3d54 7275 652c 0a20 2020 2020 2020  ze=True,.       
-00009cc0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-00009cd0: 6e20 302e 3520 2a20 6e70 2e73 756d 286e  n 0.5 * np.sum(n
-00009ce0: 702e 6162 7328 7331 5f68 202d 2073 325f  p.abs(s1_h - s2_
-00009cf0: 6829 290a 0a20 2020 2064 6566 2070 6f70  h))..    def pop
-00009d00: 756c 6174 696f 6e5f 7374 6162 696c 6974  ulation_stabilit
-00009d10: 795f 696e 6465 7828 0a20 2020 2020 2020  y_index(.       
-00009d20: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
-00009d30: 616d 706c 655f 313a 206e 702e 6e64 6172  ample_1: np.ndar
-00009d40: 7261 792c 0a20 2020 2020 2020 2073 616d  ray,.        sam
-00009d50: 706c 655f 323a 206e 702e 6e64 6172 7261  ple_2: np.ndarra
-00009d60: 792c 0a20 2020 2020 2020 2066 696c 6c5f  y,.        fill_
-00009d70: 7661 6c75 653a 204f 7074 696f 6e61 6c5b  value: Optional[
-00009d80: 696e 745d 203d 2031 2c0a 2020 2020 2020  int] = 1,.      
-00009d90: 2020 6275 636b 6574 5f6d 6574 686f 643a    bucket_method:
-00009da0: 204f 7074 696f 6e61 6c5b 0a20 2020 2020   Optional[.     
-00009db0: 2020 2020 2020 204c 6974 6572 616c 5b22         Literal["
-00009dc0: 6664 222c 2022 646f 616e 6522 2c20 2261  fd", "doane", "a
-00009dd0: 7574 6f22 2c20 2273 636f 7474 222c 2022  uto", "scott", "
-00009de0: 7374 6f6e 6522 2c20 2272 6963 6522 2c20  stone", "rice", 
-00009df0: 2273 7475 7267 6573 222c 2022 7371 7274  "sturges", "sqrt
-00009e00: 225d 0a20 2020 2020 2020 205d 203d 2022  "].        ] = "
-00009e10: 6175 746f 222c 0a20 2020 2029 202d 3e20  auto",.    ) -> 
-00009e20: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
-00009e30: 2222 0a20 2020 2020 2020 2043 6f6d 7075  "".        Compu
-00009e40: 7465 2050 6f70 756c 6174 696f 6e20 5374  te Population St
-00009e50: 6162 696c 6974 7920 496e 6465 7820 2850  ability Index (P
-00009e60: 5349 2920 636f 6d70 6172 696e 6720 7477  SI) comparing tw
-00009e70: 6f20 6469 7374 7269 6275 7469 6f6e 732e  o distributions.
-00009e80: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
-00009e90: 653a 3a0a 2020 2020 2020 2020 2020 2045  e::.           E
-00009ea0: 6d70 7479 2062 696e 7320 2830 206f 6273  mpty bins (0 obs
-00009eb0: 6572 7661 7469 6f6e 7320 696e 2062 696e  ervations in bin
-00009ec0: 2920 696e 2069 7320 7265 706c 6163 6564  ) in is replaced
-00009ed0: 2077 6974 6820 6060 6669 6c6c 5f76 616c   with ``fill_val
-00009ee0: 7565 6060 2e20 5468 6520 5053 4920 7661  ue``. The PSI va
-00009ef0: 6c75 6520 7261 6e67 6573 2066 726f 6d20  lue ranges from 
-00009f00: 3020 746f 2070 6f73 6974 6976 6520 696e  0 to positive in
-00009f10: 6669 6e69 7479 2e0a 0a20 2020 2020 2020  finity...       
-00009f20: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
-00009f30: 7261 7920 7361 6d70 6c65 5f31 3a20 4669  ray sample_1: Fi
-00009f40: 7273 7420 3164 2061 7272 6179 2072 6570  rst 1d array rep
-00009f50: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
-00009f60: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
-00009f70: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
-00009f80: 7272 6179 2073 616d 706c 655f 323a 2053  rray sample_2: S
-00009f90: 6563 6f6e 6420 3164 2061 7272 6179 2072  econd 1d array r
-00009fa0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
-00009fb0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-00009fc0: 2020 2020 3a70 6172 616d 6574 6572 204f      :parameter O
-00009fd0: 7074 696f 6e61 6c5b 696e 745d 2066 696c  ptional[int] fil
-00009fe0: 6c5f 7661 6c75 653a 2045 6d70 7479 2062  l_value: Empty b
-00009ff0: 696e 7320 2830 206f 6273 6572 7661 7469  ins (0 observati
-0000a000: 6f6e 7320 696e 2062 696e 2920 696e 2069  ons in bin) in i
-0000a010: 7320 7265 706c 6163 6564 2077 6974 6820  s replaced with 
-0000a020: 6060 6669 6c6c 5f76 616c 7565 6060 2e20  ``fill_value``. 
-0000a030: 4465 6661 756c 7420 312e 0a20 2020 2020  Default 1..     
-0000a040: 2020 203a 7061 7261 6d65 7465 7220 4c69     :parameter Li
-0000a050: 7465 7261 6c20 6275 636b 6574 5f6d 6574  teral bucket_met
-0000a060: 686f 643a 2045 7374 696d 6174 6f72 2064  hod: Estimator d
-0000a070: 6574 6572 6d69 6e69 6e67 206f 7074 696d  etermining optim
-0000a080: 616c 2062 7563 6b65 7420 636f 756e 7420  al bucket count 
-0000a090: 616e 6420 6275 636b 6574 2077 6964 7468  and bucket width
-0000a0a0: 2e20 4465 6661 756c 743a 2054 6865 206d  . Default: The m
-0000a0b0: 6178 696d 756d 206f 6620 7468 6520 5374  aximum of the St
-0000a0c0: 7572 6765 7320 616e 6420 4672 6565 646d  urges and Freedm
-0000a0d0: 616e 2d44 6961 636f 6e69 7320 6573 7469  an-Diaconis esti
-0000a0e0: 6d61 746f 7273 0a20 2020 2020 2020 203a  mators.        :
-0000a0f0: 7265 7475 726e 7320 666c 6f61 743a 2050  returns float: P
-0000a100: 5349 2064 6973 7461 6e63 6520 6265 7477  SI distance betw
-0000a110: 6565 6e20 6060 7361 6d70 6c65 5f31 6060  een ``sample_1``
-0000a120: 2061 6e64 2060 6073 616d 706c 655f 3260   and ``sample_2`
-0000a130: 600a 0a20 2020 2020 2020 203a 6578 616d  `..        :exam
-0000a140: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-0000a150: 2073 616d 706c 655f 312c 2073 616d 706c   sample_1, sampl
-0000a160: 655f 3220 3d20 6e70 2e72 616e 646f 6d2e  e_2 = np.random.
-0000a170: 7261 6e64 696e 7428 302c 2031 3030 2c20  randint(0, 100, 
-0000a180: 2831 3030 2c29 292c 206e 702e 7261 6e64  (100,)), np.rand
-0000a190: 6f6d 2e72 616e 6469 6e74 2830 2c20 3130  om.randint(0, 10
-0000a1a0: 2c20 2831 3030 2c29 290a 2020 2020 2020  , (100,)).      
-0000a1b0: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
-0000a1c0: 2829 2e70 6f70 756c 6174 696f 6e5f 7374  ().population_st
-0000a1d0: 6162 696c 6974 795f 696e 6465 7828 7361  ability_index(sa
-0000a1e0: 6d70 6c65 5f31 3d73 616d 706c 655f 312c  mple_1=sample_1,
-0000a1f0: 2073 616d 706c 655f 323d 7361 6d70 6c65   sample_2=sample
-0000a200: 5f32 2c20 6669 6c6c 5f76 616c 7565 3d31  _2, fill_value=1
-0000a210: 2c20 6275 636b 6574 5f6d 6574 686f 643d  , bucket_method=
-0000a220: 2761 7574 6f27 290a 2020 2020 2020 2020  'auto').        
-0000a230: 3e3e 3e20 332e 3936 3537 3032 3638 3637  >>> 3.9657026867
-0000a240: 3535 3338 3137 0a20 2020 2020 2020 2022  553817.        "
-0000a250: 2222 0a0a 2020 2020 2020 2020 6368 6563  ""..        chec
-0000a260: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-0000a270: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-0000a280: 7361 6d70 6c65 5f31 2c20 736f 7572 6365  sample_1, source
-0000a290: 3d73 656c 662e 5f5f 636c 6173 735f 5f2e  =self.__class__.
-0000a2a0: 5f5f 6e61 6d65 5f5f 2c20 6163 6365 7074  __name__, accept
-0000a2b0: 6564 5f73 697a 6573 3d5b 315d 0a20 2020  ed_sizes=[1].   
-0000a2c0: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
-0000a2d0: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
-0000a2e0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
-0000a2f0: 7461 3d73 616d 706c 655f 322c 2073 6f75  ta=sample_2, sou
-0000a300: 7263 653d 7365 6c66 2e5f 5f63 6c61 7373  rce=self.__class
-0000a310: 5f5f 2e5f 5f6e 616d 655f 5f2c 2061 6363  __.__name__, acc
-0000a320: 6570 7465 645f 7369 7a65 733d 5b31 5d0a  epted_sizes=[1].
-0000a330: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000a340: 2020 6368 6563 6b5f 696e 7428 6e61 6d65    check_int(name
-0000a350: 3d73 656c 662e 5f5f 636c 6173 735f 5f2e  =self.__class__.
-0000a360: 5f5f 6e61 6d65 5f5f 2c20 7661 6c75 653d  __name__, value=
-0000a370: 6669 6c6c 5f76 616c 7565 290a 2020 2020  fill_value).    
-0000a380: 2020 2020 6368 6563 6b5f 7374 7228 0a20      check_str(. 
-0000a390: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-0000a3a0: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
-0000a3b0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
-0000a3c0: 2020 2020 2076 616c 7565 3d62 7563 6b65       value=bucke
-0000a3d0: 745f 6d65 7468 6f64 2c0a 2020 2020 2020  t_method,.      
-0000a3e0: 2020 2020 2020 6f70 7469 6f6e 733d 4f70        options=Op
-0000a3f0: 7469 6f6e 732e 4255 434b 4554 5f4d 4554  tions.BUCKET_MET
-0000a400: 484f 4453 2e76 616c 7565 2c0a 2020 2020  HODS.value,.    
-0000a410: 2020 2020 290a 2020 2020 2020 2020 6269      ).        bi
-0000a420: 6e5f 7769 6474 682c 2062 696e 5f63 6f75  n_width, bin_cou
-0000a430: 6e74 203d 2062 7563 6b65 745f 6461 7461  nt = bucket_data
-0000a440: 2864 6174 613d 7361 6d70 6c65 5f31 2c20  (data=sample_1, 
-0000a450: 6d65 7468 6f64 3d62 7563 6b65 745f 6d65  method=bucket_me
-0000a460: 7468 6f64 290a 2020 2020 2020 2020 7361  thod).        sa
-0000a470: 6d70 6c65 5f31 5f68 6973 7420 3d20 7365  mple_1_hist = se
-0000a480: 6c66 2e5f 6869 7374 5f31 6428 0a20 2020  lf._hist_1d(.   
-0000a490: 2020 2020 2020 2020 2064 6174 613d 7361           data=sa
-0000a4a0: 6d70 6c65 5f31 2c0a 2020 2020 2020 2020  mple_1,.        
-0000a4b0: 2020 2020 6269 6e5f 636f 756e 743d 6269      bin_count=bi
-0000a4c0: 6e5f 636f 756e 742c 0a20 2020 2020 2020  n_count,.       
-0000a4d0: 2020 2020 2072 616e 6765 3d6e 702e 6172       range=np.ar
-0000a4e0: 7261 7928 5b30 2c20 696e 7428 6269 6e5f  ray([0, int(bin_
-0000a4f0: 7769 6474 6820 2a20 6269 6e5f 636f 756e  width * bin_coun
-0000a500: 7429 5d29 2c0a 2020 2020 2020 2020 290a  t)]),.        ).
-0000a510: 2020 2020 2020 2020 7361 6d70 6c65 5f32          sample_2
-0000a520: 5f68 6973 7420 3d20 7365 6c66 2e5f 6869  _hist = self._hi
-0000a530: 7374 5f31 6428 0a20 2020 2020 2020 2020  st_1d(.         
-0000a540: 2020 2064 6174 613d 7361 6d70 6c65 5f32     data=sample_2
-0000a550: 2c0a 2020 2020 2020 2020 2020 2020 6269  ,.            bi
-0000a560: 6e5f 636f 756e 743d 6269 6e5f 636f 756e  n_count=bin_coun
-0000a570: 742c 0a20 2020 2020 2020 2020 2020 2072  t,.            r
-0000a580: 616e 6765 3d6e 702e 6172 7261 7928 5b30  ange=np.array([0
-0000a590: 2c20 696e 7428 6269 6e5f 7769 6474 6820  , int(bin_width 
-0000a5a0: 2a20 6269 6e5f 636f 756e 7429 5d29 2c0a  * bin_count)]),.
-0000a5b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000a5c0: 2020 7361 6d70 6c65 5f31 5f68 6973 745b    sample_1_hist[
-0000a5d0: 7361 6d70 6c65 5f31 5f68 6973 7420 3d3d  sample_1_hist ==
-0000a5e0: 2030 5d20 3d20 6669 6c6c 5f76 616c 7565   0] = fill_value
-0000a5f0: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
-0000a600: 325f 6869 7374 5b73 616d 706c 655f 325f  2_hist[sample_2_
-0000a610: 6869 7374 203d 3d20 305d 203d 2066 696c  hist == 0] = fil
-0000a620: 6c5f 7661 6c75 650a 2020 2020 2020 2020  l_value.        
-0000a630: 7361 6d70 6c65 5f31 5f68 6973 742c 2073  sample_1_hist, s
-0000a640: 616d 706c 655f 325f 6869 7374 203d 2073  ample_2_hist = s
-0000a650: 616d 706c 655f 315f 6869 7374 202f 206e  ample_1_hist / n
-0000a660: 702e 7375 6d28 0a20 2020 2020 2020 2020  p.sum(.         
-0000a670: 2020 2073 616d 706c 655f 315f 6869 7374     sample_1_hist
-0000a680: 0a20 2020 2020 2020 2029 2c20 7361 6d70  .        ), samp
-0000a690: 6c65 5f32 5f68 6973 7420 2f20 6e70 2e73  le_2_hist / np.s
-0000a6a0: 756d 2873 616d 706c 655f 325f 6869 7374  um(sample_2_hist
-0000a6b0: 290a 2020 2020 2020 2020 7361 6d70 6c65  ).        sample
-0000a6c0: 735f 6469 6666 203d 2073 616d 706c 655f  s_diff = sample_
-0000a6d0: 325f 6869 7374 202d 2073 616d 706c 655f  2_hist - sample_
-0000a6e0: 315f 6869 7374 0a20 2020 2020 2020 206c  1_hist.        l
-0000a6f0: 6f67 203d 206e 702e 6c6f 6728 7361 6d70  og = np.log(samp
-0000a700: 6c65 5f32 5f68 6973 7420 2f20 7361 6d70  le_2_hist / samp
-0000a710: 6c65 5f31 5f68 6973 7429 0a20 2020 2020  le_1_hist).     
-0000a720: 2020 2072 6574 7572 6e20 6e70 2e73 756d     return np.sum
-0000a730: 2873 616d 706c 6573 5f64 6966 6620 2a20  (samples_diff * 
-0000a740: 6c6f 6729 0a0a 2020 2020 6465 6620 726f  log)..    def ro
-0000a750: 6c6c 696e 675f 706f 7075 6c61 7469 6f6e  lling_population
-0000a760: 5f73 7461 6269 6c69 7479 5f69 6e64 6578  _stability_index
-0000a770: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000a780: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
-0000a790: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-0000a7a0: 2020 7469 6d65 5f77 696e 646f 7773 3a20    time_windows: 
-0000a7b0: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
-0000a7c0: 2020 2020 6670 733a 2069 6e74 2c0a 2020      fps: int,.  
-0000a7d0: 2020 2020 2020 6669 6c6c 5f76 616c 7565        fill_value
-0000a7e0: 3a20 696e 7420 3d20 312c 0a20 2020 2020  : int = 1,.     
-0000a7f0: 2020 2062 7563 6b65 745f 6d65 7468 6f64     bucket_method
-0000a800: 3a20 4c69 7465 7261 6c5b 0a20 2020 2020  : Literal[.     
-0000a810: 2020 2020 2020 2022 6664 222c 2022 646f         "fd", "do
-0000a820: 616e 6522 2c20 2261 7574 6f22 2c20 2273  ane", "auto", "s
-0000a830: 636f 7474 222c 2022 7374 6f6e 6522 2c20  cott", "stone", 
-0000a840: 2272 6963 6522 2c20 2273 7475 7267 6573  "rice", "sturges
-0000a850: 222c 2022 7371 7274 220a 2020 2020 2020  ", "sqrt".      
-0000a860: 2020 5d20 3d20 2261 7574 6f22 2c0a 2020    ] = "auto",.  
-0000a870: 2020 2920 2d3e 206e 702e 6e64 6172 7261    ) -> np.ndarra
-0000a880: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
-0000a890: 2020 2020 2020 2043 6f6d 7075 7465 2072         Compute r
-0000a8a0: 6f6c 6c69 6e67 2050 6f70 756c 6174 696f  olling Populatio
-0000a8b0: 6e20 5374 6162 696c 6974 7920 496e 6465  n Stability Inde
-0000a8c0: 7820 2850 5349 2920 636f 6d70 6172 696e  x (PSI) comparin
-0000a8d0: 6720 7468 6520 6375 7272 656e 7420 7469  g the current ti
-0000a8e0: 6d65 2d77 696e 646f 7720 6f66 0a20 2020  me-window of.   
-0000a8f0: 2020 2020 2073 697a 6520 4e20 746f 2074       size N to t
-0000a900: 6865 2070 7265 6365 6469 6e67 2077 696e  he preceding win
-0000a910: 646f 7720 6f66 2073 697a 6520 4e2e 0a0a  dow of size N...
-0000a920: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-0000a930: 3a0a 2020 2020 2020 2020 2020 2045 6d70  :.           Emp
-0000a940: 7479 2062 696e 7320 2830 206f 6273 6572  ty bins (0 obser
-0000a950: 7661 7469 6f6e 7320 696e 2062 696e 2920  vations in bin) 
-0000a960: 696e 2069 7320 7265 706c 6163 6564 2077  in is replaced w
-0000a970: 6974 6820 6060 6669 6c6c 5f76 616c 7565  ith ``fill_value
-0000a980: 6060 2e0a 0a20 2020 2020 2020 203a 7061  ``...        :pa
-0000a990: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
-0000a9a0: 7361 6d70 6c65 5f31 3a20 4669 7273 7420  sample_1: First 
-0000a9b0: 3164 2061 7272 6179 2072 6570 7265 7365  1d array represe
-0000a9c0: 6e74 696e 6720 6665 6174 7572 6520 7661  nting feature va
-0000a9d0: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
-0000a9e0: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
-0000a9f0: 2073 616d 706c 655f 323a 2053 6563 6f6e   sample_2: Secon
-0000aa00: 6420 3164 2061 7272 6179 2072 6570 7265  d 1d array repre
-0000aa10: 7365 6e74 696e 6720 6665 6174 7572 6520  senting feature 
-0000aa20: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
-0000aa30: 3a70 6172 616d 6574 6572 2069 6e74 2066  :parameter int f
-0000aa40: 696c 6c5f 7661 6c75 653a 2045 6d70 7479  ill_value: Empty
-0000aa50: 2062 696e 7320 2830 206f 6273 6572 7661   bins (0 observa
-0000aa60: 7469 6f6e 7320 696e 2062 696e 2920 696e  tions in bin) in
-0000aa70: 2069 7320 7265 706c 6163 6564 2077 6974   is replaced wit
-0000aa80: 6820 6060 6669 6c6c 5f76 616c 7565 6060  h ``fill_value``
-0000aa90: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000aaa0: 6574 6572 204c 6974 6572 616c 2062 7563  eter Literal buc
-0000aab0: 6b65 745f 6d65 7468 6f64 3a20 4573 7469  ket_method: Esti
-0000aac0: 6d61 746f 7220 6465 7465 726d 696e 696e  mator determinin
-0000aad0: 6720 6f70 7469 6d61 6c20 6275 636b 6574  g optimal bucket
-0000aae0: 2063 6f75 6e74 2061 6e64 2062 7563 6b65   count and bucke
-0000aaf0: 7420 7769 6474 682e 2044 6566 6175 6c74  t width. Default
-0000ab00: 3a20 5468 6520 6d61 7869 6d75 6d20 6f66  : The maximum of
-0000ab10: 2074 6865 2053 7475 7267 6573 2061 6e64   the Sturges and
-0000ab20: 2046 7265 6564 6d61 6e2d 4469 6163 6f6e   Freedman-Diacon
-0000ab30: 6973 2065 7374 696d 6174 6f72 730a 2020  is estimators.  
-0000ab40: 2020 2020 2020 3a72 6574 7572 6e73 206e        :returns n
-0000ab50: 702e 6e64 6172 7261 793a 2050 5349 2064  p.ndarray: PSI d
-0000ab60: 6174 6120 6f66 2073 697a 6520 6c65 6e28  ata of size len(
-0000ab70: 6461 7461 2920 7820 6c65 6e28 7469 6d65  data) x len(time
-0000ab80: 5f77 696e 646f 7773 292e 0a20 2020 2020  _windows)..     
-0000ab90: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0000aba0: 7265 7375 6c74 7320 3d20 6e70 2e66 756c  results = np.ful
-0000abb0: 6c28 2864 6174 612e 7368 6170 655b 305d  l((data.shape[0]
-0000abc0: 2c20 7469 6d65 5f77 696e 646f 7773 2e73  , time_windows.s
-0000abd0: 6861 7065 5b30 5d29 2c20 302e 3029 0a20  hape[0]), 0.0). 
-0000abe0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0000abf0: 7072 616e 6765 2874 696d 655f 7769 6e64  prange(time_wind
-0000ac00: 6f77 732e 7368 6170 655b 305d 293a 0a20  ows.shape[0]):. 
-0000ac10: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-0000ac20: 775f 7369 7a65 203d 2069 6e74 2874 696d  w_size = int(tim
-0000ac30: 655f 7769 6e64 6f77 735b 695d 202a 2066  e_windows[i] * f
-0000ac40: 7073 290a 2020 2020 2020 2020 2020 2020  ps).            
-0000ac50: 6461 7461 5f73 706c 6974 203d 206e 702e  data_split = np.
-0000ac60: 7370 6c69 7428 0a20 2020 2020 2020 2020  split(.         
-0000ac70: 2020 2020 2020 2064 6174 612c 206c 6973         data, lis
-0000ac80: 7428 7261 6e67 6528 7769 6e64 6f77 5f73  t(range(window_s
-0000ac90: 697a 652c 2064 6174 612e 7368 6170 655b  ize, data.shape[
-0000aca0: 305d 2c20 7769 6e64 6f77 5f73 697a 6529  0], window_size)
-0000acb0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-0000acc0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000acd0: 6a20 696e 2070 7261 6e67 6528 312c 206c  j in prange(1, l
-0000ace0: 656e 2864 6174 615f 7370 6c69 7429 293a  en(data_split)):
-0000acf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ad00: 2077 696e 646f 775f 7374 6172 7420 3d20   window_start = 
-0000ad10: 696e 7428 7769 6e64 6f77 5f73 697a 6520  int(window_size 
-0000ad20: 2a20 6a29 0a20 2020 2020 2020 2020 2020  * j).           
-0000ad30: 2020 2020 2077 696e 646f 775f 656e 6420       window_end 
-0000ad40: 3d20 696e 7428 7769 6e64 6f77 5f73 7461  = int(window_sta
-0000ad50: 7274 202b 2077 696e 646f 775f 7369 7a65  rt + window_size
-0000ad60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000ad70: 2020 7361 6d70 6c65 5f31 2c20 7361 6d70    sample_1, samp
-0000ad80: 6c65 5f32 203d 2064 6174 615f 7370 6c69  le_2 = data_spli
-0000ad90: 745b 6a20 2d20 315d 2e61 7374 7970 6528  t[j - 1].astype(
-0000ada0: 6e70 2e66 6c6f 6174 3332 292c 2064 6174  np.float32), dat
-0000adb0: 615f 7370 6c69 745b 0a20 2020 2020 2020  a_split[.       
-0000adc0: 2020 2020 2020 2020 2020 2020 206a 0a20               j. 
-0000add0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0000ade0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0000adf0: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
-0000ae00: 2020 2020 6269 6e5f 7769 6474 682c 2062      bin_width, b
-0000ae10: 696e 5f63 6f75 6e74 203d 2062 7563 6b65  in_count = bucke
-0000ae20: 745f 6461 7461 2864 6174 613d 7361 6d70  t_data(data=samp
-0000ae30: 6c65 5f31 2c20 6d65 7468 6f64 3d62 7563  le_1, method=buc
-0000ae40: 6b65 745f 6d65 7468 6f64 290a 2020 2020  ket_method).    
-0000ae50: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-0000ae60: 6c65 5f31 5f68 6973 7420 3d20 7365 6c66  le_1_hist = self
-0000ae70: 2e5f 6869 7374 5f31 6428 0a20 2020 2020  ._hist_1d(.     
-0000ae80: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000ae90: 6174 613d 7361 6d70 6c65 5f31 2c0a 2020  ata=sample_1,.  
-0000aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aeb0: 2020 6269 6e5f 636f 756e 743d 6269 6e5f    bin_count=bin_
-0000aec0: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
-0000aed0: 2020 2020 2020 2020 2020 2072 616e 6765             range
-0000aee0: 3d6e 702e 6172 7261 7928 5b30 2c20 696e  =np.array([0, in
-0000aef0: 7428 6269 6e5f 7769 6474 6820 2a20 6269  t(bin_width * bi
-0000af00: 6e5f 636f 756e 7429 5d29 2c0a 2020 2020  n_count)]),.    
-0000af10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000af20: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-0000af30: 6d70 6c65 5f32 5f68 6973 7420 3d20 7365  mple_2_hist = se
-0000af40: 6c66 2e5f 6869 7374 5f31 6428 0a20 2020  lf._hist_1d(.   
-0000af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af60: 2064 6174 613d 7361 6d70 6c65 5f32 2c0a   data=sample_2,.
-0000af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af80: 2020 2020 6269 6e5f 636f 756e 743d 6269      bin_count=bi
-0000af90: 6e5f 636f 756e 742c 0a20 2020 2020 2020  n_count,.       
-0000afa0: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-0000afb0: 6765 3d6e 702e 6172 7261 7928 5b30 2c20  ge=np.array([0, 
-0000afc0: 696e 7428 6269 6e5f 7769 6474 6820 2a20  int(bin_width * 
-0000afd0: 6269 6e5f 636f 756e 7429 5d29 2c0a 2020  bin_count)]),.  
-0000afe0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000aff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b000: 7361 6d70 6c65 5f31 5f68 6973 745b 7361  sample_1_hist[sa
-0000b010: 6d70 6c65 5f31 5f68 6973 7420 3d3d 2030  mple_1_hist == 0
-0000b020: 5d20 3d20 6669 6c6c 5f76 616c 7565 0a20  ] = fill_value. 
-0000b030: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000b040: 616d 706c 655f 325f 6869 7374 5b73 616d  ample_2_hist[sam
-0000b050: 706c 655f 325f 6869 7374 203d 3d20 305d  ple_2_hist == 0]
-0000b060: 203d 2066 696c 6c5f 7661 6c75 650a 2020   = fill_value.  
-0000b070: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-0000b080: 6d70 6c65 5f31 5f68 6973 742c 2073 616d  mple_1_hist, sam
-0000b090: 706c 655f 325f 6869 7374 203d 2073 616d  ple_2_hist = sam
-0000b0a0: 706c 655f 315f 6869 7374 202f 206e 702e  ple_1_hist / np.
-0000b0b0: 7375 6d28 0a20 2020 2020 2020 2020 2020  sum(.           
-0000b0c0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-0000b0d0: 315f 6869 7374 0a20 2020 2020 2020 2020  1_hist.         
-0000b0e0: 2020 2020 2020 2029 2c20 7361 6d70 6c65         ), sample
-0000b0f0: 5f32 5f68 6973 7420 2f20 6e70 2e73 756d  _2_hist / np.sum
-0000b100: 2873 616d 706c 655f 325f 6869 7374 290a  (sample_2_hist).
-0000b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b120: 7361 6d70 6c65 735f 6469 6666 203d 2073  samples_diff = s
-0000b130: 616d 706c 655f 325f 6869 7374 202d 2073  ample_2_hist - s
-0000b140: 616d 706c 655f 315f 6869 7374 0a20 2020  ample_1_hist.   
-0000b150: 2020 2020 2020 2020 2020 2020 206c 6f67               log
-0000b160: 203d 206e 702e 6c6f 6728 7361 6d70 6c65   = np.log(sample
-0000b170: 5f32 5f68 6973 7420 2f20 7361 6d70 6c65  _2_hist / sample
-0000b180: 5f31 5f68 6973 7429 0a20 2020 2020 2020  _1_hist).       
-0000b190: 2020 2020 2020 2020 2070 7369 203d 206e           psi = n
-0000b1a0: 702e 7375 6d28 7361 6d70 6c65 735f 6469  p.sum(samples_di
-0000b1b0: 6666 202a 206c 6f67 290a 2020 2020 2020  ff * log).      
-0000b1c0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0000b1d0: 735b 7769 6e64 6f77 5f73 7461 7274 3a77  s[window_start:w
-0000b1e0: 696e 646f 775f 656e 642c 2069 5d20 3d20  indow_end, i] = 
-0000b1f0: 7073 690a 0a20 2020 2020 2020 2072 6574  psi..        ret
-0000b200: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
-0000b210: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-0000b220: 2020 2040 6e6a 6974 2822 2866 6c6f 6174     @njit("(float
-0000b230: 3634 5b3a 5d2c 2066 6c6f 6174 3634 5b3a  64[:], float64[:
-0000b240: 5d29 222c 2063 6163 6865 3d54 7275 6529  ])", cache=True)
-0000b250: 0a20 2020 2064 6566 206b 7275 736b 616c  .    def kruskal
-0000b260: 5f77 616c 6c69 7328 7361 6d70 6c65 5f31  _wallis(sample_1
-0000b270: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
-0000b280: 6d70 6c65 5f32 3a20 6e70 2e6e 6461 7272  mple_2: np.ndarr
-0000b290: 6179 2920 2d3e 2066 6c6f 6174 3a0a 2020  ay) -> float:.  
-0000b2a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000b2b0: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
-0000b2c0: 206f 6620 4b72 7573 6b61 6c2d 5761 6c6c   of Kruskal-Wall
-0000b2d0: 6973 2048 2062 6574 7765 656e 2074 776f  is H between two
-0000b2e0: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
-0000b2f0: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0000b300: 7465 7220 6e64 6172 7261 7920 7361 6d70  ter ndarray samp
-0000b310: 6c65 5f31 3a20 4669 7273 7420 3164 2061  le_1: First 1d a
-0000b320: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
-0000b330: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
-0000b340: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000b350: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
-0000b360: 706c 655f 323a 2053 6563 6f6e 6420 3164  ple_2: Second 1d
-0000b370: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
-0000b380: 696e 6720 6665 6174 7572 6520 7661 6c75  ing feature valu
-0000b390: 6573 2e0a 2020 2020 2020 2020 3a72 6574  es..        :ret
-0000b3a0: 7572 6e73 2066 6c6f 6174 3a20 4b72 7573  urns float: Krus
-0000b3b0: 6b61 6c2d 5761 6c6c 6973 2048 2e0a 0a20  kal-Wallis H... 
-0000b3c0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-0000b3d0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
-0000b3e0: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
-0000b3f0: 285b 312c 2031 2c20 332c 2034 2c20 355d  ([1, 1, 3, 4, 5]
-0000b400: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
-0000b410: 7436 3429 0a20 2020 2020 2020 203e 3e3e  t64).        >>>
-0000b420: 2073 616d 706c 655f 3220 3d20 6e70 2e61   sample_2 = np.a
-0000b430: 7272 6179 285b 362c 2037 2c20 382c 2039  rray([6, 7, 8, 9
-0000b440: 2c20 3130 5d29 2e61 7374 7970 6528 6e70  , 10]).astype(np
-0000b450: 2e66 6c6f 6174 3634 290a 2020 2020 2020  .float64).      
-0000b460: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
-0000b470: 2829 2e6b 7275 736b 616c 5f77 616c 6c69  ().kruskal_walli
-0000b480: 7328 7361 6d70 6c65 5f31 3d73 616d 706c  s(sample_1=sampl
-0000b490: 655f 312c 2073 616d 706c 655f 323d 7361  e_1, sample_2=sa
-0000b4a0: 6d70 6c65 5f32 290a 2020 2020 2020 2020  mple_2).        
-0000b4b0: 3e3e 3e20 3339 2e34 0a20 2020 2020 2020  >>> 39.4.       
-0000b4c0: 2022 2222 0a0a 2020 2020 2020 2020 2320   """..        # 
-0000b4d0: 7361 6d70 6c65 5f31 203d 206e 702e 636f  sample_1 = np.co
-0000b4e0: 6e63 6174 656e 6174 6528 286e 702e 7a65  ncatenate((np.ze
-0000b4f0: 726f 7328 2873 616d 706c 655f 312e 7368  ros((sample_1.sh
-0000b500: 6170 655b 305d 2c20 3129 292c 2073 616d  ape[0], 1)), sam
-0000b510: 706c 655f 312e 7265 7368 6170 6528 2d31  ple_1.reshape(-1
-0000b520: 2c20 3129 292c 2061 7869 733d 3129 0a20  , 1)), axis=1). 
-0000b530: 2020 2020 2020 2023 2073 616d 706c 655f         # sample_
-0000b540: 3220 3d20 6e70 2e63 6f6e 6361 7465 6e61  2 = np.concatena
-0000b550: 7465 2828 6e70 2e6f 6e65 7328 2873 616d  te((np.ones((sam
-0000b560: 706c 655f 322e 7368 6170 655b 305d 2c20  ple_2.shape[0], 
-0000b570: 3129 292c 2073 616d 706c 655f 322e 7265  1)), sample_2.re
-0000b580: 7368 6170 6528 2d31 2c20 3129 292c 2061  shape(-1, 1)), a
-0000b590: 7869 733d 3129 0a20 2020 2020 2020 2064  xis=1).        d
-0000b5a0: 6174 6120 3d20 6e70 2e76 7374 6163 6b28  ata = np.vstack(
-0000b5b0: 2873 616d 706c 655f 312c 2073 616d 706c  (sample_1, sampl
-0000b5c0: 655f 3229 290a 2020 2020 2020 2020 7261  e_2)).        ra
-0000b5d0: 6e6b 7320 3d20 6661 7374 5f6d 6561 6e5f  nks = fast_mean_
-0000b5e0: 7261 6e6b 2864 6174 613d 6461 7461 5b3a  rank(data=data[:
-0000b5f0: 2c20 315d 2c20 6465 7363 656e 6469 6e67  , 1], descending
-0000b600: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-0000b610: 6461 7461 203d 206e 702e 6873 7461 636b  data = np.hstack
-0000b620: 2828 6461 7461 2c20 7261 6e6b 732e 7265  ((data, ranks.re
-0000b630: 7368 6170 6528 2d31 2c20 3129 2929 0a20  shape(-1, 1))). 
-0000b640: 2020 2020 2020 2073 616d 706c 655f 315f         sample_1_
-0000b650: 7375 6d6d 6564 5f72 616e 6b20 3d20 6e70  summed_rank = np
-0000b660: 2e73 756d 2864 6174 615b 3020 3a20 7361  .sum(data[0 : sa
-0000b670: 6d70 6c65 5f31 2e73 6861 7065 5b30 5d2c  mple_1.shape[0],
-0000b680: 2032 5d2e 666c 6174 7465 6e28 2929 0a20   2].flatten()). 
-0000b690: 2020 2020 2020 2073 616d 706c 655f 325f         sample_2_
-0000b6a0: 7375 6d6d 6564 5f72 616e 6b20 3d20 6e70  summed_rank = np
-0000b6b0: 2e73 756d 2864 6174 615b 7361 6d70 6c65  .sum(data[sample
-0000b6c0: 5f31 2e73 6861 7065 5b30 5d20 3a2c 2032  _1.shape[0] :, 2
-0000b6d0: 5d2e 666c 6174 7465 6e28 2929 0a20 2020  ].flatten()).   
-0000b6e0: 2020 2020 2068 3120 3d20 3132 202f 2028       h1 = 12 / (
-0000b6f0: 6461 7461 2e73 6861 7065 5b30 5d20 2a20  data.shape[0] * 
-0000b700: 2864 6174 612e 7368 6170 655b 305d 202b  (data.shape[0] +
-0000b710: 2031 2929 0a20 2020 2020 2020 2068 3220   1)).        h2 
-0000b720: 3d20 286e 702e 7371 7561 7265 2873 616d  = (np.square(sam
-0000b730: 706c 655f 315f 7375 6d6d 6564 5f72 616e  ple_1_summed_ran
-0000b740: 6b29 202f 2073 616d 706c 655f 312e 7368  k) / sample_1.sh
-0000b750: 6170 655b 305d 2920 2b20 280a 2020 2020  ape[0]) + (.    
-0000b760: 2020 2020 2020 2020 6e70 2e73 7175 6172          np.squar
-0000b770: 6528 7361 6d70 6c65 5f32 5f73 756d 6d65  e(sample_2_summe
-0000b780: 645f 7261 6e6b 2920 2f20 7361 6d70 6c65  d_rank) / sample
-0000b790: 5f32 2e73 6861 7065 5b30 5d0a 2020 2020  _2.shape[0].    
-0000b7a0: 2020 2020 290a 2020 2020 2020 2020 6833      ).        h3
-0000b7b0: 203d 2033 202a 2028 6461 7461 2e73 6861   = 3 * (data.sha
-0000b7c0: 7065 5b30 5d20 2b20 3129 0a20 2020 2020  pe[0] + 1).     
-0000b7d0: 2020 2072 6574 7572 6e20 6831 202a 2068     return h1 * h
-0000b7e0: 3220 2d20 6833 0a0a 2020 2020 4073 7461  2 - h3..    @sta
-0000b7f0: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
-0000b800: 6620 7063 745f 696e 5f74 6f70 5f6e 2878  f pct_in_top_n(x
-0000b810: 3a20 6e70 2e6e 6461 7272 6179 2c20 6e3a  : np.ndarray, n:
-0000b820: 2066 6c6f 6174 2920 2d3e 2066 6c6f 6174   float) -> float
-0000b830: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000b840: 2020 2020 2020 436f 6d70 7574 6520 7065        Compute pe
-0000b850: 7263 656e 7461 6765 206f 6620 656c 656d  rcentage of elem
-0000b860: 656e 7473 2069 6e20 7468 6520 746f 7020  ents in the top 
-0000b870: 276e 2720 6672 6571 7565 6e63 6965 7320  'n' frequencies 
-0000b880: 696e 2074 6865 2069 6e70 7574 2e0a 0a20  in the input... 
-0000b890: 2020 2020 2020 203a 7061 7261 6d20 783a         :param x:
-0000b8a0: 2049 6e70 7574 2061 7272 6179 2e0a 2020   Input array..  
-0000b8b0: 2020 2020 2020 3a70 6172 616d 206e 3a20        :param n: 
-0000b8c0: 4e75 6d62 6572 206f 6620 746f 7020 6672  Number of top fr
-0000b8d0: 6571 7565 6e63 6965 732e 0a20 2020 2020  equencies..     
-0000b8e0: 2020 203a 7265 7475 726e 3a20 5065 7263     :return: Perc
-0000b8f0: 656e 7461 6765 206f 6620 656c 656d 656e  entage of elemen
-0000b900: 7473 2069 6e20 7468 6520 746f 7020 276e  ts in the top 'n
-0000b910: 2720 6672 6571 7565 6e63 6965 732e 0a0a  ' frequencies...
-0000b920: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-0000b930: 3a0a 2020 2020 2020 2020 3e3e 3e20 7820  :.        >>> x 
-0000b940: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-0000b950: 696e 7428 302c 2031 302c 2028 3130 302c  int(0, 10, (100,
-0000b960: 2929 0a20 2020 2020 2020 203e 3e3e 2053  )).        >>> S
-0000b970: 7461 7469 7374 6963 732e 7063 745f 696e  tatistics.pct_in
-0000b980: 5f74 6f70 5f6e 2878 3d78 2c20 6e3d 3529  _top_n(x=x, n=5)
-0000b990: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-0000b9a0: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
-0000b9b0: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
-0000b9c0: 2020 2020 2064 6174 613d 782c 2061 6363       data=x, acc
-0000b9d0: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
-0000b9e0: 2c20 736f 7572 6365 3d53 7461 7469 7374  , source=Statist
-0000b9f0: 6963 732e 7063 745f 696e 5f74 6f70 5f6e  ics.pct_in_top_n
-0000ba00: 2e5f 5f6e 616d 655f 5f0a 2020 2020 2020  .__name__.      
-0000ba10: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
-0000ba20: 6b5f 696e 7428 6e61 6d65 3d53 7461 7469  k_int(name=Stati
-0000ba30: 7374 6963 732e 7063 745f 696e 5f74 6f70  stics.pct_in_top
-0000ba40: 5f6e 2e5f 5f6e 616d 655f 5f2c 2076 616c  _n.__name__, val
-0000ba50: 7565 3d6e 2c20 6d61 785f 7661 6c75 653d  ue=n, max_value=
-0000ba60: 782e 7368 6170 655b 305d 290a 2020 2020  x.shape[0]).    
-0000ba70: 2020 2020 636e 7473 203d 206e 702e 736f      cnts = np.so
-0000ba80: 7274 286e 702e 756e 6971 7565 2878 2c20  rt(np.unique(x, 
-0000ba90: 7265 7475 726e 5f63 6f75 6e74 733d 5472  return_counts=Tr
-0000baa0: 7565 295b 315d 295b 2d6e 3a5d 0a20 2020  ue)[1])[-n:].   
-0000bab0: 2020 2020 2072 6574 7572 6e20 6e70 2e73       return np.s
-0000bac0: 756d 2863 6e74 7329 202f 2078 2e73 6861  um(cnts) / x.sha
-0000bad0: 7065 5b30 5d0a 0a20 2020 2040 7374 6174  pe[0]..    @stat
-0000bae0: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-0000baf0: 6974 2822 2866 6c6f 6174 3634 5b3a 5d2c  it("(float64[:],
-0000bb00: 2066 6c6f 6174 3634 5b3a 5d29 222c 2063   float64[:])", c
-0000bb10: 6163 6865 3d54 7275 6529 0a20 2020 2064  ache=True).    d
-0000bb20: 6566 206d 616e 6e5f 7768 6974 6e65 7928  ef mann_whitney(
-0000bb30: 7361 6d70 6c65 5f31 3a20 6e70 2e6e 6461  sample_1: np.nda
-0000bb40: 7272 6179 2c20 7361 6d70 6c65 5f32 3a20  rray, sample_2: 
-0000bb50: 6e70 2e6e 6461 7272 6179 2920 2d3e 2066  np.ndarray) -> f
-0000bb60: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
-0000bb70: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
-0000bb80: 2063 6f6d 7075 7465 206f 6620 4d61 6e6e   compute of Mann
-0000bb90: 2d57 6869 746e 6579 2055 2062 6574 7765  -Whitney U betwe
-0000bba0: 656e 2074 776f 2064 6973 7472 6962 7574  en two distribut
-0000bbb0: 696f 6e73 2e0a 0a20 2020 2020 2020 203a  ions...        :
-0000bbc0: 7061 7261 6d65 7465 7220 6e64 6172 7261  parameter ndarra
-0000bbd0: 7920 7361 6d70 6c65 5f31 3a20 4669 7273  y sample_1: Firs
-0000bbe0: 7420 3164 2061 7272 6179 2072 6570 7265  t 1d array repre
-0000bbf0: 7365 6e74 696e 6720 6665 6174 7572 6520  senting feature 
-0000bc00: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
-0000bc10: 3a70 6172 616d 6574 6572 206e 6461 7272  :parameter ndarr
-0000bc20: 6179 2073 616d 706c 655f 323a 2053 6563  ay sample_2: Sec
-0000bc30: 6f6e 6420 3164 2061 7272 6179 2072 6570  ond 1d array rep
-0000bc40: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
-0000bc50: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
-0000bc60: 2020 3a72 6574 7572 6e73 2066 6c6f 6174    :returns float
-0000bc70: 3a20 4d61 6e6e 2d57 6869 746e 6579 2055  : Mann-Whitney U
-0000bc80: 2e0a 0a20 2020 2020 2020 203a 7265 6665  ...        :refe
-0000bc90: 7265 6e63 6573 3a0a 2020 2020 2020 2020  rences:.        
-0000bca0: 2020 2020 604d 6f64 6966 6965 6420 6672      `Modified fr
-0000bcb0: 6f6d 204a 616d 6573 2057 6562 6265 7220  om James Webber 
-0000bcc0: 6769 7374 206f 6e20 4769 7448 7562 203c  gist on GitHub <
-0000bcd0: 6874 7470 733a 2f2f 6769 7374 2e67 6974  https://gist.git
-0000bce0: 6875 622e 636f 6d2f 6a61 6d65 7374 7765  hub.com/jamestwe
-0000bcf0: 6262 6572 2f33 3861 6232 3664 3238 3166  bber/38ab26d281f
-0000bd00: 3937 6665 6238 3139 3662 3364 3933 6564  97feb8196b3d93ed
-0000bd10: 6565 6237 623e 605f 5f2e 0a0a 2020 2020  eeb7b>`__...    
-0000bd20: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-0000bd30: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-0000bd40: 5f31 203d 206e 702e 6172 7261 7928 5b31  _1 = np.array([1
-0000bd50: 2c20 312c 2033 2c20 342c 2035 5d29 0a20  , 1, 3, 4, 5]). 
-0000bd60: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-0000bd70: 655f 3220 3d20 6e70 2e61 7272 6179 285b  e_2 = np.array([
-0000bd80: 362c 2037 2c20 382c 2039 2c20 3130 5d29  6, 7, 8, 9, 10])
-0000bd90: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-0000bda0: 756c 7473 203d 2053 7461 7469 7374 6963  ults = Statistic
-0000bdb0: 7328 292e 6d61 6e6e 5f77 6869 746e 6579  s().mann_whitney
-0000bdc0: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-0000bdd0: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-0000bde0: 706c 655f 3229 0a20 2020 2020 2020 2022  ple_2).        "
-0000bdf0: 2222 0a0a 2020 2020 2020 2020 6e31 2c20  ""..        n1, 
-0000be00: 6e32 203d 2073 616d 706c 655f 312e 7368  n2 = sample_1.sh
-0000be10: 6170 655b 305d 2c20 7361 6d70 6c65 5f32  ape[0], sample_2
-0000be20: 2e73 6861 7065 5b30 5d0a 2020 2020 2020  .shape[0].      
-0000be30: 2020 7261 6e6b 6564 203d 2066 6173 745f    ranked = fast_
-0000be40: 6d65 616e 5f72 616e 6b28 6e70 2e63 6f6e  mean_rank(np.con
-0000be50: 6361 7465 6e61 7465 2828 7361 6d70 6c65  catenate((sample
-0000be60: 5f31 2c20 7361 6d70 6c65 5f32 2929 290a  _1, sample_2))).
-0000be70: 2020 2020 2020 2020 7531 203d 206e 3120          u1 = n1 
-0000be80: 2a20 6e32 202b 2028 6e31 202a 2028 6e31  * n2 + (n1 * (n1
-0000be90: 202b 2031 2929 202f 2032 2e30 202d 206e   + 1)) / 2.0 - n
-0000bea0: 702e 7375 6d28 7261 6e6b 6564 5b3a 6e31  p.sum(ranked[:n1
-0000beb0: 5d2c 2061 7869 733d 3029 0a20 2020 2020  ], axis=0).     
-0000bec0: 2020 2075 3220 3d20 6e31 202a 206e 3220     u2 = n1 * n2 
-0000bed0: 2d20 7531 0a20 2020 2020 2020 2072 6574  - u1.        ret
-0000bee0: 7572 6e20 6d69 6e28 7531 2c20 7532 290a  urn min(u1, u2).
-0000bef0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0000bf00: 6f64 0a20 2020 2040 6a69 7428 6e6f 7079  od.    @jit(nopy
-0000bf10: 7468 6f6e 3d54 7275 652c 2063 6163 6865  thon=True, cache
-0000bf20: 3d54 7275 6529 0a20 2020 2064 6566 206c  =True).    def l
-0000bf30: 6576 656e 6573 280a 2020 2020 2020 2020  evenes(.        
-0000bf40: 7361 6d70 6c65 5f31 3a20 6e70 2e6e 6461  sample_1: np.nda
-0000bf50: 7272 6179 2c0a 2020 2020 2020 2020 7361  rray,.        sa
-0000bf60: 6d70 6c65 5f32 3a20 6e70 2e6e 6461 7272  mple_2: np.ndarr
-0000bf70: 6179 2c0a 2020 2020 2020 2020 6372 6974  ay,.        crit
-0000bf80: 6963 616c 5f76 616c 7565 733a 204f 7074  ical_values: Opt
-0000bf90: 696f 6e61 6c5b 6e70 2e6e 6461 7272 6179  ional[np.ndarray
-0000bfa0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-0000bfb0: 2d3e 2028 666c 6f61 742c 2055 6e69 6f6e  -> (float, Union
-0000bfc0: 5b62 6f6f 6c2c 204e 6f6e 655d 293a 0a20  [bool, None]):. 
-0000bfd0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000bfe0: 2020 204a 6974 7465 6420 636f 6d70 7574     Jitted comput
-0000bff0: 6520 6f66 2074 776f 2d73 616d 706c 6520  e of two-sample 
-0000c000: 4c65 7665 6e27 7320 572e 0a0a 2020 2020  Leven's W...    
-0000c010: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-0000c020: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
-0000c030: 2046 6972 7374 2031 6420 6172 7261 7920   First 1d array 
-0000c040: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
-0000c050: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
-0000c060: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-0000c070: 6e64 6172 7261 7920 7361 6d70 6c65 5f32  ndarray sample_2
-0000c080: 3a20 5365 636f 6e64 2031 6420 6172 7261  : Second 1d arra
-0000c090: 7920 7265 7072 6573 656e 7469 6e67 2066  y representing f
-0000c0a0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
-0000c0b0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-0000c0c0: 7220 6e64 6172 7261 7920 6372 6974 6963  r ndarray critic
-0000c0d0: 616c 5f76 616c 7565 733a 2032 4420 6172  al_values: 2D ar
-0000c0e0: 7261 7920 7769 7468 2077 6865 7265 2066  ray with where f
-0000c0f0: 6972 7374 2063 6f6c 756d 6e20 7265 7072  irst column repr
-0000c100: 6573 656e 7420 6466 6e20 6669 7273 7420  esent dfn first 
-0000c110: 726f 7720 6466 6420 7769 7468 2076 616c  row dfd with val
-0000c120: 7565 7320 7265 7072 6573 656e 7420 6372  ues represent cr
-0000c130: 6974 6963 616c 2076 616c 7565 732e 0a20  itical values.. 
-0000c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c160: 2020 2020 2020 2020 2020 2043 616e 2062             Can b
-0000c170: 6520 666f 756e 6420 696e 2060 6073 696d  e found in ``sim
-0000c180: 6261 2e61 7373 6574 732e 6372 6974 6963  ba.assets.critic
-0000c190: 616c 5f76 616c 7565 735f 3035 2e70 6963  al_values_05.pic
-0000c1a0: 6b6c 6560 600a 0a20 2020 2020 2020 203a  kle``..        :
-0000c1b0: 7265 7475 726e 7320 666c 6f61 743a 204c  returns float: L
-0000c1c0: 6576 656e 2773 2057 2e0a 0a20 2020 2020  even's W...     
-0000c1d0: 2020 203a 6578 616d 706c 6573 3a0a 2020     :examples:.  
-0000c1e0: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-0000c1f0: 5f31 203d 206e 702e 6172 7261 7928 6c69  _1 = np.array(li
-0000c200: 7374 2872 616e 6765 2830 2c20 3530 2929  st(range(0, 50))
-0000c210: 290a 2020 2020 2020 2020 3e3e 3e20 7361  ).        >>> sa
-0000c220: 6d70 6c65 5f32 203d 206e 702e 6172 7261  mple_2 = np.arra
-0000c230: 7928 6c69 7374 2872 616e 6765 2832 352c  y(list(range(25,
-0000c240: 2031 3030 2929 290a 2020 2020 2020 2020   100))).        
-0000c250: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
-0000c260: 2e6c 6576 656e 6573 2873 616d 706c 655f  .levenes(sample_
-0000c270: 313d 7361 6d70 6c65 5f31 2c20 7361 6d70  1=sample_1, samp
-0000c280: 6c65 5f32 3d73 616d 706c 655f 3229 0a20  le_2=sample_2). 
-0000c290: 2020 2020 2020 203e 3e3e 2031 322e 3633         >>> 12.63
-0000c2a0: 3930 3931 3038 3930 3332 3534 0a20 2020  909108903254.   
-0000c2b0: 2020 2020 203e 3e3e 2063 7269 7469 6361       >>> critica
-0000c2c0: 6c5f 7661 6c75 6573 203d 2070 6963 6b6c  l_values = pickl
-0000c2d0: 652e 6c6f 6164 286f 7065 6e28 2273 696d  e.load(open("sim
-0000c2e0: 6261 2f61 7373 6574 732f 6c6f 6f6b 7570  ba/assets/lookup
-0000c2f0: 732f 6372 6974 6963 616c 5f76 616c 7565  s/critical_value
-0000c300: 735f 352e 7069 636b 6c65 222c 2272 6222  s_5.pickle","rb"
-0000c310: 2929 5b27 6627 5d5b 276f 6e65 5f74 6169  ))['f']['one_tai
-0000c320: 6c27 5d2e 7661 6c75 6573 0a20 2020 2020  l'].values.     
-0000c330: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
-0000c340: 7328 292e 6c65 7665 6e65 7328 7361 6d70  s().levenes(samp
-0000c350: 6c65 5f31 3d73 616d 706c 655f 312c 2073  le_1=sample_1, s
-0000c360: 616d 706c 655f 323d 7361 6d70 6c65 5f32  ample_2=sample_2
-0000c370: 2c20 6372 6974 6963 616c 5f76 616c 7565  , critical_value
-0000c380: 733d 6372 6974 6963 616c 5f76 616c 7565  s=critical_value
-0000c390: 7329 0a20 2020 2020 2020 203e 3e3e 2028  s).        >>> (
-0000c3a0: 3132 2e36 3339 3039 3130 3839 3033 3235  12.6390910890325
-0000c3b0: 342c 2054 7275 6529 0a20 2020 2020 2020  4, True).       
-0000c3c0: 2022 2222 0a0a 2020 2020 2020 2020 7369   """..        si
-0000c3d0: 676e 6966 6963 616e 6365 5f62 6f6f 6c20  gnificance_bool 
-0000c3e0: 3d20 4e6f 6e65 0a20 2020 2020 2020 204e  = None.        N
-0000c3f0: 695f 782c 204e 695f 7920 3d20 6c65 6e28  i_x, Ni_y = len(
-0000c400: 7361 6d70 6c65 5f31 292c 206c 656e 2873  sample_1), len(s
-0000c410: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
-0000c420: 2059 6369 5f78 2c20 5963 695f 7920 3d20   Yci_x, Yci_y = 
-0000c430: 6e70 2e6d 6564 6961 6e28 7361 6d70 6c65  np.median(sample
-0000c440: 5f31 292c 206e 702e 6d65 6469 616e 2873  _1), np.median(s
-0000c450: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
-0000c460: 204e 746f 7420 3d20 4e69 5f78 202b 204e   Ntot = Ni_x + N
-0000c470: 695f 790a 2020 2020 2020 2020 5a69 6a5f  i_y.        Zij_
-0000c480: 782c 205a 696a 5f79 203d 206e 702e 6162  x, Zij_y = np.ab
-0000c490: 7328 7361 6d70 6c65 5f31 202d 2059 6369  s(sample_1 - Yci
-0000c4a0: 5f78 292e 6173 7479 7065 286e 702e 666c  _x).astype(np.fl
-0000c4b0: 6f61 7433 3229 2c20 6e70 2e61 6273 280a  oat32), np.abs(.
-0000c4c0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-0000c4d0: 6c65 5f32 202d 2059 6369 5f79 0a20 2020  le_2 - Yci_y.   
-0000c4e0: 2020 2020 2029 2e61 7374 7970 6528 6e70       ).astype(np
-0000c4f0: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
-0000c500: 2020 5a62 6172 695f 782c 205a 6261 7269    Zbari_x, Zbari
-0000c510: 5f79 203d 206e 702e 6d65 616e 285a 696a  _y = np.mean(Zij
-0000c520: 5f78 292c 206e 702e 6d65 616e 285a 696a  _x), np.mean(Zij
-0000c530: 5f79 290a 2020 2020 2020 2020 5a62 6172  _y).        Zbar
-0000c540: 203d 2028 285a 6261 7269 5f78 202a 204e   = ((Zbari_x * N
-0000c550: 695f 7829 202b 2028 5a62 6172 695f 7920  i_x) + (Zbari_y 
-0000c560: 2a20 4e69 5f79 2929 202f 204e 746f 740a  * Ni_y)) / Ntot.
-0000c570: 2020 2020 2020 2020 6e75 6d65 7220 3d20          numer = 
-0000c580: 284e 746f 7420 2d20 3229 202a 206e 702e  (Ntot - 2) * np.
-0000c590: 7375 6d28 0a20 2020 2020 2020 2020 2020  sum(.           
-0000c5a0: 206e 702e 6172 7261 7928 5b4e 695f 782c   np.array([Ni_x,
-0000c5b0: 204e 695f 795d 2920 2a20 286e 702e 6172   Ni_y]) * (np.ar
-0000c5c0: 7261 7928 5b5a 6261 7269 5f78 2c20 5a62  ray([Zbari_x, Zb
-0000c5d0: 6172 695f 795d 2920 2d20 5a62 6172 2920  ari_y]) - Zbar) 
-0000c5e0: 2a2a 2032 0a20 2020 2020 2020 2029 0a20  ** 2.        ). 
-0000c5f0: 2020 2020 2020 2064 7661 7220 3d20 6e70         dvar = np
-0000c600: 2e73 756d 2828 5a69 6a5f 7820 2d20 5a62  .sum((Zij_x - Zb
-0000c610: 6172 695f 7829 202a 2a20 3229 202b 206e  ari_x) ** 2) + n
-0000c620: 702e 7375 6d28 285a 696a 5f79 202d 205a  p.sum((Zij_y - Z
-0000c630: 6261 7269 5f79 2920 2a2a 2032 290a 2020  bari_y) ** 2).  
-0000c640: 2020 2020 2020 6465 6e6f 6d20 3d20 2832        denom = (2
-0000c650: 202d 2031 2e30 2920 2a20 6476 6172 0a20   - 1.0) * dvar. 
-0000c660: 2020 2020 2020 206c 5f73 7461 7469 7374         l_statist
-0000c670: 6963 203d 206e 756d 6572 202f 2064 656e  ic = numer / den
-0000c680: 6f6d 0a0a 2020 2020 2020 2020 6966 2063  om..        if c
-0000c690: 7269 7469 6361 6c5f 7661 6c75 6573 2069  ritical_values i
-0000c6a0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000c6b0: 2020 2020 2020 2020 6466 6e2c 2064 6664          dfn, dfd
-0000c6c0: 203d 2031 2c20 284e 695f 7820 2b20 4e69   = 1, (Ni_x + Ni
-0000c6d0: 5f79 2920 2d20 320a 2020 2020 2020 2020  _y) - 2.        
-0000c6e0: 2020 2020 6964 7820 3d20 286e 702e 6162      idx = (np.ab
-0000c6f0: 7328 6372 6974 6963 616c 5f76 616c 7565  s(critical_value
-0000c700: 735b 305d 5b31 3a5d 202d 2064 6664 2929  s[0][1:] - dfd))
-0000c710: 2e61 7267 6d69 6e28 2920 2b20 310a 2020  .argmin() + 1.  
-0000c720: 2020 2020 2020 2020 2020 6372 6974 6963            critic
-0000c730: 616c 5f76 616c 7565 7320 3d20 6372 6974  al_values = crit
-0000c740: 6963 616c 5f76 616c 7565 735b 313a 2c20  ical_values[1:, 
-0000c750: 6e70 2e61 7272 6179 285b 302c 2069 6478  np.array([0, idx
-0000c760: 5d29 5d0a 2020 2020 2020 2020 2020 2020  ])].            
-0000c770: 6372 6974 6963 616c 5f76 616c 7565 203d  critical_value =
-0000c780: 206e 702e 696e 7465 7270 280a 2020 2020   np.interp(.    
-0000c790: 2020 2020 2020 2020 2020 2020 6466 642c              dfd,
-0000c7a0: 2063 7269 7469 6361 6c5f 7661 6c75 6573   critical_values
-0000c7b0: 5b3a 2c20 305d 2c20 6372 6974 6963 616c  [:, 0], critical
-0000c7c0: 5f76 616c 7565 735b 3a2c 2031 5d0a 2020  _values[:, 1].  
-0000c7d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000c7e0: 2020 2020 2020 2020 6966 206c 5f73 7461          if l_sta
-0000c7f0: 7469 7374 6963 203e 3d20 6372 6974 6963  tistic >= critic
-0000c800: 616c 5f76 616c 7565 3a0a 2020 2020 2020  al_value:.      
-0000c810: 2020 2020 2020 2020 2020 7369 676e 6966            signif
-0000c820: 6963 616e 6365 5f62 6f6f 6c20 3d20 5472  icance_bool = Tr
-0000c830: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
-0000c840: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000c850: 2020 2020 2073 6967 6e69 6669 6361 6e63       significanc
-0000c860: 655f 626f 6f6c 203d 2046 616c 7365 0a0a  e_bool = False..
-0000c870: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-0000c880: 6c5f 7374 6174 6973 7469 632c 2073 6967  l_statistic, sig
-0000c890: 6e69 6669 6361 6e63 655f 626f 6f6c 290a  nificance_bool).
-0000c8a0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0000c8b0: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
-0000c8c0: 6c6f 6174 3634 5b3a 5d2c 2066 6c6f 6174  loat64[:], float
-0000c8d0: 3634 5b3a 5d2c 2066 6c6f 6174 3634 2922  64[:], float64)"
-0000c8e0: 2c20 6361 6368 653d 5472 7565 290a 2020  , cache=True).  
-0000c8f0: 2020 6465 6620 726f 6c6c 696e 675f 6c65    def rolling_le
-0000c900: 7665 6e65 7328 0a20 2020 2020 2020 2064  venes(.        d
-0000c910: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
-0000c920: 2074 696d 655f 7769 6e64 6f77 733a 206e   time_windows: n
-0000c930: 702e 6e64 6172 7261 792c 2066 7073 3a20  p.ndarray, fps: 
-0000c940: 666c 6f61 740a 2020 2020 2920 2d3e 2066  float.    ) -> f
-0000c950: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
-0000c960: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
-0000c970: 2063 6f6d 7075 7465 206f 6620 726f 6c6c   compute of roll
-0000c980: 696e 6720 4c65 7665 6e65 2773 2057 2063  ing Levene's W c
-0000c990: 6f6d 7061 7269 6e67 2074 6865 2063 7572  omparing the cur
-0000c9a0: 7265 6e74 2074 696d 652d 7769 6e64 6f77  rent time-window
-0000c9b0: 206f 6620 7369 7a65 204e 2074 6f20 7468   of size N to th
-0000c9c0: 6520 7072 6563 6564 696e 6720 7769 6e64  e preceding wind
-0000c9d0: 6f77 206f 6620 7369 7a65 204e 2e0a 0a20  ow of size N... 
-0000c9e0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-0000c9f0: 0a20 2020 2020 2020 2020 2020 4669 7273  .           Firs
-0000ca00: 7420 7469 6d65 2062 696e 2028 7768 6572  t time bin (wher
-0000ca10: 6520 6861 7320 6e6f 2070 7265 6365 6469  e has no precedi
-0000ca20: 6e67 2074 696d 6520 6269 6e29 2077 696c  ng time bin) wil
-0000ca30: 6c20 6861 7665 2066 696c 6c20 7661 6c75  l have fill valu
-0000ca40: 6520 6060 3060 600a 0a20 2020 2020 2020  e ``0``..       
+00001890: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+000018a0: 653a 3a0a 2020 2020 2020 2020 2020 2043  e::.           C
+000018b0: 7269 7469 6361 6c20 7661 6c75 6573 2061  ritical values a
+000018c0: 7265 2073 746f 7265 6420 696e 2073 696d  re stored in sim
+000018d0: 6261 2e61 7373 6574 732e 6c6f 6f6b 7570  ba.assets.lookup
+000018e0: 732e 6372 6974 6963 616c 5f76 616c 7565  s.critical_value
+000018f0: 735f 2a2a 2e70 6963 6b6c 650a 0a0a 2020  s_**.pickle...  
+00001900: 2020 2020 2020 5468 6520 742d 7374 6174        The t-stat
+00001910: 6973 7469 6320 666f 7220 696e 6465 7065  istic for indepe
+00001920: 6e64 656e 7420 7361 6d70 6c65 7320 742d  ndent samples t-
+00001930: 7465 7374 2069 7320 6361 6c63 756c 6174  test is calculat
+00001940: 6564 2075 7369 6e67 2074 6865 2066 6f6c  ed using the fol
+00001950: 6c6f 7769 6e67 2066 6f72 6d75 6c61 3a0a  lowing formula:.
+00001960: 0a20 2020 2020 2020 202e 2e20 6d61 7468  .        .. math
+00001970: 3a3a 0a20 2020 2020 2020 2020 2020 7420  ::.           t 
+00001980: 3d20 5c66 7261 637b 5c62 6172 7b78 7d5f  = \frac{\bar{x}_
+00001990: 3120 2d20 5c62 6172 7b78 7d5f 327d 7b73  1 - \bar{x}_2}{s
+000019a0: 5f70 205c 7371 7274 7b5c 6672 6163 7b31  _p \sqrt{\frac{1
+000019b0: 7d7b 6e5f 317d 202b 205c 6672 6163 7b31  }{n_1} + \frac{1
+000019c0: 7d7b 6e5f 327d 7d7d 0a0a 2020 2020 2020  }{n_2}}}..      
+000019d0: 2020 7768 6572 653a 0a20 2020 2020 2020    where:.       
+000019e0: 2020 2020 202d 205c 5c28 5c5c 6261 727b       - \\(\\bar{
+000019f0: 787d 5f31 5c5c 2920 616e 6420 5c5c 285c  x}_1\\) and \\(\
+00001a00: 5c62 6172 7b78 7d5f 325c 5c29 2061 7265  \bar{x}_2\\) are
+00001a10: 2074 6865 206d 6561 6e73 206f 6620 7361   the means of sa
+00001a20: 6d70 6c65 5f31 2061 6e64 2073 616d 706c  mple_1 and sampl
+00001a30: 655f 3220 7265 7370 6563 7469 7665 6c79  e_2 respectively
+00001a40: 2c0a 2020 2020 2020 2020 2020 2020 2d20  ,.            - 
+00001a50: 5c5c 2873 5f70 5c5c 2920 6973 2074 6865  \\(s_p\\) is the
+00001a60: 2070 6f6f 6c65 6420 7374 616e 6461 7264   pooled standard
+00001a70: 2064 6576 6961 7469 6f6e 2c0a 2020 2020   deviation,.    
+00001a80: 2020 2020 2020 2020 2d20 5c5c 286e 5f31          - \\(n_1
+00001a90: 5c5c 2920 616e 6420 5c5c 286e 5f32 5c5c  \\) and \\(n_2\\
+00001aa0: 2920 6172 6520 7468 6520 7361 6d70 6c65  ) are the sample
+00001ab0: 2073 697a 6573 206f 6620 7361 6d70 6c65   sizes of sample
+00001ac0: 5f31 2061 6e64 2073 616d 706c 655f 3220  _1 and sample_2 
+00001ad0: 7265 7370 6563 7469 7665 6c79 2e0a 0a20  respectively... 
+00001ae0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00001af0: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
+00001b00: 5f31 3a20 4669 7273 7420 3164 2061 7272  _1: First 1d arr
+00001b10: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+00001b20: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+00001b30: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+00001b40: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
+00001b50: 655f 323a 2053 6563 6f6e 6420 3164 2061  e_2: Second 1d a
+00001b60: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+00001b70: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
+00001b80: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00001b90: 6574 6572 206e 6461 7272 6179 2063 7269  eter ndarray cri
+00001ba0: 7469 6361 6c5f 7661 6c75 6573 3a20 3264  tical_values: 2d
+00001bb0: 2061 7272 6179 2077 6865 7265 2074 6865   array where the
+00001bc0: 2066 6972 7374 2063 6f6c 756d 6e20 7265   first column re
+00001bd0: 7072 6573 656e 7473 2064 6567 7265 6573  presents degrees
+00001be0: 206f 6620 6672 6565 646f 6d20 616e 6420   of freedom and 
+00001bf0: 7365 636f 6e64 2063 6f6c 756d 6e20 7265  second column re
+00001c00: 7072 6573 656e 7473 2063 7269 7469 6361  presents critica
+00001c10: 6c20 7661 6c75 6573 2e0a 2020 2020 2020  l values..      
+00001c20: 2020 3a72 6574 7572 6e73 2028 666c 6f61    :returns (floa
+00001c30: 7420 556e 696f 6e5b 4e6f 6e65 2c20 626f  t Union[None, bo
+00001c40: 6f6c 5d29 2074 5f73 7461 7469 7374 6963  ol]) t_statistic
+00001c50: 2c20 705f 7661 6c75 653a 2052 6570 7265  , p_value: Repre
+00001c60: 7365 6e74 696e 6720 742d 7374 6174 6973  senting t-statis
+00001c70: 7469 6320 616e 6420 6173 736f 6369 6174  tic and associat
+00001c80: 6564 2070 726f 6261 6269 6c69 7479 2076  ed probability v
+00001c90: 616c 7565 2e20 705f 7661 6c75 6520 6973  alue. p_value is
+00001ca0: 2060 604e 6f6e 6560 6020 6966 2063 7269   ``None`` if cri
+00001cb0: 7469 6361 6c5f 7661 6c75 6573 2069 7320  tical_values is 
+00001cc0: 4e6f 6e65 2e20 456c 7365 2054 7275 6520  None. Else True 
+00001cd0: 6f72 2046 616c 7365 2077 6974 6820 5472  or False with Tr
+00001ce0: 7565 2072 6570 7265 7365 6e74 696e 6720  ue representing 
+00001cf0: 7369 676e 6966 6963 616e 742e 0a0a 2020  significant...  
+00001d00: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+00001d10: 2020 2020 2020 2020 3e3e 3e20 7361 6d70          >>> samp
+00001d20: 6c65 5f31 203d 206e 702e 6172 7261 7928  le_1 = np.array(
+00001d30: 5b31 2c20 322c 2033 2c20 312c 2033 2c20  [1, 2, 3, 1, 3, 
+00001d40: 322c 2031 2c20 3130 2c20 382c 2034 2c20  2, 1, 10, 8, 4, 
+00001d50: 3130 5d29 0a20 2020 2020 2020 203e 3e3e  10]).        >>>
+00001d60: 2073 616d 706c 655f 3220 3d20 6e70 2e61   sample_2 = np.a
+00001d70: 7272 6179 285b 322c 2035 2c20 3130 2c20  rray([2, 5, 10, 
+00001d80: 342c 2038 2c20 3130 2c20 372c 2031 302c  4, 8, 10, 7, 10,
+00001d90: 2037 2c20 3130 2c20 3130 5d29 0a20 2020   7, 10, 10]).   
+00001da0: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
+00001db0: 6963 7328 292e 696e 6465 7065 6e64 656e  ics().independen
+00001dc0: 745f 7361 6d70 6c65 735f 7428 7361 6d70  t_samples_t(samp
+00001dd0: 6c65 5f31 3d73 616d 706c 655f 312c 2073  le_1=sample_1, s
+00001de0: 616d 706c 655f 323d 7361 6d70 6c65 5f32  ample_2=sample_2
+00001df0: 290a 2020 2020 2020 2020 3e3e 3e20 282d  ).        >>> (-
+00001e00: 322e 3532 3636 3034 3638 3034 3539 3031  2.52660468045901
+00001e10: 3833 2c20 4e6f 6e65 290a 2020 2020 2020  83, None).      
+00001e20: 2020 3e3e 3e20 6372 6974 6963 616c 5f76    >>> critical_v
+00001e30: 616c 7565 7320 3d20 7069 636b 6c65 2e6c  alues = pickle.l
+00001e40: 6f61 6428 6f70 656e 2822 7369 6d62 612f  oad(open("simba/
+00001e50: 6173 7365 7473 2f6c 6f6f 6b75 7073 2f63  assets/lookups/c
+00001e60: 7269 7469 6361 6c5f 7661 6c75 6573 5f30  ritical_values_0
+00001e70: 352e 7069 636b 6c65 222c 2272 6222 2929  5.pickle","rb"))
+00001e80: 5b27 696e 6465 7065 6e64 656e 745f 745f  ['independent_t_
+00001e90: 7465 7374 275d 5b27 6f6e 655f 7461 696c  test']['one_tail
+00001ea0: 275d 2e76 616c 7565 730a 2020 2020 2020  '].values.      
+00001eb0: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
+00001ec0: 2829 2e69 6e64 6570 656e 6465 6e74 5f73  ().independent_s
+00001ed0: 616d 706c 6573 5f74 2873 616d 706c 655f  amples_t(sample_
+00001ee0: 313d 7361 6d70 6c65 5f31 2c20 7361 6d70  1=sample_1, samp
+00001ef0: 6c65 5f32 3d73 616d 706c 655f 322c 2063  le_2=sample_2, c
+00001f00: 7269 7469 6361 6c5f 7661 6c75 6573 3d63  ritical_values=c
+00001f10: 7269 7469 6361 6c5f 7661 6c75 6573 290a  ritical_values).
+00001f20: 2020 2020 2020 2020 3e3e 3e20 282d 322e          >>> (-2.
+00001f30: 3532 3636 3034 3638 3034 3539 3031 3833  5266046804590183
+00001f40: 2c20 5472 7565 290a 2020 2020 2020 2020  , True).        
+00001f50: 2222 220a 0a20 2020 2020 2020 2073 6967  """..        sig
+00001f60: 6e69 6669 6361 6e63 655f 626f 6f6c 203d  nificance_bool =
+00001f70: 204e 6f6e 650a 2020 2020 2020 2020 6d31   None.        m1
+00001f80: 2c20 6d32 203d 206e 702e 6d65 616e 2873  , m2 = np.mean(s
+00001f90: 616d 706c 655f 3129 2c20 6e70 2e6d 6561  ample_1), np.mea
+00001fa0: 6e28 7361 6d70 6c65 5f32 290a 2020 2020  n(sample_2).    
+00001fb0: 2020 2020 7374 645f 3120 3d20 6e70 2e73      std_1 = np.s
+00001fc0: 7172 7428 6e70 2e73 756d 2828 7361 6d70  qrt(np.sum((samp
+00001fd0: 6c65 5f31 202d 206d 3129 202a 2a20 3229  le_1 - m1) ** 2)
+00001fe0: 202f 2028 6c65 6e28 7361 6d70 6c65 5f31   / (len(sample_1
+00001ff0: 2920 2d20 3129 290a 2020 2020 2020 2020  ) - 1)).        
+00002000: 7374 645f 3220 3d20 6e70 2e73 7172 7428  std_2 = np.sqrt(
+00002010: 6e70 2e73 756d 2828 7361 6d70 6c65 5f32  np.sum((sample_2
+00002020: 202d 206d 3229 202a 2a20 3229 202f 2028   - m2) ** 2) / (
+00002030: 6c65 6e28 7361 6d70 6c65 5f32 2920 2d20  len(sample_2) - 
+00002040: 3129 290a 2020 2020 2020 2020 706f 6f6c  1)).        pool
+00002050: 6564 5f73 7464 203d 206e 702e 7371 7274  ed_std = np.sqrt
+00002060: 280a 2020 2020 2020 2020 2020 2020 2828  (.            ((
+00002070: 6c65 6e28 7361 6d70 6c65 5f31 2920 2d20  len(sample_1) - 
+00002080: 3129 202a 2073 7464 5f31 2a2a 3220 2b20  1) * std_1**2 + 
+00002090: 286c 656e 2873 616d 706c 655f 3229 202d  (len(sample_2) -
+000020a0: 2031 2920 2a20 7374 645f 322a 2a32 290a   1) * std_2**2).
+000020b0: 2020 2020 2020 2020 2020 2020 2f20 286c              / (l
+000020c0: 656e 2873 616d 706c 655f 3129 202b 206c  en(sample_1) + l
+000020d0: 656e 2873 616d 706c 655f 3229 202d 2032  en(sample_2) - 2
+000020e0: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+000020f0: 2020 2020 745f 7374 6174 6973 7469 6320      t_statistic 
+00002100: 3d20 286d 3120 2d20 6d32 2920 2f20 280a  = (m1 - m2) / (.
+00002110: 2020 2020 2020 2020 2020 2020 706f 6f6c              pool
+00002120: 6564 5f73 7464 202a 206e 702e 7371 7274  ed_std * np.sqrt
+00002130: 2831 202f 206c 656e 2873 616d 706c 655f  (1 / len(sample_
+00002140: 3129 202b 2031 202f 206c 656e 2873 616d  1) + 1 / len(sam
+00002150: 706c 655f 3229 290a 2020 2020 2020 2020  ple_2)).        
+00002160: 290a 2020 2020 2020 2020 6966 2063 7269  ).        if cri
+00002170: 7469 6361 6c5f 7661 6c75 6573 2069 7320  tical_values is 
+00002180: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00002190: 2020 2020 2020 646f 6620 3d20 2873 616d        dof = (sam
+000021a0: 706c 655f 312e 7368 6170 655b 305d 202b  ple_1.shape[0] +
+000021b0: 2073 616d 706c 655f 322e 7368 6170 655b   sample_2.shape[
+000021c0: 305d 2920 2d20 320a 2020 2020 2020 2020  0]) - 2.        
+000021d0: 2020 2020 6372 6974 6963 616c 5f76 616c      critical_val
+000021e0: 7565 203d 206e 702e 696e 7465 7270 280a  ue = np.interp(.
+000021f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002200: 646f 662c 2063 7269 7469 6361 6c5f 7661  dof, critical_va
+00002210: 6c75 6573 5b3a 2c20 305d 2c20 6372 6974  lues[:, 0], crit
+00002220: 6963 616c 5f76 616c 7565 735b 3a2c 2031  ical_values[:, 1
+00002230: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
+00002240: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00002250: 7269 7469 6361 6c5f 7661 6c75 6520 3c20  ritical_value < 
+00002260: 6162 7328 745f 7374 6174 6973 7469 6329  abs(t_statistic)
+00002270: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00002280: 2020 7369 676e 6966 6963 616e 6365 5f62    significance_b
+00002290: 6f6f 6c20 3d20 5472 7565 0a20 2020 2020  ool = True.     
+000022a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000022b0: 2020 2020 2020 2020 2020 2020 2073 6967               sig
+000022c0: 6e69 6669 6361 6e63 655f 626f 6f6c 203d  nificance_bool =
+000022d0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+000022e0: 7265 7475 726e 2074 5f73 7461 7469 7374  return t_statist
+000022f0: 6963 2c20 7369 676e 6966 6963 616e 6365  ic, significance
+00002300: 5f62 6f6f 6c0a 0a20 2020 2040 7374 6174  _bool..    @stat
+00002310: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
+00002320: 6974 2822 2866 6c6f 6174 3634 5b3a 5d2c  it("(float64[:],
+00002330: 2066 6c6f 6174 3634 5b3a 5d29 222c 2063   float64[:])", c
+00002340: 6163 6865 3d54 7275 6529 0a20 2020 2064  ache=True).    d
+00002350: 6566 2063 6f68 656e 735f 6428 7361 6d70  ef cohens_d(samp
+00002360: 6c65 5f31 3a20 6e70 2e6e 6461 7272 6179  le_1: np.ndarray
+00002370: 2c20 7361 6d70 6c65 5f32 3a20 6e70 2e6e  , sample_2: np.n
+00002380: 6461 7272 6179 2920 2d3e 2066 6c6f 6174  darray) -> float
+00002390: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000023a0: 2020 2020 2020 4a69 7474 6564 2063 6f6d        Jitted com
+000023b0: 7075 7465 206f 6620 436f 6865 6e27 7320  pute of Cohen's 
+000023c0: 6420 6265 7477 6565 6e20 7477 6f20 6469  d between two di
+000023d0: 7374 7269 6275 7469 6f6e 732e 0a0a 2020  stributions...  
+000023e0: 2020 2020 2020 436f 6865 6e27 7320 6420        Cohen's d 
+000023f0: 6973 2061 206d 6561 7375 7265 206f 6620  is a measure of 
+00002400: 6566 6665 6374 2073 697a 6520 7468 6174  effect size that
+00002410: 2071 7561 6e74 6966 6965 7320 7468 6520   quantifies the 
+00002420: 6469 6666 6572 656e 6365 2062 6574 7765  difference betwe
+00002430: 656e 2074 6865 206d 6561 6e73 206f 6620  en the means of 
+00002440: 7477 6f20 6469 7374 7269 6275 7469 6f6e  two distribution
+00002450: 7320 696e 2074 6572 6d73 206f 6620 7468  s in terms of th
+00002460: 6569 7220 7374 616e 6461 7264 2064 6576  eir standard dev
+00002470: 6961 7469 6f6e 2e20 4974 2069 7320 6361  iation. It is ca
+00002480: 6c63 756c 6174 6564 2061 7320 7468 6520  lculated as the 
+00002490: 6469 6666 6572 656e 6365 2062 6574 7765  difference betwe
+000024a0: 656e 2074 6865 206d 6561 6e73 206f 6620  en the means of 
+000024b0: 7468 6520 7477 6f20 6469 7374 7269 6275  the two distribu
+000024c0: 7469 6f6e 7320 6469 7669 6465 6420 6279  tions divided by
+000024d0: 2074 6865 2070 6f6f 6c65 6420 7374 616e   the pooled stan
+000024e0: 6461 7264 2064 6576 6961 7469 6f6e 2e0a  dard deviation..
+000024f0: 0a20 2020 2020 2020 202e 2e20 6d61 7468  .        .. math
+00002500: 3a3a 0a20 2020 2020 2020 2020 2020 6420  ::.           d 
+00002510: 3d20 5c5c 6672 6163 7b7b 5c5c 6261 727b  = \\frac{{\\bar{
+00002520: 787d 5f31 202d 205c 5c62 6172 7b78 7d5f  x}_1 - \\bar{x}_
+00002530: 327d 7d7b 7b5c 5c73 7172 747b 7b5c 5c66  2}}{{\\sqrt{{\\f
+00002540: 7261 637b 7b73 5f31 5e32 202b 2073 5f32  rac{{s_1^2 + s_2
+00002550: 5e32 7d7d 7b32 7d7d 7d7d 7d0a 0a20 2020  ^2}}{2}}}}}..   
+00002560: 2020 2020 2077 6865 7265 3a0a 2020 2020       where:.    
+00002570: 2020 2020 2020 2020 2d20 5c5c 285c 5c62          - \\(\\b
+00002580: 6172 7b78 7d5f 315c 5c29 2061 6e64 205c  ar{x}_1\\) and \
+00002590: 5c28 5c5c 6261 727b 787d 5f32 5c5c 2920  \(\\bar{x}_2\\) 
+000025a0: 6172 6520 7468 6520 6d65 616e 7320 6f66  are the means of
+000025b0: 2073 616d 706c 655f 3120 616e 6420 7361   sample_1 and sa
+000025c0: 6d70 6c65 5f32 2072 6573 7065 6374 6976  mple_2 respectiv
+000025d0: 656c 792c 0a20 2020 2020 2020 2020 2020  ely,.           
+000025e0: 202d 205c 5c28 735f 315c 5c29 2061 6e64   - \\(s_1\\) and
+000025f0: 205c 5c28 735f 325c 5c29 2061 7265 2074   \\(s_2\\) are t
+00002600: 6865 2073 7461 6e64 6172 6420 6465 7669  he standard devi
+00002610: 6174 696f 6e73 206f 6620 7361 6d70 6c65  ations of sample
+00002620: 5f31 2061 6e64 2073 616d 706c 655f 3220  _1 and sample_2 
+00002630: 7265 7370 6563 7469 7665 6c79 2e0a 0a20  respectively... 
+00002640: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00002650: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
+00002660: 5f31 3a20 4669 7273 7420 3164 2061 7272  _1: First 1d arr
+00002670: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+00002680: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+00002690: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+000026a0: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
+000026b0: 655f 323a 2053 6563 6f6e 6420 3164 2061  e_2: Second 1d a
+000026c0: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+000026d0: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
+000026e0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+000026f0: 6e73 2066 6c6f 6174 3a20 436f 6865 6e73  ns float: Cohens
+00002700: 2044 2073 7461 7469 7374 6963 2e0a 0a20   D statistic... 
+00002710: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+00002720: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+00002730: 706c 655f 3120 3d20 5b32 2c20 342c 2037  ple_1 = [2, 4, 7
+00002740: 2c20 332c 2037 2c20 3335 2c20 382c 2039  , 3, 7, 35, 8, 9
+00002750: 5d0a 2020 2020 2020 2020 3e3e 3e20 7361  ].        >>> sa
+00002760: 6d70 6c65 5f32 203d 205b 342c 2038 2c20  mple_2 = [4, 8, 
+00002770: 3134 2c20 362c 2031 342c 2037 302c 2031  14, 6, 14, 70, 1
+00002780: 362c 2031 385d 0a20 2020 2020 2020 203e  6, 18].        >
+00002790: 3e3e 2053 7461 7469 7374 6963 7328 292e  >> Statistics().
+000027a0: 636f 6865 6e73 5f64 2873 616d 706c 655f  cohens_d(sample_
+000027b0: 313d 7361 6d70 6c65 5f31 2c20 7361 6d70  1=sample_1, samp
+000027c0: 6c65 5f32 3d73 616d 706c 655f 3229 0a20  le_2=sample_2). 
+000027d0: 2020 2020 2020 203e 3e3e 202d 302e 3539         >>> -0.59
+000027e0: 3532 3039 3937 3735 3137 3035 3436 0a20  52099775170546. 
+000027f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00002800: 2020 2072 6574 7572 6e20 286e 702e 6d65     return (np.me
+00002810: 616e 2873 616d 706c 655f 3129 202d 206e  an(sample_1) - n
+00002820: 702e 6d65 616e 2873 616d 706c 655f 3229  p.mean(sample_2)
+00002830: 2920 2f20 280a 2020 2020 2020 2020 2020  ) / (.          
+00002840: 2020 6e70 2e73 7172 7428 286e 702e 7374    np.sqrt((np.st
+00002850: 6428 7361 6d70 6c65 5f31 2920 2a2a 2032  d(sample_1) ** 2
+00002860: 202b 206e 702e 7374 6428 7361 6d70 6c65   + np.std(sample
+00002870: 5f32 2920 2a2a 2032 2920 2f20 3229 0a20  _2) ** 2) / 2). 
+00002880: 2020 2020 2020 2029 0a0a 2020 2020 4073         )..    @s
+00002890: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+000028a0: 406e 6a69 7428 2228 666c 6f61 7436 345b  @njit("(float64[
+000028b0: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
+000028c0: 666c 6f61 7436 3429 222c 2063 6163 6865  float64)", cache
+000028d0: 3d54 7275 6529 0a20 2020 2064 6566 2072  =True).    def r
+000028e0: 6f6c 6c69 6e67 5f63 6f68 656e 735f 6428  olling_cohens_d(
+000028f0: 0a20 2020 2020 2020 2064 6174 613a 206e  .        data: n
+00002900: 702e 6e64 6172 7261 792c 2074 696d 655f  p.ndarray, time_
+00002910: 7769 6e64 6f77 733a 206e 702e 6e64 6172  windows: np.ndar
+00002920: 7261 792c 2066 7073 3a20 666c 6f61 740a  ray, fps: float.
+00002930: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
+00002940: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
+00002950: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
+00002960: 636f 6d70 7574 6520 6f66 2072 6f6c 6c69  compute of rolli
+00002970: 6e67 2043 6f68 656e 2773 2044 2073 7461  ng Cohen's D sta
+00002980: 7469 7374 6963 2063 6f6d 7061 7269 6e67  tistic comparing
+00002990: 2074 6865 2063 7572 7265 6e74 2074 696d   the current tim
+000029a0: 652d 7769 6e64 6f77 206f 660a 2020 2020  e-window of.    
+000029b0: 2020 2020 7369 7a65 204e 2074 6f20 7468      size N to th
+000029c0: 6520 7072 6563 6564 696e 6720 7769 6e64  e preceding wind
+000029d0: 6f77 206f 6620 7369 7a65 204e 2e0a 0a20  ow of size N... 
+000029e0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+000029f0: 7220 6e64 6172 7261 7920 6461 7461 3a20  r ndarray data: 
+00002a00: 3144 2061 7272 6179 206f 6620 7369 7a65  1D array of size
+00002a10: 206c 656e 2866 7261 6d65 7329 2072 6570   len(frames) rep
+00002a20: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
+00002a30: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+00002a40: 2020 3a70 6172 616d 6574 6572 206e 702e    :parameter np.
+00002a50: 6e64 6172 7261 795b 696e 7473 5d20 7469  ndarray[ints] ti
+00002a60: 6d65 5f77 696e 646f 773a 2054 696d 6520  me_window: Time 
+00002a70: 7769 6e64 6f77 7320 746f 2063 6f6d 7075  windows to compu
+00002a80: 7465 2041 4e4f 5641 7320 666f 7220 696e  te ANOVAs for in
+00002a90: 2073 6563 6f6e 6473 2e0a 2020 2020 2020   seconds..      
+00002aa0: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
+00002ab0: 2066 7073 3a20 4672 616d 652d 7261 7465   fps: Frame-rate
+00002ac0: 206f 6620 7265 636f 7264 6564 2076 6964   of recorded vid
+00002ad0: 656f 2e0a 2020 2020 2020 2020 3a72 6574  eo..        :ret
+00002ae0: 7572 6e73 206e 702e 6e64 6172 7261 793a  urns np.ndarray:
+00002af0: 2041 7272 6179 206f 6620 7369 7a65 2064   Array of size d
+00002b00: 6174 612e 7368 6170 655b 305d 2078 2077  ata.shape[0] x w
+00002b10: 696e 646f 775f 7369 7a65 732e 7368 6170  indow_sizes.shap
+00002b20: 655b 315d 2077 6974 6820 436f 6865 6e73  e[1] with Cohens
+00002b30: 2044 2e0a 0a20 2020 2020 2020 203a 6578   D...        :ex
+00002b40: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00002b50: 3e3e 2073 616d 706c 655f 312c 2073 616d  >> sample_1, sam
+00002b60: 706c 655f 3220 3d20 6e70 2e72 616e 646f  ple_2 = np.rando
+00002b70: 6d2e 6e6f 726d 616c 286c 6f63 3d31 302c  m.normal(loc=10,
+00002b80: 2073 6361 6c65 3d31 2c20 7369 7a65 3d34   scale=1, size=4
+00002b90: 292c 206e 702e 7261 6e64 6f6d 2e6e 6f72  ), np.random.nor
+00002ba0: 6d61 6c28 6c6f 633d 3131 2c20 7363 616c  mal(loc=11, scal
+00002bb0: 653d 322c 2073 697a 653d 3429 0a20 2020  e=2, size=4).   
+00002bc0: 2020 2020 203e 3e3e 2073 616d 706c 6520       >>> sample 
+00002bd0: 3d20 6e70 2e68 7374 6163 6b28 2873 616d  = np.hstack((sam
+00002be0: 706c 655f 312c 2073 616d 706c 655f 3229  ple_1, sample_2)
+00002bf0: 290a 2020 2020 2020 2020 3e3e 3e20 5374  ).        >>> St
+00002c00: 6174 6973 7469 6373 2829 2e72 6f6c 6c69  atistics().rolli
+00002c10: 6e67 5f63 6f68 656e 735f 6428 6461 7461  ng_cohens_d(data
+00002c20: 3d73 616d 706c 652c 2077 696e 646f 775f  =sample, window_
+00002c30: 7369 7a65 733d 6e70 2e61 7272 6179 285b  sizes=np.array([
+00002c40: 315d 292c 2066 7073 3d34 290a 2020 2020  1]), fps=4).    
+00002c50: 2020 2020 3e3e 3e20 5b5b 302e 5d2c 5b30      >>> [[0.],[0
+00002c60: 2e5d 2c5b 302e 5d2c 5b30 2e5d 2c5b 302e  .],[0.],[0.],[0.
+00002c70: 3134 3731 3833 3032 5d2c 5b30 2e31 3437  14718302],[0.147
+00002c80: 3138 3330 325d 2c5b 302e 3134 3731 3833  18302],[0.147183
+00002c90: 3032 5d2c 5b30 2e31 3437 3138 3330 325d  02],[0.14718302]
+00002ca0: 5d29 0a20 2020 2020 2020 2022 2222 0a0a  ]).        """..
+00002cb0: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
+00002cc0: 3d20 6e70 2e66 756c 6c28 2864 6174 612e  = np.full((data.
+00002cd0: 7368 6170 655b 305d 2c20 7469 6d65 5f77  shape[0], time_w
+00002ce0: 696e 646f 7773 2e73 6861 7065 5b30 5d29  indows.shape[0])
+00002cf0: 2c20 302e 3029 0a20 2020 2020 2020 2066  , 0.0).        f
+00002d00: 6f72 2069 2069 6e20 7072 616e 6765 2874  or i in prange(t
+00002d10: 696d 655f 7769 6e64 6f77 732e 7368 6170  ime_windows.shap
+00002d20: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
+00002d30: 2020 2077 696e 646f 775f 7369 7a65 203d     window_size =
+00002d40: 2069 6e74 2874 696d 655f 7769 6e64 6f77   int(time_window
+00002d50: 735b 695d 202a 2066 7073 290a 2020 2020  s[i] * fps).    
+00002d60: 2020 2020 2020 2020 6461 7461 5f73 706c          data_spl
+00002d70: 6974 203d 206e 702e 7370 6c69 7428 0a20  it = np.split(. 
+00002d80: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00002d90: 6174 612c 206c 6973 7428 7261 6e67 6528  ata, list(range(
+00002da0: 7769 6e64 6f77 5f73 697a 652c 2064 6174  window_size, dat
+00002db0: 612e 7368 6170 655b 305d 2c20 7769 6e64  a.shape[0], wind
+00002dc0: 6f77 5f73 697a 6529 290a 2020 2020 2020  ow_size)).      
+00002dd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00002de0: 2020 2020 666f 7220 6a20 696e 2070 7261      for j in pra
+00002df0: 6e67 6528 312c 206c 656e 2864 6174 615f  nge(1, len(data_
+00002e00: 7370 6c69 7429 293a 0a20 2020 2020 2020  split)):.       
+00002e10: 2020 2020 2020 2020 2077 696e 646f 775f           window_
+00002e20: 7374 6172 7420 3d20 696e 7428 7769 6e64  start = int(wind
+00002e30: 6f77 5f73 697a 6520 2a20 6a29 0a20 2020  ow_size * j).   
+00002e40: 2020 2020 2020 2020 2020 2020 2077 696e               win
+00002e50: 646f 775f 656e 6420 3d20 696e 7428 7769  dow_end = int(wi
+00002e60: 6e64 6f77 5f73 7461 7274 202b 2077 696e  ndow_start + win
+00002e70: 646f 775f 7369 7a65 290a 2020 2020 2020  dow_size).      
+00002e80: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00002e90: 5f31 2c20 7361 6d70 6c65 5f32 203d 2064  _1, sample_2 = d
+00002ea0: 6174 615f 7370 6c69 745b 6a20 2d20 315d  ata_split[j - 1]
+00002eb0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00002ec0: 3332 292c 2064 6174 615f 7370 6c69 745b  32), data_split[
+00002ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002ee0: 2020 2020 206a 0a20 2020 2020 2020 2020       j.         
+00002ef0: 2020 2020 2020 205d 2e61 7374 7970 6528         ].astype(
+00002f00: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+00002f10: 2020 2020 2020 2020 2020 2020 6420 3d20              d = 
+00002f20: 286e 702e 6d65 616e 2873 616d 706c 655f  (np.mean(sample_
+00002f30: 3129 202d 206e 702e 6d65 616e 2873 616d  1) - np.mean(sam
+00002f40: 706c 655f 3229 2920 2f20 280a 2020 2020  ple_2)) / (.    
+00002f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002f60: 6e70 2e73 7172 7428 286e 702e 7374 6428  np.sqrt((np.std(
+00002f70: 7361 6d70 6c65 5f31 2920 2a2a 2032 202b  sample_1) ** 2 +
+00002f80: 206e 702e 7374 6428 7361 6d70 6c65 5f32   np.std(sample_2
+00002f90: 2920 2a2a 2032 2920 2f20 3229 0a20 2020  ) ** 2) / 2).   
+00002fa0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00002fb0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00002fc0: 6573 756c 7473 5b77 696e 646f 775f 7374  esults[window_st
+00002fd0: 6172 743a 7769 6e64 6f77 5f65 6e64 2c20  art:window_end, 
+00002fe0: 695d 203d 2064 0a20 2020 2020 2020 2072  i] = d.        r
+00002ff0: 6574 7572 6e20 7265 7375 6c74 730a 0a20  eturn results.. 
+00003000: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+00003010: 0a20 2020 2040 6e6a 6974 2822 2866 6c6f  .    @njit("(flo
+00003020: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3634  at32[:], float64
+00003030: 2c20 666c 6f61 7436 3429 2229 0a20 2020  , float64)").   
+00003040: 2064 6566 2072 6f6c 6c69 6e67 5f74 776f   def rolling_two
+00003050: 5f73 616d 706c 655f 6b73 280a 2020 2020  _sample_ks(.    
+00003060: 2020 2020 6461 7461 3a20 6e70 2e6e 6461      data: np.nda
+00003070: 7272 6179 2c20 7469 6d65 5f77 696e 646f  rray, time_windo
+00003080: 773a 2066 6c6f 6174 2c20 6670 733a 2066  w: float, fps: f
+00003090: 6c6f 6174 0a20 2020 2029 202d 3e20 6e70  loat.    ) -> np
+000030a0: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
+000030b0: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
+000030c0: 7474 6564 2063 6f6d 7075 7465 204b 6f6c  tted compute Kol
+000030d0: 6d6f 676f 726f 7620 7477 6f2d 7361 6d70  mogorov two-samp
+000030e0: 6c65 2073 7461 7469 7374 6963 7320 666f  le statistics fo
+000030f0: 7220 7365 7175 656e 7469 616c 6c79 2062  r sequentially b
+00003100: 696e 6e65 6420 7661 6c75 6573 2069 6e20  inned values in 
+00003110: 6120 7469 6d65 2d73 6572 6965 732e 0a20  a time-series.. 
+00003120: 2020 2020 2020 2045 2e67 2e2c 2063 6f6d         E.g., com
+00003130: 7075 7465 204b 5320 7374 6174 6973 7469  pute KS statisti
+00003140: 6373 2077 6865 6e20 636f 6d70 6172 696e  cs when comparin
+00003150: 6720 6060 4665 6174 7572 6520 4e60 6020  g ``Feature N`` 
+00003160: 696e 2074 6865 2063 7572 7265 6e74 2031  in the current 1
+00003170: 7320 7469 6d65 2d77 696e 646f 772c 2076  s time-window, v
+00003180: 6572 7375 7320 6060 4665 6174 7572 6520  ersus ``Feature 
+00003190: 4e60 6020 696e 2074 6865 2070 7265 7669  N`` in the previ
+000031a0: 6f75 7320 3173 2074 696d 652d 7769 6e64  ous 1s time-wind
+000031b0: 6f77 2e0a 0a20 2020 2020 2020 203a 7061  ow...        :pa
+000031c0: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+000031d0: 6461 7461 3a20 3144 2061 7272 6179 206f  data: 1D array o
+000031e0: 6620 7369 7a65 206c 656e 2866 7261 6d65  f size len(frame
+000031f0: 7329 2072 6570 7265 7365 6e74 696e 6720  s) representing 
+00003200: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+00003210: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+00003220: 6572 2066 6c6f 6174 2074 696d 655f 7769  er float time_wi
+00003230: 6e64 6f77 3a20 5468 6520 7369 7a65 206f  ndow: The size o
+00003240: 6620 7468 6520 6275 636b 6574 7320 696e  f the buckets in
+00003250: 2073 6563 6f6e 6473 2e0a 2020 2020 2020   seconds..      
+00003260: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
+00003270: 2066 7073 3a20 4672 616d 652d 7261 7465   fps: Frame-rate
+00003280: 206f 6620 7265 636f 7264 6564 2076 6964   of recorded vid
+00003290: 656f 2e0a 2020 2020 2020 2020 3a72 6574  eo..        :ret
+000032a0: 7572 6e20 6e70 2e6e 6461 7272 6179 3a20  urn np.ndarray: 
+000032b0: 4172 7261 7920 6f66 2073 697a 6520 6461  Array of size da
+000032c0: 7461 2e73 6861 7065 5b30 5d20 7769 7468  ta.shape[0] with
+000032d0: 204b 5320 7374 6174 6973 7469 6373 0a0a   KS statistics..
+000032e0: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+000032f0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6461  :.        >>> da
+00003300: 7461 203d 206e 702e 7261 6e64 6f6d 2e72  ta = np.random.r
+00003310: 616e 6469 6e74 286c 6f77 3d30 2c20 6869  andint(low=0, hi
+00003320: 6768 3d31 3030 2c20 7369 7a65 3d28 3230  gh=100, size=(20
+00003330: 3029 292e 6173 7479 7065 2827 666c 6f61  0)).astype('floa
+00003340: 7433 3227 290a 2020 2020 2020 2020 3e3e  t32').        >>
+00003350: 3e20 7265 7375 6c74 7320 3d20 5374 6174  > results = Stat
+00003360: 6973 7469 6373 2829 2e72 6f6c 6c69 6e67  istics().rolling
+00003370: 5f74 776f 5f73 616d 706c 655f 6b73 2864  _two_sample_ks(d
+00003380: 6174 613d 6461 7461 2c20 7469 6d65 5f77  ata=data, time_w
+00003390: 696e 646f 773d 312c 2066 7073 3d33 3029  indow=1, fps=30)
+000033a0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000033b0: 2020 2020 2020 7769 6e64 6f77 5f73 697a        window_siz
+000033c0: 652c 2072 6573 756c 7473 203d 2069 6e74  e, results = int
+000033d0: 2874 696d 655f 7769 6e64 6f77 202a 2066  (time_window * f
+000033e0: 7073 292c 206e 702e 6675 6c6c 2828 6461  ps), np.full((da
+000033f0: 7461 2e73 6861 7065 5b30 5d29 2c20 2d31  ta.shape[0]), -1
+00003400: 2e30 290a 2020 2020 2020 2020 6461 7461  .0).        data
+00003410: 203d 206e 702e 7370 6c69 7428 6461 7461   = np.split(data
+00003420: 2c20 6c69 7374 2872 616e 6765 2877 696e  , list(range(win
+00003430: 646f 775f 7369 7a65 2c20 6461 7461 2e73  dow_size, data.s
+00003440: 6861 7065 5b30 5d2c 2077 696e 646f 775f  hape[0], window_
+00003450: 7369 7a65 2929 290a 2020 2020 2020 2020  size))).        
+00003460: 666f 7220 636e 742c 2069 2069 6e20 656e  for cnt, i in en
+00003470: 756d 6572 6174 6528 7072 616e 6765 2831  umerate(prange(1
+00003480: 2c20 6c65 6e28 6461 7461 2929 293a 0a20  , len(data))):. 
+00003490: 2020 2020 2020 2020 2020 2073 7461 7274             start
+000034a0: 2c20 656e 6420 3d20 696e 7428 2863 6e74  , end = int((cnt
+000034b0: 202b 2031 2920 2a20 7769 6e64 6f77 5f73   + 1) * window_s
+000034c0: 697a 6529 2c20 696e 7428 0a20 2020 2020  ize), int(.     
+000034d0: 2020 2020 2020 2020 2020 2028 2863 6e74             ((cnt
+000034e0: 202b 2031 2920 2a20 7769 6e64 6f77 5f73   + 1) * window_s
+000034f0: 697a 6529 202b 2077 696e 646f 775f 7369  ize) + window_si
+00003500: 7a65 0a20 2020 2020 2020 2020 2020 2029  ze.            )
+00003510: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+00003520: 706c 655f 312c 2073 616d 706c 655f 3220  ple_1, sample_2 
+00003530: 3d20 6461 7461 5b69 202d 2031 5d2c 2064  = data[i - 1], d
+00003540: 6174 615b 695d 0a20 2020 2020 2020 2020  ata[i].         
+00003550: 2020 2063 6f6d 6269 6e65 645f 7361 6d70     combined_samp
+00003560: 6c65 7320 3d20 6e70 2e73 6f72 7428 6e70  les = np.sort(np
+00003570: 2e63 6f6e 6361 7465 6e61 7465 2828 7361  .concatenate((sa
+00003580: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
+00003590: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+000035a0: 6563 6466 5f73 616d 706c 655f 3120 3d20  ecdf_sample_1 = 
+000035b0: 6e70 2e73 6561 7263 6873 6f72 7465 6428  np.searchsorted(
+000035c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000035d0: 2073 616d 706c 655f 312c 2063 6f6d 6269   sample_1, combi
+000035e0: 6e65 645f 7361 6d70 6c65 732c 2073 6964  ned_samples, sid
+000035f0: 653d 2272 6967 6874 220a 2020 2020 2020  e="right".      
+00003600: 2020 2020 2020 2920 2f20 6c65 6e28 7361        ) / len(sa
+00003610: 6d70 6c65 5f31 290a 2020 2020 2020 2020  mple_1).        
+00003620: 2020 2020 6563 6466 5f73 616d 706c 655f      ecdf_sample_
+00003630: 3220 3d20 6e70 2e73 6561 7263 6873 6f72  2 = np.searchsor
+00003640: 7465 6428 0a20 2020 2020 2020 2020 2020  ted(.           
+00003650: 2020 2020 2073 616d 706c 655f 322c 2063       sample_2, c
+00003660: 6f6d 6269 6e65 645f 7361 6d70 6c65 732c  ombined_samples,
+00003670: 2073 6964 653d 2272 6967 6874 220a 2020   side="right".  
+00003680: 2020 2020 2020 2020 2020 2920 2f20 6c65            ) / le
+00003690: 6e28 7361 6d70 6c65 5f32 290a 2020 2020  n(sample_2).    
+000036a0: 2020 2020 2020 2020 6b73 203d 206e 702e          ks = np.
+000036b0: 6d61 7828 6e70 2e61 6273 2865 6364 665f  max(np.abs(ecdf_
+000036c0: 7361 6d70 6c65 5f31 202d 2065 6364 665f  sample_1 - ecdf_
+000036d0: 7361 6d70 6c65 5f32 2929 0a20 2020 2020  sample_2)).     
+000036e0: 2020 2020 2020 2072 6573 756c 7473 5b73         results[s
+000036f0: 7461 7274 3a65 6e64 5d20 3d20 6b73 0a20  tart:end] = ks. 
+00003700: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00003710: 7375 6c74 730a 0a20 2020 2040 7374 6174  sults..    @stat
+00003720: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
+00003730: 6974 280a 2020 2020 2020 2020 5b0a 2020  it(.        [.  
+00003740: 2020 2020 2020 2020 2020 2866 6c6f 6174            (float
+00003750: 3332 5b3a 5d2c 2066 6c6f 6174 3332 5b3a  32[:], float32[:
+00003760: 5d2c 2066 6c6f 6174 3634 5b3a 2c20 3a5d  ], float64[:, :]
+00003770: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+00003780: 666c 6f61 7433 325b 3a5d 2c20 666c 6f61  float32[:], floa
+00003790: 7433 325b 3a5d 2c20 7479 7065 732e 6d69  t32[:], types.mi
+000037a0: 7363 2e4f 6d69 7474 6564 284e 6f6e 6529  sc.Omitted(None)
+000037b0: 292c 0a20 2020 2020 2020 205d 0a20 2020  ),.        ].   
+000037c0: 2029 0a20 2020 2064 6566 2074 776f 5f73   ).    def two_s
+000037d0: 616d 706c 655f 6b73 280a 2020 2020 2020  ample_ks(.      
+000037e0: 2020 7361 6d70 6c65 5f31 3a20 6e70 2e6e    sample_1: np.n
+000037f0: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
+00003800: 7361 6d70 6c65 5f32 3a20 6e70 2e6e 6461  sample_2: np.nda
+00003810: 7272 6179 2c0a 2020 2020 2020 2020 6372  rray,.        cr
+00003820: 6974 6963 616c 5f76 616c 7565 733a 204f  itical_values: O
+00003830: 7074 696f 6e61 6c5b 666c 6f61 7436 345b  ptional[float64[
+00003840: 3a2c 203a 5d5d 203d 204e 6f6e 652c 0a20  :, :]] = None,. 
+00003850: 2020 2029 202d 3e20 2866 6c6f 6174 2c20     ) -> (float, 
+00003860: 556e 696f 6e5b 626f 6f6c 2c20 4e6f 6e65  Union[bool, None
+00003870: 5d29 3a0a 2020 2020 2020 2020 2222 220a  ]):.        """.
+00003880: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
+00003890: 6f6d 7075 7465 2074 6865 2074 776f 2d73  ompute the two-s
+000038a0: 616d 706c 6520 4b6f 6c6d 6f67 6f72 6f76  ample Kolmogorov
+000038b0: 2d53 6d69 726e 6f76 2028 4b53 2920 7465  -Smirnov (KS) te
+000038c0: 7374 2073 7461 7469 7374 6963 2061 6e64  st statistic and
+000038d0: 2c20 6f70 7469 6f6e 616c 6c79 2c20 7465  , optionally, te
+000038e0: 7374 2066 6f72 2073 7461 7469 7374 6963  st for statistic
+000038f0: 616c 2073 6967 6e69 6669 6361 6e63 652e  al significance.
+00003900: 0a0a 2020 2020 2020 2020 5468 6520 7477  ..        The tw
+00003910: 6f2d 7361 6d70 6c65 204b 5320 7465 7374  o-sample KS test
+00003920: 2069 7320 6120 6e6f 6e2d 7061 7261 6d65   is a non-parame
+00003930: 7472 6963 2074 6573 7420 7468 6174 2063  tric test that c
+00003940: 6f6d 7061 7265 7320 7468 6520 6375 6d75  ompares the cumu
+00003950: 6c61 7469 7665 2064 6973 7472 6962 7574  lative distribut
+00003960: 696f 6e20 6675 6e63 7469 6f6e 7320 2845  ion functions (E
+00003970: 4344 4673 2920 6f66 2074 776f 2069 6e64  CDFs) of two ind
+00003980: 6570 656e 6465 6e74 2073 616d 706c 6573  ependent samples
+00003990: 2074 6f20 6173 7365 7373 2077 6865 7468   to assess wheth
+000039a0: 6572 2074 6865 7920 636f 6d65 2066 726f  er they come fro
+000039b0: 6d20 7468 6520 7361 6d65 2064 6973 7472  m the same distr
+000039c0: 6962 7574 696f 6e2e 0a0a 2020 2020 2020  ibution...      
+000039d0: 2020 4b53 2073 7461 7469 7374 6963 2028    KS statistic (
+000039e0: 4429 2069 7320 6361 6c63 756c 6174 6564  D) is calculated
+000039f0: 2061 7320 7468 6520 6d61 7869 6d75 6d20   as the maximum 
+00003a00: 6162 736f 6c75 7465 2064 6966 6665 7265  absolute differe
+00003a10: 6e63 6520 6265 7477 6565 6e20 7468 6520  nce between the 
+00003a20: 656d 7069 7269 6361 6c20 6375 6d75 6c61  empirical cumula
+00003a30: 7469 7665 2064 6973 7472 6962 7574 696f  tive distributio
+00003a40: 6e20 6675 6e63 7469 6f6e 7320 2845 4344  n functions (ECD
+00003a50: 4673 2920 6f66 2074 6865 2074 776f 2073  Fs) of the two s
+00003a60: 616d 706c 6573 2e0a 0a20 2020 2020 2020  amples...       
+00003a70: 202e 2e20 6d61 7468 3a3a 0a20 2020 2020   .. math::.     
+00003a80: 2020 2020 2020 4420 3d20 5c5c 6d61 7828        D = \\max(
+00003a90: 7c20 4543 4446 5f31 2878 2920 2d20 4543  | ECDF_1(x) - EC
+00003aa0: 4446 5f32 2878 2920 7c29 0a0a 2020 2020  DF_2(x) |)..    
+00003ab0: 2020 2020 4966 2060 6372 6974 6963 616c      If `critical
+00003ac0: 5f76 616c 7565 7360 2061 7265 2070 726f  _values` are pro
+00003ad0: 7669 6465 642c 2074 6865 2066 756e 6374  vided, the funct
+00003ae0: 696f 6e20 6368 6563 6b73 2074 6865 2073  ion checks the s
+00003af0: 6967 6e69 6669 6361 6e63 6520 6f66 2074  ignificance of t
+00003b00: 6865 204b 5320 7374 6174 6973 7469 6320  he KS statistic 
+00003b10: 6167 6169 6e73 7420 7468 6520 6372 6974  against the crit
+00003b20: 6963 616c 2076 616c 7565 732e 0a0a 2020  ical values...  
+00003b30: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00003b40: 6e64 6172 7261 7920 6461 7461 3a20 5468  ndarray data: Th
+00003b50: 6520 6669 7273 7420 7361 6d70 6c65 2061  e first sample a
+00003b60: 7272 6179 2066 6f72 2074 6865 204b 5320  rray for the KS 
+00003b70: 7465 7374 2e0a 2020 2020 2020 2020 3a70  test..        :p
+00003b80: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+00003b90: 6461 7461 3a20 5468 6520 7365 636f 6e64  data: The second
+00003ba0: 2073 616d 706c 6520 6172 7261 7920 666f   sample array fo
+00003bb0: 7220 7468 6520 4b53 2074 6573 742e 0a20  r the KS test.. 
+00003bc0: 2020 2020 2020 203a 7061 7261 6d20 4f70         :param Op
+00003bd0: 7469 6f6e 616c 5b66 6c6f 6174 3634 5b3a  tional[float64[:
+00003be0: 2c20 3a5d 5d20 6372 6974 6963 616c 5f76  , :]] critical_v
+00003bf0: 616c 7565 733a 2041 6e20 6172 7261 7920  alues: An array 
+00003c00: 6f66 2063 7269 7469 6361 6c20 7661 6c75  of critical valu
+00003c10: 6573 2066 6f72 2074 6865 204b 5320 7465  es for the KS te
+00003c20: 7374 2e20 4966 2070 726f 7669 6465 642c  st. If provided,
+00003c30: 2074 6865 2066 756e 6374 696f 6e20 7769   the function wi
+00003c40: 6c6c 2061 6c73 6f20 6368 6563 6b20 7468  ll also check th
+00003c50: 6520 7369 676e 6966 6963 616e 6365 206f  e significance o
+00003c60: 6620 7468 6520 4b53 2073 7461 7469 7374  f the KS statist
+00003c70: 6963 2061 6761 696e 7374 2074 6865 2063  ic against the c
+00003c80: 7269 7469 6361 6c20 7661 6c75 6573 2e20  ritical values. 
+00003c90: 4465 6661 756c 743a 204e 6f6e 652e 0a20  Default: None.. 
+00003ca0: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
+00003cb0: 2866 6c6f 6174 2055 6e69 6f6e 5b62 6f6f  (float Union[boo
+00003cc0: 6c2c 204e 6f6e 655d 293a 2052 6574 7572  l, None]): Retur
+00003cd0: 6e73 2061 2074 7570 6c65 2063 6f6e 7461  ns a tuple conta
+00003ce0: 696e 696e 6720 7468 6520 4b53 2073 7461  ining the KS sta
+00003cf0: 7469 7374 6963 2061 6e64 2061 2062 6f6f  tistic and a boo
+00003d00: 6c65 616e 2069 6e64 6963 6174 696e 6720  lean indicating 
+00003d10: 7768 6574 6865 7220 7468 6520 7465 7374  whether the test
+00003d20: 2069 7320 7374 6174 6973 7469 6361 6c6c   is statisticall
+00003d30: 7920 7369 676e 6966 6963 616e 742e 0a0a  y significant...
+00003d40: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+00003d50: 3a0a 2020 2020 2020 2020 3e3e 3e20 7361  :.        >>> sa
+00003d60: 6d70 6c65 5f31 203d 206e 702e 6172 7261  mple_1 = np.arra
+00003d70: 7928 5b31 2c20 322c 2033 2c20 312c 2033  y([1, 2, 3, 1, 3
+00003d80: 2c20 322c 2031 2c20 3130 2c20 382c 2034  , 2, 1, 10, 8, 4
+00003d90: 2c20 3130 5d29 2e61 7374 7970 6528 6e70  , 10]).astype(np
+00003da0: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+00003db0: 2020 3e3e 3e20 7361 6d70 6c65 5f32 203d    >>> sample_2 =
+00003dc0: 206e 702e 6172 7261 7928 5b31 302c 2035   np.array([10, 5
+00003dd0: 2c20 3130 2c20 342c 2038 2c20 3130 2c20  , 10, 4, 8, 10, 
+00003de0: 372c 2031 302c 2037 2c20 3130 2c20 3130  7, 10, 7, 10, 10
+00003df0: 5d29 2e61 7374 7970 6528 6e70 2e66 6c6f  ]).astype(np.flo
+00003e00: 6174 3332 290a 2020 2020 2020 2020 3e3e  at32).        >>
+00003e10: 3e20 6372 6974 6963 616c 5f76 616c 7565  > critical_value
+00003e20: 7320 3d20 7069 636b 6c65 2e6c 6f61 6428  s = pickle.load(
+00003e30: 6f70 656e 2822 7369 6d62 612f 6173 7365  open("simba/asse
+00003e40: 7473 2f6c 6f6f 6b75 7073 2f63 7269 7469  ts/lookups/criti
+00003e50: 6361 6c5f 7661 6c75 6573 5f35 2e70 6963  cal_values_5.pic
+00003e60: 6b6c 6522 2c20 2272 6222 2929 5b27 7477  kle", "rb"))['tw
+00003e70: 6f5f 7361 6d70 6c65 5f4b 5327 5d5b 276f  o_sample_KS']['o
+00003e80: 6e65 5f74 6169 6c27 5d2e 7661 6c75 6573  ne_tail'].values
+00003e90: 0a20 2020 2020 2020 203e 3e3e 2074 776f  .        >>> two
+00003ea0: 5f73 616d 706c 655f 6b73 2873 616d 706c  _sample_ks(sampl
+00003eb0: 655f 313d 7361 6d70 6c65 5f31 2c20 7361  e_1=sample_1, sa
+00003ec0: 6d70 6c65 5f32 3d73 616d 706c 655f 322c  mple_2=sample_2,
+00003ed0: 2063 7269 7469 6361 6c5f 7661 6c75 6573   critical_values
+00003ee0: 3d63 7269 7469 6361 6c5f 7661 6c75 6573  =critical_values
+00003ef0: 290a 2020 2020 2020 2020 3e3e 3e20 2830  ).        >>> (0
+00003f00: 2e37 3237 3237 3237 3237 3237 3237 3237  .727272727272727
+00003f10: 332c 2054 7275 6529 0a20 2020 2020 2020  3, True).       
+00003f20: 2022 2222 0a20 2020 2020 2020 2073 6967   """.        sig
+00003f30: 6e69 6669 6361 6e63 655f 626f 6f6c 203d  nificance_bool =
+00003f40: 204e 6f6e 650a 2020 2020 2020 2020 636f   None.        co
+00003f50: 6d62 696e 6564 5f73 616d 706c 6573 203d  mbined_samples =
+00003f60: 206e 702e 736f 7274 286e 702e 636f 6e63   np.sort(np.conc
+00003f70: 6174 656e 6174 6528 2873 616d 706c 655f  atenate((sample_
+00003f80: 312c 2073 616d 706c 655f 3229 2929 0a20  1, sample_2))). 
+00003f90: 2020 2020 2020 2065 6364 665f 7361 6d70         ecdf_samp
+00003fa0: 6c65 5f31 203d 206e 702e 7365 6172 6368  le_1 = np.search
+00003fb0: 736f 7274 6564 2873 616d 706c 655f 312c  sorted(sample_1,
+00003fc0: 2063 6f6d 6269 6e65 645f 7361 6d70 6c65   combined_sample
+00003fd0: 732c 2073 6964 653d 2272 6967 6874 2229  s, side="right")
+00003fe0: 202f 206c 656e 280a 2020 2020 2020 2020   / len(.        
+00003ff0: 2020 2020 7361 6d70 6c65 5f31 0a20 2020      sample_1.   
+00004000: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00004010: 6364 665f 7361 6d70 6c65 5f32 203d 206e  cdf_sample_2 = n
+00004020: 702e 7365 6172 6368 736f 7274 6564 2873  p.searchsorted(s
+00004030: 616d 706c 655f 322c 2063 6f6d 6269 6e65  ample_2, combine
+00004040: 645f 7361 6d70 6c65 732c 2073 6964 653d  d_samples, side=
+00004050: 2272 6967 6874 2229 202f 206c 656e 280a  "right") / len(.
+00004060: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00004070: 6c65 5f32 0a20 2020 2020 2020 2029 0a20  le_2.        ). 
+00004080: 2020 2020 2020 206b 7320 3d20 6e70 2e6d         ks = np.m
+00004090: 6178 286e 702e 6162 7328 6563 6466 5f73  ax(np.abs(ecdf_s
+000040a0: 616d 706c 655f 3120 2d20 6563 6466 5f73  ample_1 - ecdf_s
+000040b0: 616d 706c 655f 3229 290a 2020 2020 2020  ample_2)).      
+000040c0: 2020 6966 2063 7269 7469 6361 6c5f 7661    if critical_va
+000040d0: 6c75 6573 2069 7320 6e6f 7420 4e6f 6e65  lues is not None
+000040e0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+000040f0: 6d62 696e 6564 5f73 616d 706c 655f 7369  mbined_sample_si
+00004100: 7a65 203d 206c 656e 2873 616d 706c 655f  ze = len(sample_
+00004110: 3129 202b 206c 656e 2873 616d 706c 655f  1) + len(sample_
+00004120: 3229 0a20 2020 2020 2020 2020 2020 2063  2).            c
+00004130: 7269 7469 6361 6c5f 7661 6c75 6520 3d20  ritical_value = 
+00004140: 6e70 2e69 6e74 6572 7028 0a20 2020 2020  np.interp(.     
+00004150: 2020 2020 2020 2020 2020 2063 6f6d 6269             combi
+00004160: 6e65 645f 7361 6d70 6c65 5f73 697a 652c  ned_sample_size,
+00004170: 2063 7269 7469 6361 6c5f 7661 6c75 6573   critical_values
+00004180: 5b3a 2c20 305d 2c20 6372 6974 6963 616c  [:, 0], critical
+00004190: 5f76 616c 7565 735b 3a2c 2031 5d0a 2020  _values[:, 1].  
+000041a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000041b0: 2020 2020 2020 2020 6966 2063 7269 7469          if criti
+000041c0: 6361 6c5f 7661 6c75 6520 3c20 6162 7328  cal_value < abs(
+000041d0: 6b73 293a 0a20 2020 2020 2020 2020 2020  ks):.           
+000041e0: 2020 2020 2073 6967 6e69 6669 6361 6e63       significanc
+000041f0: 655f 626f 6f6c 203d 2054 7275 650a 2020  e_bool = True.  
+00004200: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00004210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004220: 7369 676e 6966 6963 616e 6365 5f62 6f6f  significance_boo
+00004230: 6c20 3d20 4661 6c73 650a 2020 2020 2020  l = False.      
+00004240: 2020 7265 7475 726e 2028 6b73 2c20 7369    return (ks, si
+00004250: 676e 6966 6963 616e 6365 5f62 6f6f 6c29  gnificance_bool)
+00004260: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00004270: 686f 640a 2020 2020 406a 6974 286e 6f70  hod.    @jit(nop
+00004280: 7974 686f 6e3d 5472 7565 290a 2020 2020  ython=True).    
+00004290: 6465 6620 6f6e 655f 7761 795f 616e 6f76  def one_way_anov
+000042a0: 6128 0a20 2020 2020 2020 2073 616d 706c  a(.        sampl
+000042b0: 655f 313a 206e 702e 6e64 6172 7261 792c  e_1: np.ndarray,
+000042c0: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
+000042d0: 323a 206e 702e 6e64 6172 7261 792c 0a20  2: np.ndarray,. 
+000042e0: 2020 2020 2020 2063 7269 7469 6361 6c5f         critical_
+000042f0: 7661 6c75 6573 3a20 4f70 7469 6f6e 616c  values: Optional
+00004300: 5b6e 702e 6e64 6172 7261 795d 203d 204e  [np.ndarray] = N
+00004310: 6f6e 652c 0a20 2020 2029 202d 3e20 2866  one,.    ) -> (f
+00004320: 6c6f 6174 2c20 666c 6f61 7429 3a0a 2020  loat, float):.  
+00004330: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00004340: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
+00004350: 206f 6620 6f6e 652d 7761 7920 414e 4f56   of one-way ANOV
+00004360: 4120 4620 7374 6174 6973 7469 6373 2061  A F statistics a
+00004370: 6e64 2061 7373 6f63 6961 7465 6420 702d  nd associated p-
+00004380: 7661 6c75 6520 666f 7220 7477 6f20 6469  value for two di
+00004390: 7374 7269 6275 7469 6f6e 732e 0a0a 2020  stributions...  
+000043a0: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+000043b0: 206e 6461 7272 6179 2073 616d 706c 655f   ndarray sample_
+000043c0: 313a 2046 6972 7374 2031 6420 6172 7261  1: First 1d arra
+000043d0: 7920 7265 7072 6573 656e 7469 6e67 2066  y representing f
+000043e0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+000043f0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00004400: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
+00004410: 5f32 3a20 5365 636f 6e64 2031 6420 6172  _2: Second 1d ar
+00004420: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
+00004430: 2066 6561 7475 7265 2076 616c 7565 732e   feature values.
+00004440: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00004450: 7320 2866 6c6f 6174 2066 6c6f 6174 293a  s (float float):
+00004460: 2052 6570 7265 7365 6e74 696e 6720 414e   Representing AN
+00004470: 4f56 4120 4620 7374 6174 6973 7469 6320  OVA F statistic 
+00004480: 616e 6420 6173 736f 6369 6174 6564 2070  and associated p
+00004490: 726f 6261 6269 6c69 7479 2076 616c 7565  robability value
+000044a0: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+000044b0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+000044c0: 2073 616d 706c 655f 3120 3d20 6e70 2e61   sample_1 = np.a
+000044d0: 7272 6179 285b 312c 2032 2c20 332c 2031  rray([1, 2, 3, 1
+000044e0: 2c20 332c 2032 2c20 312c 2031 302c 2038  , 3, 2, 1, 10, 8
+000044f0: 2c20 342c 2031 305d 290a 2020 2020 2020  , 4, 10]).      
+00004500: 2020 3e3e 3e20 7361 6d70 6c65 5f32 203d    >>> sample_2 =
+00004510: 206e 702e 6172 7261 7928 5b38 2c20 352c   np.array([8, 5,
+00004520: 2035 2c20 382c 2038 2c20 392c 2031 302c   5, 8, 8, 9, 10,
+00004530: 2031 2c20 372c 2031 302c 2031 305d 290a   1, 7, 10, 10]).
+00004540: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
+00004550: 6973 7469 6373 2829 2e6f 6e65 5f77 6179  istics().one_way
+00004560: 5f61 6e6f 7661 2873 616d 706c 655f 313d  _anova(sample_1=
+00004570: 7361 6d70 6c65 5f32 2c20 7361 6d70 6c65  sample_2, sample
+00004580: 5f32 3d73 616d 706c 655f 3129 0a20 2020  _2=sample_1).   
+00004590: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+000045a0: 2020 7369 676e 6966 6963 616e 6365 5f62    significance_b
+000045b0: 6f6f 6c20 3d20 4e6f 6e65 0a20 2020 2020  ool = None.     
+000045c0: 2020 206e 312c 206e 3220 3d20 6c65 6e28     n1, n2 = len(
+000045d0: 7361 6d70 6c65 5f31 292c 206c 656e 2873  sample_1), len(s
+000045e0: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
+000045f0: 206d 312c 206d 3220 3d20 6e70 2e6d 6561   m1, m2 = np.mea
+00004600: 6e28 7361 6d70 6c65 5f31 292c 206e 702e  n(sample_1), np.
+00004610: 6d65 616e 2873 616d 706c 655f 3229 0a20  mean(sample_2). 
+00004620: 2020 2020 2020 2073 735f 6265 7477 6565         ss_betwee
+00004630: 6e20 3d20 280a 2020 2020 2020 2020 2020  n = (.          
+00004640: 2020 6e31 202a 2028 6d31 202d 206e 702e    n1 * (m1 - np.
+00004650: 6d65 616e 286e 702e 636f 6e63 6174 656e  mean(np.concaten
+00004660: 6174 6528 2873 616d 706c 655f 312c 2073  ate((sample_1, s
+00004670: 616d 706c 655f 3229 2929 2920 2a2a 2032  ample_2)))) ** 2
+00004680: 0a20 2020 2020 2020 2020 2020 202b 206e  .            + n
+00004690: 3220 2a20 286d 3220 2d20 6e70 2e6d 6561  2 * (m2 - np.mea
+000046a0: 6e28 6e70 2e63 6f6e 6361 7465 6e61 7465  n(np.concatenate
+000046b0: 2828 7361 6d70 6c65 5f31 2c20 7361 6d70  ((sample_1, samp
+000046c0: 6c65 5f32 2929 2929 202a 2a20 320a 2020  le_2)))) ** 2.  
+000046d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000046e0: 7373 5f77 6974 6869 6e20 3d20 6e70 2e73  ss_within = np.s
+000046f0: 756d 2828 7361 6d70 6c65 5f31 202d 206d  um((sample_1 - m
+00004700: 3129 202a 2a20 3229 202b 206e 702e 7375  1) ** 2) + np.su
+00004710: 6d28 2873 616d 706c 655f 3220 2d20 6d32  m((sample_2 - m2
+00004720: 2920 2a2a 2032 290a 2020 2020 2020 2020  ) ** 2).        
+00004730: 6466 5f62 6574 7765 656e 2c20 6466 5f77  df_between, df_w
+00004740: 6974 6869 6e20 3d20 312c 206e 3120 2b20  ithin = 1, n1 + 
+00004750: 6e32 202d 2032 0a20 2020 2020 2020 206d  n2 - 2.        m
+00004760: 735f 6265 7477 6565 6e2c 206d 735f 7769  s_between, ms_wi
+00004770: 7468 696e 203d 2073 735f 6265 7477 6565  thin = ss_betwee
+00004780: 6e20 2f20 6466 5f62 6574 7765 656e 2c20  n / df_between, 
+00004790: 7373 5f77 6974 6869 6e20 2f20 6466 5f77  ss_within / df_w
+000047a0: 6974 6869 6e0a 2020 2020 2020 2020 6620  ithin.        f 
+000047b0: 3d20 6d73 5f62 6574 7765 656e 202f 206d  = ms_between / m
+000047c0: 735f 7769 7468 696e 0a20 2020 2020 2020  s_within.       
+000047d0: 2069 6620 6372 6974 6963 616c 5f76 616c   if critical_val
+000047e0: 7565 7320 6973 206e 6f74 204e 6f6e 653a  ues is not None:
+000047f0: 0a20 2020 2020 2020 2020 2020 2063 7269  .            cri
+00004800: 7469 6361 6c5f 7661 6c75 6573 203d 2063  tical_values = c
+00004810: 7269 7469 6361 6c5f 7661 6c75 6573 5b3a  ritical_values[:
+00004820: 2c20 6e70 2e61 7272 6179 285b 302c 2064  , np.array([0, d
+00004830: 665f 6265 7477 6565 6e5d 295d 0a20 2020  f_between])].   
+00004840: 2020 2020 2020 2020 2063 7269 7469 6361           critica
+00004850: 6c5f 7661 6c75 6520 3d20 6e70 2e69 6e74  l_value = np.int
+00004860: 6572 7028 0a20 2020 2020 2020 2020 2020  erp(.           
+00004870: 2020 2020 2064 665f 7769 7468 696e 2c20       df_within, 
+00004880: 6372 6974 6963 616c 5f76 616c 7565 735b  critical_values[
+00004890: 3a2c 2030 5d2c 2063 7269 7469 6361 6c5f  :, 0], critical_
+000048a0: 7661 6c75 6573 5b3a 2c20 315d 0a20 2020  values[:, 1].   
+000048b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000048c0: 2020 2020 2020 2069 6620 6620 3e20 6372         if f > cr
+000048d0: 6974 6963 616c 5f76 616c 7565 3a0a 2020  itical_value:.  
+000048e0: 2020 2020 2020 2020 2020 2020 2020 7369                si
+000048f0: 676e 6966 6963 616e 6365 5f62 6f6f 6c20  gnificance_bool 
+00004900: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00004910: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00004920: 2020 2020 2020 2020 2073 6967 6e69 6669           signifi
+00004930: 6361 6e63 655f 626f 6f6c 203d 2046 616c  cance_bool = Fal
+00004940: 7365 0a0a 2020 2020 2020 2020 7265 7475  se..        retu
+00004950: 726e 2028 662c 2073 6967 6e69 6669 6361  rn (f, significa
+00004960: 6e63 655f 626f 6f6c 290a 0a20 2020 2040  nce_bool)..    @
+00004970: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00004980: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
+00004990: 5b3a 5d2c 2066 6c6f 6174 3634 5b3a 5d2c  [:], float64[:],
+000049a0: 2066 6c6f 6174 3634 2922 2c20 6361 6368   float64)", cach
+000049b0: 653d 5472 7565 290a 2020 2020 6465 6620  e=True).    def 
+000049c0: 726f 6c6c 696e 675f 6f6e 655f 7761 795f  rolling_one_way_
+000049d0: 616e 6f76 6128 0a20 2020 2020 2020 2064  anova(.        d
+000049e0: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+000049f0: 2074 696d 655f 7769 6e64 6f77 733a 206e   time_windows: n
+00004a00: 702e 6e64 6172 7261 792c 2066 7073 3a20  p.ndarray, fps: 
+00004a10: 696e 740a 2020 2020 2920 2d3e 206e 702e  int.    ) -> np.
+00004a20: 6e64 6172 7261 793a 0a20 2020 2020 2020  ndarray:.       
+00004a30: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+00004a40: 7465 6420 636f 6d70 7574 6520 6f66 2072  ted compute of r
+00004a50: 6f6c 6c69 6e67 206f 6e65 2d77 6179 2041  olling one-way A
+00004a60: 4e4f 5641 2046 2d73 7461 7469 7374 6963  NOVA F-statistic
+00004a70: 2063 6f6d 7061 7269 6e67 2074 6865 2063   comparing the c
+00004a80: 7572 7265 6e74 2074 696d 652d 7769 6e64  urrent time-wind
+00004a90: 6f77 206f 660a 2020 2020 2020 2020 7369  ow of.        si
+00004aa0: 7a65 204e 2074 6f20 7468 6520 7072 6563  ze N to the prec
+00004ab0: 6564 696e 6720 7769 6e64 6f77 206f 6620  eding window of 
+00004ac0: 7369 7a65 204e 2e0a 0a20 2020 2020 2020  size N...       
+00004ad0: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
+00004ae0: 7261 7920 6461 7461 3a20 3144 2061 7272  ray data: 1D arr
+00004af0: 6179 206f 6620 7369 7a65 206c 656e 2866  ay of size len(f
+00004b00: 7261 6d65 7329 2072 6570 7265 7365 6e74  rames) represent
+00004b10: 696e 6720 6665 6174 7572 6520 7661 6c75  ing feature valu
+00004b20: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
+00004b30: 616d 6574 6572 206e 702e 6e64 6172 7261  ameter np.ndarra
+00004b40: 795b 696e 7473 5d20 7469 6d65 5f77 696e  y[ints] time_win
+00004b50: 646f 7773 3a20 5469 6d65 2077 696e 646f  dows: Time windo
+00004b60: 7773 2074 6f20 636f 6d70 7574 6520 414e  ws to compute AN
+00004b70: 4f56 4173 2066 6f72 2069 6e20 7365 636f  OVAs for in seco
+00004b80: 6e64 732e 0a20 2020 2020 2020 203a 7061  nds..        :pa
+00004b90: 7261 6d65 7465 7220 696e 7420 6670 733a  rameter int fps:
+00004ba0: 2046 7261 6d65 2d72 6174 6520 6f66 2072   Frame-rate of r
+00004bb0: 6563 6f72 6465 6420 7669 6465 6f2e 0a0a  ecorded video...
+00004bc0: 2020 2020 2020 2020 2e2e 2069 6d61 6765          .. image
+00004bd0: 3a3a 205f 7374 6174 6963 2f69 6d67 2f72  :: _static/img/r
+00004be0: 6f6c 6c69 6e67 5f61 6e6f 7661 2e70 6e67  olling_anova.png
+00004bf0: 0a20 2020 2020 2020 2020 2020 3a77 6964  .           :wid
+00004c00: 7468 3a20 3630 300a 2020 2020 2020 2020  th: 600.        
+00004c10: 2020 203a 616c 6967 6e3a 2063 656e 7465     :align: cente
+00004c20: 720a 0a20 2020 2020 2020 203a 6578 616d  r..        :exam
+00004c30: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00004c40: 2073 616d 706c 6520 3d20 6e70 2e72 616e   sample = np.ran
+00004c50: 646f 6d2e 6e6f 726d 616c 286c 6f63 3d31  dom.normal(loc=1
+00004c60: 302c 2073 6361 6c65 3d31 2c20 7369 7a65  0, scale=1, size
+00004c70: 3d31 3029 2e61 7374 7970 6528 6e70 2e66  =10).astype(np.f
+00004c80: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+00004c90: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
+00004ca0: 2e72 6f6c 6c69 6e67 5f6f 6e65 5f77 6179  .rolling_one_way
+00004cb0: 5f61 6e6f 7661 2864 6174 613d 7361 6d70  _anova(data=samp
+00004cc0: 6c65 2c20 7469 6d65 5f77 696e 646f 7773  le, time_windows
+00004cd0: 3d6e 702e 6172 7261 7928 5b31 2e30 5d29  =np.array([1.0])
+00004ce0: 2c20 6670 733d 3229 0a20 2020 2020 2020  , fps=2).       
+00004cf0: 203e 3e3e 205b 5b30 2e30 3030 3030 3030   >>> [[0.0000000
+00004d00: 3065 2b30 305d 5b30 2e30 3030 3030 3030  0e+00][0.0000000
+00004d10: 3065 2b30 305d 5b32 2e32 3632 3231 3236  0e+00][2.2622126
+00004d20: 3365 2d30 365d 5b32 2e32 3632 3231 3236  3e-06][2.2622126
+00004d30: 3365 2d30 365d 5b35 2e33 3931 3139 3935  3e-06][5.3911995
+00004d40: 3065 2d30 335d 5b35 2e33 3931 3139 3935  0e-03][5.3911995
+00004d50: 3065 2d30 335d 5b31 2e34 3637 3235 3438  0e-03][1.4672548
+00004d60: 3665 2d30 335d 5b31 2e34 3637 3235 3438  6e-03][1.4672548
+00004d70: 3665 2d30 335d 5b31 2e31 3633 3932 3131  6e-03][1.1639211
+00004d80: 3165 2d30 325d 5b31 2e31 3633 3932 3131  1e-02][1.1639211
+00004d90: 3165 2d30 325d 5d0a 2020 2020 2020 2020  1e-02]].        
+00004da0: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
+00004db0: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
+00004dc0: 6461 7461 2e73 6861 7065 5b30 5d2c 2074  data.shape[0], t
+00004dd0: 696d 655f 7769 6e64 6f77 732e 7368 6170  ime_windows.shap
+00004de0: 655b 305d 292c 2030 2e30 290a 2020 2020  e[0]), 0.0).    
+00004df0: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
+00004e00: 6e67 6528 7469 6d65 5f77 696e 646f 7773  nge(time_windows
+00004e10: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
+00004e20: 2020 2020 2020 2020 7769 6e64 6f77 5f73          window_s
+00004e30: 697a 6520 3d20 696e 7428 7469 6d65 5f77  ize = int(time_w
+00004e40: 696e 646f 7773 5b69 5d20 2a20 6670 7329  indows[i] * fps)
+00004e50: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+00004e60: 615f 7370 6c69 7420 3d20 6e70 2e73 706c  a_split = np.spl
+00004e70: 6974 280a 2020 2020 2020 2020 2020 2020  it(.            
+00004e80: 2020 2020 6461 7461 2c20 6c69 7374 2872      data, list(r
+00004e90: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
+00004ea0: 2c20 6461 7461 2e73 6861 7065 5b30 5d2c  , data.shape[0],
+00004eb0: 2077 696e 646f 775f 7369 7a65 2929 0a20   window_size)). 
+00004ec0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00004ed0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+00004ee0: 6e20 7072 616e 6765 2831 2c20 6c65 6e28  n prange(1, len(
+00004ef0: 6461 7461 5f73 706c 6974 2929 3a0a 2020  data_split)):.  
+00004f00: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00004f10: 6e64 6f77 5f73 7461 7274 203d 2069 6e74  ndow_start = int
+00004f20: 2877 696e 646f 775f 7369 7a65 202a 206a  (window_size * j
+00004f30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00004f40: 2020 7769 6e64 6f77 5f65 6e64 203d 2069    window_end = i
+00004f50: 6e74 2877 696e 646f 775f 7374 6172 7420  nt(window_start 
+00004f60: 2b20 7769 6e64 6f77 5f73 697a 6529 0a20  + window_size). 
+00004f70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00004f80: 616d 706c 655f 312c 2073 616d 706c 655f  ample_1, sample_
+00004f90: 3220 3d20 6461 7461 5f73 706c 6974 5b6a  2 = data_split[j
+00004fa0: 202d 2031 5d2e 6173 7479 7065 286e 702e   - 1].astype(np.
+00004fb0: 666c 6f61 7433 3229 2c20 6461 7461 5f73  float32), data_s
+00004fc0: 706c 6974 5b0a 2020 2020 2020 2020 2020  plit[.          
+00004fd0: 2020 2020 2020 2020 2020 6a0a 2020 2020            j.    
+00004fe0: 2020 2020 2020 2020 2020 2020 5d2e 6173              ].as
+00004ff0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+00005000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005010: 206e 312c 206e 3220 3d20 6c65 6e28 7361   n1, n2 = len(sa
+00005020: 6d70 6c65 5f31 292c 206c 656e 2873 616d  mple_1), len(sam
+00005030: 706c 655f 3229 0a20 2020 2020 2020 2020  ple_2).         
+00005040: 2020 2020 2020 206d 312c 206d 3220 3d20         m1, m2 = 
+00005050: 6e70 2e6d 6561 6e28 7361 6d70 6c65 5f31  np.mean(sample_1
+00005060: 292c 206e 702e 6d65 616e 2873 616d 706c  ), np.mean(sampl
+00005070: 655f 3229 0a20 2020 2020 2020 2020 2020  e_2).           
+00005080: 2020 2020 2073 735f 6265 7477 6565 6e20       ss_between 
+00005090: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000050a0: 2020 2020 2020 2020 6e31 202a 2028 6d31          n1 * (m1
+000050b0: 202d 206e 702e 6d65 616e 286e 702e 636f   - np.mean(np.co
+000050c0: 6e63 6174 656e 6174 6528 2873 616d 706c  ncatenate((sampl
+000050d0: 655f 312c 2073 616d 706c 655f 3229 2929  e_1, sample_2)))
+000050e0: 2920 2a2a 2032 0a20 2020 2020 2020 2020  ) ** 2.         
+000050f0: 2020 2020 2020 2020 2020 202b 206e 3220             + n2 
+00005100: 2a20 286d 3220 2d20 6e70 2e6d 6561 6e28  * (m2 - np.mean(
+00005110: 6e70 2e63 6f6e 6361 7465 6e61 7465 2828  np.concatenate((
+00005120: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+00005130: 5f32 2929 2929 202a 2a20 320a 2020 2020  _2)))) ** 2.    
+00005140: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00005150: 2020 2020 2020 2020 2020 2020 2020 7373                ss
+00005160: 5f77 6974 6869 6e20 3d20 6e70 2e73 756d  _within = np.sum
+00005170: 2828 7361 6d70 6c65 5f31 202d 206d 3129  ((sample_1 - m1)
+00005180: 202a 2a20 3229 202b 206e 702e 7375 6d28   ** 2) + np.sum(
+00005190: 2873 616d 706c 655f 3220 2d20 6d32 2920  (sample_2 - m2) 
+000051a0: 2a2a 2032 290a 2020 2020 2020 2020 2020  ** 2).          
+000051b0: 2020 2020 2020 6466 5f62 6574 7765 656e        df_between
+000051c0: 2c20 6466 5f77 6974 6869 6e20 3d20 312c  , df_within = 1,
+000051d0: 206e 3120 2b20 6e32 202d 2032 0a20 2020   n1 + n2 - 2.   
+000051e0: 2020 2020 2020 2020 2020 2020 206d 735f               ms_
+000051f0: 6265 7477 6565 6e2c 206d 735f 7769 7468  between, ms_with
+00005200: 696e 203d 2073 735f 6265 7477 6565 6e20  in = ss_between 
+00005210: 2f20 6466 5f62 6574 7765 656e 2c20 7373  / df_between, ss
+00005220: 5f77 6974 6869 6e20 2f20 6466 5f77 6974  _within / df_wit
+00005230: 6869 6e0a 2020 2020 2020 2020 2020 2020  hin.            
+00005240: 2020 2020 6620 3d20 6d73 5f62 6574 7765      f = ms_betwe
+00005250: 656e 202f 206d 735f 7769 7468 696e 0a20  en / ms_within. 
+00005260: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00005270: 6573 756c 7473 5b77 696e 646f 775f 7374  esults[window_st
+00005280: 6172 743a 7769 6e64 6f77 5f65 6e64 2c20  art:window_end, 
+00005290: 695d 203d 2066 0a0a 2020 2020 2020 2020  i] = f..        
+000052a0: 7265 7475 726e 2072 6573 756c 7473 0a0a  return results..
+000052b0: 2020 2020 6465 6620 6b75 6c6c 6261 636b      def kullback
+000052c0: 5f6c 6569 626c 6572 5f64 6976 6572 6765  _leibler_diverge
+000052d0: 6e63 6528 0a20 2020 2020 2020 2073 656c  nce(.        sel
+000052e0: 662c 0a20 2020 2020 2020 2073 616d 706c  f,.        sampl
+000052f0: 655f 313a 206e 702e 6e64 6172 7261 792c  e_1: np.ndarray,
+00005300: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
+00005310: 323a 206e 702e 6e64 6172 7261 792c 0a20  2: np.ndarray,. 
+00005320: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
+00005330: 653a 204f 7074 696f 6e61 6c5b 696e 745d  e: Optional[int]
+00005340: 203d 2031 2c0a 2020 2020 2020 2020 6275   = 1,.        bu
+00005350: 636b 6574 5f6d 6574 686f 643a 204c 6974  cket_method: Lit
+00005360: 6572 616c 5b0a 2020 2020 2020 2020 2020  eral[.          
+00005370: 2020 2266 6422 2c20 2264 6f61 6e65 222c    "fd", "doane",
+00005380: 2022 6175 746f 222c 2022 7363 6f74 7422   "auto", "scott"
+00005390: 2c20 2273 746f 6e65 222c 2022 7269 6365  , "stone", "rice
+000053a0: 222c 2022 7374 7572 6765 7322 2c20 2273  ", "sturges", "s
+000053b0: 7172 7422 0a20 2020 2020 2020 205d 203d  qrt".        ] =
+000053c0: 2022 6175 746f 222c 0a20 2020 2029 202d   "auto",.    ) -
+000053d0: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
+000053e0: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
+000053f0: 7075 7465 204b 756c 6c62 6163 6b2d 4c65  pute Kullback-Le
+00005400: 6962 6c65 7220 6469 7665 7267 656e 6365  ibler divergence
+00005410: 2062 6574 7765 656e 2074 776f 2064 6973   between two dis
+00005420: 7472 6962 7574 696f 6e73 2e0a 0a20 2020  tributions...   
+00005430: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a20       .. note::. 
+00005440: 2020 2020 2020 2020 2020 456d 7074 7920            Empty 
+00005450: 6269 6e73 2028 3020 6f62 7365 7276 6174  bins (0 observat
+00005460: 696f 6e73 2069 6e20 6269 6e29 2069 6e20  ions in bin) in 
+00005470: 6973 2072 6570 6c61 6365 6420 7769 7468  is replaced with
+00005480: 2070 6173 7365 6420 6060 6669 6c6c 5f76   passed ``fill_v
+00005490: 616c 7565 6060 2e0a 0a20 2020 2020 2020  alue``...       
+000054a0: 2020 2020 4974 7320 7261 6e67 6520 6973      Its range is
+000054b0: 2066 726f 6d20 3020 746f 2070 6f73 6974   from 0 to posit
+000054c0: 6976 6520 696e 6669 6e69 7479 2e20 5768  ive infinity. Wh
+000054d0: 656e 2074 6865 204b 4c20 6469 7665 7267  en the KL diverg
+000054e0: 656e 6365 2069 7320 7a65 726f 2c20 6974  ence is zero, it
+000054f0: 2069 6e64 6963 6174 6573 2074 6861 7420   indicates that 
+00005500: 7468 6520 7477 6f20 6469 7374 7269 6275  the two distribu
+00005510: 7469 6f6e 7320 6172 6520 6964 656e 7469  tions are identi
+00005520: 6361 6c2e 2041 7320 7468 6520 4b4c 2064  cal. As the KL d
+00005530: 6976 6572 6765 6e63 6520 696e 6372 6561  ivergence increa
+00005540: 7365 732c 2069 7420 7369 676e 6966 6965  ses, it signifie
+00005550: 7320 616e 2069 6e63 7265 6173 696e 6720  s an increasing 
+00005560: 6469 6666 6572 656e 6365 2062 6574 7765  difference betwe
+00005570: 656e 2074 6865 2064 6973 7472 6962 7574  en the distribut
+00005580: 696f 6e73 2e0a 0a20 2020 2020 2020 2020  ions...         
+00005590: 2020 2e2e 206d 6174 683a 3a0a 2020 2020    .. math::.    
+000055a0: 2020 2020 2020 2020 2020 5c74 6578 747b            \text{
+000055b0: 4b4c 7d28 5020 7c7c 2051 2920 3d20 5c73  KL}(P || Q) = \s
+000055c0: 756d 7b50 2878 2920 5c6c 6f67 7b5c 6c65  um{P(x) \log{\le
+000055d0: 6674 285c 6672 6163 7b50 2878 297d 7b51  ft(\frac{P(x)}{Q
+000055e0: 2878 297d 5c72 6967 6874 297d 7d0a 0a20  (x)}\right)}}.. 
+000055f0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00005600: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
+00005610: 5f31 3a20 4669 7273 7420 3164 2061 7272  _1: First 1d arr
+00005620: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+00005630: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+00005640: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+00005650: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
+00005660: 655f 323a 2053 6563 6f6e 6420 3164 2061  e_2: Second 1d a
+00005670: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+00005680: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
+00005690: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000056a0: 6574 6572 204f 7074 696f 6e61 6c5b 696e  eter Optional[in
+000056b0: 745d 2066 696c 6c5f 7661 6c75 653a 204f  t] fill_value: O
+000056c0: 7074 696f 6e61 6c20 7073 6575 646f 2d76  ptional pseudo-v
+000056d0: 616c 7565 2074 6f20 7573 6520 746f 2066  alue to use to f
+000056e0: 696c 6c20 656d 7074 7920 6275 636b 6574  ill empty bucket
+000056f0: 7320 696e 2060 6073 616d 706c 655f 3260  s in ``sample_2`
+00005700: 6020 6869 7374 6f67 7261 6d0a 2020 2020  ` histogram.    
+00005710: 2020 2020 3a70 6172 616d 6574 6572 204c      :parameter L
+00005720: 6974 6572 616c 2062 7563 6b65 745f 6d65  iteral bucket_me
+00005730: 7468 6f64 3a20 4573 7469 6d61 746f 7220  thod: Estimator 
+00005740: 6465 7465 726d 696e 696e 6720 6f70 7469  determining opti
+00005750: 6d61 6c20 6275 636b 6574 2063 6f75 6e74  mal bucket count
+00005760: 2061 6e64 2062 7563 6b65 7420 7769 6474   and bucket widt
+00005770: 682e 2044 6566 6175 6c74 3a20 5468 6520  h. Default: The 
+00005780: 6d61 7869 6d75 6d20 6f66 2074 6865 2053  maximum of the S
+00005790: 7475 7267 6573 2061 6e64 2046 7265 6564  turges and Freed
+000057a0: 6d61 6e2d 4469 6163 6f6e 6973 2065 7374  man-Diaconis est
+000057b0: 696d 6174 6f72 730a 2020 2020 2020 2020  imators.        
+000057c0: 3a72 6574 7572 6e73 2066 6c6f 6174 3a20  :returns float: 
+000057d0: 4b75 6c6c 6261 636b 2d4c 6569 626c 6572  Kullback-Leibler
+000057e0: 2064 6976 6572 6765 6e63 6520 6265 7477   divergence betw
+000057f0: 6565 6e20 6060 7361 6d70 6c65 5f31 6060  een ``sample_1``
+00005800: 2061 6e64 2060 6073 616d 706c 655f 3260   and ``sample_2`
+00005810: 600a 2020 2020 2020 2020 2222 220a 2020  `.        """.  
+00005820: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
+00005830: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
+00005840: 2020 2020 2064 6174 613d 7361 6d70 6c65       data=sample
+00005850: 5f31 2c0a 2020 2020 2020 2020 2020 2020  _1,.            
+00005860: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+00005870: 732e 6a65 6e73 656e 5f73 6861 6e6e 6f6e  s.jensen_shannon
+00005880: 5f64 6976 6572 6765 6e63 652e 5f5f 6e61  _divergence.__na
+00005890: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+000058a0: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+000058b0: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
+000058c0: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+000058d0: 6573 3d28 6e70 2e66 6c6f 6174 3332 2c20  es=(np.float32, 
+000058e0: 6e70 2e66 6c6f 6174 3634 2c20 6e70 2e69  np.float64, np.i
+000058f0: 6e74 3332 2c20 6e70 2e69 6e74 3634 2c20  nt32, np.int64, 
+00005900: 696e 742c 2066 6c6f 6174 292c 0a20 2020  int, float),.   
+00005910: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+00005920: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+00005930: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+00005940: 7461 3d73 616d 706c 655f 322c 0a20 2020  ta=sample_2,.   
+00005950: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00005960: 5374 6174 6973 7469 6373 2e6a 656e 7365  Statistics.jense
+00005970: 6e5f 7368 616e 6e6f 6e5f 6469 7665 7267  n_shannon_diverg
+00005980: 656e 6365 2e5f 5f6e 616d 655f 5f2c 0a20  ence.__name__,. 
+00005990: 2020 2020 2020 2020 2020 2061 6363 6570             accep
+000059a0: 7465 645f 6e64 696d 733d 2831 2c29 2c0a  ted_ndims=(1,),.
+000059b0: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+000059c0: 7074 6564 5f64 7479 7065 733d 286e 702e  pted_dtypes=(np.
+000059d0: 666c 6f61 7433 322c 206e 702e 666c 6f61  float32, np.floa
+000059e0: 7436 342c 206e 702e 696e 7433 322c 206e  t64, np.int32, n
+000059f0: 702e 696e 7436 342c 2069 6e74 2c20 666c  p.int64, int, fl
+00005a00: 6f61 7429 2c0a 2020 2020 2020 2020 290a  oat),.        ).
+00005a10: 2020 2020 2020 2020 6368 6563 6b5f 7374          check_st
+00005a20: 7228 0a20 2020 2020 2020 2020 2020 206e  r(.            n
+00005a30: 616d 653d 6622 7b73 656c 662e 5f5f 636c  ame=f"{self.__cl
+00005a40: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20  ass__.__name__} 
+00005a50: 6275 636b 6574 5f6d 6574 686f 6422 2c0a  bucket_method",.
+00005a60: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00005a70: 653d 6275 636b 6574 5f6d 6574 686f 642c  e=bucket_method,
+00005a80: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00005a90: 696f 6e73 3d4f 7074 696f 6e73 2e42 5543  ions=Options.BUC
+00005aa0: 4b45 545f 4d45 5448 4f44 532e 7661 6c75  KET_METHODS.valu
+00005ab0: 652c 0a20 2020 2020 2020 2029 0a20 2020  e,.        ).   
+00005ac0: 2020 2020 2063 6865 636b 5f69 6e74 280a       check_int(.
+00005ad0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00005ae0: 3d66 227b 7365 6c66 2e5f 5f63 6c61 7373  =f"{self.__class
+00005af0: 5f5f 2e5f 5f6e 616d 655f 5f7d 2066 696c  __.__name__} fil
+00005b00: 6c20 7661 6c75 6522 2c20 7661 6c75 653d  l value", value=
+00005b10: 6669 6c6c 5f76 616c 7565 2c20 6d69 6e5f  fill_value, min_
+00005b20: 7661 6c75 653d 310a 2020 2020 2020 2020  value=1.        
+00005b30: 290a 2020 2020 2020 2020 6269 6e5f 7769  ).        bin_wi
+00005b40: 6474 682c 2062 696e 5f63 6f75 6e74 203d  dth, bin_count =
+00005b50: 2062 7563 6b65 745f 6461 7461 2864 6174   bucket_data(dat
+00005b60: 613d 7361 6d70 6c65 5f31 2c20 6d65 7468  a=sample_1, meth
+00005b70: 6f64 3d62 7563 6b65 745f 6d65 7468 6f64  od=bucket_method
+00005b80: 290a 2020 2020 2020 2020 7361 6d70 6c65  ).        sample
+00005b90: 5f31 5f68 6973 7420 3d20 7365 6c66 2e5f  _1_hist = self._
+00005ba0: 6869 7374 5f31 6428 0a20 2020 2020 2020  hist_1d(.       
+00005bb0: 2020 2020 2064 6174 613d 7361 6d70 6c65       data=sample
+00005bc0: 5f31 2c0a 2020 2020 2020 2020 2020 2020  _1,.            
+00005bd0: 6269 6e5f 636f 756e 743d 6269 6e5f 636f  bin_count=bin_co
+00005be0: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
+00005bf0: 2072 616e 6765 3d6e 702e 6172 7261 7928   range=np.array(
+00005c00: 5b30 2c20 696e 7428 6269 6e5f 7769 6474  [0, int(bin_widt
+00005c10: 6820 2a20 6269 6e5f 636f 756e 7429 5d29  h * bin_count)])
+00005c20: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00005c30: 2020 2020 7361 6d70 6c65 5f32 5f68 6973      sample_2_his
+00005c40: 7420 3d20 7365 6c66 2e5f 6869 7374 5f31  t = self._hist_1
+00005c50: 6428 0a20 2020 2020 2020 2020 2020 2064  d(.            d
+00005c60: 6174 613d 7361 6d70 6c65 5f32 2c0a 2020  ata=sample_2,.  
+00005c70: 2020 2020 2020 2020 2020 6269 6e5f 636f            bin_co
+00005c80: 756e 743d 6269 6e5f 636f 756e 742c 0a20  unt=bin_count,. 
+00005c90: 2020 2020 2020 2020 2020 2072 616e 6765             range
+00005ca0: 3d6e 702e 6172 7261 7928 5b30 2c20 696e  =np.array([0, in
+00005cb0: 7428 6269 6e5f 7769 6474 6820 2a20 6269  t(bin_width * bi
+00005cc0: 6e5f 636f 756e 7429 5d29 2c0a 2020 2020  n_count)]),.    
+00005cd0: 2020 2020 290a 2020 2020 2020 2020 7361      ).        sa
+00005ce0: 6d70 6c65 5f31 5f68 6973 745b 7361 6d70  mple_1_hist[samp
+00005cf0: 6c65 5f31 5f68 6973 7420 3d3d 2030 5d20  le_1_hist == 0] 
+00005d00: 3d20 6669 6c6c 5f76 616c 7565 0a20 2020  = fill_value.   
+00005d10: 2020 2020 2073 616d 706c 655f 325f 6869       sample_2_hi
+00005d20: 7374 5b73 616d 706c 655f 325f 6869 7374  st[sample_2_hist
+00005d30: 203d 3d20 305d 203d 2066 696c 6c5f 7661   == 0] = fill_va
+00005d40: 6c75 650a 2020 2020 2020 2020 7361 6d70  lue.        samp
+00005d50: 6c65 5f31 5f68 6973 742c 2073 616d 706c  le_1_hist, sampl
+00005d60: 655f 325f 6869 7374 203d 2073 616d 706c  e_2_hist = sampl
+00005d70: 655f 315f 6869 7374 202f 206e 702e 7375  e_1_hist / np.su
+00005d80: 6d28 0a20 2020 2020 2020 2020 2020 2073  m(.            s
+00005d90: 616d 706c 655f 315f 6869 7374 0a20 2020  ample_1_hist.   
+00005da0: 2020 2020 2029 2c20 7361 6d70 6c65 5f32       ), sample_2
+00005db0: 5f68 6973 7420 2f20 6e70 2e73 756d 2873  _hist / np.sum(s
+00005dc0: 616d 706c 655f 325f 6869 7374 290a 2020  ample_2_hist).  
+00005dd0: 2020 2020 2020 7265 7475 726e 2073 7461        return sta
+00005de0: 7473 2e65 6e74 726f 7079 2870 6b3d 7361  ts.entropy(pk=sa
+00005df0: 6d70 6c65 5f31 5f68 6973 742c 2071 6b3d  mple_1_hist, qk=
+00005e00: 7361 6d70 6c65 5f32 5f68 6973 7429 0a0a  sample_2_hist)..
+00005e10: 2020 2020 6465 6620 726f 6c6c 696e 675f      def rolling_
+00005e20: 6b75 6c6c 6261 636b 5f6c 6569 626c 6572  kullback_leibler
+00005e30: 5f64 6976 6572 6765 6e63 6528 0a20 2020  _divergence(.   
+00005e40: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00005e50: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
+00005e60: 7261 792c 0a20 2020 2020 2020 2074 696d  ray,.        tim
+00005e70: 655f 7769 6e64 6f77 733a 206e 702e 6e64  e_windows: np.nd
+00005e80: 6172 7261 792c 0a20 2020 2020 2020 2066  array,.        f
+00005e90: 7073 3a20 696e 742c 0a20 2020 2020 2020  ps: int,.       
+00005ea0: 2066 696c 6c5f 7661 6c75 653a 2069 6e74   fill_value: int
+00005eb0: 203d 2031 2c0a 2020 2020 2020 2020 6275   = 1,.        bu
+00005ec0: 636b 6574 5f6d 6574 686f 643a 204c 6974  cket_method: Lit
+00005ed0: 6572 616c 5b0a 2020 2020 2020 2020 2020  eral[.          
+00005ee0: 2020 2266 6422 2c20 2264 6f61 6e65 222c    "fd", "doane",
+00005ef0: 2022 6175 746f 222c 2022 7363 6f74 7422   "auto", "scott"
+00005f00: 2c20 2273 746f 6e65 222c 2022 7269 6365  , "stone", "rice
+00005f10: 222c 2022 7374 7572 6765 7322 2c20 2273  ", "sturges", "s
+00005f20: 7172 7422 0a20 2020 2020 2020 205d 203d  qrt".        ] =
+00005f30: 2022 6175 746f 222c 0a20 2020 2029 202d   "auto",.    ) -
+00005f40: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+00005f50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00005f60: 2020 436f 6d70 7574 6520 726f 6c6c 696e    Compute rollin
+00005f70: 6720 4b75 6c6c 6261 636b 2d4c 6569 626c  g Kullback-Leibl
+00005f80: 6572 2064 6976 6572 6765 6e63 6520 636f  er divergence co
+00005f90: 6d70 6172 696e 6720 7468 6520 6375 7272  mparing the curr
+00005fa0: 656e 7420 7469 6d65 2d77 696e 646f 7720  ent time-window 
+00005fb0: 6f66 0a20 2020 2020 2020 2073 697a 6520  of.        size 
+00005fc0: 4e20 746f 2074 6865 2070 7265 6365 6469  N to the precedi
+00005fd0: 6e67 2077 696e 646f 7720 6f66 2073 697a  ng window of siz
+00005fe0: 6520 4e2e 0a0a 2020 2020 2020 2020 2e2e  e N...        ..
+00005ff0: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
+00006000: 2020 2045 6d70 7479 2062 696e 7320 2830     Empty bins (0
+00006010: 206f 6273 6572 7661 7469 6f6e 7320 696e   observations in
+00006020: 2062 696e 2920 696e 2069 7320 7265 706c   bin) in is repl
+00006030: 6163 6564 2077 6974 6820 6060 6669 6c6c  aced with ``fill
+00006040: 5f76 616c 7565 6060 2e0a 0a20 2020 2020  _value``...     
+00006050: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
+00006060: 6172 7261 7920 7361 6d70 6c65 5f31 3a20  array sample_1: 
+00006070: 3164 2061 7272 6179 2072 6570 7265 7365  1d array represe
+00006080: 6e74 696e 6720 6665 6174 7572 6520 7661  nting feature va
+00006090: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
+000060a0: 6172 616d 6574 6572 204c 6974 6572 616c  arameter Literal
+000060b0: 2062 7563 6b65 745f 6d65 7468 6f64 3a20   bucket_method: 
+000060c0: 4573 7469 6d61 746f 7220 6465 7465 726d  Estimator determ
+000060d0: 696e 696e 6720 6f70 7469 6d61 6c20 6275  ining optimal bu
+000060e0: 636b 6574 2063 6f75 6e74 2061 6e64 2062  cket count and b
+000060f0: 7563 6b65 7420 7769 6474 682e 2044 6566  ucket width. Def
+00006100: 6175 6c74 3a20 5468 6520 6d61 7869 6d75  ault: The maximu
+00006110: 6d20 6f66 2074 6865 2053 7475 7267 6573  m of the Sturges
+00006120: 2061 6e64 2046 7265 6564 6d61 6e2d 4469   and Freedman-Di
+00006130: 6163 6f6e 6973 2065 7374 696d 6174 6f72  aconis estimator
+00006140: 730a 2020 2020 2020 2020 3a70 6172 616d  s.        :param
+00006150: 6574 6572 206e 702e 6e64 6172 7261 795b  eter np.ndarray[
+00006160: 666c 6f61 7473 5d20 7469 6d65 5f77 696e  floats] time_win
+00006170: 646f 7773 3a20 5469 6d65 2077 696e 646f  dows: Time windo
+00006180: 7773 2074 6f20 636f 6d70 7574 6520 4a53  ws to compute JS
+00006190: 2066 6f72 2069 6e20 7365 636f 6e64 732e   for in seconds.
+000061a0: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+000061b0: 7465 7220 696e 7420 6670 733a 2046 7261  ter int fps: Fra
+000061c0: 6d65 2d72 6174 6520 6f66 2072 6563 6f72  me-rate of recor
+000061d0: 6465 6420 7669 6465 6f2e 0a20 2020 2020  ded video..     
+000061e0: 2020 203a 7265 7475 726e 7320 6e70 2e6e     :returns np.n
+000061f0: 6461 7272 6179 3a20 5369 7a65 2064 6174  darray: Size dat
+00006200: 612e 7368 6170 655b 305d 2078 2077 696e  a.shape[0] x win
+00006210: 646f 775f 7369 7a65 732e 7368 6170 6520  dow_sizes.shape 
+00006220: 7769 7468 204b 756c 6c62 6163 6b2d 4c65  with Kullback-Le
+00006230: 6962 6c65 7220 6469 7665 7267 656e 6365  ibler divergence
+00006240: 2e20 436f 6c75 6d6e 7320 7265 7072 6573  . Columns repres
+00006250: 656e 7473 2064 6966 6665 7265 6e74 2074  ents different t
+00006260: 6965 6d20 7769 6e64 6f77 732e 0a0a 2020  iem windows...  
+00006270: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+00006280: 2020 2020 2020 2020 3e3e 3e20 7361 6d70          >>> samp
+00006290: 6c65 5f31 2c20 7361 6d70 6c65 5f32 203d  le_1, sample_2 =
+000062a0: 206e 702e 7261 6e64 6f6d 2e6e 6f72 6d61   np.random.norma
+000062b0: 6c28 6c6f 633d 3130 2c20 7363 616c 653d  l(loc=10, scale=
+000062c0: 3730 302c 2073 697a 653d 3529 2c20 6e70  700, size=5), np
+000062d0: 2e72 616e 646f 6d2e 6e6f 726d 616c 286c  .random.normal(l
+000062e0: 6f63 3d35 302c 2073 6361 6c65 3d37 3030  oc=50, scale=700
+000062f0: 2c20 7369 7a65 3d35 290a 2020 2020 2020  , size=5).      
+00006300: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
+00006310: 6873 7461 636b 2828 7361 6d70 6c65 5f31  hstack((sample_1
+00006320: 2c20 7361 6d70 6c65 5f32 2929 0a20 2020  , sample_2)).   
+00006330: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
+00006340: 6963 7328 292e 726f 6c6c 696e 675f 6b75  ics().rolling_ku
+00006350: 6c6c 6261 636b 5f6c 6569 626c 6572 5f64  llback_leibler_d
+00006360: 6976 6572 6765 6e63 6528 6461 7461 3d64  ivergence(data=d
+00006370: 6174 612c 2074 696d 655f 7769 6e64 6f77  ata, time_window
+00006380: 733d 6e70 2e61 7272 6179 285b 315d 292c  s=np.array([1]),
+00006390: 2066 7073 3d32 290a 2020 2020 2020 2020   fps=2).        
+000063a0: 2222 220a 0a20 2020 2020 2020 2063 6865  """..        che
+000063b0: 636b 5f76 616c 6964 5f61 7272 6179 2864  ck_valid_array(d
+000063c0: 6174 613d 6461 7461 2c20 736f 7572 6365  ata=data, source
+000063d0: 3d73 656c 662e 5f5f 636c 6173 735f 5f2e  =self.__class__.
+000063e0: 5f5f 6e61 6d65 5f5f 2c20 6163 6365 7074  __name__, accept
+000063f0: 6564 5f73 697a 6573 3d5b 315d 290a 2020  ed_sizes=[1]).  
+00006400: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
+00006410: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
+00006420: 2020 2020 2064 6174 613d 7469 6d65 5f77       data=time_w
+00006430: 696e 646f 7773 2c20 736f 7572 6365 3d73  indows, source=s
+00006440: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+00006450: 6e61 6d65 5f5f 2c20 6163 6365 7074 6564  name__, accepted
+00006460: 5f73 697a 6573 3d5b 315d 0a20 2020 2020  _sizes=[1].     
+00006470: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
+00006480: 636b 5f69 6e74 286e 616d 653d 6622 7b73  ck_int(name=f"{s
+00006490: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
+000064a0: 6e61 6d65 5f5f 7d20 6670 7322 2c20 7661  name__} fps", va
+000064b0: 6c75 653d 6670 732c 206d 696e 5f76 616c  lue=fps, min_val
+000064c0: 7565 3d31 290a 2020 2020 2020 2020 6368  ue=1).        ch
+000064d0: 6563 6b5f 7374 7228 0a20 2020 2020 2020  eck_str(.       
+000064e0: 2020 2020 206e 616d 653d 6622 7b73 656c       name=f"{sel
+000064f0: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+00006500: 6d65 5f5f 7d20 6275 636b 6574 5f6d 6574  me__} bucket_met
+00006510: 686f 6422 2c0a 2020 2020 2020 2020 2020  hod",.          
+00006520: 2020 7661 6c75 653d 6275 636b 6574 5f6d    value=bucket_m
+00006530: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+00006540: 2020 206f 7074 696f 6e73 3d4f 7074 696f     options=Optio
+00006550: 6e73 2e42 5543 4b45 545f 4d45 5448 4f44  ns.BUCKET_METHOD
+00006560: 532e 7661 6c75 652c 0a20 2020 2020 2020  S.value,.       
+00006570: 2029 0a0a 2020 2020 2020 2020 7265 7375   )..        resu
+00006580: 6c74 7320 3d20 6e70 2e66 756c 6c28 2864  lts = np.full((d
+00006590: 6174 612e 7368 6170 655b 305d 2c20 7469  ata.shape[0], ti
+000065a0: 6d65 5f77 696e 646f 7773 2e73 6861 7065  me_windows.shape
+000065b0: 5b30 5d29 2c20 302e 3029 0a20 2020 2020  [0]), 0.0).     
+000065c0: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
+000065d0: 6765 2874 696d 655f 7769 6e64 6f77 732e  ge(time_windows.
+000065e0: 7368 6170 655b 305d 293a 0a20 2020 2020  shape[0]):.     
+000065f0: 2020 2020 2020 2077 696e 646f 775f 7369         window_si
+00006600: 7a65 203d 2069 6e74 2874 696d 655f 7769  ze = int(time_wi
+00006610: 6e64 6f77 735b 695d 202a 2066 7073 290a  ndows[i] * fps).
+00006620: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00006630: 5f73 706c 6974 203d 206e 702e 7370 6c69  _split = np.spli
+00006640: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00006650: 2020 2064 6174 612c 206c 6973 7428 7261     data, list(ra
+00006660: 6e67 6528 7769 6e64 6f77 5f73 697a 652c  nge(window_size,
+00006670: 2064 6174 612e 7368 6170 655b 305d 2c20   data.shape[0], 
+00006680: 7769 6e64 6f77 5f73 697a 6529 290a 2020  window_size)).  
+00006690: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000066a0: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+000066b0: 2070 7261 6e67 6528 312c 206c 656e 2864   prange(1, len(d
+000066c0: 6174 615f 7370 6c69 7429 293a 0a20 2020  ata_split)):.   
+000066d0: 2020 2020 2020 2020 2020 2020 2077 696e               win
+000066e0: 646f 775f 7374 6172 7420 3d20 696e 7428  dow_start = int(
+000066f0: 7769 6e64 6f77 5f73 697a 6520 2a20 6a29  window_size * j)
+00006700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006710: 2077 696e 646f 775f 656e 6420 3d20 696e   window_end = in
+00006720: 7428 7769 6e64 6f77 5f73 7461 7274 202b  t(window_start +
+00006730: 2077 696e 646f 775f 7369 7a65 290a 2020   window_size).  
+00006740: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+00006750: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
+00006760: 203d 2064 6174 615f 7370 6c69 745b 6a20   = data_split[j 
+00006770: 2d20 315d 2e61 7374 7970 6528 6e70 2e66  - 1].astype(np.f
+00006780: 6c6f 6174 3332 292c 2064 6174 615f 7370  loat32), data_sp
+00006790: 6c69 745b 0a20 2020 2020 2020 2020 2020  lit[.           
+000067a0: 2020 2020 2020 2020 206a 0a20 2020 2020           j.     
+000067b0: 2020 2020 2020 2020 2020 205d 2e61 7374             ].ast
+000067c0: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+000067d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000067e0: 6269 6e5f 7769 6474 682c 2062 696e 5f63  bin_width, bin_c
+000067f0: 6f75 6e74 203d 2062 7563 6b65 745f 6461  ount = bucket_da
+00006800: 7461 2864 6174 613d 7361 6d70 6c65 5f31  ta(data=sample_1
+00006810: 2c20 6d65 7468 6f64 3d62 7563 6b65 745f  , method=bucket_
+00006820: 6d65 7468 6f64 290a 2020 2020 2020 2020  method).        
+00006830: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
+00006840: 5f68 6973 7420 3d20 7365 6c66 2e5f 6869  _hist = self._hi
+00006850: 7374 5f31 6428 0a20 2020 2020 2020 2020  st_1d(.         
+00006860: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00006870: 7361 6d70 6c65 5f31 2c0a 2020 2020 2020  sample_1,.      
+00006880: 2020 2020 2020 2020 2020 2020 2020 6269                bi
+00006890: 6e5f 636f 756e 743d 6269 6e5f 636f 756e  n_count=bin_coun
+000068a0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+000068b0: 2020 2020 2020 2072 616e 6765 3d6e 702e         range=np.
+000068c0: 6172 7261 7928 5b30 2c20 696e 7428 6269  array([0, int(bi
+000068d0: 6e5f 7769 6474 6820 2a20 6269 6e5f 636f  n_width * bin_co
+000068e0: 756e 7429 5d29 2c0a 2020 2020 2020 2020  unt)]),.        
+000068f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00006900: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00006910: 5f32 5f68 6973 7420 3d20 7365 6c66 2e5f  _2_hist = self._
+00006920: 6869 7374 5f31 6428 0a20 2020 2020 2020  hist_1d(.       
+00006930: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00006940: 613d 7361 6d70 6c65 5f32 2c0a 2020 2020  a=sample_2,.    
+00006950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006960: 6269 6e5f 636f 756e 743d 6269 6e5f 636f  bin_count=bin_co
+00006970: 756e 742c 0a20 2020 2020 2020 2020 2020  unt,.           
+00006980: 2020 2020 2020 2020 2072 616e 6765 3d6e           range=n
+00006990: 702e 6172 7261 7928 5b30 2c20 696e 7428  p.array([0, int(
+000069a0: 6269 6e5f 7769 6474 6820 2a20 6269 6e5f  bin_width * bin_
+000069b0: 636f 756e 7429 5d29 2c0a 2020 2020 2020  count)]),.      
+000069c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000069d0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+000069e0: 6c65 5f31 5f68 6973 745b 7361 6d70 6c65  le_1_hist[sample
+000069f0: 5f31 5f68 6973 7420 3d3d 2030 5d20 3d20  _1_hist == 0] = 
+00006a00: 6669 6c6c 5f76 616c 7565 0a20 2020 2020  fill_value.     
+00006a10: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00006a20: 655f 325f 6869 7374 5b73 616d 706c 655f  e_2_hist[sample_
+00006a30: 325f 6869 7374 203d 3d20 305d 203d 2066  2_hist == 0] = f
+00006a40: 696c 6c5f 7661 6c75 650a 2020 2020 2020  ill_value.      
+00006a50: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00006a60: 5f31 5f68 6973 742c 2073 616d 706c 655f  _1_hist, sample_
+00006a70: 325f 6869 7374 203d 2073 616d 706c 655f  2_hist = sample_
+00006a80: 315f 6869 7374 202f 206e 702e 7375 6d28  1_hist / np.sum(
+00006a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006aa0: 2020 2020 2073 616d 706c 655f 315f 6869       sample_1_hi
+00006ab0: 7374 0a20 2020 2020 2020 2020 2020 2020  st.             
+00006ac0: 2020 2029 2c20 7361 6d70 6c65 5f32 5f68     ), sample_2_h
+00006ad0: 6973 7420 2f20 6e70 2e73 756d 2873 616d  ist / np.sum(sam
+00006ae0: 706c 655f 325f 6869 7374 290a 2020 2020  ple_2_hist).    
+00006af0: 2020 2020 2020 2020 2020 2020 6b6c 203d              kl =
+00006b00: 2073 7461 7473 2e65 6e74 726f 7079 2870   stats.entropy(p
+00006b10: 6b3d 7361 6d70 6c65 5f31 5f68 6973 742c  k=sample_1_hist,
+00006b20: 2071 6b3d 7361 6d70 6c65 5f32 5f68 6973   qk=sample_2_his
+00006b30: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00006b40: 2020 2072 6573 756c 7473 5b77 696e 646f     results[windo
+00006b50: 775f 7374 6172 743a 7769 6e64 6f77 5f65  w_start:window_e
+00006b60: 6e64 2c20 695d 203d 206b 6c0a 2020 2020  nd, i] = kl.    
+00006b70: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+00006b80: 7473 0a0a 2020 2020 6465 6620 6a65 6e73  ts..    def jens
+00006b90: 656e 5f73 6861 6e6e 6f6e 5f64 6976 6572  en_shannon_diver
+00006ba0: 6765 6e63 6528 0a20 2020 2020 2020 2073  gence(.        s
+00006bb0: 656c 662c 0a20 2020 2020 2020 2073 616d  elf,.        sam
+00006bc0: 706c 655f 313a 206e 702e 6e64 6172 7261  ple_1: np.ndarra
+00006bd0: 792c 0a20 2020 2020 2020 2073 616d 706c  y,.        sampl
+00006be0: 655f 323a 206e 702e 6e64 6172 7261 792c  e_2: np.ndarray,
+00006bf0: 0a20 2020 2020 2020 2062 7563 6b65 745f  .        bucket_
+00006c00: 6d65 7468 6f64 3a20 4c69 7465 7261 6c5b  method: Literal[
+00006c10: 0a20 2020 2020 2020 2020 2020 2022 6664  .            "fd
+00006c20: 222c 2022 646f 616e 6522 2c20 2261 7574  ", "doane", "aut
+00006c30: 6f22 2c20 2273 636f 7474 222c 2022 7374  o", "scott", "st
+00006c40: 6f6e 6522 2c20 2272 6963 6522 2c20 2273  one", "rice", "s
+00006c50: 7475 7267 6573 222c 2022 7371 7274 220a  turges", "sqrt".
+00006c60: 2020 2020 2020 2020 5d20 3d20 2261 7574          ] = "aut
+00006c70: 6f22 2c0a 2020 2020 2920 2d3e 2066 6c6f  o",.    ) -> flo
+00006c80: 6174 3a0a 2020 2020 2020 2020 2222 220a  at:.        """.
+00006c90: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+00006ca0: 4a65 6e73 656e 2d53 6861 6e6e 6f6e 2064  Jensen-Shannon d
+00006cb0: 6976 6572 6765 6e63 6520 6265 7477 6565  ivergence betwee
+00006cc0: 6e20 7477 6f20 6469 7374 7269 6275 7469  n two distributi
+00006cd0: 6f6e 732e 2055 7365 6675 6c20 666f 7220  ons. Useful for 
+00006ce0: 2869 2920 6d65 6173 7572 6520 6472 6966  (i) measure drif
+00006cf0: 7420 696e 2064 6174 6173 6574 732c 2061  t in datasets, a
+00006d00: 6e64 2028 6969 2920 6665 6174 7572 697a  nd (ii) featuriz
+00006d10: 6174 696f 6e20 6f66 2064 6973 7472 6962  ation of distrib
+00006d20: 7574 696f 6e20 7368 6966 7473 2061 6372  ution shifts acr
+00006d30: 6f73 730a 2020 2020 2020 2020 7365 7175  oss.        sequ
+00006d40: 656e 7469 616c 2074 696d 652d 6269 6e73  ential time-bins
+00006d50: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
+00006d60: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
+00006d70: 4a53 4420 3d20 303a 2049 6e64 6963 6174  JSD = 0: Indicat
+00006d80: 6573 2074 6861 7420 7468 6520 7477 6f20  es that the two 
+00006d90: 6469 7374 7269 6275 7469 6f6e 7320 6172  distributions ar
+00006da0: 6520 6964 656e 7469 6361 6c2e 0a20 2020  e identical..   
+00006db0: 2020 2020 2020 2020 3020 3c20 4a53 4420          0 < JSD 
+00006dc0: 3c20 313a 2049 6e64 6963 6174 6573 2061  < 1: Indicates a
+00006dd0: 2064 6567 7265 6520 6f66 2064 6973 7369   degree of dissi
+00006de0: 6d69 6c61 7269 7479 2062 6574 7765 656e  milarity between
+00006df0: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+00006e00: 6e73 2c20 7769 7468 2076 616c 7565 7320  ns, with values 
+00006e10: 636c 6f73 6572 2074 6f20 3120 696e 6469  closer to 1 indi
+00006e20: 6361 7469 6e67 2067 7265 6174 6572 2064  cating greater d
+00006e30: 6973 7369 6d69 6c61 7269 7479 2e0a 2020  issimilarity..  
+00006e40: 2020 2020 2020 2020 204a 5344 203d 2031           JSD = 1
+00006e50: 3a20 496e 6469 6361 7465 7320 7468 6174  : Indicates that
+00006e60: 2074 6865 2074 776f 2064 6973 7472 6962   the two distrib
+00006e70: 7574 696f 6e73 2061 7265 206d 6178 696d  utions are maxim
+00006e80: 616c 6c79 2064 6973 7369 6d69 6c61 722e  ally dissimilar.
+00006e90: 0a0a 2020 2020 2020 2020 2e2e 206d 6174  ..        .. mat
+00006ea0: 683a 3a0a 2020 2020 2020 2020 2020 204a  h::.           J
+00006eb0: 5344 203d 205c 6672 6163 7b7b 4b4c 2850  SD = \frac{{KL(P
+00006ec0: 5f31 207c 7c20 4d29 202b 204b 4c28 505f  _1 || M) + KL(P_
+00006ed0: 3220 7c7c 204d 297d 7d7b 327d 0a0a 2020  2 || M)}}{2}..  
+00006ee0: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+00006ef0: 206e 6461 7272 6179 2073 616d 706c 655f   ndarray sample_
+00006f00: 313a 2046 6972 7374 2031 6420 6172 7261  1: First 1d arra
+00006f10: 7920 7265 7072 6573 656e 7469 6e67 2066  y representing f
+00006f20: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+00006f30: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00006f40: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
+00006f50: 5f32 3a20 5365 636f 6e64 2031 6420 6172  _2: Second 1d ar
+00006f60: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
+00006f70: 2066 6561 7475 7265 2076 616c 7565 732e   feature values.
+00006f80: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+00006f90: 7465 7220 4c69 7465 7261 6c20 6275 636b  ter Literal buck
+00006fa0: 6574 5f6d 6574 686f 643a 2045 7374 696d  et_method: Estim
+00006fb0: 6174 6f72 2064 6574 6572 6d69 6e69 6e67  ator determining
+00006fc0: 206f 7074 696d 616c 2062 7563 6b65 7420   optimal bucket 
+00006fd0: 636f 756e 7420 616e 6420 6275 636b 6574  count and bucket
+00006fe0: 2077 6964 7468 2e20 4465 6661 756c 743a   width. Default:
+00006ff0: 2054 6865 206d 6178 696d 756d 206f 6620   The maximum of 
+00007000: 7468 6520 5374 7572 6765 7320 616e 6420  the Sturges and 
+00007010: 4672 6565 646d 616e 2d44 6961 636f 6e69  Freedman-Diaconi
+00007020: 7320 6573 7469 6d61 746f 7273 2e0a 2020  s estimators..  
+00007030: 2020 2020 2020 3a72 6574 7572 6e73 2066        :returns f
+00007040: 6c6f 6174 3a20 4a65 6e73 656e 2d53 6861  loat: Jensen-Sha
+00007050: 6e6e 6f6e 2064 6976 6572 6765 6e63 6520  nnon divergence 
+00007060: 6265 7477 6565 6e20 6060 7361 6d70 6c65  between ``sample
+00007070: 5f31 6060 2061 6e64 2060 6073 616d 706c  _1`` and ``sampl
+00007080: 655f 3260 600a 0a20 2020 2020 2020 203a  e_2``..        :
+00007090: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+000070a0: 203e 3e3e 2073 616d 706c 655f 312c 2073   >>> sample_1, s
+000070b0: 616d 706c 655f 3220 3d20 6e70 2e61 7272  ample_2 = np.arr
+000070c0: 6179 285b 312c 2032 2c20 332c 2034 2c20  ay([1, 2, 3, 4, 
+000070d0: 352c 2031 302c 2031 2c20 322c 2033 5d29  5, 10, 1, 2, 3])
+000070e0: 2c20 6e70 2e61 7272 6179 285b 312c 2035  , np.array([1, 5
+000070f0: 2c20 3130 2c20 392c 2031 302c 2031 2c20  , 10, 9, 10, 1, 
+00007100: 3130 2c20 362c 2037 5d29 0a20 2020 2020  10, 6, 7]).     
+00007110: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+00007120: 7328 292e 6a65 6e73 656e 5f73 6861 6e6e  s().jensen_shann
+00007130: 6f6e 5f64 6976 6572 6765 6e63 6528 7361  on_divergence(sa
+00007140: 6d70 6c65 5f31 3d73 616d 706c 655f 312c  mple_1=sample_1,
+00007150: 2073 616d 706c 655f 323d 7361 6d70 6c65   sample_2=sample
+00007160: 5f32 2c20 6275 636b 6574 5f6d 6574 686f  _2, bucket_metho
+00007170: 643d 2766 6427 290a 2020 2020 2020 2020  d='fd').        
+00007180: 3e3e 3e20 302e 3330 3830 3635 3431 3335  >>> 0.3080654135
+00007190: 3832 3139 3738 360a 2020 2020 2020 2020  8219786.        
+000071a0: 2222 220a 0a20 2020 2020 2020 2063 6865  """..        che
+000071b0: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
+000071c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000071d0: 3d73 616d 706c 655f 312c 0a20 2020 2020  =sample_1,.     
+000071e0: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
+000071f0: 6174 6973 7469 6373 2e6a 656e 7365 6e5f  atistics.jensen_
+00007200: 7368 616e 6e6f 6e5f 6469 7665 7267 656e  shannon_divergen
+00007210: 6365 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ce.__name__,.   
+00007220: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00007230: 645f 6e64 696d 733d 2831 2c29 2c0a 2020  d_ndims=(1,),.  
+00007240: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00007250: 6564 5f64 7479 7065 733d 286e 702e 666c  ed_dtypes=(np.fl
+00007260: 6f61 7433 322c 206e 702e 666c 6f61 7436  oat32, np.float6
+00007270: 342c 206e 702e 696e 7433 322c 206e 702e  4, np.int32, np.
+00007280: 696e 7436 342c 2069 6e74 2c20 666c 6f61  int64, int, floa
+00007290: 7429 2c0a 2020 2020 2020 2020 290a 2020  t),.        ).  
+000072a0: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
+000072b0: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
+000072c0: 2020 2020 2064 6174 613d 7361 6d70 6c65       data=sample
+000072d0: 5f32 2c0a 2020 2020 2020 2020 2020 2020  _2,.            
+000072e0: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+000072f0: 732e 6a65 6e73 656e 5f73 6861 6e6e 6f6e  s.jensen_shannon
+00007300: 5f64 6976 6572 6765 6e63 652e 5f5f 6e61  _divergence.__na
+00007310: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00007320: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+00007330: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
+00007340: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+00007350: 6573 3d28 6e70 2e66 6c6f 6174 3332 2c20  es=(np.float32, 
+00007360: 6e70 2e66 6c6f 6174 3634 2c20 6e70 2e69  np.float64, np.i
+00007370: 6e74 3332 2c20 6e70 2e69 6e74 3634 2c20  nt32, np.int64, 
+00007380: 696e 742c 2066 6c6f 6174 292c 0a20 2020  int, float),.   
+00007390: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+000073a0: 6865 636b 5f73 7472 280a 2020 2020 2020  heck_str(.      
+000073b0: 2020 2020 2020 6e61 6d65 3d66 227b 7365        name=f"{se
+000073c0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+000073d0: 616d 655f 5f7d 2062 7563 6b65 745f 6d65  ame__} bucket_me
+000073e0: 7468 6f64 222c 0a20 2020 2020 2020 2020  thod",.         
+000073f0: 2020 2076 616c 7565 3d62 7563 6b65 745f     value=bucket_
+00007400: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
+00007410: 2020 2020 6f70 7469 6f6e 733d 4f70 7469      options=Opti
+00007420: 6f6e 732e 4255 434b 4554 5f4d 4554 484f  ons.BUCKET_METHO
+00007430: 4453 2e76 616c 7565 2c0a 2020 2020 2020  DS.value,.      
+00007440: 2020 290a 2020 2020 2020 2020 6269 6e5f    ).        bin_
+00007450: 7769 6474 682c 2062 696e 5f63 6f75 6e74  width, bin_count
+00007460: 203d 2062 7563 6b65 745f 6461 7461 2864   = bucket_data(d
+00007470: 6174 613d 7361 6d70 6c65 5f31 2c20 6d65  ata=sample_1, me
+00007480: 7468 6f64 3d62 7563 6b65 745f 6d65 7468  thod=bucket_meth
+00007490: 6f64 290a 2020 2020 2020 2020 7361 6d70  od).        samp
+000074a0: 6c65 5f31 5f68 6973 7420 3d20 7365 6c66  le_1_hist = self
+000074b0: 2e5f 6869 7374 5f31 6428 0a20 2020 2020  ._hist_1d(.     
+000074c0: 2020 2020 2020 2064 6174 613d 7361 6d70         data=samp
+000074d0: 6c65 5f31 2c0a 2020 2020 2020 2020 2020  le_1,.          
+000074e0: 2020 6269 6e5f 636f 756e 743d 6269 6e5f    bin_count=bin_
+000074f0: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+00007500: 2020 2072 616e 6765 3d6e 702e 6172 7261     range=np.arra
+00007510: 7928 5b30 2c20 696e 7428 6269 6e5f 7769  y([0, int(bin_wi
+00007520: 6474 6820 2a20 6269 6e5f 636f 756e 7429  dth * bin_count)
+00007530: 5d29 2c0a 2020 2020 2020 2020 290a 2020  ]),.        ).  
+00007540: 2020 2020 2020 7361 6d70 6c65 5f32 5f68        sample_2_h
+00007550: 6973 7420 3d20 7365 6c66 2e5f 6869 7374  ist = self._hist
+00007560: 5f31 6428 0a20 2020 2020 2020 2020 2020  _1d(.           
+00007570: 2064 6174 613d 7361 6d70 6c65 5f32 2c0a   data=sample_2,.
+00007580: 2020 2020 2020 2020 2020 2020 6269 6e5f              bin_
+00007590: 636f 756e 743d 6269 6e5f 636f 756e 742c  count=bin_count,
+000075a0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
+000075b0: 6765 3d6e 702e 6172 7261 7928 5b30 2c20  ge=np.array([0, 
+000075c0: 696e 7428 6269 6e5f 7769 6474 6820 2a20  int(bin_width * 
+000075d0: 6269 6e5f 636f 756e 7429 5d29 2c0a 2020  bin_count)]),.  
+000075e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000075f0: 6d65 616e 5f68 6973 7420 3d20 6e70 2e6d  mean_hist = np.m
+00007600: 6561 6e28 5b73 616d 706c 655f 315f 6869  ean([sample_1_hi
+00007610: 7374 2c20 7361 6d70 6c65 5f32 5f68 6973  st, sample_2_his
+00007620: 745d 2c20 6178 6973 3d30 290a 2020 2020  t], axis=0).    
+00007630: 2020 2020 6b6c 5f73 616d 706c 655f 312c      kl_sample_1,
+00007640: 206b 6c5f 7361 6d70 6c65 5f32 203d 2073   kl_sample_2 = s
+00007650: 7461 7473 2e65 6e74 726f 7079 280a 2020  tats.entropy(.  
+00007660: 2020 2020 2020 2020 2020 706b 3d73 616d            pk=sam
+00007670: 706c 655f 315f 6869 7374 2c20 716b 3d6d  ple_1_hist, qk=m
+00007680: 6561 6e5f 6869 7374 0a20 2020 2020 2020  ean_hist.       
+00007690: 2029 2c20 7374 6174 732e 656e 7472 6f70   ), stats.entrop
+000076a0: 7928 706b 3d73 616d 706c 655f 325f 6869  y(pk=sample_2_hi
+000076b0: 7374 2c20 716b 3d6d 6561 6e5f 6869 7374  st, qk=mean_hist
+000076c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000076d0: 2028 6b6c 5f73 616d 706c 655f 3120 2b20   (kl_sample_1 + 
+000076e0: 6b6c 5f73 616d 706c 655f 3229 202f 2032  kl_sample_2) / 2
+000076f0: 0a0a 2020 2020 6465 6620 726f 6c6c 696e  ..    def rollin
+00007700: 675f 6a65 6e73 656e 5f73 6861 6e6e 6f6e  g_jensen_shannon
+00007710: 5f64 6976 6572 6765 6e63 6528 0a20 2020  _divergence(.   
+00007720: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00007730: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
+00007740: 7261 792c 0a20 2020 2020 2020 2074 696d  ray,.        tim
+00007750: 655f 7769 6e64 6f77 733a 206e 702e 6e64  e_windows: np.nd
+00007760: 6172 7261 792c 0a20 2020 2020 2020 2066  array,.        f
+00007770: 7073 3a20 696e 742c 0a20 2020 2020 2020  ps: int,.       
+00007780: 2062 7563 6b65 745f 6d65 7468 6f64 3a20   bucket_method: 
+00007790: 4c69 7465 7261 6c5b 0a20 2020 2020 2020  Literal[.       
+000077a0: 2020 2020 2022 6664 222c 2022 646f 616e       "fd", "doan
+000077b0: 6522 2c20 2261 7574 6f22 2c20 2273 636f  e", "auto", "sco
+000077c0: 7474 222c 2022 7374 6f6e 6522 2c20 2272  tt", "stone", "r
+000077d0: 6963 6522 2c20 2273 7475 7267 6573 222c  ice", "sturges",
+000077e0: 2022 7371 7274 220a 2020 2020 2020 2020   "sqrt".        
+000077f0: 5d20 3d20 2261 7574 6f22 2c0a 2020 2020  ] = "auto",.    
+00007800: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+00007810: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00007820: 2020 2020 2043 6f6d 7075 7465 2072 6f6c       Compute rol
+00007830: 6c69 6e67 204a 656e 7365 6e2d 5368 616e  ling Jensen-Shan
+00007840: 6e6f 6e20 6469 7665 7267 656e 6365 2063  non divergence c
+00007850: 6f6d 7061 7269 6e67 2074 6865 2063 7572  omparing the cur
+00007860: 7265 6e74 2074 696d 652d 7769 6e64 6f77  rent time-window
+00007870: 206f 6620 7369 7a65 204e 2074 6f20 7468   of size N to th
+00007880: 6520 7072 6563 6564 696e 6720 7769 6e64  e preceding wind
+00007890: 6f77 206f 6620 7369 7a65 204e 2e0a 0a20  ow of size N... 
+000078a0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+000078b0: 7220 6e64 6172 7261 7920 6461 7461 3a20  r ndarray data: 
+000078c0: 3144 2061 7272 6179 206f 6620 7369 7a65  1D array of size
+000078d0: 206c 656e 2866 7261 6d65 7329 2072 6570   len(frames) rep
+000078e0: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
+000078f0: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+00007900: 2020 3a70 6172 616d 6574 6572 206e 702e    :parameter np.
+00007910: 6e64 6172 7261 795b 696e 7473 5d20 7469  ndarray[ints] ti
+00007920: 6d65 5f77 696e 646f 7773 3a20 5469 6d65  me_windows: Time
+00007930: 2077 696e 646f 7773 2074 6f20 636f 6d70   windows to comp
+00007940: 7574 6520 4a53 2066 6f72 2069 6e20 7365  ute JS for in se
+00007950: 636f 6e64 732e 0a20 2020 2020 2020 203a  conds..        :
+00007960: 7061 7261 6d65 7465 7220 696e 7420 6670  parameter int fp
+00007970: 733a 2046 7261 6d65 2d72 6174 6520 6f66  s: Frame-rate of
+00007980: 2072 6563 6f72 6465 6420 7669 6465 6f2e   recorded video.
+00007990: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+000079a0: 7465 7220 4c69 7465 7261 6c20 6275 636b  ter Literal buck
+000079b0: 6574 5f6d 6574 686f 643a 2045 7374 696d  et_method: Estim
+000079c0: 6174 6f72 2064 6574 6572 6d69 6e69 6e67  ator determining
+000079d0: 206f 7074 696d 616c 2062 7563 6b65 7420   optimal bucket 
+000079e0: 636f 756e 7420 616e 6420 6275 636b 6574  count and bucket
+000079f0: 2077 6964 7468 2e20 4465 6661 756c 743a   width. Default:
+00007a00: 2054 6865 206d 6178 696d 756d 206f 6620   The maximum of 
+00007a10: 7468 6520 5374 7572 6765 7320 616e 6420  the Sturges and 
+00007a20: 4672 6565 646d 616e 2d44 6961 636f 6e69  Freedman-Diaconi
+00007a30: 7320 6573 7469 6d61 746f 7273 0a20 2020  s estimators.   
+00007a40: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00007a50: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
+00007a60: 7261 7928 6461 7461 3d64 6174 612c 2073  ray(data=data, s
+00007a70: 6f75 7263 653d 7365 6c66 2e5f 5f63 6c61  ource=self.__cla
+00007a80: 7373 5f5f 2e5f 5f6e 616d 655f 5f2c 2061  ss__.__name__, a
+00007a90: 6363 6570 7465 645f 7369 7a65 733d 5b31  ccepted_sizes=[1
+00007aa0: 5d29 0a20 2020 2020 2020 2063 6865 636b  ]).        check
+00007ab0: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
+00007ac0: 2020 2020 2020 2020 2020 6461 7461 3d74            data=t
+00007ad0: 696d 655f 7769 6e64 6f77 732c 2073 6f75  ime_windows, sou
+00007ae0: 7263 653d 7365 6c66 2e5f 5f63 6c61 7373  rce=self.__class
+00007af0: 5f5f 2e5f 5f6e 616d 655f 5f2c 2061 6363  __.__name__, acc
+00007b00: 6570 7465 645f 7369 7a65 733d 5b31 5d0a  epted_sizes=[1].
+00007b10: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00007b20: 2020 6368 6563 6b5f 696e 7428 6e61 6d65    check_int(name
+00007b30: 3d66 227b 7365 6c66 2e5f 5f63 6c61 7373  =f"{self.__class
+00007b40: 5f5f 2e5f 5f6e 616d 655f 5f7d 2066 7073  __.__name__} fps
+00007b50: 222c 2076 616c 7565 3d66 7073 2c20 6d69  ", value=fps, mi
+00007b60: 6e5f 7661 6c75 653d 3129 0a20 2020 2020  n_value=1).     
+00007b70: 2020 2063 6865 636b 5f73 7472 280a 2020     check_str(.  
+00007b80: 2020 2020 2020 2020 2020 6e61 6d65 3d66            name=f
+00007b90: 227b 7365 6c66 2e5f 5f63 6c61 7373 5f5f  "{self.__class__
+00007ba0: 2e5f 5f6e 616d 655f 5f7d 2062 7563 6b65  .__name__} bucke
+00007bb0: 745f 6d65 7468 6f64 222c 0a20 2020 2020  t_method",.     
+00007bc0: 2020 2020 2020 2076 616c 7565 3d62 7563         value=buc
+00007bd0: 6b65 745f 6d65 7468 6f64 2c0a 2020 2020  ket_method,.    
+00007be0: 2020 2020 2020 2020 6f70 7469 6f6e 733d          options=
+00007bf0: 4f70 7469 6f6e 732e 4255 434b 4554 5f4d  Options.BUCKET_M
+00007c00: 4554 484f 4453 2e76 616c 7565 2c0a 2020  ETHODS.value,.  
+00007c10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00007c20: 7265 7375 6c74 7320 3d20 6e70 2e66 756c  results = np.ful
+00007c30: 6c28 2864 6174 612e 7368 6170 655b 305d  l((data.shape[0]
+00007c40: 2c20 7469 6d65 5f77 696e 646f 7773 2e73  , time_windows.s
+00007c50: 6861 7065 5b30 5d29 2c20 302e 3029 0a20  hape[0]), 0.0). 
+00007c60: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00007c70: 7072 616e 6765 2874 696d 655f 7769 6e64  prange(time_wind
+00007c80: 6f77 732e 7368 6170 655b 305d 293a 0a20  ows.shape[0]):. 
+00007c90: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00007ca0: 775f 7369 7a65 203d 2069 6e74 2874 696d  w_size = int(tim
+00007cb0: 655f 7769 6e64 6f77 735b 695d 202a 2066  e_windows[i] * f
+00007cc0: 7073 290a 2020 2020 2020 2020 2020 2020  ps).            
+00007cd0: 6461 7461 5f73 706c 6974 203d 206e 702e  data_split = np.
+00007ce0: 7370 6c69 7428 0a20 2020 2020 2020 2020  split(.         
+00007cf0: 2020 2020 2020 2064 6174 612c 206c 6973         data, lis
+00007d00: 7428 7261 6e67 6528 7769 6e64 6f77 5f73  t(range(window_s
+00007d10: 697a 652c 2064 6174 612e 7368 6170 655b  ize, data.shape[
+00007d20: 305d 2c20 7769 6e64 6f77 5f73 697a 6529  0], window_size)
+00007d30: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00007d40: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00007d50: 6a20 696e 2070 7261 6e67 6528 312c 206c  j in prange(1, l
+00007d60: 656e 2864 6174 615f 7370 6c69 7429 293a  en(data_split)):
+00007d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007d80: 2077 696e 646f 775f 7374 6172 7420 3d20   window_start = 
+00007d90: 696e 7428 7769 6e64 6f77 5f73 697a 6520  int(window_size 
+00007da0: 2a20 6a29 0a20 2020 2020 2020 2020 2020  * j).           
+00007db0: 2020 2020 2077 696e 646f 775f 656e 6420       window_end 
+00007dc0: 3d20 696e 7428 7769 6e64 6f77 5f73 7461  = int(window_sta
+00007dd0: 7274 202b 2077 696e 646f 775f 7369 7a65  rt + window_size
+00007de0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00007df0: 2020 7361 6d70 6c65 5f31 2c20 7361 6d70    sample_1, samp
+00007e00: 6c65 5f32 203d 2064 6174 615f 7370 6c69  le_2 = data_spli
+00007e10: 745b 6a20 2d20 315d 2e61 7374 7970 6528  t[j - 1].astype(
+00007e20: 6e70 2e66 6c6f 6174 3332 292c 2064 6174  np.float32), dat
+00007e30: 615f 7370 6c69 745b 0a20 2020 2020 2020  a_split[.       
+00007e40: 2020 2020 2020 2020 2020 2020 206a 0a20               j. 
+00007e50: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00007e60: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00007e70: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
+00007e80: 2020 2020 6269 6e5f 7769 6474 682c 2062      bin_width, b
+00007e90: 696e 5f63 6f75 6e74 203d 2062 7563 6b65  in_count = bucke
+00007ea0: 745f 6461 7461 2864 6174 613d 7361 6d70  t_data(data=samp
+00007eb0: 6c65 5f31 2c20 6d65 7468 6f64 3d62 7563  le_1, method=buc
+00007ec0: 6b65 745f 6d65 7468 6f64 290a 2020 2020  ket_method).    
+00007ed0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00007ee0: 6c65 5f31 5f68 6973 7420 3d20 7365 6c66  le_1_hist = self
+00007ef0: 2e5f 6869 7374 5f31 6428 0a20 2020 2020  ._hist_1d(.     
+00007f00: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00007f10: 6174 613d 7361 6d70 6c65 5f31 2c0a 2020  ata=sample_1,.  
+00007f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007f30: 2020 6269 6e5f 636f 756e 743d 6269 6e5f    bin_count=bin_
+00007f40: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+00007f50: 2020 2020 2020 2020 2020 2072 616e 6765             range
+00007f60: 3d6e 702e 6172 7261 7928 5b30 2c20 696e  =np.array([0, in
+00007f70: 7428 6269 6e5f 7769 6474 6820 2a20 6269  t(bin_width * bi
+00007f80: 6e5f 636f 756e 7429 5d29 2c0a 2020 2020  n_count)]),.    
+00007f90: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00007fa0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+00007fb0: 6d70 6c65 5f32 5f68 6973 7420 3d20 7365  mple_2_hist = se
+00007fc0: 6c66 2e5f 6869 7374 5f31 6428 0a20 2020  lf._hist_1d(.   
+00007fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007fe0: 2064 6174 613d 7361 6d70 6c65 5f32 2c0a   data=sample_2,.
+00007ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008000: 2020 2020 6269 6e5f 636f 756e 743d 6269      bin_count=bi
+00008010: 6e5f 636f 756e 742c 0a20 2020 2020 2020  n_count,.       
+00008020: 2020 2020 2020 2020 2020 2020 2072 616e               ran
+00008030: 6765 3d6e 702e 6172 7261 7928 5b30 2c20  ge=np.array([0, 
+00008040: 696e 7428 6269 6e5f 7769 6474 6820 2a20  int(bin_width * 
+00008050: 6269 6e5f 636f 756e 7429 5d29 2c0a 2020  bin_count)]),.  
+00008060: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00008070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008080: 7361 6d70 6c65 5f31 5f68 6973 742c 2073  sample_1_hist, s
+00008090: 616d 706c 655f 325f 6869 7374 203d 2073  ample_2_hist = s
+000080a0: 616d 706c 655f 315f 6869 7374 202f 206e  ample_1_hist / n
+000080b0: 702e 7375 6d28 0a20 2020 2020 2020 2020  p.sum(.         
+000080c0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+000080d0: 655f 315f 6869 7374 0a20 2020 2020 2020  e_1_hist.       
+000080e0: 2020 2020 2020 2020 2029 2c20 7361 6d70           ), samp
+000080f0: 6c65 5f32 5f68 6973 7420 2f20 6e70 2e73  le_2_hist / np.s
+00008100: 756d 2873 616d 706c 655f 325f 6869 7374  um(sample_2_hist
+00008110: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00008120: 2020 6d65 616e 5f68 6973 7420 3d20 6e70    mean_hist = np
+00008130: 2e6d 6561 6e28 5b73 616d 706c 655f 315f  .mean([sample_1_
+00008140: 6869 7374 2c20 7361 6d70 6c65 5f32 5f68  hist, sample_2_h
+00008150: 6973 745d 2c20 6178 6973 3d30 290a 2020  ist], axis=0).  
+00008160: 2020 2020 2020 2020 2020 2020 2020 6b6c                kl
+00008170: 5f73 616d 706c 655f 312c 206b 6c5f 7361  _sample_1, kl_sa
+00008180: 6d70 6c65 5f32 203d 2073 7461 7473 2e65  mple_2 = stats.e
+00008190: 6e74 726f 7079 280a 2020 2020 2020 2020  ntropy(.        
+000081a0: 2020 2020 2020 2020 2020 2020 706b 3d73              pk=s
+000081b0: 616d 706c 655f 315f 6869 7374 2c20 716b  ample_1_hist, qk
+000081c0: 3d6d 6561 6e5f 6869 7374 0a20 2020 2020  =mean_hist.     
+000081d0: 2020 2020 2020 2020 2020 2029 2c20 7374             ), st
+000081e0: 6174 732e 656e 7472 6f70 7928 706b 3d73  ats.entropy(pk=s
+000081f0: 616d 706c 655f 325f 6869 7374 2c20 716b  ample_2_hist, qk
+00008200: 3d6d 6561 6e5f 6869 7374 290a 2020 2020  =mean_hist).    
+00008210: 2020 2020 2020 2020 2020 2020 6a73 203d              js =
+00008220: 2028 6b6c 5f73 616d 706c 655f 3120 2b20   (kl_sample_1 + 
+00008230: 6b6c 5f73 616d 706c 655f 3229 202f 2032  kl_sample_2) / 2
+00008240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008250: 2072 6573 756c 7473 5b77 696e 646f 775f   results[window_
+00008260: 7374 6172 743a 7769 6e64 6f77 5f65 6e64  start:window_end
+00008270: 2c20 695d 203d 206a 730a 2020 2020 2020  , i] = js.      
+00008280: 2020 7265 7475 726e 2072 6573 756c 7473    return results
+00008290: 0a0a 2020 2020 6465 6620 7761 7373 6572  ..    def wasser
+000082a0: 7374 6569 6e5f 6469 7374 616e 6365 280a  stein_distance(.
+000082b0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000082c0: 2020 2020 2020 7361 6d70 6c65 5f31 3a20        sample_1: 
+000082d0: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
+000082e0: 2020 2020 7361 6d70 6c65 5f32 3a20 6e70      sample_2: np
+000082f0: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
+00008300: 2020 6275 636b 6574 5f6d 6574 686f 643a    bucket_method:
+00008310: 204c 6974 6572 616c 5b0a 2020 2020 2020   Literal[.      
+00008320: 2020 2020 2020 2266 6422 2c20 2264 6f61        "fd", "doa
+00008330: 6e65 222c 2022 6175 746f 222c 2022 7363  ne", "auto", "sc
+00008340: 6f74 7422 2c20 2273 746f 6e65 222c 2022  ott", "stone", "
+00008350: 7269 6365 222c 2022 7374 7572 6765 7322  rice", "sturges"
+00008360: 2c20 2273 7172 7422 0a20 2020 2020 2020  , "sqrt".       
+00008370: 205d 203d 2022 6175 746f 222c 0a20 2020   ] = "auto",.   
+00008380: 2029 202d 3e20 666c 6f61 743a 0a20 2020   ) -> float:.   
+00008390: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000083a0: 2043 6f6d 7075 7465 2057 6173 7365 7273   Compute Wassers
+000083b0: 7465 696e 2064 6973 7461 6e63 6520 6265  tein distance be
+000083c0: 7477 6565 6e20 7477 6f20 6469 7374 7269  tween two distri
+000083d0: 6275 7469 6f6e 732e 0a0a 2020 2020 2020  butions...      
+000083e0: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
+000083f0: 2020 2020 2020 2055 7365 7320 6060 7374         Uses ``st
+00008400: 6174 732e 7761 7373 6572 7374 6569 6e5f  ats.wasserstein_
+00008410: 6469 7374 616e 6365 6060 2e20 4920 6861  distance``. I ha
+00008420: 7665 2074 7269 6564 2074 6f20 6d6f 7665  ve tried to move
+00008430: 2060 6073 7461 7473 2e77 6173 7365 7273   ``stats.wassers
+00008440: 7465 696e 5f64 6973 7461 6e63 6560 6020  tein_distance`` 
+00008450: 746f 206a 6974 7465 6420 6d65 7468 6f64  to jitted method
+00008460: 2065 7874 656e 7369 7665 6c79 2c0a 2020   extensively,.  
+00008470: 2020 2020 2020 2020 2062 7574 2074 6869           but thi
+00008480: 7320 646f 6573 6e27 7420 6769 7665 2073  s doesn't give s
+00008490: 6967 6e69 6669 6361 6e74 2072 756e 7469  ignificant runti
+000084a0: 6d65 2069 6d70 726f 7665 6d65 6e74 2e20  me improvement. 
+000084b0: 5261 7465 2d6c 696d 6974 6572 2061 7070  Rate-limiter app
+000084c0: 6561 7273 2074 6f20 6265 2074 6865 205f  ears to be the _
+000084d0: 6869 7374 5f31 642e 0a0a 2020 2020 2020  hist_1d...      
+000084e0: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
+000084f0: 7272 6179 2073 616d 706c 655f 313a 2046  rray sample_1: F
+00008500: 6972 7374 2031 6420 6172 7261 7920 7265  irst 1d array re
+00008510: 7072 6573 656e 7469 6e67 2066 6561 7475  presenting featu
+00008520: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
+00008530: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
+00008540: 6172 7261 7920 7361 6d70 6c65 5f32 3a20  array sample_2: 
+00008550: 5365 636f 6e64 2031 6420 6172 7261 7920  Second 1d array 
+00008560: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
+00008570: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
+00008580: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
+00008590: 4c69 7465 7261 6c20 6275 636b 6574 5f6d  Literal bucket_m
+000085a0: 6574 686f 643a 2045 7374 696d 6174 6f72  ethod: Estimator
+000085b0: 2064 6574 6572 6d69 6e69 6e67 206f 7074   determining opt
+000085c0: 696d 616c 2062 7563 6b65 7420 636f 756e  imal bucket coun
+000085d0: 7420 616e 6420 6275 636b 6574 2077 6964  t and bucket wid
+000085e0: 7468 2e20 4465 6661 756c 743a 2054 6865  th. Default: The
+000085f0: 206d 6178 696d 756d 206f 6620 7468 6520   maximum of the 
+00008600: 5374 7572 6765 7320 616e 6420 4672 6565  Sturges and Free
+00008610: 646d 616e 2d44 6961 636f 6e69 7320 6573  dman-Diaconis es
+00008620: 7469 6d61 746f 7273 0a20 2020 2020 2020  timators.       
+00008630: 203a 7265 7475 726e 7320 666c 6f61 743a   :returns float:
+00008640: 2057 6173 7365 7273 7465 696e 2064 6973   Wasserstein dis
+00008650: 7461 6e63 6520 6265 7477 6565 6e20 6060  tance between ``
+00008660: 7361 6d70 6c65 5f31 6060 2061 6e64 2060  sample_1`` and `
+00008670: 6073 616d 706c 655f 3260 600a 0a20 2020  `sample_2``..   
+00008680: 2020 2020 203a 6578 616d 706c 653a 0a0a       :example:..
+00008690: 2020 2020 2020 2020 3e3e 3e20 7361 6d70          >>> samp
+000086a0: 6c65 5f31 203d 206e 702e 7261 6e64 6f6d  le_1 = np.random
+000086b0: 2e6e 6f72 6d61 6c28 6c6f 633d 3130 2c20  .normal(loc=10, 
+000086c0: 7363 616c 653d 322c 2073 697a 653d 3130  scale=2, size=10
+000086d0: 290a 2020 2020 2020 2020 3e3e 3e20 7361  ).        >>> sa
+000086e0: 6d70 6c65 5f32 203d 206e 702e 7261 6e64  mple_2 = np.rand
+000086f0: 6f6d 2e6e 6f72 6d61 6c28 6c6f 633d 3130  om.normal(loc=10
+00008700: 2c20 7363 616c 653d 332c 2073 697a 653d  , scale=3, size=
+00008710: 3130 290a 2020 2020 2020 2020 3e3e 3e20  10).        >>> 
+00008720: 5374 6174 6973 7469 6373 2829 2e77 6173  Statistics().was
+00008730: 7365 7273 7465 696e 5f64 6973 7461 6e63  serstein_distanc
+00008740: 6528 7361 6d70 6c65 5f31 3d73 616d 706c  e(sample_1=sampl
+00008750: 655f 312c 2073 616d 706c 655f 323d 7361  e_1, sample_2=sa
+00008760: 6d70 6c65 5f32 290a 2020 2020 2020 2020  mple_2).        
+00008770: 3e3e 3e20 302e 3032 3038 3333 3333 3333  >>> 0.0208333333
+00008780: 3333 3333 3333 3332 0a20 2020 2020 2020  33333332.       
+00008790: 2022 2222 0a20 2020 2020 2020 2063 6865   """.        che
+000087a0: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
+000087b0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000087c0: 3d73 616d 706c 655f 312c 0a20 2020 2020  =sample_1,.     
+000087d0: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
+000087e0: 6174 6973 7469 6373 2e6a 656e 7365 6e5f  atistics.jensen_
+000087f0: 7368 616e 6e6f 6e5f 6469 7665 7267 656e  shannon_divergen
+00008800: 6365 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ce.__name__,.   
+00008810: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00008820: 645f 6e64 696d 733d 2831 2c29 2c0a 2020  d_ndims=(1,),.  
+00008830: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00008840: 6564 5f64 7479 7065 733d 286e 702e 666c  ed_dtypes=(np.fl
+00008850: 6f61 7433 322c 206e 702e 666c 6f61 7436  oat32, np.float6
+00008860: 342c 206e 702e 696e 7433 322c 206e 702e  4, np.int32, np.
+00008870: 696e 7436 342c 2069 6e74 2c20 666c 6f61  int64, int, floa
+00008880: 7429 2c0a 2020 2020 2020 2020 290a 2020  t),.        ).  
+00008890: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
+000088a0: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
+000088b0: 2020 2020 2064 6174 613d 7361 6d70 6c65       data=sample
+000088c0: 5f32 2c0a 2020 2020 2020 2020 2020 2020  _2,.            
+000088d0: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+000088e0: 732e 6a65 6e73 656e 5f73 6861 6e6e 6f6e  s.jensen_shannon
+000088f0: 5f64 6976 6572 6765 6e63 652e 5f5f 6e61  _divergence.__na
+00008900: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00008910: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+00008920: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
+00008930: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+00008940: 6573 3d28 6e70 2e66 6c6f 6174 3332 2c20  es=(np.float32, 
+00008950: 6e70 2e66 6c6f 6174 3634 2c20 6e70 2e69  np.float64, np.i
+00008960: 6e74 3332 2c20 6e70 2e69 6e74 3634 2c20  nt32, np.int64, 
+00008970: 696e 742c 2066 6c6f 6174 292c 0a20 2020  int, float),.   
+00008980: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+00008990: 6865 636b 5f73 7472 280a 2020 2020 2020  heck_str(.      
+000089a0: 2020 2020 2020 6e61 6d65 3d66 227b 7365        name=f"{se
+000089b0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
+000089c0: 616d 655f 5f7d 2062 7563 6b65 745f 6d65  ame__} bucket_me
+000089d0: 7468 6f64 222c 0a20 2020 2020 2020 2020  thod",.         
+000089e0: 2020 2076 616c 7565 3d62 7563 6b65 745f     value=bucket_
+000089f0: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
+00008a00: 2020 2020 6f70 7469 6f6e 733d 4f70 7469      options=Opti
+00008a10: 6f6e 732e 4255 434b 4554 5f4d 4554 484f  ons.BUCKET_METHO
+00008a20: 4453 2e76 616c 7565 2c0a 2020 2020 2020  DS.value,.      
+00008a30: 2020 290a 2020 2020 2020 2020 6269 6e5f    ).        bin_
+00008a40: 7769 6474 682c 2062 696e 5f63 6f75 6e74  width, bin_count
+00008a50: 203d 2062 7563 6b65 745f 6461 7461 2864   = bucket_data(d
+00008a60: 6174 613d 7361 6d70 6c65 5f31 2c20 6d65  ata=sample_1, me
+00008a70: 7468 6f64 3d62 7563 6b65 745f 6d65 7468  thod=bucket_meth
+00008a80: 6f64 290a 2020 2020 2020 2020 7361 6d70  od).        samp
+00008a90: 6c65 5f31 5f68 6973 7420 3d20 7365 6c66  le_1_hist = self
+00008aa0: 2e5f 6869 7374 5f31 6428 0a20 2020 2020  ._hist_1d(.     
+00008ab0: 2020 2020 2020 2064 6174 613d 7361 6d70         data=samp
+00008ac0: 6c65 5f31 2c0a 2020 2020 2020 2020 2020  le_1,.          
+00008ad0: 2020 6269 6e5f 636f 756e 743d 6269 6e5f    bin_count=bin_
+00008ae0: 636f 756e 742c 0a20 2020 2020 2020 2020  count,.         
+00008af0: 2020 2072 616e 6765 3d6e 702e 6172 7261     range=np.arra
+00008b00: 7928 5b30 2c20 696e 7428 6269 6e5f 7769  y([0, int(bin_wi
+00008b10: 6474 6820 2a20 6269 6e5f 636f 756e 7429  dth * bin_count)
+00008b20: 5d29 2c0a 2020 2020 2020 2020 290a 2020  ]),.        ).  
+00008b30: 2020 2020 2020 7361 6d70 6c65 5f32 5f68        sample_2_h
+00008b40: 6973 7420 3d20 7365 6c66 2e5f 6869 7374  ist = self._hist
+00008b50: 5f31 6428 0a20 2020 2020 2020 2020 2020  _1d(.           
+00008b60: 2064 6174 613d 7361 6d70 6c65 5f32 2c0a   data=sample_2,.
+00008b70: 2020 2020 2020 2020 2020 2020 6269 6e5f              bin_
+00008b80: 636f 756e 743d 6269 6e5f 636f 756e 742c  count=bin_count,
+00008b90: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
+00008ba0: 6765 3d6e 702e 6172 7261 7928 5b30 2c20  ge=np.array([0, 
+00008bb0: 696e 7428 6269 6e5f 7769 6474 6820 2a20  int(bin_width * 
+00008bc0: 6269 6e5f 636f 756e 7429 5d29 2c0a 2020  bin_count)]),.  
+00008bd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00008be0: 7361 6d70 6c65 5f31 5f68 6973 742c 2073  sample_1_hist, s
+00008bf0: 616d 706c 655f 325f 6869 7374 203d 2073  ample_2_hist = s
+00008c00: 616d 706c 655f 315f 6869 7374 202f 206e  ample_1_hist / n
+00008c10: 702e 7375 6d28 0a20 2020 2020 2020 2020  p.sum(.         
+00008c20: 2020 2073 616d 706c 655f 315f 6869 7374     sample_1_hist
+00008c30: 0a20 2020 2020 2020 2029 2c20 7361 6d70  .        ), samp
+00008c40: 6c65 5f32 5f68 6973 7420 2f20 6e70 2e73  le_2_hist / np.s
+00008c50: 756d 2873 616d 706c 655f 325f 6869 7374  um(sample_2_hist
+00008c60: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00008c70: 2073 7461 7473 2e77 6173 7365 7273 7465   stats.wasserste
+00008c80: 696e 5f64 6973 7461 6e63 6528 0a20 2020  in_distance(.   
+00008c90: 2020 2020 2020 2020 2075 5f76 616c 7565           u_value
+00008ca0: 733d 7361 6d70 6c65 5f31 5f68 6973 742c  s=sample_1_hist,
+00008cb0: 2076 5f76 616c 7565 733d 7361 6d70 6c65   v_values=sample
+00008cc0: 5f32 5f68 6973 740a 2020 2020 2020 2020  _2_hist.        
+00008cd0: 290a 0a20 2020 2064 6566 2072 6f6c 6c69  )..    def rolli
+00008ce0: 6e67 5f77 6173 7365 7273 7465 696e 5f64  ng_wasserstein_d
+00008cf0: 6973 7461 6e63 6528 0a20 2020 2020 2020  istance(.       
+00008d00: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+00008d10: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+00008d20: 0a20 2020 2020 2020 2074 696d 655f 7769  .        time_wi
+00008d30: 6e64 6f77 733a 206e 702e 6e64 6172 7261  ndows: np.ndarra
+00008d40: 792c 0a20 2020 2020 2020 2066 7073 3a20  y,.        fps: 
+00008d50: 696e 742c 0a20 2020 2020 2020 2062 7563  int,.        buc
+00008d60: 6b65 745f 6d65 7468 6f64 3a20 4c69 7465  ket_method: Lite
+00008d70: 7261 6c5b 0a20 2020 2020 2020 2020 2020  ral[.           
+00008d80: 2022 6664 222c 2022 646f 616e 6522 2c20   "fd", "doane", 
+00008d90: 2261 7574 6f22 2c20 2273 636f 7474 222c  "auto", "scott",
+00008da0: 2022 7374 6f6e 6522 2c20 2272 6963 6522   "stone", "rice"
+00008db0: 2c20 2273 7475 7267 6573 222c 2022 7371  , "sturges", "sq
+00008dc0: 7274 220a 2020 2020 2020 2020 5d20 3d20  rt".        ] = 
+00008dd0: 2261 7574 6f22 2c0a 2020 2020 2920 2d3e  "auto",.    ) ->
+00008de0: 206e 702e 6e64 6172 7261 793a 0a20 2020   np.ndarray:.   
+00008df0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00008e00: 2043 6f6d 7075 7465 2072 6f6c 6c69 6e67   Compute rolling
+00008e10: 2057 6173 7365 7273 7465 696e 2064 6973   Wasserstein dis
+00008e20: 7461 6e63 6520 636f 6d70 6172 696e 6720  tance comparing 
+00008e30: 7468 6520 6375 7272 656e 7420 7469 6d65  the current time
+00008e40: 2d77 696e 646f 7720 6f66 2073 697a 6520  -window of size 
+00008e50: 4e20 746f 2074 6865 2070 7265 6365 6469  N to the precedi
+00008e60: 6e67 2077 696e 646f 7720 6f66 2073 697a  ng window of siz
+00008e70: 6520 4e2e 0a0a 2020 2020 2020 2020 3a70  e N...        :p
+00008e80: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
+00008e90: 2064 6174 613a 2031 4420 6172 7261 7920   data: 1D array 
+00008ea0: 6f66 2073 697a 6520 6c65 6e28 6672 616d  of size len(fram
+00008eb0: 6573 2920 7265 7072 6573 656e 7469 6e67  es) representing
+00008ec0: 2066 6561 7475 7265 2076 616c 7565 732e   feature values.
+00008ed0: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+00008ee0: 7465 7220 6e70 2e6e 6461 7272 6179 5b69  ter np.ndarray[i
+00008ef0: 6e74 735d 2074 696d 655f 7769 6e64 6f77  nts] time_window
+00008f00: 733a 2054 696d 6520 7769 6e64 6f77 7320  s: Time windows 
+00008f10: 746f 2063 6f6d 7075 7465 204a 5320 666f  to compute JS fo
+00008f20: 7220 696e 2073 6563 6f6e 6473 2e0a 2020  r in seconds..  
+00008f30: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+00008f40: 2069 6e74 2066 7073 3a20 4672 616d 652d   int fps: Frame-
+00008f50: 7261 7465 206f 6620 7265 636f 7264 6564  rate of recorded
+00008f60: 2076 6964 656f 2e0a 2020 2020 2020 2020   video..        
+00008f70: 3a70 6172 616d 6574 6572 204c 6974 6572  :parameter Liter
+00008f80: 616c 2062 7563 6b65 745f 6d65 7468 6f64  al bucket_method
+00008f90: 3a20 4573 7469 6d61 746f 7220 6465 7465  : Estimator dete
+00008fa0: 726d 696e 696e 6720 6f70 7469 6d61 6c20  rmining optimal 
+00008fb0: 6275 636b 6574 2063 6f75 6e74 2061 6e64  bucket count and
+00008fc0: 2062 7563 6b65 7420 7769 6474 682e 2044   bucket width. D
+00008fd0: 6566 6175 6c74 3a20 5468 6520 6d61 7869  efault: The maxi
+00008fe0: 6d75 6d20 6f66 2074 6865 2053 7475 7267  mum of the Sturg
+00008ff0: 6573 2061 6e64 2046 7265 6564 6d61 6e2d  es and Freedman-
+00009000: 4469 6163 6f6e 6973 2065 7374 696d 6174  Diaconis estimat
+00009010: 6f72 730a 2020 2020 2020 2020 3a72 6574  ors.        :ret
+00009020: 7572 6e73 206e 702e 6e64 6172 7261 793a  urns np.ndarray:
+00009030: 2053 697a 6520 6461 7461 2e73 6861 7065   Size data.shape
+00009040: 5b30 5d20 7820 7769 6e64 6f77 5f73 697a  [0] x window_siz
+00009050: 6573 2e73 6861 7065 2077 6974 6820 5761  es.shape with Wa
+00009060: 7373 6572 7374 6569 6e20 6469 7374 616e  sserstein distan
+00009070: 6365 2e20 436f 6c75 6d6e 7320 7265 7072  ce. Columns repr
+00009080: 6573 656e 7420 6469 6666 6572 656e 7420  esent different 
+00009090: 7469 6d65 2077 696e 646f 7773 2e0a 0a20  time windows... 
+000090a0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+000090b0: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+000090c0: 6120 3d20 6e70 2e72 616e 646f 6d2e 7261  a = np.random.ra
+000090d0: 6e64 696e 7428 302c 2031 3030 2c20 2831  ndint(0, 100, (1
+000090e0: 3030 2c29 290a 2020 2020 2020 2020 3e3e  00,)).        >>
+000090f0: 3e20 5374 6174 6973 7469 6373 2829 2e72  > Statistics().r
+00009100: 6f6c 6c69 6e67 5f77 6173 7365 7273 7465  olling_wasserste
+00009110: 696e 5f64 6973 7461 6e63 6528 6461 7461  in_distance(data
+00009120: 3d64 6174 612c 2074 696d 655f 7769 6e64  =data, time_wind
+00009130: 6f77 733d 6e70 2e61 7272 6179 285b 312c  ows=np.array([1,
+00009140: 2032 5d29 2c20 6670 733d 3330 290a 2020   2]), fps=30).  
+00009150: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00009160: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
+00009170: 7272 6179 2864 6174 613d 6461 7461 2c20  rray(data=data, 
+00009180: 736f 7572 6365 3d73 656c 662e 5f5f 636c  source=self.__cl
+00009190: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c20  ass__.__name__, 
+000091a0: 6163 6365 7074 6564 5f73 697a 6573 3d5b  accepted_sizes=[
+000091b0: 315d 290a 2020 2020 2020 2020 6368 6563  1]).        chec
+000091c0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
+000091d0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+000091e0: 7469 6d65 5f77 696e 646f 7773 2c20 736f  time_windows, so
+000091f0: 7572 6365 3d73 656c 662e 5f5f 636c 6173  urce=self.__clas
+00009200: 735f 5f2e 5f5f 6e61 6d65 5f5f 2c20 6163  s__.__name__, ac
+00009210: 6365 7074 6564 5f73 697a 6573 3d5b 315d  cepted_sizes=[1]
+00009220: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00009230: 2020 2063 6865 636b 5f69 6e74 286e 616d     check_int(nam
+00009240: 653d 6622 7b73 656c 662e 5f5f 636c 6173  e=f"{self.__clas
+00009250: 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20 6670  s__.__name__} fp
+00009260: 7322 2c20 7661 6c75 653d 6670 732c 206d  s", value=fps, m
+00009270: 696e 5f76 616c 7565 3d31 290a 2020 2020  in_value=1).    
+00009280: 2020 2020 6368 6563 6b5f 7374 7228 0a20      check_str(. 
+00009290: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+000092a0: 6622 7b73 656c 662e 5f5f 636c 6173 735f  f"{self.__class_
+000092b0: 5f2e 5f5f 6e61 6d65 5f5f 7d20 6275 636b  _.__name__} buck
+000092c0: 6574 5f6d 6574 686f 6422 2c0a 2020 2020  et_method",.    
+000092d0: 2020 2020 2020 2020 7661 6c75 653d 6275          value=bu
+000092e0: 636b 6574 5f6d 6574 686f 642c 0a20 2020  cket_method,.   
+000092f0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00009300: 3d4f 7074 696f 6e73 2e42 5543 4b45 545f  =Options.BUCKET_
+00009310: 4d45 5448 4f44 532e 7661 6c75 652c 0a20  METHODS.value,. 
+00009320: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00009330: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
+00009340: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
+00009350: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
+00009360: 7368 6170 655b 305d 292c 2030 2e30 290a  shape[0]), 0.0).
+00009370: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00009380: 2070 7261 6e67 6528 7469 6d65 5f77 696e   prange(time_win
+00009390: 646f 7773 2e73 6861 7065 5b30 5d29 3a0a  dows.shape[0]):.
+000093a0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+000093b0: 6f77 5f73 697a 6520 3d20 696e 7428 7469  ow_size = int(ti
+000093c0: 6d65 5f77 696e 646f 7773 5b69 5d20 2a20  me_windows[i] * 
+000093d0: 6670 7329 0a20 2020 2020 2020 2020 2020  fps).           
+000093e0: 2064 6174 615f 7370 6c69 7420 3d20 6e70   data_split = np
+000093f0: 2e73 706c 6974 280a 2020 2020 2020 2020  .split(.        
+00009400: 2020 2020 2020 2020 6461 7461 2c20 6c69          data, li
+00009410: 7374 2872 616e 6765 2877 696e 646f 775f  st(range(window_
+00009420: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
+00009430: 5b30 5d2c 2077 696e 646f 775f 7369 7a65  [0], window_size
+00009440: 2929 0a20 2020 2020 2020 2020 2020 2029  )).            )
+00009450: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00009460: 206a 2069 6e20 7072 616e 6765 2831 2c20   j in prange(1, 
+00009470: 6c65 6e28 6461 7461 5f73 706c 6974 2929  len(data_split))
+00009480: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009490: 2020 7769 6e64 6f77 5f73 7461 7274 203d    window_start =
+000094a0: 2069 6e74 2877 696e 646f 775f 7369 7a65   int(window_size
+000094b0: 202a 206a 290a 2020 2020 2020 2020 2020   * j).          
+000094c0: 2020 2020 2020 7769 6e64 6f77 5f65 6e64        window_end
+000094d0: 203d 2069 6e74 2877 696e 646f 775f 7374   = int(window_st
+000094e0: 6172 7420 2b20 7769 6e64 6f77 5f73 697a  art + window_siz
+000094f0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00009500: 2020 2073 616d 706c 655f 312c 2073 616d     sample_1, sam
+00009510: 706c 655f 3220 3d20 6461 7461 5f73 706c  ple_2 = data_spl
+00009520: 6974 5b6a 202d 2031 5d2e 6173 7479 7065  it[j - 1].astype
+00009530: 286e 702e 666c 6f61 7433 3229 2c20 6461  (np.float32), da
+00009540: 7461 5f73 706c 6974 5b0a 2020 2020 2020  ta_split[.      
+00009550: 2020 2020 2020 2020 2020 2020 2020 6a0a                j.
+00009560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009570: 5d2e 6173 7479 7065 286e 702e 666c 6f61  ].astype(np.floa
+00009580: 7433 3229 0a20 2020 2020 2020 2020 2020  t32).           
+00009590: 2020 2020 2062 696e 5f77 6964 7468 2c20       bin_width, 
+000095a0: 6269 6e5f 636f 756e 7420 3d20 6275 636b  bin_count = buck
+000095b0: 6574 5f64 6174 6128 6461 7461 3d73 616d  et_data(data=sam
+000095c0: 706c 655f 312c 206d 6574 686f 643d 6275  ple_1, method=bu
+000095d0: 636b 6574 5f6d 6574 686f 6429 0a20 2020  cket_method).   
+000095e0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+000095f0: 706c 655f 315f 6869 7374 203d 2073 656c  ple_1_hist = sel
+00009600: 662e 5f68 6973 745f 3164 280a 2020 2020  f._hist_1d(.    
+00009610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009620: 6461 7461 3d73 616d 706c 655f 312c 0a20  data=sample_1,. 
+00009630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009640: 2020 2062 696e 5f63 6f75 6e74 3d62 696e     bin_count=bin
+00009650: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
+00009660: 2020 2020 2020 2020 2020 2020 7261 6e67              rang
+00009670: 653d 6e70 2e61 7272 6179 285b 302c 2069  e=np.array([0, i
+00009680: 6e74 2862 696e 5f77 6964 7468 202a 2062  nt(bin_width * b
+00009690: 696e 5f63 6f75 6e74 295d 292c 0a20 2020  in_count)]),.   
+000096a0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000096b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000096c0: 616d 706c 655f 325f 6869 7374 203d 2073  ample_2_hist = s
+000096d0: 656c 662e 5f68 6973 745f 3164 280a 2020  elf._hist_1d(.  
+000096e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096f0: 2020 6461 7461 3d73 616d 706c 655f 322c    data=sample_2,
+00009700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009710: 2020 2020 2062 696e 5f63 6f75 6e74 3d62       bin_count=b
+00009720: 696e 5f63 6f75 6e74 2c0a 2020 2020 2020  in_count,.      
+00009730: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00009740: 6e67 653d 6e70 2e61 7272 6179 285b 302c  nge=np.array([0,
+00009750: 2069 6e74 2862 696e 5f77 6964 7468 202a   int(bin_width *
+00009760: 2062 696e 5f63 6f75 6e74 295d 292c 0a20   bin_count)]),. 
+00009770: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00009780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009790: 2073 616d 706c 655f 315f 6869 7374 2c20   sample_1_hist, 
+000097a0: 7361 6d70 6c65 5f32 5f68 6973 7420 3d20  sample_2_hist = 
+000097b0: 7361 6d70 6c65 5f31 5f68 6973 7420 2f20  sample_1_hist / 
+000097c0: 6e70 2e73 756d 280a 2020 2020 2020 2020  np.sum(.        
+000097d0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+000097e0: 6c65 5f31 5f68 6973 740a 2020 2020 2020  le_1_hist.      
+000097f0: 2020 2020 2020 2020 2020 292c 2073 616d            ), sam
+00009800: 706c 655f 325f 6869 7374 202f 206e 702e  ple_2_hist / np.
+00009810: 7375 6d28 7361 6d70 6c65 5f32 5f68 6973  sum(sample_2_his
+00009820: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00009830: 2020 2077 203d 2073 7461 7473 2e77 6173     w = stats.was
+00009840: 7365 7273 7465 696e 5f64 6973 7461 6e63  serstein_distanc
+00009850: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00009860: 2020 2020 2020 2075 5f76 616c 7565 733d         u_values=
+00009870: 7361 6d70 6c65 5f31 5f68 6973 742c 2076  sample_1_hist, v
+00009880: 5f76 616c 7565 733d 7361 6d70 6c65 5f32  _values=sample_2
+00009890: 5f68 6973 740a 2020 2020 2020 2020 2020  _hist.          
+000098a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000098b0: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
+000098c0: 7769 6e64 6f77 5f73 7461 7274 3a77 696e  window_start:win
+000098d0: 646f 775f 656e 642c 2069 5d20 3d20 770a  dow_end, i] = w.
+000098e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000098f0: 7265 7375 6c74 730a 0a20 2020 2040 7374  results..    @st
+00009900: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+00009910: 6566 2074 6f74 616c 5f76 6172 6961 7469  ef total_variati
+00009920: 6f6e 5f64 6973 7461 6e63 6528 0a20 2020  on_distance(.   
+00009930: 2020 2020 2078 3a20 6e70 2e6e 6461 7272       x: np.ndarr
+00009940: 6179 2c0a 2020 2020 2020 2020 793a 206e  ay,.        y: n
+00009950: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
+00009960: 2020 2062 7563 6b65 745f 6d65 7468 6f64     bucket_method
+00009970: 3a20 4f70 7469 6f6e 616c 5b0a 2020 2020  : Optional[.    
+00009980: 2020 2020 2020 2020 4c69 7465 7261 6c5b          Literal[
+00009990: 2266 6422 2c20 2264 6f61 6e65 222c 2022  "fd", "doane", "
+000099a0: 6175 746f 222c 2022 7363 6f74 7422 2c20  auto", "scott", 
+000099b0: 2273 746f 6e65 222c 2022 7269 6365 222c  "stone", "rice",
+000099c0: 2022 7374 7572 6765 7322 2c20 2273 7172   "sturges", "sqr
+000099d0: 7422 5d0a 2020 2020 2020 2020 5d20 3d20  t"].        ] = 
+000099e0: 2261 7574 6f22 2c0a 2020 2020 293a 0a20  "auto",.    ):. 
+000099f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00009a00: 2020 2043 616c 6375 6c61 7465 2074 6865     Calculate the
+00009a10: 2074 6f74 616c 2076 6172 6961 7469 6f6e   total variation
+00009a20: 2064 6973 7461 6e63 6520 6265 7477 6565   distance betwee
+00009a30: 6e20 7477 6f20 7072 6f62 6162 696c 6974  n two probabilit
+00009a40: 7920 6469 7374 7269 6275 7469 6f6e 732e  y distributions.
+00009a50: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00009a60: 206e 702e 6e64 6172 7261 7920 783a 2041   np.ndarray x: A
+00009a70: 2031 2d44 2061 7272 6179 2072 6570 7265   1-D array repre
+00009a80: 7365 6e74 696e 6720 7468 6520 6669 7273  senting the firs
+00009a90: 7420 7361 6d70 6c65 2e0a 2020 2020 2020  t sample..      
+00009aa0: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+00009ab0: 7261 7920 793a 2041 2031 2d44 2061 7272  ray y: A 1-D arr
+00009ac0: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+00009ad0: 7468 6520 7365 636f 6e64 2073 616d 706c  the second sampl
+00009ae0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00009af0: 6d20 4f70 7469 6f6e 616c 5b73 7472 5d20  m Optional[str] 
+00009b00: 6275 636b 6574 5f6d 6574 686f 643a 2054  bucket_method: T
+00009b10: 6865 206d 6574 686f 6420 7573 6564 2074  he method used t
+00009b20: 6f20 6465 7465 726d 696e 6520 7468 6520  o determine the 
+00009b30: 6e75 6d62 6572 206f 6620 6269 6e73 2066  number of bins f
+00009b40: 6f72 2068 6973 746f 6772 616d 2063 6f6d  or histogram com
+00009b50: 7075 7461 7469 6f6e 2e20 5375 7070 6f72  putation. Suppor
+00009b60: 7465 6420 6d65 7468 6f64 7320 6172 6520  ted methods are 
+00009b70: 2766 6427 2028 4672 6565 646d 616e 2d44  'fd' (Freedman-D
+00009b80: 6961 636f 6e69 7329 2c20 2764 6f61 6e65  iaconis), 'doane
+00009b90: 272c 2027 6175 746f 272c 2027 7363 6f74  ', 'auto', 'scot
+00009ba0: 7427 2c20 2773 746f 6e65 272c 2027 7269  t', 'stone', 'ri
+00009bb0: 6365 272c 2027 7374 7572 6765 7327 2c20  ce', 'sturges', 
+00009bc0: 616e 6420 2773 7172 7427 2e20 4465 6661  and 'sqrt'. Defa
+00009bd0: 756c 7473 2074 6f20 2761 7574 6f27 2e0a  ults to 'auto'..
+00009be0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+00009bf0: 666c 6f61 743a 2054 6865 2074 6f74 616c  float: The total
+00009c00: 2076 6172 6961 7469 6f6e 2064 6973 7461   variation dista
+00009c10: 6e63 6520 6265 7477 6565 6e20 7468 6520  nce between the 
+00009c20: 7477 6f20 6469 7374 7269 6275 7469 6f6e  two distribution
+00009c30: 732e 0a0a 2020 2020 2020 2020 2e2e 206d  s...        .. m
+00009c40: 6174 683a 3a0a 0a20 2020 2020 2020 2020  ath::..         
+00009c50: 2020 5456 2850 2c20 5129 203d 2030 2e35    TV(P, Q) = 0.5
+00009c60: 205c 7375 6d5f 6920 7c50 5f69 202d 2051   \sum_i |P_i - Q
+00009c70: 5f69 7c0a 0a20 2020 2020 2020 2077 6865  _i|..        whe
+00009c80: 7265 203a 6d61 7468 3a60 505f 6960 2061  re :math:`P_i` a
+00009c90: 6e64 203a 6d61 7468 3a60 515f 6960 2061  nd :math:`Q_i` a
+00009ca0: 7265 2074 6865 2070 726f 6261 6269 6c69  re the probabili
+00009cb0: 7469 6573 2061 7373 6967 6e65 6420 6279  ties assigned by
+00009cc0: 2074 6865 2064 6973 7472 6962 7574 696f   the distributio
+00009cd0: 6e73 203a 6d61 7468 3a60 5060 2061 6e64  ns :math:`P` and
+00009ce0: 203a 6d61 7468 3a60 5160 0a20 2020 2020   :math:`Q`.     
+00009cf0: 2020 2074 6f20 7468 6520 7361 6d65 2065     to the same e
+00009d00: 7665 6e74 203a 6d61 7468 3a60 6960 2c20  vent :math:`i`, 
+00009d10: 7265 7370 6563 7469 7665 6c79 2e0a 0a20  respectively... 
+00009d20: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+00009d30: 0a20 2020 2020 2020 203e 3e3e 2074 6f74  .        >>> tot
+00009d40: 616c 5f76 6172 6961 7469 6f6e 5f64 6973  al_variation_dis
+00009d50: 7461 6e63 6528 783d 6e70 2e61 7272 6179  tance(x=np.array
+00009d60: 285b 312c 2035 2c20 3130 2c20 3230 2c20  ([1, 5, 10, 20, 
+00009d70: 3530 5d29 2c20 793d 6e70 2e61 7272 6179  50]), y=np.array
+00009d80: 285b 312c 2035 2c20 3130 2c20 3130 302c  ([1, 5, 10, 100,
+00009d90: 2031 3130 5d29 290a 2020 2020 2020 2020   110])).        
+00009da0: 3e3e 3e20 302e 3339 3939 3939 3937 3631  >>> 0.3999999761
+00009db0: 3538 3134 3231 0a20 2020 2020 2020 2022  581421.        "
+00009dc0: 2222 0a0a 2020 2020 2020 2020 6368 6563  ""..        chec
+00009dd0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
+00009de0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00009df0: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
+00009e00: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
+00009e10: 2e74 6f74 616c 5f76 6172 6961 7469 6f6e  .total_variation
+00009e20: 5f64 6973 7461 6e63 652e 5f5f 6e61 6d65  _distance.__name
+00009e30: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
+00009e40: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
+00009e50: 312c 292c 0a20 2020 2020 2020 2020 2020  1,),.           
+00009e60: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
+00009e70: 3d28 0a20 2020 2020 2020 2020 2020 2020  =(.             
+00009e80: 2020 206e 702e 696e 7436 342c 0a20 2020     np.int64,.   
+00009e90: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+00009ea0: 696e 7433 322c 0a20 2020 2020 2020 2020  int32,.         
+00009eb0: 2020 2020 2020 206e 702e 696e 7438 2c0a         np.int8,.
+00009ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ed0: 6e70 2e66 6c6f 6174 3332 2c0a 2020 2020  np.float32,.    
+00009ee0: 2020 2020 2020 2020 2020 2020 6e70 2e66              np.f
+00009ef0: 6c6f 6174 3634 2c0a 2020 2020 2020 2020  loat64,.        
+00009f00: 2020 2020 2020 2020 696e 742c 0a20 2020          int,.   
+00009f10: 2020 2020 2020 2020 2020 2020 2066 6c6f               flo
+00009f20: 6174 2c0a 2020 2020 2020 2020 2020 2020  at,.            
+00009f30: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+00009f40: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
+00009f50: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
+00009f60: 2020 2020 6461 7461 3d79 2c0a 2020 2020      data=y,.    
+00009f70: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
+00009f80: 7461 7469 7374 6963 732e 746f 7461 6c5f  tatistics.total_
+00009f90: 7661 7269 6174 696f 6e5f 6469 7374 616e  variation_distan
+00009fa0: 6365 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ce.__name__,.   
+00009fb0: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00009fc0: 645f 6e64 696d 733d 2831 2c29 2c0a 2020  d_ndims=(1,),.  
+00009fd0: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00009fe0: 6564 5f64 7479 7065 733d 280a 2020 2020  ed_dtypes=(.    
+00009ff0: 2020 2020 2020 2020 2020 2020 6e70 2e69              np.i
+0000a000: 6e74 3634 2c0a 2020 2020 2020 2020 2020  nt64,.          
+0000a010: 2020 2020 2020 6e70 2e69 6e74 3332 2c0a        np.int32,.
+0000a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a030: 6e70 2e69 6e74 382c 0a20 2020 2020 2020  np.int8,.       
+0000a040: 2020 2020 2020 2020 206e 702e 666c 6f61           np.floa
+0000a050: 7433 322c 0a20 2020 2020 2020 2020 2020  t32,.           
+0000a060: 2020 2020 206e 702e 666c 6f61 7436 342c       np.float64,
+0000a070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a080: 2069 6e74 2c0a 2020 2020 2020 2020 2020   int,.          
+0000a090: 2020 2020 2020 666c 6f61 742c 0a20 2020        float,.   
+0000a0a0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+0000a0b0: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
+0000a0c0: 6563 6b5f 7374 7228 0a20 2020 2020 2020  eck_str(.       
+0000a0d0: 2020 2020 206e 616d 653d 6622 7b53 7461       name=f"{Sta
+0000a0e0: 7469 7374 6963 732e 746f 7461 6c5f 7661  tistics.total_va
+0000a0f0: 7269 6174 696f 6e5f 6469 7374 616e 6365  riation_distance
+0000a100: 2e5f 5f6e 616d 655f 5f7d 206d 6574 686f  .__name__} metho
+0000a110: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0000a120: 7661 6c75 653d 6275 636b 6574 5f6d 6574  value=bucket_met
+0000a130: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
+0000a140: 206f 7074 696f 6e73 3d4f 7074 696f 6e73   options=Options
+0000a150: 2e42 5543 4b45 545f 4d45 5448 4f44 532e  .BUCKET_METHODS.
+0000a160: 7661 6c75 652c 0a20 2020 2020 2020 2029  value,.        )
+0000a170: 0a20 2020 2020 2020 2062 696e 5f77 6964  .        bin_wid
+0000a180: 7468 2c20 6269 6e5f 636f 756e 7420 3d20  th, bin_count = 
+0000a190: 6275 636b 6574 5f64 6174 6128 6461 7461  bucket_data(data
+0000a1a0: 3d78 2c20 6d65 7468 6f64 3d62 7563 6b65  =x, method=bucke
+0000a1b0: 745f 6d65 7468 6f64 290a 2020 2020 2020  t_method).      
+0000a1c0: 2020 7331 5f68 203d 2053 7461 7469 7374    s1_h = Statist
+0000a1d0: 6963 732e 5f68 6973 745f 3164 280a 2020  ics._hist_1d(.  
+0000a1e0: 2020 2020 2020 2020 2020 6461 7461 3d78            data=x
+0000a1f0: 2c0a 2020 2020 2020 2020 2020 2020 6269  ,.            bi
+0000a200: 6e5f 636f 756e 743d 6269 6e5f 636f 756e  n_count=bin_coun
+0000a210: 742c 0a20 2020 2020 2020 2020 2020 2072  t,.            r
+0000a220: 616e 6765 3d6e 702e 6172 7261 7928 5b30  ange=np.array([0
+0000a230: 2c20 696e 7428 6269 6e5f 7769 6474 6820  , int(bin_width 
+0000a240: 2a20 6269 6e5f 636f 756e 7429 5d29 2c0a  * bin_count)]),.
+0000a250: 2020 2020 2020 2020 2020 2020 6e6f 726d              norm
+0000a260: 616c 697a 653d 5472 7565 2c0a 2020 2020  alize=True,.    
+0000a270: 2020 2020 290a 2020 2020 2020 2020 7332      ).        s2
+0000a280: 5f68 203d 2053 7461 7469 7374 6963 732e  _h = Statistics.
+0000a290: 5f68 6973 745f 3164 280a 2020 2020 2020  _hist_1d(.      
+0000a2a0: 2020 2020 2020 6461 7461 3d79 2c0a 2020        data=y,.  
+0000a2b0: 2020 2020 2020 2020 2020 6269 6e5f 636f            bin_co
+0000a2c0: 756e 743d 6269 6e5f 636f 756e 742c 0a20  unt=bin_count,. 
+0000a2d0: 2020 2020 2020 2020 2020 2072 616e 6765             range
+0000a2e0: 3d6e 702e 6172 7261 7928 5b30 2c20 696e  =np.array([0, in
+0000a2f0: 7428 6269 6e5f 7769 6474 6820 2a20 6269  t(bin_width * bi
+0000a300: 6e5f 636f 756e 7429 5d29 2c0a 2020 2020  n_count)]),.    
+0000a310: 2020 2020 2020 2020 6e6f 726d 616c 697a          normaliz
+0000a320: 653d 5472 7565 2c0a 2020 2020 2020 2020  e=True,.        
+0000a330: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0000a340: 2030 2e35 202a 206e 702e 7375 6d28 6e70   0.5 * np.sum(np
+0000a350: 2e61 6273 2873 315f 6820 2d20 7332 5f68  .abs(s1_h - s2_h
+0000a360: 2929 0a0a 2020 2020 6465 6620 706f 7075  ))..    def popu
+0000a370: 6c61 7469 6f6e 5f73 7461 6269 6c69 7479  lation_stability
+0000a380: 5f69 6e64 6578 280a 2020 2020 2020 2020  _index(.        
+0000a390: 7365 6c66 2c0a 2020 2020 2020 2020 7361  self,.        sa
+0000a3a0: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
+0000a3b0: 6179 2c0a 2020 2020 2020 2020 7361 6d70  ay,.        samp
+0000a3c0: 6c65 5f32 3a20 6e70 2e6e 6461 7272 6179  le_2: np.ndarray
+0000a3d0: 2c0a 2020 2020 2020 2020 6669 6c6c 5f76  ,.        fill_v
+0000a3e0: 616c 7565 3a20 4f70 7469 6f6e 616c 5b69  alue: Optional[i
+0000a3f0: 6e74 5d20 3d20 312c 0a20 2020 2020 2020  nt] = 1,.       
+0000a400: 2062 7563 6b65 745f 6d65 7468 6f64 3a20   bucket_method: 
+0000a410: 4f70 7469 6f6e 616c 5b0a 2020 2020 2020  Optional[.      
+0000a420: 2020 2020 2020 4c69 7465 7261 6c5b 2266        Literal["f
+0000a430: 6422 2c20 2264 6f61 6e65 222c 2022 6175  d", "doane", "au
+0000a440: 746f 222c 2022 7363 6f74 7422 2c20 2273  to", "scott", "s
+0000a450: 746f 6e65 222c 2022 7269 6365 222c 2022  tone", "rice", "
+0000a460: 7374 7572 6765 7322 2c20 2273 7172 7422  sturges", "sqrt"
+0000a470: 5d0a 2020 2020 2020 2020 5d20 3d20 2261  ].        ] = "a
+0000a480: 7574 6f22 2c0a 2020 2020 2920 2d3e 2066  uto",.    ) -> f
+0000a490: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
+0000a4a0: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
+0000a4b0: 6520 506f 7075 6c61 7469 6f6e 2053 7461  e Population Sta
+0000a4c0: 6269 6c69 7479 2049 6e64 6578 2028 5053  bility Index (PS
+0000a4d0: 4929 2063 6f6d 7061 7269 6e67 2074 776f  I) comparing two
+0000a4e0: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
+0000a4f0: 0a20 2020 2020 2020 2054 6865 2050 6f70  .        The Pop
+0000a500: 756c 6174 696f 6e20 5374 6162 696c 6974  ulation Stabilit
+0000a510: 7920 496e 6465 7820 2850 5349 2920 6973  y Index (PSI) is
+0000a520: 2061 206d 6561 7375 7265 206f 6620 7468   a measure of th
+0000a530: 6520 6469 6666 6572 656e 6365 2069 6e20  e difference in 
+0000a540: 6469 7374 7269 6275 7469 6f6e 0a20 2020  distribution.   
+0000a550: 2020 2020 2070 6174 7465 726e 7320 6265       patterns be
+0000a560: 7477 6565 6e20 7477 6f20 6772 6f75 7073  tween two groups
+0000a570: 206f 6620 6461 7461 2e20 4120 6c6f 7720   of data. A low 
+0000a580: 5053 4920 7661 6c75 6520 696e 6469 6361  PSI value indica
+0000a590: 7465 7320 6120 6d69 6e69 6d61 6c20 6f72  tes a minimal or
+0000a5a0: 206e 6567 6c69 6769 626c 6520 6368 616e   negligible chan
+0000a5b0: 6765 2069 6e20 7468 6520 6469 7374 7269  ge in the distri
+0000a5c0: 6275 7469 6f6e 2070 6174 7465 726e 7320  bution patterns 
+0000a5d0: 6265 7477 6565 6e20 7468 6520 7477 6f20  between the two 
+0000a5e0: 7361 6d70 6c65 732e 0a20 2020 2020 2020  samples..       
+0000a5f0: 2041 2068 6967 6820 5053 4920 7661 6c75   A high PSI valu
+0000a600: 6520 7375 6767 6573 7473 2061 2073 6967  e suggests a sig
+0000a610: 6e69 6669 6361 6e74 2064 6966 6665 7265  nificant differe
+0000a620: 6e63 6520 696e 2074 6865 2064 6973 7472  nce in the distr
+0000a630: 6962 7574 696f 6e20 7061 7474 6572 6e73  ibution patterns
+0000a640: 2062 6574 7765 656e 2074 6865 2074 776f   between the two
+0000a650: 2073 616d 706c 6573 2e0a 0a20 2020 2020   samples...     
+0000a660: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
+0000a670: 2020 2020 2020 2020 456d 7074 7920 6269          Empty bi
+0000a680: 6e73 2028 3020 6f62 7365 7276 6174 696f  ns (0 observatio
+0000a690: 6e73 2069 6e20 6269 6e29 2069 6e20 6973  ns in bin) in is
+0000a6a0: 2072 6570 6c61 6365 6420 7769 7468 2060   replaced with `
+0000a6b0: 6066 696c 6c5f 7661 6c75 6560 602e 2054  `fill_value``. T
+0000a6c0: 6865 2050 5349 2076 616c 7565 2072 616e  he PSI value ran
+0000a6d0: 6765 7320 6672 6f6d 2030 2074 6f20 706f  ges from 0 to po
+0000a6e0: 7369 7469 7665 2069 6e66 696e 6974 792e  sitive infinity.
+0000a6f0: 0a0a 2020 2020 2020 2020 5468 6520 506f  ..        The Po
+0000a700: 7075 6c61 7469 6f6e 2053 7461 6269 6c69  pulation Stabili
+0000a710: 7479 2049 6e64 6578 2028 5053 4929 2069  ty Index (PSI) i
+0000a720: 7320 6361 6c63 756c 6174 6564 2061 733a  s calculated as:
+0000a730: 0a0a 2020 2020 2020 2020 2e2e 206d 6174  ..        .. mat
+0000a740: 683a 3a0a 0a20 2020 2020 2020 2020 2020  h::..           
+0000a750: 5053 4920 3d20 5c5c 7375 6d20 5c5c 6c65  PSI = \\sum \\le
+0000a760: 6674 285c 5c66 7261 637b 7b70 5f32 202d  ft(\\frac{{p_2 -
+0000a770: 2070 5f31 7d7d 7b7b 6c6e 2870 5f32 202f   p_1}}{{ln(p_2 /
+0000a780: 2070 5f31 297d 7d5c 5c72 6967 6874 290a   p_1)}}\\right).
+0000a790: 0a20 2020 2020 2020 2077 6865 7265 3a0a  .        where:.
+0000a7a0: 2020 2020 2020 2020 2020 2020 2d20 5c28              - \(
+0000a7b0: 2070 5f31 205c 2920 616e 6420 5c28 2070   p_1 \) and \( p
+0000a7c0: 5f32 205c 2920 6172 6520 7468 6520 7072  _2 \) are the pr
+0000a7d0: 6f70 6f72 7469 6f6e 7320 6f66 206f 6273  oportions of obs
+0000a7e0: 6572 7661 7469 6f6e 7320 696e 2074 6865  ervations in the
+0000a7f0: 2062 696e 7320 666f 7220 7361 6d70 6c65   bins for sample
+0000a800: 2031 2061 6e64 2073 616d 706c 6520 3220   1 and sample 2 
+0000a810: 7265 7370 6563 7469 7665 6c79 2e0a 0a20  respectively... 
+0000a820: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0000a830: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
+0000a840: 5f31 3a20 4669 7273 7420 3164 2061 7272  _1: First 1d arr
+0000a850: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+0000a860: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+0000a870: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+0000a880: 6572 206e 6461 7272 6179 2073 616d 706c  er ndarray sampl
+0000a890: 655f 323a 2053 6563 6f6e 6420 3164 2061  e_2: Second 1d a
+0000a8a0: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+0000a8b0: 6720 6665 6174 7572 6520 7661 6c75 6573  g feature values
+0000a8c0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000a8d0: 6574 6572 204f 7074 696f 6e61 6c5b 696e  eter Optional[in
+0000a8e0: 745d 2066 696c 6c5f 7661 6c75 653a 2045  t] fill_value: E
+0000a8f0: 6d70 7479 2062 696e 7320 2830 206f 6273  mpty bins (0 obs
+0000a900: 6572 7661 7469 6f6e 7320 696e 2062 696e  ervations in bin
+0000a910: 2920 696e 2069 7320 7265 706c 6163 6564  ) in is replaced
+0000a920: 2077 6974 6820 6060 6669 6c6c 5f76 616c   with ``fill_val
+0000a930: 7565 6060 2e20 4465 6661 756c 7420 312e  ue``. Default 1.
+0000a940: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
+0000a950: 7465 7220 4c69 7465 7261 6c20 6275 636b  ter Literal buck
+0000a960: 6574 5f6d 6574 686f 643a 2045 7374 696d  et_method: Estim
+0000a970: 6174 6f72 2064 6574 6572 6d69 6e69 6e67  ator determining
+0000a980: 206f 7074 696d 616c 2062 7563 6b65 7420   optimal bucket 
+0000a990: 636f 756e 7420 616e 6420 6275 636b 6574  count and bucket
+0000a9a0: 2077 6964 7468 2e20 4465 6661 756c 743a   width. Default:
+0000a9b0: 2054 6865 206d 6178 696d 756d 206f 6620   The maximum of 
+0000a9c0: 7468 6520 5374 7572 6765 7320 616e 6420  the Sturges and 
+0000a9d0: 4672 6565 646d 616e 2d44 6961 636f 6e69  Freedman-Diaconi
+0000a9e0: 7320 6573 7469 6d61 746f 7273 0a20 2020  s estimators.   
+0000a9f0: 2020 2020 203a 7265 7475 726e 7320 666c       :returns fl
+0000aa00: 6f61 743a 2050 5349 2064 6973 7461 6e63  oat: PSI distanc
+0000aa10: 6520 6265 7477 6565 6e20 6060 7361 6d70  e between ``samp
+0000aa20: 6c65 5f31 6060 2061 6e64 2060 6073 616d  le_1`` and ``sam
+0000aa30: 706c 655f 3260 600a 0a20 2020 2020 2020  ple_2``..       
+0000aa40: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+0000aa50: 2020 203e 3e3e 2073 616d 706c 655f 312c     >>> sample_1,
+0000aa60: 2073 616d 706c 655f 3220 3d20 6e70 2e72   sample_2 = np.r
+0000aa70: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+0000aa80: 2031 3030 2c20 2831 3030 2c29 292c 206e   100, (100,)), n
+0000aa90: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
+0000aaa0: 2830 2c20 3130 2c20 2831 3030 2c29 290a  (0, 10, (100,)).
+0000aab0: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
+0000aac0: 6973 7469 6373 2829 2e70 6f70 756c 6174  istics().populat
+0000aad0: 696f 6e5f 7374 6162 696c 6974 795f 696e  ion_stability_in
+0000aae0: 6465 7828 7361 6d70 6c65 5f31 3d73 616d  dex(sample_1=sam
+0000aaf0: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+0000ab00: 7361 6d70 6c65 5f32 2c20 6669 6c6c 5f76  sample_2, fill_v
+0000ab10: 616c 7565 3d31 2c20 6275 636b 6574 5f6d  alue=1, bucket_m
+0000ab20: 6574 686f 643d 2761 7574 6f27 290a 2020  ethod='auto').  
+0000ab30: 2020 2020 2020 3e3e 3e20 332e 3936 3537        >>> 3.9657
+0000ab40: 3032 3638 3637 3535 3338 3137 0a20 2020  026867553817.   
+0000ab50: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0000ab60: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
+0000ab70: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
+0000ab80: 2064 6174 613d 7361 6d70 6c65 5f31 2c20   data=sample_1, 
+0000ab90: 736f 7572 6365 3d73 656c 662e 5f5f 636c  source=self.__cl
+0000aba0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c20  ass__.__name__, 
+0000abb0: 6163 6365 7074 6564 5f73 697a 6573 3d5b  accepted_sizes=[
+0000abc0: 315d 0a20 2020 2020 2020 2029 0a20 2020  1].        ).   
+0000abd0: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
+0000abe0: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
+0000abf0: 2020 2020 6461 7461 3d73 616d 706c 655f      data=sample_
+0000ac00: 322c 2073 6f75 7263 653d 7365 6c66 2e5f  2, source=self._
+0000ac10: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+0000ac20: 5f2c 2061 6363 6570 7465 645f 7369 7a65  _, accepted_size
+0000ac30: 733d 5b31 5d0a 2020 2020 2020 2020 290a  s=[1].        ).
+0000ac40: 2020 2020 2020 2020 6368 6563 6b5f 696e          check_in
+0000ac50: 7428 6e61 6d65 3d73 656c 662e 5f5f 636c  t(name=self.__cl
+0000ac60: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c20  ass__.__name__, 
+0000ac70: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+0000ac80: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
+0000ac90: 7374 7228 0a20 2020 2020 2020 2020 2020  str(.           
+0000aca0: 206e 616d 653d 7365 6c66 2e5f 5f63 6c61   name=self.__cla
+0000acb0: 7373 5f5f 2e5f 5f6e 616d 655f 5f2c 0a20  ss__.__name__,. 
+0000acc0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0000acd0: 3d62 7563 6b65 745f 6d65 7468 6f64 2c0a  =bucket_method,.
+0000ace0: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+0000acf0: 6f6e 733d 4f70 7469 6f6e 732e 4255 434b  ons=Options.BUCK
+0000ad00: 4554 5f4d 4554 484f 4453 2e76 616c 7565  ET_METHODS.value
+0000ad10: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0000ad20: 2020 2020 6269 6e5f 7769 6474 682c 2062      bin_width, b
+0000ad30: 696e 5f63 6f75 6e74 203d 2062 7563 6b65  in_count = bucke
+0000ad40: 745f 6461 7461 2864 6174 613d 7361 6d70  t_data(data=samp
+0000ad50: 6c65 5f31 2c20 6d65 7468 6f64 3d62 7563  le_1, method=buc
+0000ad60: 6b65 745f 6d65 7468 6f64 290a 2020 2020  ket_method).    
+0000ad70: 2020 2020 7361 6d70 6c65 5f31 5f68 6973      sample_1_his
+0000ad80: 7420 3d20 7365 6c66 2e5f 6869 7374 5f31  t = self._hist_1
+0000ad90: 6428 0a20 2020 2020 2020 2020 2020 2064  d(.            d
+0000ada0: 6174 613d 7361 6d70 6c65 5f31 2c0a 2020  ata=sample_1,.  
+0000adb0: 2020 2020 2020 2020 2020 6269 6e5f 636f            bin_co
+0000adc0: 756e 743d 6269 6e5f 636f 756e 742c 0a20  unt=bin_count,. 
+0000add0: 2020 2020 2020 2020 2020 2072 616e 6765             range
+0000ade0: 3d6e 702e 6172 7261 7928 5b30 2c20 696e  =np.array([0, in
+0000adf0: 7428 6269 6e5f 7769 6474 6820 2a20 6269  t(bin_width * bi
+0000ae00: 6e5f 636f 756e 7429 5d29 2c0a 2020 2020  n_count)]),.    
+0000ae10: 2020 2020 290a 2020 2020 2020 2020 7361      ).        sa
+0000ae20: 6d70 6c65 5f32 5f68 6973 7420 3d20 7365  mple_2_hist = se
+0000ae30: 6c66 2e5f 6869 7374 5f31 6428 0a20 2020  lf._hist_1d(.   
+0000ae40: 2020 2020 2020 2020 2064 6174 613d 7361           data=sa
+0000ae50: 6d70 6c65 5f32 2c0a 2020 2020 2020 2020  mple_2,.        
+0000ae60: 2020 2020 6269 6e5f 636f 756e 743d 6269      bin_count=bi
+0000ae70: 6e5f 636f 756e 742c 0a20 2020 2020 2020  n_count,.       
+0000ae80: 2020 2020 2072 616e 6765 3d6e 702e 6172       range=np.ar
+0000ae90: 7261 7928 5b30 2c20 696e 7428 6269 6e5f  ray([0, int(bin_
+0000aea0: 7769 6474 6820 2a20 6269 6e5f 636f 756e  width * bin_coun
+0000aeb0: 7429 5d29 2c0a 2020 2020 2020 2020 290a  t)]),.        ).
+0000aec0: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
+0000aed0: 5f68 6973 745b 7361 6d70 6c65 5f31 5f68  _hist[sample_1_h
+0000aee0: 6973 7420 3d3d 2030 5d20 3d20 6669 6c6c  ist == 0] = fill
+0000aef0: 5f76 616c 7565 0a20 2020 2020 2020 2073  _value.        s
+0000af00: 616d 706c 655f 325f 6869 7374 5b73 616d  ample_2_hist[sam
+0000af10: 706c 655f 325f 6869 7374 203d 3d20 305d  ple_2_hist == 0]
+0000af20: 203d 2066 696c 6c5f 7661 6c75 650a 2020   = fill_value.  
+0000af30: 2020 2020 2020 7361 6d70 6c65 5f31 5f68        sample_1_h
+0000af40: 6973 742c 2073 616d 706c 655f 325f 6869  ist, sample_2_hi
+0000af50: 7374 203d 2073 616d 706c 655f 315f 6869  st = sample_1_hi
+0000af60: 7374 202f 206e 702e 7375 6d28 0a20 2020  st / np.sum(.   
+0000af70: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+0000af80: 315f 6869 7374 0a20 2020 2020 2020 2029  1_hist.        )
+0000af90: 2c20 7361 6d70 6c65 5f32 5f68 6973 7420  , sample_2_hist 
+0000afa0: 2f20 6e70 2e73 756d 2873 616d 706c 655f  / np.sum(sample_
+0000afb0: 325f 6869 7374 290a 2020 2020 2020 2020  2_hist).        
+0000afc0: 7361 6d70 6c65 735f 6469 6666 203d 2073  samples_diff = s
+0000afd0: 616d 706c 655f 325f 6869 7374 202d 2073  ample_2_hist - s
+0000afe0: 616d 706c 655f 315f 6869 7374 0a20 2020  ample_1_hist.   
+0000aff0: 2020 2020 206c 6f67 203d 206e 702e 6c6f       log = np.lo
+0000b000: 6728 7361 6d70 6c65 5f32 5f68 6973 7420  g(sample_2_hist 
+0000b010: 2f20 7361 6d70 6c65 5f31 5f68 6973 7429  / sample_1_hist)
+0000b020: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000b030: 6e70 2e73 756d 2873 616d 706c 6573 5f64  np.sum(samples_d
+0000b040: 6966 6620 2a20 6c6f 6729 0a0a 2020 2020  iff * log)..    
+0000b050: 6465 6620 726f 6c6c 696e 675f 706f 7075  def rolling_popu
+0000b060: 6c61 7469 6f6e 5f73 7461 6269 6c69 7479  lation_stability
+0000b070: 5f69 6e64 6578 280a 2020 2020 2020 2020  _index(.        
+0000b080: 7365 6c66 2c0a 2020 2020 2020 2020 6461  self,.        da
+0000b090: 7461 3a20 6e70 2e6e 6461 7272 6179 2c0a  ta: np.ndarray,.
+0000b0a0: 2020 2020 2020 2020 7469 6d65 5f77 696e          time_win
+0000b0b0: 646f 7773 3a20 6e70 2e6e 6461 7272 6179  dows: np.ndarray
+0000b0c0: 2c0a 2020 2020 2020 2020 6670 733a 2069  ,.        fps: i
+0000b0d0: 6e74 2c0a 2020 2020 2020 2020 6669 6c6c  nt,.        fill
+0000b0e0: 5f76 616c 7565 3a20 696e 7420 3d20 312c  _value: int = 1,
+0000b0f0: 0a20 2020 2020 2020 2062 7563 6b65 745f  .        bucket_
+0000b100: 6d65 7468 6f64 3a20 4c69 7465 7261 6c5b  method: Literal[
+0000b110: 0a20 2020 2020 2020 2020 2020 2022 6664  .            "fd
+0000b120: 222c 2022 646f 616e 6522 2c20 2261 7574  ", "doane", "aut
+0000b130: 6f22 2c20 2273 636f 7474 222c 2022 7374  o", "scott", "st
+0000b140: 6f6e 6522 2c20 2272 6963 6522 2c20 2273  one", "rice", "s
+0000b150: 7475 7267 6573 222c 2022 7371 7274 220a  turges", "sqrt".
+0000b160: 2020 2020 2020 2020 5d20 3d20 2261 7574          ] = "aut
+0000b170: 6f22 2c0a 2020 2020 2920 2d3e 206e 702e  o",.    ) -> np.
+0000b180: 6e64 6172 7261 793a 0a20 2020 2020 2020  ndarray:.       
+0000b190: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
+0000b1a0: 7075 7465 2072 6f6c 6c69 6e67 2050 6f70  pute rolling Pop
+0000b1b0: 756c 6174 696f 6e20 5374 6162 696c 6974  ulation Stabilit
+0000b1c0: 7920 496e 6465 7820 2850 5349 2920 636f  y Index (PSI) co
+0000b1d0: 6d70 6172 696e 6720 7468 6520 6375 7272  mparing the curr
+0000b1e0: 656e 7420 7469 6d65 2d77 696e 646f 7720  ent time-window 
+0000b1f0: 6f66 0a20 2020 2020 2020 2073 697a 6520  of.        size 
+0000b200: 4e20 746f 2074 6865 2070 7265 6365 6469  N to the precedi
+0000b210: 6e67 2077 696e 646f 7720 6f66 2073 697a  ng window of siz
+0000b220: 6520 4e2e 0a0a 2020 2020 2020 2020 2e2e  e N...        ..
+0000b230: 206e 6f74 653a 3a0a 2020 2020 2020 2020   note::.        
+0000b240: 2020 2045 6d70 7479 2062 696e 7320 2830     Empty bins (0
+0000b250: 206f 6273 6572 7661 7469 6f6e 7320 696e   observations in
+0000b260: 2062 696e 2920 696e 2069 7320 7265 706c   bin) in is repl
+0000b270: 6163 6564 2077 6974 6820 6060 6669 6c6c  aced with ``fill
+0000b280: 5f76 616c 7565 6060 2e0a 0a20 2020 2020  _value``...     
+0000b290: 2020 203a 7061 7261 6d65 7465 7220 6e64     :parameter nd
+0000b2a0: 6172 7261 7920 7361 6d70 6c65 5f31 3a20  array sample_1: 
+0000b2b0: 4669 7273 7420 3164 2061 7272 6179 2072  First 1d array r
+0000b2c0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
+0000b2d0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
+0000b2e0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+0000b2f0: 6461 7272 6179 2073 616d 706c 655f 323a  darray sample_2:
+0000b300: 2053 6563 6f6e 6420 3164 2061 7272 6179   Second 1d array
+0000b310: 2072 6570 7265 7365 6e74 696e 6720 6665   representing fe
+0000b320: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
+0000b330: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+0000b340: 2069 6e74 2066 696c 6c5f 7661 6c75 653a   int fill_value:
+0000b350: 2045 6d70 7479 2062 696e 7320 2830 206f   Empty bins (0 o
+0000b360: 6273 6572 7661 7469 6f6e 7320 696e 2062  bservations in b
+0000b370: 696e 2920 696e 2069 7320 7265 706c 6163  in) in is replac
+0000b380: 6564 2077 6974 6820 6060 6669 6c6c 5f76  ed with ``fill_v
+0000b390: 616c 7565 6060 2e0a 2020 2020 2020 2020  alue``..        
+0000b3a0: 3a70 6172 616d 6574 6572 204c 6974 6572  :parameter Liter
+0000b3b0: 616c 2062 7563 6b65 745f 6d65 7468 6f64  al bucket_method
+0000b3c0: 3a20 4573 7469 6d61 746f 7220 6465 7465  : Estimator dete
+0000b3d0: 726d 696e 696e 6720 6f70 7469 6d61 6c20  rmining optimal 
+0000b3e0: 6275 636b 6574 2063 6f75 6e74 2061 6e64  bucket count and
+0000b3f0: 2062 7563 6b65 7420 7769 6474 682e 2044   bucket width. D
+0000b400: 6566 6175 6c74 3a20 5468 6520 6d61 7869  efault: The maxi
+0000b410: 6d75 6d20 6f66 2074 6865 2053 7475 7267  mum of the Sturg
+0000b420: 6573 2061 6e64 2046 7265 6564 6d61 6e2d  es and Freedman-
+0000b430: 4469 6163 6f6e 6973 2065 7374 696d 6174  Diaconis estimat
+0000b440: 6f72 730a 2020 2020 2020 2020 3a72 6574  ors.        :ret
+0000b450: 7572 6e73 206e 702e 6e64 6172 7261 793a  urns np.ndarray:
+0000b460: 2050 5349 2064 6174 6120 6f66 2073 697a   PSI data of siz
+0000b470: 6520 6c65 6e28 6461 7461 2920 7820 6c65  e len(data) x le
+0000b480: 6e28 7469 6d65 5f77 696e 646f 7773 292e  n(time_windows).
+0000b490: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+0000b4a0: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
+0000b4b0: 6e70 2e66 756c 6c28 2864 6174 612e 7368  np.full((data.sh
+0000b4c0: 6170 655b 305d 2c20 7469 6d65 5f77 696e  ape[0], time_win
+0000b4d0: 646f 7773 2e73 6861 7065 5b30 5d29 2c20  dows.shape[0]), 
+0000b4e0: 302e 3029 0a20 2020 2020 2020 2066 6f72  0.0).        for
+0000b4f0: 2069 2069 6e20 7072 616e 6765 2874 696d   i in prange(tim
+0000b500: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
+0000b510: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
+0000b520: 2077 696e 646f 775f 7369 7a65 203d 2069   window_size = i
+0000b530: 6e74 2874 696d 655f 7769 6e64 6f77 735b  nt(time_windows[
+0000b540: 695d 202a 2066 7073 290a 2020 2020 2020  i] * fps).      
+0000b550: 2020 2020 2020 6461 7461 5f73 706c 6974        data_split
+0000b560: 203d 206e 702e 7370 6c69 7428 0a20 2020   = np.split(.   
+0000b570: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+0000b580: 612c 206c 6973 7428 7261 6e67 6528 7769  a, list(range(wi
+0000b590: 6e64 6f77 5f73 697a 652c 2064 6174 612e  ndow_size, data.
+0000b5a0: 7368 6170 655b 305d 2c20 7769 6e64 6f77  shape[0], window
+0000b5b0: 5f73 697a 6529 290a 2020 2020 2020 2020  _size)).        
+0000b5c0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000b5d0: 2020 666f 7220 6a20 696e 2070 7261 6e67    for j in prang
+0000b5e0: 6528 312c 206c 656e 2864 6174 615f 7370  e(1, len(data_sp
+0000b5f0: 6c69 7429 293a 0a20 2020 2020 2020 2020  lit)):.         
+0000b600: 2020 2020 2020 2077 696e 646f 775f 7374         window_st
+0000b610: 6172 7420 3d20 696e 7428 7769 6e64 6f77  art = int(window
+0000b620: 5f73 697a 6520 2a20 6a29 0a20 2020 2020  _size * j).     
+0000b630: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+0000b640: 775f 656e 6420 3d20 696e 7428 7769 6e64  w_end = int(wind
+0000b650: 6f77 5f73 7461 7274 202b 2077 696e 646f  ow_start + windo
+0000b660: 775f 7369 7a65 290a 2020 2020 2020 2020  w_size).        
+0000b670: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
+0000b680: 2c20 7361 6d70 6c65 5f32 203d 2064 6174  , sample_2 = dat
+0000b690: 615f 7370 6c69 745b 6a20 2d20 315d 2e61  a_split[j - 1].a
+0000b6a0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+0000b6b0: 292c 2064 6174 615f 7370 6c69 745b 0a20  ), data_split[. 
+0000b6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6d0: 2020 206a 0a20 2020 2020 2020 2020 2020     j.           
+0000b6e0: 2020 2020 205d 2e61 7374 7970 6528 6e70       ].astype(np
+0000b6f0: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+0000b700: 2020 2020 2020 2020 2020 6269 6e5f 7769            bin_wi
+0000b710: 6474 682c 2062 696e 5f63 6f75 6e74 203d  dth, bin_count =
+0000b720: 2062 7563 6b65 745f 6461 7461 2864 6174   bucket_data(dat
+0000b730: 613d 7361 6d70 6c65 5f31 2c20 6d65 7468  a=sample_1, meth
+0000b740: 6f64 3d62 7563 6b65 745f 6d65 7468 6f64  od=bucket_method
+0000b750: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000b760: 2020 7361 6d70 6c65 5f31 5f68 6973 7420    sample_1_hist 
+0000b770: 3d20 7365 6c66 2e5f 6869 7374 5f31 6428  = self._hist_1d(
+0000b780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b790: 2020 2020 2064 6174 613d 7361 6d70 6c65       data=sample
+0000b7a0: 5f31 2c0a 2020 2020 2020 2020 2020 2020  _1,.            
+0000b7b0: 2020 2020 2020 2020 6269 6e5f 636f 756e          bin_coun
+0000b7c0: 743d 6269 6e5f 636f 756e 742c 0a20 2020  t=bin_count,.   
+0000b7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b7e0: 2072 616e 6765 3d6e 702e 6172 7261 7928   range=np.array(
+0000b7f0: 5b30 2c20 696e 7428 6269 6e5f 7769 6474  [0, int(bin_widt
+0000b800: 6820 2a20 6269 6e5f 636f 756e 7429 5d29  h * bin_count)])
+0000b810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000b820: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000b830: 2020 2020 7361 6d70 6c65 5f32 5f68 6973      sample_2_his
+0000b840: 7420 3d20 7365 6c66 2e5f 6869 7374 5f31  t = self._hist_1
+0000b850: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+0000b860: 2020 2020 2020 2064 6174 613d 7361 6d70         data=samp
+0000b870: 6c65 5f32 2c0a 2020 2020 2020 2020 2020  le_2,.          
+0000b880: 2020 2020 2020 2020 2020 6269 6e5f 636f            bin_co
+0000b890: 756e 743d 6269 6e5f 636f 756e 742c 0a20  unt=bin_count,. 
+0000b8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b8b0: 2020 2072 616e 6765 3d6e 702e 6172 7261     range=np.arra
+0000b8c0: 7928 5b30 2c20 696e 7428 6269 6e5f 7769  y([0, int(bin_wi
+0000b8d0: 6474 6820 2a20 6269 6e5f 636f 756e 7429  dth * bin_count)
+0000b8e0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+0000b8f0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000b900: 2020 2020 2020 7361 6d70 6c65 5f31 5f68        sample_1_h
+0000b910: 6973 745b 7361 6d70 6c65 5f31 5f68 6973  ist[sample_1_his
+0000b920: 7420 3d3d 2030 5d20 3d20 6669 6c6c 5f76  t == 0] = fill_v
+0000b930: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+0000b940: 2020 2020 2073 616d 706c 655f 325f 6869       sample_2_hi
+0000b950: 7374 5b73 616d 706c 655f 325f 6869 7374  st[sample_2_hist
+0000b960: 203d 3d20 305d 203d 2066 696c 6c5f 7661   == 0] = fill_va
+0000b970: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+0000b980: 2020 2020 7361 6d70 6c65 5f31 5f68 6973      sample_1_his
+0000b990: 742c 2073 616d 706c 655f 325f 6869 7374  t, sample_2_hist
+0000b9a0: 203d 2073 616d 706c 655f 315f 6869 7374   = sample_1_hist
+0000b9b0: 202f 206e 702e 7375 6d28 0a20 2020 2020   / np.sum(.     
+0000b9c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000b9d0: 616d 706c 655f 315f 6869 7374 0a20 2020  ample_1_hist.   
+0000b9e0: 2020 2020 2020 2020 2020 2020 2029 2c20               ), 
+0000b9f0: 7361 6d70 6c65 5f32 5f68 6973 7420 2f20  sample_2_hist / 
+0000ba00: 6e70 2e73 756d 2873 616d 706c 655f 325f  np.sum(sample_2_
+0000ba10: 6869 7374 290a 2020 2020 2020 2020 2020  hist).          
+0000ba20: 2020 2020 2020 7361 6d70 6c65 735f 6469        samples_di
+0000ba30: 6666 203d 2073 616d 706c 655f 325f 6869  ff = sample_2_hi
+0000ba40: 7374 202d 2073 616d 706c 655f 315f 6869  st - sample_1_hi
+0000ba50: 7374 0a20 2020 2020 2020 2020 2020 2020  st.             
+0000ba60: 2020 206c 6f67 203d 206e 702e 6c6f 6728     log = np.log(
+0000ba70: 7361 6d70 6c65 5f32 5f68 6973 7420 2f20  sample_2_hist / 
+0000ba80: 7361 6d70 6c65 5f31 5f68 6973 7429 0a20  sample_1_hist). 
+0000ba90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000baa0: 7369 203d 206e 702e 7375 6d28 7361 6d70  si = np.sum(samp
+0000bab0: 6c65 735f 6469 6666 202a 206c 6f67 290a  les_diff * log).
+0000bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bad0: 7265 7375 6c74 735b 7769 6e64 6f77 5f73  results[window_s
+0000bae0: 7461 7274 3a77 696e 646f 775f 656e 642c  tart:window_end,
+0000baf0: 2069 5d20 3d20 7073 690a 0a20 2020 2020   i] = psi..     
+0000bb00: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+0000bb10: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
+0000bb20: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+0000bb30: 2866 6c6f 6174 3634 5b3a 5d2c 2066 6c6f  (float64[:], flo
+0000bb40: 6174 3634 5b3a 5d29 222c 2063 6163 6865  at64[:])", cache
+0000bb50: 3d54 7275 6529 0a20 2020 2064 6566 206b  =True).    def k
+0000bb60: 7275 736b 616c 5f77 616c 6c69 7328 7361  ruskal_wallis(sa
+0000bb70: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
+0000bb80: 6179 2c20 7361 6d70 6c65 5f32 3a20 6e70  ay, sample_2: np
+0000bb90: 2e6e 6461 7272 6179 2920 2d3e 2066 6c6f  .ndarray) -> flo
+0000bba0: 6174 3a0a 2020 2020 2020 2020 2222 220a  at:.        """.
+0000bbb0: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+0000bbc0: 7468 6520 4b72 7573 6b61 6c2d 5761 6c6c  the Kruskal-Wall
+0000bbd0: 6973 2048 2073 7461 7469 7374 6963 2062  is H statistic b
+0000bbe0: 6574 7765 656e 2074 776f 2064 6973 7472  etween two distr
+0000bbf0: 6962 7574 696f 6e73 2e0a 0a20 2020 2020  ibutions...     
+0000bc00: 2020 2054 6865 204b 7275 736b 616c 2d57     The Kruskal-W
+0000bc10: 616c 6c69 7320 7465 7374 2069 7320 6120  allis test is a 
+0000bc20: 6e6f 6e2d 7061 7261 6d65 7472 6963 206d  non-parametric m
+0000bc30: 6574 686f 6420 666f 7220 7465 7374 696e  ethod for testin
+0000bc40: 6720 7768 6574 6865 7220 7361 6d70 6c65  g whether sample
+0000bc50: 7320 6f72 6967 696e 6174 6520 6672 6f6d  s originate from
+0000bc60: 2074 6865 2073 616d 6520 6469 7374 7269   the same distri
+0000bc70: 6275 7469 6f6e 2e0a 2020 2020 2020 2020  bution..        
+0000bc80: 4974 2072 616e 6b73 2061 6c6c 2074 6865  It ranks all the
+0000bc90: 2076 616c 7565 7320 6672 6f6d 2074 6865   values from the
+0000bca0: 2063 6f6d 6269 6e65 6420 7361 6d70 6c65   combined sample
+0000bcb0: 732c 2074 6865 6e20 6361 6c63 756c 6174  s, then calculat
+0000bcc0: 6573 2074 6865 2048 2073 7461 7469 7374  es the H statist
+0000bcd0: 6963 2062 6173 6564 206f 6e20 7468 6520  ic based on the 
+0000bce0: 7261 6e6b 732e 0a0a 0a20 2020 2020 2020  ranks....       
+0000bcf0: 202e 2e20 6d61 7468 3a3a 0a0a 2020 2020   .. math::..    
+0000bd00: 2020 2020 2020 2048 203d 205c 5c66 7261         H = \\fra
+0000bd10: 637b 7b31 327d 7d7b 7b6e 286e 202b 2031  c{{12}}{{n(n + 1
+0000bd20: 297d 7d20 5c5c 6c65 6674 285c 5c66 7261  )}} \\left(\\fra
+0000bd30: 637b 7b28 5c5c 7375 6d20 525f 7b5c 7465  c{{(\\sum R_{\te
+0000bd40: 7874 7b73 616d 706c 6531 7d7d 295e 327d  xt{sample1}})^2}
+0000bd50: 7d7b 7b6e 5f31 7d7d 202b 205c 5c66 7261  }{{n_1}} + \\fra
+0000bd60: 637b 7b28 5c5c 7375 6d20 525f 7b5c 7465  c{{(\\sum R_{\te
+0000bd70: 7874 7b73 616d 706c 6532 7d7d 295e 327d  xt{sample2}})^2}
+0000bd80: 7d7b 7b6e 5f32 7d7d 5c5c 7269 6768 7429  }{{n_2}}\\right)
+0000bd90: 202d 2033 286e 202b 2031 290a 0a20 2020   - 3(n + 1)..   
+0000bda0: 2020 2020 2077 6865 7265 3a0a 2020 2020       where:.    
+0000bdb0: 2020 2020 2020 2020 2d20 5c28 206e 205c          - \( n \
+0000bdc0: 2920 6973 2074 6865 2074 6f74 616c 206e  ) is the total n
+0000bdd0: 756d 6265 7220 6f66 206f 6273 6572 7661  umber of observa
+0000bde0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0000bdf0: 2020 202d 205c 2820 6e5f 3120 5c29 2061     - \( n_1 \) a
+0000be00: 6e64 205c 2820 6e5f 3220 5c29 2061 7265  nd \( n_2 \) are
+0000be10: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
+0000be20: 6273 6572 7661 7469 6f6e 7320 696e 2073  bservations in s
+0000be30: 616d 706c 6520 3120 616e 6420 7361 6d70  ample 1 and samp
+0000be40: 6c65 2032 2072 6573 7065 6374 6976 656c  le 2 respectivel
+0000be50: 792c 0a20 2020 2020 2020 2020 2020 202d  y,.            -
+0000be60: 205c 2820 525f 7b5c 7465 7874 7b73 616d   \( R_{\text{sam
+0000be70: 706c 6531 7d7d 205c 2920 616e 6420 5c28  ple1}} \) and \(
+0000be80: 2052 5f7b 5c74 6578 747b 7361 6d70 6c65   R_{\text{sample
+0000be90: 327d 7d20 5c29 2061 7265 2074 6865 2073  2}} \) are the s
+0000bea0: 756d 7320 6f66 2072 616e 6b73 2066 6f72  ums of ranks for
+0000beb0: 2073 616d 706c 6520 3120 616e 6420 7361   sample 1 and sa
+0000bec0: 6d70 6c65 2032 2072 6573 7065 6374 6976  mple 2 respectiv
+0000bed0: 656c 792e 0a0a 0a20 2020 2020 2020 203a  ely....        :
+0000bee0: 7061 7261 6d65 7465 7220 6e64 6172 7261  parameter ndarra
+0000bef0: 7920 7361 6d70 6c65 5f31 3a20 4669 7273  y sample_1: Firs
+0000bf00: 7420 3164 2061 7272 6179 2072 6570 7265  t 1d array repre
+0000bf10: 7365 6e74 696e 6720 6665 6174 7572 6520  senting feature 
+0000bf20: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
+0000bf30: 3a70 6172 616d 6574 6572 206e 6461 7272  :parameter ndarr
+0000bf40: 6179 2073 616d 706c 655f 323a 2053 6563  ay sample_2: Sec
+0000bf50: 6f6e 6420 3164 2061 7272 6179 2072 6570  ond 1d array rep
+0000bf60: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
+0000bf70: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+0000bf80: 2020 3a72 6574 7572 6e73 2066 6c6f 6174    :returns float
+0000bf90: 3a20 4b72 7573 6b61 6c2d 5761 6c6c 6973  : Kruskal-Wallis
+0000bfa0: 2048 2073 7461 7469 7374 6963 2e0a 0a20   H statistic... 
+0000bfb0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+0000bfc0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+0000bfd0: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
+0000bfe0: 285b 312c 2031 2c20 332c 2034 2c20 355d  ([1, 1, 3, 4, 5]
+0000bff0: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
+0000c000: 7436 3429 0a20 2020 2020 2020 203e 3e3e  t64).        >>>
+0000c010: 2073 616d 706c 655f 3220 3d20 6e70 2e61   sample_2 = np.a
+0000c020: 7272 6179 285b 362c 2037 2c20 382c 2039  rray([6, 7, 8, 9
+0000c030: 2c20 3130 5d29 2e61 7374 7970 6528 6e70  , 10]).astype(np
+0000c040: 2e66 6c6f 6174 3634 290a 2020 2020 2020  .float64).      
+0000c050: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
+0000c060: 2829 2e6b 7275 736b 616c 5f77 616c 6c69  ().kruskal_walli
+0000c070: 7328 7361 6d70 6c65 5f31 3d73 616d 706c  s(sample_1=sampl
+0000c080: 655f 312c 2073 616d 706c 655f 323d 7361  e_1, sample_2=sa
+0000c090: 6d70 6c65 5f32 290a 2020 2020 2020 2020  mple_2).        
+0000c0a0: 3e3e 3e20 3339 2e34 0a20 2020 2020 2020  >>> 39.4.       
+0000c0b0: 2022 2222 0a0a 2020 2020 2020 2020 2320   """..        # 
+0000c0c0: 7361 6d70 6c65 5f31 203d 206e 702e 636f  sample_1 = np.co
+0000c0d0: 6e63 6174 656e 6174 6528 286e 702e 7a65  ncatenate((np.ze
+0000c0e0: 726f 7328 2873 616d 706c 655f 312e 7368  ros((sample_1.sh
+0000c0f0: 6170 655b 305d 2c20 3129 292c 2073 616d  ape[0], 1)), sam
+0000c100: 706c 655f 312e 7265 7368 6170 6528 2d31  ple_1.reshape(-1
+0000c110: 2c20 3129 292c 2061 7869 733d 3129 0a20  , 1)), axis=1). 
+0000c120: 2020 2020 2020 2023 2073 616d 706c 655f         # sample_
+0000c130: 3220 3d20 6e70 2e63 6f6e 6361 7465 6e61  2 = np.concatena
+0000c140: 7465 2828 6e70 2e6f 6e65 7328 2873 616d  te((np.ones((sam
+0000c150: 706c 655f 322e 7368 6170 655b 305d 2c20  ple_2.shape[0], 
+0000c160: 3129 292c 2073 616d 706c 655f 322e 7265  1)), sample_2.re
+0000c170: 7368 6170 6528 2d31 2c20 3129 292c 2061  shape(-1, 1)), a
+0000c180: 7869 733d 3129 0a20 2020 2020 2020 2064  xis=1).        d
+0000c190: 6174 6120 3d20 6e70 2e76 7374 6163 6b28  ata = np.vstack(
+0000c1a0: 2873 616d 706c 655f 312c 2073 616d 706c  (sample_1, sampl
+0000c1b0: 655f 3229 290a 2020 2020 2020 2020 7261  e_2)).        ra
+0000c1c0: 6e6b 7320 3d20 6661 7374 5f6d 6561 6e5f  nks = fast_mean_
+0000c1d0: 7261 6e6b 2864 6174 613d 6461 7461 5b3a  rank(data=data[:
+0000c1e0: 2c20 315d 2c20 6465 7363 656e 6469 6e67  , 1], descending
+0000c1f0: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+0000c200: 6461 7461 203d 206e 702e 6873 7461 636b  data = np.hstack
+0000c210: 2828 6461 7461 2c20 7261 6e6b 732e 7265  ((data, ranks.re
+0000c220: 7368 6170 6528 2d31 2c20 3129 2929 0a20  shape(-1, 1))). 
+0000c230: 2020 2020 2020 2073 616d 706c 655f 315f         sample_1_
+0000c240: 7375 6d6d 6564 5f72 616e 6b20 3d20 6e70  summed_rank = np
+0000c250: 2e73 756d 2864 6174 615b 3020 3a20 7361  .sum(data[0 : sa
+0000c260: 6d70 6c65 5f31 2e73 6861 7065 5b30 5d2c  mple_1.shape[0],
+0000c270: 2032 5d2e 666c 6174 7465 6e28 2929 0a20   2].flatten()). 
+0000c280: 2020 2020 2020 2073 616d 706c 655f 325f         sample_2_
+0000c290: 7375 6d6d 6564 5f72 616e 6b20 3d20 6e70  summed_rank = np
+0000c2a0: 2e73 756d 2864 6174 615b 7361 6d70 6c65  .sum(data[sample
+0000c2b0: 5f31 2e73 6861 7065 5b30 5d20 3a2c 2032  _1.shape[0] :, 2
+0000c2c0: 5d2e 666c 6174 7465 6e28 2929 0a20 2020  ].flatten()).   
+0000c2d0: 2020 2020 2068 3120 3d20 3132 202f 2028       h1 = 12 / (
+0000c2e0: 6461 7461 2e73 6861 7065 5b30 5d20 2a20  data.shape[0] * 
+0000c2f0: 2864 6174 612e 7368 6170 655b 305d 202b  (data.shape[0] +
+0000c300: 2031 2929 0a20 2020 2020 2020 2068 3220   1)).        h2 
+0000c310: 3d20 286e 702e 7371 7561 7265 2873 616d  = (np.square(sam
+0000c320: 706c 655f 315f 7375 6d6d 6564 5f72 616e  ple_1_summed_ran
+0000c330: 6b29 202f 2073 616d 706c 655f 312e 7368  k) / sample_1.sh
+0000c340: 6170 655b 305d 2920 2b20 280a 2020 2020  ape[0]) + (.    
+0000c350: 2020 2020 2020 2020 6e70 2e73 7175 6172          np.squar
+0000c360: 6528 7361 6d70 6c65 5f32 5f73 756d 6d65  e(sample_2_summe
+0000c370: 645f 7261 6e6b 2920 2f20 7361 6d70 6c65  d_rank) / sample
+0000c380: 5f32 2e73 6861 7065 5b30 5d0a 2020 2020  _2.shape[0].    
+0000c390: 2020 2020 290a 2020 2020 2020 2020 6833      ).        h3
+0000c3a0: 203d 2033 202a 2028 6461 7461 2e73 6861   = 3 * (data.sha
+0000c3b0: 7065 5b30 5d20 2b20 3129 0a20 2020 2020  pe[0] + 1).     
+0000c3c0: 2020 2072 6574 7572 6e20 6831 202a 2068     return h1 * h
+0000c3d0: 3220 2d20 6833 0a0a 2020 2020 4073 7461  2 - h3..    @sta
+0000c3e0: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+0000c3f0: 6620 7063 745f 696e 5f74 6f70 5f6e 2878  f pct_in_top_n(x
+0000c400: 3a20 6e70 2e6e 6461 7272 6179 2c20 6e3a  : np.ndarray, n:
+0000c410: 2066 6c6f 6174 2920 2d3e 2066 6c6f 6174   float) -> float
+0000c420: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000c430: 2020 2020 2020 436f 6d70 7574 6520 7468        Compute th
+0000c440: 6520 7065 7263 656e 7461 6765 206f 6620  e percentage of 
+0000c450: 656c 656d 656e 7473 2069 6e20 7468 6520  elements in the 
+0000c460: 746f 7020 276e 2720 6672 6571 7565 6e63  top 'n' frequenc
+0000c470: 6965 7320 696e 2074 6865 2069 6e70 7574  ies in the input
+0000c480: 2061 7272 6179 2e0a 0a20 2020 2020 2020   array...       
+0000c490: 2054 6869 7320 6675 6e63 7469 6f6e 2063   This function c
+0000c4a0: 616c 6375 6c61 7465 7320 7468 6520 7065  alculates the pe
+0000c4b0: 7263 656e 7461 6765 206f 6620 656c 656d  rcentage of elem
+0000c4c0: 656e 7473 2074 6861 7420 6265 6c6f 6e67  ents that belong
+0000c4d0: 2074 6f20 7468 6520 276e 2720 6d6f 7374   to the 'n' most
+0000c4e0: 0a20 2020 2020 2020 2066 7265 7175 656e  .        frequen
+0000c4f0: 7420 6361 7465 676f 7269 6573 2069 6e20  t categories in 
+0000c500: 7468 6520 696e 7075 7420 6172 7261 7920  the input array 
+0000c510: 2778 272e 0a0a 2020 2020 2020 2020 3a70  'x'...        :p
+0000c520: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+0000c530: 783a 2049 6e70 7574 2061 7272 6179 2e0a  x: Input array..
+0000c540: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+0000c550: 6c6f 6174 206e 3a20 4e75 6d62 6572 206f  loat n: Number o
+0000c560: 6620 746f 7020 6672 6571 7565 6e63 6965  f top frequencie
+0000c570: 732e 0a20 2020 2020 2020 203a 7265 7475  s..        :retu
+0000c580: 726e 2066 6c6f 6174 3a20 5065 7263 656e  rn float: Percen
+0000c590: 7461 6765 206f 6620 656c 656d 656e 7473  tage of elements
+0000c5a0: 2069 6e20 7468 6520 746f 7020 276e 2720   in the top 'n' 
+0000c5b0: 6672 6571 7565 6e63 6965 732e 0a0a 2020  frequencies...  
+0000c5c0: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
+0000c5d0: 2020 2020 2020 2020 3e3e 3e20 7820 3d20          >>> x = 
+0000c5e0: 6e70 2e72 616e 646f 6d2e 7261 6e64 696e  np.random.randin
+0000c5f0: 7428 302c 2031 302c 2028 3130 302c 2929  t(0, 10, (100,))
+0000c600: 0a20 2020 2020 2020 203e 3e3e 2053 7461  .        >>> Sta
+0000c610: 7469 7374 6963 732e 7063 745f 696e 5f74  tistics.pct_in_t
+0000c620: 6f70 5f6e 2878 3d78 2c20 6e3d 3529 0a20  op_n(x=x, n=5). 
+0000c630: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000c640: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+0000c650: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+0000c660: 2020 2064 6174 613d 782c 2061 6363 6570     data=x, accep
+0000c670: 7465 645f 6e64 696d 733d 2831 2c29 2c20  ted_ndims=(1,), 
+0000c680: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+0000c690: 732e 7063 745f 696e 5f74 6f70 5f6e 2e5f  s.pct_in_top_n._
+0000c6a0: 5f6e 616d 655f 5f0a 2020 2020 2020 2020  _name__.        
+0000c6b0: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
+0000c6c0: 696e 7428 6e61 6d65 3d53 7461 7469 7374  int(name=Statist
+0000c6d0: 6963 732e 7063 745f 696e 5f74 6f70 5f6e  ics.pct_in_top_n
+0000c6e0: 2e5f 5f6e 616d 655f 5f2c 2076 616c 7565  .__name__, value
+0000c6f0: 3d6e 2c20 6d61 785f 7661 6c75 653d 782e  =n, max_value=x.
+0000c700: 7368 6170 655b 305d 290a 2020 2020 2020  shape[0]).      
+0000c710: 2020 636e 7473 203d 206e 702e 736f 7274    cnts = np.sort
+0000c720: 286e 702e 756e 6971 7565 2878 2c20 7265  (np.unique(x, re
+0000c730: 7475 726e 5f63 6f75 6e74 733d 5472 7565  turn_counts=True
+0000c740: 295b 315d 295b 2d6e 3a5d 0a20 2020 2020  )[1])[-n:].     
+0000c750: 2020 2072 6574 7572 6e20 6e70 2e73 756d     return np.sum
+0000c760: 2863 6e74 7329 202f 2078 2e73 6861 7065  (cnts) / x.shape
+0000c770: 5b30 5d0a 0a20 2020 2040 7374 6174 6963  [0]..    @static
+0000c780: 6d65 7468 6f64 0a20 2020 2040 6e6a 6974  method.    @njit
+0000c790: 2822 2866 6c6f 6174 3634 5b3a 5d2c 2066  ("(float64[:], f
+0000c7a0: 6c6f 6174 3634 5b3a 5d29 222c 2063 6163  loat64[:])", cac
+0000c7b0: 6865 3d54 7275 6529 0a20 2020 2064 6566  he=True).    def
+0000c7c0: 206d 616e 6e5f 7768 6974 6e65 7928 7361   mann_whitney(sa
+0000c7d0: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
+0000c7e0: 6179 2c20 7361 6d70 6c65 5f32 3a20 6e70  ay, sample_2: np
+0000c7f0: 2e6e 6461 7272 6179 2920 2d3e 2066 6c6f  .ndarray) -> flo
+0000c800: 6174 3a0a 2020 2020 2020 2020 2222 220a  at:.        """.
+0000c810: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
+0000c820: 6f6d 7075 7465 206f 6620 4d61 6e6e 2d57  ompute of Mann-W
+0000c830: 6869 746e 6579 2055 2062 6574 7765 656e  hitney U between
+0000c840: 2074 776f 2064 6973 7472 6962 7574 696f   two distributio
+0000c850: 6e73 2e0a 0a20 2020 2020 2020 2054 6865  ns...        The
+0000c860: 204d 616e 6e2d 5768 6974 6e65 7920 5520   Mann-Whitney U 
+0000c870: 7465 7374 2069 7320 7573 6564 2074 6f20  test is used to 
+0000c880: 6173 7365 7373 2077 6865 7468 6572 2074  assess whether t
+0000c890: 6865 2064 6973 7472 6962 7574 696f 6e73  he distributions
+0000c8a0: 206f 6620 7477 6f20 6772 6f75 7073 0a20   of two groups. 
+0000c8b0: 2020 2020 2020 2061 7265 2074 6865 2073         are the s
+0000c8c0: 616d 6520 6f72 2064 6966 6665 7265 6e74  ame or different
+0000c8d0: 2062 6173 6564 206f 6e20 7468 6569 7220   based on their 
+0000c8e0: 7261 6e6b 732e 2049 7420 6973 2063 6f6d  ranks. It is com
+0000c8f0: 6d6f 6e6c 7920 7573 6564 2061 7320 616e  monly used as an
+0000c900: 2061 6c74 6572 6e61 7469 7665 0a20 2020   alternative.   
+0000c910: 2020 2020 2074 6f20 7468 6520 742d 7465       to the t-te
+0000c920: 7374 2077 6865 6e20 7468 6520 6173 7375  st when the assu
+0000c930: 6d70 7469 6f6e 7320 6f66 206e 6f72 6d61  mptions of norma
+0000c940: 6c69 7479 2061 6e64 2065 7175 616c 2076  lity and equal v
+0000c950: 6172 6961 6e63 6573 2061 7265 2076 696f  ariances are vio
+0000c960: 6c61 7465 642e 0a0a 2020 2020 2020 2020  lated...        
+0000c970: 2e2e 206d 6174 683a 3a0a 2020 2020 2020  .. math::.      
+0000c980: 2020 2020 2055 203d 205c 5c6d 696e 2855       U = \\min(U
+0000c990: 5f31 2c20 555f 3229 0a0a 2020 2020 2020  _1, U_2)..      
+0000c9a0: 2020 5768 6572 653a 0a20 2020 2020 2020    Where:.       
+0000c9b0: 2020 2020 2020 202d 2055 2069 7320 7468         - U is th
+0000c9c0: 6520 4d61 6e6e 2d57 6869 746e 6579 2055  e Mann-Whitney U
+0000c9d0: 2073 7461 7469 7374 6963 2c0a 2020 2020   statistic,.    
+0000c9e0: 2020 2020 2020 2020 2020 2d20 555f 3120            - U_1 
+0000c9f0: 6973 2074 6865 2073 756d 206f 6620 7261  is the sum of ra
+0000ca00: 6e6b 7320 666f 7220 7361 6d70 6c65 2031  nks for sample 1
+0000ca10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ca20: 2d20 555f 3220 6973 2074 6865 2073 756d  - U_2 is the sum
+0000ca30: 206f 6620 7261 6e6b 7320 666f 7220 7361   of ranks for sa
+0000ca40: 6d70 6c65 2032 2e0a 0a20 2020 2020 2020  mple 2...       
 0000ca50: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
 0000ca60: 7261 7920 7361 6d70 6c65 5f31 3a20 4669  ray sample_1: Fi
 0000ca70: 7273 7420 3164 2061 7272 6179 2072 6570  rst 1d array rep
 0000ca80: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
 0000ca90: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
 0000caa0: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
 0000cab0: 7272 6179 2073 616d 706c 655f 323a 2053  rray sample_2: S
 0000cac0: 6563 6f6e 6420 3164 2061 7272 6179 2072  econd 1d array r
 0000cad0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
 0000cae0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-0000caf0: 2020 2020 3a72 6574 7572 6e73 206e 702e      :returns np.
-0000cb00: 6e64 6172 7261 793a 204c 6576 656e 6527  ndarray: Levene'
-0000cb10: 7320 5720 6461 7461 206f 6620 7369 7a65  s W data of size
-0000cb20: 206c 656e 2864 6174 6129 2078 206c 656e   len(data) x len
-0000cb30: 2874 696d 655f 7769 6e64 6f77 7329 2e0a  (time_windows)..
-0000cb40: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-0000cb50: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
-0000cb60: 6174 6120 3d20 6e70 2e72 616e 646f 6d2e  ata = np.random.
-0000cb70: 7261 6e64 696e 7428 302c 2035 302c 2028  randint(0, 50, (
-0000cb80: 3130 3029 292e 6173 7479 7065 286e 702e  100)).astype(np.
-0000cb90: 666c 6f61 7436 3429 0a20 2020 2020 2020  float64).       
-0000cba0: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
-0000cbb0: 292e 726f 6c6c 696e 675f 6c65 7665 6e65  ).rolling_levene
-0000cbc0: 7328 6461 7461 3d64 6174 612c 2074 696d  s(data=data, tim
-0000cbd0: 655f 7769 6e64 6f77 733d 6e70 2e61 7272  e_windows=np.arr
-0000cbe0: 6179 285b 315d 292e 6173 7479 7065 286e  ay([1]).astype(n
-0000cbf0: 702e 666c 6f61 7436 3429 2c20 6670 733d  p.float64), fps=
-0000cc00: 352e 3029 0a20 2020 2020 2020 2022 2222  5.0).        """
-0000cc10: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
-0000cc20: 7320 3d20 6e70 2e66 756c 6c28 2864 6174  s = np.full((dat
-0000cc30: 612e 7368 6170 655b 305d 2c20 7469 6d65  a.shape[0], time
-0000cc40: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
-0000cc50: 5d29 2c20 302e 3029 0a20 2020 2020 2020  ]), 0.0).       
-0000cc60: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
-0000cc70: 2874 696d 655f 7769 6e64 6f77 732e 7368  (time_windows.sh
-0000cc80: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
-0000cc90: 2020 2020 2077 696e 646f 775f 7369 7a65       window_size
-0000cca0: 203d 2069 6e74 2874 696d 655f 7769 6e64   = int(time_wind
-0000ccb0: 6f77 735b 695d 202a 2066 7073 290a 2020  ows[i] * fps).  
-0000ccc0: 2020 2020 2020 2020 2020 6461 7461 5f73            data_s
-0000ccd0: 706c 6974 203d 206e 702e 7370 6c69 7428  plit = np.split(
-0000cce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ccf0: 2064 6174 612c 206c 6973 7428 7261 6e67   data, list(rang
-0000cd00: 6528 7769 6e64 6f77 5f73 697a 652c 2064  e(window_size, d
-0000cd10: 6174 612e 7368 6170 655b 305d 2c20 7769  ata.shape[0], wi
-0000cd20: 6e64 6f77 5f73 697a 6529 290a 2020 2020  ndow_size)).    
-0000cd30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000cd40: 2020 2020 2020 666f 7220 6a20 696e 2070        for j in p
-0000cd50: 7261 6e67 6528 312c 206c 656e 2864 6174  range(1, len(dat
-0000cd60: 615f 7370 6c69 7429 293a 0a20 2020 2020  a_split)):.     
-0000cd70: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-0000cd80: 775f 7374 6172 7420 3d20 696e 7428 7769  w_start = int(wi
-0000cd90: 6e64 6f77 5f73 697a 6520 2a20 6a29 0a20  ndow_size * j). 
-0000cda0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000cdb0: 696e 646f 775f 656e 6420 3d20 696e 7428  indow_end = int(
-0000cdc0: 7769 6e64 6f77 5f73 7461 7274 202b 2077  window_start + w
-0000cdd0: 696e 646f 775f 7369 7a65 290a 2020 2020  indow_size).    
-0000cde0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-0000cdf0: 6c65 5f31 2c20 7361 6d70 6c65 5f32 203d  le_1, sample_2 =
-0000ce00: 2064 6174 615f 7370 6c69 745b 6a20 2d20   data_split[j - 
-0000ce10: 315d 2e61 7374 7970 6528 6e70 2e66 6c6f  1].astype(np.flo
-0000ce20: 6174 3332 292c 2064 6174 615f 7370 6c69  at32), data_spli
-0000ce30: 745b 0a20 2020 2020 2020 2020 2020 2020  t[.             
-0000ce40: 2020 2020 2020 206a 0a20 2020 2020 2020         j.       
-0000ce50: 2020 2020 2020 2020 205d 2e61 7374 7970           ].astyp
-0000ce60: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-0000ce70: 2020 2020 2020 2020 2020 2020 2020 4e69                Ni
-0000ce80: 5f78 2c20 4e69 5f79 203d 206c 656e 2873  _x, Ni_y = len(s
-0000ce90: 616d 706c 655f 3129 2c20 6c65 6e28 7361  ample_1), len(sa
-0000cea0: 6d70 6c65 5f32 290a 2020 2020 2020 2020  mple_2).        
-0000ceb0: 2020 2020 2020 2020 5963 695f 782c 2059          Yci_x, Y
-0000cec0: 6369 5f79 203d 206e 702e 6d65 6469 616e  ci_y = np.median
-0000ced0: 2873 616d 706c 655f 3129 2c20 6e70 2e6d  (sample_1), np.m
-0000cee0: 6564 6961 6e28 7361 6d70 6c65 5f32 290a  edian(sample_2).
-0000cef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf00: 4e74 6f74 203d 204e 695f 7820 2b20 4e69  Ntot = Ni_x + Ni
-0000cf10: 5f79 0a20 2020 2020 2020 2020 2020 2020  _y.             
-0000cf20: 2020 205a 696a 5f78 2c20 5a69 6a5f 7920     Zij_x, Zij_y 
-0000cf30: 3d20 6e70 2e61 6273 2873 616d 706c 655f  = np.abs(sample_
-0000cf40: 3120 2d20 5963 695f 7829 2e61 7374 7970  1 - Yci_x).astyp
-0000cf50: 6528 6e70 2e66 6c6f 6174 3332 292c 206e  e(np.float32), n
-0000cf60: 702e 6162 7328 0a20 2020 2020 2020 2020  p.abs(.         
-0000cf70: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-0000cf80: 655f 3220 2d20 5963 695f 790a 2020 2020  e_2 - Yci_y.    
-0000cf90: 2020 2020 2020 2020 2020 2020 292e 6173              ).as
-0000cfa0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-0000cfb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cfc0: 205a 6261 7269 5f78 2c20 5a62 6172 695f   Zbari_x, Zbari_
-0000cfd0: 7920 3d20 6e70 2e6d 6561 6e28 5a69 6a5f  y = np.mean(Zij_
-0000cfe0: 7829 2c20 6e70 2e6d 6561 6e28 5a69 6a5f  x), np.mean(Zij_
-0000cff0: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
-0000d000: 2020 205a 6261 7220 3d20 2828 5a62 6172     Zbar = ((Zbar
-0000d010: 695f 7820 2a20 4e69 5f78 2920 2b20 285a  i_x * Ni_x) + (Z
-0000d020: 6261 7269 5f79 202a 204e 695f 7929 2920  bari_y * Ni_y)) 
-0000d030: 2f20 4e74 6f74 0a20 2020 2020 2020 2020  / Ntot.         
-0000d040: 2020 2020 2020 206e 756d 6572 203d 2028         numer = (
-0000d050: 4e74 6f74 202d 2032 2920 2a20 6e70 2e73  Ntot - 2) * np.s
-0000d060: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
-0000d070: 2020 2020 2020 2020 6e70 2e61 7272 6179          np.array
-0000d080: 285b 4e69 5f78 2c20 4e69 5f79 5d29 202a  ([Ni_x, Ni_y]) *
-0000d090: 2028 6e70 2e61 7272 6179 285b 5a62 6172   (np.array([Zbar
-0000d0a0: 695f 782c 205a 6261 7269 5f79 5d29 202d  i_x, Zbari_y]) -
-0000d0b0: 205a 6261 7229 202a 2a20 320a 2020 2020   Zbar) ** 2.    
-0000d0c0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000d0d0: 2020 2020 2020 2020 2020 2020 2020 6476                dv
-0000d0e0: 6172 203d 206e 702e 7375 6d28 285a 696a  ar = np.sum((Zij
-0000d0f0: 5f78 202d 205a 6261 7269 5f78 2920 2a2a  _x - Zbari_x) **
-0000d100: 2032 2920 2b20 6e70 2e73 756d 2828 5a69   2) + np.sum((Zi
-0000d110: 6a5f 7920 2d20 5a62 6172 695f 7929 202a  j_y - Zbari_y) *
-0000d120: 2a20 3229 0a20 2020 2020 2020 2020 2020  * 2).           
-0000d130: 2020 2020 2064 656e 6f6d 203d 2028 3220       denom = (2 
-0000d140: 2d20 312e 3029 202a 2064 7661 720a 2020  - 1.0) * dvar.  
-0000d150: 2020 2020 2020 2020 2020 2020 2020 7720                w 
-0000d160: 3d20 6e75 6d65 7220 2f20 6465 6e6f 6d0a  = numer / denom.
-0000d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d180: 7265 7375 6c74 735b 7769 6e64 6f77 5f73  results[window_s
-0000d190: 7461 7274 3a77 696e 646f 775f 656e 642c  tart:window_end,
-0000d1a0: 2069 5d20 3d20 770a 2020 2020 2020 2020   i] = w.        
-0000d1b0: 7265 7475 726e 2072 6573 756c 7473 0a0a  return results..
-0000d1c0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0000d1d0: 640a 2020 2020 406a 6974 286e 6f70 7974  d.    @jit(nopyt
-0000d1e0: 686f 6e3d 5472 7565 2c20 6361 6368 653d  hon=True, cache=
-0000d1f0: 5472 7565 290a 2020 2020 6465 6620 6272  True).    def br
-0000d200: 756e 6e65 725f 6d75 6e7a 656c 2873 616d  unner_munzel(sam
-0000d210: 706c 655f 313a 206e 702e 6e64 6172 7261  ple_1: np.ndarra
-0000d220: 792c 2073 616d 706c 655f 323a 206e 702e  y, sample_2: np.
-0000d230: 6e64 6172 7261 7929 202d 3e20 666c 6f61  ndarray) -> floa
-0000d240: 743a 0a20 2020 2020 2020 2022 2222 0a20  t:.        """. 
-0000d250: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
-0000d260: 6d70 7574 6520 6f66 2042 7275 6e6e 6572  mpute of Brunner
-0000d270: 2d4d 756e 7a65 6c20 5720 6265 7477 6565  -Munzel W betwee
-0000d280: 6e20 7477 6f20 6469 7374 7269 6275 7469  n two distributi
-0000d290: 6f6e 732e 0a0a 2020 2020 2020 2020 3a70  ons...        :p
-0000d2a0: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
-0000d2b0: 2073 616d 706c 655f 313a 2046 6972 7374   sample_1: First
-0000d2c0: 2031 6420 6172 7261 7920 7265 7072 6573   1d array repres
-0000d2d0: 656e 7469 6e67 2066 6561 7475 7265 2076  enting feature v
-0000d2e0: 616c 7565 732e 0a20 2020 2020 2020 203a  alues..        :
-0000d2f0: 7061 7261 6d65 7465 7220 6e64 6172 7261  parameter ndarra
-0000d300: 7920 7361 6d70 6c65 5f32 3a20 5365 636f  y sample_2: Seco
-0000d310: 6e64 2031 6420 6172 7261 7920 7265 7072  nd 1d array repr
-0000d320: 6573 656e 7469 6e67 2066 6561 7475 7265  esenting feature
-0000d330: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
-0000d340: 203a 7265 7475 726e 7320 666c 6f61 743a   :returns float:
-0000d350: 2042 7275 6e6e 6572 2d4d 756e 7a65 6c20   Brunner-Munzel 
-0000d360: 572e 0a0a 2020 2020 2020 2020 2e2e 206e  W...        .. n
-0000d370: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
-0000d380: 204d 6f64 6966 6965 6420 6672 6f6d 2060   Modified from `
-0000d390: 6073 6369 7079 2e73 7461 7473 2e62 7275  `scipy.stats.bru
-0000d3a0: 6e6e 6572 6d75 6e7a 656c 6060 2e0a 0a20  nnermunzel``... 
-0000d3b0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-0000d3c0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
-0000d3d0: 706c 655f 312c 2073 616d 706c 655f 3220  ple_1, sample_2 
-0000d3e0: 3d20 6e70 2e72 616e 646f 6d2e 6e6f 726d  = np.random.norm
-0000d3f0: 616c 286c 6f63 3d31 302c 2073 6361 6c65  al(loc=10, scale
-0000d400: 3d32 2c20 7369 7a65 3d31 3029 2c20 6e70  =2, size=10), np
-0000d410: 2e72 616e 646f 6d2e 6e6f 726d 616c 286c  .random.normal(l
-0000d420: 6f63 3d32 302c 2073 6361 6c65 3d32 2c20  oc=20, scale=2, 
-0000d430: 7369 7a65 3d31 3029 0a20 2020 2020 2020  size=10).       
-0000d440: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
-0000d450: 292e 6272 756e 6e65 725f 6d75 6e7a 656c  ).brunner_munzel
-0000d460: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-0000d470: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-0000d480: 706c 655f 3229 0a20 2020 2020 2020 203e  ple_2).        >
-0000d490: 3e3e 2030 2e35 3735 3134 3038 3136 3134  >> 0.57514081614
-0000d4a0: 3337 3136 350a 2020 2020 2020 2020 2222  37165.        ""
-0000d4b0: 220a 2020 2020 2020 2020 6e78 2c20 6e79  ".        nx, ny
-0000d4c0: 203d 206c 656e 2873 616d 706c 655f 3129   = len(sample_1)
-0000d4d0: 2c20 6c65 6e28 7361 6d70 6c65 5f32 290a  , len(sample_2).
-0000d4e0: 2020 2020 2020 2020 7261 6e6b 6320 3d20          rankc = 
-0000d4f0: 6661 7374 5f6d 6561 6e5f 7261 6e6b 286e  fast_mean_rank(n
-0000d500: 702e 636f 6e63 6174 656e 6174 6528 2873  p.concatenate((s
-0000d510: 616d 706c 655f 312c 2073 616d 706c 655f  ample_1, sample_
-0000d520: 3229 2929 0a20 2020 2020 2020 2072 616e  2))).        ran
-0000d530: 6b63 782c 2072 616e 6b63 7920 3d20 7261  kcx, rankcy = ra
-0000d540: 6e6b 635b 303a 6e78 5d2c 2072 616e 6b63  nkc[0:nx], rankc
-0000d550: 5b6e 7820 3a20 6e78 202b 206e 795d 0a20  [nx : nx + ny]. 
-0000d560: 2020 2020 2020 2072 616e 6b63 785f 6d65         rankcx_me
-0000d570: 616e 2c20 7261 6e6b 6379 5f6d 6561 6e20  an, rankcy_mean 
-0000d580: 3d20 6e70 2e6d 6561 6e28 7261 6e6b 6378  = np.mean(rankcx
-0000d590: 292c 206e 702e 6d65 616e 2872 616e 6b63  ), np.mean(rankc
-0000d5a0: 7929 0a20 2020 2020 2020 2072 616e 6b78  y).        rankx
-0000d5b0: 2c20 7261 6e6b 7920 3d20 6661 7374 5f6d  , ranky = fast_m
-0000d5c0: 6561 6e5f 7261 6e6b 2873 616d 706c 655f  ean_rank(sample_
-0000d5d0: 3129 2c20 6661 7374 5f6d 6561 6e5f 7261  1), fast_mean_ra
-0000d5e0: 6e6b 2873 616d 706c 655f 3229 0a20 2020  nk(sample_2).   
-0000d5f0: 2020 2020 2072 616e 6b78 5f6d 6561 6e2c       rankx_mean,
-0000d600: 2072 616e 6b79 5f6d 6561 6e20 3d20 6e70   ranky_mean = np
-0000d610: 2e6d 6561 6e28 7261 6e6b 7829 2c20 6e70  .mean(rankx), np
-0000d620: 2e6d 6561 6e28 7261 6e6b 7929 0a20 2020  .mean(ranky).   
-0000d630: 2020 2020 2053 7820 3d20 6e70 2e73 756d       Sx = np.sum
-0000d640: 286e 702e 706f 7765 7228 7261 6e6b 6378  (np.power(rankcx
-0000d650: 202d 2072 616e 6b78 202d 2072 616e 6b63   - rankx - rankc
-0000d660: 785f 6d65 616e 202b 2072 616e 6b78 5f6d  x_mean + rankx_m
-0000d670: 6561 6e2c 2032 2e30 2929 202f 206e 7820  ean, 2.0)) / nx 
-0000d680: 2d20 310a 2020 2020 2020 2020 5379 203d  - 1.        Sy =
-0000d690: 206e 702e 7375 6d28 6e70 2e70 6f77 6572   np.sum(np.power
-0000d6a0: 2872 616e 6b63 7920 2d20 7261 6e6b 7920  (rankcy - ranky 
-0000d6b0: 2d20 7261 6e6b 6379 5f6d 6561 6e20 2b20  - rankcy_mean + 
-0000d6c0: 7261 6e6b 795f 6d65 616e 2c20 322e 3029  ranky_mean, 2.0)
-0000d6d0: 2920 2f20 6e79 202d 2031 0a20 2020 2020  ) / ny - 1.     
-0000d6e0: 2020 2077 6266 6e20 3d20 6e78 202a 206e     wbfn = nx * n
-0000d6f0: 7920 2a20 2872 616e 6b63 795f 6d65 616e  y * (rankcy_mean
-0000d700: 202d 2072 616e 6b63 785f 6d65 616e 290a   - rankcx_mean).
-0000d710: 2020 2020 2020 2020 7762 666e 202f 3d20          wbfn /= 
-0000d720: 286e 7820 2b20 6e79 2920 2a20 6e70 2e73  (nx + ny) * np.s
-0000d730: 7172 7428 6e78 202a 2053 7820 2b20 6e79  qrt(nx * Sx + ny
-0000d740: 202a 2053 7929 0a20 2020 2020 2020 2072   * Sy).        r
-0000d750: 6574 7572 6e20 2d77 6266 6e0a 0a20 2020  eturn -wbfn..   
-0000d760: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-0000d770: 2020 2040 6e6a 6974 2822 2866 6c6f 6174     @njit("(float
-0000d780: 3332 5b3a 5d2c 2066 6c6f 6174 3634 5b3a  32[:], float64[:
-0000d790: 5d2c 2066 6c6f 6174 3634 2922 2c20 6361  ], float64)", ca
-0000d7a0: 6368 653d 5472 7565 290a 2020 2020 6465  che=True).    de
-0000d7b0: 6620 726f 6c6c 696e 675f 6261 726c 6574  f rolling_barlet
-0000d7c0: 7473 5f74 6573 7428 0a20 2020 2020 2020  ts_test(.       
-0000d7d0: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
-0000d7e0: 792c 2074 696d 655f 7769 6e64 6f77 733a  y, time_windows:
-0000d7f0: 206e 702e 6e64 6172 7261 792c 2066 7073   np.ndarray, fps
-0000d800: 3a20 666c 6f61 740a 2020 2020 2920 2d3e  : float.    ) ->
-0000d810: 2066 6c6f 6174 3a0a 0a20 2020 2020 2020   float:..       
-0000d820: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
-0000d830: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
-0000d840: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-0000d850: 7368 6170 655b 305d 292c 2030 2e30 290a  shape[0]), 0.0).
-0000d860: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0000d870: 2070 7261 6e67 6528 7469 6d65 5f77 696e   prange(time_win
-0000d880: 646f 7773 2e73 6861 7065 5b30 5d29 3a0a  dows.shape[0]):.
-0000d890: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-0000d8a0: 6f77 5f73 697a 6520 3d20 696e 7428 7469  ow_size = int(ti
-0000d8b0: 6d65 5f77 696e 646f 7773 5b69 5d20 2a20  me_windows[i] * 
-0000d8c0: 6670 7329 0a20 2020 2020 2020 2020 2020  fps).           
-0000d8d0: 2064 6174 615f 7370 6c69 7420 3d20 6e70   data_split = np
-0000d8e0: 2e73 706c 6974 280a 2020 2020 2020 2020  .split(.        
-0000d8f0: 2020 2020 2020 2020 6461 7461 2c20 6c69          data, li
-0000d900: 7374 2872 616e 6765 2877 696e 646f 775f  st(range(window_
-0000d910: 7369 7a65 2c20 6461 7461 2e73 6861 7065  size, data.shape
-0000d920: 5b30 5d2c 2077 696e 646f 775f 7369 7a65  [0], window_size
-0000d930: 2929 0a20 2020 2020 2020 2020 2020 2029  )).            )
-0000d940: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0000d950: 206a 2069 6e20 7072 616e 6765 2831 2c20   j in prange(1, 
-0000d960: 6c65 6e28 6461 7461 5f73 706c 6974 2929  len(data_split))
-0000d970: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000d980: 2020 7769 6e64 6f77 5f73 7461 7274 203d    window_start =
-0000d990: 2069 6e74 2877 696e 646f 775f 7369 7a65   int(window_size
-0000d9a0: 202a 206a 290a 2020 2020 2020 2020 2020   * j).          
-0000d9b0: 2020 2020 2020 7769 6e64 6f77 5f65 6e64        window_end
-0000d9c0: 203d 2069 6e74 2877 696e 646f 775f 7374   = int(window_st
-0000d9d0: 6172 7420 2b20 7769 6e64 6f77 5f73 697a  art + window_siz
-0000d9e0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0000d9f0: 2020 2073 616d 706c 655f 312c 2073 616d     sample_1, sam
-0000da00: 706c 655f 3220 3d20 6461 7461 5f73 706c  ple_2 = data_spl
-0000da10: 6974 5b6a 202d 2031 5d2e 6173 7479 7065  it[j - 1].astype
-0000da20: 286e 702e 666c 6f61 7433 3229 2c20 6461  (np.float32), da
-0000da30: 7461 5f73 706c 6974 5b0a 2020 2020 2020  ta_split[.      
-0000da40: 2020 2020 2020 2020 2020 2020 2020 6a0a                j.
-0000da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da60: 5d2e 6173 7479 7065 286e 702e 666c 6f61  ].astype(np.floa
-0000da70: 7433 3229 0a20 2020 2020 2020 2020 2020  t32).           
-0000da80: 2020 2020 206e 5f31 203d 206c 656e 2873       n_1 = len(s
-0000da90: 616d 706c 655f 3129 0a20 2020 2020 2020  ample_1).       
-0000daa0: 2020 2020 2020 2020 206e 5f32 203d 206c           n_2 = l
-0000dab0: 656e 2873 616d 706c 655f 3229 0a20 2020  en(sample_2).   
-0000dac0: 2020 2020 2020 2020 2020 2020 204e 203d               N =
-0000dad0: 206e 5f31 202b 206e 5f32 0a20 2020 2020   n_1 + n_2.     
-0000dae0: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
-0000daf0: 7661 7269 616e 6365 5f31 203d 206e 702e  variance_1 = np.
-0000db00: 7375 6d28 2873 616d 706c 655f 3120 2d20  sum((sample_1 - 
-0000db10: 6e70 2e6d 6561 6e28 7361 6d70 6c65 5f31  np.mean(sample_1
-0000db20: 2929 202a 2a20 3229 202f 2028 0a20 2020  )) ** 2) / (.   
-0000db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db40: 206e 5f31 202d 2031 0a20 2020 2020 2020   n_1 - 1.       
-0000db50: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000db60: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
-0000db70: 7661 7269 616e 6365 5f32 203d 206e 702e  variance_2 = np.
-0000db80: 7375 6d28 2873 616d 706c 655f 3220 2d20  sum((sample_2 - 
-0000db90: 6e70 2e6d 6561 6e28 7361 6d70 6c65 5f32  np.mean(sample_2
-0000dba0: 2929 202a 2a20 3229 202f 2028 0a20 2020  )) ** 2) / (.   
-0000dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dbc0: 206e 5f32 202d 2031 0a20 2020 2020 2020   n_2 - 1.       
-0000dbd0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000dbe0: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-0000dbf0: 6174 6f72 203d 2028 4e20 2d20 3229 202a  ator = (N - 2) *
-0000dc00: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0000dc10: 2020 2020 2020 206e 702e 6c6f 6728 6d65         np.log(me
-0000dc20: 616e 5f76 6172 6961 6e63 655f 3129 202b  an_variance_1) +
-0000dc30: 206e 702e 6c6f 6728 6d65 616e 5f76 6172   np.log(mean_var
-0000dc40: 6961 6e63 655f 3229 0a20 2020 2020 2020  iance_2).       
-0000dc50: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000dc60: 2020 2020 2020 2020 2020 2064 656e 6f6d             denom
-0000dc70: 696e 6174 6f72 203d 2031 202f 2028 6e5f  inator = 1 / (n_
-0000dc80: 3120 2d20 3129 202b 2031 202f 2028 6e5f  1 - 1) + 1 / (n_
-0000dc90: 3220 2d20 3129 0a20 2020 2020 2020 2020  2 - 1).         
-0000dca0: 2020 2020 2020 2075 203d 206e 756d 6572         u = numer
-0000dcb0: 6174 6f72 202f 2064 656e 6f6d 696e 6174  ator / denominat
-0000dcc0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-0000dcd0: 2020 2072 6573 756c 7473 5b77 696e 646f     results[windo
-0000dce0: 775f 7374 6172 743a 7769 6e64 6f77 5f65  w_start:window_e
-0000dcf0: 6e64 2c20 695d 203d 2075 0a0a 2020 2020  nd, i] = u..    
-0000dd00: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-0000dd10: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-0000dd20: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-0000dd30: 2228 666c 6f61 7433 325b 3a5d 2c20 666c  "(float32[:], fl
-0000dd40: 6f61 7433 325b 3a5d 2922 290a 2020 2020  oat32[:])").    
-0000dd50: 6465 6620 7065 6172 736f 6e73 5f72 2873  def pearsons_r(s
-0000dd60: 616d 706c 655f 313a 206e 702e 6e64 6172  ample_1: np.ndar
-0000dd70: 7261 792c 2073 616d 706c 655f 323a 206e  ray, sample_2: n
-0000dd80: 702e 6e64 6172 7261 7929 202d 3e20 666c  p.ndarray) -> fl
-0000dd90: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
-0000dda0: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-0000ddb0: 7465 2074 6865 2050 6561 7273 6f6e 2063  te the Pearson c
-0000ddc0: 6f72 7265 6c61 7469 6f6e 2063 6f65 6666  orrelation coeff
-0000ddd0: 6963 6965 6e74 2028 5065 6172 736f 6e27  icient (Pearson'
-0000dde0: 7320 7229 2062 6574 7765 656e 2074 776f  s r) between two
-0000ddf0: 206e 756d 6572 6963 2073 616d 706c 6573   numeric samples
-0000de00: 2e0a 0a20 2020 2020 2020 2050 6561 7273  ...        Pears
-0000de10: 6f6e 2773 2072 2069 7320 6120 6d65 6173  on's r is a meas
-0000de20: 7572 6520 6f66 2074 6865 206c 696e 6561  ure of the linea
-0000de30: 7220 636f 7272 656c 6174 696f 6e20 6265  r correlation be
-0000de40: 7477 6565 6e20 7477 6f20 7365 7473 206f  tween two sets o
-0000de50: 6620 6461 7461 2070 6f69 6e74 732e 2049  f data points. I
-0000de60: 7420 7175 616e 7469 6669 6573 2074 6865  t quantifies the
-0000de70: 2073 7472 656e 6774 6820 616e 640a 2020   strength and.  
-0000de80: 2020 2020 2020 6469 7265 6374 696f 6e20        direction 
-0000de90: 6f66 2074 6865 206c 696e 6561 7220 7265  of the linear re
-0000dea0: 6c61 7469 6f6e 7368 6970 2062 6574 7765  lationship betwe
-0000deb0: 656e 2074 6865 2074 776f 2076 6172 6961  en the two varia
-0000dec0: 626c 6573 2e20 5468 6520 636f 6566 6669  bles. The coeffi
-0000ded0: 6369 656e 7420 7661 7269 6573 2062 6574  cient varies bet
-0000dee0: 7765 656e 202d 3120 616e 6420 312c 2077  ween -1 and 1, w
-0000def0: 6974 680a 2020 2020 2020 2020 2d31 2069  ith.        -1 i
-0000df00: 6e64 6963 6174 696e 6720 6120 7065 7266  ndicating a perf
-0000df10: 6563 7420 6e65 6761 7469 7665 206c 696e  ect negative lin
-0000df20: 6561 7220 7265 6c61 7469 6f6e 7368 6970  ear relationship
-0000df30: 2c20 3120 696e 6469 6361 7469 6e67 2061  , 1 indicating a
-0000df40: 2070 6572 6665 6374 2070 6f73 6974 6976   perfect positiv
-0000df50: 6520 6c69 6e65 6172 2072 656c 6174 696f  e linear relatio
-0000df60: 6e73 6869 702c 2061 6e64 2030 0a20 2020  nship, and 0.   
-0000df70: 2020 2020 2069 6e64 6963 6174 696e 6720       indicating 
-0000df80: 6e6f 206c 696e 6561 7220 7265 6c61 7469  no linear relati
-0000df90: 6f6e 7368 6970 2e0a 0a20 2020 2020 2020  onship...       
-0000dfa0: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
-0000dfb0: 2020 203e 3e3e 2073 616d 706c 655f 3120     >>> sample_1 
-0000dfc0: 3d20 6e70 2e61 7272 6179 285b 372c 2032  = np.array([7, 2
-0000dfd0: 2c20 392c 2034 2c20 352c 2036 2c20 372c  , 9, 4, 5, 6, 7,
-0000dfe0: 2038 2c20 395d 292e 6173 7479 7065 286e   8, 9]).astype(n
-0000dff0: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-0000e000: 2020 203e 3e3e 2073 616d 706c 655f 3220     >>> sample_2 
-0000e010: 3d20 6e70 2e61 7272 6179 285b 312e 352c  = np.array([1.5,
-0000e020: 2032 2e35 2c20 332e 352c 2034 2e35 2c20   2.5, 3.5, 4.5, 
-0000e030: 352e 352c 2036 2e35 2c20 372e 352c 2038  5.5, 6.5, 7.5, 8
-0000e040: 2e35 2c20 392e 355d 292e 6173 7479 7065  .5, 9.5]).astype
-0000e050: 286e 702e 666c 6f61 7433 3229 0a20 2020  (np.float32).   
-0000e060: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-0000e070: 6963 7328 292e 7065 6172 736f 6e73 5f72  ics().pearsons_r
-0000e080: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-0000e090: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-0000e0a0: 706c 655f 3229 0a20 2020 2020 2020 203e  ple_2).        >
-0000e0b0: 3e3e 2030 2e34 370a 2020 2020 2020 2020  >> 0.47.        
-0000e0c0: 2222 220a 0a20 2020 2020 2020 206d 312c  """..        m1,
-0000e0d0: 206d 3220 3d20 6e70 2e6d 6561 6e28 7361   m2 = np.mean(sa
-0000e0e0: 6d70 6c65 5f31 292c 206e 702e 6d65 616e  mple_1), np.mean
-0000e0f0: 2873 616d 706c 655f 3229 0a20 2020 2020  (sample_2).     
-0000e100: 2020 206e 756d 6572 6174 6f72 203d 206e     numerator = n
-0000e110: 702e 7375 6d28 2873 616d 706c 655f 3120  p.sum((sample_1 
-0000e120: 2d20 6d31 2920 2a20 2873 616d 706c 655f  - m1) * (sample_
-0000e130: 3220 2d20 6d32 2929 0a20 2020 2020 2020  2 - m2)).       
-0000e140: 2064 656e 6f6d 696e 6174 6f72 203d 206e   denominator = n
-0000e150: 702e 7371 7274 280a 2020 2020 2020 2020  p.sqrt(.        
-0000e160: 2020 2020 6e70 2e73 756d 2828 7361 6d70      np.sum((samp
-0000e170: 6c65 5f31 202d 206d 3129 202a 2a20 3229  le_1 - m1) ** 2)
-0000e180: 202a 206e 702e 7375 6d28 2873 616d 706c   * np.sum((sampl
-0000e190: 655f 3220 2d20 6d32 2920 2a2a 2032 290a  e_2 - m2) ** 2).
-0000e1a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000e1b0: 2020 7220 3d20 6e75 6d65 7261 746f 7220    r = numerator 
-0000e1c0: 2f20 6465 6e6f 6d69 6e61 746f 720a 2020  / denominator.  
-0000e1d0: 2020 2020 2020 7265 7475 726e 2072 0a0a        return r..
-0000e1e0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0000e1f0: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
-0000e200: 6f61 7433 325b 3a5d 2c20 666c 6f61 7433  oat32[:], float3
-0000e210: 325b 3a5d 2922 290a 2020 2020 6465 6620  2[:])").    def 
-0000e220: 7370 6561 726d 616e 5f72 616e 6b5f 636f  spearman_rank_co
-0000e230: 7272 656c 6174 696f 6e28 7361 6d70 6c65  rrelation(sample
-0000e240: 5f31 3a20 6e70 2e6e 6461 7272 6179 2c20  _1: np.ndarray, 
-0000e250: 7361 6d70 6c65 5f32 3a20 6e70 2e6e 6461  sample_2: np.nda
-0000e260: 7272 6179 2920 2d3e 2066 6c6f 6174 3a0a  rray) -> float:.
-0000e270: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000e280: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-0000e290: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-0000e2a0: 5f31 203d 206e 702e 6172 7261 7928 5b37  _1 = np.array([7
-0000e2b0: 2c20 322c 2039 2c20 342c 2035 2c20 362c  , 2, 9, 4, 5, 6,
-0000e2c0: 2037 2c20 382c 2039 5d29 2e61 7374 7970   7, 8, 9]).astyp
-0000e2d0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-0000e2e0: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-0000e2f0: 5f32 203d 206e 702e 6172 7261 7928 5b31  _2 = np.array([1
-0000e300: 2e35 2c20 322e 352c 2033 2e35 2c20 342e  .5, 2.5, 3.5, 4.
-0000e310: 352c 2035 2e35 2c20 362e 352c 2037 2e35  5, 5.5, 6.5, 7.5
-0000e320: 2c20 382e 352c 2039 2e35 5d29 2e61 7374  , 8.5, 9.5]).ast
-0000e330: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-0000e340: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
-0000e350: 6973 7469 6373 2829 2e73 7065 6172 6d61  istics().spearma
-0000e360: 6e5f 7261 6e6b 5f63 6f72 7265 6c61 7469  n_rank_correlati
-0000e370: 6f6e 2873 616d 706c 655f 313d 7361 6d70  on(sample_1=samp
-0000e380: 6c65 5f31 2c20 7361 6d70 6c65 5f32 3d73  le_1, sample_2=s
-0000e390: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
-0000e3a0: 203e 3e3e 2030 2e30 3030 3339 3739 3230   >>> 0.000397920
-0000e3b0: 3630 3835 3230 3530 3738 0a20 2020 2020  6085205078.     
-0000e3c0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-0000e3d0: 7261 6e6b 5f78 2c20 7261 6e6b 5f79 203d  rank_x, rank_y =
-0000e3e0: 206e 702e 6172 6773 6f72 7428 6e70 2e61   np.argsort(np.a
-0000e3f0: 7267 736f 7274 2873 616d 706c 655f 3129  rgsort(sample_1)
-0000e400: 292c 206e 702e 6172 6773 6f72 7428 0a20  ), np.argsort(. 
-0000e410: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-0000e420: 6773 6f72 7428 7361 6d70 6c65 5f32 290a  gsort(sample_2).
-0000e430: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000e440: 2020 645f 7371 7561 7265 6420 3d20 6e70    d_squared = np
-0000e450: 2e73 756d 2828 7261 6e6b 5f78 202d 2072  .sum((rank_x - r
-0000e460: 616e 6b5f 7929 202a 2a20 3229 0a20 2020  ank_y) ** 2).   
-0000e470: 2020 2020 2072 6574 7572 6e20 3120 2d20       return 1 - 
-0000e480: 2836 202a 2064 5f73 7175 6172 6564 2920  (6 * d_squared) 
-0000e490: 2f20 286c 656e 2873 616d 706c 655f 3129  / (len(sample_1)
-0000e4a0: 202a 2028 6c65 6e28 7361 6d70 6c65 5f32   * (len(sample_2
-0000e4b0: 2920 2a2a 2032 202d 2031 2929 0a0a 2020  ) ** 2 - 1))..  
-0000e4c0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-0000e4d0: 2020 2020 406e 6a69 7428 2228 666c 6f61      @njit("(floa
-0000e4e0: 7433 325b 3a5d 2c20 666c 6f61 7433 325b  t32[:], float32[
-0000e4f0: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
-0000e500: 696e 7436 3429 2229 0a20 2020 2064 6566  int64)").    def
-0000e510: 2073 6c69 6469 6e67 5f70 6561 7273 6f6e   sliding_pearson
-0000e520: 735f 7228 0a20 2020 2020 2020 2073 616d  s_r(.        sam
-0000e530: 706c 655f 313a 206e 702e 6e64 6172 7261  ple_1: np.ndarra
-0000e540: 792c 2073 616d 706c 655f 323a 206e 702e  y, sample_2: np.
-0000e550: 6e64 6172 7261 792c 2074 696d 655f 7769  ndarray, time_wi
-0000e560: 6e64 6f77 733a 206e 702e 6e64 6172 7261  ndows: np.ndarra
-0000e570: 792c 2066 7073 3a20 696e 740a 2020 2020  y, fps: int.    
-0000e580: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
-0000e590: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000e5a0: 2020 2020 2047 6976 656e 2074 776f 2031       Given two 1
-0000e5b0: 4420 6172 7261 7973 206f 6620 7369 7a65  D arrays of size
-0000e5c0: 204e 2c20 6372 6561 7465 2073 6c69 6469   N, create slidi
-0000e5d0: 6e67 2077 696e 646f 7720 6f66 2073 697a  ng window of siz
-0000e5e0: 6520 7469 6d65 5f77 696e 646f 7773 5b69  e time_windows[i
-0000e5f0: 5d20 2a20 6670 7320 616e 6420 7265 7475  ] * fps and retu
-0000e600: 726e 2050 6561 7273 6f6e 2773 2052 0a20  rn Pearson's R. 
-0000e610: 2020 2020 2020 2062 6574 7765 656e 2074         between t
-0000e620: 6865 2076 616c 7565 7320 696e 2074 6865  he values in the
-0000e630: 2074 776f 2031 4420 6172 7261 7973 2069   two 1D arrays i
-0000e640: 6e20 6561 6368 2077 696e 646f 772e 2041  n each window. A
-0000e650: 6464 7265 7373 2022 7768 6174 2069 7320  ddress "what is 
-0000e660: 7468 6520 636f 7272 656c 6174 696f 6e20  the correlation 
-0000e670: 6265 7477 6565 6e20 4665 6174 7572 6520  between Feature 
-0000e680: 3120 616e 640a 2020 2020 2020 2020 4665  1 and.        Fe
-0000e690: 6174 7572 6520 3220 696e 2074 6865 2063  ature 2 in the c
-0000e6a0: 7572 7265 6e74 2058 2e58 2073 6563 6f6e  urrent X.X secon
-0000e6b0: 6473 206f 6620 7468 6520 7669 6465 6f22  ds of the video"
-0000e6c0: 2e0a 0a20 2020 2020 2020 202e 2e20 696d  ...        .. im
-0000e6d0: 6167 653a 3a20 5f73 7461 7469 632f 696d  age:: _static/im
-0000e6e0: 672f 736c 6964 696e 675f 7065 6172 736f  g/sliding_pearso
-0000e6f0: 6e73 2e70 6e67 0a20 2020 2020 2020 2020  ns.png.         
-0000e700: 2020 3a77 6964 7468 3a20 3630 300a 2020    :width: 600.  
-0000e710: 2020 2020 2020 2020 203a 616c 6967 6e3a           :align:
-0000e720: 2063 656e 7465 720a 0a20 2020 2020 2020   center..       
-0000e730: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
-0000e740: 7261 7920 7361 6d70 6c65 5f31 3a20 4669  ray sample_1: Fi
-0000e750: 7273 7420 3144 2061 7272 6179 2077 6974  rst 1D array wit
-0000e760: 6820 6665 6174 7572 6520 7661 6c75 6573  h feature values
-0000e770: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000e780: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
-0000e790: 706c 655f 313a 2053 6563 6f6e 6420 3144  ple_1: Second 1D
-0000e7a0: 2061 7272 6179 2077 6974 6820 6665 6174   array with feat
-0000e7b0: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-0000e7c0: 2020 2020 3a70 6172 616d 6574 6572 2066      :parameter f
-0000e7d0: 6c6f 6174 2074 696d 655f 7769 6e64 6f77  loat time_window
-0000e7e0: 733a 2054 6865 206c 656e 6774 6820 6f66  s: The length of
-0000e7f0: 2074 6865 2073 6c69 6469 6e67 2077 696e   the sliding win
-0000e800: 646f 7720 696e 2073 6563 6f6e 6473 2e0a  dow in seconds..
-0000e810: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-0000e820: 6572 2069 6e74 2066 7073 3a20 5468 6520  er int fps: The 
-0000e830: 6670 7320 6f66 2074 6865 2072 6563 6f72  fps of the recor
-0000e840: 6465 6420 7669 6465 6f2e 0a20 2020 2020  ded video..     
-0000e850: 2020 203a 7265 7475 726e 7320 6e70 2e6e     :returns np.n
-0000e860: 6461 7272 6179 3a20 3264 2061 7272 6179  darray: 2d array
-0000e870: 206f 6620 5065 6172 736f 6e73 2052 206f   of Pearsons R o
-0000e880: 6620 7369 7a65 206c 656e 2873 616d 706c  f size len(sampl
-0000e890: 655f 3129 2078 206c 656e 2874 696d 655f  e_1) x len(time_
-0000e8a0: 7769 6e64 6f77 7329 2e20 4e6f 7465 2c20  windows). Note, 
-0000e8b0: 6966 2073 6c69 6469 6e67 2077 696e 646f  if sliding windo
-0000e8c0: 7720 6973 2031 3020 6672 616d 6573 2c20  w is 10 frames, 
-0000e8d0: 7468 6520 6669 7273 7420 3920 656e 7472  the first 9 entr
-0000e8e0: 6965 7320 7769 6c6c 2062 6520 6669 6c6c  ies will be fill
-0000e8f0: 6564 2077 6974 6820 302e 0a0a 2020 2020  ed with 0...    
-0000e900: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-0000e910: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-0000e920: 5f31 203d 206e 702e 7261 6e64 6f6d 2e72  _1 = np.random.r
-0000e930: 616e 6469 6e74 2830 2c20 3530 2c20 2831  andint(0, 50, (1
-0000e940: 3029 292e 6173 7479 7065 286e 702e 666c  0)).astype(np.fl
-0000e950: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
-0000e960: 3e3e 2073 616d 706c 655f 3220 3d20 6e70  >> sample_2 = np
-0000e970: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-0000e980: 302c 2035 302c 2028 3130 2929 2e61 7374  0, 50, (10)).ast
-0000e990: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-0000e9a0: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
-0000e9b0: 6973 7469 6373 2829 2e73 6c69 6469 6e67  istics().sliding
-0000e9c0: 5f70 6561 7273 6f6e 735f 7228 7361 6d70  _pearsons_r(samp
-0000e9d0: 6c65 5f31 3d73 616d 706c 655f 312c 2073  le_1=sample_1, s
-0000e9e0: 616d 706c 655f 323d 7361 6d70 6c65 5f32  ample_2=sample_2
-0000e9f0: 2c20 7469 6d65 5f77 696e 646f 7773 3d6e  , time_windows=n
-0000ea00: 702e 6172 7261 7928 5b30 2e35 5d29 2c20  p.array([0.5]), 
-0000ea10: 6670 733d 3130 290a 2020 2020 2020 2020  fps=10).        
-0000ea20: 3e3e 3e20 5b5b 2d31 2e5d 5b2d 312e 5d5b  >>> [[-1.][-1.][
-0000ea30: 2d31 2e5d 5b2d 312e 5d5b 302e 3232 375d  -1.][-1.][0.227]
-0000ea40: 5b2d 302e 3331 395d 5b2d 302e 3139 365d  [-0.319][-0.196]
-0000ea50: 5b30 2e34 3734 5d5b 2d30 2e30 3631 5d5b  [0.474][-0.061][
-0000ea60: 302e 3731 335d 5d0a 2020 2020 2020 2020  0.713]].        
-0000ea70: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
-0000ea80: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
-0000ea90: 7361 6d70 6c65 5f31 2e73 6861 7065 5b30  sample_1.shape[0
-0000eaa0: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-0000eab0: 7368 6170 655b 305d 292c 2030 2e30 290a  shape[0]), 0.0).
-0000eac0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0000ead0: 2070 7261 6e67 6528 7469 6d65 5f77 696e   prange(time_win
-0000eae0: 646f 7773 2e73 6861 7065 5b30 5d29 3a0a  dows.shape[0]):.
-0000eaf0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
-0000eb00: 6f77 5f73 697a 6520 3d20 696e 7428 7469  ow_size = int(ti
-0000eb10: 6d65 5f77 696e 646f 7773 5b69 5d20 2a20  me_windows[i] * 
-0000eb20: 6670 7329 0a20 2020 2020 2020 2020 2020  fps).           
-0000eb30: 2066 6f72 206c 6566 742c 2072 6967 6874   for left, right
-0000eb40: 2069 6e20 7a69 7028 0a20 2020 2020 2020   in zip(.       
-0000eb50: 2020 2020 2020 2020 2070 7261 6e67 6528           prange(
-0000eb60: 302c 2073 616d 706c 655f 312e 7368 6170  0, sample_1.shap
-0000eb70: 655b 305d 202b 2031 292c 0a20 2020 2020  e[0] + 1),.     
-0000eb80: 2020 2020 2020 2020 2020 2070 7261 6e67             prang
-0000eb90: 6528 7769 6e64 6f77 5f73 697a 652c 2073  e(window_size, s
-0000eba0: 616d 706c 655f 312e 7368 6170 655b 305d  ample_1.shape[0]
-0000ebb0: 202b 2031 292c 0a20 2020 2020 2020 2020   + 1),.         
-0000ebc0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-0000ebd0: 2020 2020 2020 7331 2c20 7332 203d 2073        s1, s2 = s
-0000ebe0: 616d 706c 655f 315b 6c65 6674 3a72 6967  ample_1[left:rig
-0000ebf0: 6874 5d2c 2073 616d 706c 655f 325b 6c65  ht], sample_2[le
-0000ec00: 6674 3a72 6967 6874 5d0a 2020 2020 2020  ft:right].      
-0000ec10: 2020 2020 2020 2020 2020 6d31 2c20 6d32            m1, m2
-0000ec20: 203d 206e 702e 6d65 616e 2873 3129 2c20   = np.mean(s1), 
-0000ec30: 6e70 2e6d 6561 6e28 7332 290a 2020 2020  np.mean(s2).    
-0000ec40: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
-0000ec50: 7261 746f 7220 3d20 6e70 2e73 756d 2828  rator = np.sum((
-0000ec60: 7331 202d 206d 3129 202a 2028 7332 202d  s1 - m1) * (s2 -
-0000ec70: 206d 3229 290a 2020 2020 2020 2020 2020   m2)).          
-0000ec80: 2020 2020 2020 6465 6e6f 6d69 6e61 746f        denominato
-0000ec90: 7220 3d20 6e70 2e73 7172 7428 6e70 2e73  r = np.sqrt(np.s
-0000eca0: 756d 2828 7331 202d 206d 3129 202a 2a20  um((s1 - m1) ** 
-0000ecb0: 3229 202a 206e 702e 7375 6d28 2873 3220  2) * np.sum((s2 
-0000ecc0: 2d20 6d32 2920 2a2a 2032 2929 0a20 2020  - m2) ** 2)).   
-0000ecd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000ece0: 6465 6e6f 6d69 6e61 746f 7220 213d 2030  denominator != 0
-0000ecf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000ed00: 2020 2020 2020 7220 3d20 6e75 6d65 7261        r = numera
-0000ed10: 746f 7220 2f20 6465 6e6f 6d69 6e61 746f  tor / denominato
-0000ed20: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000ed30: 2020 2020 2020 7265 7375 6c74 735b 7269        results[ri
-0000ed40: 6768 7420 2d20 312c 2069 5d20 3d20 720a  ght - 1, i] = r.
-0000ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed60: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000ed70: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0000ed80: 735b 7269 6768 7420 2d20 312c 2069 5d20  s[right - 1, i] 
-0000ed90: 3d20 2d31 2e30 0a0a 2020 2020 2020 2020  = -1.0..        
-0000eda0: 7265 7475 726e 2072 6573 756c 7473 0a0a  return results..
-0000edb0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0000edc0: 640a 2020 2020 406e 6a69 7428 0a20 2020  d.    @njit(.   
-0000edd0: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0000ede0: 2020 2022 2866 6c6f 6174 3332 5b3a 5d2c     "(float32[:],
-0000edf0: 2066 6c6f 6174 3332 5b3a 5d2c 2066 6c6f   float32[:], flo
-0000ee00: 6174 3634 5b3a 2c3a 5d2c 2074 7970 6573  at64[:,:], types
-0000ee10: 2e75 6e69 636f 6465 5f74 7970 6529 222c  .unicode_type)",
-0000ee20: 0a20 2020 2020 2020 2020 2020 2027 2866  .            '(f
-0000ee30: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
-0000ee40: 3332 5b3a 5d2c 2066 6c6f 6174 3634 5b3a  32[:], float64[:
-0000ee50: 2c3a 5d2c 2074 7970 6573 2e6d 6973 632e  ,:], types.misc.
-0000ee60: 4f6d 6974 7465 6428 2267 6f6f 646e 6573  Omitted("goodnes
-0000ee70: 735f 6f66 5f66 6974 2229 2927 2c0a 2020  s_of_fit"))',.  
-0000ee80: 2020 2020 2020 2020 2020 2228 666c 6f61            "(floa
-0000ee90: 7433 325b 3a5d 2c20 666c 6f61 7433 325b  t32[:], float32[
-0000eea0: 3a5d 2c20 7479 7065 732e 6d69 7363 2e4f  :], types.misc.O
-0000eeb0: 6d69 7474 6564 284e 6f6e 6529 2c20 7479  mitted(None), ty
-0000eec0: 7065 732e 756e 6963 6f64 655f 7479 7065  pes.unicode_type
-0000eed0: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
-0000eee0: 2728 666c 6f61 7433 325b 3a5d 2c20 666c  '(float32[:], fl
-0000eef0: 6f61 7433 325b 3a5d 2c20 7479 7065 732e  oat32[:], types.
-0000ef00: 6d69 7363 2e4f 6d69 7474 6564 284e 6f6e  misc.Omitted(Non
-0000ef10: 6529 2c20 7479 7065 732e 6d69 7363 2e4f  e), types.misc.O
-0000ef20: 6d69 7474 6564 2822 676f 6f64 6e65 7373  mitted("goodness
-0000ef30: 5f6f 665f 6669 7422 2929 272c 0a20 2020  _of_fit"))',.   
-0000ef40: 2020 2020 205d 0a20 2020 2029 0a20 2020       ].    ).   
-0000ef50: 2064 6566 2063 6869 5f73 7175 6172 6528   def chi_square(
-0000ef60: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
-0000ef70: 313a 206e 702e 6e64 6172 7261 792c 0a20  1: np.ndarray,. 
-0000ef80: 2020 2020 2020 2073 616d 706c 655f 323a         sample_2:
-0000ef90: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
-0000efa0: 2020 2020 2063 7269 7469 6361 6c5f 7661       critical_va
-0000efb0: 6c75 6573 3a20 4f70 7469 6f6e 616c 5b6e  lues: Optional[n
-0000efc0: 702e 6e64 6172 7261 795d 203d 204e 6f6e  p.ndarray] = Non
-0000efd0: 652c 0a20 2020 2020 2020 2074 7970 653a  e,.        type:
-0000efe0: 204f 7074 696f 6e61 6c5b 4c69 7465 7261   Optional[Litera
-0000eff0: 6c5b 2267 6f6f 646e 6573 735f 6f66 5f66  l["goodness_of_f
-0000f000: 6974 222c 2022 696e 6465 7065 6e64 656e  it", "independen
-0000f010: 6365 225d 5d20 3d20 2267 6f6f 646e 6573  ce"]] = "goodnes
-0000f020: 735f 6f66 5f66 6974 222c 0a20 2020 2029  s_of_fit",.    )
-0000f030: 202d 3e20 5475 706c 655b 666c 6f61 742c   -> Tuple[float,
-0000f040: 2055 6e69 6f6e 5b62 6f6f 6c2c 204e 6f6e   Union[bool, Non
-0000f050: 655d 5d3a 0a20 2020 2020 2020 2022 2222  e]]:.        """
-0000f060: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
-0000f070: 636f 6d70 7574 6520 6f66 2063 6869 2073  compute of chi s
-0000f080: 7175 6172 6520 6265 7477 6565 6e20 7477  quare between tw
-0000f090: 6f20 6361 7465 676f 7269 6361 6c20 6469  o categorical di
-0000f0a0: 7374 7269 6275 7469 6f6e 732e 0a0a 2020  stributions...  
-0000f0b0: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-0000f0c0: 206e 6461 7272 6179 2073 616d 706c 655f   ndarray sample_
-0000f0d0: 313a 2046 6972 7374 2031 6420 6172 7261  1: First 1d arra
-0000f0e0: 7920 7265 7072 6573 656e 7469 6e67 2066  y representing f
-0000f0f0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
-0000f100: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
-0000f110: 7220 6e64 6172 7261 7920 7361 6d70 6c65  r ndarray sample
-0000f120: 5f32 3a20 5365 636f 6e64 2031 6420 6172  _2: Second 1d ar
-0000f130: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
-0000f140: 2066 6561 7475 7265 2076 616c 7565 732e   feature values.
-0000f150: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0000f160: 7465 7220 6e64 6172 7261 7920 6372 6974  ter ndarray crit
-0000f170: 6963 616c 5f76 616c 7565 733a 2032 4420  ical_values: 2D 
-0000f180: 6172 7261 7920 7769 7468 2077 6865 7265  array with where
-0000f190: 2069 6e64 6578 6573 2072 6570 7265 7365   indexes represe
-0000f1a0: 6e74 2064 6567 7265 6573 206f 6620 6672  nt degrees of fr
-0000f1b0: 6565 646f 6d20 616e 6420 7661 6c75 6573  eedom and values
-0000f1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1e0: 2020 2020 2020 2020 2020 2020 2072 6570               rep
-0000f1f0: 7265 7365 6e74 2063 7269 7469 6361 6c20  resent critical 
-0000f200: 7661 6c75 6573 2e20 4361 6e20 6265 2066  values. Can be f
-0000f210: 6f75 6e64 2069 6e20 6060 7369 6d62 612e  ound in ``simba.
-0000f220: 6173 7365 7473 2e63 7269 7469 6361 6c5f  assets.critical_
-0000f230: 7661 6c75 6573 5f30 352e 7069 636b 6c65  values_05.pickle
-0000f240: 6060 0a0a 2020 2020 2020 2020 2e2e 206e  ``..        .. n
-0000f250: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
-0000f260: 2052 6571 7569 7265 7320 7361 6d70 6c65   Requires sample
-0000f270: 5f31 2061 6e64 2073 616d 706c 655f 3220  _1 and sample_2 
-0000f280: 6861 7320 746f 2062 6520 6e75 6d65 7269  has to be numeri
-0000f290: 632e 2069 6620 776f 726b 696e 6720 7769  c. if working wi
-0000f2a0: 7468 2073 7472 696e 6773 2c20 636f 6e76  th strings, conv
-0000f2b0: 6572 7420 746f 0a20 2020 2020 2020 2020  ert to.         
-0000f2c0: 2020 6e75 6d65 7269 6320 6361 7465 676f    numeric catego
-0000f2d0: 7279 2076 616c 7565 7320 6265 666f 7265  ry values before
-0000f2e0: 2075 7369 6e67 2063 6869 5f73 7175 6172   using chi_squar
-0000f2f0: 652e 0a0a 2020 2020 2020 2020 2e2e 2077  e...        .. w
-0000f300: 6172 6e69 6e67 3a0a 2020 2020 2020 2020  arning:.        
-0000f310: 2020 204e 6f6e 2d6f 7665 726c 6170 7069     Non-overlappi
-0000f320: 6e67 2076 616c 7565 7320 2869 2e65 2e2c  ng values (i.e.,
-0000f330: 2063 6174 6567 6f72 6965 7320 6578 6973   categories exis
-0000f340: 7420 696e 2073 616d 706c 655f 3120 7468  t in sample_1 th
-0000f350: 6174 2064 6f65 7320 6e6f 7420 6578 6973  at does not exis
-0000f360: 7420 696e 2073 616d 706c 6532 2920 6f72  t in sample2) or
-0000f370: 2073 6d61 6c6c 2076 616c 7565 7320 6d61   small values ma
-0000f380: 7920 6361 7573 6520 696e 666c 6174 6564  y cause inflated
-0000f390: 2063 6869 2073 7175 6172 6520 7661 6c75   chi square valu
-0000f3a0: 6573 2e0a 2020 2020 2020 2020 2020 2049  es..           I
-0000f3b0: 6620 736d 616c 6c20 636f 6e74 696e 6765  f small continge
-0000f3c0: 6e63 7920 7461 626c 6520 736d 616c 6c20  ncy table small 
-0000f3d0: 7661 6c75 6573 2c20 636f 6e73 6964 6572  values, consider
-0000f3e0: 2054 4f44 4f20 4669 7368 6572 2773 2065   TODO Fisher's e
-0000f3f0: 7861 6374 2074 6573 740a 0a20 2020 2020  xact test..     
-0000f400: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
-0000f410: 2020 2020 203e 3e3e 2073 616d 706c 655f       >>> sample_
-0000f420: 3120 3d20 6e70 2e61 7272 6179 285b 312c  1 = np.array([1,
-0000f430: 2031 2c20 322c 2032 2c20 332c 2033 2c20   1, 2, 2, 3, 3, 
-0000f440: 342c 2034 2c20 352c 2035 2c20 355d 292e  4, 4, 5, 5, 5]).
-0000f450: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-0000f460: 3229 0a20 2020 2020 2020 203e 3e3e 2073  2).        >>> s
-0000f470: 616d 706c 655f 3220 3d20 6e70 2e61 7272  ample_2 = np.arr
-0000f480: 6179 285b 312c 2032 2c20 332c 2034 2c20  ay([1, 2, 3, 4, 
-0000f490: 352c 2036 2c20 372c 2038 2c20 392c 2031  5, 6, 7, 8, 9, 1
-0000f4a0: 305d 292e 6173 7479 7065 286e 702e 666c  0]).astype(np.fl
-0000f4b0: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
-0000f4c0: 3e3e 2063 7269 7469 6361 6c5f 7661 6c75  >> critical_valu
-0000f4d0: 6573 203d 2070 6963 6b6c 652e 6c6f 6164  es = pickle.load
-0000f4e0: 286f 7065 6e28 2273 696d 6261 2f61 7373  (open("simba/ass
-0000f4f0: 6574 732f 6c6f 6f6b 7570 732f 6372 6974  ets/lookups/crit
-0000f500: 6963 616c 5f76 616c 7565 735f 352e 7069  ical_values_5.pi
-0000f510: 636b 6c65 222c 2022 7262 2229 295b 2763  ckle", "rb"))['c
-0000f520: 6869 5f73 7175 6172 6527 5d5b 276f 6e65  hi_square']['one
-0000f530: 5f74 6169 6c27 5d2e 7661 6c75 6573 0a20  _tail'].values. 
-0000f540: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-0000f550: 7374 6963 732e 6368 695f 7371 7561 7265  stics.chi_square
-0000f560: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-0000f570: 5f32 2c20 7361 6d70 6c65 5f32 3d73 616d  _2, sample_2=sam
-0000f580: 706c 655f 312c 2063 7269 7469 6361 6c5f  ple_1, critical_
-0000f590: 7661 6c75 6573 3d63 7269 7469 6361 6c5f  values=critical_
-0000f5a0: 7661 6c75 6573 2c20 7479 7065 3d27 676f  values, type='go
-0000f5b0: 6f64 6e65 7373 5f6f 665f 6669 7427 290a  odness_of_fit').
-0000f5c0: 2020 2020 2020 2020 3e3e 3e20 2838 2e33          >>> (8.3
-0000f5d0: 3333 2c20 4661 6c73 6529 0a20 2020 2020  33, False).     
-0000f5e0: 2020 203e 3e3e 0a20 2020 2020 2020 2022     >>>.        "
-0000f5f0: 2222 0a0a 2020 2020 2020 2020 6368 695f  ""..        chi_
-0000f600: 7371 7561 7265 2c20 7369 676e 6966 6963  square, signific
-0000f610: 616e 6365 5f62 6f6f 6c20 3d20 302e 302c  ance_bool = 0.0,
-0000f620: 204e 6f6e 650a 2020 2020 2020 2020 756e   None.        un
-0000f630: 6971 7565 5f63 6174 6567 6f72 6965 7320  ique_categories 
-0000f640: 3d20 6e70 2e75 6e69 7175 6528 6e70 2e63  = np.unique(np.c
-0000f650: 6f6e 6361 7465 6e61 7465 2828 7361 6d70  oncatenate((samp
-0000f660: 6c65 5f31 2c20 7361 6d70 6c65 5f32 2929  le_1, sample_2))
-0000f670: 290a 2020 2020 2020 2020 7361 6d70 6c65  ).        sample
-0000f680: 5f31 5f63 6f75 6e74 7320 3d20 6e70 2e7a  _1_counts = np.z
-0000f690: 6572 6f73 286c 656e 2875 6e69 7175 655f  eros(len(unique_
-0000f6a0: 6361 7465 676f 7269 6573 292c 2064 7479  categories), dty
-0000f6b0: 7065 3d6e 702e 696e 7436 3429 0a20 2020  pe=np.int64).   
-0000f6c0: 2020 2020 2073 616d 706c 655f 325f 636f       sample_2_co
-0000f6d0: 756e 7473 203d 206e 702e 7a65 726f 7328  unts = np.zeros(
-0000f6e0: 6c65 6e28 756e 6971 7565 5f63 6174 6567  len(unique_categ
-0000f6f0: 6f72 6965 7329 2c20 6474 7970 653d 6e70  ories), dtype=np
-0000f700: 2e69 6e74 3634 290a 0a20 2020 2020 2020  .int64)..       
-0000f710: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
-0000f720: 286c 656e 2875 6e69 7175 655f 6361 7465  (len(unique_cate
-0000f730: 676f 7269 6573 2929 3a0a 2020 2020 2020  gories)):.      
-0000f740: 2020 2020 2020 7361 6d70 6c65 5f31 5f63        sample_1_c
-0000f750: 6f75 6e74 735b 695d 2c20 7361 6d70 6c65  ounts[i], sample
-0000f760: 5f32 5f63 6f75 6e74 735b 695d 203d 206e  _2_counts[i] = n
-0000f770: 702e 7375 6d28 0a20 2020 2020 2020 2020  p.sum(.         
-0000f780: 2020 2020 2020 2073 616d 706c 655f 3120         sample_1 
-0000f790: 3d3d 2075 6e69 7175 655f 6361 7465 676f  == unique_catego
-0000f7a0: 7269 6573 5b69 5d0a 2020 2020 2020 2020  ries[i].        
-0000f7b0: 2020 2020 292c 206e 702e 7375 6d28 7361      ), np.sum(sa
-0000f7c0: 6d70 6c65 5f32 203d 3d20 756e 6971 7565  mple_2 == unique
-0000f7d0: 5f63 6174 6567 6f72 6965 735b 695d 290a  _categories[i]).
-0000f7e0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0000f7f0: 6e20 7072 616e 6765 286c 656e 2875 6e69  n prange(len(uni
-0000f800: 7175 655f 6361 7465 676f 7269 6573 2929  que_categories))
-0000f810: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-0000f820: 756e 745f 312c 2063 6f75 6e74 5f32 203d  unt_1, count_2 =
-0000f830: 2073 616d 706c 655f 315f 636f 756e 7473   sample_1_counts
-0000f840: 5b69 5d2c 2073 616d 706c 655f 325f 636f  [i], sample_2_co
-0000f850: 756e 7473 5b69 5d0a 2020 2020 2020 2020  unts[i].        
-0000f860: 2020 2020 6966 2063 6f75 6e74 5f32 203e      if count_2 >
-0000f870: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0000f880: 2020 2020 6368 695f 7371 7561 7265 202b      chi_square +
-0000f890: 3d20 2828 636f 756e 745f 3120 2d20 636f  = ((count_1 - co
-0000f8a0: 756e 745f 3229 202a 2a20 3229 202f 2063  unt_2) ** 2) / c
-0000f8b0: 6f75 6e74 5f32 0a20 2020 2020 2020 2020  ount_2.         
-0000f8c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000f8d0: 2020 2020 2020 2020 2063 6869 5f73 7175           chi_squ
-0000f8e0: 6172 6520 2b3d 2028 2863 6f75 6e74 5f31  are += ((count_1
-0000f8f0: 202d 2063 6f75 6e74 5f32 2920 2a2a 2032   - count_2) ** 2
-0000f900: 2920 2f20 2863 6f75 6e74 5f32 202b 2031  ) / (count_2 + 1
-0000f910: 290a 0a20 2020 2020 2020 2069 6620 6372  )..        if cr
-0000f920: 6974 6963 616c 5f76 616c 7565 7320 6973  itical_values is
-0000f930: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000f940: 2020 2020 2020 2069 6620 7479 7065 203d         if type =
-0000f950: 3d20 2267 6f6f 646e 6573 735f 6f66 5f66  = "goodness_of_f
-0000f960: 6974 223a 0a20 2020 2020 2020 2020 2020  it":.           
-0000f970: 2020 2020 2064 6620 3d20 756e 6971 7565       df = unique
-0000f980: 5f63 6174 6567 6f72 6965 732e 7368 6170  _categories.shap
-0000f990: 655b 305d 202d 2031 0a20 2020 2020 2020  e[0] - 1.       
-0000f9a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000f9b0: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
-0000f9c0: 286c 656e 2873 616d 706c 655f 315f 636f  (len(sample_1_co
-0000f9d0: 756e 7473 2920 2d20 3129 202a 2028 6c65  unts) - 1) * (le
-0000f9e0: 6e28 7361 6d70 6c65 5f32 5f63 6f75 6e74  n(sample_2_count
-0000f9f0: 7329 202d 2031 290a 0a20 2020 2020 2020  s) - 1)..       
-0000fa00: 2020 2020 2063 7269 7469 6361 6c5f 7661       critical_va
-0000fa10: 6c75 6520 3d20 6e70 2e69 6e74 6572 7028  lue = np.interp(
-0000fa20: 6466 2c20 6372 6974 6963 616c 5f76 616c  df, critical_val
-0000fa30: 7565 735b 3a2c 2030 5d2c 2063 7269 7469  ues[:, 0], criti
-0000fa40: 6361 6c5f 7661 6c75 6573 5b3a 2c20 315d  cal_values[:, 1]
-0000fa50: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0000fa60: 2063 6869 5f73 7175 6172 6520 3e3d 2063   chi_square >= c
-0000fa70: 7269 7469 6361 6c5f 7661 6c75 653a 0a20  ritical_value:. 
-0000fa80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000fa90: 6967 6e69 6669 6361 6e63 655f 626f 6f6c  ignificance_bool
-0000faa0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-0000fab0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000fac0: 2020 2020 2020 2020 2020 7369 676e 6966            signif
-0000fad0: 6963 616e 6365 5f62 6f6f 6c20 3d20 4661  icance_bool = Fa
-0000fae0: 6c73 650a 0a20 2020 2020 2020 2072 6574  lse..        ret
-0000faf0: 7572 6e20 6368 695f 7371 7561 7265 2c20  urn chi_square, 
-0000fb00: 7369 676e 6966 6963 616e 6365 5f62 6f6f  significance_boo
-0000fb10: 6c0a 0a20 2020 2040 7374 6174 6963 6d65  l..    @staticme
-0000fb20: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
-0000fb30: 2866 6c6f 6174 3332 5b3a 5d2c 2066 6c6f  (float32[:], flo
-0000fb40: 6174 3332 2c20 666c 6f61 7433 322c 2066  at32, float32, f
-0000fb50: 6c6f 6174 3332 5b3a 2c3a 5d2c 2066 6c6f  loat32[:,:], flo
-0000fb60: 6174 3332 2922 290a 2020 2020 6465 6620  at32)").    def 
-0000fb70: 736c 6964 696e 675f 696e 6465 7065 6e64  sliding_independ
-0000fb80: 656e 745f 7361 6d70 6c65 735f 7428 0a20  ent_samples_t(. 
-0000fb90: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
-0000fba0: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
-0000fbb0: 2074 696d 655f 7769 6e64 6f77 3a20 666c   time_window: fl
-0000fbc0: 6f61 742c 0a20 2020 2020 2020 2073 6c69  oat,.        sli
-0000fbd0: 6465 5f74 696d 653a 2066 6c6f 6174 2c0a  de_time: float,.
-0000fbe0: 2020 2020 2020 2020 6372 6974 6963 616c          critical
-0000fbf0: 5f76 616c 7565 733a 206e 702e 6e64 6172  _values: np.ndar
-0000fc00: 7261 792c 0a20 2020 2020 2020 2066 7073  ray,.        fps
-0000fc10: 3a20 666c 6f61 742c 0a20 2020 2029 202d  : float,.    ) -
-0000fc20: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
-0000fc30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000fc40: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
-0000fc50: 206f 6620 736c 6964 696e 6720 696e 6465   of sliding inde
-0000fc60: 7065 6e64 656e 7420 7361 6d70 6c65 2074  pendent sample t
-0000fc70: 2d74 6573 742e 2043 6f6d 7061 7265 7320  -test. Compares 
-0000fc80: 7468 6520 6665 6174 7572 6520 7661 6c75  the feature valu
-0000fc90: 6573 2069 6e20 6375 7272 656e 7420 7469  es in current ti
-0000fca0: 6d65 2d77 696e 646f 770a 2020 2020 2020  me-window.      
-0000fcb0: 2020 746f 2070 7269 6f72 2074 696d 652d    to prior time-
-0000fcc0: 7769 6e64 6f77 7320 746f 2066 696e 6420  windows to find 
-0000fcd0: 7468 6520 6c65 6e67 7468 2069 6e20 7469  the length in ti
-0000fce0: 6d65 2074 6f20 7468 6520 6d6f 7374 2072  me to the most r
-0000fcf0: 6563 656e 7420 7469 6d65 2d77 696e 646f  ecent time-windo
-0000fd00: 7720 7768 6572 6520 6120 7369 676e 6966  w where a signif
-0000fd10: 6963 616e 746c 7920 6469 6666 6572 656e  icantly differen
-0000fd20: 740a 2020 2020 2020 2020 6665 6174 7572  t.        featur
-0000fd30: 6520 7661 6c75 6520 6469 7374 7269 6275  e value distribu
-0000fd40: 7469 6f6e 2069 7320 6465 7465 6374 6564  tion is detected
-0000fd50: 2e0a 0a20 2020 2020 2020 202e 2e20 696d  ...        .. im
-0000fd60: 6167 653a 3a20 5f73 7461 7469 632f 696d  age:: _static/im
-0000fd70: 672f 736c 6964 696e 675f 7374 6174 6973  g/sliding_statis
-0000fd80: 7469 6373 2e70 6e67 0a20 2020 2020 2020  tics.png.       
-0000fd90: 2020 2020 3a77 6964 7468 3a20 3135 3030      :width: 1500
-0000fda0: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
-0000fdb0: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
-0000fdc0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-0000fdd0: 6461 7272 6179 2064 6174 613a 2031 4420  darray data: 1D 
-0000fde0: 6172 7261 7920 7769 7468 2066 6561 7475  array with featu
-0000fdf0: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
-0000fe00: 2020 203a 7061 7261 6d65 7465 7220 666c     :parameter fl
-0000fe10: 6f61 7420 7469 6d65 5f77 696e 646f 773a  oat time_window:
-0000fe20: 2054 6865 2073 697a 6573 206f 6620 7468   The sizes of th
-0000fe30: 6520 7477 6f20 6665 6174 7572 6520 7661  e two feature va
-0000fe40: 6c75 6520 7769 6e64 6f77 7320 6265 696e  lue windows bein
-0000fe50: 6720 636f 6d70 6172 6564 2069 6e20 7365  g compared in se
-0000fe60: 636f 6e64 732e 0a20 2020 2020 2020 203a  conds..        :
-0000fe70: 7061 7261 6d65 7465 7220 666c 6f61 7420  parameter float 
-0000fe80: 736c 6964 655f 7469 6d65 3a20 5468 6520  slide_time: The 
-0000fe90: 736c 6964 6520 7369 7a65 206f 6620 7468  slide size of th
-0000fea0: 6520 7365 636f 6e64 2077 696e 646f 772e  e second window.
-0000feb0: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0000fec0: 7465 7220 6e64 6172 7261 7920 6372 6974  ter ndarray crit
-0000fed0: 6963 616c 5f76 616c 7565 733a 2032 4420  ical_values: 2D 
-0000fee0: 6172 7261 7920 7769 7468 2077 6865 7265  array with where
-0000fef0: 2069 6e64 6578 6573 2072 6570 7265 7365   indexes represe
-0000ff00: 6e74 2064 6567 7265 6573 206f 6620 6672  nt degrees of fr
-0000ff10: 6565 646f 6d20 616e 6420 7661 6c75 6573  eedom and values
-0000ff20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff40: 2020 2020 2020 2020 2020 2020 2072 6570               rep
-0000ff50: 7265 7365 6e74 2063 7269 7469 6361 6c20  resent critical 
-0000ff60: 5420 7661 6c75 6573 2e20 4361 6e20 6265  T values. Can be
-0000ff70: 2066 6f75 6e64 2069 6e20 6060 7369 6d62   found in ``simb
-0000ff80: 612e 6173 7365 7473 2e63 7269 7469 6361  a.assets.critica
-0000ff90: 6c5f 7661 6c75 6573 5f30 352e 7069 636b  l_values_05.pick
-0000ffa0: 6c65 6060 2e0a 2020 2020 2020 2020 3a70  le``..        :p
-0000ffb0: 6172 616d 6574 6572 2069 6e74 2066 7073  arameter int fps
-0000ffc0: 3a20 5468 6520 6670 7320 6f66 2074 6865  : The fps of the
-0000ffd0: 2072 6563 6f72 6465 6420 7669 6465 6f2e   recorded video.
-0000ffe0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-0000fff0: 7320 6e70 2e6e 6461 7272 6179 3a20 3144  s np.ndarray: 1D
-00010000: 2061 7272 6179 206f 6620 7369 7a65 206c   array of size l
-00010010: 656e 2864 6174 6129 2077 6974 6820 7661  en(data) with va
-00010020: 6c75 6573 2072 6570 7265 7365 6e74 696e  lues representin
-00010030: 6720 7469 6d65 2074 6f20 6d6f 7374 2072  g time to most r
-00010040: 6563 656e 7420 7369 676e 6966 6963 616e  ecent significan
-00010050: 746c 7920 6469 6666 6572 656e 7420 6665  tly different fe
-00010060: 6174 7572 6520 6469 7374 7269 6275 7469  ature distributi
-00010070: 6f6e 2e0a 0a20 2020 2020 2020 203a 6578  on...        :ex
-00010080: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00010090: 3e3e 2064 6174 6120 3d20 6e70 2e72 616e  >> data = np.ran
-000100a0: 646f 6d2e 7261 6e64 696e 7428 302c 2035  dom.randint(0, 5
-000100b0: 302c 2028 3130 2929 2e61 7374 7970 6528  0, (10)).astype(
-000100c0: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
-000100d0: 2020 2020 3e3e 3e20 6372 6974 6963 616c      >>> critical
-000100e0: 5f76 616c 7565 7320 3d20 7069 636b 6c65  _values = pickle
-000100f0: 2e6c 6f61 6428 6f70 656e 2822 7369 6d62  .load(open("simb
-00010100: 612f 6173 7365 7473 2f6c 6f6f 6b75 7073  a/assets/lookups
-00010110: 2f63 7269 7469 6361 6c5f 7661 6c75 6573  /critical_values
-00010120: 5f30 352e 7069 636b 6c65 222c 2022 7262  _05.pickle", "rb
-00010130: 2229 295b 2769 6e64 6570 656e 6465 6e74  "))['independent
-00010140: 5f74 5f74 6573 7427 5d5b 276f 6e65 5f74  _t_test']['one_t
-00010150: 6169 6c27 5d2e 7661 6c75 6573 2e61 7374  ail'].values.ast
-00010160: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-00010170: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
-00010180: 6c74 7320 3d20 5374 6174 6973 7469 6373  lts = Statistics
-00010190: 2829 2e73 6c69 6469 6e67 5f69 6e64 6570  ().sliding_indep
-000101a0: 656e 6465 6e74 5f73 616d 706c 6573 5f74  endent_samples_t
-000101b0: 2864 6174 613d 6461 7461 2c20 7469 6d65  (data=data, time
-000101c0: 5f77 696e 646f 773d 302e 352c 2066 7073  _window=0.5, fps
-000101d0: 3d35 2e30 2c20 6372 6974 6963 616c 5f76  =5.0, critical_v
-000101e0: 616c 7565 733d 6372 6974 6963 616c 5f76  alues=critical_v
-000101f0: 616c 7565 732c 2073 6c69 6465 5f74 696d  alues, slide_tim
-00010200: 653d 302e 3330 290a 2020 2020 2020 2020  e=0.30).        
-00010210: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
-00010220: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
-00010230: 6461 7461 2e73 6861 7065 5b30 5d29 2c20  data.shape[0]), 
-00010240: 302e 3029 0a20 2020 2020 2020 2077 696e  0.0).        win
-00010250: 646f 775f 7369 7a65 2c20 736c 6964 655f  dow_size, slide_
-00010260: 7369 7a65 203d 2069 6e74 2874 696d 655f  size = int(time_
-00010270: 7769 6e64 6f77 202a 2066 7073 292c 2069  window * fps), i
-00010280: 6e74 2873 6c69 6465 5f74 696d 6520 2a20  nt(slide_time * 
-00010290: 6670 7329 0a20 2020 2020 2020 2066 6f72  fps).        for
-000102a0: 2069 2069 6e20 7261 6e67 6528 312c 2064   i in range(1, d
-000102b0: 6174 612e 7368 6170 655b 305d 293a 0a20  ata.shape[0]):. 
-000102c0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-000102d0: 655f 315f 6c65 6674 2c20 7361 6d70 6c65  e_1_left, sample
-000102e0: 5f31 5f72 6967 6874 203d 2069 2c20 6920  _1_right = i, i 
-000102f0: 2b20 7769 6e64 6f77 5f73 697a 650a 2020  + window_size.  
-00010300: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-00010310: 5f32 5f6c 6566 742c 2073 616d 706c 655f  _2_left, sample_
-00010320: 325f 7269 6768 7420 3d20 280a 2020 2020  2_right = (.    
-00010330: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
-00010340: 6c65 5f31 5f6c 6566 7420 2d20 736c 6964  le_1_left - slid
-00010350: 655f 7369 7a65 2c0a 2020 2020 2020 2020  e_size,.        
-00010360: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
-00010370: 5f72 6967 6874 202d 2073 6c69 6465 5f73  _right - slide_s
-00010380: 697a 652c 0a20 2020 2020 2020 2020 2020  ize,.           
-00010390: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
-000103a0: 616d 706c 655f 3120 3d20 6461 7461 5b73  ample_1 = data[s
-000103b0: 616d 706c 655f 315f 6c65 6674 3a73 616d  ample_1_left:sam
-000103c0: 706c 655f 315f 7269 6768 745d 0a20 2020  ple_1_right].   
-000103d0: 2020 2020 2020 2020 2064 6f66 2c20 7374           dof, st
-000103e0: 6570 735f 7461 6b65 6e20 3d20 2873 616d  eps_taken = (sam
-000103f0: 706c 655f 312e 7368 6170 655b 305d 202b  ple_1.shape[0] +
-00010400: 2073 616d 706c 655f 312e 7368 6170 655b   sample_1.shape[
-00010410: 305d 2920 2d20 322c 2031 0a20 2020 2020  0]) - 2, 1.     
-00010420: 2020 2020 2020 2077 6869 6c65 2073 616d         while sam
-00010430: 706c 655f 325f 6c65 6674 203e 3d20 303a  ple_2_left >= 0:
-00010440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010450: 2073 616d 706c 655f 3220 3d20 6461 7461   sample_2 = data
-00010460: 5b73 616d 706c 655f 325f 6c65 6674 3a73  [sample_2_left:s
-00010470: 616d 706c 655f 325f 7269 6768 745d 0a20  ample_2_right]. 
-00010480: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00010490: 5f73 7461 7469 7374 6963 203d 2028 6e70  _statistic = (np
-000104a0: 2e6d 6561 6e28 7361 6d70 6c65 5f31 2920  .mean(sample_1) 
-000104b0: 2d20 6e70 2e6d 6561 6e28 7361 6d70 6c65  - np.mean(sample
-000104c0: 5f32 2929 202f 206e 702e 7371 7274 280a  _2)) / np.sqrt(.
-000104d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104e0: 2020 2020 286e 702e 7374 6428 7361 6d70      (np.std(samp
-000104f0: 6c65 5f31 2920 2f20 7361 6d70 6c65 5f31  le_1) / sample_1
-00010500: 2e73 6861 7065 5b30 5d29 0a20 2020 2020  .shape[0]).     
-00010510: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-00010520: 2028 6e70 2e73 7464 2873 616d 706c 655f   (np.std(sample_
-00010530: 3229 202f 2073 616d 706c 655f 312e 7368  2) / sample_1.sh
-00010540: 6170 655b 305d 290a 2020 2020 2020 2020  ape[0]).        
-00010550: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00010560: 2020 2020 2020 2020 2020 6372 6974 6963            critic
-00010570: 616c 5f76 616c 203d 2063 7269 7469 6361  al_val = critica
-00010580: 6c5f 7661 6c75 6573 5b64 6f66 202d 2031  l_values[dof - 1
-00010590: 5d5b 315d 0a20 2020 2020 2020 2020 2020  ][1].           
-000105a0: 2020 2020 2069 6620 745f 7374 6174 6973       if t_statis
-000105b0: 7469 6320 3e3d 2063 7269 7469 6361 6c5f  tic >= critical_
-000105c0: 7661 6c3a 0a20 2020 2020 2020 2020 2020  val:.           
-000105d0: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-000105e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000105f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00010600: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00010610: 325f 6c65 6674 202d 3d20 310a 2020 2020  2_left -= 1.    
-00010620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010630: 7361 6d70 6c65 5f32 5f72 6967 6874 202d  sample_2_right -
-00010640: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00010650: 2020 2020 2020 2020 7374 6570 735f 7461          steps_ta
-00010660: 6b65 6e20 2b3d 2031 0a20 2020 2020 2020  ken += 1.       
-00010670: 2020 2020 2020 2020 2069 6620 7361 6d70           if samp
-00010680: 6c65 5f32 5f6c 6566 7420 3c20 303a 0a20  le_2_left < 0:. 
-00010690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000106a0: 2020 2073 7465 7073 5f74 616b 656e 203d     steps_taken =
-000106b0: 202d 310a 2020 2020 2020 2020 2020 2020   -1.            
-000106c0: 6966 2073 7465 7073 5f74 616b 656e 203d  if steps_taken =
-000106d0: 3d20 2d31 3a0a 2020 2020 2020 2020 2020  = -1:.          
-000106e0: 2020 2020 2020 7265 7375 6c74 735b 6920        results[i 
-000106f0: 2b20 7769 6e64 6f77 5f73 697a 655d 203d  + window_size] =
-00010700: 202d 310a 2020 2020 2020 2020 2020 2020   -1.            
-00010710: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00010720: 2020 2020 2020 7265 7375 6c74 735b 6920        results[i 
-00010730: 2b20 7769 6e64 6f77 5f73 697a 655d 203d  + window_size] =
-00010740: 2073 7465 7073 5f74 616b 656e 202a 2073   steps_taken * s
-00010750: 6c69 6465 5f74 696d 650a 0a20 2020 2020  lide_time..     
-00010760: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-00010770: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
-00010780: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
-00010790: 2866 6c6f 6174 3332 5b3a 5d2c 2066 6c6f  (float32[:], flo
-000107a0: 6174 3634 5b3a 5d2c 2066 6c6f 6174 3332  at64[:], float32
-000107b0: 2922 290a 2020 2020 6465 6620 726f 6c6c  )").    def roll
-000107c0: 696e 675f 6d61 6e6e 5f77 6869 746e 6579  ing_mann_whitney
-000107d0: 2864 6174 613a 206e 702e 6e64 6172 7261  (data: np.ndarra
-000107e0: 792c 2074 696d 655f 7769 6e64 6f77 733a  y, time_windows:
-000107f0: 206e 702e 6e64 6172 7261 792c 2066 7073   np.ndarray, fps
-00010800: 3a20 666c 6f61 7429 3a0a 2020 2020 2020  : float):.      
-00010810: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
-00010820: 7474 6564 2063 6f6d 7075 7465 206f 6620  tted compute of 
-00010830: 726f 6c6c 696e 6720 4d61 6e6e 2d57 6869  rolling Mann-Whi
-00010840: 746e 6579 2055 2063 6f6d 7061 7269 6e67  tney U comparing
-00010850: 2074 6865 2063 7572 7265 6e74 2074 696d   the current tim
-00010860: 652d 7769 6e64 6f77 206f 660a 2020 2020  e-window of.    
-00010870: 2020 2020 7369 7a65 204e 2074 6f20 7468      size N to th
-00010880: 6520 7072 6563 6564 696e 6720 7769 6e64  e preceding wind
-00010890: 6f77 206f 6620 7369 7a65 204e 2e0a 0a20  ow of size N... 
-000108a0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-000108b0: 0a20 2020 2020 2020 2020 2020 4669 7273  .           Firs
-000108c0: 7420 7469 6d65 2062 696e 2028 7768 6572  t time bin (wher
-000108d0: 6520 6861 7320 6e6f 2070 7265 6365 6469  e has no precedi
-000108e0: 6e67 2074 696d 6520 6269 6e29 2077 696c  ng time bin) wil
-000108f0: 6c20 6861 7665 2066 696c 6c20 7661 6c75  l have fill valu
-00010900: 6520 6060 3060 600a 0a20 2020 2020 2020  e ``0``..       
-00010910: 2020 2020 604d 6f64 6966 6965 6420 6672      `Modified fr
-00010920: 6f6d 204a 616d 6573 2057 6562 6265 7220  om James Webber 
-00010930: 6769 7374 203c 6874 7470 733a 2f2f 6769  gist <https://gi
-00010940: 7374 2e67 6974 6875 622e 636f 6d2f 6a61  st.github.com/ja
-00010950: 6d65 7374 7765 6262 6572 2f33 3861 6232  mestwebber/38ab2
-00010960: 3664 3238 3166 3937 6665 6238 3139 3662  6d281f97feb8196b
-00010970: 3364 3933 6564 6565 6237 623e 605f 5f2e  3d93edeeb7b>`__.
-00010980: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00010990: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
-000109a0: 706c 655f 313a 2046 6972 7374 2031 6420  ple_1: First 1d 
-000109b0: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
-000109c0: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
-000109d0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-000109e0: 6d65 7465 7220 6e64 6172 7261 7920 7361  meter ndarray sa
-000109f0: 6d70 6c65 5f32 3a20 5365 636f 6e64 2031  mple_2: Second 1
-00010a00: 6420 6172 7261 7920 7265 7072 6573 656e  d array represen
-00010a10: 7469 6e67 2066 6561 7475 7265 2076 616c  ting feature val
-00010a20: 7565 732e 0a20 2020 2020 2020 203a 7265  ues..        :re
-00010a30: 7475 726e 7320 6e70 2e6e 6461 7272 6179  turns np.ndarray
-00010a40: 3a20 4d61 6e6e 2d57 6869 746e 6579 2055  : Mann-Whitney U
-00010a50: 2064 6174 6120 6f66 2073 697a 6520 6c65   data of size le
-00010a60: 6e28 6461 7461 2920 7820 6c65 6e28 7469  n(data) x len(ti
-00010a70: 6d65 5f77 696e 646f 7773 292e 0a0a 2020  me_windows)...  
-00010a80: 2020 2020 2020 3a65 7861 6d70 6c65 733a        :examples:
-00010a90: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
-00010aa0: 6120 3d20 6e70 2e72 616e 646f 6d2e 7261  a = np.random.ra
-00010ab0: 6e64 696e 7428 302c 2034 2c20 2832 3030  ndint(0, 4, (200
-00010ac0: 2929 2e61 7374 7970 6528 6e70 2e66 6c6f  )).astype(np.flo
-00010ad0: 6174 3332 290a 2020 2020 2020 2020 3e3e  at32).        >>
-00010ae0: 3e20 7265 7375 6c74 7320 3d20 5374 6174  > results = Stat
-00010af0: 6973 7469 6373 2829 2e72 6f6c 6c69 6e67  istics().rolling
-00010b00: 5f6d 616e 6e5f 7768 6974 6e65 7928 6461  _mann_whitney(da
-00010b10: 7461 3d64 6174 612c 2074 696d 655f 7769  ta=data, time_wi
-00010b20: 6e64 6f77 733d 6e70 2e61 7272 6179 285b  ndows=np.array([
-00010b30: 312e 305d 292c 2066 7073 3d31 290a 2020  1.0]), fps=1).  
-00010b40: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00010b50: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
-00010b60: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
-00010b70: 5b30 5d2c 2074 696d 655f 7769 6e64 6f77  [0], time_window
-00010b80: 732e 7368 6170 655b 305d 292c 2030 2e30  s.shape[0]), 0.0
-00010b90: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
-00010ba0: 696e 2070 7261 6e67 6528 7469 6d65 5f77  in prange(time_w
-00010bb0: 696e 646f 7773 2e73 6861 7065 5b30 5d29  indows.shape[0])
-00010bc0: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
-00010bd0: 6e64 6f77 5f73 697a 6520 3d20 696e 7428  ndow_size = int(
-00010be0: 7469 6d65 5f77 696e 646f 7773 5b69 5d20  time_windows[i] 
-00010bf0: 2a20 6670 7329 0a20 2020 2020 2020 2020  * fps).         
-00010c00: 2020 2064 6174 615f 7370 6c69 7420 3d20     data_split = 
-00010c10: 6e70 2e73 706c 6974 280a 2020 2020 2020  np.split(.      
-00010c20: 2020 2020 2020 2020 2020 6461 7461 2c20            data, 
-00010c30: 6c69 7374 2872 616e 6765 2877 696e 646f  list(range(windo
-00010c40: 775f 7369 7a65 2c20 6461 7461 2e73 6861  w_size, data.sha
-00010c50: 7065 5b30 5d2c 2077 696e 646f 775f 7369  pe[0], window_si
-00010c60: 7a65 2929 0a20 2020 2020 2020 2020 2020  ze)).           
-00010c70: 2029 0a20 2020 2020 2020 2020 2020 2066   ).            f
-00010c80: 6f72 206a 2069 6e20 7072 616e 6765 2831  or j in prange(1
-00010c90: 2c20 6c65 6e28 6461 7461 5f73 706c 6974  , len(data_split
-00010ca0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00010cb0: 2020 2020 7769 6e64 6f77 5f73 7461 7274      window_start
-00010cc0: 203d 2069 6e74 2877 696e 646f 775f 7369   = int(window_si
-00010cd0: 7a65 202a 206a 290a 2020 2020 2020 2020  ze * j).        
-00010ce0: 2020 2020 2020 2020 7769 6e64 6f77 5f65          window_e
-00010cf0: 6e64 203d 2069 6e74 2877 696e 646f 775f  nd = int(window_
-00010d00: 7374 6172 7420 2b20 7769 6e64 6f77 5f73  start + window_s
-00010d10: 697a 6529 0a20 2020 2020 2020 2020 2020  ize).           
-00010d20: 2020 2020 2073 616d 706c 655f 312c 2073       sample_1, s
-00010d30: 616d 706c 655f 3220 3d20 6461 7461 5f73  ample_2 = data_s
-00010d40: 706c 6974 5b6a 202d 2031 5d2e 6173 7479  plit[j - 1].asty
-00010d50: 7065 286e 702e 666c 6f61 7433 3229 2c20  pe(np.float32), 
-00010d60: 6461 7461 5f73 706c 6974 5b0a 2020 2020  data_split[.    
-00010d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d80: 6a0a 2020 2020 2020 2020 2020 2020 2020  j.              
-00010d90: 2020 5d2e 6173 7479 7065 286e 702e 666c    ].astype(np.fl
-00010da0: 6f61 7433 3229 0a20 2020 2020 2020 2020  oat32).         
-00010db0: 2020 2020 2020 206e 312c 206e 3220 3d20         n1, n2 = 
-00010dc0: 7361 6d70 6c65 5f31 2e73 6861 7065 5b30  sample_1.shape[0
-00010dd0: 5d2c 2073 616d 706c 655f 322e 7368 6170  ], sample_2.shap
-00010de0: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-00010df0: 2020 2020 2072 616e 6b65 6420 3d20 6661       ranked = fa
-00010e00: 7374 5f6d 6561 6e5f 7261 6e6b 286e 702e  st_mean_rank(np.
-00010e10: 636f 6e63 6174 656e 6174 6528 2873 616d  concatenate((sam
-00010e20: 706c 655f 312c 2073 616d 706c 655f 3229  ple_1, sample_2)
-00010e30: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00010e40: 2020 2075 3120 3d20 6e31 202a 206e 3220     u1 = n1 * n2 
-00010e50: 2b20 286e 3120 2a20 286e 3120 2b20 3129  + (n1 * (n1 + 1)
-00010e60: 2920 2f20 322e 3020 2d20 6e70 2e73 756d  ) / 2.0 - np.sum
-00010e70: 2872 616e 6b65 645b 3a6e 315d 2c20 6178  (ranked[:n1], ax
-00010e80: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
-00010e90: 2020 2020 2020 7532 203d 206e 3120 2a20        u2 = n1 * 
-00010ea0: 6e32 202d 2075 310a 2020 2020 2020 2020  n2 - u1.        
-00010eb0: 2020 2020 2020 2020 7520 3d20 6d69 6e28          u = min(
-00010ec0: 7531 2c20 7532 290a 2020 2020 2020 2020  u1, u2).        
-00010ed0: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
-00010ee0: 7769 6e64 6f77 5f73 7461 7274 3a77 696e  window_start:win
-00010ef0: 646f 775f 656e 642c 2069 5d20 3d20 750a  dow_end, i] = u.
-00010f00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010f10: 7265 7375 6c74 730a 0a20 2020 2064 6566  results..    def
-00010f20: 2063 686f 775f 7465 7374 2873 656c 6629   chow_test(self)
-00010f30: 3a0a 2020 2020 2020 2020 7061 7373 0a0a  :.        pass..
-00010f40: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00010f50: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
-00010f60: 6f61 7433 325b 3a5d 2c20 666c 6f61 7433  oat32[:], float3
-00010f70: 325b 3a5d 2c20 666c 6f61 7436 345b 3a5d  2[:], float64[:]
-00010f80: 2c20 696e 7436 3429 2229 0a20 2020 2064  , int64)").    d
-00010f90: 6566 2073 6c69 6469 6e67 5f73 7065 6172  ef sliding_spear
-00010fa0: 6d61 6e5f 7261 6e6b 5f63 6f72 7265 6c61  man_rank_correla
-00010fb0: 7469 6f6e 280a 2020 2020 2020 2020 7361  tion(.        sa
-00010fc0: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
-00010fd0: 6179 2c20 7361 6d70 6c65 5f32 3a20 6e70  ay, sample_2: np
-00010fe0: 2e6e 6461 7272 6179 2c20 7469 6d65 5f77  .ndarray, time_w
-00010ff0: 696e 646f 7773 3a20 6e70 2e6e 6461 7272  indows: np.ndarr
-00011000: 6179 2c20 6670 733a 2069 6e74 0a20 2020  ay, fps: int.   
-00011010: 2029 202d 3e20 6e70 2e6e 6461 7272 6179   ) -> np.ndarray
-00011020: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00011030: 2020 2020 2020 4769 7665 6e20 7477 6f20        Given two 
-00011040: 3144 2061 7272 6179 7320 6f66 2073 697a  1D arrays of siz
-00011050: 6520 4e2c 2063 7265 6174 6520 736c 6964  e N, create slid
-00011060: 696e 6720 7769 6e64 6f77 206f 6620 7369  ing window of si
-00011070: 7a65 2074 696d 655f 7769 6e64 6f77 735b  ze time_windows[
-00011080: 695d 202a 2066 7073 2061 6e64 2072 6574  i] * fps and ret
-00011090: 7572 6e20 5370 6561 726d 616e 2773 2072  urn Spearman's r
-000110a0: 616e 6b20 636f 7272 656c 6174 696f 6e0a  ank correlation.
-000110b0: 2020 2020 2020 2020 6265 7477 6565 6e20          between 
-000110c0: 7468 6520 7661 6c75 6573 2069 6e20 7468  the values in th
-000110d0: 6520 7477 6f20 3144 2061 7272 6179 7320  e two 1D arrays 
-000110e0: 696e 2065 6163 6820 7769 6e64 6f77 2e20  in each window. 
-000110f0: 4164 6472 6573 7320 2277 6861 7420 6973  Address "what is
-00011100: 2074 6865 2063 6f72 7265 6c61 7469 6f6e   the correlation
-00011110: 2062 6574 7765 656e 2046 6561 7475 7265   between Feature
-00011120: 2031 2061 6e64 0a20 2020 2020 2020 2046   1 and.        F
-00011130: 6561 7475 7265 2032 2069 6e20 7468 6520  eature 2 in the 
-00011140: 6375 7272 656e 7420 582e 5820 7365 636f  current X.X seco
-00011150: 6e64 7320 6f66 2074 6865 2076 6964 656f  nds of the video
-00011160: 2e0a 0a20 2020 2020 2020 202e 2e20 696d  ...        .. im
-00011170: 6167 653a 3a20 5f73 7461 7469 632f 696d  age:: _static/im
-00011180: 672f 736c 6964 696e 675f 7370 6561 726d  g/sliding_spearm
-00011190: 616e 2e70 6e67 0a20 2020 2020 2020 2020  an.png.         
-000111a0: 2020 3a77 6964 7468 3a20 3630 300a 2020    :width: 600.  
-000111b0: 2020 2020 2020 2020 203a 616c 6967 6e3a           :align:
-000111c0: 2063 656e 7465 720a 0a20 2020 2020 2020   center..       
-000111d0: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
-000111e0: 7261 7920 7361 6d70 6c65 5f31 3a20 4669  ray sample_1: Fi
-000111f0: 7273 7420 3144 2061 7272 6179 2077 6974  rst 1D array wit
-00011200: 6820 6665 6174 7572 6520 7661 6c75 6573  h feature values
-00011210: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00011220: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
-00011230: 706c 655f 313a 2053 6563 6f6e 6420 3144  ple_1: Second 1D
-00011240: 2061 7272 6179 2077 6974 6820 6665 6174   array with feat
-00011250: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
-00011260: 2020 2020 3a70 6172 616d 6574 6572 2066      :parameter f
-00011270: 6c6f 6174 2074 696d 655f 7769 6e64 6f77  loat time_window
-00011280: 733a 2054 6865 206c 656e 6774 6820 6f66  s: The length of
-00011290: 2074 6865 2073 6c69 6469 6e67 2077 696e   the sliding win
-000112a0: 646f 7720 696e 2073 6563 6f6e 6473 2e0a  dow in seconds..
-000112b0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-000112c0: 6572 2069 6e74 2066 7073 3a20 5468 6520  er int fps: The 
-000112d0: 6670 7320 6f66 2074 6865 2072 6563 6f72  fps of the recor
-000112e0: 6465 6420 7669 6465 6f2e 0a20 2020 2020  ded video..     
-000112f0: 2020 203a 7265 7475 726e 7320 6e70 2e6e     :returns np.n
-00011300: 6461 7272 6179 3a20 3264 2061 7272 6179  darray: 2d array
-00011310: 206f 6620 536f 6561 726d 616e 2773 2072   of Soearman's r
-00011320: 616e 6b73 206f 6620 7369 7a65 206c 656e  anks of size len
-00011330: 2873 616d 706c 655f 3129 2078 206c 656e  (sample_1) x len
-00011340: 2874 696d 655f 7769 6e64 6f77 7329 2e20  (time_windows). 
-00011350: 4e6f 7465 2c20 6966 2073 6c69 6469 6e67  Note, if sliding
-00011360: 2077 696e 646f 7720 6973 2031 3020 6672   window is 10 fr
-00011370: 616d 6573 2c20 7468 6520 6669 7273 7420  ames, the first 
-00011380: 3920 656e 7472 6965 7320 7769 6c6c 2062  9 entries will b
-00011390: 6520 6669 6c6c 6564 2077 6974 6820 302e  e filled with 0.
-000113a0: 2054 6865 2031 3074 6820 7661 6c75 6520   The 10th value 
-000113b0: 7265 7072 6573 656e 7473 2074 6865 2063  represents the c
-000113c0: 6f72 7265 6c61 7469 6f6e 2069 6e20 7468  orrelation in th
-000113d0: 6520 6669 7273 7420 3130 2066 7261 6d65  e first 10 frame
-000113e0: 732e 0a0a 2020 2020 2020 2020 3a65 7861  s...        :exa
-000113f0: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00011400: 3e20 7361 6d70 6c65 5f31 203d 206e 702e  > sample_1 = np.
-00011410: 6172 7261 7928 5b39 2c31 302c 3133 2c32  array([9,10,13,2
-00011420: 322c 3135 2c31 382c 3135 2c31 392c 3332  2,15,18,15,19,32
-00011430: 2c31 315d 292e 6173 7479 7065 286e 702e  ,11]).astype(np.
-00011440: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
-00011450: 203e 3e3e 2073 616d 706c 655f 3220 3d20   >>> sample_2 = 
-00011460: 6e70 2e61 7272 6179 285b 3131 2c20 3132  np.array([11, 12
-00011470: 2c20 3135 2c20 3139 2c20 3231 2c20 3236  , 15, 19, 21, 26
-00011480: 2c20 3139 2c20 3230 2c20 3232 2c20 3139  , 19, 20, 22, 19
-00011490: 5d29 2e61 7374 7970 6528 6e70 2e66 6c6f  ]).astype(np.flo
-000114a0: 6174 3332 290a 2020 2020 2020 2020 3e3e  at32).        >>
-000114b0: 3e20 5374 6174 6973 7469 6373 2829 2e73  > Statistics().s
-000114c0: 6c69 6469 6e67 5f73 7065 6172 6d61 6e5f  liding_spearman_
-000114d0: 7261 6e6b 5f63 6f72 7265 6c61 7469 6f6e  rank_correlation
-000114e0: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-000114f0: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-00011500: 706c 655f 322c 2074 696d 655f 7769 6e64  ple_2, time_wind
-00011510: 6f77 733d 6e70 2e61 7272 6179 285b 302e  ows=np.array([0.
-00011520: 355d 292c 2066 7073 3d31 3029 0a20 2020  5]), fps=10).   
-00011530: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00011540: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
-00011550: 756c 6c28 2873 616d 706c 655f 312e 7368  ull((sample_1.sh
-00011560: 6170 655b 305d 2c20 7469 6d65 5f77 696e  ape[0], time_win
-00011570: 646f 7773 2e73 6861 7065 5b30 5d29 2c20  dows.shape[0]), 
-00011580: 302e 3029 0a20 2020 2020 2020 2066 6f72  0.0).        for
-00011590: 2069 2069 6e20 7072 616e 6765 2874 696d   i in prange(tim
-000115a0: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
-000115b0: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
-000115c0: 2077 696e 646f 775f 7369 7a65 203d 2069   window_size = i
-000115d0: 6e74 2874 696d 655f 7769 6e64 6f77 735b  nt(time_windows[
-000115e0: 695d 202a 2066 7073 290a 2020 2020 2020  i] * fps).      
-000115f0: 2020 2020 2020 666f 7220 6c65 6674 2c20        for left, 
-00011600: 7269 6768 7420 696e 207a 6970 280a 2020  right in zip(.  
-00011610: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00011620: 616e 6765 2830 2c20 7361 6d70 6c65 5f31  ange(0, sample_1
-00011630: 2e73 6861 7065 5b30 5d20 2b20 3129 2c0a  .shape[0] + 1),.
-00011640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011650: 7072 616e 6765 2877 696e 646f 775f 7369  prange(window_si
-00011660: 7a65 2c20 7361 6d70 6c65 5f31 2e73 6861  ze, sample_1.sha
-00011670: 7065 5b30 5d20 2b20 3129 2c0a 2020 2020  pe[0] + 1),.    
-00011680: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00011690: 2020 2020 2020 2020 2020 2073 312c 2073             s1, s
-000116a0: 3220 3d20 7361 6d70 6c65 5f31 5b6c 6566  2 = sample_1[lef
-000116b0: 743a 7269 6768 745d 2c20 7361 6d70 6c65  t:right], sample
-000116c0: 5f32 5b6c 6566 743a 7269 6768 745d 0a20  _2[left:right]. 
-000116d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000116e0: 616e 6b5f 782c 2072 616e 6b5f 7920 3d20  ank_x, rank_y = 
-000116f0: 6e70 2e61 7267 736f 7274 286e 702e 6172  np.argsort(np.ar
-00011700: 6773 6f72 7428 7331 2929 2c20 6e70 2e61  gsort(s1)), np.a
-00011710: 7267 736f 7274 286e 702e 6172 6773 6f72  rgsort(np.argsor
-00011720: 7428 7332 2929 0a20 2020 2020 2020 2020  t(s2)).         
-00011730: 2020 2020 2020 2064 5f73 7175 6172 6564         d_squared
-00011740: 203d 206e 702e 7375 6d28 2872 616e 6b5f   = np.sum((rank_
-00011750: 7820 2d20 7261 6e6b 5f79 2920 2a2a 2032  x - rank_y) ** 2
-00011760: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00011770: 2020 7320 3d20 3120 2d20 2836 202a 2064    s = 1 - (6 * d
-00011780: 5f73 7175 6172 6564 2920 2f20 286c 656e  _squared) / (len
-00011790: 2873 3129 202a 2028 6c65 6e28 7332 2920  (s1) * (len(s2) 
-000117a0: 2a2a 2032 202d 2031 2929 0a20 2020 2020  ** 2 - 1)).     
-000117b0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000117c0: 7473 5b72 6967 6874 202d 2031 2c20 695d  ts[right - 1, i]
-000117d0: 203d 2073 0a0a 2020 2020 2020 2020 7265   = s..        re
-000117e0: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
-000117f0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00011800: 2020 2020 406e 6a69 7428 2228 666c 6f61      @njit("(floa
-00011810: 7433 325b 3a5d 2c20 666c 6f61 7436 342c  t32[:], float64,
-00011820: 2066 6c6f 6174 3634 2c20 666c 6f61 7436   float64, float6
-00011830: 3429 2229 0a20 2020 2064 6566 2073 6c69  4)").    def sli
-00011840: 6469 6e67 5f61 7574 6f63 6f72 7265 6c61  ding_autocorrela
-00011850: 7469 6f6e 280a 2020 2020 2020 2020 6461  tion(.        da
-00011860: 7461 3a20 6e70 2e6e 6461 7272 6179 2c20  ta: np.ndarray, 
-00011870: 6d61 785f 6c61 673a 2066 6c6f 6174 2c20  max_lag: float, 
-00011880: 7469 6d65 5f77 696e 646f 773a 2066 6c6f  time_window: flo
-00011890: 6174 2c20 6670 733a 2066 6c6f 6174 0a20  at, fps: float. 
-000118a0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-000118b0: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
-000118c0: 2063 6f6d 7075 7465 206f 6620 736c 6964   compute of slid
-000118d0: 696e 6720 6175 746f 2d63 6f72 7265 6c61  ing auto-correla
-000118e0: 7469 6f6e 7320 2874 6865 2063 6f72 7265  tions (the corre
-000118f0: 6c61 7469 6f6e 206f 6620 6120 6665 6174  lation of a feat
-00011900: 7572 6520 7769 7468 2069 7473 656c 6620  ure with itself 
-00011910: 7573 696e 6720 6c61 6767 6564 2077 696e  using lagged win
-00011920: 646f 7773 292e 0a0a 2020 2020 2020 2020  dows)...        
-00011930: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-00011940: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
-00011950: 6172 7261 7928 5b30 2c31 2c32 2c33 2c34  array([0,1,2,3,4
-00011960: 2c20 352c 362c 372c 382c 312c 3130 2c31  , 5,6,7,8,1,10,1
-00011970: 312c 3132 2c31 332c 3134 5d29 2e61 7374  1,12,13,14]).ast
-00011980: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-00011990: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
-000119a0: 6973 7469 6373 2829 2e73 6c69 6469 6e67  istics().sliding
-000119b0: 5f61 7574 6f63 6f72 7265 6c61 7469 6f6e  _autocorrelation
-000119c0: 2864 6174 613d 6461 7461 2c20 6d61 785f  (data=data, max_
-000119d0: 6c61 673d 302e 352c 2074 696d 655f 7769  lag=0.5, time_wi
-000119e0: 6e64 6f77 3d31 2e30 2c20 6670 733d 3130  ndow=1.0, fps=10
-000119f0: 290a 2020 2020 2020 2020 3e3e 3e20 5b20  ).        >>> [ 
-00011a00: 302e 2c20 302e 2c20 302e 2c20 2030 2e2c  0., 0., 0.,  0.,
-00011a10: 2020 302e 2c20 302e 2c20 302e 2c20 2030    0., 0., 0.,  0
-00011a20: 2e20 2c20 2030 2e2c 202d 332e 3638 362c  . ,  0., -3.686,
-00011a30: 202d 322e 3032 392c 202d 312e 3332 332c   -2.029, -1.323,
-00011a40: 202d 312e 3735 332c 202d 332e 3830 372c   -1.753, -3.807,
-00011a50: 202d 342e 3633 345d 0a20 2020 2020 2020   -4.634].       
-00011a60: 2022 2222 0a0a 2020 2020 2020 2020 6d61   """..        ma
-00011a70: 785f 6672 6d5f 6c61 672c 2074 696d 655f  x_frm_lag, time_
-00011a80: 7769 6e64 6f77 5f66 726d 7320 3d20 696e  window_frms = in
-00011a90: 7428 6d61 785f 6c61 6720 2a20 6670 7329  t(max_lag * fps)
-00011aa0: 2c20 696e 7428 7469 6d65 5f77 696e 646f  , int(time_windo
-00011ab0: 7720 2a20 6670 7329 0a20 2020 2020 2020  w * fps).       
-00011ac0: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
-00011ad0: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
-00011ae0: 5d29 2c20 2d31 2e30 290a 2020 2020 2020  ]), -1.0).      
-00011af0: 2020 666f 7220 7269 6768 7420 696e 2070    for right in p
-00011b00: 7261 6e67 6528 7469 6d65 5f77 696e 646f  range(time_windo
-00011b10: 775f 6672 6d73 202d 2031 2c20 6461 7461  w_frms - 1, data
-00011b20: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
-00011b30: 2020 2020 2020 2020 6c65 6674 203d 2072          left = r
-00011b40: 6967 6874 202d 2074 696d 655f 7769 6e64  ight - time_wind
-00011b50: 6f77 5f66 726d 7320 2b20 310a 2020 2020  ow_frms + 1.    
-00011b60: 2020 2020 2020 2020 775f 6461 7461 203d          w_data =
-00011b70: 2064 6174 615b 6c65 6674 203a 2072 6967   data[left : rig
-00011b80: 6874 202b 2031 5d0a 2020 2020 2020 2020  ht + 1].        
-00011b90: 2020 2020 636f 7272 6366 7320 3d20 6e70      corrcfs = np
-00011ba0: 2e66 756c 6c28 286d 6178 5f66 726d 5f6c  .full((max_frm_l
-00011bb0: 6167 292c 206e 702e 6e61 6e29 0a20 2020  ag), np.nan).   
-00011bc0: 2020 2020 2020 2020 2063 6f72 7263 6673           corrcfs
-00011bd0: 5b30 5d20 3d20 310a 2020 2020 2020 2020  [0] = 1.        
-00011be0: 2020 2020 666f 7220 7368 6966 7420 696e      for shift in
-00011bf0: 2072 616e 6765 2831 2c20 6d61 785f 6672   range(1, max_fr
-00011c00: 6d5f 6c61 6729 3a0a 2020 2020 2020 2020  m_lag):.        
-00011c10: 2020 2020 2020 2020 6320 3d20 6e70 2e63          c = np.c
-00011c20: 6f72 7263 6f65 6628 775f 6461 7461 5b3a  orrcoef(w_data[:
-00011c30: 2d73 6869 6674 5d2c 2077 5f64 6174 615b  -shift], w_data[
-00011c40: 7368 6966 743a 5d29 5b30 5d5b 315d 0a20  shift:])[0][1]. 
-00011c50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00011c60: 6620 6e70 2e69 736e 616e 2863 293a 0a20  f np.isnan(c):. 
-00011c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c80: 2020 2063 6f72 7263 6673 5b73 6869 6674     corrcfs[shift
-00011c90: 5d20 3d20 310a 2020 2020 2020 2020 2020  ] = 1.          
-00011ca0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00011cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011cc0: 636f 7272 6366 735b 7368 6966 745d 203d  corrcfs[shift] =
-00011cd0: 206e 702e 636f 7272 636f 6566 2877 5f64   np.corrcoef(w_d
-00011ce0: 6174 615b 3a2d 7368 6966 745d 2c20 775f  ata[:-shift], w_
-00011cf0: 6461 7461 5b73 6869 6674 3a5d 295b 305d  data[shift:])[0]
-00011d00: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-00011d10: 6d61 745f 203d 206e 702e 7a65 726f 7328  mat_ = np.zeros(
-00011d20: 7368 6170 653d 2863 6f72 7263 6673 2e73  shape=(corrcfs.s
-00011d30: 6861 7065 5b30 5d2c 2032 2929 0a20 2020  hape[0], 2)).   
-00011d40: 2020 2020 2020 2020 2063 6f6e 7374 203d           const =
-00011d50: 206e 702e 6f6e 6573 5f6c 696b 6528 636f   np.ones_like(co
-00011d60: 7272 6366 7329 0a20 2020 2020 2020 2020  rrcfs).         
-00011d70: 2020 206d 6174 5f5b 3a2c 2030 5d20 3d20     mat_[:, 0] = 
-00011d80: 636f 6e73 740a 2020 2020 2020 2020 2020  const.          
-00011d90: 2020 6d61 745f 5b3a 2c20 315d 203d 2063    mat_[:, 1] = c
-00011da0: 6f72 7263 6673 0a20 2020 2020 2020 2020  orrcfs.         
-00011db0: 2020 2064 6574 5f20 3d20 6e70 2e6c 696e     det_ = np.lin
-00011dc0: 616c 672e 6c73 7473 7128 0a20 2020 2020  alg.lstsq(.     
-00011dd0: 2020 2020 2020 2020 2020 206d 6174 5f2e             mat_.
-00011de0: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-00011df0: 3229 2c20 6e70 2e61 7261 6e67 6528 302c  2), np.arange(0,
-00011e00: 206d 6178 5f66 726d 5f6c 6167 292e 6173   max_frm_lag).as
-00011e10: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00011e20: 0a20 2020 2020 2020 2020 2020 2029 5b30  .            )[0
-00011e30: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
-00011e40: 7375 6c74 735b 7269 6768 745d 203d 2064  sults[right] = d
-00011e50: 6574 5f5b 3a3a 2d31 5d5b 305d 0a20 2020  et_[::-1][0].   
-00011e60: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-00011e70: 6c74 730a 0a20 2020 2040 7374 6174 6963  lts..    @static
-00011e80: 6d65 7468 6f64 0a20 2020 2064 6566 2073  method.    def s
-00011e90: 6c69 6469 6e67 5f64 6f6d 696e 616e 745f  liding_dominant_
-00011ea0: 6672 6571 7565 6e63 6965 7328 0a20 2020  frequencies(.   
-00011eb0: 2020 2020 2064 6174 613a 206e 702e 6e64       data: np.nd
-00011ec0: 6172 7261 792c 0a20 2020 2020 2020 2066  array,.        f
-00011ed0: 7073 3a20 666c 6f61 742c 0a20 2020 2020  ps: float,.     
-00011ee0: 2020 206b 3a20 696e 742c 0a20 2020 2020     k: int,.     
-00011ef0: 2020 2074 696d 655f 7769 6e64 6f77 733a     time_windows:
-00011f00: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
-00011f10: 2020 2020 2077 696e 646f 775f 6675 6e63       window_func
-00011f20: 7469 6f6e 3a20 4c69 7465 7261 6c5b 2248  tion: Literal["H
-00011f30: 616e 6e22 2c20 2248 616d 6d69 6e67 222c  ann", "Hamming",
-00011f40: 2022 426c 6163 6b6d 616e 225d 203d 204e   "Blackman"] = N
-00011f50: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-00011f60: 2020 2020 2222 2246 696e 6420 7468 6520      """Find the 
-00011f70: 4b20 646f 6d69 6e61 6e74 2066 7265 7175  K dominant frequ
-00011f80: 656e 6369 6573 2077 6974 6869 6e20 6120  encies within a 
-00011f90: 6665 6174 7572 6520 7665 6374 6f72 2075  feature vector u
-00011fa0: 7369 6e67 2073 6c69 6469 6e67 2077 696e  sing sliding win
-00011fb0: 646f 7773 2222 220a 0a20 2020 2020 2020  dows"""..       
-00011fc0: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
-00011fd0: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
-00011fe0: 5d2c 2074 696d 655f 7769 6e64 6f77 732e  ], time_windows.
-00011ff0: 7368 6170 655b 305d 292c 2030 2e30 290a  shape[0]), 0.0).
-00012000: 2020 2020 2020 2020 666f 7220 7469 6d65          for time
-00012010: 5f77 696e 646f 775f 636e 7420 696e 2072  _window_cnt in r
-00012020: 616e 6765 2874 696d 655f 7769 6e64 6f77  ange(time_window
-00012030: 732e 7368 6170 655b 305d 293a 0a20 2020  s.shape[0]):.   
-00012040: 2020 2020 2020 2020 2077 696e 646f 775f           window_
-00012050: 7369 7a65 203d 2069 6e74 2874 696d 655f  size = int(time_
-00012060: 7769 6e64 6f77 735b 7469 6d65 5f77 696e  windows[time_win
-00012070: 646f 775f 636e 745d 202a 2066 7073 290a  dow_cnt] * fps).
-00012080: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00012090: 6c65 6674 2c20 7269 6768 7420 696e 207a  left, right in z
-000120a0: 6970 280a 2020 2020 2020 2020 2020 2020  ip(.            
-000120b0: 2020 2020 7261 6e67 6528 302c 2064 6174      range(0, dat
-000120c0: 612e 7368 6170 655b 305d 202b 2031 292c  a.shape[0] + 1),
-000120d0: 2072 616e 6765 2877 696e 646f 775f 7369   range(window_si
-000120e0: 7a65 2c20 6461 7461 2e73 6861 7065 5b30  ze, data.shape[0
-000120f0: 5d20 2b20 3129 0a20 2020 2020 2020 2020  ] + 1).         
-00012100: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00012110: 2020 2020 2020 7769 6e64 6f77 5f64 6174        window_dat
-00012120: 6120 3d20 6461 7461 5b6c 6566 743a 7269  a = data[left:ri
-00012130: 6768 745d 0a20 2020 2020 2020 2020 2020  ght].           
-00012140: 2020 2020 2069 6620 7769 6e64 6f77 5f66       if window_f
-00012150: 756e 6374 696f 6e20 3d3d 2022 4861 6e6e  unction == "Hann
-00012160: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00012170: 2020 2020 2020 2077 696e 646f 775f 6461         window_da
-00012180: 7461 203d 2077 696e 646f 775f 6461 7461  ta = window_data
-00012190: 202a 206e 702e 6861 6e6e 696e 6728 6c65   * np.hanning(le
-000121a0: 6e28 7769 6e64 6f77 5f64 6174 6129 290a  n(window_data)).
-000121b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121c0: 656c 6966 2077 696e 646f 775f 6675 6e63  elif window_func
-000121d0: 7469 6f6e 203d 3d20 2248 616d 6d69 6e67  tion == "Hamming
-000121e0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-000121f0: 2020 2020 2020 2077 696e 646f 775f 6461         window_da
-00012200: 7461 203d 2077 696e 646f 775f 6461 7461  ta = window_data
-00012210: 202a 206e 702e 6861 6d6d 696e 6728 6c65   * np.hamming(le
-00012220: 6e28 7769 6e64 6f77 5f64 6174 6129 290a  n(window_data)).
-00012230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012240: 656c 6966 2077 696e 646f 775f 6675 6e63  elif window_func
-00012250: 7469 6f6e 203d 3d20 2242 6c61 636b 6d61  tion == "Blackma
-00012260: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
-00012270: 2020 2020 2020 2020 7769 6e64 6f77 5f64          window_d
-00012280: 6174 6120 3d20 7769 6e64 6f77 5f64 6174  ata = window_dat
-00012290: 6120 2a20 6e70 2e62 6c61 636b 6d61 6e28  a * np.blackman(
-000122a0: 6c65 6e28 7769 6e64 6f77 5f64 6174 6129  len(window_data)
-000122b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000122c0: 2020 6666 745f 7265 7375 6c74 203d 206e    fft_result = n
-000122d0: 702e 6666 742e 6666 7428 7769 6e64 6f77  p.fft.fft(window
-000122e0: 5f64 6174 6129 0a20 2020 2020 2020 2020  _data).         
-000122f0: 2020 2020 2020 2066 7265 7175 656e 6369         frequenci
-00012300: 6573 203d 206e 702e 6666 742e 6666 7466  es = np.fft.fftf
-00012310: 7265 7128 7769 6e64 6f77 5f64 6174 612e  req(window_data.
-00012320: 7368 6170 655b 305d 2c20 3120 2f20 6670  shape[0], 1 / fp
-00012330: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00012340: 2020 206d 6167 6e69 7475 6465 203d 206e     magnitude = n
-00012350: 702e 6162 7328 6666 745f 7265 7375 6c74  p.abs(fft_result
-00012360: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00012370: 2020 746f 705f 6b5f 6672 6571 7565 6e63    top_k_frequenc
-00012380: 7920 3d20 6672 6571 7565 6e63 6965 735b  y = frequencies[
-00012390: 6e70 2e61 7267 736f 7274 286d 6167 6e69  np.argsort(magni
-000123a0: 7475 6465 295b 2d28 6b20 2b20 3129 203a  tude)[-(k + 1) :
-000123b0: 202d 315d 5d0a 2020 2020 2020 2020 2020   -1]].          
-000123c0: 2020 2020 2020 7265 7375 6c74 735b 7269        results[ri
-000123d0: 6768 7420 2d20 315d 5b74 696d 655f 7769  ght - 1][time_wi
-000123e0: 6e64 6f77 5f63 6e74 5d20 3d20 746f 705f  ndow_cnt] = top_
-000123f0: 6b5f 6672 6571 7565 6e63 795b 305d 0a20  k_frequency[0]. 
-00012400: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00012410: 7375 6c74 730a 0a20 2020 2040 7374 6174  sults..    @stat
-00012420: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-00012430: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
-00012440: 2066 6c6f 6174 3332 5b3a 5d29 2229 0a20   float32[:])"). 
-00012450: 2020 2064 6566 206b 656e 6461 6c6c 5f74     def kendall_t
-00012460: 6175 2873 616d 706c 655f 313a 206e 702e  au(sample_1: np.
-00012470: 6e64 6172 7261 792c 2073 616d 706c 655f  ndarray, sample_
-00012480: 323a 206e 702e 6e64 6172 7261 7929 202d  2: np.ndarray) -
-00012490: 3e20 5475 706c 655b 666c 6f61 742c 2066  > Tuple[float, f
-000124a0: 6c6f 6174 5d3a 0a20 2020 2020 2020 2022  loat]:.        "
-000124b0: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-000124c0: 6420 4b65 6e64 616c 6c20 5461 7520 2872  d Kendall Tau (r
-000124d0: 616e 6b20 636f 7272 656c 6174 696f 6e20  ank correlation 
-000124e0: 636f 6566 6669 6369 656e 7429 2e20 4e6f  coefficient). No
-000124f0: 6e2d 7061 7261 6d65 7472 6963 206d 6574  n-parametric met
-00012500: 686f 6420 666f 7220 636f 6d70 7574 696e  hod for computin
-00012510: 6720 636f 7272 656c 6174 696f 6e0a 2020  g correlation.  
-00012520: 2020 2020 2020 6265 7477 6565 6e20 7477        between tw
-00012530: 6f20 7469 6d65 2d73 6572 6965 7320 6665  o time-series fe
-00012540: 6174 7572 6573 2e20 5265 7475 726e 7320  atures. Returns 
-00012550: 7461 7520 616e 6420 6173 736f 6369 6174  tau and associat
-00012560: 6564 207a 2d73 636f 7265 2e0a 0a20 2020  ed z-score...   
-00012570: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-00012580: 6e64 6172 7261 7920 7361 6d70 6c65 5f31  ndarray sample_1
-00012590: 3a20 4669 7273 7420 3144 2061 7272 6179  : First 1D array
-000125a0: 2077 6974 6820 6665 6174 7572 6520 7661   with feature va
-000125b0: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
-000125c0: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
-000125d0: 2073 616d 706c 655f 313a 2053 6563 6f6e   sample_1: Secon
-000125e0: 6420 3144 2061 7272 6179 2077 6974 6820  d 1D array with 
-000125f0: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
-00012600: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
-00012610: 2054 7570 6c65 5b66 6c6f 6174 2c20 666c   Tuple[float, fl
-00012620: 6f61 745d 3a20 4b65 6e64 616c 6c20 5461  oat]: Kendall Ta
-00012630: 7520 616e 6420 6173 736f 6369 6174 6564  u and associated
-00012640: 207a 2d73 636f 7265 2e0a 0a20 2020 2020   z-score...     
-00012650: 2020 203a 6578 616d 706c 6573 3a0a 2020     :examples:.  
-00012660: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
-00012670: 5f31 203d 206e 702e 6172 7261 7928 5b34  _1 = np.array([4
-00012680: 2c20 322c 2033 2c20 342c 2035 2c20 375d  , 2, 3, 4, 5, 7]
-00012690: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
-000126a0: 7433 3229 0a20 2020 2020 2020 203e 3e3e  t32).        >>>
-000126b0: 2073 616d 706c 655f 3220 3d20 6e70 2e61   sample_2 = np.a
-000126c0: 7272 6179 285b 312c 2032 2c20 332c 2034  rray([1, 2, 3, 4
-000126d0: 2c20 352c 2037 5d29 2e61 7374 7970 6528  , 5, 7]).astype(
-000126e0: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
-000126f0: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
-00012700: 6373 2829 2e6b 656e 6461 6c6c 5f74 6175  cs().kendall_tau
-00012710: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-00012720: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-00012730: 706c 655f 3229 0a20 2020 2020 2020 203e  ple_2).        >
-00012740: 3e3e 2028 302e 3733 3333 3333 3333 3333  >> (0.7333333333
-00012750: 3333 3333 3333 2c20 322e 3036 3635 3430  333333, 2.066540
-00012760: 3136 3035 3830 3939 3238 290a 0a20 2020  1605809928)..   
-00012770: 2020 2020 2052 6566 6572 656e 6365 730a       References.
-00012780: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00012790: 2d2d 0a20 2020 2020 2020 202e 2e20 5b31  --.        .. [1
-000127a0: 5d20 6053 7465 7068 616e 6965 2047 6c65  ] `Stephanie Gle
-000127b0: 6e2c 2022 4b65 6e64 616c 6ce2 8099 7320  n, "Kendall...s 
-000127c0: 5461 7520 284b 656e 6461 6c6c 2052 616e  Tau (Kendall Ran
-000127d0: 6b20 436f 7272 656c 6174 696f 6e20 436f  k Correlation Co
-000127e0: 6566 6669 6369 656e 7429 2220 203c 6874  efficient)"  <ht
-000127f0: 7470 733a 2f2f 7777 772e 7374 6174 6973  tps://www.statis
-00012800: 7469 6373 686f 7774 6f2e 636f 6d2f 6b65  ticshowto.com/ke
-00012810: 6e64 616c 6c73 2d74 6175 2f3e 605f 5f2e  ndalls-tau/>`__.
-00012820: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00012830: 2020 2020 2020 726e 6b73 203d 206e 702e        rnks = np.
-00012840: 6172 6773 6f72 7428 7361 6d70 6c65 5f31  argsort(sample_1
-00012850: 290a 2020 2020 2020 2020 7331 5f72 6e6b  ).        s1_rnk
-00012860: 2c20 7332 5f72 6e6b 203d 2073 616d 706c  , s2_rnk = sampl
-00012870: 655f 315b 726e 6b73 5d2c 2073 616d 706c  e_1[rnks], sampl
-00012880: 655f 325b 726e 6b73 5d0a 2020 2020 2020  e_2[rnks].      
-00012890: 2020 636e 6372 646e 745f 636e 7473 2c20    cncrdnt_cnts, 
-000128a0: 6473 6372 646e 745f 636e 7473 203d 206e  dscrdnt_cnts = n
-000128b0: 702e 6675 6c6c 2828 7331 5f72 6e6b 2e73  p.full((s1_rnk.s
-000128c0: 6861 7065 5b30 5d20 2d20 3129 2c20 6e70  hape[0] - 1), np
-000128d0: 2e6e 616e 292c 206e 702e 6675 6c6c 280a  .nan), np.full(.
-000128e0: 2020 2020 2020 2020 2020 2020 2873 315f              (s1_
-000128f0: 726e 6b2e 7368 6170 655b 305d 202d 2031  rnk.shape[0] - 1
-00012900: 292c 206e 702e 6e61 6e0a 2020 2020 2020  ), np.nan.      
-00012910: 2020 290a 2020 2020 2020 2020 666f 7220    ).        for 
-00012920: 6920 696e 2072 616e 6765 2873 325f 726e  i in range(s2_rn
-00012930: 6b2e 7368 6170 655b 305d 202d 2031 293a  k.shape[0] - 1):
-00012940: 0a20 2020 2020 2020 2020 2020 2063 6e63  .            cnc
-00012950: 7264 6e74 5f63 6e74 735b 695d 203d 2028  rdnt_cnts[i] = (
-00012960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012970: 206e 702e 6172 6777 6865 7265 2873 325f   np.argwhere(s2_
-00012980: 726e 6b5b 6920 2b20 3120 3a5d 203e 2073  rnk[i + 1 :] > s
-00012990: 325f 726e 6b5b 695d 292e 666c 6174 7465  2_rnk[i]).flatte
-000129a0: 6e28 292e 7368 6170 655b 305d 0a20 2020  n().shape[0].   
-000129b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000129c0: 2020 2020 2020 2064 7363 7264 6e74 5f63         dscrdnt_c
-000129d0: 6e74 735b 695d 203d 2028 0a20 2020 2020  nts[i] = (.     
-000129e0: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-000129f0: 6777 6865 7265 2873 325f 726e 6b5b 6920  gwhere(s2_rnk[i 
-00012a00: 2b20 3120 3a5d 203c 2073 325f 726e 6b5b  + 1 :] < s2_rnk[
-00012a10: 695d 292e 666c 6174 7465 6e28 292e 7368  i]).flatten().sh
-00012a20: 6170 655b 305d 0a20 2020 2020 2020 2020  ape[0].         
-00012a30: 2020 2029 0a20 2020 2020 2020 2074 203d     ).        t =
-00012a40: 2028 6e70 2e73 756d 2863 6e63 7264 6e74   (np.sum(cncrdnt
-00012a50: 5f63 6e74 7329 202d 206e 702e 7375 6d28  _cnts) - np.sum(
-00012a60: 6473 6372 646e 745f 636e 7473 2929 202f  dscrdnt_cnts)) /
-00012a70: 2028 0a20 2020 2020 2020 2020 2020 206e   (.            n
-00012a80: 702e 7375 6d28 636e 6372 646e 745f 636e  p.sum(cncrdnt_cn
-00012a90: 7473 2920 2b20 6e70 2e73 756d 2864 7363  ts) + np.sum(dsc
-00012aa0: 7264 6e74 5f63 6e74 7329 0a20 2020 2020  rdnt_cnts).     
-00012ab0: 2020 2029 0a20 2020 2020 2020 207a 203d     ).        z =
-00012ac0: 2028 0a20 2020 2020 2020 2020 2020 2033   (.            3
-00012ad0: 0a20 2020 2020 2020 2020 2020 202a 2074  .            * t
-00012ae0: 0a20 2020 2020 2020 2020 2020 202a 2028  .            * (
-00012af0: 6e70 2e73 7172 7428 7331 5f72 6e6b 2e73  np.sqrt(s1_rnk.s
-00012b00: 6861 7065 5b30 5d20 2a20 2873 315f 726e  hape[0] * (s1_rn
-00012b10: 6b2e 7368 6170 655b 305d 202d 2031 2929  k.shape[0] - 1))
-00012b20: 290a 2020 2020 2020 2020 2020 2020 2f20  ).            / 
-00012b30: 6e70 2e73 7172 7428 3220 2a20 2828 3220  np.sqrt(2 * ((2 
-00012b40: 2a20 7331 5f72 6e6b 2e73 6861 7065 5b30  * s1_rnk.shape[0
-00012b50: 5d29 202b 2035 2929 0a20 2020 2020 2020  ]) + 5)).       
-00012b60: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
-00012b70: 726e 2074 2c20 7a0a 0a20 2020 2040 7374  rn t, z..    @st
-00012b80: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-00012b90: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
-00012ba0: 5d2c 2066 6c6f 6174 3332 5b3a 5d2c 2066  ], float32[:], f
-00012bb0: 6c6f 6174 3634 5b3a 5d2c 2069 6e74 3634  loat64[:], int64
-00012bc0: 2922 290a 2020 2020 6465 6620 736c 6964  )").    def slid
-00012bd0: 696e 675f 6b65 6e64 616c 6c5f 7461 7528  ing_kendall_tau(
-00012be0: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
-00012bf0: 313a 206e 702e 6e64 6172 7261 792c 2073  1: np.ndarray, s
-00012c00: 616d 706c 655f 323a 206e 702e 6e64 6172  ample_2: np.ndar
-00012c10: 7261 792c 2074 696d 655f 7769 6e64 6f77  ray, time_window
-00012c20: 733a 206e 702e 6e64 6172 7261 792c 2066  s: np.ndarray, f
-00012c30: 7073 3a20 666c 6f61 740a 2020 2020 2920  ps: float.    ) 
-00012c40: 2d3e 206e 702e 6e64 6172 7261 793a 0a20  -> np.ndarray:. 
-00012c50: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00012c60: 2020 2043 6f6d 7075 7465 2073 6c69 6469     Compute slidi
-00012c70: 6e67 204b 656e 6461 6c6c 2773 2054 6175  ng Kendall's Tau
-00012c80: 2063 6f72 7265 6c61 7469 6f6e 2063 6f65   correlation coe
-00012c90: 6666 6963 6965 6e74 2e0a 0a20 2020 2020  fficient...     
-00012ca0: 2020 2043 616c 6375 6c61 7465 7320 4b65     Calculates Ke
-00012cb0: 6e64 616c 6c27 7320 5461 7520 636f 7272  ndall's Tau corr
-00012cc0: 656c 6174 696f 6e20 636f 6566 6669 6369  elation coeffici
-00012cd0: 656e 7420 6265 7477 6565 6e20 7477 6f20  ent between two 
-00012ce0: 7361 6d70 6c65 7320 6f76 6572 2073 6c69  samples over sli
-00012cf0: 6469 6e67 2074 696d 6520 7769 6e64 6f77  ding time window
-00012d00: 732e 204b 656e 6461 6c6c 2773 2054 6175  s. Kendall's Tau
-00012d10: 2069 7320 6120 6d65 6173 7572 6520 6f66   is a measure of
-00012d20: 2063 6f72 7265 6c61 7469 6f6e 2062 6574   correlation bet
-00012d30: 7765 656e 2074 776f 2072 616e 6b65 6420  ween two ranked 
-00012d40: 6461 7461 7365 7473 2e0a 0a20 2020 2020  datasets...     
-00012d50: 2020 2054 6865 2063 6f6d 7075 7461 7469     The computati
-00012d60: 6f6e 2069 7320 6261 7365 6420 6f6e 2074  on is based on t
-00012d70: 6865 2066 6f72 6d75 6c61 3a0a 0a20 2020  he formula:..   
-00012d80: 2020 2020 202e 2e20 6d61 7468 3a3a 0a0a       .. math::..
-00012d90: 2020 2020 2020 2020 2020 205c 5c74 6175             \\tau
-00012da0: 203d 205c 5c66 7261 637b 7b5c 5c74 6578   = \\frac{{\\tex
-00012db0: 747b 7b63 6f6e 636f 7264 616e 7420 7061  t{{concordant pa
-00012dc0: 6972 737d 7d20 2d20 5c5c 7465 7874 7b7b  irs}} - \\text{{
-00012dd0: 6469 7363 6f72 6461 6e74 2070 6169 7273  discordant pairs
-00012de0: 7d7d 7d7d 7b7b 5c5c 7465 7874 7b7b 636f  }}}}{{\\text{{co
-00012df0: 6e63 6f72 6461 6e74 2070 6169 7273 7d7d  ncordant pairs}}
-00012e00: 202b 205c 5c74 6578 747b 7b64 6973 636f   + \\text{{disco
-00012e10: 7264 616e 7420 7061 6972 737d 7d7d 7d0a  rdant pairs}}}}.
-00012e20: 0a20 2020 2020 2020 2077 6865 7265 2063  .        where c
-00012e30: 6f6e 636f 7264 616e 7420 7061 6972 7320  oncordant pairs 
-00012e40: 6172 6520 7061 6972 7320 6f66 2065 6c65  are pairs of ele
-00012e50: 6d65 6e74 7320 7769 7468 2074 6865 2073  ments with the s
-00012e60: 616d 6520 6f72 6465 7220 696e 2062 6f74  ame order in bot
-00012e70: 6820 7361 6d70 6c65 732c 2061 6e64 2064  h samples, and d
-00012e80: 6973 636f 7264 616e 7420 7061 6972 7320  iscordant pairs 
-00012e90: 6172 6520 7061 6972 7320 7769 7468 2064  are pairs with d
-00012ea0: 6966 6665 7265 6e74 206f 7264 6572 732e  ifferent orders.
-00012eb0: 0a0a 2020 2020 2020 2020 5265 6665 7265  ..        Refere
-00012ec0: 6e63 6573 0a20 2020 2020 2020 202d 2d2d  nces.        ---
-00012ed0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00012ee0: 2e2e 205b 315d 2060 5374 6570 6861 6e69  .. [1] `Stephani
-00012ef0: 6520 476c 656e 2c20 224b 656e 6461 6c6c  e Glen, "Kendall
-00012f00: e280 9973 2054 6175 2028 4b65 6e64 616c  ...s Tau (Kendal
-00012f10: 6c20 5261 6e6b 2043 6f72 7265 6c61 7469  l Rank Correlati
-00012f20: 6f6e 2043 6f65 6666 6963 6965 6e74 2922  on Coefficient)"
-00012f30: 2020 3c68 7474 7073 3a2f 2f77 7777 2e73    <https://www.s
-00012f40: 7461 7469 7374 6963 7368 6f77 746f 2e63  tatisticshowto.c
-00012f50: 6f6d 2f6b 656e 6461 6c6c 732d 7461 752f  om/kendalls-tau/
-00012f60: 3e60 5f5f 2e0a 0a0a 2020 2020 2020 2020  >`__....        
-00012f70: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00012f80: 7920 7361 6d70 6c65 5f31 3a20 4669 7273  y sample_1: Firs
-00012f90: 7420 7361 6d70 6c65 2066 6f72 2063 6f6d  t sample for com
-00012fa0: 7061 7269 736f 6e2e 0a20 2020 2020 2020  parison..       
-00012fb0: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
-00012fc0: 6179 2073 616d 706c 655f 323a 2053 6563  ay sample_2: Sec
-00012fd0: 6f6e 6420 7361 6d70 6c65 2066 6f72 2063  ond sample for c
-00012fe0: 6f6d 7061 7269 736f 6e2e 0a20 2020 2020  omparison..     
-00012ff0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00013000: 7272 6179 2074 696d 655f 7769 6e64 6f77  rray time_window
-00013010: 733a 2052 6f6c 6c69 6e67 2074 696d 6520  s: Rolling time 
-00013020: 7769 6e64 6f77 7320 696e 2073 6563 6f6e  windows in secon
-00013030: 6473 2e0a 2020 2020 2020 2020 3a70 6172  ds..        :par
-00013040: 616d 2066 6c6f 6174 2066 7073 3a20 4672  am float fps: Fr
-00013050: 616d 6573 2070 6572 2073 6563 6f6e 6420  ames per second 
-00013060: 2846 5053 2920 6f66 2074 6865 2072 6563  (FPS) of the rec
-00013070: 6f72 6465 6420 7669 6465 6f2e 0a20 2020  orded video..   
-00013080: 2020 2020 203a 7265 7475 726e 3a20 4172       :return: Ar
-00013090: 7261 7920 6f66 204b 656e 6461 6c6c 2773  ray of Kendall's
-000130a0: 2054 6175 2063 6f72 7265 6c61 7469 6f6e   Tau correlation
-000130b0: 2063 6f65 6666 6963 6965 6e74 7320 636f   coefficients co
-000130c0: 7272 6573 706f 6e64 696e 6720 746f 2065  rresponding to e
-000130d0: 6163 6820 7469 6d65 2077 696e 646f 772e  ach time window.
-000130e0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-000130f0: 2020 2020 2020 7265 7375 6c74 7320 3d20        results = 
-00013100: 6e70 2e66 756c 6c28 2873 616d 706c 655f  np.full((sample_
-00013110: 312e 7368 6170 655b 305d 2c20 7469 6d65  1.shape[0], time
-00013120: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
-00013130: 5d29 2c20 302e 3029 0a20 2020 2020 2020  ]), 0.0).       
-00013140: 2066 6f72 2074 696d 655f 7769 6e64 6f77   for time_window
-00013150: 5f63 6e74 2069 6e20 7261 6e67 6528 7469  _cnt in range(ti
-00013160: 6d65 5f77 696e 646f 7773 2e73 6861 7065  me_windows.shape
-00013170: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
-00013180: 2020 7769 6e64 6f77 5f73 697a 6520 3d20    window_size = 
-00013190: 696e 7428 7469 6d65 5f77 696e 646f 7773  int(time_windows
-000131a0: 5b74 696d 655f 7769 6e64 6f77 5f63 6e74  [time_window_cnt
-000131b0: 5d20 2a20 6670 7329 0a20 2020 2020 2020  ] * fps).       
-000131c0: 2020 2020 2066 6f72 206c 6566 742c 2072       for left, r
-000131d0: 6967 6874 2069 6e20 7a69 7028 0a20 2020  ight in zip(.   
-000131e0: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-000131f0: 6765 2830 2c20 7361 6d70 6c65 5f31 2e73  ge(0, sample_1.s
-00013200: 6861 7065 5b30 5d20 2b20 3129 2c0a 2020  hape[0] + 1),.  
-00013210: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00013220: 6e67 6528 7769 6e64 6f77 5f73 697a 652c  nge(window_size,
-00013230: 2073 616d 706c 655f 312e 7368 6170 655b   sample_1.shape[
-00013240: 305d 202b 2031 292c 0a20 2020 2020 2020  0] + 1),.       
-00013250: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00013260: 2020 2020 2020 2020 736c 6963 6564 5f73          sliced_s
-00013270: 616d 706c 655f 312c 2073 6c69 6365 645f  ample_1, sliced_
-00013280: 7361 6d70 6c65 5f32 203d 2028 0a20 2020  sample_2 = (.   
-00013290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132a0: 2073 616d 706c 655f 315b 6c65 6674 3a72   sample_1[left:r
-000132b0: 6967 6874 5d2c 0a20 2020 2020 2020 2020  ight],.         
-000132c0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
-000132d0: 655f 325b 6c65 6674 3a72 6967 6874 5d2c  e_2[left:right],
-000132e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000132f0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00013300: 2020 2072 6e6b 7320 3d20 6e70 2e61 7267     rnks = np.arg
-00013310: 736f 7274 2873 6c69 6365 645f 7361 6d70  sort(sliced_samp
-00013320: 6c65 5f31 290a 2020 2020 2020 2020 2020  le_1).          
-00013330: 2020 2020 2020 7331 5f72 6e6b 2c20 7332        s1_rnk, s2
-00013340: 5f72 6e6b 203d 2073 6c69 6365 645f 7361  _rnk = sliced_sa
-00013350: 6d70 6c65 5f31 5b72 6e6b 735d 2c20 736c  mple_1[rnks], sl
-00013360: 6963 6564 5f73 616d 706c 655f 325b 726e  iced_sample_2[rn
-00013370: 6b73 5d0a 2020 2020 2020 2020 2020 2020  ks].            
-00013380: 2020 2020 636e 6372 646e 745f 636e 7473      cncrdnt_cnts
-00013390: 2c20 6473 6372 646e 745f 636e 7473 203d  , dscrdnt_cnts =
-000133a0: 206e 702e 6675 6c6c 280a 2020 2020 2020   np.full(.      
-000133b0: 2020 2020 2020 2020 2020 2020 2020 2873                (s
-000133c0: 315f 726e 6b2e 7368 6170 655b 305d 202d  1_rnk.shape[0] -
-000133d0: 2031 292c 206e 702e 6e61 6e0a 2020 2020   1), np.nan.    
-000133e0: 2020 2020 2020 2020 2020 2020 292c 206e              ), n
-000133f0: 702e 6675 6c6c 2828 7331 5f72 6e6b 2e73  p.full((s1_rnk.s
-00013400: 6861 7065 5b30 5d20 2d20 3129 2c20 6e70  hape[0] - 1), np
-00013410: 2e6e 616e 290a 2020 2020 2020 2020 2020  .nan).          
-00013420: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00013430: 616e 6765 2873 325f 726e 6b2e 7368 6170  ange(s2_rnk.shap
-00013440: 655b 305d 202d 2031 293a 0a20 2020 2020  e[0] - 1):.     
-00013450: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013460: 6e63 7264 6e74 5f63 6e74 735b 695d 203d  ncrdnt_cnts[i] =
-00013470: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00013480: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-00013490: 6777 6865 7265 2873 325f 726e 6b5b 6920  gwhere(s2_rnk[i 
-000134a0: 2b20 3120 3a5d 203e 2073 325f 726e 6b5b  + 1 :] > s2_rnk[
-000134b0: 695d 292e 666c 6174 7465 6e28 292e 7368  i]).flatten().sh
-000134c0: 6170 655b 305d 0a20 2020 2020 2020 2020  ape[0].         
-000134d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000134e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134f0: 2064 7363 7264 6e74 5f63 6e74 735b 695d   dscrdnt_cnts[i]
-00013500: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00013510: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-00013520: 6172 6777 6865 7265 2873 325f 726e 6b5b  argwhere(s2_rnk[
-00013530: 6920 2b20 3120 3a5d 203c 2073 325f 726e  i + 1 :] < s2_rn
-00013540: 6b5b 695d 292e 666c 6174 7465 6e28 292e  k[i]).flatten().
-00013550: 7368 6170 655b 305d 0a20 2020 2020 2020  shape[0].       
-00013560: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00013570: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00013580: 6573 756c 7473 5b72 6967 6874 5d5b 7469  esults[right][ti
-00013590: 6d65 5f77 696e 646f 775f 636e 745d 203d  me_window_cnt] =
-000135a0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-000135b0: 2020 2020 2020 206e 702e 7375 6d28 636e         np.sum(cn
-000135c0: 6372 646e 745f 636e 7473 2920 2d20 6e70  crdnt_cnts) - np
-000135d0: 2e73 756d 2864 7363 7264 6e74 5f63 6e74  .sum(dscrdnt_cnt
-000135e0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-000135f0: 2020 2029 202f 2028 6e70 2e73 756d 2863     ) / (np.sum(c
-00013600: 6e63 7264 6e74 5f63 6e74 7329 202b 206e  ncrdnt_cnts) + n
-00013610: 702e 7375 6d28 6473 6372 646e 745f 636e  p.sum(dscrdnt_cn
-00013620: 7473 2929 0a0a 2020 2020 2020 2020 7265  ts))..        re
-00013630: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
-00013640: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-00013650: 2020 2020 6465 6620 6669 6e64 5f63 6f6c      def find_col
-00013660: 6c69 6e65 6172 5f66 6561 7475 7265 7328  linear_features(
-00013670: 0a20 2020 2020 2020 2064 663a 2070 642e  .        df: pd.
-00013680: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
-00013690: 2020 2074 6872 6573 686f 6c64 3a20 666c     threshold: fl
-000136a0: 6f61 742c 0a20 2020 2020 2020 206d 6574  oat,.        met
-000136b0: 686f 643a 204f 7074 696f 6e61 6c5b 4c69  hod: Optional[Li
-000136c0: 7465 7261 6c5b 2270 6561 7273 6f6e 222c  teral["pearson",
-000136d0: 2022 7370 6561 726d 616e 222c 2022 6b65   "spearman", "ke
-000136e0: 6e64 616c 6c22 5d5d 203d 2022 7065 6172  ndall"]] = "pear
-000136f0: 736f 6e22 2c0a 2020 2020 2020 2020 7665  son",.        ve
-00013700: 7262 6f73 653a 204f 7074 696f 6e61 6c5b  rbose: Optional[
-00013710: 626f 6f6c 5d20 3d20 4661 6c73 652c 0a20  bool] = False,. 
-00013720: 2020 2029 202d 3e20 4c69 7374 5b73 7472     ) -> List[str
-00013730: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
-00013740: 2020 2020 2020 2049 6465 6e74 6966 7920         Identify 
-00013750: 636f 6c6c 696e 6561 7220 6665 6174 7572  collinear featur
-00013760: 6573 2069 6e20 7468 6520 6461 7461 6672  es in the datafr
-00013770: 616d 6520 6261 7365 6420 6f6e 2074 6865  ame based on the
-00013780: 2073 7065 6369 6669 6564 2063 6f72 7265   specified corre
-00013790: 6c61 7469 6f6e 206d 6574 686f 6420 616e  lation method an
-000137a0: 6420 7468 7265 7368 6f6c 642e 0a0a 2020  d threshold...  
-000137b0: 2020 2020 2020 3a70 6172 616d 2070 642e        :param pd.
-000137c0: 4461 7461 4672 616d 6520 6466 3a20 496e  DataFrame df: In
-000137d0: 7075 7420 4461 7461 4672 616d 6520 636f  put DataFrame co
-000137e0: 6e74 6169 6e69 6e67 2066 6561 7475 7265  ntaining feature
-000137f0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00013800: 6d20 666c 6f61 7420 7468 7265 7368 6f6c  m float threshol
-00013810: 643a 2054 6872 6573 686f 6c64 2076 616c  d: Threshold val
-00013820: 7565 2074 6f20 6465 7465 726d 696e 6520  ue to determine 
-00013830: 636f 6c6c 696e 6561 7269 7479 2e0a 2020  collinearity..  
-00013840: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-00013850: 696f 6e61 6c5b 4c69 7465 7261 6c5b 2770  ional[Literal['p
-00013860: 6561 7273 6f6e 272c 2027 7370 6561 726d  earson', 'spearm
-00013870: 616e 272c 2027 6b65 6e64 616c 6c27 5d5d  an', 'kendall']]
-00013880: 206d 6574 686f 643a 204d 6574 686f 6420   method: Method 
-00013890: 666f 7220 6361 6c63 756c 6174 696e 6720  for calculating 
-000138a0: 636f 7272 656c 6174 696f 6e2e 2044 6566  correlation. Def
-000138b0: 6175 6c74 7320 746f 2027 7065 6172 736f  aults to 'pearso
-000138c0: 6e27 2e0a 2020 2020 2020 2020 3a72 6574  n'..        :ret
-000138d0: 7572 6e3a 2053 6574 206f 6620 6665 6174  urn: Set of feat
-000138e0: 7572 6520 6e61 6d65 7320 6964 656e 7469  ure names identi
-000138f0: 6669 6564 2061 7320 636f 6c6c 696e 6561  fied as collinea
-00013900: 722e 2052 6574 7572 6e73 206f 6e65 2066  r. Returns one f
-00013910: 6561 7475 7265 2066 6f72 2065 7665 7279  eature for every
-00013920: 2066 6561 7475 7265 2070 6169 7220 7769   feature pair wi
-00013930: 7468 2063 6f72 7265 6c61 7469 6f6e 2076  th correlation v
-00013940: 616c 7565 2061 626f 7665 2073 7065 6369  alue above speci
-00013950: 6669 6564 2074 6872 6573 686f 6c64 2e0a  fied threshold..
-00013960: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-00013970: 653a 0a20 2020 2020 2020 203e 3e3e 2078  e:.        >>> x
-00013980: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00013990: 6e70 2e72 616e 646f 6d2e 7261 6e64 696e  np.random.randin
-000139a0: 7428 302c 2031 3030 2c20 2831 3030 2c20  t(0, 100, (100, 
-000139b0: 3130 3029 2929 0a20 2020 2020 2020 203e  100))).        >
-000139c0: 3e3e 206e 616d 6573 203d 2053 7461 7469  >> names = Stati
-000139d0: 7374 6963 732e 6669 6e64 5f63 6f6c 6c69  stics.find_colli
-000139e0: 6e65 6172 5f66 6561 7475 7265 7328 6466  near_features(df
-000139f0: 3d78 2c20 7468 7265 7368 6f6c 643d 302e  =x, threshold=0.
-00013a00: 322c 206d 6574 686f 643d 2770 6561 7273  2, method='pears
-00013a10: 6f6e 272c 2076 6572 626f 7365 3d54 7275  on', verbose=Tru
-00013a20: 6529 0a20 2020 2020 2020 2022 2222 0a0a  e).        """..
-00013a30: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
-00013a40: 6c69 645f 6461 7461 6672 616d 6528 0a20  lid_dataframe(. 
-00013a50: 2020 2020 2020 2020 2020 2064 663d 6466             df=df
-00013a60: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-00013a70: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
-00013a80: 6669 6e64 5f63 6f6c 6c69 6e65 6172 5f66  find_collinear_f
-00013a90: 6561 7475 7265 732e 5f5f 6e61 6d65 5f5f  eatures.__name__
-00013aa0: 2c0a 2020 2020 2020 2020 2020 2020 7661  ,.            va
-00013ab0: 6c69 645f 6474 7970 6573 3d28 666c 6f61  lid_dtypes=(floa
-00013ac0: 742c 2069 6e74 2c20 6e70 2e66 6c6f 6174  t, int, np.float
-00013ad0: 3332 2c20 6e70 2e66 6c6f 6174 3634 2c20  32, np.float64, 
-00013ae0: 6e70 2e69 6e74 3332 2c20 6e70 2e69 6e74  np.int32, np.int
-00013af0: 3634 292c 0a20 2020 2020 2020 2020 2020  64),.           
-00013b00: 206d 696e 5f61 7869 735f 313d 312c 0a20   min_axis_1=1,. 
-00013b10: 2020 2020 2020 2020 2020 206d 696e 5f61             min_a
-00013b20: 7869 735f 303d 312c 0a20 2020 2020 2020  xis_0=1,.       
-00013b30: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
-00013b40: 5f66 6c6f 6174 280a 2020 2020 2020 2020  _float(.        
-00013b50: 2020 2020 6e61 6d65 3d53 7461 7469 7374      name=Statist
-00013b60: 6963 732e 6669 6e64 5f63 6f6c 6c69 6e65  ics.find_colline
-00013b70: 6172 5f66 6561 7475 7265 732e 5f5f 6e61  ar_features.__na
-00013b80: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-00013b90: 2020 7661 6c75 653d 7468 7265 7368 6f6c    value=threshol
-00013ba0: 642c 0a20 2020 2020 2020 2020 2020 206d  d,.            m
-00013bb0: 6178 5f76 616c 7565 3d31 2e30 2c0a 2020  ax_value=1.0,.  
-00013bc0: 2020 2020 2020 2020 2020 6d69 6e5f 7661            min_va
-00013bd0: 6c75 653d 302e 302c 0a20 2020 2020 2020  lue=0.0,.       
-00013be0: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
-00013bf0: 5f73 7472 280a 2020 2020 2020 2020 2020  _str(.          
-00013c00: 2020 6e61 6d65 3d53 7461 7469 7374 6963    name=Statistic
-00013c10: 732e 6669 6e64 5f63 6f6c 6c69 6e65 6172  s.find_collinear
-00013c20: 5f66 6561 7475 7265 732e 5f5f 6e61 6d65  _features.__name
-00013c30: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
-00013c40: 7661 6c75 653d 6d65 7468 6f64 2c0a 2020  value=method,.  
-00013c50: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00013c60: 733d 2822 7065 6172 736f 6e22 2c20 2273  s=("pearson", "s
-00013c70: 7065 6172 6d61 6e22 2c20 226b 656e 6461  pearman", "kenda
-00013c80: 6c6c 2229 2c0a 2020 2020 2020 2020 290a  ll"),.        ).
-00013c90: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00013ca0: 6e61 6d65 7320 3d20 7365 7428 290a 2020  names = set().  
-00013cb0: 2020 2020 2020 6665 6174 7572 655f 7061        feature_pa
-00013cc0: 6972 7320 3d20 6c69 7374 2863 6f6d 6269  irs = list(combi
-00013cd0: 6e61 7469 6f6e 7328 6c69 7374 2864 662e  nations(list(df.
-00013ce0: 636f 6c75 6d6e 7329 2c20 3229 290a 0a20  columns), 2)).. 
-00013cf0: 2020 2020 2020 2066 6f72 2063 6e74 2c20         for cnt, 
-00013d00: 6920 696e 2065 6e75 6d65 7261 7465 2866  i in enumerate(f
-00013d10: 6561 7475 7265 5f70 6169 7273 293a 0a20  eature_pairs):. 
-00013d20: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
-00013d30: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00013d40: 2020 2020 2020 2070 7269 6e74 280a 2020         print(.  
-00013d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d60: 2020 6622 416e 616c 797a 696e 6720 6665    f"Analyzing fe
-00013d70: 6174 7572 6520 7061 6972 2063 6f6c 6c69  ature pair colli
-00013d80: 6e65 6172 6974 7920 7b63 6e74 202b 2031  nearity {cnt + 1
-00013d90: 7d2f 7b6c 656e 2866 6561 7475 7265 5f70  }/{len(feature_p
-00013da0: 6169 7273 297d 2e2e 2e22 0a20 2020 2020  airs)}...".     
-00013db0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00013dc0: 2020 2020 2020 2020 2069 6620 2869 5b30           if (i[0
-00013dd0: 5d20 6e6f 7420 696e 2066 6561 7475 7265  ] not in feature
-00013de0: 5f6e 616d 6573 2920 616e 6420 2869 5b31  _names) and (i[1
-00013df0: 5d20 6e6f 7420 696e 2066 6561 7475 7265  ] not in feature
-00013e00: 5f6e 616d 6573 293a 0a20 2020 2020 2020  _names):.       
-00013e10: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00013e20: 312c 2073 616d 706c 655f 3220 3d20 6466  1, sample_2 = df
-00013e30: 5b69 5b30 5d5d 2e76 616c 7565 732e 6173  [i[0]].values.as
-00013e40: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00013e50: 2c20 6466 5b0a 2020 2020 2020 2020 2020  , df[.          
-00013e60: 2020 2020 2020 2020 2020 695b 315d 0a20            i[1]. 
-00013e70: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00013e80: 2e76 616c 7565 732e 6173 7479 7065 286e  .values.astype(n
-00013e90: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-00013ea0: 2020 2020 2020 2020 2020 2069 6620 6d65             if me
-00013eb0: 7468 6f64 203d 3d20 2270 6561 7273 6f6e  thod == "pearson
-00013ec0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00013ed0: 2020 2020 2020 2072 203d 2053 7461 7469         r = Stati
-00013ee0: 7374 6963 732e 7065 6172 736f 6e73 5f72  stics.pearsons_r
-00013ef0: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
-00013f00: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
-00013f10: 706c 655f 3229 0a20 2020 2020 2020 2020  ple_2).         
-00013f20: 2020 2020 2020 2065 6c69 6620 6d65 7468         elif meth
-00013f30: 6f64 203d 3d20 2273 7065 6172 6d61 6e22  od == "spearman"
-00013f40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013f50: 2020 2020 2020 7220 3d20 5374 6174 6973        r = Statis
-00013f60: 7469 6373 2e73 7065 6172 6d61 6e5f 7261  tics.spearman_ra
-00013f70: 6e6b 5f63 6f72 7265 6c61 7469 6f6e 280a  nk_correlation(.
-00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f90: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
-00013fa0: 3d73 616d 706c 655f 312c 2073 616d 706c  =sample_1, sampl
-00013fb0: 655f 323d 7361 6d70 6c65 5f32 0a20 2020  e_2=sample_2.   
-00013fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fd0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00013fe0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00013ff0: 2020 2020 2020 2020 2020 2020 2072 203d               r =
-00014000: 2053 7461 7469 7374 6963 732e 6b65 6e64   Statistics.kend
-00014010: 616c 6c5f 7461 7528 7361 6d70 6c65 5f31  all_tau(sample_1
-00014020: 3d73 616d 706c 655f 312c 2073 616d 706c  =sample_1, sampl
-00014030: 655f 323d 7361 6d70 6c65 5f32 295b 305d  e_2=sample_2)[0]
-00014040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014050: 2069 6620 6162 7328 7229 203e 2074 6872   if abs(r) > thr
-00014060: 6573 686f 6c64 3a0a 2020 2020 2020 2020  eshold:.        
-00014070: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00014080: 7572 655f 6e61 6d65 732e 6164 6428 695b  ure_names.add(i[
-00014090: 305d 290a 2020 2020 2020 2020 6966 2076  0]).        if v
-000140a0: 6572 626f 7365 3a0a 2020 2020 2020 2020  erbose:.        
-000140b0: 2020 2020 7072 696e 7428 2243 6f6c 6c69      print("Colli
-000140c0: 6e65 6172 2061 6e61 6c79 7369 7320 636f  near analysis co
-000140d0: 6d70 6c65 7465 2e22 290a 2020 2020 2020  mplete.").      
-000140e0: 2020 7265 7475 726e 2066 6561 7475 7265    return feature
-000140f0: 5f6e 616d 6573 0a0a 2020 2020 4073 7461  _names..    @sta
-00014100: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
-00014110: 6620 6c6f 6361 6c5f 6f75 746c 6965 725f  f local_outlier_
-00014120: 6661 6374 6f72 280a 2020 2020 2020 2020  factor(.        
-00014130: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00014140: 2c0a 2020 2020 2020 2020 6b3a 2055 6e69  ,.        k: Uni
-00014150: 6f6e 5b69 6e74 2c20 666c 6f61 745d 203d  on[int, float] =
-00014160: 2035 2c0a 2020 2020 2020 2020 636f 6e74   5,.        cont
-00014170: 616d 696e 6174 696f 6e3a 204f 7074 696f  amination: Optio
-00014180: 6e61 6c5b 666c 6f61 745d 203d 2031 652d  nal[float] = 1e-
-00014190: 3130 2c0a 2020 2020 2020 2020 6e6f 726d  10,.        norm
-000141a0: 616c 697a 653a 204f 7074 696f 6e61 6c5b  alize: Optional[
-000141b0: 626f 6f6c 5d20 3d20 4661 6c73 652c 0a20  bool] = False,. 
-000141c0: 2020 2020 2020 2067 726f 7570 6279 5f69         groupby_i
-000141d0: 6478 3a20 4f70 7469 6f6e 616c 5b69 6e74  dx: Optional[int
-000141e0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-000141f0: 2d3e 206e 702e 6e64 6172 7261 793a 0a20  -> np.ndarray:. 
-00014200: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00014210: 2020 2043 6f6d 7075 7465 2074 6865 206c     Compute the l
-00014220: 6f63 616c 206f 7574 6c69 6572 2066 6163  ocal outlier fac
-00014230: 746f 7220 6f66 2065 6163 6820 6f62 7365  tor of each obse
-00014240: 7276 6174 696f 6e2e 0a0a 2020 2020 2020  rvation...      
-00014250: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
-00014260: 2020 2020 2020 2054 6865 2066 696e 616c         The final
-00014270: 204c 4f46 2073 636f 7265 7320 6172 6520   LOF scores are 
-00014280: 6e65 6761 7465 642e 2054 6875 732c 2068  negated. Thus, h
-00014290: 6967 6865 7220 7661 6c75 6573 2069 6e64  igher values ind
-000142a0: 6963 6174 6520 6d6f 7265 2061 7479 7069  icate more atypi
-000142b0: 6361 6c20 286f 7574 6c69 6572 2920 6461  cal (outlier) da
-000142c0: 7461 2070 6f69 6e74 732e 2056 616c 7565  ta points. Value
-000142d0: 730a 2020 2020 2020 2020 2020 204d 6574  s.           Met
-000142e0: 686f 6420 6361 6c6c 7320 6060 736b 6c65  hod calls ``skle
-000142f0: 6172 6e2e 6e65 6967 6862 6f72 732e 4c6f  arn.neighbors.Lo
-00014300: 6361 6c4f 7574 6c69 6572 4661 6374 6f72  calOutlierFactor
-00014310: 6060 2064 6972 6563 746c 792e 2041 7474  `` directly. Att
-00014320: 656d 7074 6564 2074 6f20 7573 6520 6f77  empted to use ow
-00014330: 6e20 6a69 7420 636f 6d70 696c 6564 2069  n jit compiled i
-00014340: 6d70 6c65 6d65 6e74 6174 696f 6e2c 0a20  mplementation,. 
-00014350: 2020 2020 2020 2020 2020 6275 7420 7275            but ru
-00014360: 6e74 696d 6520 7761 7320 3378 2d69 7368  ntime was 3x-ish
-00014370: 2073 6c6f 7765 7220 7468 616e 2060 6073   slower than ``s
-00014380: 6b6c 6561 726e 2e6e 6569 6768 626f 7273  klearn.neighbors
-00014390: 2e4c 6f63 616c 4f75 746c 6965 7246 6163  .LocalOutlierFac
-000143a0: 746f 7260 602e 0a0a 2020 2020 2020 2020  tor``...        
-000143b0: 2020 2049 6620 6772 6f75 7062 795f 6964     If groupby_id
-000143c0: 7820 6973 206e 6f74 204e 6f6e 652c 2074  x is not None, t
-000143d0: 6865 6e20 7468 6520 696e 6465 7820 3120  hen the index 1 
-000143e0: 6f66 2060 6064 6174 6160 6020 6172 7261  of ``data`` arra
-000143f0: 7920 666f 7220 7768 6963 6820 746f 2067  y for which to g
-00014400: 726f 7570 2074 6865 2064 6174 6120 616e  roup the data an
-00014410: 6420 636f 6d70 7574 6520 4c4f 4620 7769  d compute LOF wi
-00014420: 7468 696e 2065 6163 6820 7365 676d 656e  thin each segmen
-00014430: 742f 636c 7573 7465 722e 0a20 2020 2020  t/cluster..     
-00014440: 2020 2020 2020 452e 672e 2c20 6361 6e20        E.g., can 
-00014450: 6265 2066 6965 6c64 2068 6f6c 6469 6e67  be field holding
-00014460: 2063 6c75 7374 6572 2069 6465 6e74 6966   cluster identif
-00014470: 6965 722e 2054 6875 732c 206f 7574 6c69  ier. Thus, outli
-00014480: 6572 7320 6172 6520 636f 6d70 7574 6564  ers are computed
-00014490: 2077 6974 6869 6e20 6561 6368 2073 6567   within each seg
-000144a0: 6d65 6e74 2f63 6c75 7374 6572 2c20 656e  ment/cluster, en
-000144b0: 7375 7269 6e67 2074 6861 7420 6f74 6865  suring that othe
-000144c0: 7220 7365 676d 656e 7473 2063 616e 6e6f  r segments canno
-000144d0: 7420 6166 6665 6374 0a20 2020 2020 2020  t affect.       
-000144e0: 2020 2020 6f75 746c 6965 7220 7363 6f72      outlier scor
-000144f0: 6573 2077 6974 6869 6e20 6561 6368 2061  es within each a
-00014500: 6e61 6c79 7a69 6e67 2065 6163 6820 636c  nalyzing each cl
-00014510: 7573 7465 722e 0a0a 2020 2020 2020 2020  uster...        
-00014520: 2020 2049 6620 6772 6f75 7062 795f 6964     If groupby_id
-00014530: 7820 6973 2070 726f 7669 6465 642c 2074  x is provided, t
-00014540: 6865 6e20 616c 6c20 6f62 7365 7276 6174  hen all observat
-00014550: 696f 6e73 2077 6974 6820 636c 7573 7465  ions with cluste
-00014560: 722f 7365 676d 656e 7420 7661 7269 6162  r/segment variab
-00014570: 6c65 2060 602d 3160 6020 7769 6c6c 2062  le ``-1`` will b
-00014580: 6520 7472 6561 7465 6420 6173 2075 6e63  e treated as unc
-00014590: 6c75 7374 6572 6564 2061 6e64 2061 7373  lustered and ass
-000145a0: 6967 6e65 6420 7468 6520 6d61 7820 6f75  igned the max ou
-000145b0: 746c 6965 7220 7363 6f72 6520 666f 756e  tlier score foun
-000145c0: 6420 7769 7468 6969 6e20 7468 6520 636c  d withiin the cl
-000145d0: 7573 7465 7265 6420 6f62 7365 7276 6174  ustered observat
-000145e0: 696f 6e73 2e0a 0a20 2020 2020 2020 202e  ions...        .
-000145f0: 2e20 696d 6167 653a 3a20 5f73 7461 7469  . image:: _stati
-00014600: 632f 696d 672f 6c6f 6361 6c5f 6f75 746c  c/img/local_outl
-00014610: 6965 725f 6661 6374 6f72 2e70 6e67 0a20  ier_factor.png. 
-00014620: 2020 2020 2020 2020 2020 3a77 6964 7468            :width
-00014630: 3a20 3830 300a 2020 2020 2020 2020 2020  : 800.          
-00014640: 203a 616c 6967 6e3a 2063 656e 7465 720a   :align: center.
-00014650: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00014660: 6e64 6172 7261 7920 6461 7461 3a20 3244  ndarray data: 2D
-00014670: 2061 7272 6179 2077 6974 6820 6665 6174   array with feat
-00014680: 7572 6520 7661 6c75 6573 2077 6865 7265  ure values where
-00014690: 2072 6f77 7320 7265 7072 6573 656e 7420   rows represent 
-000146a0: 6672 616d 6573 2061 6e64 2063 6f6c 756d  frames and colum
-000146b0: 6e73 2072 6570 7265 7365 6e74 2066 6561  ns represent fea
-000146c0: 7475 7265 732e 0a20 2020 2020 2020 203a  tures..        :
-000146d0: 7061 7261 6d20 556e 696f 6e5b 696e 742c  param Union[int,
-000146e0: 2066 6c6f 6174 5d20 6b3a 204e 756d 6265   float] k: Numbe
-000146f0: 7220 6f66 206e 6569 6768 626f 7273 2074  r of neighbors t
-00014700: 6f20 6576 616c 7561 7465 2066 6f72 2065  o evaluate for e
-00014710: 6163 6820 6f62 7365 7276 6174 696f 6e2e  ach observation.
-00014720: 2049 6620 7468 6520 7661 6c75 6520 6973   If the value is
-00014730: 2061 2066 6c6f 6174 2c20 7468 656e 2069   a float, then i
-00014740: 6e74 6572 7072 6574 6564 2061 7320 7468  nterpreted as th
-00014750: 6520 7261 7469 6f20 6f66 2064 6174 612e  e ratio of data.
-00014760: 7368 6170 655b 305d 2e20 4966 2074 6865  shape[0]. If the
-00014770: 2076 616c 7565 2069 7320 616e 2069 6e74   value is an int
-00014780: 6567 6572 2c20 7468 656e 2069 7420 7265  eger, then it re
-00014790: 7072 6573 656e 7420 7468 6520 6e75 6d62  present the numb
-000147a0: 6572 206f 6620 6e65 6967 6862 6f75 7273  er of neighbours
-000147b0: 2074 6f20 6576 616c 7561 7465 2e0a 2020   to evaluate..  
-000147c0: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-000147d0: 696f 6e61 6c5b 666c 6f61 745d 2063 6f6e  ional[float] con
-000147e0: 7461 6d69 6e61 7469 6f6e 3a20 536d 616c  tamination: Smal
-000147f0: 6c20 7073 6575 646f 6e75 6d62 6572 2074  l pseudonumber t
-00014800: 6f20 6176 6f69 6420 4469 7669 7369 6f6e  o avoid Division
-00014810: 4279 5a65 726f 2065 7272 6f72 2e0a 2020  ByZero error..  
-00014820: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-00014830: 696f 6e61 6c5b 626f 6f6c 5d20 6e6f 726d  ional[bool] norm
-00014840: 616c 697a 653a 2057 6865 7468 6572 2074  alize: Whether t
-00014850: 6f20 6e6f 726d 616c 697a 6520 7468 6520  o normalize the 
-00014860: 6469 7374 616e 6365 7320 6265 7477 6565  distances betwee
-00014870: 6e20 3020 616e 6420 312e 2044 6566 6175  n 0 and 1. Defau
-00014880: 6c74 7320 746f 2046 616c 7365 2e0a 2020  lts to False..  
-00014890: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-000148a0: 696f 6e61 6c5b 696e 745d 2067 726f 7570  ional[int] group
-000148b0: 6279 5f69 6478 3a20 4966 2069 6e74 2c20  by_idx: If int, 
-000148c0: 7468 656e 2074 6865 2069 6e64 6578 2031  then the index 1
-000148d0: 206f 6620 6060 6461 7461 6060 2066 6f72   of ``data`` for
-000148e0: 2077 6869 6368 2074 6f20 6772 6f75 7020   which to group 
-000148f0: 7468 6520 6461 7461 2061 6e64 2063 6f6d  the data and com
-00014900: 7075 7465 204c 4f46 206f 6e20 6561 6368  pute LOF on each
-00014910: 2073 6567 6d65 6e74 2e20 452e 672e 2c20   segment. E.g., 
-00014920: 6361 6e20 6265 2066 6965 6c64 2068 6f6c  can be field hol
-00014930: 6469 6e67 2061 2063 6c75 7374 6572 2069  ding a cluster i
-00014940: 6465 6e74 6966 6965 722e 0a20 2020 2020  dentifier..     
-00014950: 2020 203a 7265 7475 726e 7320 6e70 2e6e     :returns np.n
-00014960: 6461 7272 6179 3a20 4172 7261 7920 6f66  darray: Array of
-00014970: 2073 697a 6520 6461 7461 2e73 6861 7065   size data.shape
-00014980: 5b30 5d20 7769 7468 206c 6f63 616c 206f  [0] with local o
-00014990: 7574 6c69 6572 2073 636f 7265 732e 0a0a  utlier scores...
-000149a0: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
-000149b0: 3a0a 2020 2020 2020 2020 3e3e 3e20 6461  :.        >>> da
-000149c0: 7461 2c20 6c62 6c73 203d 206d 616b 655f  ta, lbls = make_
-000149d0: 626c 6f62 7328 6e5f 7361 6d70 6c65 733d  blobs(n_samples=
-000149e0: 3230 3030 2c20 6e5f 6665 6174 7572 6573  2000, n_features
-000149f0: 3d32 2c20 6365 6e74 6572 733d 3130 2c20  =2, centers=10, 
-00014a00: 7261 6e64 6f6d 5f73 7461 7465 3d34 3229  random_state=42)
-00014a10: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
-00014a20: 6120 3d20 6e70 2e68 7374 6163 6b28 2864  a = np.hstack((d
-00014a30: 6174 612c 206c 626c 732e 7265 7368 6170  ata, lbls.reshap
-00014a40: 6528 2d31 2c20 3129 2929 0a20 2020 2020  e(-1, 1))).     
-00014a50: 2020 203e 3e3e 206c 6f66 203d 2053 7461     >>> lof = Sta
-00014a60: 7469 7374 6963 732e 6c6f 6361 6c5f 6f75  tistics.local_ou
-00014a70: 746c 6965 725f 6661 6374 6f72 2864 6174  tlier_factor(dat
-00014a80: 613d 6461 7461 2c20 6772 6f75 7062 795f  a=data, groupby_
-00014a90: 6964 783d 322c 206b 3d31 3030 2c20 6e6f  idx=2, k=100, no
-00014aa0: 726d 616c 697a 653d 5472 7565 290a 2020  rmalize=True).  
-00014ab0: 2020 2020 2020 3e3e 3e20 7265 7375 6c74        >>> result
-00014ac0: 7320 3d20 6e70 2e68 7374 6163 6b28 2864  s = np.hstack((d
-00014ad0: 6174 615b 3a2c 2030 3a32 5d2c 206c 6f66  ata[:, 0:2], lof
-00014ae0: 2e72 6573 6861 7065 286c 6f66 2e73 6861  .reshape(lof.sha
-00014af0: 7065 5b30 5d2c 2031 2929 290a 2020 2020  pe[0], 1))).    
-00014b00: 2020 2020 3e3e 3e20 506c 6f74 7469 6e67      >>> Plotting
-00014b10: 4d69 7869 6e2e 636f 6e74 696e 756f 7573  Mixin.continuous
-00014b20: 5f73 6361 7474 6572 2864 6174 613d 7265  _scatter(data=re
-00014b30: 7375 6c74 732c 2070 616c 6574 7465 3d27  sults, palette='
-00014b40: 7365 6973 6d69 6327 2c20 6267 5f63 6c72  seismic', bg_clr
-00014b50: 3d27 6c69 6768 7467 7265 7927 2c73 697a  ='lightgrey',siz
-00014b60: 653d 3330 290a 2020 2020 2020 2020 2222  e=30).        ""
-00014b70: 220a 0a20 2020 2020 2020 2064 6566 2067  "..        def g
-00014b80: 6574 5f6c 6f66 2864 6174 612c 206b 2c20  et_lof(data, k, 
-00014b90: 636f 6e74 616d 696e 6174 696f 6e29 3a0a  contamination):.
-00014ba0: 2020 2020 2020 2020 2020 2020 6368 6563              chec
-00014bb0: 6b5f 666c 6f61 7428 6e61 6d65 3d66 227b  k_float(name=f"{
-00014bc0: 5374 6174 6973 7469 6373 2e6c 6f63 616c  Statistics.local
-00014bd0: 5f6f 7574 6c69 6572 5f66 6163 746f 722e  _outlier_factor.
-00014be0: 5f5f 6e61 6d65 5f5f 7d20 6b22 2c20 7661  __name__} k", va
-00014bf0: 6c75 653d 6b29 0a20 2020 2020 2020 2020  lue=k).         
-00014c00: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00014c10: 286b 2c20 696e 7429 3a0a 2020 2020 2020  (k, int):.      
-00014c20: 2020 2020 2020 2020 2020 6b20 3d20 6d69            k = mi
-00014c30: 6e28 6b2c 2064 6174 612e 7368 6170 655b  n(k, data.shape[
-00014c40: 305d 290a 2020 2020 2020 2020 2020 2020  0]).            
-00014c50: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-00014c60: 6b2c 2066 6c6f 6174 293a 0a20 2020 2020  k, float):.     
-00014c70: 2020 2020 2020 2020 2020 206b 203d 2069             k = i
-00014c80: 6e74 2864 6174 612e 7368 6170 655b 305d  nt(data.shape[0]
-00014c90: 202a 206b 290a 2020 2020 2020 2020 2020   * k).          
-00014ca0: 2020 6c6f 665f 6d6f 6465 6c20 3d20 4c6f    lof_model = Lo
-00014cb0: 6361 6c4f 7574 6c69 6572 4661 6374 6f72  calOutlierFactor
-00014cc0: 286e 5f6e 6569 6768 626f 7273 3d6b 2c20  (n_neighbors=k, 
-00014cd0: 636f 6e74 616d 696e 6174 696f 6e3d 636f  contamination=co
-00014ce0: 6e74 616d 696e 6174 696f 6e29 0a20 2020  ntamination).   
-00014cf0: 2020 2020 2020 2020 205f 203d 206c 6f66           _ = lof
-00014d00: 5f6d 6f64 656c 2e66 6974 5f70 7265 6469  _model.fit_predi
-00014d10: 6374 2864 6174 6129 0a20 2020 2020 2020  ct(data).       
-00014d20: 2020 2020 2079 203d 202d 6c6f 665f 6d6f       y = -lof_mo
-00014d30: 6465 6c2e 6e65 6761 7469 7665 5f6f 7574  del.negative_out
-00014d40: 6c69 6572 5f66 6163 746f 725f 2e61 7374  lier_factor_.ast
-00014d50: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
-00014d60: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00014d70: 6f72 6d61 6c69 7a65 3a0a 2020 2020 2020  ormalize:.      
-00014d80: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00014d90: 2028 7920 2d20 6e70 2e6d 696e 2879 2929   (y - np.min(y))
-00014da0: 202f 2028 6e70 2e6d 6178 2879 2920 2d20   / (np.max(y) - 
-00014db0: 6e70 2e6d 696e 2879 2929 0a20 2020 2020  np.min(y)).     
-00014dc0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00014dd0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00014de0: 7572 6e20 790a 0a20 2020 2020 2020 2069  urn y..        i
-00014df0: 6620 6772 6f75 7062 795f 6964 7820 6973  f groupby_idx is
-00014e00: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00014e10: 2020 2020 2020 2063 6865 636b 5f69 6e74         check_int
-00014e20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00014e30: 2020 6e61 6d65 3d66 227b 5374 6174 6973    name=f"{Statis
-00014e40: 7469 6373 2e6c 6f63 616c 5f6f 7574 6c69  tics.local_outli
-00014e50: 6572 5f66 6163 746f 722e 5f5f 6e61 6d65  er_factor.__name
-00014e60: 5f5f 7d20 6772 6f75 7062 795f 6964 7822  __} groupby_idx"
-00014e70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014e80: 2020 7661 6c75 653d 6772 6f75 7062 795f    value=groupby_
-00014e90: 6964 782c 0a20 2020 2020 2020 2020 2020  idx,.           
-00014ea0: 2020 2020 206d 696e 5f76 616c 7565 3d30       min_value=0
-00014eb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014ec0: 2020 6d61 785f 7661 6c75 653d 6461 7461    max_value=data
-00014ed0: 2e73 6861 7065 5b31 5d20 2d20 312c 0a20  .shape[1] - 1,. 
-00014ee0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00014ef0: 2020 2020 2020 2020 2063 6865 636b 5f76           check_v
-00014f00: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
-00014f10: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-00014f20: 6365 3d66 227b 5374 6174 6973 7469 6373  ce=f"{Statistics
-00014f30: 2e6c 6f63 616c 5f6f 7574 6c69 6572 5f66  .local_outlier_f
-00014f40: 6163 746f 722e 5f5f 6e61 6d65 5f5f 7d20  actor.__name__} 
-00014f50: 6c6f 6361 6c5f 6f75 746c 6965 725f 6661  local_outlier_fa
-00014f60: 6374 6f72 222c 0a20 2020 2020 2020 2020  ctor",.         
-00014f70: 2020 2020 2020 2064 6174 613d 6461 7461         data=data
-00014f80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014f90: 2020 6163 6365 7074 6564 5f73 697a 6573    accepted_sizes
-00014fa0: 3d5b 325d 2c0a 2020 2020 2020 2020 2020  =[2],.          
-00014fb0: 2020 2020 2020 6d69 6e5f 6178 6973 5f31        min_axis_1
-00014fc0: 3d33 2c0a 2020 2020 2020 2020 2020 2020  =3,.            
-00014fd0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00014fe0: 2020 2020 2020 2020 2020 2020 6368 6563              chec
-00014ff0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-00015000: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00015010: 6f75 7263 653d 6622 7b53 7461 7469 7374  ource=f"{Statist
-00015020: 6963 732e 6c6f 6361 6c5f 6f75 746c 6965  ics.local_outlie
-00015030: 725f 6661 6374 6f72 2e5f 5f6e 616d 655f  r_factor.__name_
-00015040: 5f7d 2064 6174 6122 2c0a 2020 2020 2020  _} data",.      
-00015050: 2020 2020 2020 2020 2020 6461 7461 3d64            data=d
-00015060: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-00015070: 2020 2020 2061 6363 6570 7465 645f 7369       accepted_si
-00015080: 7a65 733d 5b32 5d2c 0a20 2020 2020 2020  zes=[2],.       
-00015090: 2020 2020 2020 2020 206d 696e 5f61 7869           min_axi
-000150a0: 735f 313d 322c 0a20 2020 2020 2020 2020  s_1=2,.         
-000150b0: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
-000150c0: 636b 5f66 6c6f 6174 280a 2020 2020 2020  ck_float(.      
-000150d0: 2020 2020 2020 6e61 6d65 3d66 227b 5374        name=f"{St
-000150e0: 6174 6973 7469 6373 2e6c 6f63 616c 5f6f  atistics.local_o
-000150f0: 7574 6c69 6572 5f66 6163 746f 722e 5f5f  utlier_factor.__
-00015100: 6e61 6d65 5f5f 7d20 636f 6e74 616d 696e  name__} contamin
-00015110: 6174 696f 6e22 2c0a 2020 2020 2020 2020  ation",.        
-00015120: 2020 2020 7661 6c75 653d 636f 6e74 616d      value=contam
-00015130: 696e 6174 696f 6e2c 0a20 2020 2020 2020  ination,.       
-00015140: 2020 2020 206d 696e 5f76 616c 7565 3d30       min_value=0
-00015150: 2e30 2c0a 2020 2020 2020 2020 290a 0a20  .0,.        ).. 
-00015160: 2020 2020 2020 2069 6620 6772 6f75 7062         if groupb
-00015170: 795f 6964 7820 6973 204e 6f6e 653a 0a20  y_idx is None:. 
-00015180: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00015190: 6e20 6765 745f 6c6f 6628 6461 7461 2c20  n get_lof(data, 
-000151a0: 6b2c 2063 6f6e 7461 6d69 6e61 7469 6f6e  k, contamination
-000151b0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-000151c0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000151d0: 6c74 7320 3d20 5b5d 0a20 2020 2020 2020  lts = [].       
-000151e0: 2020 2020 2064 6174 615f 775f 6964 7820       data_w_idx 
-000151f0: 3d20 6e70 2e68 7374 6163 6b28 286e 702e  = np.hstack((np.
-00015200: 6172 616e 6765 2830 2c20 6461 7461 2e73  arange(0, data.s
-00015210: 6861 7065 5b30 5d29 2e72 6573 6861 7065  hape[0]).reshape
-00015220: 282d 312c 2031 292c 2064 6174 6129 290a  (-1, 1), data)).
-00015230: 2020 2020 2020 2020 2020 2020 756e 6971              uniq
-00015240: 7565 5f63 203d 206e 702e 756e 6971 7565  ue_c = np.unique
-00015250: 2864 6174 615b 3a2c 2067 726f 7570 6279  (data[:, groupby
-00015260: 5f69 6478 5d29 2e61 7374 7970 6528 6e70  _idx]).astype(np
-00015270: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
-00015280: 2020 2020 2020 6966 202d 312e 3020 696e        if -1.0 in
-00015290: 2075 6e69 7175 655f 633a 0a20 2020 2020   unique_c:.     
-000152a0: 2020 2020 2020 2020 2020 2075 6e69 7175             uniqu
-000152b0: 655f 6320 3d20 756e 6971 7565 5f63 5b6e  e_c = unique_c[n
-000152c0: 702e 7768 6572 6528 756e 6971 7565 5f63  p.where(unique_c
-000152d0: 2021 3d20 2d31 295d 0a20 2020 2020 2020   != -1)].       
-000152e0: 2020 2020 2020 2020 2075 6e63 6c75 7374           unclust
-000152f0: 6572 6564 5f69 6478 203d 206e 702e 6172  ered_idx = np.ar
-00015300: 6777 6865 7265 2864 6174 615b 3a2c 2067  gwhere(data[:, g
-00015310: 726f 7570 6279 5f69 6478 5d20 3d3d 202d  roupby_idx] == -
-00015320: 312e 3029 2e66 6c61 7474 656e 2829 0a20  1.0).flatten(). 
-00015330: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00015340: 6e63 6c75 7374 6572 6564 203d 2064 6174  nclustered = dat
-00015350: 615f 775f 6964 785b 756e 636c 7573 7465  a_w_idx[uncluste
-00015360: 7265 645f 6964 785d 0a20 2020 2020 2020  red_idx].       
-00015370: 2020 2020 2020 2020 2064 6174 615f 775f           data_w_
-00015380: 6964 7820 3d20 6e70 2e64 656c 6574 6528  idx = np.delete(
-00015390: 6461 7461 5f77 5f69 6478 2c20 756e 636c  data_w_idx, uncl
-000153a0: 7573 7465 7265 645f 6964 782c 2061 7869  ustered_idx, axi
-000153b0: 733d 3029 0a20 2020 2020 2020 2020 2020  s=0).           
-000153c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000153d0: 2020 2020 2020 2075 6e63 6c75 7374 6572         uncluster
-000153e0: 6564 203d 204e 6f6e 650a 2020 2020 2020  ed = None.      
-000153f0: 2020 2020 2020 666f 7220 6920 696e 2075        for i in u
-00015400: 6e69 7175 655f 633a 0a20 2020 2020 2020  nique_c:.       
-00015410: 2020 2020 2020 2020 2073 5f64 6174 6120           s_data 
-00015420: 3d20 6461 7461 5f77 5f69 6478 5b0a 2020  = data_w_idx[.  
-00015430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015440: 2020 6e70 2e61 7267 7768 6572 6528 6461    np.argwhere(da
-00015450: 7461 5f77 5f69 6478 5b3a 2c20 6772 6f75  ta_w_idx[:, grou
-00015460: 7062 795f 6964 7820 2b20 315d 203d 3d20  pby_idx + 1] == 
-00015470: 6929 0a20 2020 2020 2020 2020 2020 2020  i).             
-00015480: 2020 205d 2e72 6573 6861 7065 282d 312c     ].reshape(-1,
-00015490: 2064 6174 615f 775f 6964 782e 7368 6170   data_w_idx.shap
-000154a0: 655b 315d 290a 2020 2020 2020 2020 2020  e[1]).          
-000154b0: 2020 2020 2020 6964 7820 3d20 735f 6461        idx = s_da
-000154c0: 7461 5b3a 2c20 305d 2e72 6573 6861 7065  ta[:, 0].reshape
-000154d0: 2873 5f64 6174 612e 7368 6170 655b 305d  (s_data.shape[0]
-000154e0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
-000154f0: 2020 2020 2073 5f64 6174 6120 3d20 6e70       s_data = np
-00015500: 2e64 656c 6574 6528 735f 6461 7461 2c20  .delete(s_data, 
-00015510: 5b30 2c20 6772 6f75 7062 795f 6964 7820  [0, groupby_idx 
-00015520: 2b20 315d 2c20 3129 0a20 2020 2020 2020  + 1], 1).       
-00015530: 2020 2020 2020 2020 206c 6f66 203d 2067           lof = g
-00015540: 6574 5f6c 6f66 2873 5f64 6174 612c 206b  et_lof(s_data, k
-00015550: 2c20 636f 6e74 616d 696e 6174 696f 6e29  , contamination)
-00015560: 2e72 6573 6861 7065 2873 5f64 6174 612e  .reshape(s_data.
-00015570: 7368 6170 655b 305d 2c20 3129 0a20 2020  shape[0], 1).   
-00015580: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00015590: 756c 7473 2e61 7070 656e 6428 6e70 2e68  ults.append(np.h
-000155a0: 7374 6163 6b28 2869 6478 2c20 6c6f 6629  stack((idx, lof)
-000155b0: 2929 0a20 2020 2020 2020 2020 2020 2078  )).            x
-000155c0: 203d 206e 702e 636f 6e63 6174 656e 6174   = np.concatenat
-000155d0: 6528 7265 7375 6c74 732c 2061 7869 733d  e(results, axis=
-000155e0: 3029 0a20 2020 2020 2020 2020 2020 2069  0).            i
-000155f0: 6620 756e 636c 7573 7465 7265 6420 6973  f unclustered is
-00015600: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00015610: 2020 2020 2020 2020 2020 206d 6178 5f6c             max_l
-00015620: 6f66 203d 206e 702e 6675 6c6c 2828 756e  of = np.full((un
-00015630: 636c 7573 7465 7265 642e 7368 6170 655b  clustered.shape[
-00015640: 305d 2c20 3129 2c20 6e70 2e6d 6178 2878  0], 1), np.max(x
-00015650: 5b3a 2c20 2d31 5d29 290a 2020 2020 2020  [:, -1])).      
-00015660: 2020 2020 2020 2020 2020 756e 636c 7573            unclus
-00015670: 7465 7265 6420 3d20 6e70 2e68 7374 6163  tered = np.hstac
-00015680: 6b28 2875 6e63 6c75 7374 6572 6564 2c20  k((unclustered, 
-00015690: 6d61 785f 6c6f 6629 295b 3a2c 205b 302c  max_lof))[:, [0,
-000156a0: 202d 315d 5d0a 2020 2020 2020 2020 2020   -1]].          
-000156b0: 2020 2020 2020 7820 3d20 6e70 2e76 7374        x = np.vst
-000156c0: 6163 6b28 2878 2c20 756e 636c 7573 7465  ack((x, uncluste
-000156d0: 7265 6429 290a 2020 2020 2020 2020 2020  red)).          
-000156e0: 2020 7265 7475 726e 2078 5b6e 702e 6172    return x[np.ar
-000156f0: 6773 6f72 7428 785b 3a2c 2030 5d29 5d5b  gsort(x[:, 0])][
-00015700: 3a2c 202d 315d 0a0a 2020 2020 4073 7461  :, -1]..    @sta
-00015710: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
-00015720: 6620 656c 6c69 7074 6963 5f65 6e76 656c  f elliptic_envel
-00015730: 6f70 6528 0a20 2020 2020 2020 2064 6174  ope(.        dat
-00015740: 613a 206e 702e 6e64 6172 7261 792c 0a20  a: np.ndarray,. 
-00015750: 2020 2020 2020 2063 6f6e 7461 6d69 6e61         contamina
-00015760: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b66  tion: Optional[f
-00015770: 6c6f 6174 5d20 3d20 3165 2d31 2c0a 2020  loat] = 1e-1,.  
-00015780: 2020 2020 2020 6e6f 726d 616c 697a 653a        normalize:
-00015790: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-000157a0: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-000157b0: 2067 726f 7570 6279 5f69 6478 3a20 4f70   groupby_idx: Op
-000157c0: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
-000157d0: 6e65 2c0a 2020 2020 2920 2d3e 206e 702e  ne,.    ) -> np.
-000157e0: 6e64 6172 7261 793a 0a20 2020 2020 2020  ndarray:.       
-000157f0: 2022 2222 0a20 2020 2020 2020 2043 6f6d   """.        Com
-00015800: 7075 7465 2074 6865 204d 6168 616c 616e  pute the Mahalan
-00015810: 6f62 6973 2064 6973 7461 6e63 6573 206f  obis distances o
-00015820: 6620 6561 6368 206f 6273 6572 7661 7469  f each observati
-00015830: 6f6e 2069 6e20 7468 6520 696e 7075 7420  on in the input 
-00015840: 6172 7261 7920 7573 696e 6720 456c 6c69  array using Elli
-00015850: 7074 6963 2045 6e76 656c 6f70 6520 6d65  ptic Envelope me
-00015860: 7468 6f64 2e0a 0a20 2020 2020 2020 202e  thod...        .
-00015870: 2e20 696d 6167 653a 3a20 5f73 7461 7469  . image:: _stati
-00015880: 632f 696d 672f 456c 6c69 7074 6963 456e  c/img/EllipticEn
-00015890: 7665 6c6f 7065 2e70 6e67 0a20 2020 2020  velope.png.     
-000158a0: 2020 2020 2020 3a77 6964 7468 3a20 3730        :width: 70
-000158b0: 300a 2020 2020 2020 2020 2020 203a 616c  0.           :al
-000158c0: 6967 6e3a 2063 656e 7465 720a 0a20 2020  ign: center..   
-000158d0: 2020 2020 202e 2e20 696d 6167 653a 3a20       .. image:: 
-000158e0: 5f73 7461 7469 632f 696d 672f 656c 6c69  _static/img/elli
-000158f0: 7074 6963 5f65 6e76 656c 6f70 652e 706e  ptic_envelope.pn
-00015900: 670a 2020 2020 2020 2020 2020 203a 7769  g.           :wi
-00015910: 6474 683a 2037 3030 0a20 2020 2020 2020  dth: 700.       
-00015920: 2020 2020 3a61 6c69 676e 3a20 6365 6e74      :align: cent
-00015930: 6572 0a0a 2020 2020 2020 2020 3a70 6172  er..        :par
-00015940: 616d 2064 6174 613a 2049 6e70 7574 2064  am data: Input d
-00015950: 6174 6120 6172 7261 7920 6f66 2073 6861  ata array of sha
-00015960: 7065 2028 6e5f 7361 6d70 6c65 732c 206e  pe (n_samples, n
-00015970: 5f66 6561 7475 7265 7329 2e0a 2020 2020  _features)..    
-00015980: 2020 2020 3a70 6172 616d 204f 7074 696f      :param Optio
-00015990: 6e61 6c5b 666c 6f61 745d 2063 6f6e 7461  nal[float] conta
-000159a0: 6d69 6e61 7469 6f6e 3a20 5468 6520 7072  mination: The pr
-000159b0: 6f70 6f72 7469 6f6e 206f 6620 6f75 746c  oportion of outl
-000159c0: 6965 7273 2074 6f20 6265 2061 7373 756d  iers to be assum
-000159d0: 6564 2069 6e20 7468 6520 6461 7461 2e20  ed in the data. 
-000159e0: 4465 6661 756c 7473 2074 6f20 302e 312e  Defaults to 0.1.
-000159f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015a00: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 206e  Optional[bool] n
-00015a10: 6f72 6d61 6c69 7a65 3a20 5768 6574 6865  ormalize: Whethe
-00015a20: 7220 746f 206e 6f72 6d61 6c69 7a65 2074  r to normalize t
-00015a30: 6865 204d 6168 616c 616e 6f62 6973 2064  he Mahalanobis d
-00015a40: 6973 7461 6e63 6573 2062 6574 7765 656e  istances between
-00015a50: 2030 2061 6e64 2031 2e20 4465 6661 756c   0 and 1. Defaul
-00015a60: 7473 2074 6f20 5472 7565 2e0a 2020 2020  ts to True..    
-00015a70: 2020 2020 3a72 6574 7572 6e20 6e70 2e6e      :return np.n
-00015a80: 6461 7272 6179 3a20 5468 6520 4d61 6861  darray: The Maha
-00015a90: 6c61 6e6f 6269 7320 6469 7374 616e 6365  lanobis distance
-00015aa0: 7320 6f66 2065 6163 6820 6f62 7365 7276  s of each observ
-00015ab0: 6174 696f 6e20 696e 2061 7272 6179 2e20  ation in array. 
-00015ac0: 4c61 7267 6572 2076 616c 7565 7320 696e  Larger values in
-00015ad0: 6469 6361 7465 206f 7574 6c69 6572 732e  dicate outliers.
-00015ae0: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-00015af0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-00015b00: 6461 7461 2c20 6c62 6c73 203d 206d 616b  data, lbls = mak
-00015b10: 655f 626c 6f62 7328 6e5f 7361 6d70 6c65  e_blobs(n_sample
-00015b20: 733d 3230 3030 2c20 6e5f 6665 6174 7572  s=2000, n_featur
-00015b30: 6573 3d32 2c20 6365 6e74 6572 733d 312c  es=2, centers=1,
-00015b40: 2072 616e 646f 6d5f 7374 6174 653d 3432   random_state=42
-00015b50: 290a 2020 2020 2020 2020 3e3e 3e20 656e  ).        >>> en
-00015b60: 7665 6c6f 7065 5f73 636f 7265 203d 2065  velope_score = e
-00015b70: 6c6c 6970 7469 635f 656e 7665 6c6f 7065  lliptic_envelope
-00015b80: 2864 6174 613d 6461 7461 2c20 6e6f 726d  (data=data, norm
-00015b90: 616c 697a 653d 5472 7565 290a 2020 2020  alize=True).    
-00015ba0: 2020 2020 3e3e 3e20 7265 7375 6c74 7320      >>> results 
-00015bb0: 3d20 6e70 2e68 7374 6163 6b28 2864 6174  = np.hstack((dat
-00015bc0: 615b 3a2c 2030 3a32 5d2c 2065 6e76 656c  a[:, 0:2], envel
-00015bd0: 6f70 655f 7363 6f72 652e 7265 7368 6170  ope_score.reshap
-00015be0: 6528 6c6f 662e 7368 6170 655b 305d 2c20  e(lof.shape[0], 
-00015bf0: 3129 2929 0a20 2020 2020 2020 203e 3e3e  1))).        >>>
-00015c00: 2072 6573 756c 7473 203d 2070 642e 4461   results = pd.Da
-00015c10: 7461 4672 616d 6528 7265 7375 6c74 732c  taFrame(results,
-00015c20: 2063 6f6c 756d 6e73 3d5b 2758 272c 2027   columns=['X', '
-00015c30: 5927 2c20 2745 4e56 454c 4f50 4520 5343  Y', 'ENVELOPE SC
-00015c40: 4f52 4527 5d29 0a20 2020 2020 2020 203e  ORE']).        >
-00015c50: 3e3e 2050 6c6f 7474 696e 674d 6978 696e  >> PlottingMixin
-00015c60: 2e63 6f6e 7469 6e75 6f75 735f 7363 6174  .continuous_scat
-00015c70: 7465 7228 6461 7461 3d72 6573 756c 7473  ter(data=results
-00015c80: 2c20 7061 6c65 7474 653d 2773 6569 736d  , palette='seism
-00015c90: 6963 272c 2062 675f 636c 723d 276c 6967  ic', bg_clr='lig
-00015ca0: 6874 6772 6579 272c 2063 6f6c 756d 6e73  htgrey', columns
-00015cb0: 3d5b 2758 272c 2027 5927 2c20 2745 4e56  =['X', 'Y', 'ENV
-00015cc0: 454c 4f50 4520 5343 4f52 4527 5d2c 7369  ELOPE SCORE'],si
-00015cd0: 7a65 3d33 3029 0a0a 2020 2020 2020 2020  ze=30)..        
-00015ce0: 2222 220a 0a20 2020 2020 2020 2064 6566  """..        def
-00015cf0: 2067 6574 5f65 6e76 656c 6f70 6528 6461   get_envelope(da
-00015d00: 7461 2c20 636f 6e74 616d 696e 6174 696f  ta, contaminatio
-00015d10: 6e29 202d 3e20 6e70 2e6e 6461 7272 6179  n) -> np.ndarray
-00015d20: 3a0a 2020 2020 2020 2020 2020 2020 6d64  :.            md
-00015d30: 6c20 3d20 456c 6c69 7074 6963 456e 7665  l = EllipticEnve
-00015d40: 6c6f 7065 2863 6f6e 7461 6d69 6e61 7469  lope(contaminati
-00015d50: 6f6e 3d63 6f6e 7461 6d69 6e61 7469 6f6e  on=contamination
-00015d60: 292e 6669 7428 6461 7461 290a 2020 2020  ).fit(data).    
-00015d70: 2020 2020 2020 2020 7920 3d20 2d6d 646c          y = -mdl
-00015d80: 2e73 636f 7265 5f73 616d 706c 6573 2864  .score_samples(d
-00015d90: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
-00015da0: 2069 6620 6e6f 726d 616c 697a 653a 0a20   if normalize:. 
-00015db0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00015dc0: 203d 2028 7920 2d20 6e70 2e6d 696e 2879   = (y - np.min(y
-00015dd0: 2929 202f 2028 6e70 2e6d 6178 2879 2920  )) / (np.max(y) 
-00015de0: 2d20 6e70 2e6d 696e 2879 2929 0a20 2020  - np.min(y)).   
-00015df0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00015e00: 790a 0a20 2020 2020 2020 2069 6620 6772  y..        if gr
-00015e10: 6f75 7062 795f 6964 7820 6973 206e 6f74  oupby_idx is not
-00015e20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00015e30: 2020 2063 6865 636b 5f69 6e74 280a 2020     check_int(.  
-00015e40: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-00015e50: 6d65 3d66 227b 5374 6174 6973 7469 6373  me=f"{Statistics
-00015e60: 2e65 6c6c 6970 7469 635f 656e 7665 6c6f  .elliptic_envelo
-00015e70: 7065 2e5f 5f6e 616d 655f 5f7d 2067 726f  pe.__name__} gro
-00015e80: 7570 6279 5f69 6478 222c 0a20 2020 2020  upby_idx",.     
-00015e90: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00015ea0: 3d67 726f 7570 6279 5f69 6478 2c0a 2020  =groupby_idx,.  
-00015eb0: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-00015ec0: 6e5f 7661 6c75 653d 302c 0a20 2020 2020  n_value=0,.     
-00015ed0: 2020 2020 2020 2020 2020 206d 6178 5f76             max_v
-00015ee0: 616c 7565 3d64 6174 612e 7368 6170 655b  alue=data.shape[
-00015ef0: 315d 202d 2031 2c0a 2020 2020 2020 2020  1] - 1,.        
-00015f00: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00015f10: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
-00015f20: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
-00015f30: 2020 2020 2073 6f75 7263 653d 6622 7b53       source=f"{S
-00015f40: 7461 7469 7374 6963 732e 656c 6c69 7074  tatistics.ellipt
-00015f50: 6963 5f65 6e76 656c 6f70 652e 5f5f 6e61  ic_envelope.__na
-00015f60: 6d65 5f5f 7d20 6c6f 6361 6c5f 6f75 746c  me__} local_outl
-00015f70: 6965 725f 6661 6374 6f72 222c 0a20 2020  ier_factor",.   
-00015f80: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00015f90: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
-00015fa0: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00015fb0: 5f73 697a 6573 3d5b 325d 2c0a 2020 2020  _sizes=[2],.    
-00015fc0: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
-00015fd0: 6178 6973 5f31 3d33 2c0a 2020 2020 2020  axis_1=3,.      
-00015fe0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00015ff0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00016000: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
-00016010: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
-00016020: 2020 2020 2073 6f75 7263 653d 6622 7b53       source=f"{S
-00016030: 7461 7469 7374 6963 732e 656c 6c69 7074  tatistics.ellipt
-00016040: 6963 5f65 6e76 656c 6f70 652e 5f5f 6e61  ic_envelope.__na
-00016050: 6d65 5f5f 7d20 6461 7461 222c 0a20 2020  me__} data",.   
-00016060: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00016070: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
-00016080: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00016090: 5f73 697a 6573 3d5b 325d 2c0a 2020 2020  _sizes=[2],.    
-000160a0: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
-000160b0: 6178 6973 5f31 3d32 2c0a 2020 2020 2020  axis_1=2,.      
-000160c0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000160d0: 2063 6865 636b 5f66 6c6f 6174 280a 2020   check_float(.  
-000160e0: 2020 2020 2020 2020 2020 6e61 6d65 3d66            name=f
-000160f0: 227b 5374 6174 6973 7469 6373 2e65 6c6c  "{Statistics.ell
-00016100: 6970 7469 635f 656e 7665 6c6f 7065 2e5f  iptic_envelope._
-00016110: 5f6e 616d 655f 5f7d 2063 6f6e 7461 6d69  _name__} contami
-00016120: 6e61 7469 6f6e 222c 0a20 2020 2020 2020  nation",.       
-00016130: 2020 2020 2076 616c 7565 3d63 6f6e 7461       value=conta
-00016140: 6d69 6e61 7469 6f6e 2c0a 2020 2020 2020  mination,.      
-00016150: 2020 2020 2020 6d69 6e5f 7661 6c75 653d        min_value=
-00016160: 302e 302c 0a20 2020 2020 2020 2020 2020  0.0,.           
-00016170: 206d 6178 5f76 616c 7565 3d31 2e30 2c0a   max_value=1.0,.
-00016180: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00016190: 2020 6966 2067 726f 7570 6279 5f69 6478    if groupby_idx
-000161a0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-000161b0: 2020 2020 2020 7265 7475 726e 2067 6574        return get
-000161c0: 5f65 6e76 656c 6f70 6528 6461 7461 2c20  _envelope(data, 
-000161d0: 636f 6e74 616d 696e 6174 696f 6e29 0a20  contamination). 
-000161e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000161f0: 2020 2020 2020 2020 2072 6573 756c 7473           results
-00016200: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-00016210: 2020 6461 7461 5f77 5f69 6478 203d 206e    data_w_idx = n
-00016220: 702e 6873 7461 636b 2828 6e70 2e61 7261  p.hstack((np.ara
-00016230: 6e67 6528 302c 2064 6174 612e 7368 6170  nge(0, data.shap
-00016240: 655b 305d 292e 7265 7368 6170 6528 2d31  e[0]).reshape(-1
-00016250: 2c20 3129 2c20 6461 7461 2929 0a20 2020  , 1), data)).   
-00016260: 2020 2020 2020 2020 2075 6e69 7175 655f           unique_
-00016270: 6320 3d20 6e70 2e75 6e69 7175 6528 6461  c = np.unique(da
-00016280: 7461 5b3a 2c20 6772 6f75 7062 795f 6964  ta[:, groupby_id
-00016290: 785d 292e 6173 7479 7065 286e 702e 666c  x]).astype(np.fl
-000162a0: 6f61 7433 3229 0a20 2020 2020 2020 2020  oat32).         
-000162b0: 2020 2069 6620 2d31 2e30 2069 6e20 756e     if -1.0 in un
-000162c0: 6971 7565 5f63 3a0a 2020 2020 2020 2020  ique_c:.        
-000162d0: 2020 2020 2020 2020 756e 6971 7565 5f63          unique_c
-000162e0: 203d 2075 6e69 7175 655f 635b 6e70 2e77   = unique_c[np.w
-000162f0: 6865 7265 2875 6e69 7175 655f 6320 213d  here(unique_c !=
-00016300: 202d 3129 5d0a 2020 2020 2020 2020 2020   -1)].          
-00016310: 2020 2020 2020 756e 636c 7573 7465 7265        unclustere
-00016320: 645f 6964 7820 3d20 6e70 2e61 7267 7768  d_idx = np.argwh
-00016330: 6572 6528 6461 7461 5b3a 2c20 6772 6f75  ere(data[:, grou
-00016340: 7062 795f 6964 785d 203d 3d20 2d31 2e30  pby_idx] == -1.0
-00016350: 292e 666c 6174 7465 6e28 290a 2020 2020  ).flatten().    
-00016360: 2020 2020 2020 2020 2020 2020 756e 636c              uncl
-00016370: 7573 7465 7265 6420 3d20 6461 7461 5f77  ustered = data_w
-00016380: 5f69 6478 5b75 6e63 6c75 7374 6572 6564  _idx[unclustered
-00016390: 5f69 6478 5d0a 2020 2020 2020 2020 2020  _idx].          
-000163a0: 2020 2020 2020 6461 7461 5f77 5f69 6478        data_w_idx
-000163b0: 203d 206e 702e 6465 6c65 7465 2864 6174   = np.delete(dat
-000163c0: 615f 775f 6964 782c 2075 6e63 6c75 7374  a_w_idx, unclust
-000163d0: 6572 6564 5f69 6478 2c20 6178 6973 3d30  ered_idx, axis=0
-000163e0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-000163f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00016400: 2020 2020 756e 636c 7573 7465 7265 6420      unclustered 
-00016410: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-00016420: 2020 2066 6f72 2069 2069 6e20 756e 6971     for i in uniq
-00016430: 7565 5f63 3a0a 2020 2020 2020 2020 2020  ue_c:.          
-00016440: 2020 2020 2020 735f 6461 7461 203d 2064        s_data = d
-00016450: 6174 615f 775f 6964 785b 0a20 2020 2020  ata_w_idx[.     
-00016460: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00016470: 702e 6172 6777 6865 7265 2864 6174 615f  p.argwhere(data_
-00016480: 775f 6964 785b 3a2c 2067 726f 7570 6279  w_idx[:, groupby
-00016490: 5f69 6478 202b 2031 5d20 3d3d 2069 290a  _idx + 1] == i).
-000164a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164b0: 5d2e 7265 7368 6170 6528 2d31 2c20 6461  ].reshape(-1, da
-000164c0: 7461 5f77 5f69 6478 2e73 6861 7065 5b31  ta_w_idx.shape[1
-000164d0: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-000164e0: 2020 2069 6478 203d 2073 5f64 6174 615b     idx = s_data[
-000164f0: 3a2c 2030 5d2e 7265 7368 6170 6528 735f  :, 0].reshape(s_
-00016500: 6461 7461 2e73 6861 7065 5b30 5d2c 2031  data.shape[0], 1
-00016510: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00016520: 2020 735f 6461 7461 203d 206e 702e 6465    s_data = np.de
-00016530: 6c65 7465 2873 5f64 6174 612c 205b 302c  lete(s_data, [0,
-00016540: 2067 726f 7570 6279 5f69 6478 202b 2031   groupby_idx + 1
-00016550: 5d2c 2031 290a 2020 2020 2020 2020 2020  ], 1).          
-00016560: 2020 2020 2020 6c6f 6620 3d20 6765 745f        lof = get_
-00016570: 656e 7665 6c6f 7065 2873 5f64 6174 612c  envelope(s_data,
-00016580: 2063 6f6e 7461 6d69 6e61 7469 6f6e 292e   contamination).
-00016590: 7265 7368 6170 6528 735f 6461 7461 2e73  reshape(s_data.s
-000165a0: 6861 7065 5b30 5d2c 2031 290a 2020 2020  hape[0], 1).    
-000165b0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000165c0: 6c74 732e 6170 7065 6e64 286e 702e 6873  lts.append(np.hs
-000165d0: 7461 636b 2828 6964 782c 206c 6f66 2929  tack((idx, lof))
-000165e0: 290a 2020 2020 2020 2020 2020 2020 7820  ).            x 
-000165f0: 3d20 6e70 2e63 6f6e 6361 7465 6e61 7465  = np.concatenate
-00016600: 2872 6573 756c 7473 2c20 6178 6973 3d30  (results, axis=0
-00016610: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00016620: 2075 6e63 6c75 7374 6572 6564 2069 7320   unclustered is 
-00016630: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00016640: 2020 2020 2020 2020 2020 6d61 785f 656e            max_en
-00016650: 765f 7363 6f72 6520 3d20 6e70 2e66 756c  v_score = np.ful
-00016660: 6c28 2875 6e63 6c75 7374 6572 6564 2e73  l((unclustered.s
-00016670: 6861 7065 5b30 5d2c 2031 292c 206e 702e  hape[0], 1), np.
-00016680: 6d61 7828 785b 3a2c 202d 315d 2929 0a20  max(x[:, -1])). 
-00016690: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-000166a0: 6e63 6c75 7374 6572 6564 203d 206e 702e  nclustered = np.
-000166b0: 6873 7461 636b 2828 756e 636c 7573 7465  hstack((uncluste
-000166c0: 7265 642c 206d 6178 5f65 6e76 5f73 636f  red, max_env_sco
-000166d0: 7265 2929 5b3a 2c20 5b30 2c20 2d31 5d5d  re))[:, [0, -1]]
-000166e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000166f0: 2078 203d 206e 702e 7673 7461 636b 2828   x = np.vstack((
-00016700: 782c 2075 6e63 6c75 7374 6572 6564 2929  x, unclustered))
-00016710: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00016720: 7572 6e20 785b 6e70 2e61 7267 736f 7274  urn x[np.argsort
-00016730: 2878 5b3a 2c20 305d 295d 5b3a 2c20 2d31  (x[:, 0])][:, -1
-00016740: 5d0a 0a20 2020 2040 7374 6174 6963 6d65  ]..    @staticme
-00016750: 7468 6f64 0a20 2020 2064 6566 2069 736f  thod.    def iso
-00016760: 6c61 7469 6f6e 5f66 6f72 6573 7428 0a20  lation_forest(. 
-00016770: 2020 2020 2020 2078 3a20 6e70 2e6e 6461         x: np.nda
-00016780: 7272 6179 2c0a 2020 2020 2020 2020 6573  rray,.        es
-00016790: 7469 6d61 746f 7273 3a20 556e 696f 6e5b  timators: Union[
-000167a0: 696e 742c 2066 6c6f 6174 5d20 3d20 302e  int, float] = 0.
-000167b0: 322c 0a20 2020 2020 2020 2067 726f 7570  2,.        group
-000167c0: 6279 5f69 6478 3a20 4f70 7469 6f6e 616c  by_idx: Optional
-000167d0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
-000167e0: 2020 2020 2020 6e6f 726d 616c 697a 653a        normalize:
-000167f0: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
-00016800: 3d20 4661 6c73 652c 0a20 2020 2029 3a0a  = False,.    ):.
-00016810: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016820: 2020 2020 416e 2069 6d70 6c65 6d65 6e74      An implement
-00016830: 6174 696f 6e20 6f66 2074 6865 2049 736f  ation of the Iso
-00016840: 6c61 7469 6f6e 2046 6f72 6573 7420 616c  lation Forest al
-00016850: 676f 7269 7468 6d20 666f 7220 6f75 746c  gorithm for outl
-00016860: 6965 7220 6465 7465 6374 696f 6e2e 0a0a  ier detection...
-00016870: 2020 2020 2020 2020 2e2e 2069 6d61 6765          .. image
-00016880: 3a3a 205f 7374 6174 6963 2f69 6d67 2f69  :: _static/img/i
-00016890: 736f 6c61 7469 6f6e 5f66 6f72 6573 742e  solation_forest.
-000168a0: 706e 672e 706e 670a 2020 2020 2020 2020  png.png.        
-000168b0: 2020 203a 7769 6474 683a 2037 3030 0a20     :width: 700. 
-000168c0: 2020 2020 2020 2020 2020 3a61 6c69 676e            :align
-000168d0: 3a20 6365 6e74 6572 0a0a 2020 2020 2020  : center..      
-000168e0: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
-000168f0: 2020 2020 2020 2054 6865 2069 736f 6c61         The isola
-00016900: 7469 6f6e 2066 6f72 6573 7420 7363 6f72  tion forest scor
-00016910: 6573 2061 7265 206e 6567 6174 6564 2e20  es are negated. 
-00016920: 5468 7573 2c20 6869 6768 6572 2076 616c  Thus, higher val
-00016930: 7565 7320 696e 6469 6361 7465 206d 6f72  ues indicate mor
-00016940: 6520 6174 7970 6963 616c 2028 6f75 746c  e atypical (outl
-00016950: 6965 7229 2064 6174 6120 706f 696e 7473  ier) data points
-00016960: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00016970: 6d20 6e70 2e6e 6461 7272 6179 2078 3a20  m np.ndarray x: 
-00016980: 322d 4420 6172 7261 7920 7769 7468 2066  2-D array with f
-00016990: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
-000169a0: 2020 2020 2020 203a 7061 7261 6d20 556e         :param Un
-000169b0: 696f 6e5b 696e 742c 2066 6c6f 6174 5d20  ion[int, float] 
-000169c0: 6573 7469 6d61 746f 7273 3a20 4e75 6d62  estimators: Numb
-000169d0: 6572 206f 6620 7370 6c69 7473 2e20 4966  er of splits. If
-000169e0: 2074 6865 2076 616c 7565 2069 7320 6120   the value is a 
-000169f0: 666c 6f61 742c 2074 6865 6e20 696e 7465  float, then inte
-00016a00: 7270 7265 7465 6420 6173 2074 6865 2072  rpreted as the r
-00016a10: 6174 696f 206f 6620 7820 7368 6170 652e  atio of x shape.
-00016a20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00016a30: 4f70 7469 6f6e 616c 5b69 6e74 5d20 6772  Optional[int] gr
-00016a40: 6f75 7062 795f 6964 783a 2049 6620 696e  oupby_idx: If in
-00016a50: 742c 2074 6865 6e20 7468 6520 696e 6465  t, then the inde
-00016a60: 7820 3120 6f66 2060 6064 6174 6160 6020  x 1 of ``data`` 
-00016a70: 666f 7220 7768 6963 6820 746f 2067 726f  for which to gro
-00016a80: 7570 2074 6865 2064 6174 6120 616e 6420  up the data and 
-00016a90: 636f 6d70 7574 6520 4c4f 4620 6f6e 2065  compute LOF on e
-00016aa0: 6163 6820 7365 676d 656e 742e 2045 2e67  ach segment. E.g
-00016ab0: 2e2c 2063 616e 2062 6520 6669 656c 6420  ., can be field 
-00016ac0: 686f 6c64 696e 6720 6120 636c 7573 7465  holding a cluste
-00016ad0: 7220 6964 656e 7469 6669 6572 2e0a 2020  r identifier..  
-00016ae0: 2020 2020 2020 3a70 6172 616d 204f 7074        :param Opt
-00016af0: 696f 6e61 6c5b 626f 6f6c 5d20 6e6f 726d  ional[bool] norm
-00016b00: 616c 697a 653a 2057 6865 7468 6572 2074  alize: Whether t
-00016b10: 6f20 6e6f 726d 616c 697a 6520 7468 6520  o normalize the 
-00016b20: 6f75 746c 6965 7220 7363 6f72 6520 6265  outlier score be
-00016b30: 7477 6565 6e20 3020 616e 6420 312e 2044  tween 0 and 1. D
-00016b40: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
-00016b50: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-00016b60: 6e3a 0a0a 2020 2020 2020 2020 3a65 7861  n:..        :exa
-00016b70: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00016b80: 3e20 782c 206c 626c 7320 3d20 6d61 6b65  > x, lbls = make
-00016b90: 5f62 6c6f 6273 286e 5f73 616d 706c 6573  _blobs(n_samples
-00016ba0: 3d31 3030 3030 2c20 6e5f 6665 6174 7572  =10000, n_featur
-00016bb0: 6573 3d32 2c20 6365 6e74 6572 733d 3130  es=2, centers=10
-00016bc0: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d34  , random_state=4
-00016bd0: 3229 0a20 2020 2020 2020 203e 3e3e 2078  2).        >>> x
-00016be0: 203d 206e 702e 6873 7461 636b 2828 782c   = np.hstack((x,
-00016bf0: 206c 626c 732e 7265 7368 6170 6528 2d31   lbls.reshape(-1
-00016c00: 2c20 3129 2929 0a20 2020 2020 2020 203e  , 1))).        >
-00016c10: 3e3e 2073 636f 7265 7320 3d20 6973 6f6c  >> scores = isol
-00016c20: 6174 696f 6e5f 666f 7265 7374 2878 3d78  ation_forest(x=x
-00016c30: 2c20 6573 7469 6d61 746f 7273 3d31 302c  , estimators=10,
-00016c40: 206e 6f72 6d61 6c69 7a65 3d54 7275 6529   normalize=True)
-00016c50: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-00016c60: 756c 7473 203d 206e 702e 6873 7461 636b  ults = np.hstack
-00016c70: 2828 785b 3a2c 2030 3a32 5d2c 2073 636f  ((x[:, 0:2], sco
-00016c80: 7265 732e 7265 7368 6170 6528 7363 6f72  res.reshape(scor
-00016c90: 6573 2e73 6861 7065 5b30 5d2c 2031 2929  es.shape[0], 1))
-00016ca0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-00016cb0: 7375 6c74 7320 3d20 7064 2e44 6174 6146  sults = pd.DataF
-00016cc0: 7261 6d65 2872 6573 756c 7473 2c20 636f  rame(results, co
-00016cd0: 6c75 6d6e 733d 5b27 5827 2c20 2759 272c  lumns=['X', 'Y',
-00016ce0: 2027 4953 4f4c 4154 494f 4e20 5343 4f52   'ISOLATION SCOR
-00016cf0: 4527 5d29 0a20 2020 2020 2020 203e 3e3e  E']).        >>>
-00016d00: 2050 6c6f 7474 696e 674d 6978 696e 2e63   PlottingMixin.c
-00016d10: 6f6e 7469 6e75 6f75 735f 7363 6174 7465  ontinuous_scatte
-00016d20: 7228 6461 7461 3d72 6573 756c 7473 2c20  r(data=results, 
-00016d30: 7061 6c65 7474 653d 2773 6569 736d 6963  palette='seismic
-00016d40: 272c 2062 675f 636c 723d 276c 6967 6874  ', bg_clr='light
-00016d50: 6772 6579 272c 2063 6f6c 756d 6e73 3d5b  grey', columns=[
-00016d60: 2758 272c 2027 5927 2c20 2749 534f 4c41  'X', 'Y', 'ISOLA
-00016d70: 5449 4f4e 2053 434f 5245 275d 2c73 697a  TION SCORE'],siz
-00016d80: 653d 3330 290a 0a20 2020 2020 2020 2022  e=30)..        "
-00016d90: 2222 0a0a 2020 2020 2020 2020 6465 6620  ""..        def 
-00016da0: 6765 745f 6966 5f73 636f 7265 7328 783a  get_if_scores(x:
-00016db0: 206e 702e 6e64 6172 7261 792c 2065 7374   np.ndarray, est
-00016dc0: 696d 6174 6f72 733a 2065 7374 696d 6174  imators: estimat
-00016dd0: 6f72 7329 3a0a 2020 2020 2020 2020 2020  ors):.          
-00016de0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00016df0: 6573 7469 6d61 746f 7273 2c20 666c 6f61  estimators, floa
-00016e00: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00016e10: 2020 2020 6368 6563 6b5f 666c 6f61 7428      check_float(
-00016e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016e30: 2020 2020 206e 616d 653d 6622 7b53 7461       name=f"{Sta
-00016e40: 7469 7374 6963 732e 6973 6f6c 6174 696f  tistics.isolatio
-00016e50: 6e5f 666f 7265 7374 2e5f 5f6e 616d 655f  n_forest.__name_
-00016e60: 5f7d 2065 7374 696d 6174 6f72 7322 2c0a  _} estimators",.
-00016e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e80: 2020 2020 7661 6c75 653d 6573 7469 6d61      value=estima
-00016e90: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00016ea0: 2020 2020 2020 2020 2020 6d69 6e5f 7661            min_va
-00016eb0: 6c75 653d 3130 652d 362c 0a20 2020 2020  lue=10e-6,.     
-00016ec0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00016ed0: 6178 5f76 616c 7565 3d31 2e30 2c0a 2020  ax_value=1.0,.  
-00016ee0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00016ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f00: 6573 7469 6d61 746f 7273 203d 2078 2e73  estimators = x.s
-00016f10: 6861 7065 5b30 5d20 2a20 6573 7469 6d61  hape[0] * estima
-00016f20: 746f 7273 0a20 2020 2020 2020 2020 2020  tors.           
-00016f30: 2020 2020 2069 6620 6573 7469 6d61 746f       if estimato
-00016f40: 7273 203c 2031 3a0a 2020 2020 2020 2020  rs < 1:.        
-00016f50: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-00016f60: 6d61 746f 7273 203d 2031 0a20 2020 2020  mators = 1.     
-00016f70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00016f80: 2020 2020 2020 2020 2020 2020 2063 6865               che
-00016f90: 636b 5f69 6e74 280a 2020 2020 2020 2020  ck_int(.        
-00016fa0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00016fb0: 3d66 227b 5374 6174 6973 7469 6373 2e69  =f"{Statistics.i
-00016fc0: 736f 6c61 7469 6f6e 5f66 6f72 6573 742e  solation_forest.
-00016fd0: 5f5f 6e61 6d65 5f5f 2e5f 5f6e 616d 655f  __name__.__name_
-00016fe0: 5f7d 2065 7374 696d 6174 6f72 7322 2c0a  _} estimators",.
-00016ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017000: 2020 2020 7661 6c75 653d 6573 7469 6d61      value=estima
-00017010: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00017020: 2020 2020 2020 2020 2020 6d69 6e5f 7661            min_va
-00017030: 6c75 653d 312c 0a20 2020 2020 2020 2020  lue=1,.         
-00017040: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00017050: 2020 2020 206d 646c 203d 2049 736f 6c61       mdl = Isola
-00017060: 7469 6f6e 466f 7265 7374 280a 2020 2020  tionForest(.    
-00017070: 2020 2020 2020 2020 2020 2020 6e5f 6573              n_es
-00017080: 7469 6d61 746f 7273 3d65 7374 696d 6174  timators=estimat
-00017090: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
-000170a0: 2020 2020 206e 5f6a 6f62 733d 2d31 2c0a       n_jobs=-1,.
-000170b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170c0: 6265 6861 7669 6f75 723d 226e 6577 222c  behaviour="new",
-000170d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000170e0: 2063 6f6e 7461 6d69 6e61 7469 6f6e 3d22   contamination="
-000170f0: 6175 746f 222c 0a20 2020 2020 2020 2020  auto",.         
-00017100: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00017110: 2072 203d 2061 6273 286d 646c 2e66 6974   r = abs(mdl.fit
-00017120: 2878 292e 7363 6f72 655f 7361 6d70 6c65  (x).score_sample
-00017130: 7328 7829 290a 2020 2020 2020 2020 2020  s(x)).          
-00017140: 2020 6966 206e 6f72 6d61 6c69 7a65 3a0a    if normalize:.
-00017150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017160: 7220 3d20 2872 202d 206e 702e 6d69 6e28  r = (r - np.min(
-00017170: 7229 2920 2f20 286e 702e 6d61 7828 7229  r)) / (np.max(r)
-00017180: 202d 206e 702e 6d69 6e28 7229 290a 2020   - np.min(r)).  
-00017190: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000171a0: 2072 0a0a 2020 2020 2020 2020 6966 2067   r..        if g
-000171b0: 726f 7570 6279 5f69 6478 2069 7320 4e6f  roupby_idx is No
-000171c0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000171d0: 6368 6563 6b5f 7661 6c69 645f 6172 7261  check_valid_arra
-000171e0: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
-000171f0: 2020 2064 6174 613d 782c 0a20 2020 2020     data=x,.     
-00017200: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-00017210: 653d 5374 6174 6973 7469 6373 2e69 736f  e=Statistics.iso
-00017220: 6c61 7469 6f6e 5f66 6f72 6573 742e 5f5f  lation_forest.__
-00017230: 6e61 6d65 5f5f 2e5f 5f6e 616d 655f 5f2c  name__.__name__,
-00017240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017250: 2061 6363 6570 7465 645f 6e64 696d 733d   accepted_ndims=
-00017260: 2832 2c29 2c0a 2020 2020 2020 2020 2020  (2,),.          
-00017270: 2020 2020 2020 6d69 6e5f 6178 6973 5f31        min_axis_1
-00017280: 3d32 2c0a 2020 2020 2020 2020 2020 2020  =2,.            
-00017290: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
-000172a0: 7065 733d 280a 2020 2020 2020 2020 2020  pes=(.          
-000172b0: 2020 2020 2020 2020 2020 6e70 2e69 6e74            np.int
-000172c0: 3634 2c0a 2020 2020 2020 2020 2020 2020  64,.            
-000172d0: 2020 2020 2020 2020 6e70 2e69 6e74 3332          np.int32
-000172e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000172f0: 2020 2020 2020 6e70 2e69 6e74 382c 0a20        np.int8,. 
-00017300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017310: 2020 206e 702e 666c 6f61 7433 322c 0a20     np.float32,. 
-00017320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017330: 2020 206e 702e 666c 6f61 7436 342c 0a20     np.float64,. 
-00017340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017350: 2020 2069 6e74 2c0a 2020 2020 2020 2020     int,.        
-00017360: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
-00017370: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00017380: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-00017390: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000173a0: 7265 7475 726e 2067 6574 5f69 665f 7363  return get_if_sc
-000173b0: 6f72 6573 2878 3d78 2c20 6573 7469 6d61  ores(x=x, estima
-000173c0: 746f 7273 3d65 7374 696d 6174 6f72 7329  tors=estimators)
-000173d0: 0a0a 2020 2020 2020 2020 656c 7365 3a0a  ..        else:.
-000173e0: 2020 2020 2020 2020 2020 2020 6368 6563              chec
-000173f0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-00017400: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00017410: 6174 613d 782c 0a20 2020 2020 2020 2020  ata=x,.         
-00017420: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
-00017430: 6174 6973 7469 6373 2e69 736f 6c61 7469  atistics.isolati
-00017440: 6f6e 5f66 6f72 6573 742e 5f5f 6e61 6d65  on_forest.__name
-00017450: 5f5f 2e5f 5f6e 616d 655f 5f2c 0a20 2020  __.__name__,.   
-00017460: 2020 2020 2020 2020 2020 2020 2061 6363               acc
-00017470: 6570 7465 645f 6e64 696d 733d 2832 2c29  epted_ndims=(2,)
-00017480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017490: 2020 6d69 6e5f 6178 6973 5f31 3d33 2c0a    min_axis_1=3,.
-000174a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174b0: 6163 6365 7074 6564 5f64 7479 7065 733d  accepted_dtypes=
-000174c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000174d0: 2020 2020 2020 6e70 2e69 6e74 3634 2c0a        np.int64,.
-000174e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174f0: 2020 2020 6e70 2e69 6e74 3332 2c0a 2020      np.int32,.  
-00017500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017510: 2020 6e70 2e69 6e74 382c 0a20 2020 2020    np.int8,.     
-00017520: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00017530: 702e 666c 6f61 7433 322c 0a20 2020 2020  p.float32,.     
-00017540: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00017550: 702e 666c 6f61 7436 342c 0a20 2020 2020  p.float64,.     
-00017560: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00017570: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-00017580: 2020 2020 2020 2020 666c 6f61 742c 0a20          float,. 
-00017590: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000175a0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-000175b0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-000175c0: 6c74 7320 3d20 5b5d 0a20 2020 2020 2020  lts = [].       
-000175d0: 2020 2020 2064 6174 615f 775f 6964 7820       data_w_idx 
-000175e0: 3d20 6e70 2e68 7374 6163 6b28 286e 702e  = np.hstack((np.
-000175f0: 6172 616e 6765 2830 2c20 782e 7368 6170  arange(0, x.shap
-00017600: 655b 305d 292e 7265 7368 6170 6528 2d31  e[0]).reshape(-1
-00017610: 2c20 3129 2c20 7829 290a 2020 2020 2020  , 1), x)).      
-00017620: 2020 2020 2020 756e 6971 7565 5f63 203d        unique_c =
-00017630: 206e 702e 756e 6971 7565 2878 5b3a 2c20   np.unique(x[:, 
-00017640: 6772 6f75 7062 795f 6964 785d 292e 6173  groupby_idx]).as
-00017650: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00017660: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00017670: 2d31 2e30 2069 6e20 756e 6971 7565 5f63  -1.0 in unique_c
-00017680: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00017690: 2020 756e 6971 7565 5f63 203d 2075 6e69    unique_c = uni
-000176a0: 7175 655f 635b 6e70 2e77 6865 7265 2875  que_c[np.where(u
-000176b0: 6e69 7175 655f 6320 213d 202d 3129 5d0a  nique_c != -1)].
-000176c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176d0: 756e 636c 7573 7465 7265 645f 6964 7820  unclustered_idx 
-000176e0: 3d20 6e70 2e61 7267 7768 6572 6528 785b  = np.argwhere(x[
-000176f0: 3a2c 2067 726f 7570 6279 5f69 6478 5d20  :, groupby_idx] 
-00017700: 3d3d 202d 312e 3029 2e66 6c61 7474 656e  == -1.0).flatten
-00017710: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00017720: 2020 2075 6e63 6c75 7374 6572 6564 203d     unclustered =
-00017730: 2064 6174 615f 775f 6964 785b 756e 636c   data_w_idx[uncl
-00017740: 7573 7465 7265 645f 6964 785d 0a20 2020  ustered_idx].   
-00017750: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00017760: 615f 775f 6964 7820 3d20 6e70 2e64 656c  a_w_idx = np.del
-00017770: 6574 6528 6461 7461 5f77 5f69 6478 2c20  ete(data_w_idx, 
-00017780: 756e 636c 7573 7465 7265 645f 6964 782c  unclustered_idx,
-00017790: 2061 7869 733d 3029 0a20 2020 2020 2020   axis=0).       
-000177a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000177b0: 2020 2020 2020 2020 2020 2075 6e63 6c75             unclu
-000177c0: 7374 6572 6564 203d 204e 6f6e 650a 2020  stered = None.  
-000177d0: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-000177e0: 696e 2075 6e69 7175 655f 633a 0a20 2020  in unique_c:.   
-000177f0: 2020 2020 2020 2020 2020 2020 2073 5f64               s_d
-00017800: 6174 6120 3d20 6461 7461 5f77 5f69 6478  ata = data_w_idx
-00017810: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00017820: 2020 2020 2020 6e70 2e61 7267 7768 6572        np.argwher
-00017830: 6528 6461 7461 5f77 5f69 6478 5b3a 2c20  e(data_w_idx[:, 
-00017840: 6772 6f75 7062 795f 6964 7820 2b20 315d  groupby_idx + 1]
-00017850: 203d 3d20 6929 0a20 2020 2020 2020 2020   == i).         
-00017860: 2020 2020 2020 205d 2e72 6573 6861 7065         ].reshape
-00017870: 282d 312c 2064 6174 615f 775f 6964 782e  (-1, data_w_idx.
-00017880: 7368 6170 655b 315d 290a 2020 2020 2020  shape[1]).      
-00017890: 2020 2020 2020 2020 2020 6964 7820 3d20            idx = 
-000178a0: 735f 6461 7461 5b3a 2c20 305d 2e72 6573  s_data[:, 0].res
-000178b0: 6861 7065 2873 5f64 6174 612e 7368 6170  hape(s_data.shap
-000178c0: 655b 305d 2c20 3129 0a20 2020 2020 2020  e[0], 1).       
-000178d0: 2020 2020 2020 2020 2073 5f64 6174 6120           s_data 
-000178e0: 3d20 6e70 2e64 656c 6574 6528 735f 6461  = np.delete(s_da
-000178f0: 7461 2c20 5b30 2c20 6772 6f75 7062 795f  ta, [0, groupby_
-00017900: 6964 7820 2b20 315d 2c20 3129 0a20 2020  idx + 1], 1).   
-00017910: 2020 2020 2020 2020 2020 2020 2069 5f66               i_f
-00017920: 203d 2067 6574 5f69 665f 7363 6f72 6573   = get_if_scores
-00017930: 2873 5f64 6174 612c 2065 7374 696d 6174  (s_data, estimat
-00017940: 6f72 7329 2e72 6573 6861 7065 2873 5f64  ors).reshape(s_d
-00017950: 6174 612e 7368 6170 655b 305d 2c20 3129  ata.shape[0], 1)
-00017960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017970: 2072 6573 756c 7473 2e61 7070 656e 6428   results.append(
-00017980: 6e70 2e68 7374 6163 6b28 2869 6478 2c20  np.hstack((idx, 
-00017990: 695f 6629 2929 0a20 2020 2020 2020 2020  i_f))).         
-000179a0: 2020 2078 203d 206e 702e 636f 6e63 6174     x = np.concat
-000179b0: 656e 6174 6528 7265 7375 6c74 732c 2061  enate(results, a
-000179c0: 7869 733d 3029 0a20 2020 2020 2020 2020  xis=0).         
-000179d0: 2020 2069 6620 756e 636c 7573 7465 7265     if unclustere
-000179e0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
-000179f0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00017a00: 6178 5f69 6620 3d20 6e70 2e66 756c 6c28  ax_if = np.full(
-00017a10: 2875 6e63 6c75 7374 6572 6564 2e73 6861  (unclustered.sha
-00017a20: 7065 5b30 5d2c 2031 292c 206e 702e 6d61  pe[0], 1), np.ma
-00017a30: 7828 785b 3a2c 202d 315d 2929 0a20 2020  x(x[:, -1])).   
-00017a40: 2020 2020 2020 2020 2020 2020 2075 6e63               unc
-00017a50: 6c75 7374 6572 6564 203d 206e 702e 6873  lustered = np.hs
-00017a60: 7461 636b 2828 756e 636c 7573 7465 7265  tack((unclustere
-00017a70: 642c 206d 6178 5f69 6629 295b 3a2c 205b  d, max_if))[:, [
-00017a80: 302c 202d 315d 5d0a 2020 2020 2020 2020  0, -1]].        
-00017a90: 2020 2020 2020 2020 7820 3d20 6e70 2e76          x = np.v
-00017aa0: 7374 6163 6b28 2878 2c20 756e 636c 7573  stack((x, unclus
-00017ab0: 7465 7265 6429 290a 2020 2020 2020 2020  tered)).        
-00017ac0: 2020 2020 7265 7475 726e 2078 5b6e 702e      return x[np.
-00017ad0: 6172 6773 6f72 7428 785b 3a2c 2030 5d29  argsort(x[:, 0])
-00017ae0: 5d5b 3a2c 202d 315d 0a0a 2020 2020 4073  ][:, -1]..    @s
-00017af0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
-00017b00: 406a 6974 286e 6f70 7974 686f 6e3d 5472  @jit(nopython=Tr
-00017b10: 7565 290a 2020 2020 6465 6620 5f68 626f  ue).    def _hbo
-00017b20: 735f 636f 6d70 7574 6528 0a20 2020 2020  s_compute(.     
-00017b30: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
-00017b40: 7261 792c 2068 6973 746f 6772 616d 733a  ray, histograms:
-00017b50: 2074 7970 6564 2e44 6963 742c 2068 6973   typed.Dict, his
-00017b60: 746f 6772 616d 5f65 6467 6573 3a20 7479  togram_edges: ty
-00017b70: 7065 642e 4469 6374 0a20 2020 2029 202d  ped.Dict.    ) -
-00017b80: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
-00017b90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00017ba0: 2020 4a69 7474 6564 2068 656c 7065 7220    Jitted helper 
-00017bb0: 746f 2063 6f6d 7075 7465 2048 6973 746f  to compute Histo
-00017bc0: 6772 616d 2d62 6173 6564 204f 7574 6c69  gram-based Outli
-00017bd0: 6572 2053 636f 7265 2028 4842 4f53 2920  er Score (HBOS) 
-00017be0: 6361 6c6c 6564 2062 7920 6060 7369 6d62  called by ``simb
-00017bf0: 612e 6d69 7869 6e73 2e73 7461 7469 7374  a.mixins.statist
-00017c00: 6963 735f 6d69 7869 6e2e 5374 6174 6973  ics_mixin.Statis
-00017c10: 7469 6373 2e68 626f 7360 602e 0a0a 2020  tics.hbos``...  
-00017c20: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-00017c30: 206e 702e 6e64 6172 7261 7920 6461 7461   np.ndarray data
-00017c40: 3a20 3264 2061 7272 6179 2077 6974 6820  : 2d array with 
-00017c50: 6672 616d 6573 2072 6570 7265 7365 6e74  frames represent
-00017c60: 6564 2062 7920 726f 7773 2061 6e64 2063  ed by rows and c
-00017c70: 6f6c 756d 6e73 2072 6570 7265 7365 6e74  olumns represent
-00017c80: 696e 6720 6665 6174 7572 6520 7661 6c75  ing feature valu
-00017c90: 6573 2e0a 2020 2020 2020 2020 3a70 6172  es..        :par
-00017ca0: 616d 6574 6572 2074 7970 6564 2e44 6963  ameter typed.Dic
-00017cb0: 7420 6869 7374 6f67 7261 6d73 3a20 4e75  t histograms: Nu
-00017cc0: 6d62 6120 7479 7065 642e 4469 6374 2077  mba typed.Dict w
-00017cd0: 6974 6820 696e 7465 6765 7220 6b65 7973  ith integer keys
-00017ce0: 2028 7265 7072 6573 656e 7469 6e67 206f   (representing o
-00017cf0: 7264 6572 206f 6620 6665 6174 7572 6529  rder of feature)
-00017d00: 2061 6e64 2031 6420 6172 7261 7973 2061   and 1d arrays a
-00017d10: 7320 7661 6c75 6573 2072 6570 7265 7365  s values represe
-00017d20: 6e74 696e 6720 6f62 7365 7276 6174 696f  nting observatio
-00017d30: 6e20 6269 6e20 636f 756e 7473 2e0a 2020  n bin counts..  
-00017d40: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-00017d50: 3a20 7479 7065 642e 4469 6374 2068 6973  : typed.Dict his
-00017d60: 746f 6772 616d 5f65 6467 6573 3a20 4e75  togram_edges: Nu
-00017d70: 6d62 6120 7479 7065 642e 4469 6374 2077  mba typed.Dict w
-00017d80: 6974 6820 696e 7465 6765 7220 6b65 7973  ith integer keys
-00017d90: 2028 7265 7072 6573 656e 7469 6e67 206f   (representing o
-00017da0: 7264 6572 206f 6620 6665 6174 7572 6529  rder of feature)
-00017db0: 2061 6e64 2031 6420 6172 7261 7973 2061   and 1d arrays a
-00017dc0: 7320 7661 6c75 6573 2072 6570 7265 7365  s values represe
-00017dd0: 6e74 696e 6720 6269 6e20 6564 6765 732e  nting bin edges.
-00017de0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00017df0: 206e 702e 6e64 6172 7261 793a 2041 7272   np.ndarray: Arr
-00017e00: 6179 206f 6620 7369 7a65 2064 6174 612e  ay of size data.
-00017e10: 7368 6170 655b 305d 2072 6570 7265 7365  shape[0] represe
-00017e20: 6e74 696e 6720 6f75 746c 6965 7220 7363  nting outlier sc
-00017e30: 6f72 6573 2c20 7769 7468 2068 6967 6865  ores, with highe
-00017e40: 7220 7661 6c75 6573 2072 6570 7265 7365  r values represe
-00017e50: 6e74 696e 6720 6772 6561 7465 7220 6f75  nting greater ou
-00017e60: 746c 6965 7273 2e0a 2020 2020 2020 2020  tliers..        
-00017e70: 2222 220a 0a20 2020 2020 2020 2072 6573  """..        res
-00017e80: 756c 7473 203d 206e 702e 6675 6c6c 2828  ults = np.full((
-00017e90: 6461 7461 2e73 6861 7065 5b30 5d29 2c20  data.shape[0]), 
-00017ea0: 6e70 2e6e 616e 290a 2020 2020 2020 2020  np.nan).        
-00017eb0: 6461 7461 203d 2064 6174 612e 6173 7479  data = data.asty
-00017ec0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-00017ed0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00017ee0: 7072 616e 6765 2864 6174 612e 7368 6170  prange(data.shap
-00017ef0: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
-00017f00: 2020 2073 636f 7265 203d 2030 2e30 0a20     score = 0.0. 
-00017f10: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-00017f20: 2069 6e20 7072 616e 6765 2864 6174 612e   in prange(data.
-00017f30: 7368 6170 655b 315d 293a 0a20 2020 2020  shape[1]):.     
-00017f40: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00017f50: 2c20 6269 6e5f 6964 7820 3d20 6461 7461  , bin_idx = data
-00017f60: 5b69 5d5b 6a5d 2c20 6e70 2e6e 616e 0a20  [i][j], np.nan. 
-00017f70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00017f80: 6f72 206b 2069 6e20 6e70 2e61 7261 6e67  or k in np.arang
-00017f90: 6528 6869 7374 6f67 7261 6d5f 6564 6765  e(histogram_edge
-00017fa0: 735b 6a5d 2e73 6861 7065 5b30 5d2c 2030  s[j].shape[0], 0
-00017fb0: 2c20 2d31 293a 0a20 2020 2020 2020 2020  , -1):.         
-00017fc0: 2020 2020 2020 2020 2020 2062 696e 5f6d             bin_m
-00017fd0: 6178 2c20 6269 6e5f 6d69 6e20 3d20 6869  ax, bin_min = hi
-00017fe0: 7374 6f67 7261 6d5f 6564 6765 735b 6a5d  stogram_edges[j]
-00017ff0: 5b6b 5d2c 2068 6973 746f 6772 616d 5f65  [k], histogram_e
-00018000: 6467 6573 5b6a 5d5b 6b20 2d20 315d 0a20  dges[j][k - 1]. 
-00018010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018020: 2020 2069 6620 2876 616c 7565 203c 3d20     if (value <= 
-00018030: 6269 6e5f 6d61 7829 2061 6e64 2028 7661  bin_max) and (va
-00018040: 6c75 6520 3e20 6269 6e5f 6d69 6e29 3a0a  lue > bin_min):.
-00018050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018060: 2020 2020 2020 2020 6269 6e5f 6964 7820          bin_idx 
-00018070: 3d20 6b0a 2020 2020 2020 2020 2020 2020  = k.            
-00018080: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00018090: 696e 7565 0a20 2020 2020 2020 2020 2020  inue.           
-000180a0: 2020 2020 2069 6620 6e70 2e69 736e 616e       if np.isnan
-000180b0: 2862 696e 5f69 6478 293a 0a20 2020 2020  (bin_idx):.     
-000180c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-000180d0: 696e 5f69 6478 203d 2030 0a20 2020 2020  in_idx = 0.     
-000180e0: 2020 2020 2020 2020 2020 2073 636f 7265             score
-000180f0: 202b 3d20 2d6e 702e 6c6f 6728 6869 7374   += -np.log(hist
-00018100: 6f67 7261 6d73 5b6a 5d5b 696e 7428 6269  ograms[j][int(bi
-00018110: 6e5f 6964 7829 202d 2031 5d20 2b20 3165  n_idx) - 1] + 1e
-00018120: 2d31 3029 0a20 2020 2020 2020 2020 2020  -10).           
-00018130: 2072 6573 756c 7473 5b69 5d20 3d20 7363   results[i] = sc
-00018140: 6f72 650a 2020 2020 2020 2020 7265 7475  ore.        retu
-00018150: 726e 2072 6573 756c 7473 0a0a 2020 2020  rn results..    
-00018160: 6465 6620 6862 6f73 280a 2020 2020 2020  def hbos(.      
-00018170: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00018180: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00018190: 2c0a 2020 2020 2020 2020 6275 636b 6574  ,.        bucket
-000181a0: 5f6d 6574 686f 643a 204c 6974 6572 616c  _method: Literal
-000181b0: 5b0a 2020 2020 2020 2020 2020 2020 2266  [.            "f
-000181c0: 6422 2c20 2264 6f61 6e65 222c 2022 6175  d", "doane", "au
-000181d0: 746f 222c 2022 7363 6f74 7422 2c20 2273  to", "scott", "s
-000181e0: 746f 6e65 222c 2022 7269 6365 222c 2022  tone", "rice", "
-000181f0: 7374 7572 6765 7322 2c20 2273 7172 7422  sturges", "sqrt"
-00018200: 0a20 2020 2020 2020 205d 203d 2022 6175  .        ] = "au
-00018210: 746f 222c 0a20 2020 2029 202d 3e20 6e70  to",.    ) -> np
-00018220: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
-00018230: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
-00018240: 7474 6564 2063 6f6d 7075 7465 206f 6620  tted compute of 
-00018250: 4869 7374 6f67 7261 6d2d 6261 7365 6420  Histogram-based 
-00018260: 4f75 746c 6965 7220 5363 6f72 6573 2028  Outlier Scores (
-00018270: 4842 4f53 292e 2048 424f 5320 7175 616e  HBOS). HBOS quan
-00018280: 7469 6669 6573 2074 6865 2061 626e 6f72  tifies the abnor
-00018290: 6d61 6c69 7479 206f 6620 6461 7461 2070  mality of data p
-000182a0: 6f69 6e74 7320 6261 7365 6420 6f6e 2074  oints based on t
-000182b0: 6865 2064 656e 7369 7469 6573 206f 6620  he densities of 
-000182c0: 7468 6569 7220 6665 6174 7572 6520 7661  their feature va
-000182d0: 6c75 6573 0a20 2020 2020 2020 2077 6974  lues.        wit
-000182e0: 6869 6e20 7468 6569 7220 7265 7370 6563  hin their respec
-000182f0: 7469 7665 2062 7563 6b65 7473 206f 7665  tive buckets ove
-00018300: 7220 616c 6c20 6665 6174 7572 6520 7661  r all feature va
-00018310: 6c75 6573 2e0a 0a20 2020 2020 2020 203a  lues...        :
-00018320: 7061 7261 6d65 7465 7220 6e70 2e6e 6461  parameter np.nda
-00018330: 7272 6179 2064 6174 613a 2032 6420 6172  rray data: 2d ar
-00018340: 7261 7920 7769 7468 2066 7261 6d65 7320  ray with frames 
-00018350: 7265 7072 6573 656e 7465 6420 6279 2072  represented by r
-00018360: 6f77 7320 616e 6420 636f 6c75 6d6e 7320  ows and columns 
-00018370: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
-00018380: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
-00018390: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
-000183a0: 4c69 7465 7261 6c20 6275 636b 6574 5f6d  Literal bucket_m
-000183b0: 6574 686f 643a 2045 7374 696d 6174 6f72  ethod: Estimator
-000183c0: 2064 6574 6572 6d69 6e69 6e67 206f 7074   determining opt
-000183d0: 696d 616c 2062 7563 6b65 7420 636f 756e  imal bucket coun
-000183e0: 7420 616e 6420 6275 636b 6574 2077 6964  t and bucket wid
-000183f0: 7468 2e20 4465 6661 756c 743a 2054 6865  th. Default: The
-00018400: 206d 6178 696d 756d 206f 6620 7468 6520   maximum of the 
-00018410: 5374 7572 6765 7320 616e 6420 4672 6565  Sturges and Free
-00018420: 646d 616e 2d44 6961 636f 6e69 7320 6573  dman-Diaconis es
-00018430: 7469 6d61 746f 7273 2e0a 2020 2020 2020  timators..      
-00018440: 2020 3a72 6574 7572 6e20 6e70 2e6e 6461    :return np.nda
-00018450: 7272 6179 3a20 4172 7261 7920 6f66 2073  rray: Array of s
-00018460: 697a 6520 6461 7461 2e73 6861 7065 5b30  ize data.shape[0
-00018470: 5d20 7265 7072 6573 656e 7469 6e67 206f  ] representing o
-00018480: 7574 6c69 6572 2073 636f 7265 732c 2077  utlier scores, w
-00018490: 6974 6820 6869 6768 6572 2076 616c 7565  ith higher value
-000184a0: 7320 7265 7072 6573 656e 7469 6e67 2067  s representing g
-000184b0: 7265 6174 6572 206f 7574 6c69 6572 732e  reater outliers.
-000184c0: 0a0a 2020 2020 2020 2020 2e2e 2069 6d61  ..        .. ima
-000184d0: 6765 3a3a 205f 7374 6174 6963 2f69 6d67  ge:: _static/img
-000184e0: 2f68 626f 732e 706e 670a 2020 2020 2020  /hbos.png.      
-000184f0: 2020 2020 203a 7769 6474 683a 2031 3230       :width: 120
-00018500: 300a 2020 2020 2020 2020 2020 203a 616c  0.           :al
-00018510: 6967 6e3a 2063 656e 7465 720a 0a20 2020  ign: center..   
-00018520: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-00018530: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-00018540: 655f 3120 3d20 6e70 2e72 616e 646f 6d2e  e_1 = np.random.
-00018550: 7261 6e64 6f6d 5f69 6e74 6567 6572 7328  random_integers(
-00018560: 6c6f 773d 312c 2068 6967 683d 322c 2073  low=1, high=2, s
-00018570: 697a 653d 2831 302c 2035 3029 292e 6173  ize=(10, 50)).as
-00018580: 7479 7065 286e 702e 666c 6f61 7436 3429  type(np.float64)
-00018590: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
-000185a0: 706c 655f 3220 3d20 6e70 2e72 616e 646f  ple_2 = np.rando
-000185b0: 6d2e 7261 6e64 6f6d 5f69 6e74 6567 6572  m.random_integer
-000185c0: 7328 6c6f 773d 372c 2068 6967 683d 3230  s(low=7, high=20
-000185d0: 2c20 7369 7a65 3d28 322c 2035 3029 292e  , size=(2, 50)).
-000185e0: 6173 7479 7065 286e 702e 666c 6f61 7436  astype(np.float6
-000185f0: 3429 0a20 2020 2020 2020 203e 3e3e 2064  4).        >>> d
-00018600: 6174 6120 3d20 6e70 2e76 7374 6163 6b28  ata = np.vstack(
-00018610: 5b73 616d 706c 655f 312c 2073 616d 706c  [sample_1, sampl
-00018620: 655f 325d 290a 2020 2020 2020 2020 3e3e  e_2]).        >>
-00018630: 3e20 5374 6174 6973 7469 6373 2829 2e68  > Statistics().h
-00018640: 626f 7328 6461 7461 3d64 6174 6129 0a20  bos(data=data). 
-00018650: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00018660: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
-00018670: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
-00018680: 2020 2064 6174 613d 6461 7461 2c0a 2020     data=data,.  
-00018690: 2020 2020 2020 2020 2020 736f 7572 6365            source
-000186a0: 3d66 227b 5374 6174 6973 7469 6373 2e5f  =f"{Statistics._
-000186b0: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-000186c0: 5f7d 2064 6174 6122 2c0a 2020 2020 2020  _} data",.      
-000186d0: 2020 2020 2020 6163 6365 7074 6564 5f73        accepted_s
-000186e0: 697a 6573 3d5b 325d 2c0a 2020 2020 2020  izes=[2],.      
-000186f0: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
-00018700: 6b5f 7374 7228 0a20 2020 2020 2020 2020  k_str(.         
-00018710: 2020 206e 616d 653d 6622 7b53 7461 7469     name=f"{Stati
-00018720: 7374 6963 732e 5f5f 636c 6173 735f 5f2e  stics.__class__.
-00018730: 5f5f 6e61 6d65 5f5f 7d20 6275 636b 6574  __name__} bucket
-00018740: 5f6d 6574 686f 6422 2c0a 2020 2020 2020  _method",.      
-00018750: 2020 2020 2020 7661 6c75 653d 6275 636b        value=buck
-00018760: 6574 5f6d 6574 686f 642c 0a20 2020 2020  et_method,.     
-00018770: 2020 2020 2020 206f 7074 696f 6e73 3d4f         options=O
-00018780: 7074 696f 6e73 2e42 5543 4b45 545f 4d45  ptions.BUCKET_ME
-00018790: 5448 4f44 532e 7661 6c75 652c 0a20 2020  THODS.value,.   
-000187a0: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
-000187b0: 696e 5f76 616c 732c 206d 6178 5f76 616c  in_vals, max_val
-000187c0: 7320 3d20 6e70 2e6d 696e 2864 6174 612c  s = np.min(data,
-000187d0: 2061 7869 733d 3029 2c20 6e70 2e6d 6178   axis=0), np.max
-000187e0: 2864 6174 612c 2061 7869 733d 3029 0a20  (data, axis=0). 
-000187f0: 2020 2020 2020 2064 6174 6120 3d20 2864         data = (d
-00018800: 6174 6120 2d20 6d69 6e5f 7661 6c73 2920  ata - min_vals) 
-00018810: 2f20 286d 6178 5f76 616c 7320 2d20 6d69  / (max_vals - mi
-00018820: 6e5f 7661 6c73 2920 2a20 2831 202d 2030  n_vals) * (1 - 0
-00018830: 2920 2b20 300a 2020 2020 2020 2020 6869  ) + 0.        hi
-00018840: 7374 6f67 7261 6d5f 6564 6765 7320 3d20  stogram_edges = 
-00018850: 7479 7065 642e 4469 6374 2e65 6d70 7479  typed.Dict.empty
-00018860: 280a 2020 2020 2020 2020 2020 2020 6b65  (.            ke
-00018870: 795f 7479 7065 3d74 7970 6573 2e69 6e74  y_type=types.int
-00018880: 3634 2c20 7661 6c75 655f 7479 7065 3d74  64, value_type=t
-00018890: 7970 6573 2e66 6c6f 6174 3634 5b3a 5d0a  ypes.float64[:].
-000188a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000188b0: 2020 6869 7374 6f67 7261 6d73 203d 2074    histograms = t
-000188c0: 7970 6564 2e44 6963 742e 656d 7074 7928  yped.Dict.empty(
-000188d0: 6b65 795f 7479 7065 3d74 7970 6573 2e69  key_type=types.i
-000188e0: 6e74 3634 2c20 7661 6c75 655f 7479 7065  nt64, value_type
-000188f0: 3d74 7970 6573 2e69 6e74 3634 5b3a 5d29  =types.int64[:])
-00018900: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-00018910: 6e20 7261 6e67 6528 6461 7461 2e73 6861  n range(data.sha
-00018920: 7065 5b31 5d29 3a0a 2020 2020 2020 2020  pe[1]):.        
-00018930: 2020 2020 6269 6e5f 7769 6474 682c 2062      bin_width, b
-00018940: 696e 5f63 6f75 6e74 203d 2062 7563 6b65  in_count = bucke
-00018950: 745f 6461 7461 280a 2020 2020 2020 2020  t_data(.        
-00018960: 2020 2020 2020 2020 6461 7461 3d64 6174          data=dat
-00018970: 615b 3a2c 2069 5d2e 666c 6174 7465 6e28  a[:, i].flatten(
-00018980: 292c 206d 6574 686f 643d 6275 636b 6574  ), method=bucket
-00018990: 5f6d 6574 686f 640a 2020 2020 2020 2020  _method.        
-000189a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000189b0: 2020 6869 7374 6f67 7261 6d73 5b69 5d20    histograms[i] 
-000189c0: 3d20 7365 6c66 2e5f 6869 7374 5f31 6428  = self._hist_1d(
-000189d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000189e0: 2064 6174 613d 6461 7461 5b3a 2c20 695d   data=data[:, i]
-000189f0: 2e66 6c61 7474 656e 2829 2c0a 2020 2020  .flatten(),.    
-00018a00: 2020 2020 2020 2020 2020 2020 6269 6e5f              bin_
-00018a10: 636f 756e 743d 6269 6e5f 636f 756e 742c  count=bin_count,
-00018a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018a30: 2072 616e 6765 3d6e 702e 6172 7261 7928   range=np.array(
-00018a40: 5b30 2c20 696e 7428 6269 6e5f 7769 6474  [0, int(bin_widt
-00018a50: 6820 2a20 6269 6e5f 636f 756e 7429 5d29  h * bin_count)])
-00018a60: 2c0a 2020 2020 2020 2020 2020 2020 292e  ,.            ).
-00018a70: 6173 7479 7065 286e 702e 696e 7436 3429  astype(np.int64)
-00018a80: 0a20 2020 2020 2020 2020 2020 2068 6973  .            his
-00018a90: 746f 6772 616d 5f65 6467 6573 5b69 5d20  togram_edges[i] 
-00018aa0: 3d20 6e70 2e61 7261 6e67 6528 302c 2031  = np.arange(0, 1
-00018ab0: 202b 2062 696e 5f77 6964 7468 2c20 6269   + bin_width, bi
-00018ac0: 6e5f 7769 6474 6829 2e61 7374 7970 6528  n_width).astype(
-00018ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018ae0: 206e 702e 666c 6f61 7436 340a 2020 2020   np.float64.    
-00018af0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00018b00: 2020 7265 7375 6c74 7320 3d20 7365 6c66    results = self
-00018b10: 2e5f 6862 6f73 5f63 6f6d 7075 7465 280a  ._hbos_compute(.
-00018b20: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00018b30: 3d64 6174 612c 2068 6973 746f 6772 616d  =data, histogram
-00018b40: 733d 6869 7374 6f67 7261 6d73 2c20 6869  s=histograms, hi
-00018b50: 7374 6f67 7261 6d5f 6564 6765 733d 6869  stogram_edges=hi
-00018b60: 7374 6f67 7261 6d5f 6564 6765 730a 2020  stogram_edges.  
-00018b70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00018b80: 7265 7475 726e 2072 6573 756c 7473 2e61  return results.a
-00018b90: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-00018ba0: 290a 0a20 2020 2064 6566 2072 6f6c 6c69  )..    def rolli
-00018bb0: 6e67 5f73 6861 7069 726f 5f77 696c 6b73  ng_shapiro_wilks
-00018bc0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00018bd0: 6461 7461 3a20 6e70 2e6e 6461 7272 6179  data: np.ndarray
-00018be0: 2c20 7469 6d65 5f77 696e 646f 773a 2066  , time_window: f
-00018bf0: 6c6f 6174 2c20 6670 733a 2069 6e74 0a20  loat, fps: int. 
-00018c00: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
-00018c10: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
-00018c20: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
-00018c30: 5368 6170 6972 6f2d 5769 6c6b 7320 6e6f  Shapiro-Wilks no
-00018c40: 726d 616c 6974 7920 7374 6174 6973 7469  rmality statisti
-00018c50: 6373 2066 6f72 2073 6571 7565 6e74 6961  cs for sequentia
-00018c60: 6c6c 7920 6269 6e6e 6564 2076 616c 7565  lly binned value
-00018c70: 7320 696e 2061 2074 696d 652d 7365 7269  s in a time-seri
-00018c80: 6573 2e20 452e 672e 2c20 636f 6d70 7574  es. E.g., comput
-00018c90: 650a 2020 2020 2020 2020 7468 6520 6e6f  e.        the no
-00018ca0: 726d 616c 6974 7920 7374 6174 6973 7469  rmality statisti
-00018cb0: 6373 206f 6620 6060 4665 6174 7572 6520  cs of ``Feature 
-00018cc0: 4e60 6020 696e 2065 6163 6820 7769 6e64  N`` in each wind
-00018cd0: 6f77 206f 6620 6060 7469 6d65 5f77 696e  ow of ``time_win
-00018ce0: 646f 7760 6020 7365 636f 6e64 732e 0a0a  dow`` seconds...
-00018cf0: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
-00018d00: 6572 206e 6461 7272 6179 2064 6174 613a  er ndarray data:
-00018d10: 2031 4420 6172 7261 7920 6f66 2073 697a   1D array of siz
-00018d20: 6520 6c65 6e28 6672 616d 6573 2920 7265  e len(frames) re
-00018d30: 7072 6573 656e 7469 6e67 2066 6561 7475  presenting featu
-00018d40: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
-00018d50: 2020 203a 7061 7261 6d65 7465 7220 696e     :parameter in
-00018d60: 7420 7469 6d65 5f77 696e 646f 773a 2054  t time_window: T
-00018d70: 6865 2073 697a 6520 6f66 2074 6865 2062  he size of the b
-00018d80: 7563 6b65 7473 2069 6e20 7365 636f 6e64  uckets in second
-00018d90: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00018da0: 6d65 7465 7220 696e 7420 6670 733a 2046  meter int fps: F
-00018db0: 7261 6d65 2d72 6174 6520 6f66 2072 6563  rame-rate of rec
-00018dc0: 6f72 6465 6420 7669 6465 6f2e 0a20 2020  orded video..   
-00018dd0: 2020 2020 203a 7265 7475 726e 206e 702e       :return np.
-00018de0: 6e64 6172 7261 793a 2041 7272 6179 206f  ndarray: Array o
-00018df0: 6620 7369 7a65 2064 6174 612e 7368 6170  f size data.shap
-00018e00: 655b 305d 2077 6974 6820 5368 6170 6972  e[0] with Shapir
-00018e10: 6f2d 5769 6c6b 7320 6e6f 726d 616c 6974  o-Wilks normalit
-00018e20: 7920 7374 6174 6973 7469 6373 0a0a 2020  y statistics..  
-00018e30: 2020 2020 2020 3a65 7861 6d70 6c65 3a0a        :example:.
-00018e40: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
-00018e50: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-00018e60: 6469 6e74 286c 6f77 3d30 2c20 6869 6768  dint(low=0, high
-00018e70: 3d31 3030 2c20 7369 7a65 3d28 3230 3029  =100, size=(200)
-00018e80: 292e 6173 7479 7065 2827 666c 6f61 7433  ).astype('float3
-00018e90: 3227 290a 2020 2020 2020 2020 3e3e 3e20  2').        >>> 
-00018ea0: 7265 7375 6c74 7320 3d20 7365 6c66 2e72  results = self.r
-00018eb0: 6f6c 6c69 6e67 5f73 6861 7069 726f 5f77  olling_shapiro_w
-00018ec0: 696c 6b73 2864 6174 613d 6461 7461 2c20  ilks(data=data, 
-00018ed0: 7469 6d65 5f77 696e 646f 773d 312c 2066  time_window=1, f
-00018ee0: 7073 3d33 3029 0a20 2020 2020 2020 2022  ps=30).        "
-00018ef0: 2222 0a0a 2020 2020 2020 2020 6368 6563  ""..        chec
-00018f00: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-00018f10: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00018f20: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-00018f30: 2020 736f 7572 6365 3d66 227b 5374 6174    source=f"{Stat
-00018f40: 6973 7469 6373 2e5f 5f63 6c61 7373 5f5f  istics.__class__
-00018f50: 2e5f 5f6e 616d 655f 5f7d 2064 6174 6122  .__name__} data"
-00018f60: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-00018f70: 6365 7074 6564 5f73 697a 6573 3d5b 315d  cepted_sizes=[1]
-00018f80: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00018f90: 2020 2020 6368 6563 6b5f 666c 6f61 7428      check_float(
-00018fa0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00018fb0: 653d 6622 7b53 7461 7469 7374 6963 732e  e=f"{Statistics.
-00018fc0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
-00018fd0: 5f5f 7d20 6461 7461 222c 0a20 2020 2020  __} data",.     
-00018fe0: 2020 2020 2020 2076 616c 7565 3d74 696d         value=tim
-00018ff0: 655f 7769 6e64 6f77 2c0a 2020 2020 2020  e_window,.      
-00019000: 2020 2020 2020 6d69 6e5f 7661 6c75 653d        min_value=
-00019010: 302e 312c 0a20 2020 2020 2020 2029 0a20  0.1,.        ). 
-00019020: 2020 2020 2020 2063 6865 636b 5f69 6e74         check_int
-00019030: 280a 2020 2020 2020 2020 2020 2020 6e61  (.            na
-00019040: 6d65 3d66 227b 5374 6174 6973 7469 6373  me=f"{Statistics
-00019050: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00019060: 655f 5f7d 2064 6174 6122 2c20 7661 6c75  e__} data", valu
-00019070: 653d 7469 6d65 5f77 696e 646f 772c 206d  e=time_window, m
-00019080: 696e 5f76 616c 7565 3d31 0a20 2020 2020  in_value=1.     
-00019090: 2020 2029 0a20 2020 2020 2020 2077 696e     ).        win
-000190a0: 646f 775f 7369 7a65 2c20 7265 7375 6c74  dow_size, result
-000190b0: 7320 3d20 696e 7428 7469 6d65 5f77 696e  s = int(time_win
-000190c0: 646f 7720 2a20 6670 7329 2c20 6e70 2e66  dow * fps), np.f
-000190d0: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
-000190e0: 305d 292c 202d 312e 3029 0a20 2020 2020  0]), -1.0).     
-000190f0: 2020 2064 6174 6120 3d20 6e70 2e73 706c     data = np.spl
-00019100: 6974 2864 6174 612c 206c 6973 7428 7261  it(data, list(ra
-00019110: 6e67 6528 7769 6e64 6f77 5f73 697a 652c  nge(window_size,
-00019120: 2064 6174 612e 7368 6170 655b 305d 2c20   data.shape[0], 
-00019130: 7769 6e64 6f77 5f73 697a 6529 2929 0a20  window_size))). 
-00019140: 2020 2020 2020 2066 6f72 2063 6e74 2c20         for cnt, 
-00019150: 6920 696e 2065 6e75 6d65 7261 7465 2870  i in enumerate(p
-00019160: 7261 6e67 6528 312c 206c 656e 2864 6174  range(1, len(dat
-00019170: 6129 2929 3a0a 2020 2020 2020 2020 2020  a))):.          
-00019180: 2020 7374 6172 742c 2065 6e64 203d 2069    start, end = i
-00019190: 6e74 2828 636e 7420 2b20 3129 202a 2077  nt((cnt + 1) * w
-000191a0: 696e 646f 775f 7369 7a65 292c 2069 6e74  indow_size), int
-000191b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000191c0: 2020 2828 636e 7420 2b20 3129 202a 2077    ((cnt + 1) * w
-000191d0: 696e 646f 775f 7369 7a65 2920 2b20 7769  indow_size) + wi
-000191e0: 6e64 6f77 5f73 697a 650a 2020 2020 2020  ndow_size.      
-000191f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00019200: 2020 2020 7265 7375 6c74 735b 7374 6172      results[star
-00019210: 743a 656e 645d 203d 2073 7461 7473 2e73  t:end] = stats.s
-00019220: 6861 7069 726f 2864 6174 615b 695d 295b  hapiro(data[i])[
-00019230: 305d 0a20 2020 2020 2020 2072 6574 7572  0].        retur
-00019240: 6e20 7265 7375 6c74 730a 0a20 2020 2040  n results..    @
-00019250: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00019260: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
-00019270: 5b3a 5d2c 2066 6c6f 6174 3634 5b3a 5d2c  [:], float64[:],
-00019280: 2069 6e74 3634 2c29 2229 0a20 2020 2064   int64,)").    d
-00019290: 6566 2073 6c69 6469 6e67 5f7a 5f73 636f  ef sliding_z_sco
-000192a0: 7265 7328 0a20 2020 2020 2020 2064 6174  res(.        dat
-000192b0: 613a 206e 702e 6e64 6172 7261 792c 2074  a: np.ndarray, t
-000192c0: 696d 655f 7769 6e64 6f77 733a 206e 702e  ime_windows: np.
-000192d0: 6e64 6172 7261 792c 2066 7073 3a20 696e  ndarray, fps: in
-000192e0: 740a 2020 2020 2920 2d3e 206e 702e 6e64  t.    ) -> np.nd
-000192f0: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-00019300: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
-00019310: 6c61 7465 2073 6c69 6469 6e67 205a 2d73  late sliding Z-s
-00019320: 636f 7265 7320 666f 7220 6120 6769 7665  cores for a give
-00019330: 6e20 6461 7461 2061 7272 6179 206f 7665  n data array ove
-00019340: 7220 7370 6563 6966 6965 6420 7469 6d65  r specified time
-00019350: 2077 696e 646f 7773 2e0a 0a20 2020 2020   windows...     
-00019360: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
-00019370: 2063 6f6d 7075 7465 7320 736c 6964 696e   computes slidin
-00019380: 6720 5a2d 7363 6f72 6573 2066 6f72 2061  g Z-scores for a
-00019390: 2031 4420 6461 7461 2061 7272 6179 206f   1D data array o
-000193a0: 7665 7220 6469 6666 6572 656e 7420 7469  ver different ti
-000193b0: 6d65 2077 696e 646f 7773 2e20 5468 6520  me windows. The 
-000193c0: 736c 6964 696e 6720 5a2d 7363 6f72 650a  sliding Z-score.
-000193d0: 2020 2020 2020 2020 6973 2061 206d 6561          is a mea
-000193e0: 7375 7265 206f 6620 686f 7720 6d61 6e79  sure of how many
-000193f0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-00019400: 696f 6e73 2061 2064 6174 6120 706f 696e  ions a data poin
-00019410: 7420 6973 2066 726f 6d20 7468 6520 6d65  t is from the me
-00019420: 616e 206f 6620 7468 6520 7375 7272 6f75  an of the surrou
-00019430: 6e64 696e 6720 6461 7461 2077 6974 6869  nding data withi
-00019440: 6e0a 2020 2020 2020 2020 7468 6520 7370  n.        the sp
-00019450: 6563 6966 6965 6420 7469 6d65 2077 696e  ecified time win
-00019460: 646f 772e 2054 6869 7320 6361 6e20 6265  dow. This can be
-00019470: 2075 7365 6675 6c20 666f 7220 6465 7465   useful for dete
-00019480: 6374 696e 6720 616e 6f6d 616c 6965 7320  cting anomalies 
-00019490: 6f72 2076 6172 6961 7469 6f6e 7320 696e  or variations in
-000194a0: 2074 696d 652d 7365 7269 6573 2064 6174   time-series dat
-000194b0: 612e 0a0a 2020 2020 2020 2020 3a70 6172  a...        :par
-000194c0: 616d 6574 6572 206e 6461 7272 6179 2064  ameter ndarray d
-000194d0: 6174 613a 2031 4420 4e75 6d50 7920 6172  ata: 1D NumPy ar
-000194e0: 7261 7920 636f 6e74 6169 6e69 6e67 2074  ray containing t
-000194f0: 6865 2074 696d 652d 7365 7269 6573 2064  he time-series d
-00019500: 6174 612e 0a20 2020 2020 2020 203a 7061  ata..        :pa
-00019510: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
-00019520: 7469 6d65 5f77 696e 646f 7773 3a20 3144  time_windows: 1D
-00019530: 204e 756d 5079 2061 7272 6179 2073 7065   NumPy array spe
-00019540: 6369 6679 696e 6720 7468 6520 7469 6d65  cifying the time
-00019550: 2077 696e 646f 7773 2069 6e20 7365 636f   windows in seco
-00019560: 6e64 7320 6f76 6572 2077 6869 6368 2074  nds over which t
-00019570: 6f20 6361 6c63 756c 6174 6520 7468 6520  o calculate the 
-00019580: 5a2d 7363 6f72 6573 2e0a 2020 2020 2020  Z-scores..      
-00019590: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
-000195a0: 2074 696d 655f 7769 6e64 6f77 733a 2046   time_windows: F
-000195b0: 7261 6d65 7320 7065 7220 7365 636f 6e64  rames per second
-000195c0: 2c20 7573 6564 2074 6f20 636f 6e76 6572  , used to conver
-000195d0: 7420 7469 6d65 2077 696e 646f 7773 2066  t time windows f
-000195e0: 726f 6d20 7365 636f 6e64 7320 746f 2074  rom seconds to t
-000195f0: 6865 2063 6f72 7265 7370 6f6e 6469 6e67  he corresponding
-00019600: 206e 756d 6265 7220 6f66 2064 6174 6120   number of data 
-00019610: 706f 696e 7473 2e0a 2020 2020 2020 2020  points..        
-00019620: 3a72 6574 7572 6e73 206e 702e 6e64 6172  :returns np.ndar
-00019630: 7261 793a 2041 2032 4420 4e75 6d50 7920  ray: A 2D NumPy 
-00019640: 6172 7261 7920 636f 6e74 6169 6e69 6e67  array containing
-00019650: 2074 6865 2063 616c 6375 6c61 7465 6420   the calculated 
-00019660: 5a2d 7363 6f72 6573 2e20 4561 6368 2072  Z-scores. Each r
-00019670: 6f77 2063 6f72 7265 7370 6f6e 6473 2074  ow corresponds t
-00019680: 6f20 7468 6520 5a2d 7363 6f72 6573 2063  o the Z-scores c
-00019690: 616c 6375 6c61 7465 6420 666f 7220 6120  alculated for a 
-000196a0: 7370 6563 6966 6963 2074 696d 6520 7769  specific time wi
-000196b0: 6e64 6f77 2e20 5468 6520 7469 6d65 2077  ndow. The time w
-000196c0: 696e 646f 7773 2061 7265 2072 6570 7265  indows are repre
-000196d0: 7365 6e74 6564 2062 7920 7468 6520 636f  sented by the co
-000196e0: 6c75 6d6e 732e 0a0a 2020 2020 2020 2020  lumns...        
-000196f0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-00019700: 2020 3e3e 3e20 6461 7461 203d 206e 702e    >>> data = np.
-00019710: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
-00019720: 2c20 3130 302c 2028 3130 3030 2c29 292e  , 100, (1000,)).
-00019730: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-00019740: 3229 0a20 2020 2020 2020 203e 3e3e 207a  2).        >>> z
-00019750: 5f73 636f 7265 7320 3d20 5374 6174 6973  _scores = Statis
-00019760: 7469 6373 2829 2e73 6c69 6469 6e67 5f7a  tics().sliding_z
-00019770: 5f73 636f 7265 7328 6461 7461 3d64 6174  _scores(data=dat
-00019780: 612c 2074 696d 655f 7769 6e64 6f77 733d  a, time_windows=
-00019790: 6e70 2e61 7272 6179 285b 312e 302c 2032  np.array([1.0, 2
-000197a0: 2e35 5d29 2c20 6670 733d 3130 290a 2020  .5]), fps=10).  
-000197b0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-000197c0: 2020 2072 6573 756c 7473 203d 206e 702e     results = np.
-000197d0: 6675 6c6c 2828 6461 7461 2e73 6861 7065  full((data.shape
-000197e0: 5b30 5d2c 2074 696d 655f 7769 6e64 6f77  [0], time_window
-000197f0: 732e 7368 6170 655b 305d 292c 2030 2e30  s.shape[0]), 0.0
-00019800: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
-00019810: 696e 2072 616e 6765 2874 696d 655f 7769  in range(time_wi
-00019820: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
-00019830: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-00019840: 646f 775f 7369 7a65 203d 2069 6e74 2874  dow_size = int(t
-00019850: 696d 655f 7769 6e64 6f77 735b 695d 202a  ime_windows[i] *
-00019860: 2066 7073 290a 2020 2020 2020 2020 2020   fps).          
-00019870: 2020 666f 7220 7269 6768 7420 696e 2072    for right in r
-00019880: 616e 6765 2877 696e 646f 775f 7369 7a65  ange(window_size
-00019890: 202d 2031 2c20 6461 7461 2e73 6861 7065   - 1, data.shape
-000198a0: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
-000198b0: 2020 2020 2020 6c65 6674 203d 2072 6967        left = rig
-000198c0: 6874 202d 2077 696e 646f 775f 7369 7a65  ht - window_size
-000198d0: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-000198e0: 2020 2020 2073 616d 706c 655f 6461 7461       sample_data
-000198f0: 203d 2064 6174 615b 6c65 6674 203a 2072   = data[left : r
-00019900: 6967 6874 202b 2031 5d0a 2020 2020 2020  ight + 1].      
-00019910: 2020 2020 2020 2020 2020 6d2c 2073 203d            m, s =
-00019920: 206e 702e 6d65 616e 2873 616d 706c 655f   np.mean(sample_
-00019930: 6461 7461 292c 206e 702e 7374 6428 7361  data), np.std(sa
-00019940: 6d70 6c65 5f64 6174 6129 0a20 2020 2020  mple_data).     
-00019950: 2020 2020 2020 2020 2020 2076 616c 7320             vals 
-00019960: 3d20 2873 616d 706c 655f 6461 7461 202d  = (sample_data -
-00019970: 206d 2920 2f20 730a 2020 2020 2020 2020   m) / s.        
-00019980: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
-00019990: 6c65 6674 203a 2072 6967 6874 202b 2031  left : right + 1
-000199a0: 2c20 695d 203d 2076 616c 730a 2020 2020  , i] = vals.    
-000199b0: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-000199c0: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
-000199d0: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
-000199e0: 2228 696e 7436 345b 3a2c 203a 5d2c 2922  "(int64[:, :],)"
-000199f0: 290a 2020 2020 6465 6620 7068 695f 636f  ).    def phi_co
-00019a00: 6566 6669 6369 656e 7428 6461 7461 3a20  efficient(data: 
-00019a10: 6e70 2e6e 6461 7272 6179 2920 2d3e 2066  np.ndarray) -> f
-00019a20: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
-00019a30: 220a 2020 2020 2020 2020 436f 6d70 7574  ".        Comput
-00019a40: 6520 7468 6520 7068 6920 636f 6566 6669  e the phi coeffi
-00019a50: 6369 656e 7420 666f 7220 6120 4e78 3220  cient for a Nx2 
-00019a60: 6172 7261 7920 6f66 2062 696e 6172 7920  array of binary 
-00019a70: 6461 7461 2e0a 0a20 2020 2020 2020 2054  data...        T
-00019a80: 6865 2070 6869 2063 6f65 6666 6963 6965  he phi coefficie
-00019a90: 6e74 2028 612e 6b2e 6120 4d61 7474 6865  nt (a.k.a Matthe
-00019aa0: 7773 2043 6f72 7265 6c61 7469 6f6e 2043  ws Correlation C
-00019ab0: 6f65 6666 6963 6965 6e74 2028 4d43 4329  oefficient (MCC)
-00019ac0: 292c 2069 7320 6120 6d65 6173 7572 6520  ), is a measure 
-00019ad0: 6f66 2061 7373 6f63 6961 7469 6f6e 2066  of association f
-00019ae0: 6f72 2062 696e 6172 7920 6461 7461 2069  or binary data i
-00019af0: 6e20 6120 3278 3220 636f 6e74 696e 6765  n a 2x2 continge
-00019b00: 6e63 7920 7461 626c 652e 2049 7420 7175  ncy table. It qu
-00019b10: 616e 7469 6669 6573 2074 6865 0a20 2020  antifies the.   
-00019b20: 2020 2020 2064 6567 7265 6520 6f66 2061       degree of a
-00019b30: 7373 6f63 6961 7469 6f6e 206f 7220 636f  ssociation or co
-00019b40: 7272 656c 6174 696f 6e20 6265 7477 6565  rrelation betwee
-00019b50: 6e20 7477 6f20 6269 6e61 7279 2076 6172  n two binary var
-00019b60: 6961 626c 6573 2028 652e 672e 2c20 6269  iables (e.g., bi
-00019b70: 6e61 7279 2063 6c61 7373 6966 6963 6174  nary classificat
-00019b80: 696f 6e20 7461 7267 6574 7329 2e0a 0a20  ion targets)... 
-00019b90: 2020 2020 2020 2054 6865 2066 6f72 6d75         The formu
-00019ba0: 6c61 2066 6f72 2074 6865 2070 6869 2063  la for the phi c
-00019bb0: 6f65 6666 6963 6965 6e74 2069 7320 6465  oefficient is de
-00019bc0: 6669 6e65 6420 6173 3a0a 0a20 2020 2020  fined as:..     
-00019bd0: 2020 202e 2e20 6d61 7468 3a3a 0a20 2020     .. math::.   
-00019be0: 2020 2020 2020 2020 5c70 6869 203d 205c          \phi = \
-00019bf0: 6672 6163 7b28 4243 202d 2041 4429 7d7b  frac{(BC - AD)}{
-00019c00: 5c73 7172 747b 2843 5f31 202b 2043 5f32  \sqrt{(C_1 + C_2
-00019c10: 2928 525f 3120 2b20 525f 3229 2843 5f31  )(R_1 + R_2)(C_1
-00019c20: 202b 2052 5f31 2928 435f 3220 2b20 525f   + R_1)(C_2 + R_
-00019c30: 3229 7d7d 0a0a 2020 2020 2020 2020 7768  2)}}..        wh
-00019c40: 6572 653a 0a20 2020 2020 2020 202d 2042  ere:.        - B
-00019c50: 433a 2048 6974 2072 6174 6520 2872 6570  C: Hit rate (rep
-00019c60: 6f6e 7365 2061 6e64 2074 7275 7468 2069  onse and truth i
-00019c70: 7320 626f 7468 2031 290a 2020 2020 2020  s both 1).      
-00019c80: 2020 2d20 4144 3a20 436f 7272 6563 7420    - AD: Correct 
-00019c90: 7265 6a65 6374 696f 6e73 2028 7265 7370  rejections (resp
-00019ca0: 6f6e 7365 2061 6e64 2074 7275 7468 2061  onse and truth a
-00019cb0: 7265 2062 6f74 6820 3029 0a20 2020 2020  re both 0).     
-00019cc0: 2020 202d 2043 312c 2043 323a 2043 6f75     - C1, C2: Cou
-00019cd0: 6e74 7320 6f66 206f 6363 7572 7265 6e63  nts of occurrenc
-00019ce0: 6573 2077 6865 7265 2074 6865 2072 6573  es where the res
-00019cf0: 706f 6e73 6520 6973 2031 2061 6e64 2030  ponse is 1 and 0
-00019d00: 2c20 7265 7370 6563 7469 7665 6c79 2e0a  , respectively..
-00019d10: 2020 2020 2020 2020 2d20 5231 2c20 5232          - R1, R2
-00019d20: 3a20 436f 756e 7473 206f 6620 6f63 6375  : Counts of occu
-00019d30: 7272 656e 6365 7320 7768 6572 6520 7468  rrences where th
-00019d40: 6520 7472 7574 6820 6973 2031 2061 6e64  e truth is 1 and
-00019d50: 2030 2c20 7265 7370 6563 7469 7665 6c79   0, respectively
-00019d60: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00019d70: 6d20 6e70 2e6e 6461 7272 6179 2064 6174  m np.ndarray dat
-00019d80: 613a 2041 204e 756d 5079 2061 7272 6179  a: A NumPy array
-00019d90: 2063 6f6e 7461 696e 696e 6720 6269 6e61   containing bina
-00019da0: 7279 2064 6174 6120 6f72 6761 6e69 7a65  ry data organize
-00019db0: 6420 696e 2074 776f 2063 6f6c 756d 6e73  d in two columns
-00019dc0: 2e20 4561 6368 2072 6f77 2072 6570 7265  . Each row repre
-00019dd0: 7365 6e74 7320 6120 7061 6972 206f 6620  sents a pair of 
-00019de0: 6269 6e61 7279 2076 616c 7565 7320 666f  binary values fo
-00019df0: 7220 7477 6f20 7661 7269 6162 6c65 732e  r two variables.
-00019e00: 2043 6f6c 756d 6e73 2072 6570 7265 7365   Columns represe
-00019e10: 6e74 2074 776f 2066 6561 7475 7265 7320  nt two features 
-00019e20: 6f72 2074 776f 2062 696e 6172 7920 636c  or two binary cl
-00019e30: 6173 7369 6669 6361 7469 6f6e 2072 6573  assification res
-00019e40: 756c 7473 2e0a 2020 2020 2020 2020 3a70  ults..        :p
-00019e50: 6172 616d 2066 6c6f 6174 3a20 5468 6520  aram float: The 
-00019e60: 6361 6c63 756c 6174 6564 2070 6869 2063  calculated phi c
-00019e70: 6f65 6666 6963 6965 6e74 2c20 6120 7661  oefficient, a va
-00019e80: 6c75 6520 6265 7477 6565 6e20 3020 616e  lue between 0 an
-00019e90: 6420 312e 2041 2076 616c 7565 206f 6620  d 1. A value of 
-00019ea0: 3020 696e 6469 6361 7465 7320 6e6f 2061  0 indicates no a
-00019eb0: 7373 6f63 6961 7469 6f6e 2062 6574 7765  ssociation betwe
-00019ec0: 656e 2074 6865 2076 6172 6961 626c 6573  en the variables
-00019ed0: 2c20 7768 696c 6520 3120 696e 6469 6361  , while 1 indica
-00019ee0: 7465 7320 6120 7065 7266 6563 7420 6173  tes a perfect as
-00019ef0: 736f 6369 6174 696f 6e2e 0a0a 2020 2020  sociation...    
-00019f00: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
-00019f10: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
-00019f20: 206e 702e 6172 7261 7928 5b5b 302c 2031   np.array([[0, 1
-00019f30: 5d2c 205b 312c 2030 5d2c 205b 312c 2030  ], [1, 0], [1, 0
-00019f40: 5d2c 205b 312c 2031 5d5d 292e 6173 7479  ], [1, 1]]).asty
-00019f50: 7065 286e 702e 696e 7436 3429 0a20 2020  pe(np.int64).   
-00019f60: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-00019f70: 6963 7328 292e 7068 695f 636f 6566 6669  ics().phi_coeffi
-00019f80: 6369 656e 7428 6461 7461 3d64 6174 6129  cient(data=data)
-00019f90: 0a20 2020 2020 2020 203e 3e3e 2030 2e38  .        >>> 0.8
-00019fa0: 3136 3439 3635 3830 3932 3737 3236 310a  164965809277261.
-00019fb0: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
-00019fc0: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
-00019fd0: 6469 6e74 2830 2c20 322c 2028 3130 302c  dint(0, 2, (100,
-00019fe0: 2032 2929 0a20 2020 2020 2020 203e 3e3e   2)).        >>>
-00019ff0: 2072 6573 756c 7420 3d20 5374 6174 6973   result = Statis
-0001a000: 7469 6373 2e70 6869 5f63 6f65 6666 6963  tics.phi_coeffic
-0001a010: 6965 6e74 2864 6174 613d 6461 7461 290a  ient(data=data).
-0001a020: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001a030: 2020 2020 636e 745f 305f 3020 3d20 6c65      cnt_0_0 = le
-0001a040: 6e28 6e70 2e61 7267 7768 6572 6528 2864  n(np.argwhere((d
-0001a050: 6174 615b 3a2c 2030 5d20 3d3d 2030 2920  ata[:, 0] == 0) 
-0001a060: 2620 2864 6174 615b 3a2c 2031 5d20 3d3d  & (data[:, 1] ==
-0001a070: 2030 2929 2e66 6c61 7474 656e 2829 290a   0)).flatten()).
-0001a080: 2020 2020 2020 2020 636e 745f 305f 3120          cnt_0_1 
-0001a090: 3d20 6c65 6e28 6e70 2e61 7267 7768 6572  = len(np.argwher
-0001a0a0: 6528 2864 6174 615b 3a2c 2030 5d20 3d3d  e((data[:, 0] ==
-0001a0b0: 2030 2920 2620 2864 6174 615b 3a2c 2031   0) & (data[:, 1
-0001a0c0: 5d20 3d3d 2031 2929 2e66 6c61 7474 656e  ] == 1)).flatten
-0001a0d0: 2829 290a 2020 2020 2020 2020 636e 745f  ()).        cnt_
-0001a0e0: 315f 3020 3d20 6c65 6e28 6e70 2e61 7267  1_0 = len(np.arg
-0001a0f0: 7768 6572 6528 2864 6174 615b 3a2c 2030  where((data[:, 0
-0001a100: 5d20 3d3d 2031 2920 2620 2864 6174 615b  ] == 1) & (data[
-0001a110: 3a2c 2031 5d20 3d3d 2030 2929 2e66 6c61  :, 1] == 0)).fla
-0001a120: 7474 656e 2829 290a 2020 2020 2020 2020  tten()).        
-0001a130: 636e 745f 315f 3120 3d20 6c65 6e28 6e70  cnt_1_1 = len(np
-0001a140: 2e61 7267 7768 6572 6528 2864 6174 615b  .argwhere((data[
-0001a150: 3a2c 2030 5d20 3d3d 2031 2920 2620 2864  :, 0] == 1) & (d
-0001a160: 6174 615b 3a2c 2031 5d20 3d3d 2031 2929  ata[:, 1] == 1))
-0001a170: 2e66 6c61 7474 656e 2829 290a 0a20 2020  .flatten())..   
-0001a180: 2020 2020 2042 432c 2041 4420 3d20 636e       BC, AD = cn
-0001a190: 745f 315f 3120 2a20 636e 745f 305f 302c  t_1_1 * cnt_0_0,
-0001a1a0: 2063 6e74 5f31 5f30 202a 2063 6e74 5f30   cnt_1_0 * cnt_0
-0001a1b0: 5f31 0a20 2020 2020 2020 206e 6f6d 696e  _1.        nomin
-0001a1c0: 6174 6f72 203d 2042 4320 2d20 4144 0a20  ator = BC - AD. 
-0001a1d0: 2020 2020 2020 2064 656e 6f6d 696e 6174         denominat
-0001a1e0: 6f72 203d 206e 702e 7371 7274 280a 2020  or = np.sqrt(.  
-0001a1f0: 2020 2020 2020 2020 2020 2863 6e74 5f31            (cnt_1
-0001a200: 5f30 202b 2063 6e74 5f31 5f31 290a 2020  _0 + cnt_1_1).  
-0001a210: 2020 2020 2020 2020 2020 2a20 2863 6e74            * (cnt
-0001a220: 5f30 5f30 202b 2063 6e74 5f30 5f31 290a  _0_0 + cnt_0_1).
-0001a230: 2020 2020 2020 2020 2020 2020 2a20 2863              * (c
-0001a240: 6e74 5f31 5f30 202b 2063 6e74 5f30 5f30  nt_1_0 + cnt_0_0
-0001a250: 290a 2020 2020 2020 2020 2020 2020 2a20  ).            * 
-0001a260: 2863 6e74 5f31 5f31 202a 2063 6e74 5f30  (cnt_1_1 * cnt_0
-0001a270: 5f31 290a 2020 2020 2020 2020 290a 2020  _1).        ).  
-0001a280: 2020 2020 2020 6966 206e 6f6d 696e 6174        if nominat
-0001a290: 6f72 203d 3d20 3020 6f72 2064 656e 6f6d  or == 0 or denom
-0001a2a0: 696e 6174 6f72 203d 3d20 303a 0a20 2020  inator == 0:.   
-0001a2b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001a2c0: 312e 300a 2020 2020 2020 2020 656c 7365  1.0.        else
-0001a2d0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001a2e0: 7475 726e 206e 702e 6162 7328 0a20 2020  turn np.abs(.   
-0001a2f0: 2020 2020 2020 2020 2020 2020 2028 4243               (BC
-0001a300: 202d 2041 4429 0a20 2020 2020 2020 2020   - AD).         
-0001a310: 2020 2020 2020 202f 206e 702e 7371 7274         / np.sqrt
-0001a320: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001a330: 2020 2020 2020 2863 6e74 5f31 5f30 202b        (cnt_1_0 +
-0001a340: 2063 6e74 5f31 5f31 290a 2020 2020 2020   cnt_1_1).      
-0001a350: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-0001a360: 2863 6e74 5f30 5f30 202b 2063 6e74 5f30  (cnt_0_0 + cnt_0
-0001a370: 5f31 290a 2020 2020 2020 2020 2020 2020  _1).            
-0001a380: 2020 2020 2020 2020 2a20 2863 6e74 5f31          * (cnt_1
-0001a390: 5f30 202b 2063 6e74 5f30 5f30 290a 2020  _0 + cnt_0_0).  
-0001a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3b0: 2020 2a20 2863 6e74 5f31 5f31 202a 2063    * (cnt_1_1 * c
-0001a3c0: 6e74 5f30 5f31 290a 2020 2020 2020 2020  nt_0_1).        
-0001a3d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001a3e0: 2020 2020 2020 290a 0a20 2020 2040 7374        )..    @st
-0001a3f0: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-0001a400: 6e6a 6974 2822 2869 6e74 3332 5b3a 2c20  njit("(int32[:, 
-0001a410: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
-0001a420: 696e 7436 3429 2229 0a20 2020 2064 6566  int64)").    def
-0001a430: 2073 6c69 6469 6e67 5f70 6869 5f63 6f65   sliding_phi_coe
-0001a440: 6666 6963 6965 6e74 280a 2020 2020 2020  fficient(.      
-0001a450: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
-0001a460: 6179 2c20 7769 6e64 6f77 5f73 697a 6573  ay, window_sizes
-0001a470: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
-0001a480: 6d70 6c65 5f72 6174 653a 2069 6e74 0a20  mple_rate: int. 
-0001a490: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
-0001a4a0: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
-0001a4b0: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
-0001a4c0: 6520 736c 6964 696e 6720 7068 6920 636f  e sliding phi co
-0001a4d0: 6566 6669 6369 656e 7473 2066 6f72 2061  efficients for a
-0001a4e0: 2032 7832 2063 6f6e 7469 6e67 656e 6379   2x2 contingency
-0001a4f0: 2074 6162 6c65 2064 6572 6976 6564 2066   table derived f
-0001a500: 726f 6d20 6269 6e61 7279 2064 6174 612e  rom binary data.
-0001a510: 0a0a 2020 2020 2020 2020 436f 6d70 7574  ..        Comput
-0001a520: 6573 2073 6c69 6469 6e67 2070 6869 2063  es sliding phi c
-0001a530: 6f65 6666 6963 6965 6e74 7320 666f 7220  oefficients for 
-0001a540: 6120 3278 3220 636f 6e74 696e 6765 6e63  a 2x2 contingenc
-0001a550: 7920 7461 626c 6520 6465 7269 7665 6420  y table derived 
-0001a560: 6672 6f6d 2062 696e 6172 7920 6461 7461  from binary data
-0001a570: 206f 7665 7220 6469 6666 6572 656e 740a   over different.
-0001a580: 2020 2020 2020 2020 7469 6d65 2077 696e          time win
-0001a590: 646f 7773 2e20 5468 6520 7068 6920 636f  dows. The phi co
-0001a5a0: 6566 6669 6369 656e 7420 6973 2061 206d  efficient is a m
-0001a5b0: 6561 7375 7265 206f 6620 6173 736f 6369  easure of associ
-0001a5c0: 6174 696f 6e20 6265 7477 6565 6e20 7477  ation between tw
-0001a5d0: 6f20 6269 6e61 7279 2076 6172 6961 626c  o binary variabl
-0001a5e0: 6573 2c20 616e 6420 736c 6964 696e 6720  es, and sliding 
-0001a5f0: 7068 690a 2020 2020 2020 2020 636f 6566  phi.        coef
-0001a600: 6669 6369 656e 7473 2063 616e 2072 6576  ficients can rev
-0001a610: 6561 6c20 6368 616e 6765 7320 696e 2061  eal changes in a
-0001a620: 7373 6f63 6961 7469 6f6e 206f 7665 7220  ssociation over 
-0001a630: 7469 6d65 2e0a 0a20 2020 2020 2020 203a  time...        :
-0001a640: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-0001a650: 2064 6174 613a 2041 2032 4420 4e75 6d50   data: A 2D NumP
-0001a660: 7920 6172 7261 7920 636f 6e74 6169 6e69  y array containi
-0001a670: 6e67 2062 696e 6172 7920 6461 7461 206f  ng binary data o
-0001a680: 7267 616e 697a 6564 2069 6e20 7477 6f20  rganized in two 
-0001a690: 636f 6c75 6d6e 732e 2045 6163 6820 726f  columns. Each ro
-0001a6a0: 7720 7265 7072 6573 656e 7473 2061 2070  w represents a p
-0001a6b0: 6169 7220 6f66 2062 696e 6172 7920 7661  air of binary va
-0001a6c0: 6c75 6573 2066 6f72 2074 776f 2076 6172  lues for two var
-0001a6d0: 6961 626c 6573 2e0a 2020 2020 2020 2020  iables..        
-0001a6e0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-0001a6f0: 7920 7769 6e64 6f77 5f73 697a 6573 3a20  y window_sizes: 
-0001a700: 3144 204e 756d 5079 2061 7272 6179 2073  1D NumPy array s
-0001a710: 7065 6369 6679 696e 6720 7468 6520 7469  pecifying the ti
-0001a720: 6d65 2077 696e 646f 7773 2028 696e 2073  me windows (in s
-0001a730: 6563 6f6e 6473 2920 6f76 6572 2077 6869  econds) over whi
-0001a740: 6368 2074 6f20 6361 6c63 756c 6174 6520  ch to calculate 
-0001a750: 7468 6520 736c 6964 696e 6720 7068 6920  the sliding phi 
-0001a760: 636f 6566 6669 6369 656e 7473 2e0a 2020  coefficients..  
-0001a770: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
-0001a780: 2073 616d 706c 655f 7261 7465 3a20 5468   sample_rate: Th
-0001a790: 6520 7361 6d70 6c69 6e67 2072 6174 6520  e sampling rate 
-0001a7a0: 6f72 2074 696d 6520 696e 7465 7276 616c  or time interval
-0001a7b0: 2028 696e 2073 616d 706c 6573 2070 6572   (in samples per
-0001a7c0: 2073 6563 6f6e 642c 2065 2e67 2e2c 2066   second, e.g., f
-0001a7d0: 7073 2920 6174 2077 6869 6368 2064 6174  ps) at which dat
-0001a7e0: 6120 706f 696e 7473 2077 6572 6520 636f  a points were co
-0001a7f0: 6c6c 6563 7465 642e 0a20 2020 2020 2020  llected..       
-0001a800: 203a 7265 7475 726e 7320 6e70 2e6e 6461   :returns np.nda
-0001a810: 7272 6179 3a20 4120 3244 204e 756d 5079  rray: A 2D NumPy
-0001a820: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
-0001a830: 6720 7468 6520 6361 6c63 756c 6174 6564  g the calculated
-0001a840: 2073 6c69 6469 6e67 2070 6869 2063 6f65   sliding phi coe
-0001a850: 6666 6963 6965 6e74 732e 2045 6163 6820  fficients. Each 
-0001a860: 726f 7720 636f 7272 6573 706f 6e64 7320  row corresponds 
-0001a870: 746f 2074 6865 2070 6869 2063 6f65 6666  to the phi coeff
-0001a880: 6963 6965 6e74 7320 6361 6c63 756c 6174  icients calculat
-0001a890: 6564 2066 6f72 2061 2073 7065 6369 6669  ed for a specifi
-0001a8a0: 6320 7469 6d65 2070 6f69 6e74 2c20 7468  c time point, th
-0001a8b0: 6520 636f 6c75 6d6e 7320 636f 7272 6573  e columns corres
-0001a8c0: 706f 6e64 2074 6f20 7469 6d65 2d77 696e  pond to time-win
-0001a8d0: 646f 7773 2e0a 0a20 2020 2020 2020 203a  dows...        :
-0001a8e0: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
-0001a8f0: 203e 3e3e 2064 6174 6120 3d20 6e70 2e72   >>> data = np.r
-0001a900: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
-0001a910: 2032 2c20 2832 3030 2c20 3229 290a 2020   2, (200, 2)).  
-0001a920: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
-0001a930: 7469 6373 2829 2e73 6c69 6469 6e67 5f70  tics().sliding_p
-0001a940: 6869 5f63 6f65 6666 6963 6965 6e74 2864  hi_coefficient(d
-0001a950: 6174 613d 6461 7461 2c20 7769 6e64 6f77  ata=data, window
-0001a960: 5f73 697a 6573 3d6e 702e 6172 7261 7928  _sizes=np.array(
-0001a970: 5b31 2e30 2c20 342e 305d 292c 2073 616d  [1.0, 4.0]), sam
-0001a980: 706c 655f 7261 7465 3d31 3029 0a20 2020  ple_rate=10).   
-0001a990: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001a9a0: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
-0001a9b0: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
-0001a9c0: 305d 2c20 7769 6e64 6f77 5f73 697a 6573  0], window_sizes
-0001a9d0: 2e73 6861 7065 5b30 5d29 2c20 2d31 2e30  .shape[0]), -1.0
-0001a9e0: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
-0001a9f0: 696e 2070 7261 6e67 6528 7769 6e64 6f77  in prange(window
-0001aa00: 5f73 697a 6573 2e73 6861 7065 5b30 5d29  _sizes.shape[0])
-0001aa10: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
-0001aa20: 6e64 6f77 5f73 697a 6520 3d20 696e 7428  ndow_size = int(
-0001aa30: 7769 6e64 6f77 5f73 697a 6573 5b69 5d20  window_sizes[i] 
-0001aa40: 2a20 7361 6d70 6c65 5f72 6174 6529 0a20  * sample_rate). 
-0001aa50: 2020 2020 2020 2020 2020 2066 6f72 206c             for l
-0001aa60: 2c20 7220 696e 207a 6970 280a 2020 2020  , r in zip(.    
-0001aa70: 2020 2020 2020 2020 2020 2020 7261 6e67              rang
-0001aa80: 6528 302c 2064 6174 612e 7368 6170 655b  e(0, data.shape[
-0001aa90: 305d 202b 2031 292c 2072 616e 6765 2877  0] + 1), range(w
-0001aaa0: 696e 646f 775f 7369 7a65 2c20 6461 7461  indow_size, data
-0001aab0: 2e73 6861 7065 5b30 5d20 2b20 3129 0a20  .shape[0] + 1). 
-0001aac0: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-0001aad0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-0001aae0: 6d70 6c65 203d 2064 6174 615b 6c3a 722c  mple = data[l:r,
-0001aaf0: 203a 5d0a 2020 2020 2020 2020 2020 2020   :].            
-0001ab00: 2020 2020 636e 745f 305f 3020 3d20 6c65      cnt_0_0 = le
-0001ab10: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-0001ab20: 2020 2020 2020 206e 702e 6172 6777 6865         np.argwhe
-0001ab30: 7265 2828 7361 6d70 6c65 5b3a 2c20 305d  re((sample[:, 0]
-0001ab40: 203d 3d20 3029 2026 2028 7361 6d70 6c65   == 0) & (sample
-0001ab50: 5b3a 2c20 315d 203d 3d20 3029 292e 666c  [:, 1] == 0)).fl
-0001ab60: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
-0001ab70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001ab80: 2020 2020 2020 2020 2020 636e 745f 305f            cnt_0_
-0001ab90: 3120 3d20 6c65 6e28 0a20 2020 2020 2020  1 = len(.       
-0001aba0: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-0001abb0: 6172 6777 6865 7265 2828 7361 6d70 6c65  argwhere((sample
-0001abc0: 5b3a 2c20 305d 203d 3d20 3029 2026 2028  [:, 0] == 0) & (
-0001abd0: 7361 6d70 6c65 5b3a 2c20 315d 203d 3d20  sample[:, 1] == 
-0001abe0: 3129 292e 666c 6174 7465 6e28 290a 2020  1)).flatten().  
-0001abf0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac10: 636e 745f 315f 3020 3d20 6c65 6e28 0a20  cnt_1_0 = len(. 
-0001ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac30: 2020 206e 702e 6172 6777 6865 7265 2828     np.argwhere((
-0001ac40: 7361 6d70 6c65 5b3a 2c20 305d 203d 3d20  sample[:, 0] == 
-0001ac50: 3129 2026 2028 7361 6d70 6c65 5b3a 2c20  1) & (sample[:, 
-0001ac60: 315d 203d 3d20 3029 292e 666c 6174 7465  1] == 0)).flatte
-0001ac70: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
-0001ac80: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001ac90: 2020 2020 2020 636e 745f 315f 3120 3d20        cnt_1_1 = 
-0001aca0: 6c65 6e28 0a20 2020 2020 2020 2020 2020  len(.           
-0001acb0: 2020 2020 2020 2020 206e 702e 6172 6777           np.argw
-0001acc0: 6865 7265 2828 7361 6d70 6c65 5b3a 2c20  here((sample[:, 
-0001acd0: 305d 203d 3d20 3129 2026 2028 7361 6d70  0] == 1) & (samp
-0001ace0: 6c65 5b3a 2c20 315d 203d 3d20 3129 292e  le[:, 1] == 1)).
-0001acf0: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
-0001ad00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001ad10: 2020 2020 2020 2020 2020 2020 4243 2c20              BC, 
-0001ad20: 4144 203d 2063 6e74 5f31 5f31 202a 2063  AD = cnt_1_1 * c
-0001ad30: 6e74 5f30 5f30 2c20 636e 745f 315f 3020  nt_0_0, cnt_1_0 
-0001ad40: 2a20 636e 745f 305f 310a 2020 2020 2020  * cnt_0_1.      
-0001ad50: 2020 2020 2020 2020 2020 6e6f 6d69 6e61            nomina
-0001ad60: 746f 7220 3d20 4243 202d 2041 440a 2020  tor = BC - AD.  
-0001ad70: 2020 2020 2020 2020 2020 2020 2020 6465                de
-0001ad80: 6e6f 6d69 6e61 746f 7220 3d20 6e70 2e73  nominator = np.s
-0001ad90: 7172 7428 0a20 2020 2020 2020 2020 2020  qrt(.           
-0001ada0: 2020 2020 2020 2020 2028 636e 745f 315f           (cnt_1_
-0001adb0: 3020 2b20 636e 745f 315f 3129 0a20 2020  0 + cnt_1_1).   
-0001adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001add0: 202a 2028 636e 745f 305f 3020 2b20 636e   * (cnt_0_0 + cn
-0001ade0: 745f 305f 3129 0a20 2020 2020 2020 2020  t_0_1).         
-0001adf0: 2020 2020 2020 2020 2020 202a 2028 636e             * (cn
-0001ae00: 745f 315f 3020 2b20 636e 745f 305f 3029  t_1_0 + cnt_0_0)
-0001ae10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ae20: 2020 2020 202a 2028 636e 745f 315f 3120       * (cnt_1_1 
-0001ae30: 2a20 636e 745f 305f 3129 0a20 2020 2020  * cnt_0_1).     
-0001ae40: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001ae50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001ae60: 6e6f 6d69 6e61 746f 7220 3d3d 2030 206f  nominator == 0 o
-0001ae70: 7220 6465 6e6f 6d69 6e61 746f 7220 3d3d  r denominator ==
-0001ae80: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0001ae90: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
-0001aea0: 7220 2d20 312c 2069 5d20 3d20 302e 300a  r - 1, i] = 0.0.
-0001aeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aec0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001aed0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-0001aee0: 735b 7220 2d20 312c 2069 5d20 3d20 6e70  s[r - 1, i] = np
-0001aef0: 2e61 6273 280a 2020 2020 2020 2020 2020  .abs(.          
-0001af00: 2020 2020 2020 2020 2020 2020 2020 2842                (B
-0001af10: 4320 2d20 4144 290a 2020 2020 2020 2020  C - AD).        
-0001af20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af30: 2f20 6e70 2e73 7172 7428 0a20 2020 2020  / np.sqrt(.     
-0001af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af50: 2020 2020 2020 2028 636e 745f 315f 3020         (cnt_1_0 
-0001af60: 2b20 636e 745f 315f 3129 0a20 2020 2020  + cnt_1_1).     
-0001af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af80: 2020 2020 2020 202a 2028 636e 745f 305f         * (cnt_0_
-0001af90: 3020 2b20 636e 745f 305f 3129 0a20 2020  0 + cnt_0_1).   
-0001afa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001afb0: 2020 2020 2020 2020 202a 2028 636e 745f           * (cnt_
-0001afc0: 315f 3020 2b20 636e 745f 305f 3029 0a20  1_0 + cnt_0_0). 
-0001afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001afe0: 2020 2020 2020 2020 2020 202a 2028 636e             * (cn
-0001aff0: 745f 315f 3120 2a20 636e 745f 305f 3129  t_1_1 * cnt_0_1)
-0001b000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b010: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001b020: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001b030: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001b040: 2072 6573 756c 7473 2e61 7374 7970 6528   results.astype(
-0001b050: 6e70 2e66 6c6f 6174 3332 290a 0a20 2020  np.float32)..   
-0001b060: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-0001b070: 2020 2040 6e6a 6974 2822 696e 7436 345b     @njit("int64[
-0001b080: 3a5d 2c20 696e 7436 345b 3a5d 2c22 290a  :], int64[:],").
-0001b090: 2020 2020 6465 6620 636f 6865 6e73 5f68      def cohens_h
-0001b0a0: 2873 616d 706c 655f 313a 206e 702e 6e64  (sample_1: np.nd
-0001b0b0: 6172 7261 792c 2073 616d 706c 655f 323a  array, sample_2:
-0001b0c0: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
-0001b0d0: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
-0001b0e0: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
-0001b0f0: 6420 636f 6d70 7574 6520 436f 6865 6e27  d compute Cohen'
-0001b100: 7320 6820 6566 6665 6374 2073 697a 6520  s h effect size 
-0001b110: 666f 7220 7477 6f20 7361 6d70 6c65 7320  for two samples 
-0001b120: 6f66 2062 696e 6172 7920 5b30 2c20 315d  of binary [0, 1]
-0001b130: 2076 616c 7565 732e 2043 6f68 656e 2773   values. Cohen's
-0001b140: 2068 2069 7320 6120 6d65 6173 7572 6520   h is a measure 
-0001b150: 6f66 2065 6666 6563 7420 7369 7a65 0a20  of effect size. 
-0001b160: 2020 2020 2020 2066 6f72 2063 6f6d 7061         for compa
-0001b170: 7269 6e67 2074 776f 2069 6e64 6570 656e  ring two indepen
-0001b180: 6465 6e74 2073 616d 706c 6573 2062 6173  dent samples bas
-0001b190: 6564 206f 6e20 7468 6520 6469 6666 6572  ed on the differ
-0001b1a0: 656e 6365 7320 696e 2070 726f 706f 7274  ences in proport
-0001b1b0: 696f 6e73 206f 6620 7468 6520 7477 6f20  ions of the two 
-0001b1c0: 7361 6d70 6c65 732e 0a0a 2020 2020 2020  samples...      
-0001b1d0: 2020 2e2e 206e 6f74 653a 0a20 2020 2020    .. note:.     
-0001b1e0: 2020 2020 2020 4d6f 6469 6669 6564 2066        Modified f
-0001b1f0: 726f 6d20 6044 4142 4553 5420 3c68 7474  rom `DABEST <htt
-0001b200: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0001b210: 4143 434c 4142 2f44 4142 4553 542d 7079  ACCLAB/DABEST-py
-0001b220: 7468 6f6e 2f62 6c6f 622f 6661 3764 6635  thon/blob/fa7df5
-0001b230: 3064 3230 6162 3163 3963 6336 3837 6336  0d20ab1c9cc687c6
-0001b240: 3664 6438 6264 6466 3535 6439 6139 6463  6dd8bddf55d9a9dc
-0001b250: 6533 2f64 6162 6573 742f 5f73 7461 7473  e3/dabest/_stats
-0001b260: 5f74 6f6f 6c73 2f65 6666 7369 7a65 2e70  _tools/effsize.p
-0001b270: 7923 4c32 3136 3e60 5f0a 2020 2020 2020  y#L216>`_.      
-0001b280: 2020 2020 2060 436f 6865 6e27 7320 6820       `Cohen's h 
-0001b290: 7769 6b69 203c 6874 7470 733a 2f2f 656e  wiki <https://en
-0001b2a0: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
-0001b2b0: 696b 692f 436f 6865 6e25 3237 735f 683e  iki/Cohen%27s_h>
-0001b2c0: 605f 0a0a 2020 2020 2020 2020 2e2e 206d  `_..        .. m
-0001b2d0: 6174 683a 3a0a 0a20 2020 2020 2020 2020  ath::..         
-0001b2e0: 2020 5c5c 7465 7874 7b43 6f68 656e 2773    \\text{Cohen's
-0001b2f0: 2068 7d20 3d20 3220 5c5c 6172 6373 696e   h} = 2 \\arcsin
-0001b300: 5c5c 6c65 6674 285c 5c73 7172 747b 5c5c  \\left(\\sqrt{\\
-0001b310: 6672 6163 7b5c 5c73 756d 7b73 616d 706c  frac{\\sum{sampl
-0001b320: 655f 317d 7d7b 4e5f 317d 7d5c 5c72 6967  e_1}}{N_1}}\\rig
-0001b330: 6874 2920 2d20 3220 5c5c 6172 6373 696e  ht) - 2 \\arcsin
-0001b340: 5c6c 6566 7428 5c5c 7371 7274 7b5c 6672  \left(\\sqrt{\fr
-0001b350: 6163 7b5c 5c73 756d 7b73 616d 706c 655f  ac{\\sum{sample_
-0001b360: 327d 7d7b 4e5f 327d 7d5c 5c72 6967 6874  2}}{N_2}}\\right
-0001b370: 290a 0a20 2020 2020 2020 2057 6865 7265  )..        Where
-0001b380: 204e 5f31 2061 6e64 204e 5f32 2061 7265   N_1 and N_2 are
-0001b390: 2074 6865 2073 616d 706c 6520 7369 7a65   the sample size
-0001b3a0: 7320 6f66 2073 616d 706c 655f 3120 616e  s of sample_1 an
-0001b3b0: 6420 7361 6d70 6c65 5f32 2c20 7265 7370  d sample_2, resp
-0001b3c0: 6563 7469 7665 6c79 2e0a 0a20 2020 2020  ectively...     
-0001b3d0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-0001b3e0: 7272 6179 2073 616d 706c 655f 313a 2031  rray sample_1: 1
-0001b3f0: 4420 6172 7261 7920 7769 7468 2062 696e  D array with bin
-0001b400: 6172 7920 5b30 2c20 315d 2076 616c 7565  ary [0, 1] value
-0001b410: 7320 2865 2e67 2e2c 2066 6972 7374 2063  s (e.g., first c
-0001b420: 6c61 7373 6966 6965 7220 696e 6665 7265  lassifier infere
-0001b430: 6e63 6520 7661 6c75 6573 292e 0a20 2020  nce values)..   
-0001b440: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-0001b450: 6461 7272 6179 2073 616d 706c 655f 323a  darray sample_2:
-0001b460: 2031 4420 6172 7261 7920 7769 7468 2062   1D array with b
-0001b470: 696e 6172 7920 5b30 2c20 315d 2076 616c  inary [0, 1] val
-0001b480: 7565 7320 2865 2e67 2e2c 2073 6563 6f6e  ues (e.g., secon
-0001b490: 6420 636c 6173 7369 6669 6572 2069 6e66  d classifier inf
-0001b4a0: 6572 656e 6365 2076 616c 7565 7329 2e0a  erence values)..
-0001b4b0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-0001b4c0: 666c 6f61 743a 2043 6f68 656e 2773 2068  float: Cohen's h
-0001b4d0: 2065 6666 6563 7420 7369 7a65 2e0a 0a20   effect size... 
-0001b4e0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-0001b4f0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
-0001b500: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
-0001b510: 285b 312c 2030 2c20 302c 2031 5d29 0a20  ([1, 0, 0, 1]). 
-0001b520: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
-0001b530: 655f 3220 3d20 6e70 2e61 7272 6179 285b  e_2 = np.array([
-0001b540: 312c 2031 2c20 312c 2030 5d29 0a20 2020  1, 1, 1, 0]).   
-0001b550: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-0001b560: 6963 7328 292e 636f 6865 6e73 5f68 2873  ics().cohens_h(s
-0001b570: 616d 706c 655f 313d 7361 6d70 6c65 5f31  ample_1=sample_1
-0001b580: 2c20 7361 6d70 6c65 5f32 3d73 616d 706c  , sample_2=sampl
-0001b590: 655f 3229 0a20 2020 2020 2020 203e 3e3e  e_2).        >>>
-0001b5a0: 202d 302e 3532 3335 3938 3737 3535 3938   -0.523598775598
-0001b5b0: 3239 3835 0a20 2020 2020 2020 2022 2222  2985.        """
-0001b5c0: 0a0a 2020 2020 2020 2020 7361 6d70 6c65  ..        sample
-0001b5d0: 5f31 5f70 726f 706f 7274 696f 6e20 3d20  _1_proportion = 
-0001b5e0: 6e70 2e73 756d 2873 616d 706c 655f 3129  np.sum(sample_1)
-0001b5f0: 202f 2073 616d 706c 655f 312e 7368 6170   / sample_1.shap
-0001b600: 655b 305d 0a20 2020 2020 2020 2073 616d  e[0].        sam
-0001b610: 706c 655f 325f 7072 6f70 6f72 7469 6f6e  ple_2_proportion
-0001b620: 203d 206e 702e 7375 6d28 7361 6d70 6c65   = np.sum(sample
-0001b630: 5f32 2920 2f20 7361 6d70 6c65 5f32 2e73  _2) / sample_2.s
-0001b640: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
-0001b650: 7068 695f 7361 6d70 6c65 5f31 203d 2032  phi_sample_1 = 2
-0001b660: 202a 206e 702e 6172 6373 696e 286e 702e   * np.arcsin(np.
-0001b670: 7371 7274 2873 616d 706c 655f 315f 7072  sqrt(sample_1_pr
-0001b680: 6f70 6f72 7469 6f6e 2929 0a20 2020 2020  oportion)).     
-0001b690: 2020 2070 6869 5f73 616d 706c 655f 3220     phi_sample_2 
-0001b6a0: 3d20 3220 2a20 6e70 2e61 7263 7369 6e28  = 2 * np.arcsin(
-0001b6b0: 6e70 2e73 7172 7428 7361 6d70 6c65 5f32  np.sqrt(sample_2
-0001b6c0: 5f70 726f 706f 7274 696f 6e29 290a 0a20  _proportion)).. 
-0001b6d0: 2020 2020 2020 2072 6574 7572 6e20 7068         return ph
-0001b6e0: 695f 7361 6d70 6c65 5f31 202d 2070 6869  i_sample_1 - phi
-0001b6f0: 5f73 616d 706c 655f 320a 0a20 2020 2040  _sample_2..    @
-0001b700: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-0001b710: 2040 6a69 7428 2228 666c 6f61 7433 325b   @jit("(float32[
-0001b720: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
-0001b730: 696e 7436 342c 2922 290a 2020 2020 6465  int64,)").    de
-0001b740: 6620 736c 6964 696e 675f 736b 6577 280a  f sliding_skew(.
-0001b750: 2020 2020 2020 2020 6461 7461 3a20 6e70          data: np
-0001b760: 2e6e 6461 7272 6179 2c20 7469 6d65 5f77  .ndarray, time_w
-0001b770: 696e 646f 7773 3a20 6e70 2e6e 6461 7272  indows: np.ndarr
-0001b780: 6179 2c20 7361 6d70 6c65 5f72 6174 653a  ay, sample_rate:
-0001b790: 2069 6e74 0a20 2020 2029 202d 3e20 6e70   int.    ) -> np
-0001b7a0: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
-0001b7b0: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
-0001b7c0: 6d70 7574 6520 7468 6520 736b 6577 6e65  mpute the skewne
-0001b7d0: 7373 206f 6620 6120 3144 2061 7272 6179  ss of a 1D array
-0001b7e0: 2077 6974 6869 6e20 736c 6964 696e 6720   within sliding 
-0001b7f0: 7469 6d65 2077 696e 646f 7773 2e0a 0a20  time windows... 
-0001b800: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
-0001b810: 2e6e 6461 7272 6179 2064 6174 613a 2049  .ndarray data: I
-0001b820: 6e70 7574 2064 6174 6120 6172 7261 792e  nput data array.
-0001b830: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001b840: 6e70 2e6e 6461 7272 6179 2064 6174 613a  np.ndarray data:
-0001b850: 2031 4420 6172 7261 7920 6f66 2074 696d   1D array of tim
-0001b860: 6520 7769 6e64 6f77 2064 7572 6174 696f  e window duratio
-0001b870: 6e73 2069 6e20 7365 636f 6e64 732e 0a20  ns in seconds.. 
-0001b880: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
-0001b890: 2e6e 6461 7272 6179 2064 6174 613a 2053  .ndarray data: S
-0001b8a0: 616d 706c 696e 6720 7261 7465 206f 6620  ampling rate of 
-0001b8b0: 7468 6520 6461 7461 2069 6e20 7361 6d70  the data in samp
-0001b8c0: 6c65 7320 7065 7220 7365 636f 6e64 2e0a  les per second..
-0001b8d0: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-0001b8e0: 6e70 2e6e 6461 7272 6179 3a20 3244 2061  np.ndarray: 2D a
-0001b8f0: 7272 6179 206f 6620 736b 6577 6e65 7373  rray of skewness
-0001b900: 6031 2076 616c 7565 7320 7769 7468 2072  `1 values with r
-0001b910: 6f77 7320 636f 7272 6573 706f 6e64 696e  ows correspondin
-0001b920: 6720 746f 2064 6174 6120 706f 696e 7473  g to data points
-0001b930: 2061 6e64 2063 6f6c 756d 6e73 2063 6f72   and columns cor
-0001b940: 7265 7370 6f6e 6469 6e67 2074 6f20 7469  responding to ti
-0001b950: 6d65 2077 696e 646f 7773 2e0a 0a20 2020  me windows...   
-0001b960: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
-0001b970: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
-0001b980: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-0001b990: 696e 7428 302c 2031 3030 2c20 2831 302c  int(0, 100, (10,
-0001b9a0: 2929 0a20 2020 2020 2020 203e 3e3e 2073  )).        >>> s
-0001b9b0: 6b65 776e 6573 7320 3d20 5374 6174 6973  kewness = Statis
-0001b9c0: 7469 6373 2829 2e73 6c69 6469 6e67 5f73  tics().sliding_s
-0001b9d0: 6b65 7728 6461 7461 3d64 6174 612e 6173  kew(data=data.as
-0001b9e0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-0001b9f0: 2c20 7469 6d65 5f77 696e 646f 7773 3d6e  , time_windows=n
-0001ba00: 702e 6172 7261 7928 5b31 2e30 2c20 322e  p.array([1.0, 2.
-0001ba10: 305d 292c 2073 616d 706c 655f 7261 7465  0]), sample_rate
-0001ba20: 3d32 290a 2020 2020 2020 2020 2222 220a  =2).        """.
-0001ba30: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
-0001ba40: 203d 206e 702e 6675 6c6c 2828 6461 7461   = np.full((data
-0001ba50: 2e73 6861 7065 5b30 5d2c 2074 696d 655f  .shape[0], time_
-0001ba60: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
-0001ba70: 292c 2030 2e30 290a 2020 2020 2020 2020  ), 0.0).        
-0001ba80: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
-0001ba90: 7469 6d65 5f77 696e 646f 7773 2e73 6861  time_windows.sha
-0001baa0: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
-0001bab0: 2020 2020 7769 6e64 6f77 5f73 697a 6520      window_size 
-0001bac0: 3d20 696e 7428 7469 6d65 5f77 696e 646f  = int(time_windo
-0001bad0: 7773 5b69 5d20 2a20 7361 6d70 6c65 5f72  ws[i] * sample_r
-0001bae0: 6174 6529 0a20 2020 2020 2020 2020 2020  ate).           
-0001baf0: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
-0001bb00: 7769 6e64 6f77 5f73 697a 652c 2064 6174  window_size, dat
-0001bb10: 612e 7368 6170 655b 305d 202b 2031 293a  a.shape[0] + 1):
-0001bb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bb30: 2073 616d 706c 6520 3d20 6461 7461 5b6a   sample = data[j
-0001bb40: 202d 2077 696e 646f 775f 7369 7a65 203a   - window_size :
-0001bb50: 206a 5d0a 2020 2020 2020 2020 2020 2020   j].            
-0001bb60: 2020 2020 6d65 616e 2c20 7374 6420 3d20      mean, std = 
-0001bb70: 6e70 2e6d 6561 6e28 7361 6d70 6c65 292c  np.mean(sample),
-0001bb80: 206e 702e 7374 6428 7361 6d70 6c65 290a   np.std(sample).
-0001bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bba0: 7265 7375 6c74 735b 6a20 2d20 315d 5b69  results[j - 1][i
-0001bbb0: 5d20 3d20 2831 202f 2073 616d 706c 652e  ] = (1 / sample.
-0001bbc0: 7368 6170 655b 305d 2920 2a20 6e70 2e73  shape[0]) * np.s
-0001bbd0: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
-0001bbe0: 2020 2020 2020 2020 2828 6461 7461 202d          ((data -
-0001bbf0: 206d 6561 6e29 202f 2073 7464 2920 2a2a   mean) / std) **
-0001bc00: 2033 0a20 2020 2020 2020 2020 2020 2020   3.             
-0001bc10: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0001bc20: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
-0001bc30: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-0001bc40: 2020 2020 406a 6974 2822 2866 6c6f 6174      @jit("(float
-0001bc50: 3332 5b3a 5d2c 2066 6c6f 6174 3634 5b3a  32[:], float64[:
-0001bc60: 5d2c 2069 6e74 3634 2c29 2229 0a20 2020  ], int64,)").   
-0001bc70: 2064 6566 2073 6c69 6469 6e67 5f6b 7572   def sliding_kur
-0001bc80: 746f 7369 7328 0a20 2020 2020 2020 2064  tosis(.        d
-0001bc90: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
-0001bca0: 2074 696d 655f 7769 6e64 6f77 733a 206e   time_windows: n
-0001bcb0: 702e 6e64 6172 7261 792c 2073 616d 706c  p.ndarray, sampl
-0001bcc0: 655f 7261 7465 3a20 696e 740a 2020 2020  e_rate: int.    
-0001bcd0: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
-0001bce0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001bcf0: 2020 2020 2043 6f6d 7075 7465 2074 6865       Compute the
-0001bd00: 206b 7572 746f 7369 7320 6f66 2061 2031   kurtosis of a 1
-0001bd10: 4420 6172 7261 7920 7769 7468 696e 2073  D array within s
-0001bd20: 6c69 6469 6e67 2074 696d 6520 7769 6e64  liding time wind
-0001bd30: 6f77 732e 0a0a 2020 2020 2020 2020 3a70  ows...        :p
-0001bd40: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
-0001bd50: 6461 7461 3a20 496e 7075 7420 6461 7461  data: Input data
-0001bd60: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
-0001bd70: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-0001bd80: 7920 7469 6d65 5f77 696e 646f 7773 3a20  y time_windows: 
-0001bd90: 3144 2061 7272 6179 206f 6620 7469 6d65  1D array of time
-0001bda0: 2077 696e 646f 7720 6475 7261 7469 6f6e   window duration
-0001bdb0: 7320 696e 2073 6563 6f6e 6473 2e0a 2020  s in seconds..  
-0001bdc0: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
-0001bdd0: 6e64 6172 7261 7920 7361 6d70 6c65 5f72  ndarray sample_r
-0001bde0: 6174 653a 2053 616d 706c 696e 6720 7261  ate: Sampling ra
-0001bdf0: 7465 206f 6620 7468 6520 6461 7461 2069  te of the data i
-0001be00: 6e20 7361 6d70 6c65 7320 7065 7220 7365  n samples per se
-0001be10: 636f 6e64 2e0a 2020 2020 2020 2020 3a72  cond..        :r
-0001be20: 6574 7572 6e20 6e70 2e6e 6461 7272 6179  eturn np.ndarray
-0001be30: 3a20 3244 2061 7272 6179 206f 6620 736b  : 2D array of sk
-0001be40: 6577 6e65 7373 6031 2076 616c 7565 7320  ewness`1 values 
-0001be50: 7769 7468 2072 6f77 7320 636f 7272 6573  with rows corres
-0001be60: 706f 6e64 696e 6720 746f 2064 6174 6120  ponding to data 
-0001be70: 706f 696e 7473 2061 6e64 2063 6f6c 756d  points and colum
-0001be80: 6e73 2063 6f72 7265 7370 6f6e 6469 6e67  ns corresponding
-0001be90: 2074 6f20 7469 6d65 2077 696e 646f 7773   to time windows
-0001bea0: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
-0001beb0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-0001bec0: 2064 6174 6120 3d20 6e70 2e72 616e 646f   data = np.rando
-0001bed0: 6d2e 7261 6e64 696e 7428 302c 2031 3030  m.randint(0, 100
-0001bee0: 2c20 2831 302c 2929 0a20 2020 2020 2020  , (10,)).       
-0001bef0: 203e 3e3e 206b 7572 746f 7369 7320 3d20   >>> kurtosis = 
-0001bf00: 5374 6174 6973 7469 6373 2829 2e73 6c69  Statistics().sli
-0001bf10: 6469 6e67 5f6b 7572 746f 7369 7328 6461  ding_kurtosis(da
-0001bf20: 7461 3d64 6174 612e 6173 7479 7065 286e  ta=data.astype(n
-0001bf30: 702e 666c 6f61 7433 3229 2c20 7469 6d65  p.float32), time
-0001bf40: 5f77 696e 646f 7773 3d6e 702e 6172 7261  _windows=np.arra
-0001bf50: 7928 5b31 2e30 2c20 322e 305d 292c 2073  y([1.0, 2.0]), s
-0001bf60: 616d 706c 655f 7261 7465 3d32 290a 2020  ample_rate=2).  
-0001bf70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001bf80: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
-0001bf90: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
-0001bfa0: 305d 2c20 7469 6d65 5f77 696e 646f 7773  0], time_windows
-0001bfb0: 2e73 6861 7065 5b30 5d29 2c20 302e 3029  .shape[0]), 0.0)
-0001bfc0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0001bfd0: 6e20 7072 616e 6765 2874 696d 655f 7769  n prange(time_wi
-0001bfe0: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
-0001bff0: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-0001c000: 646f 775f 7369 7a65 203d 2074 696d 655f  dow_size = time_
-0001c010: 7769 6e64 6f77 735b 695d 202a 2073 616d  windows[i] * sam
-0001c020: 706c 655f 7261 7465 0a20 2020 2020 2020  ple_rate.       
-0001c030: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-0001c040: 6e67 6528 7769 6e64 6f77 5f73 697a 652c  nge(window_size,
-0001c050: 2064 6174 612e 7368 6170 655b 305d 202b   data.shape[0] +
-0001c060: 2031 293a 0a20 2020 2020 2020 2020 2020   1):.           
-0001c070: 2020 2020 2073 616d 706c 6520 3d20 6461       sample = da
-0001c080: 7461 5b6a 202d 2077 696e 646f 775f 7369  ta[j - window_si
-0001c090: 7a65 203a 206a 5d0a 2020 2020 2020 2020  ze : j].        
-0001c0a0: 2020 2020 2020 2020 6d65 616e 2c20 7374          mean, st
-0001c0b0: 6420 3d20 6e70 2e6d 6561 6e28 7361 6d70  d = np.mean(samp
-0001c0c0: 6c65 292c 206e 702e 7374 6428 7361 6d70  le), np.std(samp
-0001c0d0: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-0001c0e0: 2020 2020 7265 7375 6c74 735b 6a20 2d20      results[j - 
-0001c0f0: 315d 5b69 5d20 3d20 6e70 2e6d 6561 6e28  1][i] = np.mean(
-0001c100: 2828 6461 7461 202d 206d 6561 6e29 202f  ((data - mean) /
-0001c110: 2073 7464 2920 2a2a 2034 2920 2d20 330a   std) ** 4) - 3.
-0001c120: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0001c130: 6573 756c 7473 0a0a 2020 2020 4073 7461  esults..    @sta
-0001c140: 7469 636d 6574 686f 640a 2020 2020 406a  ticmethod.    @j
-0001c150: 6974 286e 6f70 7974 686f 6e3d 5472 7565  it(nopython=True
-0001c160: 290a 2020 2020 2320 406e 6a69 7428 5b28  ).    # @njit([(
-0001c170: 666c 6f61 7433 325b 3a5d 2c20 666c 6f61  float32[:], floa
-0001c180: 7436 342c 2069 6e74 3634 2c20 626f 6f6c  t64, int64, bool
-0001c190: 6561 6e29 2c5d 290a 2020 2020 6465 6620  ean),]).    def 
-0001c1a0: 6b6d 6561 6e73 5f31 6428 0a20 2020 2020  kmeans_1d(.     
-0001c1b0: 2020 2064 6174 613a 206e 702e 6e64 6172     data: np.ndar
-0001c1c0: 7261 792c 206b 3a20 696e 742c 206d 6178  ray, k: int, max
-0001c1d0: 5f69 7465 7273 3a20 696e 742c 2063 616c  _iters: int, cal
-0001c1e0: 635f 6d65 6469 616e 733a 2062 6f6f 6c0a  c_medians: bool.
-0001c1f0: 2020 2020 2920 2d3e 2054 7570 6c65 5b6e      ) -> Tuple[n
-0001c200: 702e 6e64 6172 7261 792c 206e 702e 6e64  p.ndarray, np.nd
-0001c210: 6172 7261 792c 2055 6e69 6f6e 5b4e 6f6e  array, Union[Non
-0001c220: 652c 2074 7970 6573 2e44 6963 7454 7970  e, types.DictTyp
-0001c230: 655d 5d3a 0a20 2020 2020 2020 2022 2222  e]]:.        """
-0001c240: 0a20 2020 2020 2020 2050 6572 666f 726d  .        Perform
-0001c250: 206b 2d6d 6561 6e73 2063 6c75 7374 6572   k-means cluster
-0001c260: 696e 6720 6f6e 2061 2031 2d64 696d 656e  ing on a 1-dimen
-0001c270: 7369 6f6e 616c 2064 6174 6173 6574 2e0a  sional dataset..
-0001c280: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0001c290: 7465 7220 6e70 2e6e 6461 7272 6179 2064  ter np.ndarray d
-0001c2a0: 6174 613a 2031 6420 6172 7261 7920 636f  ata: 1d array co
-0001c2b0: 6e74 6169 6e69 6e67 2066 6561 7475 7265  ntaining feature
-0001c2c0: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
-0001c2d0: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
-0001c2e0: 6b3a 204e 756d 6265 7220 6f66 2063 6c75  k: Number of clu
-0001c2f0: 7374 6572 732e 0a20 2020 2020 2020 203a  sters..        :
-0001c300: 7061 7261 6d65 7465 7220 696e 7420 6d61  parameter int ma
-0001c310: 785f 6974 6572 733a 204d 6178 696d 756d  x_iters: Maximum
-0001c320: 206e 756d 6265 7220 6f66 2069 7465 7261   number of itera
-0001c330: 7469 6f6e 7320 666f 7220 7468 6520 6b2d  tions for the k-
-0001c340: 6d65 616e 7320 616c 676f 7269 7468 6d2e  means algorithm.
-0001c350: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0001c360: 7465 7220 626f 6f6c 2063 616c 635f 6d65  ter bool calc_me
-0001c370: 6469 616e 733a 2046 6c61 6720 696e 6469  dians: Flag indi
-0001c380: 6361 7469 6e67 2077 6865 7468 6572 2074  cating whether t
-0001c390: 6f20 6361 6c63 756c 6174 6520 636c 7573  o calculate clus
-0001c3a0: 7465 7220 6d65 6469 616e 732e 0a20 2020  ter medians..   
-0001c3b0: 2020 2020 203a 7265 7475 726e 7320 5475       :returns Tu
-0001c3c0: 706c 653a 2054 7570 6c65 206f 6620 7468  ple: Tuple of th
-0001c3d0: 7265 6520 656c 656d 656e 7473 2e20 4669  ree elements. Fi
-0001c3e0: 6e61 6c20 6365 6e74 726f 6964 7320 6f66  nal centroids of
-0001c3f0: 2074 6865 2063 6c75 7374 6572 732e 204c   the clusters. L
-0001c400: 6162 656c 7320 6173 7369 676e 6564 2074  abels assigned t
-0001c410: 6f20 6561 6368 2064 6174 6120 706f 696e  o each data poin
-0001c420: 7420 6261 7365 6420 6f6e 2063 6c75 7374  t based on clust
-0001c430: 6572 732e 2043 6c75 7374 6572 206d 6564  ers. Cluster med
-0001c440: 6961 6e73 2028 6966 2063 616c 635f 6d65  ians (if calc_me
-0001c450: 6469 616e 7320 6973 2054 7275 6529 2c20  dians is True), 
-0001c460: 6f74 6865 7277 6973 6520 4e6f 6e65 2e0a  otherwise None..
-0001c470: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-0001c480: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
-0001c490: 6174 615f 3164 203d 206e 702e 6172 7261  ata_1d = np.arra
-0001c4a0: 7928 5b31 2c20 322c 2033 2c20 3535 2c20  y([1, 2, 3, 55, 
-0001c4b0: 3635 2c20 3430 2c20 3433 2c20 3430 5d29  65, 40, 43, 40])
-0001c4c0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-0001c4d0: 3634 290a 2020 2020 2020 2020 3e3e 3e20  64).        >>> 
-0001c4e0: 6365 6e74 726f 6964 732c 206c 6162 656c  centroids, label
-0001c4f0: 732c 206d 6564 6961 6e73 203d 2053 7461  s, medians = Sta
-0001c500: 7469 7374 6963 7328 292e 6b6d 6561 6e73  tistics().kmeans
-0001c510: 5f31 6428 6461 7461 5f31 642c 2032 2c20  _1d(data_1d, 2, 
-0001c520: 3130 3030 2c20 5472 7565 290a 2020 2020  1000, True).    
-0001c530: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0001c540: 2064 6174 6120 3d20 6e70 2e61 7363 6f6e   data = np.ascon
-0001c550: 7469 6775 6f75 7361 7272 6179 2864 6174  tiguousarray(dat
-0001c560: 6129 0a20 2020 2020 2020 2058 203d 2064  a).        X = d
-0001c570: 6174 612e 7265 7368 6170 6528 2864 6174  ata.reshape((dat
-0001c580: 612e 7368 6170 655b 305d 2c20 3129 290a  a.shape[0], 1)).
-0001c590: 2020 2020 2020 2020 6c61 6265 6c73 2c20          labels, 
-0001c5a0: 6d65 6469 616e 7320 3d20 4e6f 6e65 2c20  medians = None, 
-0001c5b0: 4e6f 6e65 0a20 2020 2020 2020 2063 656e  None.        cen
-0001c5c0: 7472 6f69 6473 203d 2058 5b6e 702e 7261  troids = X[np.ra
-0001c5d0: 6e64 6f6d 2e63 686f 6963 6528 6461 7461  ndom.choice(data
-0001c5e0: 2e73 6861 7065 5b30 5d2c 206b 2c20 7265  .shape[0], k, re
-0001c5f0: 706c 6163 653d 4661 6c73 6529 5d2e 636f  place=False)].co
-0001c600: 7079 2829 0a20 2020 2020 2020 2066 6f72  py().        for
-0001c610: 205f 2069 6e20 7261 6e67 6528 6d61 785f   _ in range(max_
-0001c620: 6974 6572 7329 3a0a 2020 2020 2020 2020  iters):.        
-0001c630: 2020 2020 6c61 6265 6c73 203d 206e 702e      labels = np.
-0001c640: 7a65 726f 7328 582e 7368 6170 655b 305d  zeros(X.shape[0]
-0001c650: 2c20 6474 7970 653d 6e70 2e69 6e74 3634  , dtype=np.int64
-0001c660: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-0001c670: 7220 6920 696e 2072 616e 6765 2858 2e73  r i in range(X.s
-0001c680: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
-0001c690: 2020 2020 2020 2020 2020 6d69 6e5f 6469            min_di
-0001c6a0: 7374 203d 206e 702e 696e 660a 2020 2020  st = np.inf.    
-0001c6b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001c6c0: 6a20 696e 2072 616e 6765 286b 293a 0a20  j in range(k):. 
-0001c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6e0: 2020 2064 6973 7420 3d20 6e70 2e61 6273     dist = np.abs
-0001c6f0: 2858 5b69 5d20 2d20 6365 6e74 726f 6964  (X[i] - centroid
-0001c700: 735b 6a5d 290a 2020 2020 2020 2020 2020  s[j]).          
-0001c710: 2020 2020 2020 2020 2020 6469 7374 5f73            dist_s
-0001c720: 756d 203d 206e 702e 7375 6d28 6469 7374  um = np.sum(dist
-0001c730: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001c740: 2020 2020 2020 6966 2064 6973 745f 7375        if dist_su
-0001c750: 6d20 3c20 6d69 6e5f 6469 7374 3a0a 2020  m < min_dist:.  
-0001c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c770: 2020 2020 2020 6d69 6e5f 6469 7374 203d        min_dist =
-0001c780: 2064 6973 745f 7375 6d0a 2020 2020 2020   dist_sum.      
-0001c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7a0: 2020 6c61 6265 6c73 5b69 5d20 3d20 6a0a    labels[i] = j.
-0001c7b0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-0001c7c0: 5f63 656e 7472 6f69 6473 203d 206e 702e  _centroids = np.
-0001c7d0: 7a65 726f 735f 6c69 6b65 2863 656e 7472  zeros_like(centr
-0001c7e0: 6f69 6473 290a 2020 2020 2020 2020 2020  oids).          
-0001c7f0: 2020 636f 756e 7473 203d 206e 702e 7a65    counts = np.ze
-0001c800: 726f 7328 6b2c 2064 7479 7065 3d6e 702e  ros(k, dtype=np.
-0001c810: 696e 7436 3429 0a20 2020 2020 2020 2020  int64).         
-0001c820: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0001c830: 6528 582e 7368 6170 655b 305d 293a 0a20  e(X.shape[0]):. 
-0001c840: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001c850: 6c75 7374 6572 203d 206c 6162 656c 735b  luster = labels[
-0001c860: 695d 0a20 2020 2020 2020 2020 2020 2020  i].             
-0001c870: 2020 206e 6577 5f63 656e 7472 6f69 6473     new_centroids
-0001c880: 5b63 6c75 7374 6572 5d20 2b3d 2058 5b69  [cluster] += X[i
-0001c890: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001c8a0: 2020 636f 756e 7473 5b63 6c75 7374 6572    counts[cluster
-0001c8b0: 5d20 2b3d 2031 0a0a 2020 2020 2020 2020  ] += 1..        
-0001c8c0: 2020 2020 666f 7220 6a20 696e 2072 616e      for j in ran
-0001c8d0: 6765 286b 293a 0a20 2020 2020 2020 2020  ge(k):.         
-0001c8e0: 2020 2020 2020 2069 6620 636f 756e 7473         if counts
-0001c8f0: 5b6a 5d20 3e20 303a 0a20 2020 2020 2020  [j] > 0:.       
-0001c900: 2020 2020 2020 2020 2020 2020 206e 6577               new
-0001c910: 5f63 656e 7472 6f69 6473 5b6a 5d20 2f3d  _centroids[j] /=
-0001c920: 2063 6f75 6e74 735b 6a5d 0a0a 2020 2020   counts[j]..    
-0001c930: 2020 2020 2020 2020 6966 206e 702e 6172          if np.ar
-0001c940: 7261 795f 6571 7561 6c28 6365 6e74 726f  ray_equal(centro
-0001c950: 6964 732c 206e 6577 5f63 656e 7472 6f69  ids, new_centroi
-0001c960: 6473 293a 0a20 2020 2020 2020 2020 2020  ds):.           
-0001c970: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-0001c980: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001c990: 2020 2020 2020 2020 2020 2020 2063 656e               cen
-0001c9a0: 7472 6f69 6473 203d 206e 6577 5f63 656e  troids = new_cen
-0001c9b0: 7472 6f69 6473 0a0a 2020 2020 2020 2020  troids..        
-0001c9c0: 6966 2063 616c 635f 6d65 6469 616e 733a  if calc_medians:
-0001c9d0: 0a20 2020 2020 2020 2020 2020 206c 6162  .            lab
-0001c9e0: 656c 732c 206d 6564 6961 6e73 203d 206c  els, medians = l
-0001c9f0: 6162 656c 732e 6173 7479 7065 286e 702e  abels.astype(np.
-0001ca00: 696e 7436 3429 2c20 7b7d 0a20 2020 2020  int64), {}.     
-0001ca10: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0001ca20: 7072 616e 6765 2830 2c20 6b2c 2031 293a  prange(0, k, 1):
-0001ca30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ca40: 206d 6564 6961 6e73 5b69 5d20 3d20 6e70   medians[i] = np
-0001ca50: 2e6d 6564 6961 6e28 6461 7461 5b6e 702e  .median(data[np.
-0001ca60: 6172 6777 6865 7265 286c 6162 656c 7320  argwhere(labels 
-0001ca70: 3d3d 2069 292e 666c 6174 7465 6e28 295d  == i).flatten()]
-0001ca80: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0001ca90: 6e20 6365 6e74 726f 6964 732c 206c 6162  n centroids, lab
-0001caa0: 656c 732c 206d 6564 6961 6e73 0a0a 2020  els, medians..  
-0001cab0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
-0001cac0: 2020 2020 406e 6a69 7428 0a20 2020 2020      @njit(.     
-0001cad0: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-0001cae0: 2028 696e 7438 5b3a 5d2c 2069 6e74 385b   (int8[:], int8[
-0001caf0: 3a5d 2c20 7479 7065 732e 6d69 7363 2e4f  :], types.misc.O
-0001cb00: 6d69 7474 6564 2876 616c 7565 3d46 616c  mitted(value=Fal
-0001cb10: 7365 292c 2066 6c6f 6174 3332 5b3a 5d29  se), float32[:])
-0001cb20: 2c0a 2020 2020 2020 2020 2020 2020 280a  ,.            (.
-0001cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb40: 696e 7438 5b3a 5d2c 0a20 2020 2020 2020  int8[:],.       
-0001cb50: 2020 2020 2020 2020 2069 6e74 385b 3a5d           int8[:]
-0001cb60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001cb70: 2020 7479 7065 732e 6d69 7363 2e4f 6d69    types.misc.Omi
-0001cb80: 7474 6564 2876 616c 7565 3d46 616c 7365  tted(value=False
-0001cb90: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0001cba0: 2020 2074 7970 6573 2e6d 6973 632e 4f6d     types.misc.Om
-0001cbb0: 6974 7465 6428 4e6f 6e65 292c 0a20 2020  itted(None),.   
-0001cbc0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-0001cbd0: 2020 2020 2020 2020 2869 6e74 385b 3a5d          (int8[:]
-0001cbe0: 2c20 696e 7438 5b3a 5d2c 2062 6f6f 6c5f  , int8[:], bool_
-0001cbf0: 2c20 666c 6f61 7433 325b 3a5d 292c 0a20  , float32[:]),. 
-0001cc00: 2020 2020 2020 2020 2020 2028 696e 7438             (int8
-0001cc10: 5b3a 5d2c 2069 6e74 385b 3a5d 2c20 626f  [:], int8[:], bo
-0001cc20: 6f6c 5f2c 2074 7970 6573 2e6d 6973 632e  ol_, types.misc.
-0001cc30: 4f6d 6974 7465 6428 4e6f 6e65 2929 2c0a  Omitted(None)),.
-0001cc40: 2020 2020 2020 2020 5d0a 2020 2020 290a          ].    ).
-0001cc50: 2020 2020 6465 6620 6861 6d6d 696e 675f      def hamming_
-0001cc60: 6469 7374 616e 6365 280a 2020 2020 2020  distance(.      
-0001cc70: 2020 783a 206e 702e 6e64 6172 7261 792c    x: np.ndarray,
-0001cc80: 0a20 2020 2020 2020 2079 3a20 6e70 2e6e  .        y: np.n
-0001cc90: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
-0001cca0: 736f 7274 3a20 4f70 7469 6f6e 616c 5b62  sort: Optional[b
-0001ccb0: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2020  ool] = False,.  
-0001ccc0: 2020 2020 2020 773a 204f 7074 696f 6e61        w: Optiona
-0001ccd0: 6c5b 6e70 2e6e 6461 7272 6179 5d20 3d20  l[np.ndarray] = 
-0001cce0: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2066  None,.    ) -> f
-0001ccf0: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
-0001cd00: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
-0001cd10: 2063 616c 6375 6c61 7465 206f 6620 7468   calculate of th
-0001cd20: 6520 4861 6d6d 696e 6720 7369 6d69 6c61  e Hamming simila
-0001cd30: 7269 7479 2062 6574 7765 656e 2074 776f  rity between two
-0001cd40: 2076 6563 746f 7273 2e0a 0a20 2020 2020   vectors...     
-0001cd50: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
-0001cd60: 2020 2020 2020 2020 4164 6170 7465 6420          Adapted 
-0001cd70: 6672 6f6d 2060 7079 6e6e 6465 7363 656e  from `pynndescen
-0001cd80: 7420 3c68 7474 7073 3a2f 2f70 796e 6e64  t <https://pynnd
-0001cd90: 6573 6365 6e74 2e72 6561 6474 6865 646f  escent.readthedo
-0001cda0: 6373 2e69 6f2f 656e 2f6c 6174 6573 742f  cs.io/en/latest/
-0001cdb0: 3e60 5f2e 0a0a 2020 2020 2020 2020 3a70  >`_...        :p
-0001cdc0: 6172 616d 6574 6572 206e 702e 6e64 6172  arameter np.ndar
-0001cdd0: 7261 7920 783a 2046 6972 7374 2062 696e  ray x: First bin
-0001cde0: 6172 7920 7665 6374 6f72 2e0a 2020 2020  ary vector..    
-0001cdf0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
-0001ce00: 702e 6e64 6172 7261 7920 783a 2053 6563  p.ndarray x: Sec
-0001ce10: 6f6e 6420 6269 6e61 7279 2076 6563 746f  ond binary vecto
-0001ce20: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
-0001ce30: 6d65 7465 7220 4f70 7469 6f6e 616c 5b6e  meter Optional[n
-0001ce40: 702e 6e64 6172 7261 795d 2077 3a20 4f70  p.ndarray] w: Op
-0001ce50: 7469 6f6e 616c 2077 6569 6768 7473 2066  tional weights f
-0001ce60: 6f72 2065 6163 6820 656c 656d 656e 742e  or each element.
-0001ce70: 2043 616e 2062 6520 636c 6173 7369 6669   Can be classifi
-0001ce80: 6361 7469 6f6e 2070 726f 6261 6269 6c69  cation probabili
-0001ce90: 7469 6573 2e20 4966 206e 6f74 2070 726f  ties. If not pro
-0001cea0: 7669 6465 642c 2065 7175 616c 2077 6569  vided, equal wei
-0001ceb0: 6768 7473 2061 7265 2061 7373 756d 6564  ghts are assumed
-0001cec0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001ced0: 6574 6572 204f 7074 696f 6e61 6c5b 626f  eter Optional[bo
-0001cee0: 6f6c 5d20 736f 7274 3a20 4966 2054 7275  ol] sort: If Tru
-0001cef0: 652c 2073 6f72 7473 2078 2061 6e64 2079  e, sorts x and y
-0001cf00: 2070 7269 6f72 2074 6f20 6861 6d6d 696e   prior to hammin
-0001cf10: 6720 6469 7374 616e 6365 2063 616c 6375  g distance calcu
-0001cf20: 6c61 7469 6f6e 2e20 4465 6661 756c 742c  lation. Default,
-0001cf30: 2046 616c 7365 2e0a 0a20 2020 2020 2020   False...       
-0001cf40: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
-0001cf50: 2020 203e 3e3e 2078 2c20 7920 3d20 6e70     >>> x, y = np
-0001cf60: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-0001cf70: 302c 2032 2c20 2831 302c 2929 2e61 7374  0, 2, (10,)).ast
-0001cf80: 7970 6528 6e70 2e69 6e74 3829 2c20 6e70  ype(np.int8), np
-0001cf90: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-0001cfa0: 302c 2032 2c20 2831 302c 2929 2e61 7374  0, 2, (10,)).ast
-0001cfb0: 7970 6528 6e70 2e69 6e74 3829 0a20 2020  ype(np.int8).   
-0001cfc0: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
-0001cfd0: 6963 7328 292e 6861 6d6d 696e 675f 6469  ics().hamming_di
-0001cfe0: 7374 616e 6365 2878 3d78 2c20 793d 7929  stance(x=x, y=y)
-0001cff0: 0a20 2020 2020 2020 203e 3e3e 2030 2e39  .        >>> 0.9
-0001d000: 310a 2020 2020 2020 2020 2222 220a 2020  1.        """.  
-0001d010: 2020 2020 2020 2320 7061 7373 0a20 2020        # pass.   
-0001d020: 2020 2020 2069 6620 7720 6973 204e 6f6e       if w is Non
-0001d030: 653a 0a20 2020 2020 2020 2020 2020 2077  e:.            w
-0001d040: 203d 206e 702e 6f6e 6573 2878 2e73 6861   = np.ones(x.sha
-0001d050: 7065 5b30 5d29 2e61 7374 7970 6528 6e70  pe[0]).astype(np
-0001d060: 2e66 6c6f 6174 3332 290a 0a20 2020 2020  .float32)..     
-0001d070: 2020 2072 6573 756c 7473 203d 2030 2e30     results = 0.0
-0001d080: 0a20 2020 2020 2020 2069 6620 736f 7274  .        if sort
-0001d090: 3a0a 2020 2020 2020 2020 2020 2020 782c  :.            x,
-0001d0a0: 2079 203d 206e 702e 736f 7274 2878 292c   y = np.sort(x),
-0001d0b0: 206e 702e 736f 7274 2879 290a 2020 2020   np.sort(y).    
-0001d0c0: 2020 2020 666f 7220 6920 696e 2070 7261      for i in pra
-0001d0d0: 6e67 6528 782e 7368 6170 655b 305d 293a  nge(x.shape[0]):
-0001d0e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001d0f0: 785b 695d 2021 3d20 795b 695d 3a0a 2020  x[i] != y[i]:.  
-0001d100: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001d110: 7375 6c74 7320 2b3d 2031 2e30 202a 2077  sults += 1.0 * w
-0001d120: 5b69 5d0a 2020 2020 2020 2020 7265 7475  [i].        retu
-0001d130: 726e 2072 6573 756c 7473 202f 2078 2e73  rn results / x.s
-0001d140: 6861 7065 5b30 5d0a 0a20 2020 2040 7374  hape[0]..    @st
-0001d150: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
-0001d160: 6e6a 6974 280a 2020 2020 2020 2020 5b28  njit(.        [(
-0001d170: 696e 7438 5b3a 5d2c 2069 6e74 385b 3a5d  int8[:], int8[:]
-0001d180: 2c20 666c 6f61 7433 325b 3a5d 292c 2028  , float32[:]), (
-0001d190: 696e 7438 5b3a 5d2c 2069 6e74 385b 3a5d  int8[:], int8[:]
-0001d1a0: 2c20 7479 7065 732e 6d69 7363 2e4f 6d69  , types.misc.Omi
-0001d1b0: 7474 6564 284e 6f6e 6529 295d 0a20 2020  tted(None))].   
-0001d1c0: 2029 0a20 2020 2064 6566 2079 756c 655f   ).    def yule_
-0001d1d0: 636f 6566 280a 2020 2020 2020 2020 783a  coef(.        x:
-0001d1e0: 206e 702e 6e64 6172 7261 792c 2079 3a20   np.ndarray, y: 
-0001d1f0: 6e70 2e6e 6461 7272 6179 2c20 773a 204f  np.ndarray, w: O
-0001d200: 7074 696f 6e61 6c5b 6e70 2e6e 6461 7272  ptional[np.ndarr
-0001d210: 6179 5d20 3d20 4e6f 6e65 0a20 2020 2029  ay] = None.    )
-0001d220: 202d 3e20 666c 6f61 7436 343a 0a20 2020   -> float64:.   
-0001d230: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001d240: 204a 6974 7465 6420 6361 6c63 756c 6174   Jitted calculat
-0001d250: 6520 6f66 2074 6865 2079 756c 6520 636f  e of the yule co
-0001d260: 6566 6669 6369 656e 7420 6265 7477 6565  efficient betwee
-0001d270: 6e20 7477 6f20 6269 6e61 7279 2076 6563  n two binary vec
-0001d280: 746f 7273 2028 652e 672e 2c20 746f 2063  tors (e.g., to c
-0001d290: 6c61 7373 6966 6965 6420 6265 6861 7669  lassified behavi
-0001d2a0: 6f72 7329 2e20 3020 7265 7072 6573 656e  ors). 0 represen
-0001d2b0: 7420 696e 6465 7065 6e64 656e 6365 2c20  t independence, 
-0001d2c0: 3220 7265 7072 6573 656e 7473 0a20 2020  2 represents.   
-0001d2d0: 2020 2020 2063 6f6d 706c 6574 6520 696e       complete in
-0001d2e0: 7465 7264 6570 656e 6465 6e63 652e 0a0a  terdependence...
-0001d2f0: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
-0001d300: 3a0a 2020 2020 2020 2020 2020 2041 6461  :.           Ada
-0001d310: 7074 6564 2066 726f 6d20 6070 796e 6e64  pted from `pynnd
-0001d320: 6573 6365 6e74 203c 6874 7470 733a 2f2f  escent <https://
-0001d330: 7079 6e6e 6465 7363 656e 742e 7265 6164  pynndescent.read
-0001d340: 7468 6564 6f63 732e 696f 2f65 6e2f 6c61  thedocs.io/en/la
-0001d350: 7465 7374 2f3e 605f 2e0a 0a20 2020 2020  test/>`_...     
-0001d360: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
-0001d370: 2e6e 6461 7272 6179 2078 3a20 4669 7273  .ndarray x: Firs
-0001d380: 7420 6269 6e61 7279 2076 6563 746f 722e  t binary vector.
-0001d390: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0001d3a0: 7465 7220 6e70 2e6e 6461 7272 6179 2078  ter np.ndarray x
-0001d3b0: 3a20 5365 636f 6e64 2062 696e 6172 7920  : Second binary 
-0001d3c0: 7665 6374 6f72 2e0a 2020 2020 2020 2020  vector..        
-0001d3d0: 3a70 6172 616d 6574 6572 204f 7074 696f  :parameter Optio
-0001d3e0: 6e61 6c5b 6e70 2e6e 6461 7272 6179 5d20  nal[np.ndarray] 
-0001d3f0: 773a 204f 7074 696f 6e61 6c20 7765 6967  w: Optional weig
-0001d400: 6874 7320 666f 7220 6561 6368 2065 6c65  hts for each ele
-0001d410: 6d65 6e74 2e20 4361 6e20 6265 2063 6c61  ment. Can be cla
-0001d420: 7373 6966 6963 6174 696f 6e20 7072 6f62  ssification prob
-0001d430: 6162 696c 6974 6965 732e 2049 6620 6e6f  abilities. If no
-0001d440: 7420 7072 6f76 6964 6564 2c20 6571 7561  t provided, equa
-0001d450: 6c20 7765 6967 6874 7320 6172 6520 6173  l weights are as
-0001d460: 7375 6d65 642e 0a0a 2020 2020 2020 2020  sumed...        
-0001d470: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
-0001d480: 2020 3e3e 3e20 7820 3d20 6e70 2e72 616e    >>> x = np.ran
-0001d490: 646f 6d2e 7261 6e64 696e 7428 302c 2032  dom.randint(0, 2
-0001d4a0: 2c20 2835 302c 2929 2e61 7374 7970 6528  , (50,)).astype(
-0001d4b0: 6e70 2e69 6e74 3829 0a20 2020 2020 2020  np.int8).       
-0001d4c0: 203e 3e3e 2079 203d 2078 205e 2031 0a20   >>> y = x ^ 1. 
-0001d4d0: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-0001d4e0: 7374 6963 7328 292e 7975 6c65 5f63 6f65  stics().yule_coe
-0001d4f0: 6628 783d 782c 2079 3d79 290a 2020 2020  f(x=x, y=y).    
-0001d500: 2020 2020 3e3e 3e20 320a 2020 2020 2020      >>> 2.      
-0001d510: 2020 3e3e 3e20 7261 6e64 6f6d 5f69 6e64    >>> random_ind
-0001d520: 6963 6573 203d 206e 702e 7261 6e64 6f6d  ices = np.random
-0001d530: 2e63 686f 6963 6528 6c65 6e28 7829 2c20  .choice(len(x), 
-0001d540: 7369 7a65 3d6c 656e 2878 292f 2f32 2c20  size=len(x)//2, 
-0001d550: 7265 706c 6163 653d 4661 6c73 6529 0a20  replace=False). 
-0001d560: 2020 2020 2020 203e 3e3e 2079 203d 206e         >>> y = n
-0001d570: 702e 636f 7079 2878 290a 2020 2020 2020  p.copy(x).      
-0001d580: 2020 3e3e 3e20 795b 7261 6e64 6f6d 5f69    >>> y[random_i
-0001d590: 6e64 6963 6573 5d20 3d20 3120 2d20 795b  ndices] = 1 - y[
-0001d5a0: 7261 6e64 6f6d 5f69 6e64 6963 6573 5d0a  random_indices].
-0001d5b0: 2020 2020 2020 2020 3e3e 3e20 5374 6174          >>> Stat
-0001d5c0: 6973 7469 6373 2829 2e79 756c 655f 636f  istics().yule_co
-0001d5d0: 6566 2878 3d78 2c20 793d 7929 0a20 2020  ef(x=x, y=y).   
-0001d5e0: 2020 2020 203e 3e3e 2030 2e39 390a 2020       >>> 0.99.  
-0001d5f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001d600: 2020 6966 2077 2069 7320 4e6f 6e65 3a0a    if w is None:.
-0001d610: 2020 2020 2020 2020 2020 2020 7720 3d20              w = 
-0001d620: 6e70 2e6f 6e65 7328 782e 7368 6170 655b  np.ones(x.shape[
-0001d630: 305d 292e 6173 7479 7065 286e 702e 666c  0]).astype(np.fl
-0001d640: 6f61 7433 3229 0a0a 2020 2020 2020 2020  oat32)..        
-0001d650: 665f 662c 2074 5f74 2c20 745f 662c 2066  f_f, t_t, t_f, f
-0001d660: 5f74 203d 2030 2e30 2c20 302e 302c 2030  _t = 0.0, 0.0, 0
-0001d670: 2e30 2c20 302e 300a 2020 2020 2020 2020  .0, 0.0.        
-0001d680: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
-0001d690: 782e 7368 6170 655b 305d 293a 0a20 2020  x.shape[0]):.   
-0001d6a0: 2020 2020 2020 2020 2069 6620 2878 5b69           if (x[i
-0001d6b0: 5d20 3d3d 2031 2920 616e 6420 2879 5b69  ] == 1) and (y[i
-0001d6c0: 5d20 3d3d 2031 293a 0a20 2020 2020 2020  ] == 1):.       
-0001d6d0: 2020 2020 2020 2020 2074 5f74 202b 3d20           t_t += 
-0001d6e0: 3120 2a20 775b 695d 0a20 2020 2020 2020  1 * w[i].       
-0001d6f0: 2020 2020 2069 6620 2878 5b69 5d20 3d3d       if (x[i] ==
-0001d700: 2030 2920 616e 6420 2879 5b69 5d20 3d3d   0) and (y[i] ==
-0001d710: 2030 293a 0a20 2020 2020 2020 2020 2020   0):.           
-0001d720: 2020 2020 2066 5f66 202b 3d20 3120 2a20       f_f += 1 * 
-0001d730: 775b 695d 0a20 2020 2020 2020 2020 2020  w[i].           
-0001d740: 2069 6620 2878 5b69 5d20 3d3d 2030 2920   if (x[i] == 0) 
-0001d750: 616e 6420 2879 5b69 5d20 3d3d 2031 293a  and (y[i] == 1):
-0001d760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d770: 2066 5f74 202b 3d20 3120 2a20 775b 695d   f_t += 1 * w[i]
-0001d780: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001d790: 2878 5b69 5d20 3d3d 2031 2920 616e 6420  (x[i] == 1) and 
-0001d7a0: 2879 5b69 5d20 3d3d 2030 293a 0a20 2020  (y[i] == 0):.   
-0001d7b0: 2020 2020 2020 2020 2020 2020 2074 5f66               t_f
-0001d7c0: 202b 3d20 3120 2a20 775b 695d 0a20 2020   += 1 * w[i].   
-0001d7d0: 2020 2020 2069 6620 745f 6620 3d3d 2030       if t_f == 0
-0001d7e0: 2e30 206f 7220 665f 7420 3d3d 2030 2e30  .0 or f_t == 0.0
-0001d7f0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001d800: 7475 726e 2030 2e30 0a20 2020 2020 2020  turn 0.0.       
-0001d810: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001d820: 2020 2072 6574 7572 6e20 2832 2e30 202a     return (2.0 *
-0001d830: 2074 5f66 202a 2066 5f74 2920 2f20 2874   t_f * f_t) / (t
-0001d840: 5f74 202a 2066 5f66 202b 2074 5f66 202a  _t * f_f + t_f *
-0001d850: 2066 5f74 290a 0a20 2020 2040 7374 6174   f_t)..    @stat
-0001d860: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-0001d870: 6974 280a 2020 2020 2020 2020 5b28 696e  it(.        [(in
-0001d880: 7438 5b3a 5d2c 2069 6e74 385b 3a5d 2c20  t8[:], int8[:], 
-0001d890: 7479 7065 732e 6d69 7363 2e4f 6d69 7474  types.misc.Omitt
-0001d8a0: 6564 284e 6f6e 6529 292c 2028 696e 7438  ed(None)), (int8
-0001d8b0: 5b3a 5d2c 2069 6e74 385b 3a5d 2c20 666c  [:], int8[:], fl
-0001d8c0: 6f61 7433 325b 3a5d 295d 0a20 2020 2029  oat32[:])].    )
-0001d8d0: 0a20 2020 2064 6566 2073 6f6b 616c 5f73  .    def sokal_s
-0001d8e0: 6e65 6174 6828 0a20 2020 2020 2020 2078  neath(.        x
-0001d8f0: 3a20 6e70 2e6e 6461 7272 6179 2c20 793a  : np.ndarray, y:
-0001d900: 206e 702e 6e64 6172 7261 792c 2077 3a20   np.ndarray, w: 
-0001d910: 4f70 7469 6f6e 616c 5b6e 702e 6e64 6172  Optional[np.ndar
-0001d920: 7261 795d 203d 204e 6f6e 650a 2020 2020  ray] = None.    
-0001d930: 2920 2d3e 2066 6c6f 6174 3634 3a0a 2020  ) -> float64:.  
-0001d940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001d950: 2020 4a69 7474 6564 2063 616c 6375 6c61    Jitted calcula
-0001d960: 7465 206f 6620 7468 6520 736f 6b61 6c20  te of the sokal 
-0001d970: 736e 6561 7468 2063 6f65 6666 6963 6965  sneath coefficie
-0001d980: 6e74 2062 6574 7765 656e 2074 776f 2062  nt between two b
-0001d990: 696e 6172 7920 7665 6374 6f72 7320 2865  inary vectors (e
-0001d9a0: 2e67 2e2c 2074 6f20 636c 6173 7369 6669  .g., to classifi
-0001d9b0: 6564 2062 6568 6176 696f 7273 292e 2030  ed behaviors). 0
-0001d9c0: 2072 6570 7265 7365 6e74 2069 6e64 6570   represent indep
-0001d9d0: 656e 6465 6e63 652c 2031 2072 6570 7265  endence, 1 repre
-0001d9e0: 7365 6e74 7320 636f 6d70 6c65 7465 2069  sents complete i
-0001d9f0: 6e74 6572 6465 7065 6e64 656e 6365 2e0a  nterdependence..
-0001da00: 0a20 2020 2020 2020 203a 7061 7261 6d65  .        :parame
-0001da10: 7465 7220 6e70 2e6e 6461 7272 6179 2078  ter np.ndarray x
-0001da20: 3a20 4669 7273 7420 6269 6e61 7279 2076  : First binary v
-0001da30: 6563 746f 722e 0a20 2020 2020 2020 203a  ector..        :
-0001da40: 7061 7261 6d65 7465 7220 6e70 2e6e 6461  parameter np.nda
-0001da50: 7272 6179 2078 3a20 5365 636f 6e64 2062  rray x: Second b
-0001da60: 696e 6172 7920 7665 6374 6f72 2e0a 2020  inary vector..  
-0001da70: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
-0001da80: 204f 7074 696f 6e61 6c5b 6e70 2e6e 6461   Optional[np.nda
-0001da90: 7272 6179 5d20 773a 204f 7074 696f 6e61  rray] w: Optiona
-0001daa0: 6c20 7765 6967 6874 7320 666f 7220 6561  l weights for ea
-0001dab0: 6368 2065 6c65 6d65 6e74 2e20 4361 6e20  ch element. Can 
-0001dac0: 6265 2063 6c61 7373 6966 6963 6174 696f  be classificatio
-0001dad0: 6e20 7072 6f62 6162 696c 6974 6965 732e  n probabilities.
-0001dae0: 2049 6620 6e6f 7420 7072 6f76 6964 6564   If not provided
-0001daf0: 2c20 6571 7561 6c20 7765 6967 6874 7320  , equal weights 
-0001db00: 6172 6520 6173 7375 6d65 642e 0a0a 2020  are assumed...  
-0001db10: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
-0001db20: 2020 2020 2020 2020 2020 2041 6461 7074             Adapt
-0001db30: 6564 2066 726f 6d20 6070 796e 6e64 6573  ed from `pynndes
-0001db40: 6365 6e74 203c 6874 7470 733a 2f2f 7079  cent <https://py
-0001db50: 6e6e 6465 7363 656e 742e 7265 6164 7468  nndescent.readth
-0001db60: 6564 6f63 732e 696f 2f65 6e2f 6c61 7465  edocs.io/en/late
-0001db70: 7374 2f3e 605f 2e0a 0a20 2020 2020 2020  st/>`_...       
-0001db80: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
-0001db90: 2020 203e 3e3e 2078 203d 206e 702e 6172     >>> x = np.ar
-0001dba0: 7261 7928 5b30 2c20 312c 2030 2c20 302c  ray([0, 1, 0, 0,
-0001dbb0: 2031 5d29 2e61 7374 7970 6528 6e70 2e69   1]).astype(np.i
-0001dbc0: 6e74 3829 0a20 2020 2020 2020 203e 3e3e  nt8).        >>>
-0001dbd0: 2079 203d 206e 702e 6172 7261 7928 5b31   y = np.array([1
-0001dbe0: 2c20 302c 2031 2c20 312c 2030 5d29 2e61  , 0, 1, 1, 0]).a
-0001dbf0: 7374 7970 6528 6e70 2e69 6e74 3829 0a20  stype(np.int8). 
-0001dc00: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-0001dc10: 7374 6963 7328 292e 736f 6b61 6c5f 736e  stics().sokal_sn
-0001dc20: 6561 7468 2878 2c20 7929 0a20 2020 2020  eath(x, y).     
-0001dc30: 2020 203e 3e3e 2030 2e30 0a20 2020 2020     >>> 0.0.     
-0001dc40: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0001dc50: 6620 7720 6973 204e 6f6e 653a 0a20 2020  f w is None:.   
-0001dc60: 2020 2020 2020 2020 2077 203d 206e 702e           w = np.
-0001dc70: 6f6e 6573 2878 2e73 6861 7065 5b30 5d29  ones(x.shape[0])
-0001dc80: 2e61 7374 7970 6528 666c 6f61 7433 3229  .astype(float32)
-0001dc90: 0a20 2020 2020 2020 2074 5f63 6e74 2c20  .        t_cnt, 
-0001dca0: 665f 636e 742c 2074 5f66 2c20 665f 7420  f_cnt, t_f, f_t 
-0001dcb0: 3d20 302e 302c 2030 2e30 2c20 302e 302c  = 0.0, 0.0, 0.0,
-0001dcc0: 2030 2e30 0a20 2020 2020 2020 2066 6f72   0.0.        for
-0001dcd0: 2069 2069 6e20 7072 616e 6765 2878 2e73   i in prange(x.s
-0001dce0: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
-0001dcf0: 2020 2020 2020 6966 2028 785b 695d 203d        if (x[i] =
-0001dd00: 3d20 3129 2061 6e64 2028 795b 695d 203d  = 1) and (y[i] =
-0001dd10: 3d20 3129 3a0a 2020 2020 2020 2020 2020  = 1):.          
-0001dd20: 2020 2020 2020 745f 636e 7420 2b3d 2031        t_cnt += 1
-0001dd30: 2e30 202a 2077 5b69 5d0a 2020 2020 2020  .0 * w[i].      
-0001dd40: 2020 2020 2020 656c 6966 2028 785b 695d        elif (x[i]
-0001dd50: 203d 3d20 3029 2061 6e64 2028 795b 695d   == 0) and (y[i]
-0001dd60: 203d 3d20 3029 3a0a 2020 2020 2020 2020   == 0):.        
-0001dd70: 2020 2020 2020 2020 665f 636e 7420 2b3d          f_cnt +=
-0001dd80: 2031 2e30 202a 2077 5b69 5d0a 2020 2020   1.0 * w[i].    
-0001dd90: 2020 2020 2020 2020 656c 6966 2028 785b          elif (x[
-0001dda0: 695d 203d 3d20 3029 2061 6e64 2028 795b  i] == 0) and (y[
-0001ddb0: 695d 203d 3d20 3129 3a0a 2020 2020 2020  i] == 1):.      
-0001ddc0: 2020 2020 2020 2020 2020 665f 7420 2b3d            f_t +=
-0001ddd0: 2031 2e30 202a 2077 5b69 5d0a 2020 2020   1.0 * w[i].    
-0001dde0: 2020 2020 2020 2020 656c 6966 2028 785b          elif (x[
-0001ddf0: 695d 203d 3d20 3129 2061 6e64 2028 795b  i] == 1) and (y[
-0001de00: 695d 203d 3d20 3029 3a0a 2020 2020 2020  i] == 0):.      
-0001de10: 2020 2020 2020 2020 2020 745f 6620 2b3d            t_f +=
-0001de20: 2031 2e30 202a 2077 5b69 5d0a 0a20 2020   1.0 * w[i]..   
-0001de30: 2020 2020 2069 6620 745f 6620 2b20 665f       if t_f + f_
-0001de40: 7420 3d3d 2030 2e30 3a0a 2020 2020 2020  t == 0.0:.      
-0001de50: 2020 2020 2020 7265 7475 726e 2030 2e30        return 0.0
-0001de60: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001de70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001de80: 6e20 2866 5f74 202b 2074 5f66 2920 2f20  n (f_t + t_f) / 
-0001de90: 2832 202a 2028 745f 636e 7420 2b20 665f  (2 * (t_cnt + f_
-0001dea0: 636e 7429 202b 2066 5f74 202b 2074 5f66  cnt) + f_t + t_f
-0001deb0: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
-0001dec0: 7468 6f64 0a20 2020 2040 6e6a 6974 285b  thod.    @njit([
-0001ded0: 2866 6c6f 6174 3332 5b3a 2c20 3a5d 2c20  (float32[:, :], 
-0001dee0: 666c 6f61 7433 325b 3a2c 203a 5d29 2c20  float32[:, :]), 
-0001def0: 2866 6c6f 6174 3332 5b3a 2c20 3a5d 2c20  (float32[:, :], 
-0001df00: 7479 7065 732e 6d69 7363 2e4f 6d69 7474  types.misc.Omitt
-0001df10: 6564 284e 6f6e 6529 295d 290a 2020 2020  ed(None))]).    
-0001df20: 6465 6620 6272 6179 5f63 7572 7469 735f  def bray_curtis_
-0001df30: 6469 7373 696d 696c 6172 6974 7928 0a20  dissimilarity(. 
-0001df40: 2020 2020 2020 2078 3a20 6e70 2e6e 6461         x: np.nda
-0001df50: 7272 6179 2c20 773a 204f 7074 696f 6e61  rray, w: Optiona
-0001df60: 6c5b 6e70 2e6e 6461 7272 6179 5d20 3d20  l[np.ndarray] = 
-0001df70: 4e6f 6e65 0a20 2020 2029 202d 3e20 6e70  None.    ) -> np
-0001df80: 2e6e 6461 7272 6179 3a0a 2020 2020 2020  .ndarray:.      
-0001df90: 2020 2222 220a 2020 2020 2020 2020 4a69    """.        Ji
-0001dfa0: 7474 6564 2063 616c 6375 6c61 7465 206f  tted calculate o
-0001dfb0: 6620 7468 6520 4272 6179 2d43 7572 7469  f the Bray-Curti
-0001dfc0: 7320 6469 7373 696d 696c 6172 6974 7920  s dissimilarity 
-0001dfd0: 6d61 7472 6978 2062 6574 7765 656e 2073  matrix between s
-0001dfe0: 616d 706c 6573 2062 6173 6564 206f 6e20  amples based on 
-0001dff0: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
-0001e000: 0a20 2020 2020 2020 2055 7365 6675 6c20  .        Useful 
-0001e010: 666f 7220 6669 6e64 696e 6720 7369 6d69  for finding simi
-0001e020: 6c61 7220 6672 616d 6573 2062 6173 6564  lar frames based
-0001e030: 206f 6e20 6265 6861 7669 6f72 2e0a 0a20   on behavior... 
-0001e040: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-0001e050: 0a20 2020 2020 2020 2020 2020 4164 6170  .           Adap
-0001e060: 7465 6420 6672 6f6d 2060 7079 6e6e 6465  ted from `pynnde
-0001e070: 7363 656e 7420 3c68 7474 7073 3a2f 2f70  scent <https://p
-0001e080: 796e 6e64 6573 6365 6e74 2e72 6561 6474  ynndescent.readt
-0001e090: 6865 646f 6373 2e69 6f2f 656e 2f6c 6174  hedocs.io/en/lat
-0001e0a0: 6573 742f 3e60 5f2e 0a0a 2020 2020 2020  est/>`_...      
-0001e0b0: 2020 3a70 6172 616d 6574 6572 206e 702e    :parameter np.
-0001e0c0: 6e64 6172 7261 7920 783a 2032 6420 6172  ndarray x: 2d ar
-0001e0d0: 7261 7920 7769 7468 206c 696b 656c 7920  ray with likely 
-0001e0e0: 6e6f 726d 616c 697a 6564 2066 6561 7475  normalized featu
-0001e0f0: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
-0001e100: 2020 203a 7061 7261 6d65 7465 7220 4f70     :parameter Op
-0001e110: 7469 6f6e 616c 5b6e 702e 6e64 6172 7261  tional[np.ndarra
-0001e120: 795d 2077 3a20 4f70 7469 6f6e 616c 2032  y] w: Optional 2
-0001e130: 6420 6172 7261 7920 7769 7468 2077 6569  d array with wei
-0001e140: 6768 7473 206f 6620 7361 6d65 2073 697a  ghts of same siz
-0001e150: 6520 6173 2078 2e20 4465 6661 756c 7420  e as x. Default 
-0001e160: 4e6f 6e65 2061 6e64 2061 6c6c 206f 6273  None and all obs
-0001e170: 6572 7661 7469 6f6e 7320 7769 6c6c 2068  ervations will h
-0001e180: 6176 6520 7468 6520 7361 6d65 2077 6569  ave the same wei
-0001e190: 6768 742e 0a20 2020 2020 2020 203a 7265  ght..        :re
-0001e1a0: 7475 726e 7320 6e70 2e6e 6461 7272 6179  turns np.ndarray
-0001e1b0: 3a20 3264 2061 7272 6179 2077 6974 6820  : 2d array with 
-0001e1c0: 7361 6d65 2073 697a 6520 6173 2078 2072  same size as x r
-0001e1d0: 6570 7265 7365 6e74 696e 6720 6469 7373  epresenting diss
-0001e1e0: 696d 696c 6172 6974 7920 7661 6c75 6573  imilarity values
-0001e1f0: 2e20 3020 616e 6420 7468 6520 6f62 7365  . 0 and the obse
-0001e200: 7276 6174 696f 6e73 2061 7265 2069 6465  rvations are ide
-0001e210: 6e74 6963 616c 2061 6e64 2061 7420 3120  ntical and at 1 
-0001e220: 7468 6520 6f62 7365 7276 6174 696f 6e73  the observations
-0001e230: 2061 7265 2063 6f6d 706c 6574 6c79 2064   are completly d
-0001e240: 6973 696d 696c 6172 2e0a 0a20 2020 2020  isimilar...     
-0001e250: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
-0001e260: 2020 2020 203e 3e3e 2078 203d 206e 702e       >>> x = np.
-0001e270: 6172 7261 7928 5b5b 312c 2031 2c20 312c  array([[1, 1, 1,
-0001e280: 2031 2c20 315d 2c20 5b30 2c20 302c 2030   1, 1], [0, 0, 0
-0001e290: 2c20 302c 2030 5d2c 205b 302c 2030 2c20  , 0, 0], [0, 0, 
-0001e2a0: 302c 2030 2c20 305d 2c20 5b31 2c20 312c  0, 0, 0], [1, 1,
-0001e2b0: 2031 2c20 312c 2031 5d5d 292e 6173 7479   1, 1, 1]]).asty
-0001e2c0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-0001e2d0: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-0001e2e0: 7374 6963 7328 292e 6272 6179 5f63 7572  stics().bray_cur
-0001e2f0: 7469 735f 6469 7373 696d 696c 6172 6974  tis_dissimilarit
-0001e300: 7928 783d 7829 0a20 2020 2020 2020 203e  y(x=x).        >
-0001e310: 3e3e 205b 5b30 2c20 312e 2c20 312e 2c20  >> [[0, 1., 1., 
-0001e320: 302e 5d2c 205b 312e 2c20 302e 2c20 302e  0.], [1., 0., 0.
-0001e330: 2c20 312e 5d2c 205b 312e 2c20 302e 2c20  , 1.], [1., 0., 
-0001e340: 302e 2c20 312e 5d2c 205b 302e 2c20 312e  0., 1.], [0., 1.
-0001e350: 2c20 312e 2c20 302e 5d5d 0a20 2020 2020  , 1., 0.]].     
-0001e360: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0001e370: 6620 7720 6973 204e 6f6e 653a 0a20 2020  f w is None:.   
-0001e380: 2020 2020 2020 2020 2077 203d 206e 702e           w = np.
-0001e390: 6f6e 6573 2828 782e 7368 6170 655b 305d  ones((x.shape[0]
-0001e3a0: 2c20 782e 7368 6170 655b 305d 2929 2e61  , x.shape[0])).a
-0001e3b0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-0001e3c0: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
-0001e3d0: 7320 3d20 6e70 2e66 756c 6c28 2878 2e73  s = np.full((x.s
-0001e3e0: 6861 7065 5b30 5d2c 2078 2e73 6861 7065  hape[0], x.shape
-0001e3f0: 5b30 5d29 2c20 302e 3029 0a20 2020 2020  [0]), 0.0).     
-0001e400: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
-0001e410: 6765 2878 2e73 6861 7065 5b30 5d29 3a0a  ge(x.shape[0]):.
-0001e420: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001e430: 6a20 696e 2072 616e 6765 2869 202b 2031  j in range(i + 1
-0001e440: 2c20 782e 7368 6170 655b 305d 293a 0a20  , x.shape[0]):. 
-0001e450: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001e460: 312c 2073 322c 206e 756d 2c20 6465 6e20  1, s2, num, den 
-0001e470: 3d20 785b 695d 2c20 785b 6a5d 2c20 302e  = x[i], x[j], 0.
-0001e480: 302c 2030 2e30 0a20 2020 2020 2020 2020  0, 0.0.         
-0001e490: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
-0001e4a0: 7261 6e67 6528 7331 2e73 6861 7065 5b30  range(s1.shape[0
-0001e4b0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-0001e4c0: 2020 2020 2020 2020 6e75 6d20 2b3d 206e          num += n
-0001e4d0: 702e 6162 7328 7331 5b6b 5d20 2d20 7332  p.abs(s1[k] - s2
-0001e4e0: 5b6b 5d29 0a20 2020 2020 2020 2020 2020  [k]).           
-0001e4f0: 2020 2020 2020 2020 2064 656e 202b 3d20           den += 
-0001e500: 6e70 2e61 6273 2873 315b 6b5d 202b 2073  np.abs(s1[k] + s
-0001e510: 325b 6b5d 290a 2020 2020 2020 2020 2020  2[k]).          
-0001e520: 2020 2020 2020 6966 2064 656e 203d 3d20        if den == 
-0001e530: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
-0001e540: 2020 2020 2020 2020 2076 616c 203d 2030           val = 0
-0001e550: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-0001e560: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001e570: 2020 2020 2020 2020 2020 2020 2076 616c               val
-0001e580: 203d 2028 666c 6f61 7428 6e75 6d29 202f   = (float(num) /
-0001e590: 2064 656e 2920 2a20 775b 692c 206a 5d0a   den) * w[i, j].
-0001e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e5b0: 7265 7375 6c74 735b 692c 206a 5d20 3d20  results[i, j] = 
-0001e5c0: 7661 6c0a 2020 2020 2020 2020 2020 2020  val.            
-0001e5d0: 2020 2020 7265 7375 6c74 735b 6a2c 2069      results[j, i
-0001e5e0: 5d20 3d20 7661 6c0a 2020 2020 2020 2020  ] = val.        
-0001e5f0: 7265 7475 726e 2072 6573 756c 7473 2e61  return results.a
-0001e600: 7374 7970 6528 666c 6f61 7433 3229 0a0a  stype(float32)..
-0001e610: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0001e620: 640a 2020 2020 406e 6a69 7428 2866 6c6f  d.    @njit((flo
-0001e630: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3332  at32[:], float32
-0001e640: 5b3a 5d29 290a 2020 2020 6465 6620 5f68  [:])).    def _h
-0001e650: 656c 6c69 6e67 6572 5f68 656c 7065 7228  ellinger_helper(
-0001e660: 783a 206e 702e 6e64 6172 7261 792c 2079  x: np.ndarray, y
-0001e670: 3a20 6e70 2e6e 6461 7272 6179 293a 0a20  : np.ndarray):. 
-0001e680: 2020 2020 2020 2022 2222 4a69 7474 6564         """Jitted
-0001e690: 2068 656c 7065 7220 666f 7220 636f 6d70   helper for comp
-0001e6a0: 7574 696e 6720 4865 6c6c 696e 6765 7220  uting Hellinger 
-0001e6b0: 6469 7374 616e 6365 7320 6672 6f6d 2060  distances from `
-0001e6c0: 6068 656c 6c69 6e67 6572 5f64 6973 7461  `hellinger_dista
-0001e6d0: 6e63 6560 6022 2222 0a20 2020 2020 2020  nce``""".       
-0001e6e0: 2072 6573 756c 742c 206e 6f72 6d5f 782c   result, norm_x,
-0001e6f0: 206e 6f72 6d5f 7920 3d20 302e 302c 2030   norm_y = 0.0, 0
-0001e700: 2e30 2c20 302e 300a 2020 2020 2020 2020  .0, 0.0.        
-0001e710: 666f 7220 6920 696e 2072 616e 6765 2878  for i in range(x
-0001e720: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
-0001e730: 2020 2020 2020 2020 7265 7375 6c74 202b          result +
-0001e740: 3d20 6e70 2e73 7172 7428 785b 695d 202a  = np.sqrt(x[i] *
-0001e750: 2079 5b69 5d29 0a20 2020 2020 2020 2020   y[i]).         
-0001e760: 2020 206e 6f72 6d5f 7820 2b3d 2078 5b69     norm_x += x[i
-0001e770: 5d0a 2020 2020 2020 2020 2020 2020 6e6f  ].            no
-0001e780: 726d 5f79 202b 3d20 795b 695d 0a20 2020  rm_y += y[i].   
-0001e790: 2020 2020 2069 6620 6e6f 726d 5f78 203d       if norm_x =
-0001e7a0: 3d20 3020 616e 6420 6e6f 726d 5f79 203d  = 0 and norm_y =
-0001e7b0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0001e7c0: 2072 6574 7572 6e20 302e 300a 2020 2020   return 0.0.    
-0001e7d0: 2020 2020 656c 6966 206e 6f72 6d5f 7820      elif norm_x 
-0001e7e0: 3d3d 2030 206f 7220 6e6f 726d 5f79 203d  == 0 or norm_y =
-0001e7f0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0001e800: 2072 6574 7572 6e20 312e 300a 2020 2020   return 1.0.    
-0001e810: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001e820: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
-0001e830: 7371 7274 2831 202d 2072 6573 756c 7420  sqrt(1 - result 
-0001e840: 2f20 6e70 2e73 7172 7428 6e6f 726d 5f78  / np.sqrt(norm_x
-0001e850: 202a 206e 6f72 6d5f 7929 290a 0a20 2020   * norm_y))..   
-0001e860: 2064 6566 2068 656c 6c69 6e67 6572 5f64   def hellinger_d
-0001e870: 6973 7461 6e63 6528 0a20 2020 2020 2020  istance(.       
-0001e880: 2073 656c 662c 0a20 2020 2020 2020 2078   self,.        x
-0001e890: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
-0001e8a0: 2020 2020 2020 793a 206e 702e 6e64 6172        y: np.ndar
-0001e8b0: 7261 792c 0a20 2020 2020 2020 2062 7563  ray,.        buc
-0001e8c0: 6b65 745f 6d65 7468 6f64 3a20 4f70 7469  ket_method: Opti
-0001e8d0: 6f6e 616c 5b0a 2020 2020 2020 2020 2020  onal[.          
-0001e8e0: 2020 4c69 7465 7261 6c5b 2266 6422 2c20    Literal["fd", 
-0001e8f0: 2264 6f61 6e65 222c 2022 6175 746f 222c  "doane", "auto",
-0001e900: 2022 7363 6f74 7422 2c20 2273 746f 6e65   "scott", "stone
-0001e910: 222c 2022 7269 6365 222c 2022 7374 7572  ", "rice", "stur
-0001e920: 6765 7322 2c20 2273 7172 7422 5d0a 2020  ges", "sqrt"].  
-0001e930: 2020 2020 2020 5d20 3d20 2261 7574 6f22        ] = "auto"
-0001e940: 2c0a 2020 2020 2920 2d3e 2066 6c6f 6174  ,.    ) -> float
-0001e950: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001e960: 2020 2020 2020 436f 6d70 7574 6520 7468        Compute th
-0001e970: 6520 4865 6c6c 696e 6765 7220 6469 7374  e Hellinger dist
-0001e980: 616e 6365 2062 6574 7765 656e 2074 776f  ance between two
-0001e990: 2076 6563 746f 7220 6469 7374 7269 6269   vector distribi
-0001e9a0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-0001e9b0: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
-0001e9c0: 2020 2020 2054 6865 2048 656c 6c69 6e67       The Helling
-0001e9d0: 6572 2064 6973 7461 6e63 6520 6973 2062  er distance is b
-0001e9e0: 6f75 6e64 6564 2061 6e64 2072 616e 6765  ounded and range
-0001e9f0: 7320 6672 6f6d 2030 2074 6f20 e288 9a32  s from 0 to ...2
-0001ea00: 2e20 4469 7374 616e 6365 206f 6620 e288  . Distance of ..
-0001ea10: 9a32 2069 6e64 6963 6174 6573 2074 6861  .2 indicates tha
-0001ea20: 7420 7468 6520 7477 6f20 6469 7374 7269  t the two distri
-0001ea30: 6275 7469 6f6e 7320 6172 6520 6d61 7869  butions are maxi
-0001ea40: 6d61 6c6c 7920 6469 7373 696d 696c 6172  mally dissimilar
-0001ea50: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001ea60: 206e 702e 6e64 6172 7261 7920 783a 2046   np.ndarray x: F
-0001ea70: 6972 7374 2031 4420 6172 7261 7920 7265  irst 1D array re
-0001ea80: 7072 6573 656e 7469 6e67 2061 2070 726f  presenting a pro
-0001ea90: 6261 6269 6c69 7479 2064 6973 7472 6962  bability distrib
-0001eaa0: 7574 696f 6e2e 0a20 2020 2020 2020 203a  ution..        :
-0001eab0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-0001eac0: 2079 3a20 5365 636f 6e64 2031 4420 6172   y: Second 1D ar
-0001ead0: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
-0001eae0: 2061 2070 726f 6261 6269 6c69 7479 2064   a probability d
-0001eaf0: 6973 7472 6962 7574 696f 6e2e 0a20 2020  istribution..   
-0001eb00: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
-0001eb10: 6f6e 616c 5b4c 6974 6572 616c 5b27 6664  onal[Literal['fd
-0001eb20: 272c 2027 646f 616e 6527 2c20 2761 7574  ', 'doane', 'aut
-0001eb30: 6f27 2c20 2773 636f 7474 272c 2027 7374  o', 'scott', 'st
-0001eb40: 6f6e 6527 2c20 2772 6963 6527 2c20 2773  one', 'rice', 's
-0001eb50: 7475 7267 6573 272c 2027 7371 7274 275d  turges', 'sqrt']
-0001eb60: 5d20 6275 636b 6574 5f6d 6574 686f 643a  ] bucket_method:
-0001eb70: 204d 6574 686f 6420 666f 7220 636f 6d70   Method for comp
-0001eb80: 7574 696e 6720 6869 7374 6f67 7261 6d20  uting histogram 
-0001eb90: 6269 6e73 2e20 4465 6661 756c 7420 6973  bins. Default is
-0001eba0: 2027 6175 746f 272e 0a20 2020 2020 2020   'auto'..       
-0001ebb0: 203a 7265 7475 726e 7320 666c 6f61 743a   :returns float:
-0001ebc0: 2048 656c 6c69 6e67 6572 2064 6973 7461   Hellinger dista
-0001ebd0: 6e63 6520 6265 7477 6565 6e20 7468 6520  nce between the 
-0001ebe0: 7477 6f20 696e 7075 7420 7072 6f62 6162  two input probab
-0001ebf0: 696c 6974 7920 6469 7374 7269 6275 7469  ility distributi
-0001ec00: 6f6e 732e 0a0a 2020 2020 2020 2020 3a65  ons...        :e
-0001ec10: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-0001ec20: 3e3e 3e20 7820 3d20 6e70 2e72 616e 646f  >>> x = np.rando
-0001ec30: 6d2e 7261 6e64 696e 7428 302c 2039 3030  m.randint(0, 900
-0001ec40: 302c 2028 3530 3030 3030 2c29 290a 2020  0, (500000,)).  
-0001ec50: 2020 2020 2020 3e3e 3e20 7920 3d20 6e70        >>> y = np
-0001ec60: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
-0001ec70: 302c 2039 3030 302c 2028 3530 3030 3030  0, 9000, (500000
-0001ec80: 2c29 290a 2020 2020 2020 2020 3e3e 3e20  ,)).        >>> 
-0001ec90: 5374 6174 6973 7469 6373 2829 2e68 656c  Statistics().hel
-0001eca0: 6c69 6e67 6572 5f64 6973 7461 6e63 6528  linger_distance(
-0001ecb0: 783d 782c 2079 3d79 2c20 6275 636b 6574  x=x, y=y, bucket
-0001ecc0: 5f6d 6574 686f 643d 2761 7574 6f27 290a  _method='auto').
-0001ecd0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-0001ece0: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
-0001ecf0: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-0001ed00: 2020 2020 6461 7461 3d78 2c0a 2020 2020      data=x,.    
-0001ed10: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
-0001ed20: 7461 7469 7374 6963 732e 6865 6c6c 696e  tatistics.hellin
-0001ed30: 6765 725f 6469 7374 616e 6365 2e5f 5f6e  ger_distance.__n
-0001ed40: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-0001ed50: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
-0001ed60: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
-0001ed70: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
-0001ed80: 7065 733d 280a 2020 2020 2020 2020 2020  pes=(.          
-0001ed90: 2020 2020 2020 6e70 2e69 6e74 3634 2c0a        np.int64,.
-0001eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001edb0: 6e70 2e69 6e74 3332 2c0a 2020 2020 2020  np.int32,.      
-0001edc0: 2020 2020 2020 2020 2020 6e70 2e69 6e74            np.int
-0001edd0: 382c 0a20 2020 2020 2020 2020 2020 2020  8,.             
-0001ede0: 2020 206e 702e 666c 6f61 7433 322c 0a20     np.float32,. 
-0001edf0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001ee00: 702e 666c 6f61 7436 342c 0a20 2020 2020  p.float64,.     
-0001ee10: 2020 2020 2020 2020 2020 2069 6e74 2c0a             int,.
-0001ee20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee30: 666c 6f61 742c 0a20 2020 2020 2020 2020  float,.         
-0001ee40: 2020 2029 2c0a 2020 2020 2020 2020 290a     ),.        ).
-0001ee50: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
-0001ee60: 6c69 645f 6172 7261 7928 0a20 2020 2020  lid_array(.     
-0001ee70: 2020 2020 2020 2064 6174 613d 792c 0a20         data=y,. 
-0001ee80: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-0001ee90: 653d 5374 6174 6973 7469 6373 2e68 656c  e=Statistics.hel
-0001eea0: 6c69 6e67 6572 5f64 6973 7461 6e63 652e  linger_distance.
-0001eeb0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-0001eec0: 2020 2020 2020 6163 6365 7074 6564 5f6e        accepted_n
-0001eed0: 6469 6d73 3d28 312c 292c 0a20 2020 2020  dims=(1,),.     
-0001eee0: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
-0001eef0: 6474 7970 6573 3d28 0a20 2020 2020 2020  dtypes=(.       
-0001ef00: 2020 2020 2020 2020 206e 702e 696e 7436           np.int6
-0001ef10: 342c 0a20 2020 2020 2020 2020 2020 2020  4,.             
-0001ef20: 2020 206e 702e 696e 7433 322c 0a20 2020     np.int32,.   
-0001ef30: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-0001ef40: 696e 7438 2c0a 2020 2020 2020 2020 2020  int8,.          
-0001ef50: 2020 2020 2020 6e70 2e66 6c6f 6174 3332        np.float32
-0001ef60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ef70: 2020 6e70 2e66 6c6f 6174 3634 2c0a 2020    np.float64,.  
-0001ef80: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001ef90: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0001efa0: 2020 2066 6c6f 6174 2c0a 2020 2020 2020     float,.      
-0001efb0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0001efc0: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
-0001efd0: 5f73 7472 280a 2020 2020 2020 2020 2020  _str(.          
-0001efe0: 2020 6e61 6d65 3d66 227b 5374 6174 6973    name=f"{Statis
-0001eff0: 7469 6373 2e68 656c 6c69 6e67 6572 5f64  tics.hellinger_d
-0001f000: 6973 7461 6e63 652e 5f5f 6e61 6d65 5f5f  istance.__name__
-0001f010: 7d20 6d65 7468 6f64 222c 0a20 2020 2020  } method",.     
-0001f020: 2020 2020 2020 2076 616c 7565 3d62 7563         value=buc
-0001f030: 6b65 745f 6d65 7468 6f64 2c0a 2020 2020  ket_method,.    
-0001f040: 2020 2020 2020 2020 6f70 7469 6f6e 733d          options=
-0001f050: 4f70 7469 6f6e 732e 4255 434b 4554 5f4d  Options.BUCKET_M
-0001f060: 4554 484f 4453 2e76 616c 7565 2c0a 2020  ETHODS.value,.  
-0001f070: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001f080: 6269 6e5f 7769 6474 682c 2062 696e 5f63  bin_width, bin_c
-0001f090: 6f75 6e74 203d 2062 7563 6b65 745f 6461  ount = bucket_da
-0001f0a0: 7461 2864 6174 613d 782c 206d 6574 686f  ta(data=x, metho
-0001f0b0: 643d 6275 636b 6574 5f6d 6574 686f 6429  d=bucket_method)
-0001f0c0: 0a20 2020 2020 2020 2073 315f 6820 3d20  .        s1_h = 
-0001f0d0: 7365 6c66 2e5f 6869 7374 5f31 6428 0a20  self._hist_1d(. 
-0001f0e0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-0001f0f0: 782c 2062 696e 5f63 6f75 6e74 3d62 696e  x, bin_count=bin
-0001f100: 5f63 6f75 6e74 2c20 7261 6e67 653d 6e70  _count, range=np
-0001f110: 2e61 7272 6179 285b 302c 2069 6e74 2862  .array([0, int(b
-0001f120: 696e 5f77 6964 7468 202a 2062 696e 5f63  in_width * bin_c
-0001f130: 6f75 6e74 295d 290a 2020 2020 2020 2020  ount)]).        
-0001f140: 290a 2020 2020 2020 2020 7332 5f68 203d  ).        s2_h =
-0001f150: 2073 656c 662e 5f68 6973 745f 3164 280a   self._hist_1d(.
-0001f160: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0001f170: 3d79 2c20 6269 6e5f 636f 756e 743d 6269  =y, bin_count=bi
-0001f180: 6e5f 636f 756e 742c 2072 616e 6765 3d6e  n_count, range=n
-0001f190: 702e 6172 7261 7928 5b30 2c20 696e 7428  p.array([0, int(
-0001f1a0: 6269 6e5f 7769 6474 6820 2a20 6269 6e5f  bin_width * bin_
-0001f1b0: 636f 756e 7429 5d29 0a20 2020 2020 2020  count)]).       
-0001f1c0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-0001f1d0: 6e20 7365 6c66 2e5f 6865 6c6c 696e 6765  n self._hellinge
-0001f1e0: 725f 6865 6c70 6572 280a 2020 2020 2020  r_helper(.      
-0001f1f0: 2020 2020 2020 783d 7331 5f68 2e61 7374        x=s1_h.ast
-0001f200: 7970 6528 6e70 2e66 6c6f 6174 3332 292c  ype(np.float32),
-0001f210: 2079 3d73 325f 682e 6173 7479 7065 286e   y=s2_h.astype(n
-0001f220: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
-0001f230: 2020 2029 0a0a 2020 2020 4073 7461 7469     )..    @stati
-0001f240: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
-0001f250: 7428 2228 696e 7436 345b 3a5d 2c69 6e74  t("(int64[:],int
-0001f260: 3634 5b3a 5d29 2229 0a20 2020 2064 6566  64[:])").    def
-0001f270: 2063 6f68 656e 735f 6b61 7070 6128 7361   cohens_kappa(sa
-0001f280: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
-0001f290: 6179 2c20 7361 6d70 6c65 5f32 3a20 6e70  ay, sample_2: np
-0001f2a0: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
-0001f2b0: 2020 2022 2222 0a20 2020 2020 2020 204a     """.        J
-0001f2c0: 6974 7465 6420 636f 6d70 7574 6520 436f  itted compute Co
-0001f2d0: 6865 6e27 7320 4b61 7070 6120 636f 6566  hen's Kappa coef
-0001f2e0: 6669 6369 656e 7420 666f 7220 7477 6f20  ficient for two 
-0001f2f0: 6269 6e61 7279 2073 616d 706c 6573 2e0a  binary samples..
-0001f300: 0a20 2020 2020 2020 2043 6f68 656e 2773  .        Cohen's
-0001f310: 204b 6170 7061 2063 6f65 6666 6963 6965   Kappa coefficie
-0001f320: 6e74 2062 6574 7765 656e 2063 6c61 7373  nt between class
-0001f330: 6966 6963 6174 696f 6e73 2061 6e64 2067  ifications and g
-0001f340: 726f 756e 6420 7472 7574 6820 7461 6b69  round truth taki
-0001f350: 6e67 2069 6e74 6f20 6163 636f 756e 7420  ng into account 
-0001f360: 6167 7265 656d 656e 7420 6265 7477 6565  agreement betwee
-0001f370: 6e20 636c 6173 7369 6669 6361 7469 6f6e  n classification
-0001f380: 7320 616e 6420 6772 6f75 6e64 2074 7275  s and ground tru
-0001f390: 7468 206f 6363 7572 7269 6e67 2062 7920  th occurring by 
-0001f3a0: 6368 616e 6365 2e0a 2020 2020 2020 2020  chance..        
-0001f3b0: 496e 7465 7270 7265 7461 7469 6f6e 3a20  Interpretation: 
-0001f3c0: 3e30 2e38 0941 6c6d 6f73 7420 5065 7266  >0.8.Almost Perf
-0001f3d0: 6563 742c 203e 302e 3609 5375 6273 7461  ect, >0.6.Substa
-0001f3e0: 6e74 6961 6c2c 2020 3e30 2e34 094d 6f64  ntial,  >0.4.Mod
-0001f3f0: 6572 6174 6520 3e30 2e32 0946 6169 722c  erate >0.2.Fair,
-0001f400: 2030 2d30 2c32 0953 6c69 6768 742c 203c   0-0,2.Slight, <
-0001f410: 3009 506f 6f72 2028 204c 616e 6469 7320  0.Poor ( Landis 
-0001f420: 2620 4b6f 6368 2028 3139 3737 2929 2e0a  & Koch (1977))..
-0001f430: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
-0001f440: 653a 0a20 2020 2020 2020 203e 3e3e 2073  e:.        >>> s
-0001f450: 616d 706c 655f 3120 3d20 6e70 2e72 616e  ample_1 = np.ran
-0001f460: 646f 6d2e 7261 6e64 696e 7428 302c 2032  dom.randint(0, 2
-0001f470: 2c20 7369 7a65 3d28 3130 3030 302c 2929  , size=(10000,))
-0001f480: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
-0001f490: 706c 655f 3220 3d20 6e70 2e72 616e 646f  ple_2 = np.rando
-0001f4a0: 6d2e 7261 6e64 696e 7428 302c 2032 2c20  m.randint(0, 2, 
-0001f4b0: 7369 7a65 3d28 3130 3030 302c 2929 0a20  size=(10000,)). 
-0001f4c0: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-0001f4d0: 7374 6963 732e 636f 6865 6e73 5f6b 6170  stics.cohens_kap
-0001f4e0: 7061 2873 616d 706c 655f 313d 7361 6d70  pa(sample_1=samp
-0001f4f0: 6c65 5f31 2c20 7361 6d70 6c65 5f32 3d73  le_1, sample_2=s
-0001f500: 616d 706c 655f 3229 290a 2020 2020 2020  ample_2)).      
-0001f510: 2020 2222 220a 2020 2020 2020 2020 7361    """.        sa
-0001f520: 6d70 6c65 5f31 203d 206e 702e 6173 636f  mple_1 = np.asco
-0001f530: 6e74 6967 756f 7573 6172 7261 7928 7361  ntiguousarray(sa
-0001f540: 6d70 6c65 5f31 290a 2020 2020 2020 2020  mple_1).        
-0001f550: 7361 6d70 6c65 5f32 203d 206e 702e 6173  sample_2 = np.as
-0001f560: 636f 6e74 6967 756f 7573 6172 7261 7928  contiguousarray(
-0001f570: 7361 6d70 6c65 5f32 290a 2020 2020 2020  sample_2).      
-0001f580: 2020 6461 7461 203d 206e 702e 6873 7461    data = np.hsta
-0001f590: 636b 2828 7361 6d70 6c65 5f31 2e72 6573  ck((sample_1.res
-0001f5a0: 6861 7065 282d 312c 2031 292c 2073 616d  hape(-1, 1), sam
-0001f5b0: 706c 655f 322e 7265 7368 6170 6528 2d31  ple_2.reshape(-1
-0001f5c0: 2c20 3129 2929 0a20 2020 2020 2020 2074  , 1))).        t
-0001f5d0: 7020 3d20 6c65 6e28 6e70 2e61 7267 7768  p = len(np.argwh
-0001f5e0: 6572 6528 2864 6174 615b 3a2c 2030 5d20  ere((data[:, 0] 
-0001f5f0: 3d3d 2031 2920 2620 2864 6174 615b 3a2c  == 1) & (data[:,
-0001f600: 2031 5d20 3d3d 2031 2929 2e66 6c61 7474   1] == 1)).flatt
-0001f610: 656e 2829 290a 2020 2020 2020 2020 746e  en()).        tn
-0001f620: 203d 206c 656e 286e 702e 6172 6777 6865   = len(np.argwhe
-0001f630: 7265 2828 6461 7461 5b3a 2c20 305d 203d  re((data[:, 0] =
-0001f640: 3d20 3029 2026 2028 6461 7461 5b3a 2c20  = 0) & (data[:, 
-0001f650: 315d 203d 3d20 3029 292e 666c 6174 7465  1] == 0)).flatte
-0001f660: 6e28 2929 0a20 2020 2020 2020 2066 7020  n()).        fp 
-0001f670: 3d20 6c65 6e28 6e70 2e61 7267 7768 6572  = len(np.argwher
-0001f680: 6528 2864 6174 615b 3a2c 2030 5d20 3d3d  e((data[:, 0] ==
-0001f690: 2031 2920 2620 2864 6174 615b 3a2c 2031   1) & (data[:, 1
-0001f6a0: 5d20 3d3d 2030 2929 2e66 6c61 7474 656e  ] == 0)).flatten
-0001f6b0: 2829 290a 2020 2020 2020 2020 666e 203d  ()).        fn =
-0001f6c0: 206c 656e 286e 702e 6172 6777 6865 7265   len(np.argwhere
-0001f6d0: 2828 6461 7461 5b3a 2c20 305d 203d 3d20  ((data[:, 0] == 
-0001f6e0: 3029 2026 2028 6461 7461 5b3a 2c20 315d  0) & (data[:, 1]
-0001f6f0: 203d 3d20 3129 292e 666c 6174 7465 6e28   == 1)).flatten(
-0001f700: 2929 0a20 2020 2020 2020 2064 6174 6120  )).        data 
-0001f710: 3d20 6e70 2e61 7272 6179 2828 5b74 702c  = np.array(([tp,
-0001f720: 2066 705d 2c20 5b66 6e2c 2074 6e5d 2929   fp], [fn, tn]))
-0001f730: 0a20 2020 2020 2020 2073 756d 3020 3d20  .        sum0 = 
-0001f740: 6461 7461 2e73 756d 2861 7869 733d 3029  data.sum(axis=0)
-0001f750: 0a20 2020 2020 2020 2073 756d 3120 3d20  .        sum1 = 
-0001f760: 6461 7461 2e73 756d 2861 7869 733d 3129  data.sum(axis=1)
-0001f770: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-0001f780: 6420 3d20 6e70 2e6f 7574 6572 2873 756d  d = np.outer(sum
-0001f790: 302c 2073 756d 3129 202f 206e 702e 7375  0, sum1) / np.su
-0001f7a0: 6d28 7375 6d30 290a 2020 2020 2020 2020  m(sum0).        
-0001f7b0: 775f 6d61 7420 3d20 6e70 2e66 756c 6c28  w_mat = np.full(
-0001f7c0: 7368 6170 653d 2832 2c20 3229 2c20 6669  shape=(2, 2), fi
-0001f7d0: 6c6c 5f76 616c 7565 3d31 290a 2020 2020  ll_value=1).    
-0001f7e0: 2020 2020 775f 6d61 745b 302c 2030 5d20      w_mat[0, 0] 
-0001f7f0: 3d20 300a 2020 2020 2020 2020 775f 6d61  = 0.        w_ma
-0001f800: 745b 312c 2031 5d20 3d20 300a 2020 2020  t[1, 1] = 0.    
-0001f810: 2020 2020 7265 7475 726e 2031 202d 206e      return 1 - n
-0001f820: 702e 7375 6d28 775f 6d61 7420 2a20 6461  p.sum(w_mat * da
-0001f830: 7461 2920 2f20 6e70 2e73 756d 2877 5f6d  ta) / np.sum(w_m
-0001f840: 6174 202a 2065 7870 6563 7465 6429 0a0a  at * expected)..
-0001f850: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0001f860: 640a 2020 2020 6465 6620 645f 7072 696d  d.    def d_prim
-0001f870: 6528 0a20 2020 2020 2020 2078 3a20 6e70  e(.        x: np
-0001f880: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-0001f890: 2020 793a 206e 702e 6e64 6172 7261 792c    y: np.ndarray,
-0001f8a0: 0a20 2020 2020 2020 206c 6f77 6572 5f6c  .        lower_l
-0001f8b0: 696d 6974 3a20 4f70 7469 6f6e 616c 5b66  imit: Optional[f
-0001f8c0: 6c6f 6174 5d20 3d20 302e 3030 3031 2c0a  loat] = 0.0001,.
-0001f8d0: 2020 2020 2020 2020 7570 7065 725f 6c69          upper_li
-0001f8e0: 6d69 743a 204f 7074 696f 6e61 6c5b 666c  mit: Optional[fl
-0001f8f0: 6f61 745d 203d 2030 2e39 3939 392c 0a20  oat] = 0.9999,. 
-0001f900: 2020 2029 202d 3e20 666c 6f61 743a 0a20     ) -> float:. 
-0001f910: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001f920: 2020 2043 6f6d 7075 7465 7320 642d 7072     Computes d-pr
-0001f930: 696d 6520 6672 6f6d 2074 776f 2042 6f6f  ime from two Boo
-0001f940: 6c65 616e 2031 6420 6172 7261 7973 2c20  lean 1d arrays, 
-0001f950: 652e 672e 2c20 6265 7477 6565 6e20 636c  e.g., between cl
-0001f960: 6173 7369 6669 6361 7469 6f6e 7320 616e  assifications an
-0001f970: 6420 6772 6f75 6e64 2074 7275 7468 2e0a  d ground truth..
-0001f980: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001f990: 6e70 2e6e 6461 7272 6179 2078 3a20 426f  np.ndarray x: Bo
-0001f9a0: 6f6c 6561 6e20 3144 2061 7272 6179 206f  olean 1D array o
-0001f9b0: 6620 7265 7370 6f6e 7365 2076 616c 7565  f response value
-0001f9c0: 732c 2077 6865 7265 2031 2072 6570 7265  s, where 1 repre
-0001f9d0: 7365 6e74 7320 7072 6573 656e 6365 2c20  sents presence, 
-0001f9e0: 616e 6420 3020 7265 7072 6573 656e 7469  and 0 representi
-0001f9f0: 6e67 2061 6273 656e 6365 2e0a 2020 2020  ng absence..    
-0001fa00: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
-0001fa10: 6172 7261 7920 793a 2042 6f6f 6c65 616e  array y: Boolean
-0001fa20: 2031 4420 6172 7261 7920 6f66 2067 726f   1D array of gro
-0001fa30: 756e 6420 7472 7574 682c 2077 6865 7265  und truth, where
-0001fa40: 2031 2072 6570 7265 7365 6e74 7320 7072   1 represents pr
-0001fa50: 6573 656e 6365 2c20 616e 6420 3020 7265  esence, and 0 re
-0001fa60: 7072 6573 656e 7469 6e67 2061 6273 656e  presenting absen
-0001fa70: 6365 2e0a 2020 2020 2020 2020 3a70 6172  ce..        :par
-0001fa80: 616d 204f 7074 696f 6e61 6c5b 666c 6f61  am Optional[floa
-0001fa90: 745d 206c 6f77 6572 5f6c 696d 6974 3a20  t] lower_limit: 
-0001faa0: 4c6f 7765 7220 6c69 6d69 7420 746f 2062  Lower limit to b
-0001fab0: 6f75 6e64 2068 6974 2061 6e64 2066 616c  ound hit and fal
-0001fac0: 7365 2061 6c61 726d 2072 6174 6573 2e20  se alarm rates. 
-0001fad0: 4465 6661 756c 7473 2074 6f20 302e 3030  Defaults to 0.00
-0001fae0: 3031 2e0a 2020 2020 2020 2020 3a70 6172  01..        :par
-0001faf0: 616d 204f 7074 696f 6e61 6c5b 666c 6f61  am Optional[floa
-0001fb00: 745d 2075 7070 6572 5f6c 696d 6974 3a20  t] upper_limit: 
-0001fb10: 5570 7065 7220 6c69 6d69 7420 746f 2062  Upper limit to b
-0001fb20: 6f75 6e64 2068 6974 2061 6e64 2066 616c  ound hit and fal
-0001fb30: 7365 2061 6c61 726d 2072 6174 6573 2e20  se alarm rates. 
-0001fb40: 4465 6661 756c 7473 2074 6f20 302e 3939  Defaults to 0.99
-0001fb50: 3939 2e0a 2020 2020 2020 2020 3a72 6574  99..        :ret
-0001fb60: 7572 6e20 666c 6f61 743a 2054 6865 2063  urn float: The c
-0001fb70: 616c 6375 6c61 7465 6420 6427 2028 642d  alculated d' (d-
-0001fb80: 7072 696d 6529 2076 616c 7565 2e0a 0a20  prime) value... 
-0001fb90: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-0001fba0: 0a20 2020 2020 2020 203e 3e3e 2078 203d  .        >>> x =
-0001fbb0: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
-0001fbc0: 6e74 2830 2c20 322c 2028 3130 3030 2c29  nt(0, 2, (1000,)
-0001fbd0: 290a 2020 2020 2020 2020 3e3e 3e20 7920  ).        >>> y 
-0001fbe0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-0001fbf0: 696e 7428 302c 2032 2c20 2831 3030 302c  int(0, 2, (1000,
-0001fc00: 2929 0a20 2020 2020 2020 203e 3e3e 2053  )).        >>> S
-0001fc10: 7461 7469 7374 6963 732e 645f 7072 696d  tatistics.d_prim
-0001fc20: 6528 783d 782c 2079 3d79 290a 2020 2020  e(x=x, y=y).    
-0001fc30: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0001fc40: 2063 6865 636b 5f76 616c 6964 5f61 7272   check_valid_arr
-0001fc50: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
-0001fc60: 6461 7461 3d78 2c0a 2020 2020 2020 2020  data=x,.        
-0001fc70: 2020 2020 736f 7572 6365 3d53 7461 7469      source=Stati
-0001fc80: 7374 6963 732e 645f 7072 696d 652e 5f5f  stics.d_prime.__
-0001fc90: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-0001fca0: 2020 2020 6163 6365 7074 6564 5f6e 6469      accepted_ndi
-0001fcb0: 6d73 3d28 312c 292c 0a20 2020 2020 2020  ms=(1,),.       
-0001fcc0: 2020 2020 2061 6363 6570 7465 645f 6474       accepted_dt
-0001fcd0: 7970 6573 3d28 6e70 2e69 6e74 3634 2c20  ypes=(np.int64, 
-0001fce0: 6e70 2e69 6e74 3332 2c20 6e70 2e69 6e74  np.int32, np.int
-0001fcf0: 3829 2c0a 2020 2020 2020 2020 290a 2020  8),.        ).  
-0001fd00: 2020 2020 2020 6368 6563 6b5f 7661 6c69        check_vali
-0001fd10: 645f 6172 7261 7928 0a20 2020 2020 2020  d_array(.       
-0001fd20: 2020 2020 2064 6174 613d 792c 0a20 2020       data=y,.   
-0001fd30: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
-0001fd40: 5374 6174 6973 7469 6373 2e64 5f70 7269  Statistics.d_pri
-0001fd50: 6d65 2e5f 5f6e 616d 655f 5f2c 0a20 2020  me.__name__,.   
-0001fd60: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-0001fd70: 645f 6e64 696d 733d 2831 2c29 2c0a 2020  d_ndims=(1,),.  
-0001fd80: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-0001fd90: 6564 5f64 7479 7065 733d 286e 702e 696e  ed_dtypes=(np.in
-0001fda0: 7436 342c 206e 702e 696e 7433 322c 206e  t64, np.int32, n
-0001fdb0: 702e 696e 7438 292c 0a20 2020 2020 2020  p.int8),.       
-0001fdc0: 2029 0a20 2020 2020 2020 2069 6620 6c65   ).        if le
-0001fdd0: 6e28 6c69 7374 287b 782e 7368 6170 655b  n(list({x.shape[
-0001fde0: 305d 2c20 792e 7368 6170 655b 305d 7d29  0], y.shape[0]})
-0001fdf0: 2920 213d 2031 3a0a 2020 2020 2020 2020  ) != 1:.        
-0001fe00: 2020 2020 7261 6973 6520 436f 756e 7445      raise CountE
-0001fe10: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001fe20: 2020 2020 2020 6d73 673d 6622 5468 6520        msg=f"The 
-0001fe30: 7477 6f20 6172 7261 7973 2068 6173 2074  two arrays has t
-0001fe40: 6f20 6265 2065 7175 616c 206c 656e 6774  o be equal lengt
-0001fe50: 6873 2062 7574 2067 6f74 3a20 7b78 2e73  hs but got: {x.s
-0001fe60: 6861 7065 5b30 5d2c 2079 2e73 6861 7065  hape[0], y.shape
-0001fe70: 5b30 5d7d 222c 0a20 2020 2020 2020 2020  [0]}",.         
-0001fe80: 2020 2020 2020 2073 6f75 7263 653d 5374         source=St
-0001fe90: 6174 6973 7469 6373 2e64 5f70 7269 6d65  atistics.d_prime
-0001fea0: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-0001feb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001fec0: 2066 6f72 2069 2069 6e20 5b78 2c20 795d   for i in [x, y]
-0001fed0: 3a0a 2020 2020 2020 2020 2020 2020 6164  :.            ad
-0001fee0: 6469 7469 6f6e 616c 203d 206c 6973 7428  ditional = list(
-0001fef0: 7365 7428 6c69 7374 286e 702e 736f 7274  set(list(np.sort
-0001ff00: 286e 702e 756e 6971 7565 2869 2929 2929  (np.unique(i))))
-0001ff10: 202d 207b 302c 2031 7d29 0a20 2020 2020   - {0, 1}).     
-0001ff20: 2020 2020 2020 2069 6620 6c65 6e28 6164         if len(ad
-0001ff30: 6469 7469 6f6e 616c 2920 3e20 303a 0a20  ditional) > 0:. 
-0001ff40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001ff50: 6169 7365 2049 6e76 616c 6964 496e 7075  aise InvalidInpu
-0001ff60: 7445 7272 6f72 280a 2020 2020 2020 2020  tError(.        
-0001ff70: 2020 2020 2020 2020 2020 2020 6d73 673d              msg=
-0001ff80: 6622 442d 7072 696d 6520 7265 7175 6972  f"D-prime requir
-0001ff90: 6573 2062 696e 6172 7920 696e 7075 7420  es binary input 
-0001ffa0: 6461 7461 2062 7574 2066 6f75 6e64 207b  data but found {
-0001ffb0: 6164 6469 7469 6f6e 616c 7d22 2c0a 2020  additional}",.  
-0001ffc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ffd0: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
-0001ffe0: 6963 732e 645f 7072 696d 6528 292e 5f5f  ics.d_prime().__
-0001fff0: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-00020000: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00020010: 2020 7461 7267 6574 5f69 6478 203d 206e    target_idx = n
-00020020: 702e 6172 6777 6865 7265 2879 203d 3d20  p.argwhere(y == 
-00020030: 3129 2e66 6c61 7474 656e 2829 0a20 2020  1).flatten().   
-00020040: 2020 2020 2068 6974 5f72 6174 6520 3d20       hit_rate = 
-00020050: 6e70 2e73 756d 2878 5b6e 702e 6172 6777  np.sum(x[np.argw
-00020060: 6865 7265 2879 203d 3d20 3129 5d29 202f  here(y == 1)]) /
-00020070: 2074 6172 6765 745f 6964 782e 7368 6170   target_idx.shap
-00020080: 655b 305d 0a20 2020 2020 2020 2066 616c  e[0].        fal
-00020090: 7365 5f61 6c61 726d 5f72 6174 6520 3d20  se_alarm_rate = 
-000200a0: 6e70 2e73 756d 2878 5b6e 702e 6172 6777  np.sum(x[np.argw
-000200b0: 6865 7265 2879 203d 3d20 3029 5d29 202f  here(y == 0)]) /
-000200c0: 2074 6172 6765 745f 6964 782e 7368 6170   target_idx.shap
-000200d0: 655b 305d 0a20 2020 2020 2020 2069 6620  e[0].        if 
-000200e0: 6869 745f 7261 7465 203c 206c 6f77 6572  hit_rate < lower
-000200f0: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
-00020100: 2020 2020 6869 745f 7261 7465 203d 206c      hit_rate = l
-00020110: 6f77 6572 5f6c 696d 6974 0a20 2020 2020  ower_limit.     
-00020120: 2020 2065 6c69 6620 6869 745f 7261 7465     elif hit_rate
-00020130: 203e 2075 7070 6572 5f6c 696d 6974 3a0a   > upper_limit:.
-00020140: 2020 2020 2020 2020 2020 2020 6869 745f              hit_
-00020150: 7261 7465 203d 2075 7070 6572 5f6c 696d  rate = upper_lim
-00020160: 6974 0a20 2020 2020 2020 2069 6620 6661  it.        if fa
-00020170: 6c73 655f 616c 6172 6d5f 7261 7465 203c  lse_alarm_rate <
-00020180: 206c 6f77 6572 5f6c 696d 6974 3a0a 2020   lower_limit:.  
-00020190: 2020 2020 2020 2020 2020 6661 6c73 655f            false_
-000201a0: 616c 6172 6d5f 7261 7465 203d 206c 6f77  alarm_rate = low
-000201b0: 6572 5f6c 696d 6974 0a20 2020 2020 2020  er_limit.       
-000201c0: 2065 6c69 6620 6661 6c73 655f 616c 6172   elif false_alar
-000201d0: 6d5f 7261 7465 203e 2075 7070 6572 5f6c  m_rate > upper_l
-000201e0: 696d 6974 3a0a 2020 2020 2020 2020 2020  imit:.          
-000201f0: 2020 6661 6c73 655f 616c 6172 6d5f 7261    false_alarm_ra
-00020200: 7465 203d 2075 7070 6572 5f6c 696d 6974  te = upper_limit
-00020210: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00020220: 7374 6174 732e 6e6f 726d 2e70 7066 2868  stats.norm.ppf(h
-00020230: 6974 5f72 6174 6529 202d 2073 7461 7473  it_rate) - stats
-00020240: 2e6e 6f72 6d2e 7070 6628 6661 6c73 655f  .norm.ppf(false_
-00020250: 616c 6172 6d5f 7261 7465 290a 0a20 2020  alarm_rate)..   
-00020260: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00020270: 2020 2064 6566 206d 636e 656d 6172 280a     def mcnemar(.
-00020280: 2020 2020 2020 2020 783a 206e 702e 6e64          x: np.nd
-00020290: 6172 7261 792c 0a20 2020 2020 2020 2079  array,.        y
-000202a0: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
-000202b0: 2020 2020 2020 6772 6f75 6e64 5f74 7275        ground_tru
-000202c0: 7468 3a20 6e70 2e6e 6461 7272 6179 2c0a  th: np.ndarray,.
-000202d0: 2020 2020 2020 2020 636f 6e74 696e 7569          continui
-000202e0: 7479 5f63 6f72 7265 6374 6564 3a20 4f70  ty_corrected: Op
-000202f0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 2054  tional[bool] = T
-00020300: 7275 652c 0a20 2020 2029 202d 3e20 5475  rue,.    ) -> Tu
-00020310: 706c 655b 666c 6f61 742c 2066 6c6f 6174  ple[float, float
-00020320: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
-00020330: 2020 2020 2020 204d 634e 656d 6172 2773         McNemar's
-00020340: 2074 6573 7420 746f 2063 6f6d 7061 7265   test to compare
-00020350: 2074 6865 2064 6966 6665 7265 6e63 6520   the difference 
-00020360: 696e 2070 7265 6469 6374 6976 6520 6163  in predictive ac
-00020370: 6375 7261 6379 206f 6620 7477 6f20 6d6f  curacy of two mo
-00020380: 6465 6c73 2e0a 0a20 2020 2020 2020 2045  dels...        E
-00020390: 2e67 2e2c 2063 616e 2062 6520 7573 6564  .g., can be used
-000203a0: 2074 6f20 636f 6d70 7574 6520 6966 2074   to compute if t
-000203b0: 6865 2061 6363 7572 6163 7920 6f66 2074  he accuracy of t
-000203c0: 776f 2063 6c61 7373 6966 6965 7273 2061  wo classifiers a
-000203d0: 7265 2073 6967 6e69 6669 6361 6e74 6c79  re significantly
-000203e0: 2064 6966 6665 7265 6e74 2077 6865 6e20   different when 
-000203f0: 7472 616e 7366 6f72 6d69 6e67 2074 6865  transforming the
-00020400: 2073 616d 6520 6461 7461 2e0a 0a20 2020   same data...   
-00020410: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a20       .. note::. 
-00020420: 2020 2020 2020 2020 2020 606d 6c65 7874            `mlext
-00020430: 656e 6420 3c68 7474 7073 3a2f 2f67 6974  end <https://git
-00020440: 6875 622e 636f 6d2f 7261 7362 742f 6d6c  hub.com/rasbt/ml
-00020450: 7874 656e 642f 626c 6f62 2f6d 6173 7465  xtend/blob/maste
-00020460: 722f 6d6c 7874 656e 642f 6576 616c 7561  r/mlxtend/evalua
-00020470: 7465 2f6d 636e 656d 6172 2e70 793e 605f  te/mcnemar.py>`_
-00020480: 5f2e 0a0a 2020 2020 2020 2020 3a70 6172  _...        :par
-00020490: 616d 206e 702e 6e64 6172 7261 7920 783a  am np.ndarray x:
-000204a0: 2031 2d64 696d 656e 7369 6f6e 616c 2042   1-dimensional B
-000204b0: 6f6f 6c65 616e 2061 7272 6179 2077 6974  oolean array wit
-000204c0: 6820 7072 6564 6963 7469 6f6e 7320 6f66  h predictions of
-000204d0: 2074 6865 2066 6972 7374 206d 6f64 656c   the first model
-000204e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000204f0: 206e 702e 6e64 6172 7261 7920 783a 2031   np.ndarray x: 1
-00020500: 2d64 696d 656e 7369 6f6e 616c 2042 6f6f  -dimensional Boo
-00020510: 6c65 616e 2061 7272 6179 2077 6974 6820  lean array with 
-00020520: 7072 6564 6963 7469 6f6e 7320 6f66 2074  predictions of t
-00020530: 6865 2073 6563 6f6e 6420 6d6f 6465 6c2e  he second model.
-00020540: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00020550: 6e70 2e6e 6461 7272 6179 2078 3a20 312d  np.ndarray x: 1-
-00020560: 6469 6d65 6e73 696f 6e61 6c20 426f 6f6c  dimensional Bool
-00020570: 6561 6e20 6172 7261 7920 7769 7468 2067  ean array with g
-00020580: 726f 756e 6420 7472 7574 6820 6c61 6265  round truth labe
-00020590: 6c73 2e0a 2020 2020 2020 2020 3a70 6172  ls..        :par
-000205a0: 616d 204f 7074 696f 6e61 6c5b 626f 6f6c  am Optional[bool
-000205b0: 5d20 636f 6e74 696e 7569 7479 5f63 6f72  ] continuity_cor
-000205c0: 7265 6374 6564 203a 2057 6865 7468 6572  rected : Whether
-000205d0: 2074 6f20 6170 706c 7920 636f 6e74 696e   to apply contin
-000205e0: 7569 7479 2063 6f72 7265 6374 696f 6e2e  uity correction.
-000205f0: 2044 6566 6175 6c74 2069 7320 5472 7565   Default is True
-00020600: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
-00020610: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00020620: 2078 203d 206e 702e 7261 6e64 6f6d 2e72   x = np.random.r
-00020630: 616e 6469 6e74 2830 2c20 322c 2028 3130  andint(0, 2, (10
-00020640: 3030 3030 2c20 2929 0a20 2020 2020 2020  0000, )).       
-00020650: 203e 3e3e 2079 203d 206e 702e 7261 6e64   >>> y = np.rand
-00020660: 6f6d 2e72 616e 6469 6e74 2830 2c20 322c  om.randint(0, 2,
-00020670: 2028 3130 3030 3030 2c20 2929 0a20 2020   (100000, )).   
-00020680: 2020 2020 203e 3e3e 2067 726f 756e 645f       >>> ground_
-00020690: 7472 7574 6820 3d20 6e70 2e72 616e 646f  truth = np.rando
-000206a0: 6d2e 7261 6e64 696e 7428 302c 2032 2c20  m.randint(0, 2, 
-000206b0: 2831 3030 3030 302c 2029 290a 2020 2020  (100000, )).    
-000206c0: 2020 2020 3e3e 3e20 5374 6174 6973 7469      >>> Statisti
-000206d0: 6373 2e6d 636e 656d 6172 2878 3d78 2c20  cs.mcnemar(x=x, 
-000206e0: 793d 792c 2067 726f 756e 645f 7472 7574  y=y, ground_trut
-000206f0: 683d 6772 6f75 6e64 5f74 7275 7468 290a  h=ground_truth).
-00020700: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00020710: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
-00020720: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-00020730: 2020 2020 6461 7461 3d78 2c0a 2020 2020      data=x,.    
-00020740: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
-00020750: 7461 7469 7374 6963 732e 6d63 6e65 6d61  tatistics.mcnema
-00020760: 722e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  r.__name__,.    
-00020770: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00020780: 5f6e 6469 6d73 3d28 312c 292c 0a20 2020  _ndims=(1,),.   
-00020790: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-000207a0: 645f 6474 7970 6573 3d28 6e70 2e69 6e74  d_dtypes=(np.int
-000207b0: 3634 2c20 6e70 2e69 6e74 3332 2c20 6e70  64, np.int32, np
-000207c0: 2e69 6e74 3829 2c0a 2020 2020 2020 2020  .int8),.        
-000207d0: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
-000207e0: 7661 6c69 645f 6172 7261 7928 0a20 2020  valid_array(.   
-000207f0: 2020 2020 2020 2020 2064 6174 613d 792c           data=y,
-00020800: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-00020810: 7263 653d 5374 6174 6973 7469 6373 2e6d  rce=Statistics.m
-00020820: 636e 656d 6172 2e5f 5f6e 616d 655f 5f2c  cnemar.__name__,
-00020830: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-00020840: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
-00020850: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-00020860: 6365 7074 6564 5f64 7479 7065 733d 286e  cepted_dtypes=(n
-00020870: 702e 696e 7436 342c 206e 702e 696e 7433  p.int64, np.int3
-00020880: 322c 206e 702e 696e 7438 292c 0a20 2020  2, np.int8),.   
-00020890: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
-000208a0: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
-000208b0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
-000208c0: 7461 3d67 726f 756e 645f 7472 7574 682c  ta=ground_truth,
-000208d0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-000208e0: 7263 653d 5374 6174 6973 7469 6373 2e6d  rce=Statistics.m
-000208f0: 636e 656d 6172 2e5f 5f6e 616d 655f 5f2c  cnemar.__name__,
-00020900: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-00020910: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
-00020920: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
-00020930: 6365 7074 6564 5f64 7479 7065 733d 286e  cepted_dtypes=(n
-00020940: 702e 696e 7436 342c 206e 702e 696e 7433  p.int64, np.int3
-00020950: 322c 206e 702e 696e 7438 292c 0a20 2020  2, np.int8),.   
-00020960: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00020970: 6620 6c65 6e28 6c69 7374 287b 782e 7368  f len(list({x.sh
-00020980: 6170 655b 305d 2c20 792e 7368 6170 655b  ape[0], y.shape[
-00020990: 305d 2c20 6772 6f75 6e64 5f74 7275 7468  0], ground_truth
-000209a0: 2e73 6861 7065 5b30 5d7d 2929 2021 3d20  .shape[0]})) != 
-000209b0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-000209c0: 6169 7365 2043 6f75 6e74 4572 726f 7228  aise CountError(
-000209d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000209e0: 206d 7367 3d66 2254 6865 2074 6872 6565   msg=f"The three
-000209f0: 2061 7272 6179 7320 6861 7320 746f 2062   arrays has to b
-00020a00: 6520 6571 7561 6c20 6c65 6e67 7468 7320  e equal lengths 
-00020a10: 6275 7420 676f 743a 207b 782e 7368 6170  but got: {x.shap
-00020a20: 655b 305d 2c20 792e 7368 6170 655b 305d  e[0], y.shape[0]
-00020a30: 2c20 6772 6f75 6e64 5f74 7275 7468 2e73  , ground_truth.s
-00020a40: 6861 7065 5b30 5d7d 222c 0a20 2020 2020  hape[0]}",.     
-00020a50: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-00020a60: 653d 5374 6174 6973 7469 6373 2e6d 636e  e=Statistics.mcn
-00020a70: 656d 6172 2e5f 5f6e 616d 655f 5f2c 0a20  emar.__name__,. 
-00020a80: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00020a90: 2020 2020 2066 6f72 2069 2069 6e20 5b78       for i in [x
-00020aa0: 2c20 792c 2067 726f 756e 645f 7472 7574  , y, ground_trut
-00020ab0: 685d 3a0a 2020 2020 2020 2020 2020 2020  h]:.            
-00020ac0: 6164 6469 7469 6f6e 616c 203d 206c 6973  additional = lis
-00020ad0: 7428 7365 7428 6c69 7374 286e 702e 736f  t(set(list(np.so
-00020ae0: 7274 286e 702e 756e 6971 7565 2869 2929  rt(np.unique(i))
-00020af0: 2929 202d 207b 302c 2031 7d29 0a20 2020  )) - {0, 1}).   
-00020b00: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-00020b10: 6164 6469 7469 6f6e 616c 2920 3e20 303a  additional) > 0:
-00020b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020b30: 2072 6169 7365 2049 6e76 616c 6964 496e   raise InvalidIn
-00020b40: 7075 7445 7272 6f72 280a 2020 2020 2020  putError(.      
-00020b50: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
-00020b60: 673d 6622 4d63 6e65 6d61 7220 7265 7175  g=f"Mcnemar requ
-00020b70: 6972 6573 2062 696e 6172 7920 696e 7075  ires binary inpu
-00020b80: 7420 6461 7461 2062 7574 2066 6f75 6e64  t data but found
-00020b90: 207b 6164 6469 7469 6f6e 616c 7d22 2c0a   {additional}",.
-00020ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bb0: 2020 2020 736f 7572 6365 3d53 7461 7469      source=Stati
-00020bc0: 7374 6963 732e 6d63 6e65 6d61 722e 5f5f  stics.mcnemar.__
-00020bd0: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-00020be0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00020bf0: 2020 6461 7461 203d 206e 702e 6873 7461    data = np.hsta
-00020c00: 636b 280a 2020 2020 2020 2020 2020 2020  ck(.            
-00020c10: 2878 2e72 6573 6861 7065 282d 312c 2031  (x.reshape(-1, 1
-00020c20: 292c 2079 2e72 6573 6861 7065 282d 312c  ), y.reshape(-1,
-00020c30: 2031 292c 2067 726f 756e 645f 7472 7574   1), ground_trut
-00020c40: 682e 7265 7368 6170 6528 2d31 2c20 3129  h.reshape(-1, 1)
-00020c50: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
-00020c60: 2020 2020 6220 3d20 280a 2020 2020 2020      b = (.      
-00020c70: 2020 2020 2020 6e70 2e77 6865 7265 2828        np.where((
-00020c80: 6461 7461 203d 3d20 2830 2c20 312c 2030  data == (0, 1, 0
-00020c90: 2929 2e61 6c6c 2861 7869 733d 3129 295b  )).all(axis=1))[
-00020ca0: 305d 2e73 6861 7065 5b30 5d0a 2020 2020  0].shape[0].    
-00020cb0: 2020 2020 2020 2020 2b20 6e70 2e77 6865          + np.whe
-00020cc0: 7265 2828 6461 7461 203d 3d20 2831 2c20  re((data == (1, 
-00020cd0: 302c 2031 2929 2e61 6c6c 2861 7869 733d  0, 1)).all(axis=
-00020ce0: 3129 295b 305d 2e73 6861 7065 5b30 5d0a  1))[0].shape[0].
-00020cf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00020d00: 2020 6320 3d20 280a 2020 2020 2020 2020    c = (.        
-00020d10: 2020 2020 6e70 2e77 6865 7265 2828 6461      np.where((da
-00020d20: 7461 203d 3d20 2831 2c20 302c 2030 2929  ta == (1, 0, 0))
-00020d30: 2e61 6c6c 2861 7869 733d 3129 295b 305d  .all(axis=1))[0]
-00020d40: 2e73 6861 7065 5b30 5d0a 2020 2020 2020  .shape[0].      
-00020d50: 2020 2020 2020 2b20 6e70 2e77 6865 7265        + np.where
-00020d60: 2828 6461 7461 203d 3d20 2830 2c20 312c  ((data == (0, 1,
-00020d70: 2031 2929 2e61 6c6c 2861 7869 733d 3129   1)).all(axis=1)
-00020d80: 295b 305d 2e73 6861 7065 5b30 5d0a 2020  )[0].shape[0].  
-00020d90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00020da0: 6966 206e 6f74 2063 6f6e 7469 6e75 6974  if not continuit
-00020db0: 795f 636f 7272 6563 7465 643a 0a20 2020  y_corrected:.   
-00020dc0: 2020 2020 2020 2020 2078 203d 2028 6e70           x = (np
-00020dd0: 2e73 7175 6172 6528 6220 2d20 6329 2920  .square(b - c)) 
-00020de0: 2f20 2862 202b 2063 290a 2020 2020 2020  / (b + c).      
-00020df0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00020e00: 2020 2020 7820 3d20 286e 702e 7371 7561      x = (np.squa
-00020e10: 7265 286e 702e 6162 7328 6220 2d20 6329  re(np.abs(b - c)
-00020e20: 202d 2031 2929 202f 2028 6220 2b20 6329   - 1)) / (b + c)
-00020e30: 0a20 2020 2020 2020 2070 203d 2063 6869  .        p = chi
-00020e40: 322e 7366 2878 2c20 3129 0a20 2020 2020  2.sf(x, 1).     
-00020e50: 2020 2072 6574 7572 6e20 782c 2070 0a0a     return x, p..
-00020e60: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00020e70: 640a 2020 2020 6465 6620 636f 6368 7261  d.    def cochra
-00020e80: 6e73 5f71 2864 6174 613a 206e 702e 6e64  ns_q(data: np.nd
-00020e90: 6172 7261 7929 202d 3e20 5475 706c 655b  array) -> Tuple[
-00020ea0: 666c 6f61 742c 2066 6c6f 6174 5d3a 0a20  float, float]:. 
-00020eb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00020ec0: 2020 2043 6f6d 7075 7465 2043 6f63 6872     Compute Cochr
-00020ed0: 616e 7320 5120 666f 7220 322d 6469 6d65  ans Q for 2-dime
-00020ee0: 6e73 696f 6e61 6c20 626f 6f6c 6561 6e20  nsional boolean 
-00020ef0: 6172 7261 792e 0a0a 2020 2020 2020 2020  array...        
-00020f00: 4361 6e20 6265 2075 7365 6420 746f 2065  Can be used to e
-00020f10: 7661 6c75 6174 6520 6966 2074 6865 2070  valuate if the p
-00020f20: 6572 666f 726d 616e 6365 206f 6620 6d75  erformance of mu
-00020f30: 6c74 6970 6c65 2028 3e3d 3229 2063 6c61  ltiple (>=2) cla
-00020f40: 7373 6966 6965 7273 206f 6e20 7468 6520  ssifiers on the 
-00020f50: 7361 6d65 2064 6174 6120 6973 2074 6865  same data is the
-00020f60: 2073 616d 6520 6f72 2073 6967 6e69 6669   same or signifi
-00020f70: 6361 6e74 6c79 2064 6966 6665 7265 6e74  cantly different
-00020f80: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
-00020f90: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
-00020fa0: 4966 2074 776f 2063 6c61 7373 6966 6965  If two classifie
-00020fb0: 7273 2c20 636f 6e73 6964 6572 2060 6073  rs, consider ``s
-00020fc0: 696d 6261 2e6d 6978 696e 732e 7374 6174  imba.mixins.stat
-00020fd0: 6973 7469 6373 2e53 7461 7469 7374 6963  istics.Statistic
-00020fe0: 732e 6d63 6e65 6d61 7260 602e 0a20 2020  s.mcnemar``..   
-00020ff0: 2020 2020 2020 2020 6055 7365 6675 6c20          `Useful 
-00021000: 6261 636b 6772 6f75 6e64 2020 3c68 7474  background  <htt
-00021010: 7073 3a2f 2f70 7379 6368 2e75 6e6c 2e65  ps://psych.unl.e
-00021020: 6475 2f70 7379 6372 732f 6861 6e64 636f  du/psycrs/handco
-00021030: 6d70 2f68 6363 6f63 6872 616e 2e50 4446  mp/hccochran.PDF
-00021040: 3e60 5f5f 2e0a 0a20 2020 2020 2020 203a  >`__...        :
-00021050: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-00021060: 2064 6174 613a 2054 776f 2064 696d 656e   data: Two dimen
-00021070: 7369 6f6e 616c 2061 7272 6179 206f 6620  sional array of 
-00021080: 626f 6f6c 6561 6e20 7661 6c75 6573 2077  boolean values w
-00021090: 6865 7265 2061 7869 7320 3120 7265 7072  here axis 1 repr
-000210a0: 6573 656e 7473 2063 6c61 7373 6966 6965  esents classifie
-000210b0: 7273 206f 7220 6665 6174 7572 6573 2061  rs or features a
-000210c0: 6e64 2072 6f77 7320 7265 7072 6573 656e  nd rows represen
-000210d0: 7420 6672 616d 6573 2e0a 2020 2020 2020  t frames..      
-000210e0: 2020 3a72 6574 7572 6e20 5475 706c 655b    :return Tuple[
-000210f0: 666c 6f61 742c 2066 6c6f 6174 5d3a 2043  float, float]: C
-00021100: 6f63 6872 616e 2773 2051 2073 7461 7469  ochran's Q stati
-00021110: 7374 6963 2073 6967 6e69 6469 6361 6e63  stic signidicanc
-00021120: 6520 7661 6c75 652e 0a0a 2020 2020 2020  e value...      
-00021130: 2020 3a65 7861 6d70 6c65 3a0a 2020 2020    :example:.    
-00021140: 2020 2020 3e3e 3e20 6461 7461 203d 206e      >>> data = n
-00021150: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
-00021160: 2830 2c20 322c 2028 3130 3030 3030 2c20  (0, 2, (100000, 
-00021170: 3429 290a 2020 2020 2020 2020 3e3e 3e20  4)).        >>> 
-00021180: 5374 6174 6973 7469 6373 2e63 6f63 6872  Statistics.cochr
-00021190: 616e 735f 7128 6461 7461 3d64 6174 6129  ans_q(data=data)
-000211a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000211b0: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
-000211c0: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-000211d0: 2020 2020 6461 7461 3d64 6174 612c 2073      data=data, s
-000211e0: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
-000211f0: 2e63 6f63 6872 616e 735f 712e 5f5f 6e61  .cochrans_q.__na
-00021200: 6d65 5f5f 2c20 6163 6365 7074 6564 5f6e  me__, accepted_n
-00021210: 6469 6d73 3d28 322c 290a 2020 2020 2020  dims=(2,).      
-00021220: 2020 290a 2020 2020 2020 2020 6164 6469    ).        addi
-00021230: 7469 6f6e 616c 203d 206c 6973 7428 7365  tional = list(se
-00021240: 7428 6c69 7374 286e 702e 736f 7274 286e  t(list(np.sort(n
-00021250: 702e 756e 6971 7565 2864 6174 6129 2929  p.unique(data)))
-00021260: 2920 2d20 7b30 2c20 317d 290a 2020 2020  ) - {0, 1}).    
-00021270: 2020 2020 6966 206c 656e 2861 6464 6974      if len(addit
-00021280: 696f 6e61 6c29 203e 2030 3a0a 2020 2020  ional) > 0:.    
-00021290: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
-000212a0: 7661 6c69 6449 6e70 7574 4572 726f 7228  validInputError(
-000212b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000212c0: 206d 7367 3d66 2243 6f63 6872 616e 7320   msg=f"Cochrans 
-000212d0: 5120 7265 7175 6972 6573 2062 696e 6172  Q requires binar
-000212e0: 7920 696e 7075 7420 6461 7461 2062 7574  y input data but
-000212f0: 2066 6f75 6e64 207b 6164 6469 7469 6f6e   found {addition
-00021300: 616c 7d22 2c0a 2020 2020 2020 2020 2020  al}",.          
-00021310: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-00021320: 7469 7374 6963 732e 636f 6368 7261 6e73  tistics.cochrans
-00021330: 5f71 2e5f 5f6e 616d 655f 5f2c 0a20 2020  _q.__name__,.   
-00021340: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00021350: 2020 2063 6f6c 5f73 756d 7320 3d20 6e70     col_sums = np
-00021360: 2e73 756d 2864 6174 612c 2061 7869 733d  .sum(data, axis=
-00021370: 3029 0a20 2020 2020 2020 2072 6f77 5f73  0).        row_s
-00021380: 756d 5f73 756d 203d 206e 702e 7375 6d28  um_sum = np.sum(
-00021390: 6e70 2e73 756d 2864 6174 612c 2061 7869  np.sum(data, axi
-000213a0: 733d 3129 290a 2020 2020 2020 2020 726f  s=1)).        ro
-000213b0: 775f 7375 6d5f 7371 7561 7265 5f73 756d  w_sum_square_sum
-000213c0: 203d 206e 702e 7375 6d28 6e70 2e73 7175   = np.sum(np.squ
-000213d0: 6172 6528 6e70 2e73 756d 2864 6174 612c  are(np.sum(data,
-000213e0: 2061 7869 733d 3129 2929 0a20 2020 2020   axis=1))).     
-000213f0: 2020 206b 203d 2064 6174 612e 7368 6170     k = data.shap
-00021400: 655b 315d 0a20 2020 2020 2020 2067 3220  e[1].        g2 
-00021410: 3d20 6e70 2e73 756d 2873 756d 286e 702e  = np.sum(sum(np.
-00021420: 7371 7561 7265 2863 6f6c 5f73 756d 7329  square(col_sums)
-00021430: 2929 0a20 2020 2020 2020 206e 6f6d 696e  )).        nomin
-00021440: 6174 6f72 203d 2028 6b20 2d20 3129 202a  ator = (k - 1) *
-00021450: 2028 286b 202a 2067 3229 202d 206e 702e   ((k * g2) - np.
-00021460: 7371 7561 7265 286e 702e 7375 6d28 636f  square(np.sum(co
-00021470: 6c5f 7375 6d73 2929 290a 2020 2020 2020  l_sums))).      
-00021480: 2020 6465 6e6f 6d69 6e61 746f 7220 3d20    denominator = 
-00021490: 286b 202a 2072 6f77 5f73 756d 5f73 756d  (k * row_sum_sum
-000214a0: 2920 2d20 726f 775f 7375 6d5f 7371 7561  ) - row_sum_squa
-000214b0: 7265 5f73 756d 0a20 2020 2020 2020 2069  re_sum.        i
-000214c0: 6620 6e6f 6d69 6e61 746f 7220 3d3d 2030  f nominator == 0
-000214d0: 206f 7220 6465 6e6f 6d69 6e61 746f 7220   or denominator 
-000214e0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-000214f0: 2020 7265 7475 726e 202d 312e 302c 202d    return -1.0, -
-00021500: 312e 300a 2020 2020 2020 2020 656c 7365  1.0.        else
-00021510: 3a0a 2020 2020 2020 2020 2020 2020 7120  :.            q 
-00021520: 3d20 286e 6f6d 696e 6174 6f72 202f 2064  = (nominator / d
-00021530: 656e 6f6d 696e 6174 6f72 2c29 0a20 2020  enominator,).   
-00021540: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00021550: 712c 2073 7461 7473 2e63 6869 322e 7366  q, stats.chi2.sf
-00021560: 2871 2c20 6b20 2d20 3129 0a0a 2020 2020  (q, k - 1)..    
-00021570: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-00021580: 2020 6465 6620 6861 7274 6c65 795f 666d    def hartley_fm
-00021590: 6178 2878 3a20 6e70 2e6e 6461 7272 6179  ax(x: np.ndarray
-000215a0: 2c20 793a 206e 702e 6e64 6172 7261 7929  , y: np.ndarray)
-000215b0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000215c0: 2020 2020 2020 436f 6d70 7574 6520 4861        Compute Ha
-000215d0: 7274 6c65 7927 7320 466d 6178 2073 7461  rtley's Fmax sta
-000215e0: 7469 7374 6963 2074 6f20 7465 7374 2066  tistic to test f
-000215f0: 6f72 2065 7175 616c 6974 7920 6f66 2076  or equality of v
-00021600: 6172 6961 6e63 6573 2062 6574 7765 656e  ariances between
-00021610: 2074 776f 2066 6561 7475 7265 7320 6f72   two features or
-00021620: 2067 726f 7570 732e 0a0a 2020 2020 2020   groups...      
-00021630: 2020 5661 6c75 6573 2063 6c6f 7365 2074    Values close t
-00021640: 6f20 6f6e 6520 7265 7072 6573 656e 7473  o one represents
-00021650: 2063 6c6f 7365 7220 746f 2065 7175 616c   closer to equal
-00021660: 2076 6172 6961 6e63 652e 0a0a 2020 2020   variance...    
-00021670: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
-00021680: 6172 7261 7920 783a 2031 4420 6172 7261  array x: 1D arra
-00021690: 7920 7265 7072 6573 656e 7469 6e67 206e  y representing n
-000216a0: 756d 6572 6963 2064 6174 6120 6f66 2074  umeric data of t
-000216b0: 6865 2066 6972 7374 2067 726f 7570 2f66  he first group/f
-000216c0: 6561 7475 7265 2e0a 2020 2020 2020 2020  eature..        
-000216d0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-000216e0: 7920 783a 2031 4420 6172 7261 7920 7265  y x: 1D array re
-000216f0: 7072 6573 656e 7469 6e67 206e 756d 6572  presenting numer
-00021700: 6963 2064 6174 6120 6f66 2074 6865 2073  ic data of the s
-00021710: 6563 6f6e 6420 6772 6f75 702f 6665 6174  econd group/feat
-00021720: 7572 652e 0a0a 2020 2020 2020 2020 3a65  ure...        :e
-00021730: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
-00021740: 3e3e 3e20 7820 3d20 6e70 2e72 616e 646f  >>> x = np.rando
-00021750: 6d2e 7261 6e64 6f6d 2828 3130 302c 2929  m.random((100,))
-00021760: 0a20 2020 2020 2020 203e 3e3e 2079 203d  .        >>> y =
-00021770: 206e 702e 7261 6e64 6f6d 2e72 616e 646f   np.random.rando
-00021780: 6d28 2831 3030 2c29 290a 2020 2020 2020  m((100,)).      
-00021790: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
-000217a0: 2e68 6172 746c 6579 5f66 6d61 7828 783d  .hartley_fmax(x=
-000217b0: 782c 2079 3d79 290a 2020 2020 2020 2020  x, y=y).        
-000217c0: 2222 220a 2020 2020 2020 2020 6368 6563  """.        chec
-000217d0: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
-000217e0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-000217f0: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
-00021800: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
-00021810: 2e68 6172 746c 6579 5f66 6d61 782e 5f5f  .hartley_fmax.__
-00021820: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
-00021830: 2020 2020 6163 6365 7074 6564 5f6e 6469      accepted_ndi
-00021840: 6d73 3d28 312c 292c 0a20 2020 2020 2020  ms=(1,),.       
-00021850: 2020 2020 2061 6363 6570 7465 645f 6474       accepted_dt
-00021860: 7970 6573 3d28 6e70 2e66 6c6f 6174 3332  ypes=(np.float32
-00021870: 2c20 6e70 2e66 6c6f 6174 3634 2c20 6e70  , np.float64, np
-00021880: 2e69 6e74 3634 2c20 6e70 2e66 6c6f 6174  .int64, np.float
-00021890: 3332 292c 0a20 2020 2020 2020 2029 0a20  32),.        ). 
-000218a0: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
-000218b0: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
-000218c0: 2020 2020 2020 6461 7461 3d79 2c0a 2020        data=y,.  
-000218d0: 2020 2020 2020 2020 2020 736f 7572 6365            source
-000218e0: 3d53 7461 7469 7374 6963 732e 6861 7274  =Statistics.hart
-000218f0: 6c65 795f 666d 6178 2e5f 5f6e 616d 655f  ley_fmax.__name_
-00021900: 5f2c 0a20 2020 2020 2020 2020 2020 2061  _,.            a
-00021910: 6363 6570 7465 645f 6e64 696d 733d 2831  ccepted_ndims=(1
-00021920: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
-00021930: 6163 6365 7074 6564 5f64 7479 7065 733d  accepted_dtypes=
-00021940: 286e 702e 666c 6f61 7433 322c 206e 702e  (np.float32, np.
-00021950: 666c 6f61 7436 342c 206e 702e 696e 7436  float64, np.int6
-00021960: 342c 206e 702e 666c 6f61 7433 3229 2c0a  4, np.float32),.
-00021970: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00021980: 2020 6d61 785f 7661 7220 3d20 6e70 2e6d    max_var = np.m
-00021990: 6178 2828 6e70 2e76 6172 2878 292c 206e  ax((np.var(x), n
-000219a0: 702e 7661 7228 7929 2929 0a20 2020 2020  p.var(y))).     
-000219b0: 2020 206d 696e 5f76 6172 203d 206e 702e     min_var = np.
-000219c0: 6d69 6e28 286e 702e 7661 7228 7829 2c20  min((np.var(x), 
-000219d0: 6e70 2e76 6172 2879 2929 290a 2020 2020  np.var(y))).    
-000219e0: 2020 2020 6966 2028 6d61 785f 7661 7220      if (max_var 
-000219f0: 3d3d 2030 2920 6f72 2028 6d69 6e5f 7661  == 0) or (min_va
-00021a00: 7220 3d3d 2030 293a 0a20 2020 2020 2020  r == 0):.       
-00021a10: 2020 2020 2072 6574 7572 6e20 2d31 2e30       return -1.0
-00021a20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00021a30: 6d61 785f 7661 7220 2f20 6d69 6e5f 7661  max_var / min_va
-00021a40: 720a 0a20 2020 2040 7374 6174 6963 6d65  r..    @staticme
-00021a50: 7468 6f64 0a20 2020 2064 6566 2067 7275  thod.    def gru
-00021a60: 6262 735f 7465 7374 2878 3a20 6e70 2e6e  bbs_test(x: np.n
-00021a70: 6461 7272 6179 2c20 6c65 6674 5f74 6169  darray, left_tai
-00021a80: 6c3a 204f 7074 696f 6e61 6c5b 626f 6f6c  l: Optional[bool
-00021a90: 5d20 3d20 4661 6c73 6529 202d 3e20 666c  ] = False) -> fl
-00021aa0: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
-00021ab0: 0a20 2020 2020 2020 2050 6572 666f 726d  .        Perform
-00021ac0: 2047 7275 6262 7327 2074 6573 7420 746f   Grubbs' test to
-00021ad0: 2064 6574 6563 7420 6f75 746c 6965 7273   detect outliers
-00021ae0: 2069 6620 7468 6520 6d69 6e69 6d75 6d20   if the minimum 
-00021af0: 6f72 206d 6178 696d 756d 2076 616c 7565  or maximum value
-00021b00: 2069 6e20 6120 6665 6174 7572 6520 7365   in a feature se
-00021b10: 7269 6573 2069 7320 616e 206f 7574 6c69  ries is an outli
-00021b20: 6572 2e0a 0a20 2020 2020 2020 203a 7061  er...        :pa
-00021b30: 7261 6d20 6e70 2e6e 6461 7272 6179 2078  ram np.ndarray x
-00021b40: 3a20 3144 2061 7272 6179 2072 6570 7265  : 1D array repre
-00021b50: 7365 6e74 696e 6720 6e75 6d65 7269 6320  senting numeric 
-00021b60: 6461 7461 2e0a 2020 2020 2020 2020 3a70  data..        :p
-00021b70: 6172 616d 204f 7074 696f 6e61 6c5b 626f  aram Optional[bo
-00021b80: 6f6c 5d20 6c65 6674 5f74 6169 6c3a 2049  ol] left_tail: I
-00021b90: 6620 5472 7565 2c20 7468 6520 7465 7374  f True, the test
-00021ba0: 2063 616c 6375 6c61 7465 7320 7468 6520   calculates the 
-00021bb0: 4772 7562 6273 2720 7465 7374 2073 7461  Grubbs' test sta
-00021bc0: 7469 7374 6963 2066 6f72 2074 6865 206c  tistic for the l
-00021bd0: 6566 7420 7461 696c 2028 6d69 6e69 6d75  eft tail (minimu
-00021be0: 6d20 7661 6c75 6529 2e20 4966 2046 616c  m value). If Fal
-00021bf0: 7365 2028 6465 6661 756c 7429 2c20 6974  se (default), it
-00021c00: 2063 616c 6375 6c61 7465 7320 7468 6520   calculates the 
-00021c10: 7374 6174 6973 7469 6320 666f 7220 7468  statistic for th
-00021c20: 6520 7269 6768 7420 7461 696c 2028 6d61  e right tail (ma
-00021c30: 7869 6d75 6d20 7661 6c75 6529 2e0a 2020  ximum value)..  
-00021c40: 2020 2020 2020 3a72 6574 7572 6e20 666c        :return fl
-00021c50: 6f61 743a 2054 6865 2063 6f6d 7075 7465  oat: The compute
-00021c60: 6420 4772 7562 6273 2720 7465 7374 2073  d Grubbs' test s
-00021c70: 7461 7469 7374 6963 2e0a 0a20 2020 2020  tatistic...     
-00021c80: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
-00021c90: 2020 2020 203e 3e3e 2078 203d 206e 702e       >>> x = np.
-00021ca0: 7261 6e64 6f6d 2e72 616e 646f 6d28 2831  random.random((1
-00021cb0: 3030 2c29 290a 2020 2020 2020 2020 3e3e  00,)).        >>
-00021cc0: 3e20 5374 6174 6973 7469 6373 2e67 7275  > Statistics.gru
-00021cd0: 6262 735f 7465 7374 2878 3d78 290a 2020  bbs_test(x=x).  
-00021ce0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00021cf0: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
-00021d00: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
-00021d10: 2064 6174 613d 782c 0a20 2020 2020 2020   data=x,.       
-00021d20: 2020 2020 2073 6f75 7263 653d 5374 6174       source=Stat
-00021d30: 6973 7469 6373 2e67 7275 6262 735f 7465  istics.grubbs_te
-00021d40: 7374 2e5f 5f6e 616d 655f 5f2c 0a20 2020  st.__name__,.   
-00021d50: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-00021d60: 645f 6e64 696d 733d 2831 2c29 2c0a 2020  d_ndims=(1,),.  
-00021d70: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-00021d80: 6564 5f64 7479 7065 733d 286e 702e 666c  ed_dtypes=(np.fl
-00021d90: 6f61 7433 322c 206e 702e 666c 6f61 7436  oat32, np.float6
-00021da0: 342c 206e 702e 696e 7436 342c 206e 702e  4, np.int64, np.
-00021db0: 666c 6f61 7433 3229 2c0a 2020 2020 2020  float32),.      
-00021dc0: 2020 290a 2020 2020 2020 2020 7820 3d20    ).        x = 
-00021dd0: 6e70 2e73 6f72 7428 7829 0a20 2020 2020  np.sort(x).     
-00021de0: 2020 2069 6620 6c65 6674 5f74 6169 6c3a     if left_tail:
-00021df0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00021e00: 7572 6e20 286e 702e 6d65 616e 2878 2920  urn (np.mean(x) 
-00021e10: 2d20 6e70 2e6d 696e 2878 2929 202f 206e  - np.min(x)) / n
-00021e20: 702e 7374 6428 7829 0a20 2020 2020 2020  p.std(x).       
-00021e30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00021e40: 2020 2072 6574 7572 6e20 286e 702e 6d61     return (np.ma
-00021e50: 7828 7829 202d 206e 702e 6d65 616e 2878  x(x) - np.mean(x
-00021e60: 2929 202f 206e 702e 7374 6428 7829 0a0a  )) / np.std(x)..
-00021e70: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00021e80: 640a 2020 2020 6465 6620 7769 6c63 6f78  d.    def wilcox
-00021e90: 6f6e 2878 3a20 6e70 2e6e 6461 7272 6179  on(x: np.ndarray
-00021ea0: 2c20 793a 206e 702e 6e64 6172 7261 7929  , y: np.ndarray)
-00021eb0: 3a0a 2020 2020 2020 2020 2222 224e 6f6e  :.        """Non
-00021ec0: 2d70 6172 616d 6574 7269 6320 7477 6f2d  -parametric two-
-00021ed0: 7761 7920 7769 7468 696e 2d73 7562 6a65  way within-subje
-00021ee0: 6374 7320 7465 7374 2222 220a 2020 2020  cts test""".    
-00021ef0: 2020 2020 6461 7461 203d 206e 702e 6873      data = np.hs
-00021f00: 7461 636b 2828 782e 7265 7368 6170 6528  tack((x.reshape(
-00021f10: 2d31 2c20 3129 2c20 792e 7265 7368 6170  -1, 1), y.reshap
-00021f20: 6528 2d31 2c20 3129 2929 0a20 2020 2020  e(-1, 1))).     
-00021f30: 2020 206e 203d 2064 6174 612e 7368 6170     n = data.shap
-00021f40: 655b 305d 0a20 2020 2020 2020 2064 6966  e[0].        dif
-00021f50: 6620 3d20 6e70 2e64 6966 6628 6461 7461  f = np.diff(data
-00021f60: 292e 666c 6174 7465 6e28 290a 2020 2020  ).flatten().    
-00021f70: 2020 2020 6469 6666 5f61 6273 203d 206e      diff_abs = n
-00021f80: 702e 6162 7328 6469 6666 290a 2020 2020  p.abs(diff).    
-00021f90: 2020 2020 7261 6e6b 5f77 5f74 6965 7320      rank_w_ties 
-00021fa0: 3d20 6661 7374 5f6d 6561 6e5f 7261 6e6b  = fast_mean_rank
-00021fb0: 2864 6174 613d 6469 6666 5f61 6273 2c20  (data=diff_abs, 
-00021fc0: 6465 7363 656e 6469 6e67 3d46 616c 7365  descending=False
-00021fd0: 290a 2020 2020 2020 2020 7369 676e 6564  ).        signed
-00021fe0: 5f72 616e 6b5f 775f 7469 6573 203d 206e  _rank_w_ties = n
-00021ff0: 702e 6675 6c6c 2828 7261 6e6b 5f77 5f74  p.full((rank_w_t
-00022000: 6965 732e 7368 6170 655b 305d 292c 206e  ies.shape[0]), n
-00022010: 702e 6e61 6e29 0a20 2020 2020 2020 2074  p.nan).        t
-00022020: 5f70 6c75 732c 2074 5f6d 696e 7573 203d  _plus, t_minus =
-00022030: 2030 2c20 300a 0a20 2020 2020 2020 2066   0, 0..        f
-00022040: 6f72 2069 2069 6e20 7261 6e67 6528 6469  or i in range(di
-00022050: 6666 2e73 6861 7065 5b30 5d29 3a0a 2020  ff.shape[0]):.  
-00022060: 2020 2020 2020 2020 2020 6966 2064 6966            if dif
-00022070: 665b 695d 203c 2030 3a0a 2020 2020 2020  f[i] < 0:.      
-00022080: 2020 2020 2020 2020 2020 7369 676e 6564            signed
-00022090: 5f72 616e 6b5f 775f 7469 6573 5b69 5d20  _rank_w_ties[i] 
-000220a0: 3d20 2d72 616e 6b5f 775f 7469 6573 5b69  = -rank_w_ties[i
-000220b0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000220c0: 2020 745f 6d69 6e75 7320 2b3d 206e 702e    t_minus += np.
-000220d0: 6162 7328 7261 6e6b 5f77 5f74 6965 735b  abs(rank_w_ties[
-000220e0: 695d 290a 2020 2020 2020 2020 2020 2020  i]).            
-000220f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00022100: 2020 2020 2020 7369 676e 6564 5f72 616e        signed_ran
-00022110: 6b5f 775f 7469 6573 5b69 5d20 3d20 7261  k_w_ties[i] = ra
-00022120: 6e6b 5f77 5f74 6965 735b 695d 0a20 2020  nk_w_ties[i].   
-00022130: 2020 2020 2020 2020 2020 2020 2074 5f70               t_p
-00022140: 6c75 7320 2b3d 206e 702e 6162 7328 7261  lus += np.abs(ra
-00022150: 6e6b 5f77 5f74 6965 735b 695d 290a 2020  nk_w_ties[i]).  
-00022160: 2020 2020 2020 755f 7720 3d20 286e 202a        u_w = (n *
-00022170: 2028 6e20 2b20 3129 2920 2f20 340a 2020   (n + 1)) / 4.  
-00022180: 2020 2020 2020 7374 645f 636f 7272 6563        std_correc
-00022190: 7469 6f6e 203d 2030 0a20 2020 2020 2020  tion = 0.       
-000221a0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-000221b0: 7369 676e 6564 5f72 616e 6b5f 775f 7469  signed_rank_w_ti
-000221c0: 6573 2e73 6861 7065 5b30 5d29 3a0a 2020  es.shape[0]):.  
-000221d0: 2020 2020 2020 2020 2020 7361 6d65 5f72            same_r
-000221e0: 616e 6b5f 6e20 3d20 280a 2020 2020 2020  ank_n = (.      
-000221f0: 2020 2020 2020 2020 2020 6e70 2e61 7267            np.arg
-00022200: 7768 6572 6528 7369 676e 6564 5f72 616e  where(signed_ran
-00022210: 6b5f 775f 7469 6573 203d 3d20 7369 676e  k_w_ties == sign
-00022220: 6564 5f72 616e 6b5f 775f 7469 6573 5b69  ed_rank_w_ties[i
-00022230: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-00022240: 2020 202e 666c 6174 7465 6e28 290a 2020     .flatten().  
-00022250: 2020 2020 2020 2020 2020 2020 2020 2e73                .s
-00022260: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
-00022270: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00022280: 2020 6966 2073 616d 655f 7261 6e6b 5f6e    if same_rank_n
-00022290: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
-000222a0: 2020 2020 2020 7374 645f 636f 7272 6563        std_correc
-000222b0: 7469 6f6e 202b 3d20 2828 7361 6d65 5f72  tion += ((same_r
-000222c0: 616e 6b5f 6e2a 2a33 2920 2d20 7361 6d65  ank_n**3) - same
-000222d0: 5f72 616e 6b5f 6e29 202f 2032 0a0a 2020  _rank_n) / 2..  
-000222e0: 2020 2020 2020 7374 6420 3d20 6e70 2e73        std = np.s
-000222f0: 7172 7428 2828 6e20 2a20 286e 202b 2031  qrt(((n * (n + 1
-00022300: 2929 202a 2028 2832 202a 206e 2920 2b20  )) * ((2 * n) + 
-00022310: 3129 202d 2073 7464 5f63 6f72 7265 6374  1) - std_correct
-00022320: 696f 6e29 202f 2032 3429 0a20 2020 2020  ion) / 24).     
-00022330: 2020 2057 203d 206e 702e 6d69 6e28 2874     W = np.min((t
-00022340: 5f70 6c75 732c 2074 5f6d 696e 7573 2929  _plus, t_minus))
-00022350: 0a20 2020 2020 2020 207a 203d 2028 5720  .        z = (W 
-00022360: 2d20 755f 7729 202f 2073 7464 0a20 2020  - u_w) / std.   
-00022370: 2020 2020 2072 203d 207a 202f 206e 702e       r = z / np.
-00022380: 7371 7274 286e 290a 2020 2020 2020 2020  sqrt(n).        
-00022390: 7265 7475 726e 207a 2c20 720a 0a20 2020  return z, r..   
-000223a0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-000223b0: 2020 2040 6e6a 6974 280a 2020 2020 2020     @njit(.      
-000223c0: 2020 2228 666c 6f61 7433 325b 3a2c 3a5d    "(float32[:,:]
-000223d0: 2c20 2922 2c0a 2020 2020 290a 2020 2020  , )",.    ).    
-000223e0: 6465 6620 636f 765f 6d61 7472 6978 2864  def cov_matrix(d
-000223f0: 6174 613a 206e 702e 6e64 6172 7261 7929  ata: np.ndarray)
-00022400: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00022410: 2020 2020 2020 4a69 7474 6564 2068 656c        Jitted hel
-00022420: 7065 7220 746f 2063 6f6d 7075 7465 2074  per to compute t
-00022430: 6865 2063 6f76 6172 6961 6e63 6520 6d61  he covariance ma
-00022440: 7472 6978 206f 6620 7468 6520 696e 7075  trix of the inpu
-00022450: 7420 6461 7461 2e20 4865 6c70 6572 2066  t data. Helper f
-00022460: 6f72 2063 6f6d 7075 7469 6e67 2063 726f  or computing cro
-00022470: 6e62 6163 6820 616c 7068 612c 0a20 2020  nbach alpha,.   
-00022480: 2020 2020 206d 756c 7469 7661 7269 6174       multivariat
-00022490: 6520 616e 616c 7973 6973 2c20 616e 6420  e analysis, and 
-000224a0: 6469 7374 616e 6365 2063 6f6d 7075 7461  distance computa
-000224b0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-000224c0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-000224d0: 7920 6461 7461 3a20 322d 6469 6d65 6e73  y data: 2-dimens
-000224e0: 696f 6e61 6c20 6e75 6d70 7920 6172 7261  ional numpy arra
-000224f0: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
-00022500: 6865 2069 6e70 7574 2064 6174 6120 7769  he input data wi
-00022510: 7468 2073 6861 7065 2028 6e2c 206d 292c  th shape (n, m),
-00022520: 2077 6865 7265 206e 2069 7320 7468 6520   where n is the 
-00022530: 6e75 6d62 6572 206f 6620 6f62 7365 7276  number of observ
-00022540: 6174 696f 6e73 2061 6e64 206d 2069 7320  ations and m is 
-00022550: 7468 6520 6e75 6d62 6572 206f 6620 6665  the number of fe
-00022560: 6174 7572 6573 2e0a 2020 2020 2020 2020  atures..        
-00022570: 3a72 6574 7572 6e3a 2043 6f76 6172 6961  :return: Covaria
-00022580: 6e63 6520 6d61 7472 6978 206f 6620 7468  nce matrix of th
-00022590: 6520 696e 7075 7420 6461 7461 2077 6974  e input data wit
-000225a0: 6820 7368 6170 6520 286d 2c20 6d29 2e20  h shape (m, m). 
-000225b0: 5468 6520 2869 2c20 6a29 2d74 6820 656c  The (i, j)-th el
-000225c0: 656d 656e 7420 6f66 2074 6865 206d 6174  ement of the mat
-000225d0: 7269 7820 7265 7072 6573 656e 7473 2074  rix represents t
-000225e0: 6865 2063 6f76 6172 6961 6e63 6520 6265  he covariance be
-000225f0: 7477 6565 6e20 7468 6520 692d 7468 2061  tween the i-th a
-00022600: 6e64 206a 2d74 6820 6665 6174 7572 6573  nd j-th features
-00022610: 2069 6e20 7468 6520 6461 7461 2e0a 0a20   in the data... 
-00022620: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
-00022630: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
-00022640: 6120 3d20 6e70 2e72 616e 646f 6d2e 7261  a = np.random.ra
-00022650: 6e64 696e 7428 302c 322c 2028 3230 302c  ndint(0,2, (200,
-00022660: 2034 3029 292e 6173 7479 7065 286e 702e   40)).astype(np.
-00022670: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
-00022680: 203e 3e3e 2063 6f76 6172 6961 6e63 655f   >>> covariance_
-00022690: 6d61 7472 6978 203d 2053 7461 7469 7374  matrix = Statist
-000226a0: 6963 732e 636f 765f 6d61 7472 6978 2864  ics.cov_matrix(d
-000226b0: 6174 613d 6461 7461 290a 2020 2020 2020  ata=data).      
-000226c0: 2020 2222 220a 2020 2020 2020 2020 6e2c    """.        n,
-000226d0: 206d 203d 2064 6174 612e 7368 6170 650a   m = data.shape.
-000226e0: 2020 2020 2020 2020 636f 7620 3d20 6e70          cov = np
-000226f0: 2e66 756c 6c28 286d 2c20 6d29 2c20 302e  .full((m, m), 0.
-00022700: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
-00022710: 2069 6e20 7072 616e 6765 286d 293a 0a20   in prange(m):. 
-00022720: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
-00022730: 6920 3d20 6e70 2e73 756d 2864 6174 615b  i = np.sum(data[
-00022740: 3a2c 2069 5d29 202f 206e 0a20 2020 2020  :, i]) / n.     
-00022750: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-00022760: 7261 6e67 6528 6d29 3a0a 2020 2020 2020  range(m):.      
-00022770: 2020 2020 2020 2020 2020 6d65 616e 5f6a            mean_j
-00022780: 203d 206e 702e 7375 6d28 6461 7461 5b3a   = np.sum(data[:
-00022790: 2c20 6a5d 2920 2f20 6e0a 2020 2020 2020  , j]) / n.      
-000227a0: 2020 2020 2020 2020 2020 636f 765b 692c            cov[i,
-000227b0: 206a 5d20 3d20 6e70 2e73 756d 2828 6461   j] = np.sum((da
-000227c0: 7461 5b3a 2c20 695d 202d 206d 6561 6e5f  ta[:, i] - mean_
-000227d0: 6929 202a 2028 6461 7461 5b3a 2c20 6a5d  i) * (data[:, j]
-000227e0: 202d 206d 6561 6e5f 6a29 2920 2f20 280a   - mean_j)) / (.
-000227f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022800: 2020 2020 6e20 2d20 310a 2020 2020 2020      n - 1.      
-00022810: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00022820: 2020 2020 7265 7475 726e 2063 6f76 0a0a      return cov..
-00022830: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00022840: 640a 2020 2020 406e 6a69 7428 2228 666c  d.    @njit("(fl
-00022850: 6f61 7433 325b 3a5d 2c20 666c 6f61 7436  oat32[:], float6
-00022860: 342c 2922 290a 2020 2020 6465 6620 6d61  4,)").    def ma
-00022870: 645f 6d65 6469 616e 5f72 756c 6528 6461  d_median_rule(da
-00022880: 7461 3a20 6e70 2e6e 6461 7272 6179 2c20  ta: np.ndarray, 
-00022890: 6b3a 2069 6e74 2920 2d3e 206e 702e 6e64  k: int) -> np.nd
-000228a0: 6172 7261 793a 0a20 2020 2020 2020 2022  array:.        "
-000228b0: 2222 0a20 2020 2020 2020 2044 6574 6563  "".        Detec
-000228c0: 7420 6f75 746c 6965 7273 2075 7369 6e67  t outliers using
-000228d0: 2074 6865 204d 4144 2d4d 6564 6961 6e20   the MAD-Median 
-000228e0: 5275 6c65 2e20 5265 7475 726e 7320 3164  Rule. Returns 1d
-000228f0: 2061 7272 6179 206f 6620 7369 7a65 2064   array of size d
-00022900: 6174 612e 7368 6170 655b 305d 2077 6974  ata.shape[0] wit
-00022910: 6820 3120 7265 7072 6573 656e 7469 6e67  h 1 representing
-00022920: 206f 7574 6c69 6572 2061 6e64 2030 2072   outlier and 0 r
-00022930: 6570 7265 7365 6e74 696e 6720 696e 6c69  epresenting inli
-00022940: 6572 2e0a 0a20 2020 2020 2020 203a 6578  er...        :ex
-00022950: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
-00022960: 3e3e 2064 6174 6120 3d20 6e70 2e72 616e  >> data = np.ran
-00022970: 646f 6d2e 7261 6e64 696e 7428 302c 2036  dom.randint(0, 6
-00022980: 3030 2c20 2839 3030 3030 3030 2c29 292e  00, (9000000,)).
-00022990: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
-000229a0: 3229 0a20 2020 2020 2020 203e 3e3e 2053  2).        >>> S
-000229b0: 7461 7469 7374 6963 732e 6d61 645f 6d65  tatistics.mad_me
-000229c0: 6469 616e 5f72 756c 6528 6461 7461 3d64  dian_rule(data=d
-000229d0: 6174 612c 206b 3d31 2e30 290a 2020 2020  ata, k=1.0).    
-000229e0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-000229f0: 206d 6564 6961 6e20 3d20 6e70 2e6d 6564   median = np.med
-00022a00: 6961 6e28 6461 7461 290a 2020 2020 2020  ian(data).      
-00022a10: 2020 6d61 6420 3d20 6e70 2e6d 6564 6961    mad = np.media
-00022a20: 6e28 6e70 2e61 6273 2864 6174 6120 2d20  n(np.abs(data - 
-00022a30: 6d65 6469 616e 2929 0a20 2020 2020 2020  median)).       
-00022a40: 2074 6872 6573 686f 6c64 203d 206b 202a   threshold = k *
-00022a50: 206d 6164 0a20 2020 2020 2020 206f 7574   mad.        out
-00022a60: 6c69 6572 7320 3d20 6e70 2e61 6273 2864  liers = np.abs(d
-00022a70: 6174 6120 2d20 6d65 6469 616e 2920 3e20  ata - median) > 
-00022a80: 7468 7265 7368 6f6c 640a 2020 2020 2020  threshold.      
-00022a90: 2020 7265 7475 726e 206f 7574 6c69 6572    return outlier
-00022aa0: 7320 2a20 310a 0a20 2020 2040 7374 6174  s * 1..    @stat
-00022ab0: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-00022ac0: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
-00022ad0: 2066 6c6f 6174 3634 2c20 666c 6f61 7436   float64, float6
-00022ae0: 345b 3a5d 2c20 666c 6f61 7436 3429 2229  4[:], float64)")
-00022af0: 0a20 2020 2064 6566 2073 6c69 6469 6e67  .    def sliding
-00022b00: 5f6d 6164 5f6d 6564 6961 6e5f 7275 6c65  _mad_median_rule
-00022b10: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
-00022b20: 6e70 2e6e 6461 7272 6179 2c20 6b3a 2069  np.ndarray, k: i
-00022b30: 6e74 2c20 7469 6d65 5f77 696e 646f 7773  nt, time_windows
-00022b40: 3a20 6e70 2e6e 6461 7272 6179 2c20 6670  : np.ndarray, fp
-00022b50: 733a 2066 6c6f 6174 0a20 2020 2029 202d  s: float.    ) -
-00022b60: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
-00022b70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00022b80: 2020 436f 756e 7420 7468 6520 6e75 6d62    Count the numb
-00022b90: 6572 206f 6620 6f75 746c 6965 7273 2069  er of outliers i
-00022ba0: 6e20 6120 736c 6964 696e 6720 7469 6d65  n a sliding time
-00022bb0: 2d77 696e 646f 7720 7573 696e 6720 7468  -window using th
-00022bc0: 6520 4d41 442d 4d65 6469 616e 2052 756c  e MAD-Median Rul
-00022bd0: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
-00022be0: 616d 206e 702e 6e64 6172 7261 7920 6461  am np.ndarray da
-00022bf0: 7461 3a20 3144 206e 756d 6572 6963 616c  ta: 1D numerical
-00022c00: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
-00022c10: 696e 6720 6665 6174 7572 652e 0a20 2020  ing feature..   
-00022c20: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
-00022c30: 6b3a 2054 6865 206f 7574 6c69 6572 2074  k: The outlier t
-00022c40: 6872 6573 686f 6c64 2064 6566 696e 6564  hreshold defined
-00022c50: 2061 7320 6b20 2a20 6d65 6469 616e 2061   as k * median a
-00022c60: 6273 6f6c 7574 6520 6465 7669 6174 696f  bsolute deviatio
-00022c70: 6e20 696e 2065 6163 6820 7469 6d65 2077  n in each time w
-00022c80: 696e 646f 772e 0a20 2020 2020 2020 203a  indow..        :
-00022c90: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-00022ca0: 2074 696d 655f 7769 6e64 6f77 733a 2031   time_windows: 1
-00022cb0: 4420 6172 7261 7920 6f66 2074 696d 6520  D array of time 
-00022cc0: 7769 6e64 6f77 2073 697a 6573 2069 6e20  window sizes in 
-00022cd0: 7365 636f 6e64 732e 0a20 2020 2020 2020  seconds..       
-00022ce0: 203a 7061 7261 6d20 666c 6f61 7420 6670   :param float fp
-00022cf0: 733a 2054 6865 2066 7265 7175 656e 6379  s: The frequency
-00022d00: 206f 6620 7468 6520 7369 676e 616c 2e0a   of the signal..
-00022d10: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-00022d20: 6e70 2e6e 6461 7272 6179 3a20 4172 7261  np.ndarray: Arra
-00022d30: 7920 6f66 2073 697a 6520 2864 6174 612e  y of size (data.
-00022d40: 7368 6170 655b 305d 2c20 7469 6d65 5f77  shape[0], time_w
-00022d50: 696e 646f 7773 2e73 6861 7065 5b30 5d29  indows.shape[0])
-00022d60: 2077 6974 6820 636f 756e 7473 2069 6620   with counts if 
-00022d70: 6f75 746c 6965 7273 2064 6574 6563 7465  outliers detecte
-00022d80: 642e 0a0a 2020 2020 2020 2020 3a65 7861  d...        :exa
-00022d90: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00022da0: 3e20 6461 7461 203d 206e 702e 7261 6e64  > data = np.rand
-00022db0: 6f6d 2e72 616e 6469 6e74 2830 2c20 3530  om.randint(0, 50
-00022dc0: 2c20 2835 3030 3030 2c29 292e 6173 7479  , (50000,)).asty
-00022dd0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
-00022de0: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-00022df0: 7374 6963 732e 736c 6964 696e 675f 6d61  stics.sliding_ma
-00022e00: 645f 6d65 6469 616e 5f72 756c 6528 6461  d_median_rule(da
-00022e10: 7461 3d64 6174 612c 206b 3d32 2c20 7469  ta=data, k=2, ti
-00022e20: 6d65 5f77 696e 646f 7773 3d6e 702e 6172  me_windows=np.ar
-00022e30: 7261 7928 5b32 302e 305d 292c 2066 7073  ray([20.0]), fps
-00022e40: 3d31 2e30 290a 2020 2020 2020 2020 2222  =1.0).        ""
-00022e50: 220a 2020 2020 2020 2020 7265 7375 6c74  ".        result
-00022e60: 7320 3d20 6e70 2e66 756c 6c28 2864 6174  s = np.full((dat
-00022e70: 612e 7368 6170 655b 305d 2c20 7469 6d65  a.shape[0], time
-00022e80: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
-00022e90: 5d29 2c20 2d31 290a 2020 2020 2020 2020  ]), -1).        
-00022ea0: 666f 7220 7469 6d65 5f77 696e 646f 7720  for time_window 
-00022eb0: 696e 2074 696d 655f 7769 6e64 6f77 733a  in time_windows:
-00022ec0: 0a20 2020 2020 2020 2020 2020 2077 203d  .            w =
-00022ed0: 2069 6e74 2866 7073 202a 2074 696d 655f   int(fps * time_
-00022ee0: 7769 6e64 6f77 290a 2020 2020 2020 2020  window).        
-00022ef0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00022f00: 6765 2877 2c20 6461 7461 2e73 6861 7065  ge(w, data.shape
-00022f10: 5b30 5d20 2b20 312c 2031 293a 0a20 2020  [0] + 1, 1):.   
-00022f20: 2020 2020 2020 2020 2020 2020 2077 5f64               w_d
-00022f30: 6174 6120 3d20 6461 7461 5b69 202d 2077  ata = data[i - w
-00022f40: 203a 2069 5d0a 2020 2020 2020 2020 2020   : i].          
-00022f50: 2020 2020 2020 6d65 6469 616e 203d 206e        median = n
-00022f60: 702e 6d65 6469 616e 2877 5f64 6174 6129  p.median(w_data)
-00022f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022f80: 206d 6164 203d 206e 702e 6d65 6469 616e   mad = np.median
-00022f90: 286e 702e 6162 7328 775f 6461 7461 202d  (np.abs(w_data -
-00022fa0: 206d 6564 6961 6e29 290a 2020 2020 2020   median)).      
-00022fb0: 2020 2020 2020 2020 2020 7468 7265 7368            thresh
-00022fc0: 6f6c 6420 3d20 6b20 2a20 6d61 640a 2020  old = k * mad.  
-00022fd0: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00022fe0: 746c 6965 7273 203d 206e 702e 6162 7328  tliers = np.abs(
-00022ff0: 775f 6461 7461 202d 206d 6564 6961 6e29  w_data - median)
-00023000: 203e 2074 6872 6573 686f 6c64 0a20 2020   > threshold.   
-00023010: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00023020: 756c 7473 5b69 202d 2031 5d20 3d20 6e70  ults[i - 1] = np
-00023030: 2e73 756d 286f 7574 6c69 6572 7320 2a20  .sum(outliers * 
-00023040: 3129 0a20 2020 2020 2020 2072 6574 7572  1).        retur
-00023050: 6e20 7265 7375 6c74 730a 0a20 2020 2040  n results..    @
-00023060: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
-00023070: 2064 6566 2064 756e 6e5f 696e 6465 7828   def dunn_index(
-00023080: 783a 206e 702e 6e64 6172 7261 792c 2079  x: np.ndarray, y
-00023090: 3a20 6e70 2e6e 6461 7272 6179 2920 2d3e  : np.ndarray) ->
-000230a0: 2066 6c6f 6174 3a0a 2020 2020 2020 2020   float:.        
-000230b0: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
-000230c0: 756c 6174 6520 7468 6520 4475 6e6e 2069  ulate the Dunn i
-000230d0: 6e64 6578 2074 6f20 6576 616c 7561 7465  ndex to evaluate
-000230e0: 2074 6865 2071 7561 6c69 7479 206f 6620   the quality of 
-000230f0: 636c 7573 7465 7265 6420 6c61 6265 6c73  clustered labels
-00023100: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-00023110: 6675 6e63 7469 6f6e 2063 616c 6375 6c61  function calcula
-00023120: 7465 7320 7468 6520 4475 6e6e 2069 6e64  tes the Dunn ind
-00023130: 6578 2c20 7768 6963 6820 6973 2061 206d  ex, which is a m
-00023140: 6561 7375 7265 206f 6620 636c 7573 7465  easure of cluste
-00023150: 7269 6e67 2071 7561 6c69 7479 2e0a 2020  ring quality..  
-00023160: 2020 2020 2020 5468 6520 696e 6465 7820        The index 
-00023170: 636f 6e73 6964 6572 7320 7468 6520 7261  considers the ra
-00023180: 7469 6f20 6f66 2074 6865 206d 696e 696d  tio of the minim
-00023190: 756d 2069 6e74 6572 2d63 6c75 7374 6572  um inter-cluster
-000231a0: 2064 6973 7461 6e63 6520 746f 2074 6865   distance to the
-000231b0: 206d 6178 696d 756d 0a20 2020 2020 2020   maximum.       
-000231c0: 2069 6e74 7261 2d63 6c75 7374 6572 2064   intra-cluster d
-000231d0: 6973 7461 6e63 652e 2041 2068 6967 6865  istance. A highe
-000231e0: 7220 4475 6e6e 2069 6e64 6578 2069 6e64  r Dunn index ind
-000231f0: 6963 6174 6573 2062 6574 7465 7220 636c  icates better cl
-00023200: 7573 7465 7269 6e67 2e0a 0a20 2020 2020  ustering...     
-00023210: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
-00023220: 2020 2020 2020 2020 4d6f 6469 6669 6564          Modified
-00023230: 2066 726f 6d20 606a 716d 7669 6567 6173   from `jqmviegas
-00023240: 203c 6874 7470 733a 2f2f 6769 7468 7562   <https://github
-00023250: 2e63 6f6d 2f6a 716d 7669 6567 6173 2f6a  .com/jqmviegas/j
-00023260: 716d 5f63 7669 2f3e 605f 0a20 2020 2020  qm_cvi/>`_.     
-00023270: 2020 2020 2020 5769 6b69 2060 6874 7470        Wiki `http
-00023280: 733a 2f2f 656e 2e77 696b 6970 6564 6961  s://en.wikipedia
-00023290: 2e6f 7267 2f77 696b 692f 4475 6e6e 5f69  .org/wiki/Dunn_i
-000232a0: 6e64 6578 203c 6874 7470 733a 2f2f 656e  ndex <https://en
-000232b0: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
-000232c0: 696b 692f 4475 6e6e 5f69 6e64 6578 3e60  iki/Dunn_index>`
-000232d0: 5f0a 2020 2020 2020 2020 2020 2055 7365  _.           Use
-000232e0: 7320 4575 636c 6964 6561 6e20 6469 7374  s Euclidean dist
-000232f0: 616e 6365 732e 0a0a 2020 2020 2020 2020  ances...        
-00023300: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
-00023310: 7920 783a 2032 4420 6172 7261 7920 7265  y x: 2D array re
-00023320: 7072 6573 656e 7469 6e67 2074 6865 2064  presenting the d
-00023330: 6174 6120 706f 696e 7473 2e20 5368 6170  ata points. Shap
-00023340: 6520 286e 5f73 616d 706c 6573 2c20 6e5f  e (n_samples, n_
-00023350: 6665 6174 7572 6573 292e 0a20 2020 2020  features)..     
-00023360: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00023370: 7272 6179 2079 3a20 3244 2061 7272 6179  rray y: 2D array
-00023380: 2072 6570 7265 7365 6e74 696e 6720 636c   representing cl
-00023390: 7573 7465 7220 6c61 6265 6c73 2066 6f72  uster labels for
-000233a0: 2065 6163 6820 6461 7461 2070 6f69 6e74   each data point
-000233b0: 2e20 5368 6170 6520 286e 5f73 616d 706c  . Shape (n_sampl
-000233c0: 6573 2c29 2e0a 2020 2020 2020 2020 3a72  es,)..        :r
-000233d0: 6574 7572 6e20 666c 6f61 743a 2054 6865  eturn float: The
-000233e0: 2044 756e 6e20 696e 6465 7820 7661 6c75   Dunn index valu
-000233f0: 650a 0a20 2020 2020 2020 203a 6578 616d  e..        :exam
-00023400: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
-00023410: 2078 203d 206e 702e 7261 6e64 6f6d 2e72   x = np.random.r
-00023420: 616e 6469 6e74 2830 2c20 3130 302c 2028  andint(0, 100, (
-00023430: 3130 302c 2032 2929 0a20 2020 2020 2020  100, 2)).       
-00023440: 203e 3e3e 2079 203d 206e 702e 7261 6e64   >>> y = np.rand
-00023450: 6f6d 2e72 616e 6469 6e74 2830 2c20 332c  om.randint(0, 3,
-00023460: 2028 3130 302c 2929 0a20 2020 2020 2020   (100,)).       
-00023470: 203e 3e3e 2053 7461 7469 7374 6963 732e   >>> Statistics.
-00023480: 6475 6e6e 5f69 6e64 6578 2878 3d78 2c20  dunn_index(x=x, 
-00023490: 793d 7929 0a20 2020 2020 2020 2022 2222  y=y).        """
-000234a0: 0a0a 2020 2020 2020 2020 6368 6563 6b5f  ..        check_
-000234b0: 7661 6c69 645f 6172 7261 7928 0a20 2020  valid_array(.   
-000234c0: 2020 2020 2020 2020 2064 6174 613d 782c           data=x,
-000234d0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-000234e0: 7263 653d 5374 6174 6973 7469 6373 2e64  rce=Statistics.d
-000234f0: 756e 6e5f 696e 6465 782e 5f5f 6e61 6d65  unn_index.__name
-00023500: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
-00023510: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
-00023520: 322c 292c 0a20 2020 2020 2020 2020 2020  2,),.           
-00023530: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
-00023540: 3d28 696e 742c 2066 6c6f 6174 2c20 6e70  =(int, float, np
-00023550: 2e66 6c6f 6174 3634 2c20 6e70 2e66 6c6f  .float64, np.flo
-00023560: 6174 3332 2c20 6e70 2e69 6e74 3634 2c20  at32, np.int64, 
-00023570: 6e70 2e69 6e74 3332 292c 0a20 2020 2020  np.int32),.     
-00023580: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
-00023590: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
-000235a0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000235b0: 3d79 2c0a 2020 2020 2020 2020 2020 2020  =y,.            
-000235c0: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
-000235d0: 732e 6475 6e6e 5f69 6e64 6578 2e5f 5f6e  s.dunn_index.__n
-000235e0: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
-000235f0: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
-00023600: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
-00023610: 2020 2020 6163 6365 7074 6564 5f73 6861      accepted_sha
-00023620: 7065 733d 5b28 782e 7368 6170 655b 305d  pes=[(x.shape[0]
-00023630: 2c29 5d2c 0a20 2020 2020 2020 2020 2020  ,)],.           
-00023640: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
-00023650: 3d28 696e 742c 2066 6c6f 6174 2c20 6e70  =(int, float, np
-00023660: 2e66 6c6f 6174 3634 2c20 6e70 2e66 6c6f  .float64, np.flo
-00023670: 6174 3332 2c20 6e70 2e69 6e74 3634 2c20  at32, np.int64, 
-00023680: 6e70 2e69 6e74 3332 292c 0a20 2020 2020  np.int32),.     
-00023690: 2020 2029 0a20 2020 2020 2020 2064 6973     ).        dis
-000236a0: 7461 6e63 6573 203d 2046 6561 7475 7265  tances = Feature
-000236b0: 4578 7472 6163 7469 6f6e 4d69 7869 6e2e  ExtractionMixin.
-000236c0: 6364 6973 7428 0a20 2020 2020 2020 2020  cdist(.         
-000236d0: 2020 2061 7272 6179 5f31 3d78 2e61 7374     array_1=x.ast
-000236e0: 7970 6528 6e70 2e66 6c6f 6174 3332 292c  ype(np.float32),
-000236f0: 2061 7272 6179 5f32 3d78 2e61 7374 7970   array_2=x.astyp
-00023700: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
-00023710: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00023720: 6b73 203d 206e 702e 736f 7274 286e 702e  ks = np.sort(np.
-00023730: 756e 6971 7565 2879 2929 2e61 7374 7970  unique(y)).astyp
-00023740: 6528 6e70 2e69 6e74 3634 290a 2020 2020  e(np.int64).    
-00023750: 2020 2020 6465 6c74 6173 203d 206e 702e      deltas = np.
-00023760: 6675 6c6c 2828 6b73 2e73 6861 7065 5b30  full((ks.shape[0
-00023770: 5d2c 206b 732e 7368 6170 655b 305d 292c  ], ks.shape[0]),
-00023780: 206e 702e 696e 6629 0a20 2020 2020 2020   np.inf).       
-00023790: 2062 6967 5f64 656c 7461 7320 3d20 6e70   big_deltas = np
-000237a0: 2e7a 6572 6f73 285b 6b73 2e73 6861 7065  .zeros([ks.shape
-000237b0: 5b30 5d2c 2031 5d29 0a20 2020 2020 2020  [0], 1]).       
-000237c0: 2066 6f72 2069 2c20 6c20 696e 206c 6973   for i, l in lis
-000237d0: 7428 7065 726d 7574 6174 696f 6e73 286b  t(permutations(k
-000237e0: 732c 2032 2929 3a0a 2020 2020 2020 2020  s, 2)):.        
-000237f0: 2020 2020 7661 6c75 6573 203d 2064 6973      values = dis
-00023800: 7461 6e63 6573 5b6e 702e 7768 6572 6528  tances[np.where(
-00023810: 2879 203d 3d20 6929 295d 5b3a 2c20 6e70  (y == i))][:, np
-00023820: 2e77 6865 7265 2828 7920 3d3d 206c 2929  .where((y == l))
-00023830: 5d0a 2020 2020 2020 2020 2020 2020 6465  ].            de
-00023840: 6c74 6173 5b69 2c20 6c5d 203d 206e 702e  ltas[i, l] = np.
-00023850: 6d69 6e28 7661 6c75 6573 5b6e 702e 6e6f  min(values[np.no
-00023860: 6e7a 6572 6f28 7661 6c75 6573 295d 290a  nzero(values)]).
-00023870: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
-00023880: 206b 733a 0a20 2020 2020 2020 2020 2020   ks:.           
-00023890: 2076 616c 7565 7320 3d20 6469 7374 616e   values = distan
-000238a0: 6365 735b 6e70 2e77 6865 7265 2828 7920  ces[np.where((y 
-000238b0: 3d3d 206b 735b 6b5d 2929 5d5b 3a2c 206e  == ks[k]))][:, n
-000238c0: 702e 7768 6572 6528 2879 203d 3d20 6b73  p.where((y == ks
-000238d0: 5b6b 5d29 295d 0a20 2020 2020 2020 2020  [k]))].         
-000238e0: 2020 2062 6967 5f64 656c 7461 735b 6b5d     big_deltas[k]
-000238f0: 203d 206e 702e 6d61 7828 7661 6c75 6573   = np.max(values
-00023900: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00023910: 6e20 6e70 2e6d 696e 2864 656c 7461 7329  n np.min(deltas)
-00023920: 202f 206e 702e 6d61 7828 6269 675f 6465   / np.max(big_de
-00023930: 6c74 6173 290a 0a20 2020 2064 6566 2064  ltas)..    def d
-00023940: 6176 6973 5f62 6f75 6c64 696e 2878 3a20  avis_bouldin(x: 
-00023950: 6e70 2e6e 6461 7272 6179 2c20 793a 206e  np.ndarray, y: n
-00023960: 702e 6e64 6172 7261 7929 202d 3e20 666c  p.ndarray) -> fl
-00023970: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
-00023980: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-00023990: 7465 2074 6865 2044 6176 6973 2d42 6f75  te the Davis-Bou
-000239a0: 6c64 696e 2069 6e64 6578 2066 6f72 2065  ldin index for e
-000239b0: 7661 6c75 6174 696e 6720 636c 7573 7465  valuating cluste
-000239c0: 7269 6e67 2070 6572 666f 726d 616e 6365  ring performance
-000239d0: 2e0a 0a20 2020 2020 2020 2044 6176 6973  ...        Davis
-000239e0: 2d42 6f75 6c64 696e 2069 6e64 6578 206d  -Bouldin index m
-000239f0: 6561 7375 7265 7320 7468 6520 636c 7573  easures the clus
-00023a00: 7465 7269 6e67 2071 7561 6c69 7479 2062  tering quality b
-00023a10: 6173 6564 206f 6e20 7468 6520 7769 7468  ased on the with
-00023a20: 696e 2d63 6c75 7374 6572 0a20 2020 2020  in-cluster.     
-00023a30: 2020 2073 696d 696c 6172 6974 7920 616e     similarity an
-00023a40: 6420 6265 7477 6565 6e2d 636c 7573 7465  d between-cluste
-00023a50: 7220 6469 7373 696d 696c 6172 6974 792e  r dissimilarity.
-00023a60: 204c 6f77 6572 2076 616c 7565 7320 696e   Lower values in
-00023a70: 6469 6361 7465 2062 6574 7465 7220 636c  dicate better cl
-00023a80: 7573 7465 7269 6e67 2e0a 0a20 2020 2020  ustering...     
-00023a90: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
-00023aa0: 2020 2020 2020 2020 4d6f 6469 6669 6564          Modified
-00023ab0: 2066 726f 6d20 6073 6369 6b69 742d 6c65   from `scikit-le
-00023ac0: 6172 6e20 3c68 7474 7073 3a2f 2f67 6974  arn <https://git
-00023ad0: 6875 622e 636f 6d2f 7363 696b 6974 2d6c  hub.com/scikit-l
-00023ae0: 6561 726e 2f73 6369 6b69 742d 6c65 6172  earn/scikit-lear
-00023af0: 6e2f 626c 6f62 2f66 3037 6530 3133 3862  n/blob/f07e0138b
-00023b00: 6665 6534 3163 6432 6330 6135 6430 3235  fee41cd2c0a5d025
-00023b10: 3164 6333 6665 3033 6536 6531 3038 342f  1dc3fe03e6e1084/
-00023b20: 736b 6c65 6172 6e2f 6d65 7472 6963 732f  sklearn/metrics/
-00023b30: 636c 7573 7465 722f 5f75 6e73 7570 6572  cluster/_unsuper
-00023b40: 7669 7365 642e 7079 234c 3339 303e 605f  vised.py#L390>`_
-00023b50: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00023b60: 206e 702e 6e64 6172 7261 7920 783a 2032   np.ndarray x: 2
-00023b70: 4420 6172 7261 7920 7265 7072 6573 656e  D array represen
-00023b80: 7469 6e67 2074 6865 2064 6174 6120 706f  ting the data po
-00023b90: 696e 7473 2e20 5368 6170 6520 286e 5f73  ints. Shape (n_s
-00023ba0: 616d 706c 6573 2c20 6e5f 6665 6174 7572  amples, n_featur
-00023bb0: 6573 2f6e 5f64 696d 656e 7369 6f6e 292e  es/n_dimension).
-00023bc0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00023bd0: 6e70 2e6e 6461 7272 6179 2079 3a20 3244  np.ndarray y: 2D
-00023be0: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
-00023bf0: 696e 6720 636c 7573 7465 7220 6c61 6265  ing cluster labe
-00023c00: 6c73 2066 6f72 2065 6163 6820 6461 7461  ls for each data
-00023c10: 2070 6f69 6e74 2e20 5368 6170 6520 286e   point. Shape (n
-00023c20: 5f73 616d 706c 6573 2c29 2e0a 2020 2020  _samples,)..    
-00023c30: 2020 2020 3a72 6574 7572 6e20 666c 6f61      :return floa
-00023c40: 743a 2044 6176 6973 2d42 6f75 6c64 696e  t: Davis-Bouldin
-00023c50: 2073 636f 7265 2e0a 0a20 2020 2020 2020   score...       
-00023c60: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
-00023c70: 2020 203e 3e3e 2078 203d 206e 702e 7261     >>> x = np.ra
-00023c80: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
-00023c90: 3130 302c 2028 3130 302c 2032 2929 0a20  100, (100, 2)). 
-00023ca0: 2020 2020 2020 203e 3e3e 2079 203d 206e         >>> y = n
-00023cb0: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
-00023cc0: 2830 2c20 332c 2028 3130 302c 2929 0a20  (0, 3, (100,)). 
-00023cd0: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
-00023ce0: 7374 6963 732e 6461 7669 735f 626f 756c  stics.davis_boul
-00023cf0: 6469 6e28 783d 782c 2079 3d79 290a 2020  din(x=x, y=y).  
-00023d00: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-00023d10: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
-00023d20: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
-00023d30: 2020 6461 7461 3d78 2c0a 2020 2020 2020    data=x,.      
-00023d40: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
-00023d50: 7469 7374 6963 732e 6461 7669 735f 626f  tistics.davis_bo
-00023d60: 756c 6469 6e2e 5f5f 6e61 6d65 5f5f 2c0a  uldin.__name__,.
-00023d70: 2020 2020 2020 2020 2020 2020 6163 6365              acce
-00023d80: 7074 6564 5f6e 6469 6d73 3d28 322c 292c  pted_ndims=(2,),
-00023d90: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-00023da0: 6570 7465 645f 6474 7970 6573 3d28 696e  epted_dtypes=(in
-00023db0: 742c 2066 6c6f 6174 2c20 6e70 2e66 6c6f  t, float, np.flo
-00023dc0: 6174 3634 2c20 6e70 2e66 6c6f 6174 3332  at64, np.float32
-00023dd0: 2c20 6e70 2e69 6e74 3634 2c20 6e70 2e69  , np.int64, np.i
-00023de0: 6e74 3332 292c 0a20 2020 2020 2020 2029  nt32),.        )
-00023df0: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
-00023e00: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
-00023e10: 2020 2020 2020 2020 6461 7461 3d79 2c0a          data=y,.
-00023e20: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-00023e30: 6365 3d53 7461 7469 7374 6963 732e 6461  ce=Statistics.da
-00023e40: 7669 735f 626f 756c 6469 6e2e 5f5f 6e61  vis_bouldin.__na
-00023e50: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-00023e60: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
-00023e70: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
-00023e80: 2020 2061 6363 6570 7465 645f 7368 6170     accepted_shap
-00023e90: 6573 3d5b 2878 2e73 6861 7065 5b30 5d2c  es=[(x.shape[0],
-00023ea0: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
-00023eb0: 6163 6365 7074 6564 5f64 7479 7065 733d  accepted_dtypes=
-00023ec0: 2869 6e74 2c20 666c 6f61 742c 206e 702e  (int, float, np.
-00023ed0: 666c 6f61 7436 342c 206e 702e 666c 6f61  float64, np.floa
-00023ee0: 7433 322c 206e 702e 696e 7436 342c 206e  t32, np.int64, n
-00023ef0: 702e 696e 7433 3229 2c0a 2020 2020 2020  p.int32),.      
-00023f00: 2020 290a 2020 2020 2020 2020 6e5f 6c61    ).        n_la
-00023f10: 6265 6c73 203d 206e 702e 756e 6971 7565  bels = np.unique
-00023f20: 2879 292e 7368 6170 655b 305d 0a20 2020  (y).shape[0].   
-00023f30: 2020 2020 206c 6162 656c 7320 3d20 6e70       labels = np
-00023f40: 2e75 6e69 7175 6528 7929 0a20 2020 2020  .unique(y).     
-00023f50: 2020 2069 6e74 7261 5f64 6973 7473 203d     intra_dists =
-00023f60: 206e 702e 6675 6c6c 2828 6e5f 6c61 6265   np.full((n_labe
-00023f70: 6c73 292c 2030 2e30 290a 2020 2020 2020  ls), 0.0).      
-00023f80: 2020 6365 6e74 726f 6964 7320 3d20 6e70    centroids = np
-00023f90: 2e66 756c 6c28 286e 5f6c 6162 656c 732c  .full((n_labels,
-00023fa0: 2078 2e73 6861 7065 5b31 5d29 2c20 302e   x.shape[1]), 0.
-00023fb0: 3029 0a20 2020 2020 2020 2066 6f72 206b  0).        for k
-00023fc0: 2069 6e20 7261 6e67 6528 6e5f 6c61 6265   in range(n_labe
-00023fd0: 6c73 293a 0a20 2020 2020 2020 2020 2020  ls):.           
-00023fe0: 2063 6c75 7374 6572 5f6b 203d 2078 5b6e   cluster_k = x[n
-00023ff0: 702e 6172 6777 6865 7265 2879 203d 3d20  p.argwhere(y == 
-00024000: 6c61 6265 6c73 5b6b 5d29 5d2e 7265 7368  labels[k])].resh
-00024010: 6170 6528 2d31 2c20 3229 0a20 2020 2020  ape(-1, 2).     
-00024020: 2020 2020 2020 2063 6c75 7374 6572 5f6d         cluster_m
-00024030: 6561 6e20 3d20 6e70 2e66 756c 6c28 2878  ean = np.full((x
-00024040: 2e73 6861 7065 5b31 5d29 2c20 6e70 2e6e  .shape[1]), np.n
-00024050: 616e 290a 2020 2020 2020 2020 2020 2020  an).            
-00024060: 666f 7220 6920 696e 2072 616e 6765 2863  for i in range(c
-00024070: 6c75 7374 6572 5f6d 6561 6e2e 7368 6170  luster_mean.shap
-00024080: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
-00024090: 2020 2020 2020 2063 6c75 7374 6572 5f6d         cluster_m
-000240a0: 6561 6e5b 695d 203d 206e 702e 6d65 616e  ean[i] = np.mean
-000240b0: 2863 6c75 7374 6572 5f6b 5b3a 2c20 695d  (cluster_k[:, i]
-000240c0: 2e66 6c61 7474 656e 2829 290a 2020 2020  .flatten()).    
-000240d0: 2020 2020 2020 2020 6365 6e74 726f 6964          centroid
-000240e0: 735b 6b5d 203d 2063 6c75 7374 6572 5f6d  s[k] = cluster_m
-000240f0: 6561 6e0a 2020 2020 2020 2020 2020 2020  ean.            
-00024100: 696e 7472 615f 6469 7374 735b 6b5d 203d  intra_dists[k] =
-00024110: 206e 702e 6176 6572 6167 6528 0a20 2020   np.average(.   
-00024120: 2020 2020 2020 2020 2020 2020 2046 6561               Fea
-00024130: 7475 7265 4578 7472 6163 7469 6f6e 4d69  tureExtractionMi
-00024140: 7869 6e2e 6672 616d 6577 6973 655f 6575  xin.framewise_eu
-00024150: 636c 6964 6561 6e5f 6469 7374 616e 6365  clidean_distance
-00024160: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00024170: 2020 2020 2020 6c6f 6361 7469 6f6e 5f31        location_1
-00024180: 3d63 6c75 7374 6572 5f6b 2c0a 2020 2020  =cluster_k,.    
-00024190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241a0: 6c6f 6361 7469 6f6e 5f32 3d6e 702e 6675  location_2=np.fu
-000241b0: 6c6c 2863 6c75 7374 6572 5f6b 2e73 6861  ll(cluster_k.sha
-000241c0: 7065 2c20 636c 7573 7465 725f 6d65 616e  pe, cluster_mean
-000241d0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000241e0: 2020 2020 2020 2070 785f 7065 725f 6d6d         px_per_mm
-000241f0: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
-00024200: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00024210: 2020 290a 2020 2020 2020 2020 6365 6e74    ).        cent
-00024220: 726f 6964 5f64 6973 7461 6e63 6573 203d  roid_distances =
-00024230: 2046 6561 7475 7265 4578 7472 6163 7469   FeatureExtracti
-00024240: 6f6e 4d69 7869 6e2e 6364 6973 7428 0a20  onMixin.cdist(. 
-00024250: 2020 2020 2020 2020 2020 2061 7272 6179             array
-00024260: 5f31 3d63 656e 7472 6f69 6473 2e61 7374  _1=centroids.ast
-00024270: 7970 6528 6e70 2e66 6c6f 6174 3332 292c  ype(np.float32),
-00024280: 2061 7272 6179 5f32 3d63 656e 7472 6f69   array_2=centroi
-00024290: 6473 2e61 7374 7970 6528 6e70 2e66 6c6f  ds.astype(np.flo
-000242a0: 6174 3332 290a 2020 2020 2020 2020 290a  at32).        ).
-000242b0: 2020 2020 2020 2020 6966 206e 702e 616c          if np.al
-000242c0: 6c63 6c6f 7365 2869 6e74 7261 5f64 6973  lclose(intra_dis
-000242d0: 7473 2c20 3029 206f 7220 6e70 2e61 6c6c  ts, 0) or np.all
-000242e0: 636c 6f73 6528 6365 6e74 726f 6964 5f64  close(centroid_d
-000242f0: 6973 7461 6e63 6573 2c20 3029 3a0a 2020  istances, 0):.  
-00024300: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00024310: 2030 2e30 0a20 2020 2020 2020 2063 656e   0.0.        cen
-00024320: 7472 6f69 645f 6469 7374 616e 6365 735b  troid_distances[
-00024330: 6365 6e74 726f 6964 5f64 6973 7461 6e63  centroid_distanc
-00024340: 6573 203d 3d20 305d 203d 206e 702e 696e  es == 0] = np.in
-00024350: 660a 2020 2020 2020 2020 636f 6d62 696e  f.        combin
-00024360: 6564 5f69 6e74 7261 5f64 6973 7473 203d  ed_intra_dists =
-00024370: 2069 6e74 7261 5f64 6973 7473 5b3a 2c20   intra_dists[:, 
-00024380: 4e6f 6e65 5d20 2b20 696e 7472 615f 6469  None] + intra_di
-00024390: 7374 730a 2020 2020 2020 2020 7265 7475  sts.        retu
-000243a0: 726e 206e 702e 6d65 616e 286e 702e 6d61  rn np.mean(np.ma
-000243b0: 7828 636f 6d62 696e 6564 5f69 6e74 7261  x(combined_intra
-000243c0: 5f64 6973 7473 202f 2063 656e 7472 6f69  _dists / centroi
-000243d0: 645f 6469 7374 616e 6365 732c 2061 7869  d_distances, axi
-000243e0: 733d 3129 290a 0a20 2020 2040 7374 6174  s=1))..    @stat
-000243f0: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
-00024400: 6974 2822 2866 6c6f 6174 3332 5b3a 2c3a  it("(float32[:,:
-00024410: 5d2c 2069 6e74 3634 5b3a 5d29 222c 2063  ], int64[:])", c
-00024420: 6163 6865 3d54 7275 6529 0a20 2020 2064  ache=True).    d
-00024430: 6566 2063 616c 696e 736b 695f 6861 7261  ef calinski_hara
-00024440: 6261 737a 2878 3a20 6e70 2e6e 6461 7272  basz(x: np.ndarr
-00024450: 6179 2c20 793a 206e 702e 6e64 6172 7261  ay, y: np.ndarra
-00024460: 7929 202d 3e20 666c 6f61 743a 0a20 2020  y) -> float:.   
-00024470: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00024480: 2043 6f6d 7075 7465 2074 6865 2043 616c   Compute the Cal
-00024490: 696e 736b 692d 4861 7261 6261 737a 2073  inski-Harabasz s
-000244a0: 636f 7265 2074 6f20 6576 616c 7561 7465  core to evaluate
-000244b0: 2063 6c75 7374 6572 696e 6720 7175 616c   clustering qual
-000244c0: 6974 792e 0a0a 2020 2020 2020 2020 5468  ity...        Th
-000244d0: 6520 4361 6c69 6e73 6b69 2d48 6172 6162  e Calinski-Harab
-000244e0: 6173 7a20 7363 6f72 6520 6973 2061 206d  asz score is a m
-000244f0: 6561 7375 7265 206f 6620 636c 7573 7465  easure of cluste
-00024500: 7220 7365 7061 7261 7469 6f6e 2061 6e64  r separation and
-00024510: 2063 6f6d 7061 6374 6e65 7373 2e0a 2020   compactness..  
-00024520: 2020 2020 2020 4974 2069 7320 6361 6c63        It is calc
-00024530: 756c 6174 6564 2061 7320 7468 6520 7261  ulated as the ra
-00024540: 7469 6f20 6f66 2074 6865 2062 6574 7765  tio of the betwe
-00024550: 656e 2d63 6c75 7374 6572 2064 6973 7065  en-cluster dispe
-00024560: 7273 696f 6e20 746f 2074 6865 0a20 2020  rsion to the.   
-00024570: 2020 2020 2077 6974 6869 6e2d 636c 7573       within-clus
-00024580: 7465 7220 6469 7370 6572 7369 6f6e 2e20  ter dispersion. 
-00024590: 4120 6869 6768 6572 2073 636f 7265 2069  A higher score i
-000245a0: 6e64 6963 6174 6573 2062 6574 7465 7220  ndicates better 
-000245b0: 636c 7573 7465 7269 6e67 2e0a 0a20 2020  clustering...   
-000245c0: 2020 2020 203a 7061 7261 6d20 783a 2032       :param x: 2
-000245d0: 4420 6172 7261 7920 7265 7072 6573 656e  D array represen
-000245e0: 7469 6e67 2074 6865 2064 6174 6120 706f  ting the data po
-000245f0: 696e 7473 2e20 5368 6170 6520 286e 5f73  ints. Shape (n_s
-00024600: 616d 706c 6573 2c20 6e5f 6665 6174 7572  amples, n_featur
-00024610: 6573 2f6e 5f64 696d 656e 7369 6f6e 292e  es/n_dimension).
-00024620: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00024630: 793a 2032 4420 6172 7261 7920 7265 7072  y: 2D array repr
-00024640: 6573 656e 7469 6e67 2063 6c75 7374 6572  esenting cluster
-00024650: 206c 6162 656c 7320 666f 7220 6561 6368   labels for each
-00024660: 2064 6174 6120 706f 696e 742e 2053 6861   data point. Sha
-00024670: 7065 2028 6e5f 7361 6d70 6c65 732c 292e  pe (n_samples,).
-00024680: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00024690: 2066 6c6f 6174 3a20 4361 6c69 6e73 6b69   float: Calinski
-000246a0: 2d48 6172 6162 6173 7a20 7363 6f72 652e  -Harabasz score.
-000246b0: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
-000246c0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
-000246d0: 7820 3d20 6e70 2e72 616e 646f 6d2e 7261  x = np.random.ra
-000246e0: 6e64 6f6d 2828 3130 302c 2032 2929 2e61  ndom((100, 2)).a
-000246f0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-00024700: 290a 2020 2020 2020 2020 3e3e 3e20 7920  ).        >>> y 
-00024710: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-00024720: 696e 7428 302c 2031 3030 2c20 2831 3030  int(0, 100, (100
-00024730: 2c29 292e 6173 7479 7065 286e 702e 696e  ,)).astype(np.in
-00024740: 7436 3429 0a20 2020 2020 2020 203e 3e3e  t64).        >>>
-00024750: 2053 7461 7469 7374 6963 732e 6361 6c69   Statistics.cali
-00024760: 6e73 6b69 5f68 6172 6162 6173 7a28 783d  nski_harabasz(x=
-00024770: 782c 2079 3d79 290a 2020 2020 2020 2020  x, y=y).        
-00024780: 2222 220a 0a20 2020 2020 2020 206e 5f6c  """..        n_l
-00024790: 6162 656c 7320 3d20 6e70 2e75 6e69 7175  abels = np.uniqu
-000247a0: 6528 7929 2e73 6861 7065 5b30 5d0a 2020  e(y).shape[0].  
-000247b0: 2020 2020 2020 6c61 6265 6c73 203d 206e        labels = n
-000247c0: 702e 756e 6971 7565 2879 290a 2020 2020  p.unique(y).    
-000247d0: 2020 2020 6578 7472 615f 6469 7370 6572      extra_disper
-000247e0: 7369 6f6e 2c20 696e 7472 615f 6469 7370  sion, intra_disp
-000247f0: 6572 7369 6f6e 203d 2030 2e30 2c20 302e  ersion = 0.0, 0.
-00024800: 300a 2020 2020 2020 2020 676c 6f62 616c  0.        global
-00024810: 5f6d 6561 6e20 3d20 6e70 2e66 756c 6c28  _mean = np.full(
-00024820: 2878 2e73 6861 7065 5b31 5d29 2c20 6e70  (x.shape[1]), np
-00024830: 2e6e 616e 290a 2020 2020 2020 2020 666f  .nan).        fo
-00024840: 7220 6920 696e 2072 616e 6765 2878 2e73  r i in range(x.s
-00024850: 6861 7065 5b31 5d29 3a0a 2020 2020 2020  hape[1]):.      
-00024860: 2020 2020 2020 676c 6f62 616c 5f6d 6561        global_mea
-00024870: 6e5b 695d 203d 206e 702e 6d65 616e 2878  n[i] = np.mean(x
-00024880: 5b3a 2c20 695d 2e66 6c61 7474 656e 2829  [:, i].flatten()
-00024890: 290a 2020 2020 2020 2020 666f 7220 6b20  ).        for k 
-000248a0: 696e 2072 616e 6765 286e 5f6c 6162 656c  in range(n_label
-000248b0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-000248c0: 636c 7573 7465 725f 6b20 3d20 785b 6e70  cluster_k = x[np
-000248d0: 2e61 7267 7768 6572 6528 7920 3d3d 206c  .argwhere(y == l
-000248e0: 6162 656c 735b 6b5d 292e 666c 6174 7465  abels[k]).flatte
-000248f0: 6e28 292c 203a 5d0a 2020 2020 2020 2020  n(), :].        
-00024900: 2020 2020 6d65 616e 5f6b 203d 206e 702e      mean_k = np.
-00024910: 6675 6c6c 2828 636c 7573 7465 725f 6b2e  full((cluster_k.
-00024920: 7368 6170 655b 315d 292c 206e 702e 6e61  shape[1]), np.na
-00024930: 6e29 0a20 2020 2020 2020 2020 2020 2066  n).            f
-00024940: 6f72 2069 2069 6e20 7261 6e67 6528 636c  or i in range(cl
-00024950: 7573 7465 725f 6b2e 7368 6170 655b 315d  uster_k.shape[1]
-00024960: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00024970: 2020 206d 6561 6e5f 6b5b 695d 203d 206e     mean_k[i] = n
-00024980: 702e 6d65 616e 2863 6c75 7374 6572 5f6b  p.mean(cluster_k
-00024990: 5b3a 2c20 695d 2e66 6c61 7474 656e 2829  [:, i].flatten()
-000249a0: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
-000249b0: 7472 615f 6469 7370 6572 7369 6f6e 202b  tra_dispersion +
-000249c0: 3d20 6c65 6e28 636c 7573 7465 725f 6b29  = len(cluster_k)
-000249d0: 202a 206e 702e 7375 6d28 286d 6561 6e5f   * np.sum((mean_
-000249e0: 6b20 2d20 676c 6f62 616c 5f6d 6561 6e29  k - global_mean)
-000249f0: 202a 2a20 3229 0a20 2020 2020 2020 2020   ** 2).         
-00024a00: 2020 2069 6e74 7261 5f64 6973 7065 7273     intra_dispers
-00024a10: 696f 6e20 2b3d 206e 702e 7375 6d28 2863  ion += np.sum((c
-00024a20: 6c75 7374 6572 5f6b 202d 206d 6561 6e5f  luster_k - mean_
-00024a30: 6b29 202a 2a20 3229 0a0a 2020 2020 2020  k) ** 2)..      
-00024a40: 2020 6465 6e6f 6d69 6e61 746f 7220 3d20    denominator = 
-00024a50: 696e 7472 615f 6469 7370 6572 7369 6f6e  intra_dispersion
-00024a60: 202a 2028 6e5f 6c61 6265 6c73 202d 2031   * (n_labels - 1
-00024a70: 2e30 290a 2020 2020 2020 2020 6966 2064  .0).        if d
-00024a80: 656e 6f6d 696e 6174 6f72 203d 3d20 302e  enominator == 0.
-00024a90: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-00024aa0: 6574 7572 6e20 302e 300a 2020 2020 2020  eturn 0.0.      
-00024ab0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00024ac0: 2020 2020 7265 7475 726e 2065 7874 7261      return extra
-00024ad0: 5f64 6973 7065 7273 696f 6e20 2a20 2878  _dispersion * (x
-00024ae0: 2e73 6861 7065 5b30 5d20 2d20 6e5f 6c61  .shape[0] - n_la
-00024af0: 6265 6c73 2920 2f20 6465 6e6f 6d69 6e61  bels) / denomina
-00024b00: 746f 720a 0a20 2020 2040 7374 6174 6963  tor..    @static
-00024b10: 6d65 7468 6f64 0a20 2020 2064 6566 2061  method.    def a
-00024b20: 646a 7573 7465 645f 7261 6e64 2878 3a20  djusted_rand(x: 
-00024b30: 6e70 2e6e 6461 7272 6179 2c20 793a 206e  np.ndarray, y: n
-00024b40: 702e 6e64 6172 7261 7929 202d 3e20 666c  p.ndarray) -> fl
-00024b50: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
-00024b60: 0a20 2020 2020 2020 2043 616c 6375 6c61  .        Calcula
-00024b70: 7465 2074 6865 2041 646a 7573 7465 6420  te the Adjusted 
-00024b80: 5261 6e64 2049 6e64 6578 2028 4152 4929  Rand Index (ARI)
-00024b90: 2062 6574 7765 656e 2074 776f 2063 6c75   between two clu
-00024ba0: 7374 6572 696e 6773 2e0a 0a20 2020 2020  sterings...     
-00024bb0: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
-00024bc0: 7272 6179 2078 3a20 3144 2061 7272 6179  rray x: 1D array
-00024bd0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-00024be0: 6520 6c61 6265 6c73 206f 6620 7468 6520  e labels of the 
-00024bf0: 6669 7273 7420 6d6f 6465 6c2e 0a20 2020  first model..   
-00024c00: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
-00024c10: 6461 7272 6179 2079 3a20 3144 2061 7272  darray y: 1D arr
-00024c20: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
-00024c30: 7468 6520 6c61 6265 6c73 206f 6620 7468  the labels of th
-00024c40: 6520 7365 636f 6e64 206d 6f64 656c 2e0a  e second model..
-00024c50: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
-00024c60: 666c 6f61 743a 2031 2069 6e64 6963 6174  float: 1 indicat
-00024c70: 6573 2070 6572 6665 6374 2063 6c75 7374  es perfect clust
-00024c80: 6572 696e 6720 6167 7265 656d 656e 742c  ering agreement,
-00024c90: 2030 2069 6e64 6963 6174 6573 2072 616e   0 indicates ran
-00024ca0: 646f 6d20 636c 7573 7465 7269 6e67 2c20  dom clustering, 
-00024cb0: 616e 6420 6e65 6761 7469 7665 2076 616c  and negative val
-00024cc0: 7565 7320 696e 6469 6361 7465 2064 6973  ues indicate dis
-00024cd0: 6167 7265 656d 656e 7420 6265 7477 6565  agreement betwee
-00024ce0: 6e20 7468 6520 636c 7573 7465 7269 6e67  n the clustering
-00024cf0: 732e 0a0a 2020 2020 2020 2020 3a65 7861  s...        :exa
-00024d00: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
-00024d10: 3e20 7820 3d20 6e70 2e61 7272 6179 285b  > x = np.array([
-00024d20: 302c 2030 2c20 302c 2030 2c20 305d 290a  0, 0, 0, 0, 0]).
-00024d30: 2020 2020 2020 2020 3e3e 3e20 7920 3d20          >>> y = 
-00024d40: 6e70 2e61 7272 6179 285b 312c 2031 2c20  np.array([1, 1, 
-00024d50: 312c 2031 2c20 315d 290a 2020 2020 2020  1, 1, 1]).      
-00024d60: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
-00024d70: 2e61 646a 7573 7465 645f 7261 6e64 2878  .adjusted_rand(x
-00024d80: 3d78 2c20 793d 7929 0a20 2020 2020 2020  =x, y=y).       
-00024d90: 203e 3e3e 2031 2e30 0a20 2020 2020 2020   >>> 1.0.       
-00024da0: 2022 2222 0a0a 2020 2020 2020 2020 6368   """..        ch
-00024db0: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
-00024dc0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00024dd0: 613d 782c 0a20 2020 2020 2020 2020 2020  a=x,.           
-00024de0: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
-00024df0: 6373 2e61 646a 7573 7465 645f 7261 6e64  cs.adjusted_rand
-00024e00: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
-00024e10: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
-00024e20: 6e64 696d 733d 2831 2c29 2c0a 2020 2020  ndims=(1,),.    
-00024e30: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00024e40: 5f64 7479 7065 733d 286e 702e 696e 7436  _dtypes=(np.int6
-00024e50: 342c 206e 702e 696e 7433 322c 2069 6e74  4, np.int32, int
-00024e60: 292c 0a20 2020 2020 2020 2020 2020 206d  ),.            m
-00024e70: 696e 5f61 7869 735f 303d 312c 0a20 2020  in_axis_0=1,.   
-00024e80: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
-00024e90: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
-00024ea0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
-00024eb0: 7461 3d79 2c0a 2020 2020 2020 2020 2020  ta=y,.          
-00024ec0: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
-00024ed0: 6963 732e 6164 6a75 7374 6564 5f72 616e  ics.adjusted_ran
-00024ee0: 642e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  d.__name__,.    
-00024ef0: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
-00024f00: 5f6e 6469 6d73 3d28 312c 292c 0a20 2020  _ndims=(1,),.   
-00024f10: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
-00024f20: 645f 6474 7970 6573 3d28 6e70 2e69 6e74  d_dtypes=(np.int
-00024f30: 3634 2c20 6e70 2e69 6e74 3332 2c20 696e  64, np.int32, in
-00024f40: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
-00024f50: 6163 6365 7074 6564 5f73 6861 7065 733d  accepted_shapes=
-00024f60: 5b28 782e 7368 6170 655b 305d 2c29 5d2c  [(x.shape[0],)],
-00024f70: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00024f80: 2020 2072 6574 7572 6e20 6164 6a75 7374     return adjust
-00024f90: 6564 5f72 616e 645f 7363 6f72 6528 6c61  ed_rand_score(la
-00024fa0: 6265 6c73 5f74 7275 653d 782c 206c 6162  bels_true=x, lab
-00024fb0: 656c 735f 7072 6564 3d79 290a 0a20 2020  els_pred=y)..   
-00024fc0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00024fd0: 2020 2064 6566 2066 6f77 6c6b 6573 5f6d     def fowlkes_m
-00024fe0: 616c 6c6f 7773 2878 3a20 6e70 2e6e 6461  allows(x: np.nda
-00024ff0: 7272 6179 2c20 793a 206e 702e 6e64 6172  rray, y: np.ndar
-00025000: 7261 7929 202d 3e20 666c 6f61 743a 0a20  ray) -> float:. 
-00025010: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00025020: 2020 2043 616c 6375 6c61 7465 2074 6865     Calculate the
-00025030: 2046 6f77 6c6b 6573 2d4d 616c 6c6f 7773   Fowlkes-Mallows
-00025040: 2049 6e64 6578 2028 464d 4929 2062 6574   Index (FMI) bet
-00025050: 7765 656e 2074 776f 2063 6c75 7374 6572  ween two cluster
-00025060: 696e 6773 2e0a 0a20 2020 2020 2020 203a  ings...        :
-00025070: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
-00025080: 2078 3a20 3144 2061 7272 6179 2072 6570   x: 1D array rep
-00025090: 7265 7365 6e74 696e 6720 7468 6520 6c61  resenting the la
-000250a0: 6265 6c73 206f 6620 7468 6520 6669 7273  bels of the firs
-000250b0: 7420 6d6f 6465 6c2e 0a20 2020 2020 2020  t model..       
-000250c0: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
-000250d0: 6179 2079 3a20 3144 2061 7272 6179 2072  ay y: 1D array r
-000250e0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
-000250f0: 6c61 6265 6c73 206f 6620 7468 6520 7365  labels of the se
-00025100: 636f 6e64 206d 6f64 656c 2e0a 2020 2020  cond model..    
-00025110: 2020 2020 3a72 6574 7572 6e20 666c 6f61      :return floa
-00025120: 743a 2053 636f 7265 2062 6574 7765 656e  t: Score between
-00025130: 2030 2061 6e64 2031 2e20 3120 696e 6469   0 and 1. 1 indi
-00025140: 6361 7465 7320 7065 7266 6563 7420 636c  cates perfect cl
-00025150: 7573 7465 7269 6e67 2061 6772 6565 6d65  ustering agreeme
-00025160: 6e74 2c20 3020 696e 6469 6361 7465 7320  nt, 0 indicates 
-00025170: 7261 6e64 6f6d 2063 6c75 7374 6572 696e  random clusterin
-00025180: 672e 0a20 2020 2020 2020 2022 2222 0a20  g..        """. 
-00025190: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
-000251a0: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
-000251b0: 2020 2020 2020 6461 7461 3d78 2c0a 2020        data=x,.  
-000251c0: 2020 2020 2020 2020 2020 736f 7572 6365            source
-000251d0: 3d53 7461 7469 7374 6963 732e 666f 776c  =Statistics.fowl
-000251e0: 6b65 735f 6d61 6c6c 6f77 732e 5f5f 6e61  kes_mallows.__na
-000251f0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-00025200: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
-00025210: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
-00025220: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
-00025230: 6573 3d28 6e70 2e69 6e74 3634 2c20 6e70  es=(np.int64, np
-00025240: 2e69 6e74 3332 2c20 696e 7429 2c0a 2020  .int32, int),.  
-00025250: 2020 2020 2020 2020 2020 6d69 6e5f 6178            min_ax
-00025260: 6973 5f30 3d31 2c0a 2020 2020 2020 2020  is_0=1,.        
-00025270: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
-00025280: 7661 6c69 645f 6172 7261 7928 0a20 2020  valid_array(.   
-00025290: 2020 2020 2020 2020 2064 6174 613d 792c           data=y,
-000252a0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-000252b0: 7263 653d 5374 6174 6973 7469 6373 2e66  rce=Statistics.f
-000252c0: 6f77 6c6b 6573 5f6d 616c 6c6f 7773 2e5f  owlkes_mallows._
-000252d0: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
-000252e0: 2020 2020 2061 6363 6570 7465 645f 6e64       accepted_nd
-000252f0: 696d 733d 2831 2c29 2c0a 2020 2020 2020  ims=(1,),.      
-00025300: 2020 2020 2020 6163 6365 7074 6564 5f64        accepted_d
-00025310: 7479 7065 733d 286e 702e 696e 7436 342c  types=(np.int64,
-00025320: 206e 702e 696e 7433 322c 2069 6e74 292c   np.int32, int),
-00025330: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-00025340: 6570 7465 645f 7368 6170 6573 3d5b 2878  epted_shapes=[(x
-00025350: 2e73 6861 7065 5b30 5d2c 295d 2c0a 2020  .shape[0],)],.  
-00025360: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00025370: 7265 7475 726e 2066 6f77 6c6b 6573 5f6d  return fowlkes_m
-00025380: 616c 6c6f 7773 5f73 636f 7265 286c 6162  allows_score(lab
-00025390: 656c 735f 7472 7565 3d78 2c20 6c61 6265  els_true=x, labe
-000253a0: 6c73 5f70 7265 643d 7929 0a0a 2020 2020  ls_pred=y)..    
-000253b0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
-000253c0: 2020 6465 6620 6164 6a75 7374 6564 5f6d    def adjusted_m
-000253d0: 7574 7561 6c5f 696e 666f 2878 3a20 6e70  utual_info(x: np
-000253e0: 2e6e 6461 7272 6179 2c20 793a 206e 702e  .ndarray, y: np.
-000253f0: 6e64 6172 7261 7929 202d 3e20 666c 6f61  ndarray) -> floa
-00025400: 743a 0a20 2020 2020 2020 2022 2222 0a20  t:.        """. 
-00025410: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
-00025420: 2074 6865 2041 646a 7573 7465 6420 4d75   the Adjusted Mu
-00025430: 7475 616c 2049 6e66 6f72 6d61 7469 6f6e  tual Information
-00025440: 2028 414d 4929 2062 6574 7765 656e 2074   (AMI) between t
-00025450: 776f 2063 6c75 7374 6572 696e 6773 2061  wo clusterings a
-00025460: 7320 6120 6d65 6173 7375 7265 206f 6620  s a meassure of 
-00025470: 7369 6d69 6c61 7269 7479 2e0a 2020 2020  similarity..    
-00025480: 2020 2020 636c 7573 7465 7269 6e67 732e      clusterings.
-00025490: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000254a0: 206e 702e 6e64 6172 7261 7920 783a 2031   np.ndarray x: 1
-000254b0: 4420 6172 7261 7920 7265 7072 6573 656e  D array represen
-000254c0: 7469 6e67 2074 6865 206c 6162 656c 7320  ting the labels 
-000254d0: 6f66 2074 6865 2066 6972 7374 206d 6f64  of the first mod
-000254e0: 656c 2e0a 2020 2020 2020 2020 3a70 6172  el..        :par
-000254f0: 616d 206e 702e 6e64 6172 7261 7920 793a  am np.ndarray y:
-00025500: 2031 4420 6172 7261 7920 7265 7072 6573   1D array repres
-00025510: 656e 7469 6e67 2074 6865 206c 6162 656c  enting the label
-00025520: 7320 6f66 2074 6865 2073 6563 6f6e 6420  s of the second 
-00025530: 6d6f 6465 6c2e 0a20 2020 2020 2020 203a  model..        :
-00025540: 7265 7475 726e 2066 6c6f 6174 3a20 5363  return float: Sc
-00025550: 6f72 6520 6265 7477 6565 6e20 3020 616e  ore between 0 an
-00025560: 6420 312c 2077 6865 7265 2031 2069 6e64  d 1, where 1 ind
-00025570: 6963 6174 6573 2070 6572 6665 6374 2063  icates perfect c
-00025580: 6c75 7374 6572 696e 6720 6167 7265 656d  lustering agreem
-00025590: 656e 742e 0a0a 2020 2020 2020 2020 2222  ent...        ""
-000255a0: 220a 2020 2020 2020 2020 6368 6563 6b5f  ".        check_
-000255b0: 7661 6c69 645f 6172 7261 7928 0a20 2020  valid_array(.   
-000255c0: 2020 2020 2020 2020 2064 6174 613d 782c           data=x,
-000255d0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
-000255e0: 7263 653d 5374 6174 6973 7469 6373 2e61  rce=Statistics.a
-000255f0: 646a 7573 7465 645f 6d75 7475 616c 5f69  djusted_mutual_i
-00025600: 6e66 6f2e 5f5f 6e61 6d65 5f5f 2c0a 2020  nfo.__name__,.  
-00025610: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-00025620: 6564 5f6e 6469 6d73 3d28 312c 292c 0a20  ed_ndims=(1,),. 
-00025630: 2020 2020 2020 2020 2020 2061 6363 6570             accep
-00025640: 7465 645f 6474 7970 6573 3d28 6e70 2e69  ted_dtypes=(np.i
-00025650: 6e74 3634 2c20 6e70 2e69 6e74 3332 2c20  nt64, np.int32, 
-00025660: 696e 7429 2c0a 2020 2020 2020 2020 2020  int),.          
-00025670: 2020 6d69 6e5f 6178 6973 5f30 3d31 2c0a    min_axis_0=1,.
-00025680: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00025690: 2020 6368 6563 6b5f 7661 6c69 645f 6172    check_valid_ar
-000256a0: 7261 7928 0a20 2020 2020 2020 2020 2020  ray(.           
-000256b0: 2064 6174 613d 792c 0a20 2020 2020 2020   data=y,.       
-000256c0: 2020 2020 2073 6f75 7263 653d 5374 6174       source=Stat
-000256d0: 6973 7469 6373 2e61 646a 7573 7465 645f  istics.adjusted_
-000256e0: 6d75 7475 616c 5f69 6e66 6f2e 5f5f 6e61  mutual_info.__na
-000256f0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
-00025700: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
-00025710: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
-00025720: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
-00025730: 6573 3d28 6e70 2e69 6e74 3634 2c20 6e70  es=(np.int64, np
-00025740: 2e69 6e74 3332 2c20 696e 7429 2c0a 2020  .int32, int),.  
-00025750: 2020 2020 2020 2020 2020 6163 6365 7074            accept
-00025760: 6564 5f73 6861 7065 733d 5b28 782e 7368  ed_shapes=[(x.sh
-00025770: 6170 655b 305d 2c29 5d2c 0a20 2020 2020  ape[0],)],.     
-00025780: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-00025790: 7572 6e20 6164 6a75 7374 6564 5f6d 7574  urn adjusted_mut
-000257a0: 7561 6c5f 696e 666f 5f73 636f 7265 286c  ual_info_score(l
-000257b0: 6162 656c 735f 7472 7565 3d78 2c20 6c61  abels_true=x, la
-000257c0: 6265 6c73 5f70 7265 643d 7929 0a0a 0a23  bels_pred=y)...#
-000257d0: 2073 616d 706c 655f 3120 3d20 6e70 2e72   sample_1 = np.r
-000257e0: 616e 646f 6d2e 7261 6e64 6f6d 5f69 6e74  andom.random_int
-000257f0: 6567 6572 7328 6c6f 773d 312c 2068 6967  egers(low=1, hig
-00025800: 683d 322c 2073 697a 653d 2831 302c 2035  h=2, size=(10, 5
-00025810: 3029 292e 6173 7479 7065 286e 702e 666c  0)).astype(np.fl
-00025820: 6f61 7436 3429 0a23 2073 616d 706c 655f  oat64).# sample_
-00025830: 3220 3d20 6e70 2e72 616e 646f 6d2e 7261  2 = np.random.ra
-00025840: 6e64 6f6d 5f69 6e74 6567 6572 7328 6c6f  ndom_integers(lo
-00025850: 773d 372c 2068 6967 683d 3230 2c20 7369  w=7, high=20, si
-00025860: 7a65 3d28 3130 2c20 3530 2929 2e61 7374  ze=(10, 50)).ast
-00025870: 7970 6528 6e70 2e66 6c6f 6174 3634 290a  ype(np.float64).
-00025880: 2320 6461 7461 203d 206e 702e 7673 7461  # data = np.vsta
-00025890: 636b 285b 7361 6d70 6c65 5f31 2c20 7361  ck([sample_1, sa
-000258a0: 6d70 6c65 5f32 5d29 0a23 2053 7461 7469  mple_2]).# Stati
-000258b0: 7374 6963 7328 292e 6862 6f73 2864 6174  stics().hbos(dat
-000258c0: 613d 6461 7461 290a 0a23 2073 616d 706c  a=data)..# sampl
-000258d0: 655f 3120 3d20 6e70 2e72 616e 646f 6d2e  e_1 = np.random.
-000258e0: 6e6f 726d 616c 286c 6f63 3d31 302c 2073  normal(loc=10, s
-000258f0: 6361 6c65 3d32 2c20 7369 7a65 3d31 3030  cale=2, size=100
-00025900: 3029 2e61 7374 7970 6528 6e70 2e66 6c6f  0).astype(np.flo
-00025910: 6174 3634 290a 2320 7361 6d70 6c65 5f32  at64).# sample_2
-00025920: 203d 206e 702e 7261 6e64 6f6d 2e6e 6f72   = np.random.nor
-00025930: 6d61 6c28 6c6f 633d 3132 2c20 7363 616c  mal(loc=12, scal
-00025940: 653d 322c 2073 697a 653d 3130 3030 3029  e=2, size=10000)
-00025950: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-00025960: 3634 290a 0a23 2073 616d 706c 655f 3120  64)..# sample_1 
-00025970: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
-00025980: 696e 7428 302c 2031 3030 2c20 2831 3030  int(0, 100, (100
-00025990: 2c20 2929 2e61 7374 7970 6528 6e70 2e66  , )).astype(np.f
-000259a0: 6c6f 6174 3634 290a 2320 7361 6d70 6c65  loat64).# sample
-000259b0: 5f32 203d 206e 702e 7261 6e64 6f6d 2e72  _2 = np.random.r
-000259c0: 616e 6469 6e74 2831 3130 2c20 3230 302c  andint(110, 200,
-000259d0: 2028 3130 302c 2029 292e 6173 7479 7065   (100, )).astype
-000259e0: 286e 702e 666c 6f61 7436 3429 0a23 0a23  (np.float64).#.#
-000259f0: 2053 7461 7469 7374 6963 7328 292e 6a65   Statistics().je
-00025a00: 6e73 656e 5f73 6861 6e6e 6f6e 5f64 6976  nsen_shannon_div
-00025a10: 6572 6765 6e63 6528 7361 6d70 6c65 5f31  ergence(sample_1
-00025a20: 3d73 616d 706c 655f 312c 2073 616d 706c  =sample_1, sampl
-00025a30: 655f 323d 7361 6d70 6c65 5f32 290a       e_2=sample_2).
+0000caf0: 2020 2020 3a72 6574 7572 6e73 2066 6c6f      :returns flo
+0000cb00: 6174 3a20 5468 6520 4d61 6e6e 2d57 6869  at: The Mann-Whi
+0000cb10: 746e 6579 2055 2073 7461 7469 7374 6963  tney U statistic
+0000cb20: 2e0a 0a20 2020 2020 2020 203a 7265 6665  ...        :refe
+0000cb30: 7265 6e63 6573 3a0a 2020 2020 2020 2020  rences:.        
+0000cb40: 604d 6f64 6966 6965 6420 6672 6f6d 204a  `Modified from J
+0000cb50: 616d 6573 2057 6562 6265 7220 6769 7374  ames Webber gist
+0000cb60: 206f 6e20 4769 7448 7562 203c 6874 7470   on GitHub <http
+0000cb70: 733a 2f2f 6769 7374 2e67 6974 6875 622e  s://gist.github.
+0000cb80: 636f 6d2f 6a61 6d65 7374 7765 6262 6572  com/jamestwebber
+0000cb90: 2f33 3861 6232 3664 3238 3166 3937 6665  /38ab26d281f97fe
+0000cba0: 6238 3139 3662 3364 3933 6564 6565 6237  b8196b3d93edeeb7
+0000cbb0: 623e 605f 5f2e 0a0a 2020 2020 2020 2020  b>`__...        
+0000cbc0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+0000cbd0: 2020 3e3e 3e20 7361 6d70 6c65 5f31 203d    >>> sample_1 =
+0000cbe0: 206e 702e 6172 7261 7928 5b31 2c20 312c   np.array([1, 1,
+0000cbf0: 2033 2c20 342c 2035 5d29 0a20 2020 2020   3, 4, 5]).     
+0000cc00: 2020 203e 3e3e 2073 616d 706c 655f 3220     >>> sample_2 
+0000cc10: 3d20 6e70 2e61 7272 6179 285b 362c 2037  = np.array([6, 7
+0000cc20: 2c20 382c 2039 2c20 3130 5d29 0a20 2020  , 8, 9, 10]).   
+0000cc30: 2020 2020 203e 3e3e 2072 6573 756c 7473       >>> results
+0000cc40: 203d 2053 7461 7469 7374 6963 7328 292e   = Statistics().
+0000cc50: 6d61 6e6e 5f77 6869 746e 6579 2873 616d  mann_whitney(sam
+0000cc60: 706c 655f 313d 7361 6d70 6c65 5f31 2c20  ple_1=sample_1, 
+0000cc70: 7361 6d70 6c65 5f32 3d73 616d 706c 655f  sample_2=sample_
+0000cc80: 3229 0a20 2020 2020 2020 2022 2222 0a0a  2).        """..
+0000cc90: 2020 2020 2020 2020 6e31 2c20 6e32 203d          n1, n2 =
+0000cca0: 2073 616d 706c 655f 312e 7368 6170 655b   sample_1.shape[
+0000ccb0: 305d 2c20 7361 6d70 6c65 5f32 2e73 6861  0], sample_2.sha
+0000ccc0: 7065 5b30 5d0a 2020 2020 2020 2020 7261  pe[0].        ra
+0000ccd0: 6e6b 6564 203d 2066 6173 745f 6d65 616e  nked = fast_mean
+0000cce0: 5f72 616e 6b28 6e70 2e63 6f6e 6361 7465  _rank(np.concate
+0000ccf0: 6e61 7465 2828 7361 6d70 6c65 5f31 2c20  nate((sample_1, 
+0000cd00: 7361 6d70 6c65 5f32 2929 290a 2020 2020  sample_2))).    
+0000cd10: 2020 2020 7531 203d 206e 3120 2a20 6e32      u1 = n1 * n2
+0000cd20: 202b 2028 6e31 202a 2028 6e31 202b 2031   + (n1 * (n1 + 1
+0000cd30: 2929 202f 2032 2e30 202d 206e 702e 7375  )) / 2.0 - np.su
+0000cd40: 6d28 7261 6e6b 6564 5b3a 6e31 5d2c 2061  m(ranked[:n1], a
+0000cd50: 7869 733d 3029 0a20 2020 2020 2020 2075  xis=0).        u
+0000cd60: 3220 3d20 6e31 202a 206e 3220 2d20 7531  2 = n1 * n2 - u1
+0000cd70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000cd80: 6d69 6e28 7531 2c20 7532 290a 0a20 2020  min(u1, u2)..   
+0000cd90: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+0000cda0: 2020 2040 6a69 7428 6e6f 7079 7468 6f6e     @jit(nopython
+0000cdb0: 3d54 7275 652c 2063 6163 6865 3d54 7275  =True, cache=Tru
+0000cdc0: 6529 0a20 2020 2064 6566 206c 6576 656e  e).    def leven
+0000cdd0: 6573 280a 2020 2020 2020 2020 7361 6d70  es(.        samp
+0000cde0: 6c65 5f31 3a20 6e70 2e6e 6461 7272 6179  le_1: np.ndarray
+0000cdf0: 2c0a 2020 2020 2020 2020 7361 6d70 6c65  ,.        sample
+0000ce00: 5f32 3a20 6e70 2e6e 6461 7272 6179 2c0a  _2: np.ndarray,.
+0000ce10: 2020 2020 2020 2020 6372 6974 6963 616c          critical
+0000ce20: 5f76 616c 7565 733a 204f 7074 696f 6e61  _values: Optiona
+0000ce30: 6c5b 6e70 2e6e 6461 7272 6179 5d20 3d20  l[np.ndarray] = 
+0000ce40: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2028  None,.    ) -> (
+0000ce50: 666c 6f61 742c 2055 6e69 6f6e 5b62 6f6f  float, Union[boo
+0000ce60: 6c2c 204e 6f6e 655d 293a 0a20 2020 2020  l, None]):.     
+0000ce70: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+0000ce80: 6f6d 7075 7465 204c 6576 656e 6527 7320  ompute Levene's 
+0000ce90: 5720 7374 6174 6973 7469 632c 2061 2074  W statistic, a t
+0000cea0: 6573 7420 666f 7220 7468 6520 6571 7561  est for the equa
+0000ceb0: 6c69 7479 206f 6620 7661 7269 616e 6365  lity of variance
+0000cec0: 7320 6265 7477 6565 6e20 7477 6f20 7361  s between two sa
+0000ced0: 6d70 6c65 732e 0a0a 2020 2020 2020 2020  mples...        
+0000cee0: 4c65 7665 6e65 2773 2074 6573 7420 6973  Levene's test is
+0000cef0: 2061 2073 7461 7469 7374 6963 616c 2074   a statistical t
+0000cf00: 6573 7420 7573 6564 2074 6f20 6465 7465  est used to dete
+0000cf10: 726d 696e 6520 7768 6574 6865 7220 7477  rmine whether tw
+0000cf20: 6f20 6f72 206d 6f72 6520 6772 6f75 7073  o or more groups
+0000cf30: 2068 6176 6520 6571 7561 6c20 7661 7269   have equal vari
+0000cf40: 616e 6365 732e 2049 7420 6973 206f 6674  ances. It is oft
+0000cf50: 656e 0a20 2020 2020 2020 2075 7365 6420  en.        used 
+0000cf60: 6173 2061 6e20 616c 7465 726e 6174 6976  as an alternativ
+0000cf70: 6520 746f 2074 6865 2042 6172 746c 6574  e to the Bartlet
+0000cf80: 7420 7465 7374 2077 6865 6e20 7468 6520  t test when the 
+0000cf90: 6173 7375 6d70 7469 6f6e 206f 6620 6e6f  assumption of no
+0000cfa0: 726d 616c 6974 7920 6973 2076 696f 6c61  rmality is viola
+0000cfb0: 7465 642e 2054 6865 2066 756e 6374 696f  ted. The functio
+0000cfc0: 6e20 636f 6d70 7574 6573 2074 6865 0a20  n computes the. 
+0000cfd0: 2020 2020 2020 204c 6576 656e 6527 7320         Levene's 
+0000cfe0: 5720 7374 6174 6973 7469 632c 2077 6869  W statistic, whi
+0000cff0: 6368 206d 6561 7375 7265 7320 7468 6520  ch measures the 
+0000d000: 6465 6772 6565 206f 6620 6469 6666 6572  degree of differ
+0000d010: 656e 6365 2069 6e20 7661 7269 616e 6365  ence in variance
+0000d020: 7320 6265 7477 6565 6e20 7468 6520 7477  s between the tw
+0000d030: 6f20 7361 6d70 6c65 732e 0a0a 2020 2020  o samples...    
+0000d040: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+0000d050: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
+0000d060: 2046 6972 7374 2031 6420 6172 7261 7920   First 1d array 
+0000d070: 7265 7072 6573 656e 7469 6e67 2066 6561  representing fea
+0000d080: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
+0000d090: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
+0000d0a0: 6e64 6172 7261 7920 7361 6d70 6c65 5f32  ndarray sample_2
+0000d0b0: 3a20 5365 636f 6e64 2031 6420 6172 7261  : Second 1d arra
+0000d0c0: 7920 7265 7072 6573 656e 7469 6e67 2066  y representing f
+0000d0d0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+0000d0e0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0000d0f0: 7220 6e64 6172 7261 7920 6372 6974 6963  r ndarray critic
+0000d100: 616c 5f76 616c 7565 733a 2032 4420 6172  al_values: 2D ar
+0000d110: 7261 7920 7769 7468 2077 6865 7265 2066  ray with where f
+0000d120: 6972 7374 2063 6f6c 756d 6e20 7265 7072  irst column repr
+0000d130: 6573 656e 7420 6466 6e20 6669 7273 7420  esent dfn first 
+0000d140: 726f 7720 6466 6420 7769 7468 2076 616c  row dfd with val
+0000d150: 7565 7320 7265 7072 6573 656e 7420 6372  ues represent cr
+0000d160: 6974 6963 616c 2076 616c 7565 732e 2043  itical values. C
+0000d170: 616e 2062 6520 666f 756e 6420 696e 2060  an be found in `
+0000d180: 6073 696d 6261 2e61 7373 6574 732e 6372  `simba.assets.cr
+0000d190: 6974 6963 616c 5f76 616c 7565 735f 3035  itical_values_05
+0000d1a0: 2e70 6963 6b6c 6560 600a 2020 2020 2020  .pickle``.      
+0000d1b0: 2020 3a72 6574 7572 6e73 2074 7570 6c65    :returns tuple
+0000d1c0: 5b66 6c6f 6174 2c20 556e 696f 6e5b 626f  [float, Union[bo
+0000d1d0: 6f6c 2c20 4e6f 6e65 5d5d 3a20 4c65 7665  ol, None]]: Leve
+0000d1e0: 6e65 2773 2057 2073 7461 7469 7374 6963  ne's W statistic
+0000d1f0: 2061 6e64 2061 2062 6f6f 6c65 616e 2069   and a boolean i
+0000d200: 6e64 6963 6174 696e 6720 7768 6574 6865  ndicating whethe
+0000d210: 7220 7468 6520 7465 7374 2069 7320 7374  r the test is st
+0000d220: 6174 6973 7469 6361 6c6c 7920 7369 676e  atistically sign
+0000d230: 6966 6963 616e 7420 2869 6620 6372 6974  ificant (if crit
+0000d240: 6963 616c 2076 616c 7565 7320 6973 206e  ical values is n
+0000d250: 6f74 204e 6f6e 6529 2e0a 0a20 2020 2020  ot None)...     
+0000d260: 2020 203a 6578 616d 706c 6573 3a0a 2020     :examples:.  
+0000d270: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
+0000d280: 5f31 203d 206e 702e 6172 7261 7928 6c69  _1 = np.array(li
+0000d290: 7374 2872 616e 6765 2830 2c20 3530 2929  st(range(0, 50))
+0000d2a0: 290a 2020 2020 2020 2020 3e3e 3e20 7361  ).        >>> sa
+0000d2b0: 6d70 6c65 5f32 203d 206e 702e 6172 7261  mple_2 = np.arra
+0000d2c0: 7928 6c69 7374 2872 616e 6765 2832 352c  y(list(range(25,
+0000d2d0: 2031 3030 2929 290a 2020 2020 2020 2020   100))).        
+0000d2e0: 3e3e 3e20 5374 6174 6973 7469 6373 2829  >>> Statistics()
+0000d2f0: 2e6c 6576 656e 6573 2873 616d 706c 655f  .levenes(sample_
+0000d300: 313d 7361 6d70 6c65 5f31 2c20 7361 6d70  1=sample_1, samp
+0000d310: 6c65 5f32 3d73 616d 706c 655f 3229 0a20  le_2=sample_2). 
+0000d320: 2020 2020 2020 203e 3e3e 2031 322e 3633         >>> 12.63
+0000d330: 3930 3931 3038 3930 3332 3534 0a20 2020  909108903254.   
+0000d340: 2020 2020 203e 3e3e 2063 7269 7469 6361       >>> critica
+0000d350: 6c5f 7661 6c75 6573 203d 2070 6963 6b6c  l_values = pickl
+0000d360: 652e 6c6f 6164 286f 7065 6e28 2273 696d  e.load(open("sim
+0000d370: 6261 2f61 7373 6574 732f 6c6f 6f6b 7570  ba/assets/lookup
+0000d380: 732f 6372 6974 6963 616c 5f76 616c 7565  s/critical_value
+0000d390: 735f 352e 7069 636b 6c65 222c 2272 6222  s_5.pickle","rb"
+0000d3a0: 2929 5b27 6627 5d5b 276f 6e65 5f74 6169  ))['f']['one_tai
+0000d3b0: 6c27 5d2e 7661 6c75 6573 0a20 2020 2020  l'].values.     
+0000d3c0: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+0000d3d0: 7328 292e 6c65 7665 6e65 7328 7361 6d70  s().levenes(samp
+0000d3e0: 6c65 5f31 3d73 616d 706c 655f 312c 2073  le_1=sample_1, s
+0000d3f0: 616d 706c 655f 323d 7361 6d70 6c65 5f32  ample_2=sample_2
+0000d400: 2c20 6372 6974 6963 616c 5f76 616c 7565  , critical_value
+0000d410: 733d 6372 6974 6963 616c 5f76 616c 7565  s=critical_value
+0000d420: 7329 0a20 2020 2020 2020 203e 3e3e 2028  s).        >>> (
+0000d430: 3132 2e36 3339 3039 3130 3839 3033 3235  12.6390910890325
+0000d440: 342c 2054 7275 6529 0a20 2020 2020 2020  4, True).       
+0000d450: 2022 2222 0a0a 2020 2020 2020 2020 7369   """..        si
+0000d460: 676e 6966 6963 616e 6365 5f62 6f6f 6c20  gnificance_bool 
+0000d470: 3d20 4e6f 6e65 0a20 2020 2020 2020 204e  = None.        N
+0000d480: 695f 782c 204e 695f 7920 3d20 6c65 6e28  i_x, Ni_y = len(
+0000d490: 7361 6d70 6c65 5f31 292c 206c 656e 2873  sample_1), len(s
+0000d4a0: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
+0000d4b0: 2059 6369 5f78 2c20 5963 695f 7920 3d20   Yci_x, Yci_y = 
+0000d4c0: 6e70 2e6d 6564 6961 6e28 7361 6d70 6c65  np.median(sample
+0000d4d0: 5f31 292c 206e 702e 6d65 6469 616e 2873  _1), np.median(s
+0000d4e0: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
+0000d4f0: 204e 746f 7420 3d20 4e69 5f78 202b 204e   Ntot = Ni_x + N
+0000d500: 695f 790a 2020 2020 2020 2020 5a69 6a5f  i_y.        Zij_
+0000d510: 782c 205a 696a 5f79 203d 206e 702e 6162  x, Zij_y = np.ab
+0000d520: 7328 7361 6d70 6c65 5f31 202d 2059 6369  s(sample_1 - Yci
+0000d530: 5f78 292e 6173 7479 7065 286e 702e 666c  _x).astype(np.fl
+0000d540: 6f61 7433 3229 2c20 6e70 2e61 6273 280a  oat32), np.abs(.
+0000d550: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+0000d560: 6c65 5f32 202d 2059 6369 5f79 0a20 2020  le_2 - Yci_y.   
+0000d570: 2020 2020 2029 2e61 7374 7970 6528 6e70       ).astype(np
+0000d580: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+0000d590: 2020 5a62 6172 695f 782c 205a 6261 7269    Zbari_x, Zbari
+0000d5a0: 5f79 203d 206e 702e 6d65 616e 285a 696a  _y = np.mean(Zij
+0000d5b0: 5f78 292c 206e 702e 6d65 616e 285a 696a  _x), np.mean(Zij
+0000d5c0: 5f79 290a 2020 2020 2020 2020 5a62 6172  _y).        Zbar
+0000d5d0: 203d 2028 285a 6261 7269 5f78 202a 204e   = ((Zbari_x * N
+0000d5e0: 695f 7829 202b 2028 5a62 6172 695f 7920  i_x) + (Zbari_y 
+0000d5f0: 2a20 4e69 5f79 2929 202f 204e 746f 740a  * Ni_y)) / Ntot.
+0000d600: 2020 2020 2020 2020 6e75 6d65 7220 3d20          numer = 
+0000d610: 284e 746f 7420 2d20 3229 202a 206e 702e  (Ntot - 2) * np.
+0000d620: 7375 6d28 0a20 2020 2020 2020 2020 2020  sum(.           
+0000d630: 206e 702e 6172 7261 7928 5b4e 695f 782c   np.array([Ni_x,
+0000d640: 204e 695f 795d 2920 2a20 286e 702e 6172   Ni_y]) * (np.ar
+0000d650: 7261 7928 5b5a 6261 7269 5f78 2c20 5a62  ray([Zbari_x, Zb
+0000d660: 6172 695f 795d 2920 2d20 5a62 6172 2920  ari_y]) - Zbar) 
+0000d670: 2a2a 2032 0a20 2020 2020 2020 2029 0a20  ** 2.        ). 
+0000d680: 2020 2020 2020 2064 7661 7220 3d20 6e70         dvar = np
+0000d690: 2e73 756d 2828 5a69 6a5f 7820 2d20 5a62  .sum((Zij_x - Zb
+0000d6a0: 6172 695f 7829 202a 2a20 3229 202b 206e  ari_x) ** 2) + n
+0000d6b0: 702e 7375 6d28 285a 696a 5f79 202d 205a  p.sum((Zij_y - Z
+0000d6c0: 6261 7269 5f79 2920 2a2a 2032 290a 2020  bari_y) ** 2).  
+0000d6d0: 2020 2020 2020 6465 6e6f 6d20 3d20 2832        denom = (2
+0000d6e0: 202d 2031 2e30 2920 2a20 6476 6172 0a20   - 1.0) * dvar. 
+0000d6f0: 2020 2020 2020 206c 5f73 7461 7469 7374         l_statist
+0000d700: 6963 203d 206e 756d 6572 202f 2064 656e  ic = numer / den
+0000d710: 6f6d 0a0a 2020 2020 2020 2020 6966 2063  om..        if c
+0000d720: 7269 7469 6361 6c5f 7661 6c75 6573 2069  ritical_values i
+0000d730: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0000d740: 2020 2020 2020 2020 6466 6e2c 2064 6664          dfn, dfd
+0000d750: 203d 2031 2c20 284e 695f 7820 2b20 4e69   = 1, (Ni_x + Ni
+0000d760: 5f79 2920 2d20 320a 2020 2020 2020 2020  _y) - 2.        
+0000d770: 2020 2020 6964 7820 3d20 286e 702e 6162      idx = (np.ab
+0000d780: 7328 6372 6974 6963 616c 5f76 616c 7565  s(critical_value
+0000d790: 735b 305d 5b31 3a5d 202d 2064 6664 2929  s[0][1:] - dfd))
+0000d7a0: 2e61 7267 6d69 6e28 2920 2b20 310a 2020  .argmin() + 1.  
+0000d7b0: 2020 2020 2020 2020 2020 6372 6974 6963            critic
+0000d7c0: 616c 5f76 616c 7565 7320 3d20 6372 6974  al_values = crit
+0000d7d0: 6963 616c 5f76 616c 7565 735b 313a 2c20  ical_values[1:, 
+0000d7e0: 6e70 2e61 7272 6179 285b 302c 2069 6478  np.array([0, idx
+0000d7f0: 5d29 5d0a 2020 2020 2020 2020 2020 2020  ])].            
+0000d800: 6372 6974 6963 616c 5f76 616c 7565 203d  critical_value =
+0000d810: 206e 702e 696e 7465 7270 280a 2020 2020   np.interp(.    
+0000d820: 2020 2020 2020 2020 2020 2020 6466 642c              dfd,
+0000d830: 2063 7269 7469 6361 6c5f 7661 6c75 6573   critical_values
+0000d840: 5b3a 2c20 305d 2c20 6372 6974 6963 616c  [:, 0], critical
+0000d850: 5f76 616c 7565 735b 3a2c 2031 5d0a 2020  _values[:, 1].  
+0000d860: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000d870: 2020 2020 2020 2020 6966 206c 5f73 7461          if l_sta
+0000d880: 7469 7374 6963 203e 3d20 6372 6974 6963  tistic >= critic
+0000d890: 616c 5f76 616c 7565 3a0a 2020 2020 2020  al_value:.      
+0000d8a0: 2020 2020 2020 2020 2020 7369 676e 6966            signif
+0000d8b0: 6963 616e 6365 5f62 6f6f 6c20 3d20 5472  icance_bool = Tr
+0000d8c0: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
+0000d8d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000d8e0: 2020 2020 2073 6967 6e69 6669 6361 6e63       significanc
+0000d8f0: 655f 626f 6f6c 203d 2046 616c 7365 0a0a  e_bool = False..
+0000d900: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+0000d910: 6c5f 7374 6174 6973 7469 632c 2073 6967  l_statistic, sig
+0000d920: 6e69 6669 6361 6e63 655f 626f 6f6c 290a  nificance_bool).
+0000d930: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+0000d940: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+0000d950: 6c6f 6174 3634 5b3a 5d2c 2066 6c6f 6174  loat64[:], float
+0000d960: 3634 5b3a 5d2c 2066 6c6f 6174 3634 2922  64[:], float64)"
+0000d970: 2c20 6361 6368 653d 5472 7565 290a 2020  , cache=True).  
+0000d980: 2020 6465 6620 726f 6c6c 696e 675f 6c65    def rolling_le
+0000d990: 7665 6e65 7328 0a20 2020 2020 2020 2064  venes(.        d
+0000d9a0: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+0000d9b0: 2074 696d 655f 7769 6e64 6f77 733a 206e   time_windows: n
+0000d9c0: 702e 6e64 6172 7261 792c 2066 7073 3a20  p.ndarray, fps: 
+0000d9d0: 666c 6f61 740a 2020 2020 2920 2d3e 2066  float.    ) -> f
+0000d9e0: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
+0000d9f0: 220a 2020 2020 2020 2020 4a69 7474 6564  ".        Jitted
+0000da00: 2063 6f6d 7075 7465 206f 6620 726f 6c6c   compute of roll
+0000da10: 696e 6720 4c65 7665 6e65 2773 2057 2063  ing Levene's W c
+0000da20: 6f6d 7061 7269 6e67 2074 6865 2063 7572  omparing the cur
+0000da30: 7265 6e74 2074 696d 652d 7769 6e64 6f77  rent time-window
+0000da40: 206f 6620 7369 7a65 204e 2074 6f20 7468   of size N to th
+0000da50: 6520 7072 6563 6564 696e 6720 7769 6e64  e preceding wind
+0000da60: 6f77 206f 6620 7369 7a65 204e 2e0a 0a20  ow of size N... 
+0000da70: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+0000da80: 0a20 2020 2020 2020 2020 2020 4669 7273  .           Firs
+0000da90: 7420 7469 6d65 2062 696e 2028 7768 6572  t time bin (wher
+0000daa0: 6520 6861 7320 6e6f 2070 7265 6365 6469  e has no precedi
+0000dab0: 6e67 2074 696d 6520 6269 6e29 2077 696c  ng time bin) wil
+0000dac0: 6c20 6861 7665 2066 696c 6c20 7661 6c75  l have fill valu
+0000dad0: 6520 6060 3060 600a 0a20 2020 2020 2020  e ``0``..       
+0000dae0: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
+0000daf0: 7261 7920 7361 6d70 6c65 5f31 3a20 4669  ray sample_1: Fi
+0000db00: 7273 7420 3164 2061 7272 6179 2072 6570  rst 1d array rep
+0000db10: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
+0000db20: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+0000db30: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
+0000db40: 7272 6179 2073 616d 706c 655f 323a 2053  rray sample_2: S
+0000db50: 6563 6f6e 6420 3164 2061 7272 6179 2072  econd 1d array r
+0000db60: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
+0000db70: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
+0000db80: 2020 2020 3a72 6574 7572 6e73 206e 702e      :returns np.
+0000db90: 6e64 6172 7261 793a 204c 6576 656e 6527  ndarray: Levene'
+0000dba0: 7320 5720 6461 7461 206f 6620 7369 7a65  s W data of size
+0000dbb0: 206c 656e 2864 6174 6129 2078 206c 656e   len(data) x len
+0000dbc0: 2874 696d 655f 7769 6e64 6f77 7329 2e0a  (time_windows)..
+0000dbd0: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
+0000dbe0: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
+0000dbf0: 6174 6120 3d20 6e70 2e72 616e 646f 6d2e  ata = np.random.
+0000dc00: 7261 6e64 696e 7428 302c 2035 302c 2028  randint(0, 50, (
+0000dc10: 3130 3029 292e 6173 7479 7065 286e 702e  100)).astype(np.
+0000dc20: 666c 6f61 7436 3429 0a20 2020 2020 2020  float64).       
+0000dc30: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+0000dc40: 292e 726f 6c6c 696e 675f 6c65 7665 6e65  ).rolling_levene
+0000dc50: 7328 6461 7461 3d64 6174 612c 2074 696d  s(data=data, tim
+0000dc60: 655f 7769 6e64 6f77 733d 6e70 2e61 7272  e_windows=np.arr
+0000dc70: 6179 285b 315d 292e 6173 7479 7065 286e  ay([1]).astype(n
+0000dc80: 702e 666c 6f61 7436 3429 2c20 6670 733d  p.float64), fps=
+0000dc90: 352e 3029 0a20 2020 2020 2020 2022 2222  5.0).        """
+0000dca0: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+0000dcb0: 7320 3d20 6e70 2e66 756c 6c28 2864 6174  s = np.full((dat
+0000dcc0: 612e 7368 6170 655b 305d 2c20 7469 6d65  a.shape[0], time
+0000dcd0: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
+0000dce0: 5d29 2c20 302e 3029 0a20 2020 2020 2020  ]), 0.0).       
+0000dcf0: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
+0000dd00: 2874 696d 655f 7769 6e64 6f77 732e 7368  (time_windows.sh
+0000dd10: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+0000dd20: 2020 2020 2077 696e 646f 775f 7369 7a65       window_size
+0000dd30: 203d 2069 6e74 2874 696d 655f 7769 6e64   = int(time_wind
+0000dd40: 6f77 735b 695d 202a 2066 7073 290a 2020  ows[i] * fps).  
+0000dd50: 2020 2020 2020 2020 2020 6461 7461 5f73            data_s
+0000dd60: 706c 6974 203d 206e 702e 7370 6c69 7428  plit = np.split(
+0000dd70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dd80: 2064 6174 612c 206c 6973 7428 7261 6e67   data, list(rang
+0000dd90: 6528 7769 6e64 6f77 5f73 697a 652c 2064  e(window_size, d
+0000dda0: 6174 612e 7368 6170 655b 305d 2c20 7769  ata.shape[0], wi
+0000ddb0: 6e64 6f77 5f73 697a 6529 290a 2020 2020  ndow_size)).    
+0000ddc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ddd0: 2020 2020 2020 666f 7220 6a20 696e 2070        for j in p
+0000dde0: 7261 6e67 6528 312c 206c 656e 2864 6174  range(1, len(dat
+0000ddf0: 615f 7370 6c69 7429 293a 0a20 2020 2020  a_split)):.     
+0000de00: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+0000de10: 775f 7374 6172 7420 3d20 696e 7428 7769  w_start = int(wi
+0000de20: 6e64 6f77 5f73 697a 6520 2a20 6a29 0a20  ndow_size * j). 
+0000de30: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0000de40: 696e 646f 775f 656e 6420 3d20 696e 7428  indow_end = int(
+0000de50: 7769 6e64 6f77 5f73 7461 7274 202b 2077  window_start + w
+0000de60: 696e 646f 775f 7369 7a65 290a 2020 2020  indow_size).    
+0000de70: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+0000de80: 6c65 5f31 2c20 7361 6d70 6c65 5f32 203d  le_1, sample_2 =
+0000de90: 2064 6174 615f 7370 6c69 745b 6a20 2d20   data_split[j - 
+0000dea0: 315d 2e61 7374 7970 6528 6e70 2e66 6c6f  1].astype(np.flo
+0000deb0: 6174 3332 292c 2064 6174 615f 7370 6c69  at32), data_spli
+0000dec0: 745b 0a20 2020 2020 2020 2020 2020 2020  t[.             
+0000ded0: 2020 2020 2020 206a 0a20 2020 2020 2020         j.       
+0000dee0: 2020 2020 2020 2020 205d 2e61 7374 7970           ].astyp
+0000def0: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+0000df00: 2020 2020 2020 2020 2020 2020 2020 4e69                Ni
+0000df10: 5f78 2c20 4e69 5f79 203d 206c 656e 2873  _x, Ni_y = len(s
+0000df20: 616d 706c 655f 3129 2c20 6c65 6e28 7361  ample_1), len(sa
+0000df30: 6d70 6c65 5f32 290a 2020 2020 2020 2020  mple_2).        
+0000df40: 2020 2020 2020 2020 5963 695f 782c 2059          Yci_x, Y
+0000df50: 6369 5f79 203d 206e 702e 6d65 6469 616e  ci_y = np.median
+0000df60: 2873 616d 706c 655f 3129 2c20 6e70 2e6d  (sample_1), np.m
+0000df70: 6564 6961 6e28 7361 6d70 6c65 5f32 290a  edian(sample_2).
+0000df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df90: 4e74 6f74 203d 204e 695f 7820 2b20 4e69  Ntot = Ni_x + Ni
+0000dfa0: 5f79 0a20 2020 2020 2020 2020 2020 2020  _y.             
+0000dfb0: 2020 205a 696a 5f78 2c20 5a69 6a5f 7920     Zij_x, Zij_y 
+0000dfc0: 3d20 6e70 2e61 6273 2873 616d 706c 655f  = np.abs(sample_
+0000dfd0: 3120 2d20 5963 695f 7829 2e61 7374 7970  1 - Yci_x).astyp
+0000dfe0: 6528 6e70 2e66 6c6f 6174 3332 292c 206e  e(np.float32), n
+0000dff0: 702e 6162 7328 0a20 2020 2020 2020 2020  p.abs(.         
+0000e000: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+0000e010: 655f 3220 2d20 5963 695f 790a 2020 2020  e_2 - Yci_y.    
+0000e020: 2020 2020 2020 2020 2020 2020 292e 6173              ).as
+0000e030: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0000e040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e050: 205a 6261 7269 5f78 2c20 5a62 6172 695f   Zbari_x, Zbari_
+0000e060: 7920 3d20 6e70 2e6d 6561 6e28 5a69 6a5f  y = np.mean(Zij_
+0000e070: 7829 2c20 6e70 2e6d 6561 6e28 5a69 6a5f  x), np.mean(Zij_
+0000e080: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
+0000e090: 2020 205a 6261 7220 3d20 2828 5a62 6172     Zbar = ((Zbar
+0000e0a0: 695f 7820 2a20 4e69 5f78 2920 2b20 285a  i_x * Ni_x) + (Z
+0000e0b0: 6261 7269 5f79 202a 204e 695f 7929 2920  bari_y * Ni_y)) 
+0000e0c0: 2f20 4e74 6f74 0a20 2020 2020 2020 2020  / Ntot.         
+0000e0d0: 2020 2020 2020 206e 756d 6572 203d 2028         numer = (
+0000e0e0: 4e74 6f74 202d 2032 2920 2a20 6e70 2e73  Ntot - 2) * np.s
+0000e0f0: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
+0000e100: 2020 2020 2020 2020 6e70 2e61 7272 6179          np.array
+0000e110: 285b 4e69 5f78 2c20 4e69 5f79 5d29 202a  ([Ni_x, Ni_y]) *
+0000e120: 2028 6e70 2e61 7272 6179 285b 5a62 6172   (np.array([Zbar
+0000e130: 695f 782c 205a 6261 7269 5f79 5d29 202d  i_x, Zbari_y]) -
+0000e140: 205a 6261 7229 202a 2a20 320a 2020 2020   Zbar) ** 2.    
+0000e150: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000e160: 2020 2020 2020 2020 2020 2020 2020 6476                dv
+0000e170: 6172 203d 206e 702e 7375 6d28 285a 696a  ar = np.sum((Zij
+0000e180: 5f78 202d 205a 6261 7269 5f78 2920 2a2a  _x - Zbari_x) **
+0000e190: 2032 2920 2b20 6e70 2e73 756d 2828 5a69   2) + np.sum((Zi
+0000e1a0: 6a5f 7920 2d20 5a62 6172 695f 7929 202a  j_y - Zbari_y) *
+0000e1b0: 2a20 3229 0a20 2020 2020 2020 2020 2020  * 2).           
+0000e1c0: 2020 2020 2064 656e 6f6d 203d 2028 3220       denom = (2 
+0000e1d0: 2d20 312e 3029 202a 2064 7661 720a 2020  - 1.0) * dvar.  
+0000e1e0: 2020 2020 2020 2020 2020 2020 2020 7720                w 
+0000e1f0: 3d20 6e75 6d65 7220 2f20 6465 6e6f 6d0a  = numer / denom.
+0000e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e210: 7265 7375 6c74 735b 7769 6e64 6f77 5f73  results[window_s
+0000e220: 7461 7274 3a77 696e 646f 775f 656e 642c  tart:window_end,
+0000e230: 2069 5d20 3d20 770a 2020 2020 2020 2020   i] = w.        
+0000e240: 7265 7475 726e 2072 6573 756c 7473 0a0a  return results..
+0000e250: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+0000e260: 640a 2020 2020 406a 6974 286e 6f70 7974  d.    @jit(nopyt
+0000e270: 686f 6e3d 5472 7565 2c20 6361 6368 653d  hon=True, cache=
+0000e280: 5472 7565 290a 2020 2020 6465 6620 6272  True).    def br
+0000e290: 756e 6e65 725f 6d75 6e7a 656c 2873 616d  unner_munzel(sam
+0000e2a0: 706c 655f 313a 206e 702e 6e64 6172 7261  ple_1: np.ndarra
+0000e2b0: 792c 2073 616d 706c 655f 323a 206e 702e  y, sample_2: np.
+0000e2c0: 6e64 6172 7261 7929 202d 3e20 666c 6f61  ndarray) -> floa
+0000e2d0: 743a 0a20 2020 2020 2020 2022 2222 0a20  t:.        """. 
+0000e2e0: 2020 2020 2020 204a 6974 7465 6420 636f         Jitted co
+0000e2f0: 6d70 7574 6520 6f66 2042 7275 6e6e 6572  mpute of Brunner
+0000e300: 2d4d 756e 7a65 6c20 5720 6265 7477 6565  -Munzel W betwee
+0000e310: 6e20 7477 6f20 6469 7374 7269 6275 7469  n two distributi
+0000e320: 6f6e 732e 0a0a 2020 2020 2020 2020 5468  ons...        Th
+0000e330: 6520 4272 756e 6e65 722d 4d75 6e7a 656c  e Brunner-Munzel
+0000e340: 2057 2073 7461 7469 7374 6963 2063 6f6d   W statistic com
+0000e350: 7061 7265 7320 7468 6520 6365 6e74 7261  pares the centra
+0000e360: 6c20 7465 6e64 656e 6379 2061 6e64 2074  l tendency and t
+0000e370: 6865 2073 7072 6561 6420 6f66 2074 776f  he spread of two
+0000e380: 2069 6e64 6570 656e 6465 6e74 2073 616d   independent sam
+0000e390: 706c 6573 2e20 4974 2069 7320 7573 6566  ples. It is usef
+0000e3a0: 756c 0a20 2020 2020 2020 2066 6f72 2063  ul.        for c
+0000e3b0: 6f6d 7061 7269 6e67 2074 6865 2064 6973  omparing the dis
+0000e3c0: 7472 6962 7574 696f 6e20 6f66 2061 2063  tribution of a c
+0000e3d0: 6f6e 7469 6e75 6f75 7320 7661 7269 6162  ontinuous variab
+0000e3e0: 6c65 2062 6574 7765 656e 2074 776f 2067  le between two g
+0000e3f0: 726f 7570 732c 2065 7370 6563 6961 6c6c  roups, especiall
+0000e400: 7920 7768 656e 2074 6865 2061 7373 756d  y when the assum
+0000e410: 7074 696f 6e73 206f 660a 2020 2020 2020  ptions of.      
+0000e420: 2020 7061 7261 6d65 7472 6963 2074 6573    parametric tes
+0000e430: 7473 206c 696b 6520 7468 6520 742d 7465  ts like the t-te
+0000e440: 7374 2061 7265 2076 696f 6c61 7465 642e  st are violated.
+0000e450: 0a0a 2020 2020 2020 2020 2e2e 206e 6f74  ..        .. not
+0000e460: 653a 3a0a 2020 2020 2020 2020 2020 204d  e::.           M
+0000e470: 6f64 6966 6965 6420 6672 6f6d 2060 7363  odified from `sc
+0000e480: 6970 792e 7374 6174 732e 6272 756e 6e65  ipy.stats.brunne
+0000e490: 726d 756e 7a65 6c20 3c68 7474 7073 3a2f  rmunzel <https:/
+0000e4a0: 2f67 6974 6875 622e 636f 6d2f 7363 6970  /github.com/scip
+0000e4b0: 792f 7363 6970 792f 626c 6f62 2f37 6463  y/scipy/blob/7dc
+0000e4c0: 6438 6335 3939 3333 3532 3439 3836 3932  d8c5993352498692
+0000e4d0: 3363 6465 3865 3931 3236 6635 6663 3265  3cde8e9126f5fc2e
+0000e4e0: 3662 3330 622f 7363 6970 792f 7374 6174  6b30b/scipy/stat
+0000e4f0: 732f 5f73 7461 7473 5f70 792e 7079 234c  s/_stats_py.py#L
+0000e500: 3933 3837 3e60 5f0a 0a20 2020 2020 2020  9387>`_..       
+0000e510: 202e 2e20 6d61 7468 3a3a 0a0a 2020 2020   .. math::..    
+0000e520: 2020 2020 2020 2057 203d 202d 5c5c 6672         W = -\\fr
+0000e530: 6163 7b7b 6e5f 7820 5c5c 6364 6f74 206e  ac{{n_x \\cdot n
+0000e540: 5f79 205c 5c63 646f 7420 285c 5c62 6172  _y \\cdot (\\bar
+0000e550: 7b52 7d5f 7920 2d20 5c5c 6261 727b 527d  {R}_y - \\bar{R}
+0000e560: 5f78 297d 7d7b 7b28 6e5f 7820 2b20 6e5f  _x)}}{{(n_x + n_
+0000e570: 7929 205c 5c63 646f 7420 5c5c 7371 7274  y) \\cdot \\sqrt
+0000e580: 7b7b 6e5f 7820 5c5c 6364 6f74 2053 5f78  {{n_x \\cdot S_x
+0000e590: 202b 206e 5f79 205c 5c63 646f 7420 535f   + n_y \\cdot S_
+0000e5a0: 797d 7d7d 7d0a 0a20 2020 2020 2020 2077  y}}}}..        w
+0000e5b0: 6865 7265 3a0a 2020 2020 2020 2020 2020  here:.          
+0000e5c0: 2020 2d20 5c28 206e 5f78 205c 2920 616e    - \( n_x \) an
+0000e5d0: 6420 5c28 206e 5f79 205c 2920 6172 6520  d \( n_y \) are 
+0000e5e0: 7468 6520 7369 7a65 7320 6f66 2073 616d  the sizes of sam
+0000e5f0: 706c 655f 3120 616e 6420 7361 6d70 6c65  ple_1 and sample
+0000e600: 5f32 2072 6573 7065 6374 6976 656c 792c  _2 respectively,
+0000e610: 0a20 2020 2020 2020 2020 2020 202d 205c  .            - \
+0000e620: 2820 5c62 6172 7b52 7d5f 7820 5c29 2061  ( \bar{R}_x \) a
+0000e630: 6e64 205c 2820 5c62 6172 7b52 7d5f 7920  nd \( \bar{R}_y 
+0000e640: 5c29 2061 7265 2074 6865 206d 6561 6e20  \) are the mean 
+0000e650: 7261 6e6b 7320 6f66 2073 616d 706c 655f  ranks of sample_
+0000e660: 3120 616e 6420 7361 6d70 6c65 5f32 2072  1 and sample_2 r
+0000e670: 6573 7065 6374 6976 656c 792c 0a20 2020  espectively,.   
+0000e680: 2020 2020 2020 2020 202d 205c 2820 535f           - \( S_
+0000e690: 7820 5c29 2061 6e64 205c 2820 535f 7920  x \) and \( S_y 
+0000e6a0: 5c29 2061 7265 2074 6865 2064 6973 7065  \) are the dispe
+0000e6b0: 7273 696f 6e20 7374 6174 6973 7469 6373  rsion statistics
+0000e6c0: 206f 6620 7361 6d70 6c65 5f31 2061 6e64   of sample_1 and
+0000e6d0: 2073 616d 706c 655f 3220 7265 7370 6563   sample_2 respec
+0000e6e0: 7469 7665 6c79 2e0a 0a20 2020 2020 2020  tively...       
+0000e6f0: 203a 7061 7261 6d65 7465 7220 6e64 6172   :parameter ndar
+0000e700: 7261 7920 7361 6d70 6c65 5f31 3a20 4669  ray sample_1: Fi
+0000e710: 7273 7420 3164 2061 7272 6179 2072 6570  rst 1d array rep
+0000e720: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
+0000e730: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+0000e740: 2020 3a70 6172 616d 6574 6572 206e 6461    :parameter nda
+0000e750: 7272 6179 2073 616d 706c 655f 323a 2053  rray sample_2: S
+0000e760: 6563 6f6e 6420 3164 2061 7272 6179 2072  econd 1d array r
+0000e770: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
+0000e780: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
+0000e790: 2020 2020 3a72 6574 7572 6e73 2066 6c6f      :returns flo
+0000e7a0: 6174 3a20 4272 756e 6e65 722d 4d75 6e7a  at: Brunner-Munz
+0000e7b0: 656c 2057 2e0a 0a0a 2020 2020 2020 2020  el W....        
+0000e7c0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+0000e7d0: 2020 3e3e 3e20 7361 6d70 6c65 5f31 2c20    >>> sample_1, 
+0000e7e0: 7361 6d70 6c65 5f32 203d 206e 702e 7261  sample_2 = np.ra
+0000e7f0: 6e64 6f6d 2e6e 6f72 6d61 6c28 6c6f 633d  ndom.normal(loc=
+0000e800: 3130 2c20 7363 616c 653d 322c 2073 697a  10, scale=2, siz
+0000e810: 653d 3130 292c 206e 702e 7261 6e64 6f6d  e=10), np.random
+0000e820: 2e6e 6f72 6d61 6c28 6c6f 633d 3230 2c20  .normal(loc=20, 
+0000e830: 7363 616c 653d 322c 2073 697a 653d 3130  scale=2, size=10
+0000e840: 290a 2020 2020 2020 2020 3e3e 3e20 5374  ).        >>> St
+0000e850: 6174 6973 7469 6373 2829 2e62 7275 6e6e  atistics().brunn
+0000e860: 6572 5f6d 756e 7a65 6c28 7361 6d70 6c65  er_munzel(sample
+0000e870: 5f31 3d73 616d 706c 655f 312c 2073 616d  _1=sample_1, sam
+0000e880: 706c 655f 323d 7361 6d70 6c65 5f32 290a  ple_2=sample_2).
+0000e890: 2020 2020 2020 2020 3e3e 3e20 302e 3537          >>> 0.57
+0000e8a0: 3531 3430 3831 3631 3433 3731 3635 0a20  51408161437165. 
+0000e8b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000e8c0: 2020 206e 782c 206e 7920 3d20 6c65 6e28     nx, ny = len(
+0000e8d0: 7361 6d70 6c65 5f31 292c 206c 656e 2873  sample_1), len(s
+0000e8e0: 616d 706c 655f 3229 0a20 2020 2020 2020  ample_2).       
+0000e8f0: 2072 616e 6b63 203d 2066 6173 745f 6d65   rankc = fast_me
+0000e900: 616e 5f72 616e 6b28 6e70 2e63 6f6e 6361  an_rank(np.conca
+0000e910: 7465 6e61 7465 2828 7361 6d70 6c65 5f31  tenate((sample_1
+0000e920: 2c20 7361 6d70 6c65 5f32 2929 290a 2020  , sample_2))).  
+0000e930: 2020 2020 2020 7261 6e6b 6378 2c20 7261        rankcx, ra
+0000e940: 6e6b 6379 203d 2072 616e 6b63 5b30 3a6e  nkcy = rankc[0:n
+0000e950: 785d 2c20 7261 6e6b 635b 6e78 203a 206e  x], rankc[nx : n
+0000e960: 7820 2b20 6e79 5d0a 2020 2020 2020 2020  x + ny].        
+0000e970: 7261 6e6b 6378 5f6d 6561 6e2c 2072 616e  rankcx_mean, ran
+0000e980: 6b63 795f 6d65 616e 203d 206e 702e 6d65  kcy_mean = np.me
+0000e990: 616e 2872 616e 6b63 7829 2c20 6e70 2e6d  an(rankcx), np.m
+0000e9a0: 6561 6e28 7261 6e6b 6379 290a 2020 2020  ean(rankcy).    
+0000e9b0: 2020 2020 7261 6e6b 782c 2072 616e 6b79      rankx, ranky
+0000e9c0: 203d 2066 6173 745f 6d65 616e 5f72 616e   = fast_mean_ran
+0000e9d0: 6b28 7361 6d70 6c65 5f31 292c 2066 6173  k(sample_1), fas
+0000e9e0: 745f 6d65 616e 5f72 616e 6b28 7361 6d70  t_mean_rank(samp
+0000e9f0: 6c65 5f32 290a 2020 2020 2020 2020 7261  le_2).        ra
+0000ea00: 6e6b 785f 6d65 616e 2c20 7261 6e6b 795f  nkx_mean, ranky_
+0000ea10: 6d65 616e 203d 206e 702e 6d65 616e 2872  mean = np.mean(r
+0000ea20: 616e 6b78 292c 206e 702e 6d65 616e 2872  ankx), np.mean(r
+0000ea30: 616e 6b79 290a 2020 2020 2020 2020 5378  anky).        Sx
+0000ea40: 203d 206e 702e 7375 6d28 6e70 2e70 6f77   = np.sum(np.pow
+0000ea50: 6572 2872 616e 6b63 7820 2d20 7261 6e6b  er(rankcx - rank
+0000ea60: 7820 2d20 7261 6e6b 6378 5f6d 6561 6e20  x - rankcx_mean 
+0000ea70: 2b20 7261 6e6b 785f 6d65 616e 2c20 322e  + rankx_mean, 2.
+0000ea80: 3029 2920 2f20 6e78 202d 2031 0a20 2020  0)) / nx - 1.   
+0000ea90: 2020 2020 2053 7920 3d20 6e70 2e73 756d       Sy = np.sum
+0000eaa0: 286e 702e 706f 7765 7228 7261 6e6b 6379  (np.power(rankcy
+0000eab0: 202d 2072 616e 6b79 202d 2072 616e 6b63   - ranky - rankc
+0000eac0: 795f 6d65 616e 202b 2072 616e 6b79 5f6d  y_mean + ranky_m
+0000ead0: 6561 6e2c 2032 2e30 2929 202f 206e 7920  ean, 2.0)) / ny 
+0000eae0: 2d20 310a 2020 2020 2020 2020 7762 666e  - 1.        wbfn
+0000eaf0: 203d 206e 7820 2a20 6e79 202a 2028 7261   = nx * ny * (ra
+0000eb00: 6e6b 6379 5f6d 6561 6e20 2d20 7261 6e6b  nkcy_mean - rank
+0000eb10: 6378 5f6d 6561 6e29 0a20 2020 2020 2020  cx_mean).       
+0000eb20: 2077 6266 6e20 2f3d 2028 6e78 202b 206e   wbfn /= (nx + n
+0000eb30: 7929 202a 206e 702e 7371 7274 286e 7820  y) * np.sqrt(nx 
+0000eb40: 2a20 5378 202b 206e 7920 2a20 5379 290a  * Sx + ny * Sy).
+0000eb50: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+0000eb60: 7762 666e 0a0a 2020 2020 4073 7461 7469  wbfn..    @stati
+0000eb70: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
+0000eb80: 7428 2228 666c 6f61 7433 325b 3a5d 2c20  t("(float32[:], 
+0000eb90: 666c 6f61 7436 345b 3a5d 2c20 666c 6f61  float64[:], floa
+0000eba0: 7436 3429 222c 2063 6163 6865 3d54 7275  t64)", cache=Tru
+0000ebb0: 6529 0a20 2020 2064 6566 2072 6f6c 6c69  e).    def rolli
+0000ebc0: 6e67 5f62 6172 6c65 7474 735f 7465 7374  ng_barletts_test
+0000ebd0: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
+0000ebe0: 6e70 2e6e 6461 7272 6179 2c20 7469 6d65  np.ndarray, time
+0000ebf0: 5f77 696e 646f 7773 3a20 6e70 2e6e 6461  _windows: np.nda
+0000ec00: 7272 6179 2c20 6670 733a 2066 6c6f 6174  rray, fps: float
+0000ec10: 0a20 2020 2029 202d 3e20 666c 6f61 743a  .    ) -> float:
+0000ec20: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+0000ec30: 7320 3d20 6e70 2e66 756c 6c28 2864 6174  s = np.full((dat
+0000ec40: 612e 7368 6170 655b 305d 2c20 7469 6d65  a.shape[0], time
+0000ec50: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
+0000ec60: 5d29 2c20 302e 3029 0a20 2020 2020 2020  ]), 0.0).       
+0000ec70: 2066 6f72 2069 2069 6e20 7072 616e 6765   for i in prange
+0000ec80: 2874 696d 655f 7769 6e64 6f77 732e 7368  (time_windows.sh
+0000ec90: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+0000eca0: 2020 2020 2077 696e 646f 775f 7369 7a65       window_size
+0000ecb0: 203d 2069 6e74 2874 696d 655f 7769 6e64   = int(time_wind
+0000ecc0: 6f77 735b 695d 202a 2066 7073 290a 2020  ows[i] * fps).  
+0000ecd0: 2020 2020 2020 2020 2020 6461 7461 5f73            data_s
+0000ece0: 706c 6974 203d 206e 702e 7370 6c69 7428  plit = np.split(
+0000ecf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ed00: 2064 6174 612c 206c 6973 7428 7261 6e67   data, list(rang
+0000ed10: 6528 7769 6e64 6f77 5f73 697a 652c 2064  e(window_size, d
+0000ed20: 6174 612e 7368 6170 655b 305d 2c20 7769  ata.shape[0], wi
+0000ed30: 6e64 6f77 5f73 697a 6529 290a 2020 2020  ndow_size)).    
+0000ed40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ed50: 2020 2020 2020 666f 7220 6a20 696e 2070        for j in p
+0000ed60: 7261 6e67 6528 312c 206c 656e 2864 6174  range(1, len(dat
+0000ed70: 615f 7370 6c69 7429 293a 0a20 2020 2020  a_split)):.     
+0000ed80: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+0000ed90: 775f 7374 6172 7420 3d20 696e 7428 7769  w_start = int(wi
+0000eda0: 6e64 6f77 5f73 697a 6520 2a20 6a29 0a20  ndow_size * j). 
+0000edb0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0000edc0: 696e 646f 775f 656e 6420 3d20 696e 7428  indow_end = int(
+0000edd0: 7769 6e64 6f77 5f73 7461 7274 202b 2077  window_start + w
+0000ede0: 696e 646f 775f 7369 7a65 290a 2020 2020  indow_size).    
+0000edf0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+0000ee00: 6c65 5f31 2c20 7361 6d70 6c65 5f32 203d  le_1, sample_2 =
+0000ee10: 2064 6174 615f 7370 6c69 745b 6a20 2d20   data_split[j - 
+0000ee20: 315d 2e61 7374 7970 6528 6e70 2e66 6c6f  1].astype(np.flo
+0000ee30: 6174 3332 292c 2064 6174 615f 7370 6c69  at32), data_spli
+0000ee40: 745b 0a20 2020 2020 2020 2020 2020 2020  t[.             
+0000ee50: 2020 2020 2020 206a 0a20 2020 2020 2020         j.       
+0000ee60: 2020 2020 2020 2020 205d 2e61 7374 7970           ].astyp
+0000ee70: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+0000ee80: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+0000ee90: 3120 3d20 6c65 6e28 7361 6d70 6c65 5f31  1 = len(sample_1
+0000eea0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000eeb0: 2020 6e5f 3220 3d20 6c65 6e28 7361 6d70    n_2 = len(samp
+0000eec0: 6c65 5f32 290a 2020 2020 2020 2020 2020  le_2).          
+0000eed0: 2020 2020 2020 4e20 3d20 6e5f 3120 2b20        N = n_1 + 
+0000eee0: 6e5f 320a 2020 2020 2020 2020 2020 2020  n_2.            
+0000eef0: 2020 2020 6d65 616e 5f76 6172 6961 6e63      mean_varianc
+0000ef00: 655f 3120 3d20 6e70 2e73 756d 2828 7361  e_1 = np.sum((sa
+0000ef10: 6d70 6c65 5f31 202d 206e 702e 6d65 616e  mple_1 - np.mean
+0000ef20: 2873 616d 706c 655f 3129 2920 2a2a 2032  (sample_1)) ** 2
+0000ef30: 2920 2f20 280a 2020 2020 2020 2020 2020  ) / (.          
+0000ef40: 2020 2020 2020 2020 2020 6e5f 3120 2d20            n_1 - 
+0000ef50: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0000ef60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000ef70: 2020 2020 6d65 616e 5f76 6172 6961 6e63      mean_varianc
+0000ef80: 655f 3220 3d20 6e70 2e73 756d 2828 7361  e_2 = np.sum((sa
+0000ef90: 6d70 6c65 5f32 202d 206e 702e 6d65 616e  mple_2 - np.mean
+0000efa0: 2873 616d 706c 655f 3229 2920 2a2a 2032  (sample_2)) ** 2
+0000efb0: 2920 2f20 280a 2020 2020 2020 2020 2020  ) / (.          
+0000efc0: 2020 2020 2020 2020 2020 6e5f 3220 2d20            n_2 - 
+0000efd0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0000efe0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000eff0: 2020 2020 6e75 6d65 7261 746f 7220 3d20      numerator = 
+0000f000: 284e 202d 2032 2920 2a20 280a 2020 2020  (N - 2) * (.    
+0000f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f020: 6e70 2e6c 6f67 286d 6561 6e5f 7661 7269  np.log(mean_vari
+0000f030: 616e 6365 5f31 2920 2b20 6e70 2e6c 6f67  ance_1) + np.log
+0000f040: 286d 6561 6e5f 7661 7269 616e 6365 5f32  (mean_variance_2
+0000f050: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000f060: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000f070: 2020 2020 6465 6e6f 6d69 6e61 746f 7220      denominator 
+0000f080: 3d20 3120 2f20 286e 5f31 202d 2031 2920  = 1 / (n_1 - 1) 
+0000f090: 2b20 3120 2f20 286e 5f32 202d 2031 290a  + 1 / (n_2 - 1).
+0000f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0b0: 7520 3d20 6e75 6d65 7261 746f 7220 2f20  u = numerator / 
+0000f0c0: 6465 6e6f 6d69 6e61 746f 720a 2020 2020  denominator.    
+0000f0d0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0000f0e0: 6c74 735b 7769 6e64 6f77 5f73 7461 7274  lts[window_start
+0000f0f0: 3a77 696e 646f 775f 656e 642c 2069 5d20  :window_end, i] 
+0000f100: 3d20 750a 0a20 2020 2020 2020 2072 6574  = u..        ret
+0000f110: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
+0000f120: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+0000f130: 2020 2040 6e6a 6974 2822 2866 6c6f 6174     @njit("(float
+0000f140: 3332 5b3a 5d2c 2066 6c6f 6174 3332 5b3a  32[:], float32[:
+0000f150: 5d29 2229 0a20 2020 2064 6566 2070 6561  ])").    def pea
+0000f160: 7273 6f6e 735f 7228 7361 6d70 6c65 5f31  rsons_r(sample_1
+0000f170: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
+0000f180: 6d70 6c65 5f32 3a20 6e70 2e6e 6461 7272  mple_2: np.ndarr
+0000f190: 6179 2920 2d3e 2066 6c6f 6174 3a0a 2020  ay) -> float:.  
+0000f1a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000f1b0: 2020 4361 6c63 756c 6174 6520 7468 6520    Calculate the 
+0000f1c0: 5065 6172 736f 6e20 636f 7272 656c 6174  Pearson correlat
+0000f1d0: 696f 6e20 636f 6566 6669 6369 656e 7420  ion coefficient 
+0000f1e0: 2850 6561 7273 6f6e 2773 2072 2920 6265  (Pearson's r) be
+0000f1f0: 7477 6565 6e20 7477 6f20 6e75 6d65 7269  tween two numeri
+0000f200: 6320 7361 6d70 6c65 732e 0a0a 2020 2020  c samples...    
+0000f210: 2020 2020 5065 6172 736f 6e27 7320 7220      Pearson's r 
+0000f220: 6973 2061 206d 6561 7375 7265 206f 6620  is a measure of 
+0000f230: 7468 6520 6c69 6e65 6172 2063 6f72 7265  the linear corre
+0000f240: 6c61 7469 6f6e 2062 6574 7765 656e 2074  lation between t
+0000f250: 776f 2073 6574 7320 6f66 2064 6174 6120  wo sets of data 
+0000f260: 706f 696e 7473 2e20 4974 2071 7561 6e74  points. It quant
+0000f270: 6966 6965 7320 7468 6520 7374 7265 6e67  ifies the streng
+0000f280: 7468 2061 6e64 0a20 2020 2020 2020 2064  th and.        d
+0000f290: 6972 6563 7469 6f6e 206f 6620 7468 6520  irection of the 
+0000f2a0: 6c69 6e65 6172 2072 656c 6174 696f 6e73  linear relations
+0000f2b0: 6869 7020 6265 7477 6565 6e20 7468 6520  hip between the 
+0000f2c0: 7477 6f20 7661 7269 6162 6c65 732e 2054  two variables. T
+0000f2d0: 6865 2063 6f65 6666 6963 6965 6e74 2076  he coefficient v
+0000f2e0: 6172 6965 7320 6265 7477 6565 6e20 2d31  aries between -1
+0000f2f0: 2061 6e64 2031 2c20 7769 7468 0a20 2020   and 1, with.   
+0000f300: 2020 2020 202d 3120 696e 6469 6361 7469       -1 indicati
+0000f310: 6e67 2061 2070 6572 6665 6374 206e 6567  ng a perfect neg
+0000f320: 6174 6976 6520 6c69 6e65 6172 2072 656c  ative linear rel
+0000f330: 6174 696f 6e73 6869 702c 2031 2069 6e64  ationship, 1 ind
+0000f340: 6963 6174 696e 6720 6120 7065 7266 6563  icating a perfec
+0000f350: 7420 706f 7369 7469 7665 206c 696e 6561  t positive linea
+0000f360: 7220 7265 6c61 7469 6f6e 7368 6970 2c20  r relationship, 
+0000f370: 616e 6420 300a 2020 2020 2020 2020 696e  and 0.        in
+0000f380: 6469 6361 7469 6e67 206e 6f20 6c69 6e65  dicating no line
+0000f390: 6172 2072 656c 6174 696f 6e73 6869 702e  ar relationship.
+0000f3a0: 0a0a 2020 2020 2020 2020 5065 6172 736f  ..        Pearso
+0000f3b0: 6e27 7320 7220 6973 2063 616c 6375 6c61  n's r is calcula
+0000f3c0: 7465 6420 7573 696e 6720 7468 6520 666f  ted using the fo
+0000f3d0: 726d 756c 613a 0a0a 2020 2020 2020 2020  rmula:..        
+0000f3e0: 2320 2e2e 206d 6174 683a 3a0a 2020 2020  # .. math::.    
+0000f3f0: 2020 2020 230a 2020 2020 2020 2020 2320      #.        # 
+0000f400: 2020 2072 203d 205c 6672 6163 7b5c 7375     r = \frac{\su
+0000f410: 6d7b 2878 5f69 202d 205c 6261 727b 787d  m{(x_i - \bar{x}
+0000f420: 2928 795f 6920 2d20 5c62 6172 7b79 7d29  )(y_i - \bar{y})
+0000f430: 7d7d 7b5c 7371 7274 7b5c 7375 6d7b 2878  }}{\sqrt{\sum{(x
+0000f440: 5f69 202d 205c 6261 727b 787d 295e 327d  _i - \bar{x})^2}
+0000f450: 5c73 756d 7b28 795f 6920 2d20 5c62 6172  \sum{(y_i - \bar
+0000f460: 7b79 7d29 5e32 7d7d 7d0a 2020 2020 2020  {y})^2}}}.      
+0000f470: 2020 230a 2020 2020 2020 2020 2320 7768    #.        # wh
+0000f480: 6572 653a 0a20 2020 2020 2020 2023 2020  ere:.        #  
+0000f490: 2020 2d20 5c28 2078 5f69 205c 2920 616e    - \( x_i \) an
+0000f4a0: 6420 5c28 2079 5f69 205c 2920 6172 6520  d \( y_i \) are 
+0000f4b0: 696e 6469 7669 6475 616c 2064 6174 6120  individual data 
+0000f4c0: 706f 696e 7473 2069 6e20 7361 6d70 6c65  points in sample
+0000f4d0: 5f31 2061 6e64 2073 616d 706c 655f 322c  _1 and sample_2,
+0000f4e0: 2072 6573 7065 6374 6976 656c 792e 0a20   respectively.. 
+0000f4f0: 2020 2020 2020 2023 2020 2020 2d20 5c28         #    - \(
+0000f500: 205c 6261 727b 787d 205c 2920 616e 6420   \bar{x} \) and 
+0000f510: 5c28 205c 6261 727b 797d 205c 2920 6172  \( \bar{y} \) ar
+0000f520: 6520 7468 6520 6d65 616e 7320 6f66 2073  e the means of s
+0000f530: 616d 706c 655f 3120 616e 6420 7361 6d70  ample_1 and samp
+0000f540: 6c65 5f32 2c20 7265 7370 6563 7469 7665  le_2, respective
+0000f550: 6c79 2e0a 0a20 2020 2020 2020 203a 7061  ly...        :pa
+0000f560: 7261 6d20 6e70 2e6e 6461 7272 6179 2073  ram np.ndarray s
+0000f570: 616d 706c 655f 313a 2046 6972 7374 206e  ample_1: First n
+0000f580: 756d 6572 6963 2073 616d 706c 652e 0a20  umeric sample.. 
+0000f590: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
+0000f5a0: 2e6e 6461 7272 6179 2073 616d 706c 655f  .ndarray sample_
+0000f5b0: 323a 2053 6563 6f6e 6420 6e75 6d65 7269  2: Second numeri
+0000f5c0: 6320 7361 6d70 6c65 2e0a 2020 2020 2020  c sample..      
+0000f5d0: 2020 3a72 6574 7572 6e20 666c 6f61 743a    :return float:
+0000f5e0: 2050 6561 7273 6f6e 2773 2063 6f72 7265   Pearson's corre
+0000f5f0: 6c61 7469 6f6e 2063 6f65 6666 6963 6965  lation coefficie
+0000f600: 6e74 2062 6574 7765 656e 2074 6865 2074  nt between the t
+0000f610: 776f 2073 616d 706c 6573 2e0a 0a20 2020  wo samples...   
+0000f620: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
+0000f630: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
+0000f640: 655f 3120 3d20 6e70 2e61 7272 6179 285b  e_1 = np.array([
+0000f650: 372c 2032 2c20 392c 2034 2c20 352c 2036  7, 2, 9, 4, 5, 6
+0000f660: 2c20 372c 2038 2c20 395d 292e 6173 7479  , 7, 8, 9]).asty
+0000f670: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+0000f680: 2020 2020 2020 203e 3e3e 2073 616d 706c         >>> sampl
+0000f690: 655f 3220 3d20 6e70 2e61 7272 6179 285b  e_2 = np.array([
+0000f6a0: 312e 352c 2032 2e35 2c20 332e 352c 2034  1.5, 2.5, 3.5, 4
+0000f6b0: 2e35 2c20 352e 352c 2036 2e35 2c20 372e  .5, 5.5, 6.5, 7.
+0000f6c0: 352c 2038 2e35 2c20 392e 355d 292e 6173  5, 8.5, 9.5]).as
+0000f6d0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0000f6e0: 0a20 2020 2020 2020 203e 3e3e 2053 7461  .        >>> Sta
+0000f6f0: 7469 7374 6963 7328 292e 7065 6172 736f  tistics().pearso
+0000f700: 6e73 5f72 2873 616d 706c 655f 313d 7361  ns_r(sample_1=sa
+0000f710: 6d70 6c65 5f31 2c20 7361 6d70 6c65 5f32  mple_1, sample_2
+0000f720: 3d73 616d 706c 655f 3229 0a20 2020 2020  =sample_2).     
+0000f730: 2020 203e 3e3e 2030 2e34 370a 2020 2020     >>> 0.47.    
+0000f740: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0000f750: 206d 312c 206d 3220 3d20 6e70 2e6d 6561   m1, m2 = np.mea
+0000f760: 6e28 7361 6d70 6c65 5f31 292c 206e 702e  n(sample_1), np.
+0000f770: 6d65 616e 2873 616d 706c 655f 3229 0a20  mean(sample_2). 
+0000f780: 2020 2020 2020 206e 756d 6572 6174 6f72         numerator
+0000f790: 203d 206e 702e 7375 6d28 2873 616d 706c   = np.sum((sampl
+0000f7a0: 655f 3120 2d20 6d31 2920 2a20 2873 616d  e_1 - m1) * (sam
+0000f7b0: 706c 655f 3220 2d20 6d32 2929 0a20 2020  ple_2 - m2)).   
+0000f7c0: 2020 2020 2064 656e 6f6d 696e 6174 6f72       denominator
+0000f7d0: 203d 206e 702e 7371 7274 280a 2020 2020   = np.sqrt(.    
+0000f7e0: 2020 2020 2020 2020 6e70 2e73 756d 2828          np.sum((
+0000f7f0: 7361 6d70 6c65 5f31 202d 206d 3129 202a  sample_1 - m1) *
+0000f800: 2a20 3229 202a 206e 702e 7375 6d28 2873  * 2) * np.sum((s
+0000f810: 616d 706c 655f 3220 2d20 6d32 2920 2a2a  ample_2 - m2) **
+0000f820: 2032 290a 2020 2020 2020 2020 290a 2020   2).        ).  
+0000f830: 2020 2020 2020 7220 3d20 6e75 6d65 7261        r = numera
+0000f840: 746f 7220 2f20 6465 6e6f 6d69 6e61 746f  tor / denominato
+0000f850: 720a 2020 2020 2020 2020 7265 7475 726e  r.        return
+0000f860: 2072 0a0a 2020 2020 4073 7461 7469 636d   r..    @staticm
+0000f870: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
+0000f880: 2228 666c 6f61 7433 325b 3a5d 2c20 666c  "(float32[:], fl
+0000f890: 6f61 7433 325b 3a5d 2922 290a 2020 2020  oat32[:])").    
+0000f8a0: 6465 6620 7370 6561 726d 616e 5f72 616e  def spearman_ran
+0000f8b0: 6b5f 636f 7272 656c 6174 696f 6e28 7361  k_correlation(sa
+0000f8c0: 6d70 6c65 5f31 3a20 6e70 2e6e 6461 7272  mple_1: np.ndarr
+0000f8d0: 6179 2c20 7361 6d70 6c65 5f32 3a20 6e70  ay, sample_2: np
+0000f8e0: 2e6e 6461 7272 6179 2920 2d3e 2066 6c6f  .ndarray) -> flo
+0000f8f0: 6174 3a0a 2020 2020 2020 2020 2222 220a  at:.        """.
+0000f900: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
+0000f910: 6f6d 7075 7465 206f 6620 5370 6561 726d  ompute of Spearm
+0000f920: 616e 2773 2072 616e 6b20 636f 7272 656c  an's rank correl
+0000f930: 6174 696f 6e20 636f 6566 6669 6369 656e  ation coefficien
+0000f940: 7420 6265 7477 6565 6e20 7477 6f20 7361  t between two sa
+0000f950: 6d70 6c65 732e 0a0a 2020 2020 2020 2020  mples...        
+0000f960: 5370 6561 726d 616e 2773 2072 616e 6b20  Spearman's rank 
+0000f970: 636f 7272 656c 6174 696f 6e20 636f 6566  correlation coef
+0000f980: 6669 6369 656e 7420 6173 7365 7373 6573  ficient assesses
+0000f990: 2068 6f77 2077 656c 6c20 7468 6520 7265   how well the re
+0000f9a0: 6c61 7469 6f6e 7368 6970 2062 6574 7765  lationship betwe
+0000f9b0: 656e 2074 776f 2076 6172 6961 626c 6573  en two variables
+0000f9c0: 2063 616e 2062 6520 6465 7363 7269 6265   can be describe
+0000f9d0: 6420 7573 696e 6720 6120 6d6f 6e6f 746f  d using a monoto
+0000f9e0: 6e69 6320 6675 6e63 7469 6f6e 2e0a 2020  nic function..  
+0000f9f0: 2020 2020 2020 4974 2063 6f6d 7075 7465        It compute
+0000fa00: 7320 7468 6520 7374 7265 6e67 7468 2061  s the strength a
+0000fa10: 6e64 2064 6972 6563 7469 6f6e 206f 6620  nd direction of 
+0000fa20: 7468 6520 6d6f 6e6f 746f 6e69 6320 7265  the monotonic re
+0000fa30: 6c61 7469 6f6e 7368 6970 2062 6574 7765  lationship betwe
+0000fa40: 656e 2072 616e 6b65 6420 7661 7269 6162  en ranked variab
+0000fa50: 6c65 732e 0a0a 2020 2020 2020 2020 2320  les...        # 
+0000fa60: 2e2e 206d 6174 683a 3a0a 2020 2020 2020  .. math::.      
+0000fa70: 2020 2320 2020 20cf 8120 3d20 3120 2d20    #    .. = 1 - 
+0000fa80: 5c5c 6672 6163 7b7b 3620 e288 9128 645f  \\frac{{6 ...(d_
+0000fa90: 695e 3229 7d7d 7b7b 6e28 6e5e 3220 2d20  i^2)}}{{n(n^2 - 
+0000faa0: 3129 7d7d 0a20 2020 2020 2020 2023 0a20  1)}}.        #. 
+0000fab0: 2020 2020 2020 2023 2077 6865 7265 3a0a         # where:.
+0000fac0: 2020 2020 2020 2020 2320 2d20 5c28 2064          # - \( d
+0000fad0: 5f69 205c 2920 6973 2074 6865 2064 6966  _i \) is the dif
+0000fae0: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
+0000faf0: 7468 6520 7261 6e6b 7320 6f66 2063 6f72  the ranks of cor
+0000fb00: 7265 7370 6f6e 6469 6e67 2065 6c65 6d65  responding eleme
+0000fb10: 6e74 7320 696e 2073 616d 706c 655f 3120  nts in sample_1 
+0000fb20: 616e 6420 7361 6d70 6c65 5f32 2e0a 2020  and sample_2..  
+0000fb30: 2020 2020 2020 2320 2d20 5c28 206e 205c        # - \( n \
+0000fb40: 2920 6973 2074 6865 206e 756d 6265 7220  ) is the number 
+0000fb50: 6f66 206f 6273 6572 7661 7469 6f6e 732e  of observations.
+0000fb60: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000fb70: 206e 702e 6e64 6172 7261 7920 7361 6d70   np.ndarray samp
+0000fb80: 6c65 5f31 3a20 4669 7273 7420 3144 2061  le_1: First 1D a
+0000fb90: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
+0000fba0: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+0000fbb0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+0000fbc0: 702e 6e64 6172 7261 7920 7361 6d70 6c65  p.ndarray sample
+0000fbd0: 5f32 3a20 5365 636f 6e64 2031 4420 6172  _2: Second 1D ar
+0000fbe0: 7261 7920 636f 6e74 6169 6e69 6e67 2066  ray containing f
+0000fbf0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+0000fc00: 2020 2020 2020 203a 7265 7475 726e 2066         :return f
+0000fc10: 6c6f 6174 3a20 5370 6561 726d 616e 2773  loat: Spearman's
+0000fc20: 2072 616e 6b20 636f 7272 656c 6174 696f   rank correlatio
+0000fc30: 6e20 636f 6566 6669 6369 656e 742e 0a0a  n coefficient...
+0000fc40: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+0000fc50: 3a0a 2020 2020 2020 2020 3e3e 3e20 7361  :.        >>> sa
+0000fc60: 6d70 6c65 5f31 203d 206e 702e 6172 7261  mple_1 = np.arra
+0000fc70: 7928 5b37 2c20 322c 2039 2c20 342c 2035  y([7, 2, 9, 4, 5
+0000fc80: 2c20 362c 2037 2c20 382c 2039 5d29 2e61  , 6, 7, 8, 9]).a
+0000fc90: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+0000fca0: 290a 2020 2020 2020 2020 3e3e 3e20 7361  ).        >>> sa
+0000fcb0: 6d70 6c65 5f32 203d 206e 702e 6172 7261  mple_2 = np.arra
+0000fcc0: 7928 5b31 2e35 2c20 322e 352c 2033 2e35  y([1.5, 2.5, 3.5
+0000fcd0: 2c20 342e 352c 2035 2e35 2c20 362e 352c  , 4.5, 5.5, 6.5,
+0000fce0: 2037 2e35 2c20 382e 352c 2039 2e35 5d29   7.5, 8.5, 9.5])
+0000fcf0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+0000fd00: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
+0000fd10: 5374 6174 6973 7469 6373 2829 2e73 7065  Statistics().spe
+0000fd20: 6172 6d61 6e5f 7261 6e6b 5f63 6f72 7265  arman_rank_corre
+0000fd30: 6c61 7469 6f6e 2873 616d 706c 655f 313d  lation(sample_1=
+0000fd40: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+0000fd50: 5f32 3d73 616d 706c 655f 3229 0a20 2020  _2=sample_2).   
+0000fd60: 2020 2020 203e 3e3e 2030 2e30 3030 3339       >>> 0.00039
+0000fd70: 3739 3230 3630 3835 3230 3530 3738 0a20  79206085205078. 
+0000fd80: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000fd90: 2020 2020 7261 6e6b 5f78 2c20 7261 6e6b      rank_x, rank
+0000fda0: 5f79 203d 206e 702e 6172 6773 6f72 7428  _y = np.argsort(
+0000fdb0: 6e70 2e61 7267 736f 7274 2873 616d 706c  np.argsort(sampl
+0000fdc0: 655f 3129 292c 206e 702e 6172 6773 6f72  e_1)), np.argsor
+0000fdd0: 7428 0a20 2020 2020 2020 2020 2020 206e  t(.            n
+0000fde0: 702e 6172 6773 6f72 7428 7361 6d70 6c65  p.argsort(sample
+0000fdf0: 5f32 290a 2020 2020 2020 2020 290a 2020  _2).        ).  
+0000fe00: 2020 2020 2020 645f 7371 7561 7265 6420        d_squared 
+0000fe10: 3d20 6e70 2e73 756d 2828 7261 6e6b 5f78  = np.sum((rank_x
+0000fe20: 202d 2072 616e 6b5f 7929 202a 2a20 3229   - rank_y) ** 2)
+0000fe30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000fe40: 3120 2d20 2836 202a 2064 5f73 7175 6172  1 - (6 * d_squar
+0000fe50: 6564 2920 2f20 286c 656e 2873 616d 706c  ed) / (len(sampl
+0000fe60: 655f 3129 202a 2028 6c65 6e28 7361 6d70  e_1) * (len(samp
+0000fe70: 6c65 5f32 2920 2a2a 2032 202d 2031 2929  le_2) ** 2 - 1))
+0000fe80: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+0000fe90: 686f 640a 2020 2020 406e 6a69 7428 2228  hod.    @njit("(
+0000fea0: 666c 6f61 7433 325b 3a5d 2c20 666c 6f61  float32[:], floa
+0000feb0: 7433 325b 3a5d 2c20 666c 6f61 7436 345b  t32[:], float64[
+0000fec0: 3a5d 2c20 696e 7436 3429 2229 0a20 2020  :], int64)").   
+0000fed0: 2064 6566 2073 6c69 6469 6e67 5f70 6561   def sliding_pea
+0000fee0: 7273 6f6e 735f 7228 0a20 2020 2020 2020  rsons_r(.       
+0000fef0: 2073 616d 706c 655f 313a 206e 702e 6e64   sample_1: np.nd
+0000ff00: 6172 7261 792c 2073 616d 706c 655f 323a  array, sample_2:
+0000ff10: 206e 702e 6e64 6172 7261 792c 2074 696d   np.ndarray, tim
+0000ff20: 655f 7769 6e64 6f77 733a 206e 702e 6e64  e_windows: np.nd
+0000ff30: 6172 7261 792c 2066 7073 3a20 696e 740a  array, fps: int.
+0000ff40: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
+0000ff50: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
+0000ff60: 0a20 2020 2020 2020 2047 6976 656e 2074  .        Given t
+0000ff70: 776f 2031 4420 6172 7261 7973 206f 6620  wo 1D arrays of 
+0000ff80: 7369 7a65 204e 2c20 6372 6561 7465 2073  size N, create s
+0000ff90: 6c69 6469 6e67 2077 696e 646f 7720 6f66  liding window of
+0000ffa0: 2073 697a 6520 7469 6d65 5f77 696e 646f   size time_windo
+0000ffb0: 7773 5b69 5d20 2a20 6670 7320 616e 6420  ws[i] * fps and 
+0000ffc0: 7265 7475 726e 2050 6561 7273 6f6e 2773  return Pearson's
+0000ffd0: 2052 0a20 2020 2020 2020 2062 6574 7765   R.        betwe
+0000ffe0: 656e 2074 6865 2076 616c 7565 7320 696e  en the values in
+0000fff0: 2074 6865 2074 776f 2031 4420 6172 7261   the two 1D arra
+00010000: 7973 2069 6e20 6561 6368 2077 696e 646f  ys in each windo
+00010010: 772e 2041 6464 7265 7373 2022 7768 6174  w. Address "what
+00010020: 2069 7320 7468 6520 636f 7272 656c 6174   is the correlat
+00010030: 696f 6e20 6265 7477 6565 6e20 4665 6174  ion between Feat
+00010040: 7572 6520 3120 616e 640a 2020 2020 2020  ure 1 and.      
+00010050: 2020 4665 6174 7572 6520 3220 696e 2074    Feature 2 in t
+00010060: 6865 2063 7572 7265 6e74 2058 2e58 2073  he current X.X s
+00010070: 6563 6f6e 6473 206f 6620 7468 6520 7669  econds of the vi
+00010080: 6465 6f22 2e0a 0a20 2020 2020 2020 202e  deo"...        .
+00010090: 2e20 696d 6167 653a 3a20 5f73 7461 7469  . image:: _stati
+000100a0: 632f 696d 672f 736c 6964 696e 675f 7065  c/img/sliding_pe
+000100b0: 6172 736f 6e73 2e70 6e67 0a20 2020 2020  arsons.png.     
+000100c0: 2020 2020 2020 3a77 6964 7468 3a20 3630        :width: 60
+000100d0: 300a 2020 2020 2020 2020 2020 203a 616c  0.           :al
+000100e0: 6967 6e3a 2063 656e 7465 720a 0a20 2020  ign: center..   
+000100f0: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
+00010100: 6e64 6172 7261 7920 7361 6d70 6c65 5f31  ndarray sample_1
+00010110: 3a20 4669 7273 7420 3144 2061 7272 6179  : First 1D array
+00010120: 2077 6974 6820 6665 6174 7572 6520 7661   with feature va
+00010130: 6c75 6573 2e0a 2020 2020 2020 2020 3a70  lues..        :p
+00010140: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
+00010150: 2073 616d 706c 655f 313a 2053 6563 6f6e   sample_1: Secon
+00010160: 6420 3144 2061 7272 6179 2077 6974 6820  d 1D array with 
+00010170: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+00010180: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+00010190: 6572 2066 6c6f 6174 2074 696d 655f 7769  er float time_wi
+000101a0: 6e64 6f77 733a 2054 6865 206c 656e 6774  ndows: The lengt
+000101b0: 6820 6f66 2074 6865 2073 6c69 6469 6e67  h of the sliding
+000101c0: 2077 696e 646f 7720 696e 2073 6563 6f6e   window in secon
+000101d0: 6473 2e0a 2020 2020 2020 2020 3a70 6172  ds..        :par
+000101e0: 616d 6574 6572 2069 6e74 2066 7073 3a20  ameter int fps: 
+000101f0: 5468 6520 6670 7320 6f66 2074 6865 2072  The fps of the r
+00010200: 6563 6f72 6465 6420 7669 6465 6f2e 0a20  ecorded video.. 
+00010210: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
+00010220: 6e70 2e6e 6461 7272 6179 3a20 3264 2061  np.ndarray: 2d a
+00010230: 7272 6179 206f 6620 5065 6172 736f 6e73  rray of Pearsons
+00010240: 2052 206f 6620 7369 7a65 206c 656e 2873   R of size len(s
+00010250: 616d 706c 655f 3129 2078 206c 656e 2874  ample_1) x len(t
+00010260: 696d 655f 7769 6e64 6f77 7329 2e20 4e6f  ime_windows). No
+00010270: 7465 2c20 6966 2073 6c69 6469 6e67 2077  te, if sliding w
+00010280: 696e 646f 7720 6973 2031 3020 6672 616d  indow is 10 fram
+00010290: 6573 2c20 7468 6520 6669 7273 7420 3920  es, the first 9 
+000102a0: 656e 7472 6965 7320 7769 6c6c 2062 6520  entries will be 
+000102b0: 6669 6c6c 6564 2077 6974 6820 302e 0a0a  filled with 0...
+000102c0: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+000102d0: 3a0a 2020 2020 2020 2020 3e3e 3e20 7361  :.        >>> sa
+000102e0: 6d70 6c65 5f31 203d 206e 702e 7261 6e64  mple_1 = np.rand
+000102f0: 6f6d 2e72 616e 6469 6e74 2830 2c20 3530  om.randint(0, 50
+00010300: 2c20 2831 3029 292e 6173 7479 7065 286e  , (10)).astype(n
+00010310: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+00010320: 2020 203e 3e3e 2073 616d 706c 655f 3220     >>> sample_2 
+00010330: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+00010340: 696e 7428 302c 2035 302c 2028 3130 2929  int(0, 50, (10))
+00010350: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00010360: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
+00010370: 5374 6174 6973 7469 6373 2829 2e73 6c69  Statistics().sli
+00010380: 6469 6e67 5f70 6561 7273 6f6e 735f 7228  ding_pearsons_r(
+00010390: 7361 6d70 6c65 5f31 3d73 616d 706c 655f  sample_1=sample_
+000103a0: 312c 2073 616d 706c 655f 323d 7361 6d70  1, sample_2=samp
+000103b0: 6c65 5f32 2c20 7469 6d65 5f77 696e 646f  le_2, time_windo
+000103c0: 7773 3d6e 702e 6172 7261 7928 5b30 2e35  ws=np.array([0.5
+000103d0: 5d29 2c20 6670 733d 3130 290a 2020 2020  ]), fps=10).    
+000103e0: 2020 2020 3e3e 3e20 5b5b 2d31 2e5d 5b2d      >>> [[-1.][-
+000103f0: 312e 5d5b 2d31 2e5d 5b2d 312e 5d5b 302e  1.][-1.][-1.][0.
+00010400: 3232 375d 5b2d 302e 3331 395d 5b2d 302e  227][-0.319][-0.
+00010410: 3139 365d 5b30 2e34 3734 5d5b 2d30 2e30  196][0.474][-0.0
+00010420: 3631 5d5b 302e 3731 335d 5d0a 2020 2020  61][0.713]].    
+00010430: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00010440: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
+00010450: 6c6c 2828 7361 6d70 6c65 5f31 2e73 6861  ll((sample_1.sha
+00010460: 7065 5b30 5d2c 2074 696d 655f 7769 6e64  pe[0], time_wind
+00010470: 6f77 732e 7368 6170 655b 305d 292c 2030  ows.shape[0]), 0
+00010480: 2e30 290a 2020 2020 2020 2020 666f 7220  .0).        for 
+00010490: 6920 696e 2070 7261 6e67 6528 7469 6d65  i in prange(time
+000104a0: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
+000104b0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+000104c0: 7769 6e64 6f77 5f73 697a 6520 3d20 696e  window_size = in
+000104d0: 7428 7469 6d65 5f77 696e 646f 7773 5b69  t(time_windows[i
+000104e0: 5d20 2a20 6670 7329 0a20 2020 2020 2020  ] * fps).       
+000104f0: 2020 2020 2066 6f72 206c 6566 742c 2072       for left, r
+00010500: 6967 6874 2069 6e20 7a69 7028 0a20 2020  ight in zip(.   
+00010510: 2020 2020 2020 2020 2020 2020 2070 7261               pra
+00010520: 6e67 6528 302c 2073 616d 706c 655f 312e  nge(0, sample_1.
+00010530: 7368 6170 655b 305d 202b 2031 292c 0a20  shape[0] + 1),. 
+00010540: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00010550: 7261 6e67 6528 7769 6e64 6f77 5f73 697a  range(window_siz
+00010560: 652c 2073 616d 706c 655f 312e 7368 6170  e, sample_1.shap
+00010570: 655b 305d 202b 2031 292c 0a20 2020 2020  e[0] + 1),.     
+00010580: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00010590: 2020 2020 2020 2020 2020 7331 2c20 7332            s1, s2
+000105a0: 203d 2073 616d 706c 655f 315b 6c65 6674   = sample_1[left
+000105b0: 3a72 6967 6874 5d2c 2073 616d 706c 655f  :right], sample_
+000105c0: 325b 6c65 6674 3a72 6967 6874 5d0a 2020  2[left:right].  
+000105d0: 2020 2020 2020 2020 2020 2020 2020 6d31                m1
+000105e0: 2c20 6d32 203d 206e 702e 6d65 616e 2873  , m2 = np.mean(s
+000105f0: 3129 2c20 6e70 2e6d 6561 6e28 7332 290a  1), np.mean(s2).
+00010600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010610: 6e75 6d65 7261 746f 7220 3d20 6e70 2e73  numerator = np.s
+00010620: 756d 2828 7331 202d 206d 3129 202a 2028  um((s1 - m1) * (
+00010630: 7332 202d 206d 3229 290a 2020 2020 2020  s2 - m2)).      
+00010640: 2020 2020 2020 2020 2020 6465 6e6f 6d69            denomi
+00010650: 6e61 746f 7220 3d20 6e70 2e73 7172 7428  nator = np.sqrt(
+00010660: 6e70 2e73 756d 2828 7331 202d 206d 3129  np.sum((s1 - m1)
+00010670: 202a 2a20 3229 202a 206e 702e 7375 6d28   ** 2) * np.sum(
+00010680: 2873 3220 2d20 6d32 2920 2a2a 2032 2929  (s2 - m2) ** 2))
+00010690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000106a0: 2069 6620 6465 6e6f 6d69 6e61 746f 7220   if denominator 
+000106b0: 213d 2030 3a0a 2020 2020 2020 2020 2020  != 0:.          
+000106c0: 2020 2020 2020 2020 2020 7220 3d20 6e75            r = nu
+000106d0: 6d65 7261 746f 7220 2f20 6465 6e6f 6d69  merator / denomi
+000106e0: 6e61 746f 720a 2020 2020 2020 2020 2020  nator.          
+000106f0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00010700: 735b 7269 6768 7420 2d20 312c 2069 5d20  s[right - 1, i] 
+00010710: 3d20 720a 2020 2020 2020 2020 2020 2020  = r.            
+00010720: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00010730: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00010740: 7375 6c74 735b 7269 6768 7420 2d20 312c  sults[right - 1,
+00010750: 2069 5d20 3d20 2d31 2e30 0a0a 2020 2020   i] = -1.0..    
+00010760: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+00010770: 7473 0a0a 2020 2020 4073 7461 7469 636d  ts..    @staticm
+00010780: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
+00010790: 0a20 2020 2020 2020 205b 0a20 2020 2020  .        [.     
+000107a0: 2020 2020 2020 2022 2866 6c6f 6174 3332         "(float32
+000107b0: 5b3a 5d2c 2066 6c6f 6174 3332 5b3a 5d2c  [:], float32[:],
+000107c0: 2066 6c6f 6174 3634 5b3a 2c3a 5d2c 2074   float64[:,:], t
+000107d0: 7970 6573 2e75 6e69 636f 6465 5f74 7970  ypes.unicode_typ
+000107e0: 6529 222c 0a20 2020 2020 2020 2020 2020  e)",.           
+000107f0: 2027 2866 6c6f 6174 3332 5b3a 5d2c 2066   '(float32[:], f
+00010800: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
+00010810: 3634 5b3a 2c3a 5d2c 2074 7970 6573 2e6d  64[:,:], types.m
+00010820: 6973 632e 4f6d 6974 7465 6428 2267 6f6f  isc.Omitted("goo
+00010830: 646e 6573 735f 6f66 5f66 6974 2229 2927  dness_of_fit"))'
+00010840: 2c0a 2020 2020 2020 2020 2020 2020 2228  ,.            "(
+00010850: 666c 6f61 7433 325b 3a5d 2c20 666c 6f61  float32[:], floa
+00010860: 7433 325b 3a5d 2c20 7479 7065 732e 6d69  t32[:], types.mi
+00010870: 7363 2e4f 6d69 7474 6564 284e 6f6e 6529  sc.Omitted(None)
+00010880: 2c20 7479 7065 732e 756e 6963 6f64 655f  , types.unicode_
+00010890: 7479 7065 2922 2c0a 2020 2020 2020 2020  type)",.        
+000108a0: 2020 2020 2728 666c 6f61 7433 325b 3a5d      '(float32[:]
+000108b0: 2c20 666c 6f61 7433 325b 3a5d 2c20 7479  , float32[:], ty
+000108c0: 7065 732e 6d69 7363 2e4f 6d69 7474 6564  pes.misc.Omitted
+000108d0: 284e 6f6e 6529 2c20 7479 7065 732e 6d69  (None), types.mi
+000108e0: 7363 2e4f 6d69 7474 6564 2822 676f 6f64  sc.Omitted("good
+000108f0: 6e65 7373 5f6f 665f 6669 7422 2929 272c  ness_of_fit"))',
+00010900: 0a20 2020 2020 2020 205d 0a20 2020 2029  .        ].    )
+00010910: 0a20 2020 2064 6566 2063 6869 5f73 7175  .    def chi_squ
+00010920: 6172 6528 0a20 2020 2020 2020 2073 616d  are(.        sam
+00010930: 706c 655f 313a 206e 702e 6e64 6172 7261  ple_1: np.ndarra
+00010940: 792c 0a20 2020 2020 2020 2073 616d 706c  y,.        sampl
+00010950: 655f 323a 206e 702e 6e64 6172 7261 792c  e_2: np.ndarray,
+00010960: 0a20 2020 2020 2020 2063 7269 7469 6361  .        critica
+00010970: 6c5f 7661 6c75 6573 3a20 4f70 7469 6f6e  l_values: Option
+00010980: 616c 5b6e 702e 6e64 6172 7261 795d 203d  al[np.ndarray] =
+00010990: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
+000109a0: 7970 653a 204f 7074 696f 6e61 6c5b 4c69  ype: Optional[Li
+000109b0: 7465 7261 6c5b 2267 6f6f 646e 6573 735f  teral["goodness_
+000109c0: 6f66 5f66 6974 222c 2022 696e 6465 7065  of_fit", "indepe
+000109d0: 6e64 656e 6365 225d 5d20 3d20 2267 6f6f  ndence"]] = "goo
+000109e0: 646e 6573 735f 6f66 5f66 6974 222c 0a20  dness_of_fit",. 
+000109f0: 2020 2029 202d 3e20 5475 706c 655b 666c     ) -> Tuple[fl
+00010a00: 6f61 742c 2055 6e69 6f6e 5b62 6f6f 6c2c  oat, Union[bool,
+00010a10: 204e 6f6e 655d 5d3a 0a20 2020 2020 2020   None]]:.       
+00010a20: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+00010a30: 7465 6420 636f 6d70 7574 6520 6f66 2063  ted compute of c
+00010a40: 6869 2073 7175 6172 6520 6265 7477 6565  hi square betwee
+00010a50: 6e20 7477 6f20 6361 7465 676f 7269 6361  n two categorica
+00010a60: 6c20 6469 7374 7269 6275 7469 6f6e 732e  l distributions.
+00010a70: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00010a80: 6574 6572 206e 6461 7272 6179 2073 616d  eter ndarray sam
+00010a90: 706c 655f 313a 2046 6972 7374 2031 6420  ple_1: First 1d 
+00010aa0: 6172 7261 7920 7265 7072 6573 656e 7469  array representi
+00010ab0: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
+00010ac0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00010ad0: 6d65 7465 7220 6e64 6172 7261 7920 7361  meter ndarray sa
+00010ae0: 6d70 6c65 5f32 3a20 5365 636f 6e64 2031  mple_2: Second 1
+00010af0: 6420 6172 7261 7920 7265 7072 6573 656e  d array represen
+00010b00: 7469 6e67 2066 6561 7475 7265 2076 616c  ting feature val
+00010b10: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
+00010b20: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+00010b30: 6372 6974 6963 616c 5f76 616c 7565 733a  critical_values:
+00010b40: 2032 4420 6172 7261 7920 7769 7468 2077   2D array with w
+00010b50: 6865 7265 2069 6e64 6578 6573 2072 6570  here indexes rep
+00010b60: 7265 7365 6e74 2064 6567 7265 6573 206f  resent degrees o
+00010b70: 6620 6672 6565 646f 6d20 616e 6420 7661  f freedom and va
+00010b80: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+00010b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010bb0: 2072 6570 7265 7365 6e74 2063 7269 7469   represent criti
+00010bc0: 6361 6c20 7661 6c75 6573 2e20 4361 6e20  cal values. Can 
+00010bd0: 6265 2066 6f75 6e64 2069 6e20 6060 7369  be found in ``si
+00010be0: 6d62 612e 6173 7365 7473 2e63 7269 7469  mba.assets.criti
+00010bf0: 6361 6c5f 7661 6c75 6573 5f30 352e 7069  cal_values_05.pi
+00010c00: 636b 6c65 6060 0a0a 2020 2020 2020 2020  ckle``..        
+00010c10: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
+00010c20: 2020 2020 2052 6571 7569 7265 7320 7361       Requires sa
+00010c30: 6d70 6c65 5f31 2061 6e64 2073 616d 706c  mple_1 and sampl
+00010c40: 655f 3220 6861 7320 746f 2062 6520 6e75  e_2 has to be nu
+00010c50: 6d65 7269 632e 2069 6620 776f 726b 696e  meric. if workin
+00010c60: 6720 7769 7468 2073 7472 696e 6773 2c20  g with strings, 
+00010c70: 636f 6e76 6572 7420 746f 0a20 2020 2020  convert to.     
+00010c80: 2020 2020 2020 6e75 6d65 7269 6320 6361        numeric ca
+00010c90: 7465 676f 7279 2076 616c 7565 7320 6265  tegory values be
+00010ca0: 666f 7265 2075 7369 6e67 2063 6869 5f73  fore using chi_s
+00010cb0: 7175 6172 652e 0a0a 2020 2020 2020 2020  quare...        
+00010cc0: 2e2e 2077 6172 6e69 6e67 3a0a 2020 2020  .. warning:.    
+00010cd0: 2020 2020 2020 204e 6f6e 2d6f 7665 726c         Non-overl
+00010ce0: 6170 7069 6e67 2076 616c 7565 7320 2869  apping values (i
+00010cf0: 2e65 2e2c 2063 6174 6567 6f72 6965 7320  .e., categories 
+00010d00: 6578 6973 7420 696e 2073 616d 706c 655f  exist in sample_
+00010d10: 3120 7468 6174 2064 6f65 7320 6e6f 7420  1 that does not 
+00010d20: 6578 6973 7420 696e 2073 616d 706c 6532  exist in sample2
+00010d30: 2920 6f72 2073 6d61 6c6c 2076 616c 7565  ) or small value
+00010d40: 7320 6d61 7920 6361 7573 6520 696e 666c  s may cause infl
+00010d50: 6174 6564 2063 6869 2073 7175 6172 6520  ated chi square 
+00010d60: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
+00010d70: 2020 2049 6620 736d 616c 6c20 636f 6e74     If small cont
+00010d80: 696e 6765 6e63 7920 7461 626c 6520 736d  ingency table sm
+00010d90: 616c 6c20 7661 6c75 6573 2c20 636f 6e73  all values, cons
+00010da0: 6964 6572 2054 4f44 4f20 4669 7368 6572  ider TODO Fisher
+00010db0: 2773 2065 7861 6374 2074 6573 740a 0a20  's exact test.. 
+00010dc0: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+00010dd0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+00010de0: 706c 655f 3120 3d20 6e70 2e61 7272 6179  ple_1 = np.array
+00010df0: 285b 312c 2031 2c20 322c 2032 2c20 332c  ([1, 1, 2, 2, 3,
+00010e00: 2033 2c20 342c 2034 2c20 352c 2035 2c20   3, 4, 4, 5, 5, 
+00010e10: 355d 292e 6173 7479 7065 286e 702e 666c  5]).astype(np.fl
+00010e20: 6f61 7433 3229 0a20 2020 2020 2020 203e  oat32).        >
+00010e30: 3e3e 2073 616d 706c 655f 3220 3d20 6e70  >> sample_2 = np
+00010e40: 2e61 7272 6179 285b 312c 2032 2c20 332c  .array([1, 2, 3,
+00010e50: 2034 2c20 352c 2036 2c20 372c 2038 2c20   4, 5, 6, 7, 8, 
+00010e60: 392c 2031 305d 292e 6173 7479 7065 286e  9, 10]).astype(n
+00010e70: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+00010e80: 2020 203e 3e3e 2063 7269 7469 6361 6c5f     >>> critical_
+00010e90: 7661 6c75 6573 203d 2070 6963 6b6c 652e  values = pickle.
+00010ea0: 6c6f 6164 286f 7065 6e28 2273 696d 6261  load(open("simba
+00010eb0: 2f61 7373 6574 732f 6c6f 6f6b 7570 732f  /assets/lookups/
+00010ec0: 6372 6974 6963 616c 5f76 616c 7565 735f  critical_values_
+00010ed0: 352e 7069 636b 6c65 222c 2022 7262 2229  5.pickle", "rb")
+00010ee0: 295b 2763 6869 5f73 7175 6172 6527 5d5b  )['chi_square'][
+00010ef0: 276f 6e65 5f74 6169 6c27 5d2e 7661 6c75  'one_tail'].valu
+00010f00: 6573 0a20 2020 2020 2020 203e 3e3e 2053  es.        >>> S
+00010f10: 7461 7469 7374 6963 732e 6368 695f 7371  tatistics.chi_sq
+00010f20: 7561 7265 2873 616d 706c 655f 313d 7361  uare(sample_1=sa
+00010f30: 6d70 6c65 5f32 2c20 7361 6d70 6c65 5f32  mple_2, sample_2
+00010f40: 3d73 616d 706c 655f 312c 2063 7269 7469  =sample_1, criti
+00010f50: 6361 6c5f 7661 6c75 6573 3d63 7269 7469  cal_values=criti
+00010f60: 6361 6c5f 7661 6c75 6573 2c20 7479 7065  cal_values, type
+00010f70: 3d27 676f 6f64 6e65 7373 5f6f 665f 6669  ='goodness_of_fi
+00010f80: 7427 290a 2020 2020 2020 2020 3e3e 3e20  t').        >>> 
+00010f90: 2838 2e33 3333 2c20 4661 6c73 6529 0a20  (8.333, False). 
+00010fa0: 2020 2020 2020 203e 3e3e 0a20 2020 2020         >>>.     
+00010fb0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00010fc0: 6368 695f 7371 7561 7265 2c20 7369 676e  chi_square, sign
+00010fd0: 6966 6963 616e 6365 5f62 6f6f 6c20 3d20  ificance_bool = 
+00010fe0: 302e 302c 204e 6f6e 650a 2020 2020 2020  0.0, None.      
+00010ff0: 2020 756e 6971 7565 5f63 6174 6567 6f72    unique_categor
+00011000: 6965 7320 3d20 6e70 2e75 6e69 7175 6528  ies = np.unique(
+00011010: 6e70 2e63 6f6e 6361 7465 6e61 7465 2828  np.concatenate((
+00011020: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+00011030: 5f32 2929 290a 2020 2020 2020 2020 7361  _2))).        sa
+00011040: 6d70 6c65 5f31 5f63 6f75 6e74 7320 3d20  mple_1_counts = 
+00011050: 6e70 2e7a 6572 6f73 286c 656e 2875 6e69  np.zeros(len(uni
+00011060: 7175 655f 6361 7465 676f 7269 6573 292c  que_categories),
+00011070: 2064 7479 7065 3d6e 702e 696e 7436 3429   dtype=np.int64)
+00011080: 0a20 2020 2020 2020 2073 616d 706c 655f  .        sample_
+00011090: 325f 636f 756e 7473 203d 206e 702e 7a65  2_counts = np.ze
+000110a0: 726f 7328 6c65 6e28 756e 6971 7565 5f63  ros(len(unique_c
+000110b0: 6174 6567 6f72 6965 7329 2c20 6474 7970  ategories), dtyp
+000110c0: 653d 6e70 2e69 6e74 3634 290a 0a20 2020  e=np.int64)..   
+000110d0: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
+000110e0: 616e 6765 286c 656e 2875 6e69 7175 655f  ange(len(unique_
+000110f0: 6361 7465 676f 7269 6573 2929 3a0a 2020  categories)):.  
+00011100: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00011110: 5f31 5f63 6f75 6e74 735b 695d 2c20 7361  _1_counts[i], sa
+00011120: 6d70 6c65 5f32 5f63 6f75 6e74 735b 695d  mple_2_counts[i]
+00011130: 203d 206e 702e 7375 6d28 0a20 2020 2020   = np.sum(.     
+00011140: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00011150: 655f 3120 3d3d 2075 6e69 7175 655f 6361  e_1 == unique_ca
+00011160: 7465 676f 7269 6573 5b69 5d0a 2020 2020  tegories[i].    
+00011170: 2020 2020 2020 2020 292c 206e 702e 7375          ), np.su
+00011180: 6d28 7361 6d70 6c65 5f32 203d 3d20 756e  m(sample_2 == un
+00011190: 6971 7565 5f63 6174 6567 6f72 6965 735b  ique_categories[
+000111a0: 695d 290a 0a20 2020 2020 2020 2066 6f72  i])..        for
+000111b0: 2069 2069 6e20 7072 616e 6765 286c 656e   i in prange(len
+000111c0: 2875 6e69 7175 655f 6361 7465 676f 7269  (unique_categori
+000111d0: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
+000111e0: 2020 636f 756e 745f 312c 2063 6f75 6e74    count_1, count
+000111f0: 5f32 203d 2073 616d 706c 655f 315f 636f  _2 = sample_1_co
+00011200: 756e 7473 5b69 5d2c 2073 616d 706c 655f  unts[i], sample_
+00011210: 325f 636f 756e 7473 5b69 5d0a 2020 2020  2_counts[i].    
+00011220: 2020 2020 2020 2020 6966 2063 6f75 6e74          if count
+00011230: 5f32 203e 2030 3a0a 2020 2020 2020 2020  _2 > 0:.        
+00011240: 2020 2020 2020 2020 6368 695f 7371 7561          chi_squa
+00011250: 7265 202b 3d20 2828 636f 756e 745f 3120  re += ((count_1 
+00011260: 2d20 636f 756e 745f 3229 202a 2a20 3229  - count_2) ** 2)
+00011270: 202f 2063 6f75 6e74 5f32 0a20 2020 2020   / count_2.     
+00011280: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00011290: 2020 2020 2020 2020 2020 2020 2063 6869               chi
+000112a0: 5f73 7175 6172 6520 2b3d 2028 2863 6f75  _square += ((cou
+000112b0: 6e74 5f31 202d 2063 6f75 6e74 5f32 2920  nt_1 - count_2) 
+000112c0: 2a2a 2032 2920 2f20 2863 6f75 6e74 5f32  ** 2) / (count_2
+000112d0: 202b 2031 290a 0a20 2020 2020 2020 2069   + 1)..        i
+000112e0: 6620 6372 6974 6963 616c 5f76 616c 7565  f critical_value
+000112f0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00011300: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
+00011310: 7065 203d 3d20 2267 6f6f 646e 6573 735f  pe == "goodness_
+00011320: 6f66 5f66 6974 223a 0a20 2020 2020 2020  of_fit":.       
+00011330: 2020 2020 2020 2020 2064 6620 3d20 756e           df = un
+00011340: 6971 7565 5f63 6174 6567 6f72 6965 732e  ique_categories.
+00011350: 7368 6170 655b 305d 202d 2031 0a20 2020  shape[0] - 1.   
+00011360: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00011370: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00011380: 6620 3d20 286c 656e 2873 616d 706c 655f  f = (len(sample_
+00011390: 315f 636f 756e 7473 2920 2d20 3129 202a  1_counts) - 1) *
+000113a0: 2028 6c65 6e28 7361 6d70 6c65 5f32 5f63   (len(sample_2_c
+000113b0: 6f75 6e74 7329 202d 2031 290a 0a20 2020  ounts) - 1)..   
+000113c0: 2020 2020 2020 2020 2063 7269 7469 6361           critica
+000113d0: 6c5f 7661 6c75 6520 3d20 6e70 2e69 6e74  l_value = np.int
+000113e0: 6572 7028 6466 2c20 6372 6974 6963 616c  erp(df, critical
+000113f0: 5f76 616c 7565 735b 3a2c 2030 5d2c 2063  _values[:, 0], c
+00011400: 7269 7469 6361 6c5f 7661 6c75 6573 5b3a  ritical_values[:
+00011410: 2c20 315d 290a 2020 2020 2020 2020 2020  , 1]).          
+00011420: 2020 6966 2063 6869 5f73 7175 6172 6520    if chi_square 
+00011430: 3e3d 2063 7269 7469 6361 6c5f 7661 6c75  >= critical_valu
+00011440: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00011450: 2020 2073 6967 6e69 6669 6361 6e63 655f     significance_
+00011460: 626f 6f6c 203d 2054 7275 650a 2020 2020  bool = True.    
+00011470: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00011480: 2020 2020 2020 2020 2020 2020 2020 7369                si
+00011490: 676e 6966 6963 616e 6365 5f62 6f6f 6c20  gnificance_bool 
+000114a0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+000114b0: 2072 6574 7572 6e20 6368 695f 7371 7561   return chi_squa
+000114c0: 7265 2c20 7369 676e 6966 6963 616e 6365  re, significance
+000114d0: 5f62 6f6f 6c0a 0a20 2020 2040 7374 6174  _bool..    @stat
+000114e0: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
+000114f0: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
+00011500: 2066 6c6f 6174 3332 2c20 666c 6f61 7433   float32, float3
+00011510: 322c 2066 6c6f 6174 3332 5b3a 2c3a 5d2c  2, float32[:,:],
+00011520: 2066 6c6f 6174 3332 2922 290a 2020 2020   float32)").    
+00011530: 6465 6620 736c 6964 696e 675f 696e 6465  def sliding_inde
+00011540: 7065 6e64 656e 745f 7361 6d70 6c65 735f  pendent_samples_
+00011550: 7428 0a20 2020 2020 2020 2064 6174 613a  t(.        data:
+00011560: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
+00011570: 2020 2020 2074 696d 655f 7769 6e64 6f77       time_window
+00011580: 3a20 666c 6f61 742c 0a20 2020 2020 2020  : float,.       
+00011590: 2073 6c69 6465 5f74 696d 653a 2066 6c6f   slide_time: flo
+000115a0: 6174 2c0a 2020 2020 2020 2020 6372 6974  at,.        crit
+000115b0: 6963 616c 5f76 616c 7565 733a 206e 702e  ical_values: np.
+000115c0: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
+000115d0: 2066 7073 3a20 666c 6f61 742c 0a20 2020   fps: float,.   
+000115e0: 2029 202d 3e20 6e70 2e6e 6461 7272 6179   ) -> np.ndarray
+000115f0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00011600: 2020 2020 2020 4a69 7474 6564 2063 6f6d        Jitted com
+00011610: 7075 7465 206f 6620 736c 6964 696e 6720  pute of sliding 
+00011620: 696e 6465 7065 6e64 656e 7420 7361 6d70  independent samp
+00011630: 6c65 2074 2d74 6573 742e 2043 6f6d 7061  le t-test. Compa
+00011640: 7265 7320 7468 6520 6665 6174 7572 6520  res the feature 
+00011650: 7661 6c75 6573 2069 6e20 6375 7272 656e  values in curren
+00011660: 7420 7469 6d65 2d77 696e 646f 770a 2020  t time-window.  
+00011670: 2020 2020 2020 746f 2070 7269 6f72 2074        to prior t
+00011680: 696d 652d 7769 6e64 6f77 7320 746f 2066  ime-windows to f
+00011690: 696e 6420 7468 6520 6c65 6e67 7468 2069  ind the length i
+000116a0: 6e20 7469 6d65 2074 6f20 7468 6520 6d6f  n time to the mo
+000116b0: 7374 2072 6563 656e 7420 7469 6d65 2d77  st recent time-w
+000116c0: 696e 646f 7720 7768 6572 6520 6120 7369  indow where a si
+000116d0: 676e 6966 6963 616e 746c 7920 6469 6666  gnificantly diff
+000116e0: 6572 656e 740a 2020 2020 2020 2020 6665  erent.        fe
+000116f0: 6174 7572 6520 7661 6c75 6520 6469 7374  ature value dist
+00011700: 7269 6275 7469 6f6e 2069 7320 6465 7465  ribution is dete
+00011710: 6374 6564 2e0a 0a20 2020 2020 2020 202e  cted...        .
+00011720: 2e20 696d 6167 653a 3a20 5f73 7461 7469  . image:: _stati
+00011730: 632f 696d 672f 736c 6964 696e 675f 7374  c/img/sliding_st
+00011740: 6174 6973 7469 6373 2e70 6e67 0a20 2020  atistics.png.   
+00011750: 2020 2020 2020 2020 3a77 6964 7468 3a20          :width: 
+00011760: 3135 3030 0a20 2020 2020 2020 2020 2020  1500.           
+00011770: 3a61 6c69 676e 3a20 6365 6e74 6572 0a0a  :align: center..
+00011780: 2020 2020 2020 2020 3a70 6172 616d 6574          :paramet
+00011790: 6572 206e 6461 7272 6179 2064 6174 613a  er ndarray data:
+000117a0: 2031 4420 6172 7261 7920 7769 7468 2066   1D array with f
+000117b0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+000117c0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+000117d0: 7220 666c 6f61 7420 7469 6d65 5f77 696e  r float time_win
+000117e0: 646f 773a 2054 6865 2073 697a 6573 206f  dow: The sizes o
+000117f0: 6620 7468 6520 7477 6f20 6665 6174 7572  f the two featur
+00011800: 6520 7661 6c75 6520 7769 6e64 6f77 7320  e value windows 
+00011810: 6265 696e 6720 636f 6d70 6172 6564 2069  being compared i
+00011820: 6e20 7365 636f 6e64 732e 0a20 2020 2020  n seconds..     
+00011830: 2020 203a 7061 7261 6d65 7465 7220 666c     :parameter fl
+00011840: 6f61 7420 736c 6964 655f 7469 6d65 3a20  oat slide_time: 
+00011850: 5468 6520 736c 6964 6520 7369 7a65 206f  The slide size o
+00011860: 6620 7468 6520 7365 636f 6e64 2077 696e  f the second win
+00011870: 646f 772e 0a20 2020 2020 2020 203a 7061  dow..        :pa
+00011880: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+00011890: 6372 6974 6963 616c 5f76 616c 7565 733a  critical_values:
+000118a0: 2032 4420 6172 7261 7920 7769 7468 2077   2D array with w
+000118b0: 6865 7265 2069 6e64 6578 6573 2072 6570  here indexes rep
+000118c0: 7265 7365 6e74 2064 6567 7265 6573 206f  resent degrees o
+000118d0: 6620 6672 6565 646f 6d20 616e 6420 7661  f freedom and va
+000118e0: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+000118f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011910: 2072 6570 7265 7365 6e74 2063 7269 7469   represent criti
+00011920: 6361 6c20 5420 7661 6c75 6573 2e20 4361  cal T values. Ca
+00011930: 6e20 6265 2066 6f75 6e64 2069 6e20 6060  n be found in ``
+00011940: 7369 6d62 612e 6173 7365 7473 2e63 7269  simba.assets.cri
+00011950: 7469 6361 6c5f 7661 6c75 6573 5f30 352e  tical_values_05.
+00011960: 7069 636b 6c65 6060 2e0a 2020 2020 2020  pickle``..      
+00011970: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
+00011980: 2066 7073 3a20 5468 6520 6670 7320 6f66   fps: The fps of
+00011990: 2074 6865 2072 6563 6f72 6465 6420 7669   the recorded vi
+000119a0: 6465 6f2e 0a20 2020 2020 2020 203a 7265  deo..        :re
+000119b0: 7475 726e 7320 6e70 2e6e 6461 7272 6179  turns np.ndarray
+000119c0: 3a20 3144 2061 7272 6179 206f 6620 7369  : 1D array of si
+000119d0: 7a65 206c 656e 2864 6174 6129 2077 6974  ze len(data) wit
+000119e0: 6820 7661 6c75 6573 2072 6570 7265 7365  h values represe
+000119f0: 6e74 696e 6720 7469 6d65 2074 6f20 6d6f  nting time to mo
+00011a00: 7374 2072 6563 656e 7420 7369 676e 6966  st recent signif
+00011a10: 6963 616e 746c 7920 6469 6666 6572 656e  icantly differen
+00011a20: 7420 6665 6174 7572 6520 6469 7374 7269  t feature distri
+00011a30: 6275 7469 6f6e 2e0a 0a20 2020 2020 2020  bution...       
+00011a40: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+00011a50: 2020 203e 3e3e 2064 6174 6120 3d20 6e70     >>> data = np
+00011a60: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+00011a70: 302c 2035 302c 2028 3130 2929 2e61 7374  0, 50, (10)).ast
+00011a80: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+00011a90: 2020 2020 2020 2020 3e3e 3e20 6372 6974          >>> crit
+00011aa0: 6963 616c 5f76 616c 7565 7320 3d20 7069  ical_values = pi
+00011ab0: 636b 6c65 2e6c 6f61 6428 6f70 656e 2822  ckle.load(open("
+00011ac0: 7369 6d62 612f 6173 7365 7473 2f6c 6f6f  simba/assets/loo
+00011ad0: 6b75 7073 2f63 7269 7469 6361 6c5f 7661  kups/critical_va
+00011ae0: 6c75 6573 5f30 352e 7069 636b 6c65 222c  lues_05.pickle",
+00011af0: 2022 7262 2229 295b 2769 6e64 6570 656e   "rb"))['indepen
+00011b00: 6465 6e74 5f74 5f74 6573 7427 5d5b 276f  dent_t_test']['o
+00011b10: 6e65 5f74 6169 6c27 5d2e 7661 6c75 6573  ne_tail'].values
+00011b20: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00011b30: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
+00011b40: 7265 7375 6c74 7320 3d20 5374 6174 6973  results = Statis
+00011b50: 7469 6373 2829 2e73 6c69 6469 6e67 5f69  tics().sliding_i
+00011b60: 6e64 6570 656e 6465 6e74 5f73 616d 706c  ndependent_sampl
+00011b70: 6573 5f74 2864 6174 613d 6461 7461 2c20  es_t(data=data, 
+00011b80: 7469 6d65 5f77 696e 646f 773d 302e 352c  time_window=0.5,
+00011b90: 2066 7073 3d35 2e30 2c20 6372 6974 6963   fps=5.0, critic
+00011ba0: 616c 5f76 616c 7565 733d 6372 6974 6963  al_values=critic
+00011bb0: 616c 5f76 616c 7565 732c 2073 6c69 6465  al_values, slide
+00011bc0: 5f74 696d 653d 302e 3330 290a 2020 2020  _time=0.30).    
+00011bd0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00011be0: 2072 6573 756c 7473 203d 206e 702e 6675   results = np.fu
+00011bf0: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
+00011c00: 5d29 2c20 302e 3029 0a20 2020 2020 2020  ]), 0.0).       
+00011c10: 2077 696e 646f 775f 7369 7a65 2c20 736c   window_size, sl
+00011c20: 6964 655f 7369 7a65 203d 2069 6e74 2874  ide_size = int(t
+00011c30: 696d 655f 7769 6e64 6f77 202a 2066 7073  ime_window * fps
+00011c40: 292c 2069 6e74 2873 6c69 6465 5f74 696d  ), int(slide_tim
+00011c50: 6520 2a20 6670 7329 0a20 2020 2020 2020  e * fps).       
+00011c60: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00011c70: 312c 2064 6174 612e 7368 6170 655b 305d  1, data.shape[0]
+00011c80: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00011c90: 616d 706c 655f 315f 6c65 6674 2c20 7361  ample_1_left, sa
+00011ca0: 6d70 6c65 5f31 5f72 6967 6874 203d 2069  mple_1_right = i
+00011cb0: 2c20 6920 2b20 7769 6e64 6f77 5f73 697a  , i + window_siz
+00011cc0: 650a 2020 2020 2020 2020 2020 2020 7361  e.            sa
+00011cd0: 6d70 6c65 5f32 5f6c 6566 742c 2073 616d  mple_2_left, sam
+00011ce0: 706c 655f 325f 7269 6768 7420 3d20 280a  ple_2_right = (.
+00011cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d00: 7361 6d70 6c65 5f31 5f6c 6566 7420 2d20  sample_1_left - 
+00011d10: 736c 6964 655f 7369 7a65 2c0a 2020 2020  slide_size,.    
+00011d20: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00011d30: 6c65 5f31 5f72 6967 6874 202d 2073 6c69  le_1_right - sli
+00011d40: 6465 5f73 697a 652c 0a20 2020 2020 2020  de_size,.       
+00011d50: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00011d60: 2020 2073 616d 706c 655f 3120 3d20 6461     sample_1 = da
+00011d70: 7461 5b73 616d 706c 655f 315f 6c65 6674  ta[sample_1_left
+00011d80: 3a73 616d 706c 655f 315f 7269 6768 745d  :sample_1_right]
+00011d90: 0a20 2020 2020 2020 2020 2020 2064 6f66  .            dof
+00011da0: 2c20 7374 6570 735f 7461 6b65 6e20 3d20  , steps_taken = 
+00011db0: 2873 616d 706c 655f 312e 7368 6170 655b  (sample_1.shape[
+00011dc0: 305d 202b 2073 616d 706c 655f 312e 7368  0] + sample_1.sh
+00011dd0: 6170 655b 305d 2920 2d20 322c 2031 0a20  ape[0]) - 2, 1. 
+00011de0: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+00011df0: 2073 616d 706c 655f 325f 6c65 6674 203e   sample_2_left >
+00011e00: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00011e10: 2020 2020 2073 616d 706c 655f 3220 3d20       sample_2 = 
+00011e20: 6461 7461 5b73 616d 706c 655f 325f 6c65  data[sample_2_le
+00011e30: 6674 3a73 616d 706c 655f 325f 7269 6768  ft:sample_2_righ
+00011e40: 745d 0a20 2020 2020 2020 2020 2020 2020  t].             
+00011e50: 2020 2074 5f73 7461 7469 7374 6963 203d     t_statistic =
+00011e60: 2028 6e70 2e6d 6561 6e28 7361 6d70 6c65   (np.mean(sample
+00011e70: 5f31 2920 2d20 6e70 2e6d 6561 6e28 7361  _1) - np.mean(sa
+00011e80: 6d70 6c65 5f32 2929 202f 206e 702e 7371  mple_2)) / np.sq
+00011e90: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
+00011ea0: 2020 2020 2020 2020 286e 702e 7374 6428          (np.std(
+00011eb0: 7361 6d70 6c65 5f31 2920 2f20 7361 6d70  sample_1) / samp
+00011ec0: 6c65 5f31 2e73 6861 7065 5b30 5d29 0a20  le_1.shape[0]). 
+00011ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ee0: 2020 202b 2028 6e70 2e73 7464 2873 616d     + (np.std(sam
+00011ef0: 706c 655f 3229 202f 2073 616d 706c 655f  ple_2) / sample_
+00011f00: 312e 7368 6170 655b 305d 290a 2020 2020  1.shape[0]).    
+00011f10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00011f20: 2020 2020 2020 2020 2020 2020 2020 6372                cr
+00011f30: 6974 6963 616c 5f76 616c 203d 2063 7269  itical_val = cri
+00011f40: 7469 6361 6c5f 7661 6c75 6573 5b64 6f66  tical_values[dof
+00011f50: 202d 2031 5d5b 315d 0a20 2020 2020 2020   - 1][1].       
+00011f60: 2020 2020 2020 2020 2069 6620 745f 7374           if t_st
+00011f70: 6174 6973 7469 6320 3e3d 2063 7269 7469  atistic >= criti
+00011f80: 6361 6c5f 7661 6c3a 0a20 2020 2020 2020  cal_val:.       
+00011f90: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+00011fa0: 616b 0a20 2020 2020 2020 2020 2020 2020  ak.             
+00011fb0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00011fc0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+00011fd0: 706c 655f 325f 6c65 6674 202d 3d20 310a  ple_2_left -= 1.
+00011fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ff0: 2020 2020 7361 6d70 6c65 5f32 5f72 6967      sample_2_rig
+00012000: 6874 202d 3d20 310a 2020 2020 2020 2020  ht -= 1.        
+00012010: 2020 2020 2020 2020 2020 2020 7374 6570              step
+00012020: 735f 7461 6b65 6e20 2b3d 2031 0a20 2020  s_taken += 1.   
+00012030: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00012040: 7361 6d70 6c65 5f32 5f6c 6566 7420 3c20  sample_2_left < 
+00012050: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+00012060: 2020 2020 2020 2073 7465 7073 5f74 616b         steps_tak
+00012070: 656e 203d 202d 310a 2020 2020 2020 2020  en = -1.        
+00012080: 2020 2020 6966 2073 7465 7073 5f74 616b      if steps_tak
+00012090: 656e 203d 3d20 2d31 3a0a 2020 2020 2020  en == -1:.      
+000120a0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+000120b0: 735b 6920 2b20 7769 6e64 6f77 5f73 697a  s[i + window_siz
+000120c0: 655d 203d 202d 310a 2020 2020 2020 2020  e] = -1.        
+000120d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000120e0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+000120f0: 735b 6920 2b20 7769 6e64 6f77 5f73 697a  s[i + window_siz
+00012100: 655d 203d 2073 7465 7073 5f74 616b 656e  e] = steps_taken
+00012110: 202a 2073 6c69 6465 5f74 696d 650a 0a20   * slide_time.. 
+00012120: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00012130: 7375 6c74 730a 0a20 2020 2040 7374 6174  sults..    @stat
+00012140: 6963 6d65 7468 6f64 0a20 2020 2040 6e6a  icmethod.    @nj
+00012150: 6974 2822 2866 6c6f 6174 3332 5b3a 5d2c  it("(float32[:],
+00012160: 2066 6c6f 6174 3634 5b3a 5d2c 2066 6c6f   float64[:], flo
+00012170: 6174 3332 2922 290a 2020 2020 6465 6620  at32)").    def 
+00012180: 726f 6c6c 696e 675f 6d61 6e6e 5f77 6869  rolling_mann_whi
+00012190: 746e 6579 2864 6174 613a 206e 702e 6e64  tney(data: np.nd
+000121a0: 6172 7261 792c 2074 696d 655f 7769 6e64  array, time_wind
+000121b0: 6f77 733a 206e 702e 6e64 6172 7261 792c  ows: np.ndarray,
+000121c0: 2066 7073 3a20 666c 6f61 7429 3a0a 2020   fps: float):.  
+000121d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000121e0: 2020 4a69 7474 6564 2063 6f6d 7075 7465    Jitted compute
+000121f0: 206f 6620 726f 6c6c 696e 6720 4d61 6e6e   of rolling Mann
+00012200: 2d57 6869 746e 6579 2055 2063 6f6d 7061  -Whitney U compa
+00012210: 7269 6e67 2074 6865 2063 7572 7265 6e74  ring the current
+00012220: 2074 696d 652d 7769 6e64 6f77 206f 660a   time-window of.
+00012230: 2020 2020 2020 2020 7369 7a65 204e 2074          size N t
+00012240: 6f20 7468 6520 7072 6563 6564 696e 6720  o the preceding 
+00012250: 7769 6e64 6f77 206f 6620 7369 7a65 204e  window of size N
+00012260: 2e0a 0a20 2020 2020 2020 202e 2e20 6e6f  ...        .. no
+00012270: 7465 3a3a 0a20 2020 2020 2020 2020 2020  te::.           
+00012280: 4669 7273 7420 7469 6d65 2062 696e 2028  First time bin (
+00012290: 7768 6572 6520 6861 7320 6e6f 2070 7265  where has no pre
+000122a0: 6365 6469 6e67 2074 696d 6520 6269 6e29  ceding time bin)
+000122b0: 2077 696c 6c20 6861 7665 2066 696c 6c20   will have fill 
+000122c0: 7661 6c75 6520 6060 3060 600a 0a20 2020  value ``0``..   
+000122d0: 2020 2020 2020 2020 604d 6f64 6966 6965          `Modifie
+000122e0: 6420 6672 6f6d 204a 616d 6573 2057 6562  d from James Web
+000122f0: 6265 7220 6769 7374 203c 6874 7470 733a  ber gist <https:
+00012300: 2f2f 6769 7374 2e67 6974 6875 622e 636f  //gist.github.co
+00012310: 6d2f 6a61 6d65 7374 7765 6262 6572 2f33  m/jamestwebber/3
+00012320: 3861 6232 3664 3238 3166 3937 6665 6238  8ab26d281f97feb8
+00012330: 3139 3662 3364 3933 6564 6565 6237 623e  196b3d93edeeb7b>
+00012340: 605f 5f2e 0a0a 2020 2020 2020 2020 3a70  `__...        :p
+00012350: 6172 616d 6574 6572 206e 6461 7272 6179  arameter ndarray
+00012360: 2073 616d 706c 655f 313a 2046 6972 7374   sample_1: First
+00012370: 2031 6420 6172 7261 7920 7265 7072 6573   1d array repres
+00012380: 656e 7469 6e67 2066 6561 7475 7265 2076  enting feature v
+00012390: 616c 7565 732e 0a20 2020 2020 2020 203a  alues..        :
+000123a0: 7061 7261 6d65 7465 7220 6e64 6172 7261  parameter ndarra
+000123b0: 7920 7361 6d70 6c65 5f32 3a20 5365 636f  y sample_2: Seco
+000123c0: 6e64 2031 6420 6172 7261 7920 7265 7072  nd 1d array repr
+000123d0: 6573 656e 7469 6e67 2066 6561 7475 7265  esenting feature
+000123e0: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
+000123f0: 203a 7265 7475 726e 7320 6e70 2e6e 6461   :returns np.nda
+00012400: 7272 6179 3a20 4d61 6e6e 2d57 6869 746e  rray: Mann-Whitn
+00012410: 6579 2055 2064 6174 6120 6f66 2073 697a  ey U data of siz
+00012420: 6520 6c65 6e28 6461 7461 2920 7820 6c65  e len(data) x le
+00012430: 6e28 7469 6d65 5f77 696e 646f 7773 292e  n(time_windows).
+00012440: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+00012450: 6c65 733a 0a20 2020 2020 2020 203e 3e3e  les:.        >>>
+00012460: 2064 6174 6120 3d20 6e70 2e72 616e 646f   data = np.rando
+00012470: 6d2e 7261 6e64 696e 7428 302c 2034 2c20  m.randint(0, 4, 
+00012480: 2832 3030 2929 2e61 7374 7970 6528 6e70  (200)).astype(np
+00012490: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+000124a0: 2020 3e3e 3e20 7265 7375 6c74 7320 3d20    >>> results = 
+000124b0: 5374 6174 6973 7469 6373 2829 2e72 6f6c  Statistics().rol
+000124c0: 6c69 6e67 5f6d 616e 6e5f 7768 6974 6e65  ling_mann_whitne
+000124d0: 7928 6461 7461 3d64 6174 612c 2074 696d  y(data=data, tim
+000124e0: 655f 7769 6e64 6f77 733d 6e70 2e61 7272  e_windows=np.arr
+000124f0: 6179 285b 312e 305d 292c 2066 7073 3d31  ay([1.0]), fps=1
+00012500: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
+00012510: 2020 2020 2020 2072 6573 756c 7473 203d         results =
+00012520: 206e 702e 6675 6c6c 2828 6461 7461 2e73   np.full((data.s
+00012530: 6861 7065 5b30 5d2c 2074 696d 655f 7769  hape[0], time_wi
+00012540: 6e64 6f77 732e 7368 6170 655b 305d 292c  ndows.shape[0]),
+00012550: 2030 2e30 290a 2020 2020 2020 2020 666f   0.0).        fo
+00012560: 7220 6920 696e 2070 7261 6e67 6528 7469  r i in prange(ti
+00012570: 6d65 5f77 696e 646f 7773 2e73 6861 7065  me_windows.shape
+00012580: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+00012590: 2020 7769 6e64 6f77 5f73 697a 6520 3d20    window_size = 
+000125a0: 696e 7428 7469 6d65 5f77 696e 646f 7773  int(time_windows
+000125b0: 5b69 5d20 2a20 6670 7329 0a20 2020 2020  [i] * fps).     
+000125c0: 2020 2020 2020 2064 6174 615f 7370 6c69         data_spli
+000125d0: 7420 3d20 6e70 2e73 706c 6974 280a 2020  t = np.split(.  
+000125e0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+000125f0: 7461 2c20 6c69 7374 2872 616e 6765 2877  ta, list(range(w
+00012600: 696e 646f 775f 7369 7a65 2c20 6461 7461  indow_size, data
+00012610: 2e73 6861 7065 5b30 5d2c 2077 696e 646f  .shape[0], windo
+00012620: 775f 7369 7a65 2929 0a20 2020 2020 2020  w_size)).       
+00012630: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00012640: 2020 2066 6f72 206a 2069 6e20 7072 616e     for j in pran
+00012650: 6765 2831 2c20 6c65 6e28 6461 7461 5f73  ge(1, len(data_s
+00012660: 706c 6974 2929 3a0a 2020 2020 2020 2020  plit)):.        
+00012670: 2020 2020 2020 2020 7769 6e64 6f77 5f73          window_s
+00012680: 7461 7274 203d 2069 6e74 2877 696e 646f  tart = int(windo
+00012690: 775f 7369 7a65 202a 206a 290a 2020 2020  w_size * j).    
+000126a0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+000126b0: 6f77 5f65 6e64 203d 2069 6e74 2877 696e  ow_end = int(win
+000126c0: 646f 775f 7374 6172 7420 2b20 7769 6e64  dow_start + wind
+000126d0: 6f77 5f73 697a 6529 0a20 2020 2020 2020  ow_size).       
+000126e0: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+000126f0: 312c 2073 616d 706c 655f 3220 3d20 6461  1, sample_2 = da
+00012700: 7461 5f73 706c 6974 5b6a 202d 2031 5d2e  ta_split[j - 1].
+00012710: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+00012720: 3229 2c20 6461 7461 5f73 706c 6974 5b0a  2), data_split[.
+00012730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012740: 2020 2020 6a0a 2020 2020 2020 2020 2020      j.          
+00012750: 2020 2020 2020 5d2e 6173 7479 7065 286e        ].astype(n
+00012760: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+00012770: 2020 2020 2020 2020 2020 206e 312c 206e             n1, n
+00012780: 3220 3d20 7361 6d70 6c65 5f31 2e73 6861  2 = sample_1.sha
+00012790: 7065 5b30 5d2c 2073 616d 706c 655f 322e  pe[0], sample_2.
+000127a0: 7368 6170 655b 305d 0a20 2020 2020 2020  shape[0].       
+000127b0: 2020 2020 2020 2020 2072 616e 6b65 6420           ranked 
+000127c0: 3d20 6661 7374 5f6d 6561 6e5f 7261 6e6b  = fast_mean_rank
+000127d0: 286e 702e 636f 6e63 6174 656e 6174 6528  (np.concatenate(
+000127e0: 2873 616d 706c 655f 312c 2073 616d 706c  (sample_1, sampl
+000127f0: 655f 3229 2929 0a20 2020 2020 2020 2020  e_2))).         
+00012800: 2020 2020 2020 2075 3120 3d20 6e31 202a         u1 = n1 *
+00012810: 206e 3220 2b20 286e 3120 2a20 286e 3120   n2 + (n1 * (n1 
+00012820: 2b20 3129 2920 2f20 322e 3020 2d20 6e70  + 1)) / 2.0 - np
+00012830: 2e73 756d 2872 616e 6b65 645b 3a6e 315d  .sum(ranked[:n1]
+00012840: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+00012850: 2020 2020 2020 2020 2020 7532 203d 206e            u2 = n
+00012860: 3120 2a20 6e32 202d 2075 310a 2020 2020  1 * n2 - u1.    
+00012870: 2020 2020 2020 2020 2020 2020 7520 3d20              u = 
+00012880: 6d69 6e28 7531 2c20 7532 290a 2020 2020  min(u1, u2).    
+00012890: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+000128a0: 6c74 735b 7769 6e64 6f77 5f73 7461 7274  lts[window_start
+000128b0: 3a77 696e 646f 775f 656e 642c 2069 5d20  :window_end, i] 
+000128c0: 3d20 750a 0a20 2020 2020 2020 2072 6574  = u..        ret
+000128d0: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
+000128e0: 2064 6566 2063 686f 775f 7465 7374 2873   def chow_test(s
+000128f0: 656c 6629 3a0a 2020 2020 2020 2020 7061  elf):.        pa
+00012900: 7373 0a0a 2020 2020 4073 7461 7469 636d  ss..    @staticm
+00012910: 6574 686f 640a 2020 2020 406e 6a69 7428  ethod.    @njit(
+00012920: 2228 696e 7436 345b 3a2c 203a 5d29 2c20  "(int64[:, :]), 
+00012930: 626f 6f6c 5f22 290a 2020 2020 6465 6620  bool_").    def 
+00012940: 636f 6e63 6f72 6461 6e63 655f 7261 7469  concordance_rati
+00012950: 6f28 783a 206e 702e 6e64 6172 7261 792c  o(x: np.ndarray,
+00012960: 2069 6e76 6572 743a 2062 6f6f 6c29 202d   invert: bool) -
+00012970: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
+00012980: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
+00012990: 6375 6c61 7465 2074 6865 2063 6f6e 636f  culate the conco
+000129a0: 7264 616e 6365 2072 6174 696f 206f 6620  rdance ratio of 
+000129b0: 6120 3244 206e 756d 7079 2061 7272 6179  a 2D numpy array
+000129c0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+000129d0: 6d20 6e70 2e6e 6461 7272 6179 2078 3a20  m np.ndarray x: 
+000129e0: 4120 3244 206e 756d 7079 2061 7272 6179  A 2D numpy array
+000129f0: 2077 6974 6820 6f72 6469 6e61 6c73 2072   with ordinals r
+00012a00: 6570 7265 7365 6e74 6564 2061 7320 696e  epresented as in
+00012a10: 7465 6765 7273 2e0a 2020 2020 2020 2020  tegers..        
+00012a20: 3a70 6172 616d 2062 6f6f 6c20 696e 7665  :param bool inve
+00012a30: 7274 3a20 4966 2054 7275 652c 2074 6865  rt: If True, the
+00012a40: 2063 6f6e 636f 7264 616e 6365 2072 6174   concordance rat
+00012a50: 696f 2069 7320 696e 7665 7274 6564 2c20  io is inverted, 
+00012a60: 616e 6420 6469 7363 6f6e 636f 7264 616e  and disconcordan
+00012a70: 6365 2072 6174 696f 2069 7320 7265 7475  ce ratio is retu
+00012a80: 726e 6564 0a20 2020 2020 2020 203a 7265  rned.        :re
+00012a90: 7475 726e 2066 6c6f 6174 3a20 5468 6520  turn float: The 
+00012aa0: 636f 6e63 6f72 6461 6e63 6520 7261 7469  concordance rati
+00012ab0: 6f2c 2072 6570 7265 7365 6e74 696e 6720  o, representing 
+00012ac0: 7468 6520 636f 756e 7420 6f66 2072 6f77  the count of row
+00012ad0: 7320 7769 7468 206f 6e6c 7920 6f6e 6520  s with only one 
+00012ae0: 756e 6971 7565 2076 616c 7565 2064 6976  unique value div
+00012af0: 6964 6564 2062 7920 7468 6520 746f 7461  ided by the tota
+00012b00: 6c20 6e75 6d62 6572 206f 6620 726f 7773  l number of rows
+00012b10: 2069 6e20 7468 6520 6172 7261 792e 0a0a   in the array...
+00012b20: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+00012b30: 3a0a 2020 2020 2020 2020 3e3e 3e20 7820  :.        >>> x 
+00012b40: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+00012b50: 696e 7428 302c 2032 2c20 2835 3030 302c  int(0, 2, (5000,
+00012b60: 2034 2929 0a20 2020 2020 2020 203e 3e3e   4)).        >>>
+00012b70: 2072 6573 756c 7473 203d 2053 7461 7469   results = Stati
+00012b80: 7374 6963 732e 636f 6e63 6f72 6461 6e63  stics.concordanc
+00012b90: 655f 7261 7469 6f28 783d 782c 2069 6e76  e_ratio(x=x, inv
+00012ba0: 6572 743d 4661 6c73 6529 0a20 2020 2020  ert=False).     
+00012bb0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00012bc0: 6f6e 635f 636f 756e 7420 3d20 300a 2020  onc_count = 0.  
+00012bd0: 2020 2020 2020 666f 7220 6920 696e 2070        for i in p
+00012be0: 7261 6e67 6528 782e 7368 6170 655b 305d  range(x.shape[0]
+00012bf0: 293a 0a20 2020 2020 2020 2020 2020 2075  ):.            u
+00012c00: 6e69 7175 655f 636e 7420 3d20 6e70 2e75  nique_cnt = np.u
+00012c10: 6e69 7175 6528 2878 5b69 5d29 292e 7368  nique((x[i])).sh
+00012c20: 6170 655b 305d 0a20 2020 2020 2020 2020  ape[0].         
+00012c30: 2020 2069 6620 756e 6971 7565 5f63 6e74     if unique_cnt
+00012c40: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00012c50: 2020 2020 2020 2063 6f6e 635f 636f 756e         conc_coun
+00012c60: 7420 2b3d 2031 0a20 2020 2020 2020 2069  t += 1.        i
+00012c70: 6620 696e 7665 7274 3a0a 2020 2020 2020  f invert:.      
+00012c80: 2020 2020 2020 636f 6e63 5f63 6f75 6e74        conc_count
+00012c90: 203d 2078 2e73 6861 7065 5b30 5d20 2d20   = x.shape[0] - 
+00012ca0: 636f 6e63 5f63 6f75 6e74 0a20 2020 2020  conc_count.     
+00012cb0: 2020 2072 6574 7572 6e20 636f 6e63 5f63     return conc_c
+00012cc0: 6f75 6e74 202f 2078 2e73 6861 7065 5b30  ount / x.shape[0
+00012cd0: 5d0a 0a20 2020 2040 7374 6174 6963 6d65  ]..    @staticme
+00012ce0: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+00012cf0: 2866 6c6f 6174 3332 5b3a 5d2c 2066 6c6f  (float32[:], flo
+00012d00: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3634  at32[:], float64
+00012d10: 5b3a 5d2c 2069 6e74 3634 2922 290a 2020  [:], int64)").  
+00012d20: 2020 6465 6620 736c 6964 696e 675f 7370    def sliding_sp
+00012d30: 6561 726d 616e 5f72 616e 6b5f 636f 7272  earman_rank_corr
+00012d40: 656c 6174 696f 6e28 0a20 2020 2020 2020  elation(.       
+00012d50: 2073 616d 706c 655f 313a 206e 702e 6e64   sample_1: np.nd
+00012d60: 6172 7261 792c 2073 616d 706c 655f 323a  array, sample_2:
+00012d70: 206e 702e 6e64 6172 7261 792c 2074 696d   np.ndarray, tim
+00012d80: 655f 7769 6e64 6f77 733a 206e 702e 6e64  e_windows: np.nd
+00012d90: 6172 7261 792c 2066 7073 3a20 696e 740a  array, fps: int.
+00012da0: 2020 2020 2920 2d3e 206e 702e 6e64 6172      ) -> np.ndar
+00012db0: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
+00012dc0: 0a20 2020 2020 2020 2047 6976 656e 2074  .        Given t
+00012dd0: 776f 2031 4420 6172 7261 7973 206f 6620  wo 1D arrays of 
+00012de0: 7369 7a65 204e 2c20 6372 6561 7465 2073  size N, create s
+00012df0: 6c69 6469 6e67 2077 696e 646f 7720 6f66  liding window of
+00012e00: 2073 697a 6520 7469 6d65 5f77 696e 646f   size time_windo
+00012e10: 7773 5b69 5d20 2a20 6670 7320 616e 6420  ws[i] * fps and 
+00012e20: 7265 7475 726e 2053 7065 6172 6d61 6e27  return Spearman'
+00012e30: 7320 7261 6e6b 2063 6f72 7265 6c61 7469  s rank correlati
+00012e40: 6f6e 0a20 2020 2020 2020 2062 6574 7765  on.        betwe
+00012e50: 656e 2074 6865 2076 616c 7565 7320 696e  en the values in
+00012e60: 2074 6865 2074 776f 2031 4420 6172 7261   the two 1D arra
+00012e70: 7973 2069 6e20 6561 6368 2077 696e 646f  ys in each windo
+00012e80: 772e 2041 6464 7265 7373 2022 7768 6174  w. Address "what
+00012e90: 2069 7320 7468 6520 636f 7272 656c 6174   is the correlat
+00012ea0: 696f 6e20 6265 7477 6565 6e20 4665 6174  ion between Feat
+00012eb0: 7572 6520 3120 616e 640a 2020 2020 2020  ure 1 and.      
+00012ec0: 2020 4665 6174 7572 6520 3220 696e 2074    Feature 2 in t
+00012ed0: 6865 2063 7572 7265 6e74 2058 2e58 2073  he current X.X s
+00012ee0: 6563 6f6e 6473 206f 6620 7468 6520 7669  econds of the vi
+00012ef0: 6465 6f2e 0a0a 2020 2020 2020 2020 2e2e  deo...        ..
+00012f00: 2069 6d61 6765 3a3a 205f 7374 6174 6963   image:: _static
+00012f10: 2f69 6d67 2f73 6c69 6469 6e67 5f73 7065  /img/sliding_spe
+00012f20: 6172 6d61 6e2e 706e 670a 2020 2020 2020  arman.png.      
+00012f30: 2020 2020 203a 7769 6474 683a 2036 3030       :width: 600
+00012f40: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+00012f50: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
+00012f60: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+00012f70: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
+00012f80: 2046 6972 7374 2031 4420 6172 7261 7920   First 1D array 
+00012f90: 7769 7468 2066 6561 7475 7265 2076 616c  with feature val
+00012fa0: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
+00012fb0: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+00012fc0: 7361 6d70 6c65 5f31 3a20 5365 636f 6e64  sample_1: Second
+00012fd0: 2031 4420 6172 7261 7920 7769 7468 2066   1D array with f
+00012fe0: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+00012ff0: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+00013000: 7220 666c 6f61 7420 7469 6d65 5f77 696e  r float time_win
+00013010: 646f 7773 3a20 5468 6520 6c65 6e67 7468  dows: The length
+00013020: 206f 6620 7468 6520 736c 6964 696e 6720   of the sliding 
+00013030: 7769 6e64 6f77 2069 6e20 7365 636f 6e64  window in second
+00013040: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00013050: 6d65 7465 7220 696e 7420 6670 733a 2054  meter int fps: T
+00013060: 6865 2066 7073 206f 6620 7468 6520 7265  he fps of the re
+00013070: 636f 7264 6564 2076 6964 656f 2e0a 2020  corded video..  
+00013080: 2020 2020 2020 3a72 6574 7572 6e73 206e        :returns n
+00013090: 702e 6e64 6172 7261 793a 2032 6420 6172  p.ndarray: 2d ar
+000130a0: 7261 7920 6f66 2053 6f65 6172 6d61 6e27  ray of Soearman'
+000130b0: 7320 7261 6e6b 7320 6f66 2073 697a 6520  s ranks of size 
+000130c0: 6c65 6e28 7361 6d70 6c65 5f31 2920 7820  len(sample_1) x 
+000130d0: 6c65 6e28 7469 6d65 5f77 696e 646f 7773  len(time_windows
+000130e0: 292e 204e 6f74 652c 2069 6620 736c 6964  ). Note, if slid
+000130f0: 696e 6720 7769 6e64 6f77 2069 7320 3130  ing window is 10
+00013100: 2066 7261 6d65 732c 2074 6865 2066 6972   frames, the fir
+00013110: 7374 2039 2065 6e74 7269 6573 2077 696c  st 9 entries wil
+00013120: 6c20 6265 2066 696c 6c65 6420 7769 7468  l be filled with
+00013130: 2030 2e20 5468 6520 3130 7468 2076 616c   0. The 10th val
+00013140: 7565 2072 6570 7265 7365 6e74 7320 7468  ue represents th
+00013150: 6520 636f 7272 656c 6174 696f 6e20 696e  e correlation in
+00013160: 2074 6865 2066 6972 7374 2031 3020 6672   the first 10 fr
+00013170: 616d 6573 2e0a 0a20 2020 2020 2020 203a  ames...        :
+00013180: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+00013190: 203e 3e3e 2073 616d 706c 655f 3120 3d20   >>> sample_1 = 
+000131a0: 6e70 2e61 7272 6179 285b 392c 3130 2c31  np.array([9,10,1
+000131b0: 332c 3232 2c31 352c 3138 2c31 352c 3139  3,22,15,18,15,19
+000131c0: 2c33 322c 3131 5d29 2e61 7374 7970 6528  ,32,11]).astype(
+000131d0: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+000131e0: 2020 2020 3e3e 3e20 7361 6d70 6c65 5f32      >>> sample_2
+000131f0: 203d 206e 702e 6172 7261 7928 5b31 312c   = np.array([11,
+00013200: 2031 322c 2031 352c 2031 392c 2032 312c   12, 15, 19, 21,
+00013210: 2032 362c 2031 392c 2032 302c 2032 322c   26, 19, 20, 22,
+00013220: 2031 395d 292e 6173 7479 7065 286e 702e   19]).astype(np.
+00013230: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00013240: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+00013250: 292e 736c 6964 696e 675f 7370 6561 726d  ).sliding_spearm
+00013260: 616e 5f72 616e 6b5f 636f 7272 656c 6174  an_rank_correlat
+00013270: 696f 6e28 7361 6d70 6c65 5f31 3d73 616d  ion(sample_1=sam
+00013280: 706c 655f 312c 2073 616d 706c 655f 323d  ple_1, sample_2=
+00013290: 7361 6d70 6c65 5f32 2c20 7469 6d65 5f77  sample_2, time_w
+000132a0: 696e 646f 7773 3d6e 702e 6172 7261 7928  indows=np.array(
+000132b0: 5b30 2e35 5d29 2c20 6670 733d 3130 290a  [0.5]), fps=10).
+000132c0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+000132d0: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
+000132e0: 702e 6675 6c6c 2828 7361 6d70 6c65 5f31  p.full((sample_1
+000132f0: 2e73 6861 7065 5b30 5d2c 2074 696d 655f  .shape[0], time_
+00013300: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+00013310: 292c 2030 2e30 290a 2020 2020 2020 2020  ), 0.0).        
+00013320: 666f 7220 6920 696e 2070 7261 6e67 6528  for i in prange(
+00013330: 7469 6d65 5f77 696e 646f 7773 2e73 6861  time_windows.sha
+00013340: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
+00013350: 2020 2020 7769 6e64 6f77 5f73 697a 6520      window_size 
+00013360: 3d20 696e 7428 7469 6d65 5f77 696e 646f  = int(time_windo
+00013370: 7773 5b69 5d20 2a20 6670 7329 0a20 2020  ws[i] * fps).   
+00013380: 2020 2020 2020 2020 2066 6f72 206c 6566           for lef
+00013390: 742c 2072 6967 6874 2069 6e20 7a69 7028  t, right in zip(
+000133a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000133b0: 2070 7261 6e67 6528 302c 2073 616d 706c   prange(0, sampl
+000133c0: 655f 312e 7368 6170 655b 305d 202b 2031  e_1.shape[0] + 1
+000133d0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000133e0: 2020 2070 7261 6e67 6528 7769 6e64 6f77     prange(window
+000133f0: 5f73 697a 652c 2073 616d 706c 655f 312e  _size, sample_1.
+00013400: 7368 6170 655b 305d 202b 2031 292c 0a20  shape[0] + 1),. 
+00013410: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+00013420: 2020 2020 2020 2020 2020 2020 2020 7331                s1
+00013430: 2c20 7332 203d 2073 616d 706c 655f 315b  , s2 = sample_1[
+00013440: 6c65 6674 3a72 6967 6874 5d2c 2073 616d  left:right], sam
+00013450: 706c 655f 325b 6c65 6674 3a72 6967 6874  ple_2[left:right
+00013460: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00013470: 2020 7261 6e6b 5f78 2c20 7261 6e6b 5f79    rank_x, rank_y
+00013480: 203d 206e 702e 6172 6773 6f72 7428 6e70   = np.argsort(np
+00013490: 2e61 7267 736f 7274 2873 3129 292c 206e  .argsort(s1)), n
+000134a0: 702e 6172 6773 6f72 7428 6e70 2e61 7267  p.argsort(np.arg
+000134b0: 736f 7274 2873 3229 290a 2020 2020 2020  sort(s2)).      
+000134c0: 2020 2020 2020 2020 2020 645f 7371 7561            d_squa
+000134d0: 7265 6420 3d20 6e70 2e73 756d 2828 7261  red = np.sum((ra
+000134e0: 6e6b 5f78 202d 2072 616e 6b5f 7929 202a  nk_x - rank_y) *
+000134f0: 2a20 3229 0a20 2020 2020 2020 2020 2020  * 2).           
+00013500: 2020 2020 2073 203d 2031 202d 2028 3620       s = 1 - (6 
+00013510: 2a20 645f 7371 7561 7265 6429 202f 2028  * d_squared) / (
+00013520: 6c65 6e28 7331 2920 2a20 286c 656e 2873  len(s1) * (len(s
+00013530: 3229 202a 2a20 3220 2d20 3129 290a 2020  2) ** 2 - 1)).  
+00013540: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00013550: 7375 6c74 735b 7269 6768 7420 2d20 312c  sults[right - 1,
+00013560: 2069 5d20 3d20 730a 0a20 2020 2020 2020   i] = s..       
+00013570: 2072 6574 7572 6e20 7265 7375 6c74 730a   return results.
+00013580: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00013590: 6f64 0a20 2020 2040 6e6a 6974 2822 2866  od.    @njit("(f
+000135a0: 6c6f 6174 3332 5b3a 5d2c 2066 6c6f 6174  loat32[:], float
+000135b0: 3634 2c20 666c 6f61 7436 342c 2066 6c6f  64, float64, flo
+000135c0: 6174 3634 2922 290a 2020 2020 6465 6620  at64)").    def 
+000135d0: 736c 6964 696e 675f 6175 746f 636f 7272  sliding_autocorr
+000135e0: 656c 6174 696f 6e28 0a20 2020 2020 2020  elation(.       
+000135f0: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
+00013600: 792c 206d 6178 5f6c 6167 3a20 666c 6f61  y, max_lag: floa
+00013610: 742c 2074 696d 655f 7769 6e64 6f77 3a20  t, time_window: 
+00013620: 666c 6f61 742c 2066 7073 3a20 666c 6f61  float, fps: floa
+00013630: 740a 2020 2020 293a 0a20 2020 2020 2020  t.    ):.       
+00013640: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+00013650: 7465 6420 636f 6d70 7574 6174 696f 6e20  ted computation 
+00013660: 6f66 2073 6c69 6469 6e67 2061 7574 6f63  of sliding autoc
+00013670: 6f72 7265 6c61 7469 6f6e 732c 2077 6869  orrelations, whi
+00013680: 6368 206d 6561 7375 7265 7320 7468 6520  ch measures the 
+00013690: 636f 7272 656c 6174 696f 6e20 6f66 2061  correlation of a
+000136a0: 2066 6561 7475 7265 2077 6974 6820 6974   feature with it
+000136b0: 7365 6c66 2075 7369 6e67 206c 6167 6765  self using lagge
+000136c0: 6420 7769 6e64 6f77 732e 0a0a 2020 2020  d windows...    
+000136d0: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+000136e0: 6172 7261 7920 6461 7461 3a20 3144 2061  array data: 1D a
+000136f0: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
+00013700: 6665 6174 7572 6520 7661 6c75 6573 2e0a  feature values..
+00013710: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+00013720: 6c6f 6174 206d 6178 5f6c 6167 3a20 4d61  loat max_lag: Ma
+00013730: 7869 6d75 6d20 6c61 6720 696e 2073 6563  ximum lag in sec
+00013740: 6f6e 6473 2066 6f72 2074 6865 2061 7574  onds for the aut
+00013750: 6f63 6f72 7265 6c61 7469 6f6e 2077 696e  ocorrelation win
+00013760: 646f 772e 0a20 2020 2020 2020 203a 7061  dow..        :pa
+00013770: 7261 6d20 666c 6f61 7420 7469 6d65 5f77  ram float time_w
+00013780: 696e 646f 773a 204c 656e 6774 6820 6f66  indow: Length of
+00013790: 2074 6865 2073 6c69 6469 6e67 2074 696d   the sliding tim
+000137a0: 6520 7769 6e64 6f77 2069 6e20 7365 636f  e window in seco
+000137b0: 6e64 732e 0a20 2020 2020 2020 203a 7061  nds..        :pa
+000137c0: 7261 6d20 666c 6f61 7420 6670 733a 2046  ram float fps: F
+000137d0: 7261 6d65 7320 7065 7220 7365 636f 6e64  rames per second
+000137e0: 2c20 7573 6564 2074 6f20 636f 6e76 6572  , used to conver
+000137f0: 7420 7469 6d65 2d72 656c 6174 6564 2070  t time-related p
+00013800: 6172 616d 6574 6572 7320 696e 746f 2066  arameters into f
+00013810: 7261 6d65 732e 0a20 2020 2020 2020 203a  rames..        :
+00013820: 7265 7475 726e 206e 702e 6e64 6172 7261  return np.ndarra
+00013830: 793a 2031 4420 6172 7261 7920 636f 6e74  y: 1D array cont
+00013840: 6169 6e69 6e67 2074 6865 2073 6c69 6469  aining the slidi
+00013850: 6e67 2061 7574 6f63 6f72 7265 6c61 7469  ng autocorrelati
+00013860: 6f6e 2076 616c 7565 732e 0a0a 2020 2020  on values...    
+00013870: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+00013880: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
+00013890: 206e 702e 6172 7261 7928 5b30 2c31 2c32   np.array([0,1,2
+000138a0: 2c33 2c34 2c20 352c 362c 372c 382c 312c  ,3,4, 5,6,7,8,1,
+000138b0: 3130 2c31 312c 3132 2c31 332c 3134 5d29  10,11,12,13,14])
+000138c0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+000138d0: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
+000138e0: 5374 6174 6973 7469 6373 2829 2e73 6c69  Statistics().sli
+000138f0: 6469 6e67 5f61 7574 6f63 6f72 7265 6c61  ding_autocorrela
+00013900: 7469 6f6e 2864 6174 613d 6461 7461 2c20  tion(data=data, 
+00013910: 6d61 785f 6c61 673d 302e 352c 2074 696d  max_lag=0.5, tim
+00013920: 655f 7769 6e64 6f77 3d31 2e30 2c20 6670  e_window=1.0, fp
+00013930: 733d 3130 290a 2020 2020 2020 2020 3e3e  s=10).        >>
+00013940: 3e20 5b20 302e 2c20 302e 2c20 302e 2c20  > [ 0., 0., 0., 
+00013950: 2030 2e2c 2020 302e 2c20 302e 2c20 302e   0.,  0., 0., 0.
+00013960: 2c20 2030 2e20 2c20 2030 2e2c 202d 332e  ,  0. ,  0., -3.
+00013970: 3638 362c 202d 322e 3032 392c 202d 312e  686, -2.029, -1.
+00013980: 3332 332c 202d 312e 3735 332c 202d 332e  323, -1.753, -3.
+00013990: 3830 372c 202d 342e 3633 345d 0a20 2020  807, -4.634].   
+000139a0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+000139b0: 2020 6d61 785f 6672 6d5f 6c61 672c 2074    max_frm_lag, t
+000139c0: 696d 655f 7769 6e64 6f77 5f66 726d 7320  ime_window_frms 
+000139d0: 3d20 696e 7428 6d61 785f 6c61 6720 2a20  = int(max_lag * 
+000139e0: 6670 7329 2c20 696e 7428 7469 6d65 5f77  fps), int(time_w
+000139f0: 696e 646f 7720 2a20 6670 7329 0a20 2020  indow * fps).   
+00013a00: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
+00013a10: 702e 6675 6c6c 2828 6461 7461 2e73 6861  p.full((data.sha
+00013a20: 7065 5b30 5d29 2c20 2d31 2e30 290a 2020  pe[0]), -1.0).  
+00013a30: 2020 2020 2020 666f 7220 7269 6768 7420        for right 
+00013a40: 696e 2070 7261 6e67 6528 7469 6d65 5f77  in prange(time_w
+00013a50: 696e 646f 775f 6672 6d73 202d 2031 2c20  indow_frms - 1, 
+00013a60: 6461 7461 2e73 6861 7065 5b30 5d29 3a0a  data.shape[0]):.
+00013a70: 2020 2020 2020 2020 2020 2020 6c65 6674              left
+00013a80: 203d 2072 6967 6874 202d 2074 696d 655f   = right - time_
+00013a90: 7769 6e64 6f77 5f66 726d 7320 2b20 310a  window_frms + 1.
+00013aa0: 2020 2020 2020 2020 2020 2020 775f 6461              w_da
+00013ab0: 7461 203d 2064 6174 615b 6c65 6674 203a  ta = data[left :
+00013ac0: 2072 6967 6874 202b 2031 5d0a 2020 2020   right + 1].    
+00013ad0: 2020 2020 2020 2020 636f 7272 6366 7320          corrcfs 
+00013ae0: 3d20 6e70 2e66 756c 6c28 286d 6178 5f66  = np.full((max_f
+00013af0: 726d 5f6c 6167 292c 206e 702e 6e61 6e29  rm_lag), np.nan)
+00013b00: 0a20 2020 2020 2020 2020 2020 2063 6f72  .            cor
+00013b10: 7263 6673 5b30 5d20 3d20 310a 2020 2020  rcfs[0] = 1.    
+00013b20: 2020 2020 2020 2020 666f 7220 7368 6966          for shif
+00013b30: 7420 696e 2072 616e 6765 2831 2c20 6d61  t in range(1, ma
+00013b40: 785f 6672 6d5f 6c61 6729 3a0a 2020 2020  x_frm_lag):.    
+00013b50: 2020 2020 2020 2020 2020 2020 6320 3d20              c = 
+00013b60: 6e70 2e63 6f72 7263 6f65 6628 775f 6461  np.corrcoef(w_da
+00013b70: 7461 5b3a 2d73 6869 6674 5d2c 2077 5f64  ta[:-shift], w_d
+00013b80: 6174 615b 7368 6966 743a 5d29 5b30 5d5b  ata[shift:])[0][
+00013b90: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00013ba0: 2020 2069 6620 6e70 2e69 736e 616e 2863     if np.isnan(c
+00013bb0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00013bc0: 2020 2020 2020 2063 6f72 7263 6673 5b73         corrcfs[s
+00013bd0: 6869 6674 5d20 3d20 310a 2020 2020 2020  hift] = 1.      
+00013be0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00013bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c00: 2020 2020 636f 7272 6366 735b 7368 6966      corrcfs[shif
+00013c10: 745d 203d 206e 702e 636f 7272 636f 6566  t] = np.corrcoef
+00013c20: 2877 5f64 6174 615b 3a2d 7368 6966 745d  (w_data[:-shift]
+00013c30: 2c20 775f 6461 7461 5b73 6869 6674 3a5d  , w_data[shift:]
+00013c40: 295b 305d 5b31 5d0a 2020 2020 2020 2020  )[0][1].        
+00013c50: 2020 2020 6d61 745f 203d 206e 702e 7a65      mat_ = np.ze
+00013c60: 726f 7328 7368 6170 653d 2863 6f72 7263  ros(shape=(corrc
+00013c70: 6673 2e73 6861 7065 5b30 5d2c 2032 2929  fs.shape[0], 2))
+00013c80: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00013c90: 7374 203d 206e 702e 6f6e 6573 5f6c 696b  st = np.ones_lik
+00013ca0: 6528 636f 7272 6366 7329 0a20 2020 2020  e(corrcfs).     
+00013cb0: 2020 2020 2020 206d 6174 5f5b 3a2c 2030         mat_[:, 0
+00013cc0: 5d20 3d20 636f 6e73 740a 2020 2020 2020  ] = const.      
+00013cd0: 2020 2020 2020 6d61 745f 5b3a 2c20 315d        mat_[:, 1]
+00013ce0: 203d 2063 6f72 7263 6673 0a20 2020 2020   = corrcfs.     
+00013cf0: 2020 2020 2020 2064 6574 5f20 3d20 6e70         det_ = np
+00013d00: 2e6c 696e 616c 672e 6c73 7473 7128 0a20  .linalg.lstsq(. 
+00013d10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00013d20: 6174 5f2e 6173 7479 7065 286e 702e 666c  at_.astype(np.fl
+00013d30: 6f61 7433 3229 2c20 6e70 2e61 7261 6e67  oat32), np.arang
+00013d40: 6528 302c 206d 6178 5f66 726d 5f6c 6167  e(0, max_frm_lag
+00013d50: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
+00013d60: 7433 3229 0a20 2020 2020 2020 2020 2020  t32).           
+00013d70: 2029 5b30 5d0a 2020 2020 2020 2020 2020   )[0].          
+00013d80: 2020 7265 7375 6c74 735b 7269 6768 745d    results[right]
+00013d90: 203d 2064 6574 5f5b 3a3a 2d31 5d5b 305d   = det_[::-1][0]
+00013da0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013db0: 7265 7375 6c74 730a 0a20 2020 2040 7374  results..    @st
+00013dc0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+00013dd0: 6566 2073 6c69 6469 6e67 5f64 6f6d 696e  ef sliding_domin
+00013de0: 616e 745f 6672 6571 7565 6e63 6965 7328  ant_frequencies(
+00013df0: 0a20 2020 2020 2020 2064 6174 613a 206e  .        data: n
+00013e00: 702e 6e64 6172 7261 792c 0a20 2020 2020  p.ndarray,.     
+00013e10: 2020 2066 7073 3a20 666c 6f61 742c 0a20     fps: float,. 
+00013e20: 2020 2020 2020 206b 3a20 696e 742c 0a20         k: int,. 
+00013e30: 2020 2020 2020 2074 696d 655f 7769 6e64         time_wind
+00013e40: 6f77 733a 206e 702e 6e64 6172 7261 792c  ows: np.ndarray,
+00013e50: 0a20 2020 2020 2020 2077 696e 646f 775f  .        window_
+00013e60: 6675 6e63 7469 6f6e 3a20 4c69 7465 7261  function: Litera
+00013e70: 6c5b 2248 616e 6e22 2c20 2248 616d 6d69  l["Hann", "Hammi
+00013e80: 6e67 222c 2022 426c 6163 6b6d 616e 225d  ng", "Blackman"]
+00013e90: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
+00013ea0: 2020 2020 2020 2020 2222 2246 696e 6420          """Find 
+00013eb0: 7468 6520 4b20 646f 6d69 6e61 6e74 2066  the K dominant f
+00013ec0: 7265 7175 656e 6369 6573 2077 6974 6869  requencies withi
+00013ed0: 6e20 6120 6665 6174 7572 6520 7665 6374  n a feature vect
+00013ee0: 6f72 2075 7369 6e67 2073 6c69 6469 6e67  or using sliding
+00013ef0: 2077 696e 646f 7773 2222 220a 0a20 2020   windows"""..   
+00013f00: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
+00013f10: 702e 6675 6c6c 2828 6461 7461 2e73 6861  p.full((data.sha
+00013f20: 7065 5b30 5d2c 2074 696d 655f 7769 6e64  pe[0], time_wind
+00013f30: 6f77 732e 7368 6170 655b 305d 292c 2030  ows.shape[0]), 0
+00013f40: 2e30 290a 2020 2020 2020 2020 666f 7220  .0).        for 
+00013f50: 7469 6d65 5f77 696e 646f 775f 636e 7420  time_window_cnt 
+00013f60: 696e 2072 616e 6765 2874 696d 655f 7769  in range(time_wi
+00013f70: 6e64 6f77 732e 7368 6170 655b 305d 293a  ndows.shape[0]):
+00013f80: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
+00013f90: 646f 775f 7369 7a65 203d 2069 6e74 2874  dow_size = int(t
+00013fa0: 696d 655f 7769 6e64 6f77 735b 7469 6d65  ime_windows[time
+00013fb0: 5f77 696e 646f 775f 636e 745d 202a 2066  _window_cnt] * f
+00013fc0: 7073 290a 2020 2020 2020 2020 2020 2020  ps).            
+00013fd0: 666f 7220 6c65 6674 2c20 7269 6768 7420  for left, right 
+00013fe0: 696e 207a 6970 280a 2020 2020 2020 2020  in zip(.        
+00013ff0: 2020 2020 2020 2020 7261 6e67 6528 302c          range(0,
+00014000: 2064 6174 612e 7368 6170 655b 305d 202b   data.shape[0] +
+00014010: 2031 292c 2072 616e 6765 2877 696e 646f   1), range(windo
+00014020: 775f 7369 7a65 2c20 6461 7461 2e73 6861  w_size, data.sha
+00014030: 7065 5b30 5d20 2b20 3129 0a20 2020 2020  pe[0] + 1).     
+00014040: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00014050: 2020 2020 2020 2020 2020 7769 6e64 6f77            window
+00014060: 5f64 6174 6120 3d20 6461 7461 5b6c 6566  _data = data[lef
+00014070: 743a 7269 6768 745d 0a20 2020 2020 2020  t:right].       
+00014080: 2020 2020 2020 2020 2069 6620 7769 6e64           if wind
+00014090: 6f77 5f66 756e 6374 696f 6e20 3d3d 2022  ow_function == "
+000140a0: 4861 6e6e 223a 0a20 2020 2020 2020 2020  Hann":.         
+000140b0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+000140c0: 775f 6461 7461 203d 2077 696e 646f 775f  w_data = window_
+000140d0: 6461 7461 202a 206e 702e 6861 6e6e 696e  data * np.hannin
+000140e0: 6728 6c65 6e28 7769 6e64 6f77 5f64 6174  g(len(window_dat
+000140f0: 6129 290a 2020 2020 2020 2020 2020 2020  a)).            
+00014100: 2020 2020 656c 6966 2077 696e 646f 775f      elif window_
+00014110: 6675 6e63 7469 6f6e 203d 3d20 2248 616d  function == "Ham
+00014120: 6d69 6e67 223a 0a20 2020 2020 2020 2020  ming":.         
+00014130: 2020 2020 2020 2020 2020 2077 696e 646f             windo
+00014140: 775f 6461 7461 203d 2077 696e 646f 775f  w_data = window_
+00014150: 6461 7461 202a 206e 702e 6861 6d6d 696e  data * np.hammin
+00014160: 6728 6c65 6e28 7769 6e64 6f77 5f64 6174  g(len(window_dat
+00014170: 6129 290a 2020 2020 2020 2020 2020 2020  a)).            
+00014180: 2020 2020 656c 6966 2077 696e 646f 775f      elif window_
+00014190: 6675 6e63 7469 6f6e 203d 3d20 2242 6c61  function == "Bla
+000141a0: 636b 6d61 6e22 3a0a 2020 2020 2020 2020  ckman":.        
+000141b0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+000141c0: 6f77 5f64 6174 6120 3d20 7769 6e64 6f77  ow_data = window
+000141d0: 5f64 6174 6120 2a20 6e70 2e62 6c61 636b  _data * np.black
+000141e0: 6d61 6e28 6c65 6e28 7769 6e64 6f77 5f64  man(len(window_d
+000141f0: 6174 6129 290a 2020 2020 2020 2020 2020  ata)).          
+00014200: 2020 2020 2020 6666 745f 7265 7375 6c74        fft_result
+00014210: 203d 206e 702e 6666 742e 6666 7428 7769   = np.fft.fft(wi
+00014220: 6e64 6f77 5f64 6174 6129 0a20 2020 2020  ndow_data).     
+00014230: 2020 2020 2020 2020 2020 2066 7265 7175             frequ
+00014240: 656e 6369 6573 203d 206e 702e 6666 742e  encies = np.fft.
+00014250: 6666 7466 7265 7128 7769 6e64 6f77 5f64  fftfreq(window_d
+00014260: 6174 612e 7368 6170 655b 305d 2c20 3120  ata.shape[0], 1 
+00014270: 2f20 6670 7329 0a20 2020 2020 2020 2020  / fps).         
+00014280: 2020 2020 2020 206d 6167 6e69 7475 6465         magnitude
+00014290: 203d 206e 702e 6162 7328 6666 745f 7265   = np.abs(fft_re
+000142a0: 7375 6c74 290a 2020 2020 2020 2020 2020  sult).          
+000142b0: 2020 2020 2020 746f 705f 6b5f 6672 6571        top_k_freq
+000142c0: 7565 6e63 7920 3d20 6672 6571 7565 6e63  uency = frequenc
+000142d0: 6965 735b 6e70 2e61 7267 736f 7274 286d  ies[np.argsort(m
+000142e0: 6167 6e69 7475 6465 295b 2d28 6b20 2b20  agnitude)[-(k + 
+000142f0: 3129 203a 202d 315d 5d0a 2020 2020 2020  1) : -1]].      
+00014300: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00014310: 735b 7269 6768 7420 2d20 315d 5b74 696d  s[right - 1][tim
+00014320: 655f 7769 6e64 6f77 5f63 6e74 5d20 3d20  e_window_cnt] = 
+00014330: 746f 705f 6b5f 6672 6571 7565 6e63 795b  top_k_frequency[
+00014340: 305d 0a20 2020 2020 2020 2072 6574 7572  0].        retur
+00014350: 6e20 7265 7375 6c74 730a 0a20 2020 2040  n results..    @
+00014360: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00014370: 2040 6e6a 6974 2822 2866 6c6f 6174 3332   @njit("(float32
+00014380: 5b3a 5d2c 2066 6c6f 6174 3332 5b3a 5d29  [:], float32[:])
+00014390: 2229 0a20 2020 2064 6566 206b 656e 6461  ").    def kenda
+000143a0: 6c6c 5f74 6175 2873 616d 706c 655f 313a  ll_tau(sample_1:
+000143b0: 206e 702e 6e64 6172 7261 792c 2073 616d   np.ndarray, sam
+000143c0: 706c 655f 323a 206e 702e 6e64 6172 7261  ple_2: np.ndarra
+000143d0: 7929 202d 3e20 5475 706c 655b 666c 6f61  y) -> Tuple[floa
+000143e0: 742c 2066 6c6f 6174 5d3a 0a20 2020 2020  t, float]:.     
+000143f0: 2020 2022 2222 0a20 2020 2020 2020 204a     """.        J
+00014400: 6974 7465 6420 636f 6d70 7574 6520 6f66  itted compute of
+00014410: 204b 656e 6461 6c6c 2054 6175 2028 7261   Kendall Tau (ra
+00014420: 6e6b 2063 6f72 7265 6c61 7469 6f6e 2063  nk correlation c
+00014430: 6f65 6666 6963 6965 6e74 292e 204e 6f6e  oefficient). Non
+00014440: 2d70 6172 616d 6574 7269 6320 6d65 7468  -parametric meth
+00014450: 6f64 2066 6f72 2063 6f6d 7075 7469 6e67  od for computing
+00014460: 2063 6f72 7265 6c61 7469 6f6e 0a20 2020   correlation.   
+00014470: 2020 2020 2062 6574 7765 656e 2074 776f       between two
+00014480: 2074 696d 652d 7365 7269 6573 2066 6561   time-series fea
+00014490: 7475 7265 732e 2052 6574 7572 6e73 2074  tures. Returns t
+000144a0: 6175 2061 6e64 2061 7373 6f63 6961 7465  au and associate
+000144b0: 6420 7a2d 7363 6f72 652e 0a0a 2020 2020  d z-score...    
+000144c0: 2020 2020 4b65 6e64 616c 6c20 5461 7520      Kendall Tau 
+000144d0: 6973 2061 206d 6561 7375 7265 206f 6620  is a measure of 
+000144e0: 7468 6520 636f 7272 6573 706f 6e64 656e  the corresponden
+000144f0: 6365 2062 6574 7765 656e 2074 776f 2072  ce between two r
+00014500: 616e 6b69 6e67 732e 2049 7420 636f 6d70  ankings. It comp
+00014510: 6172 6573 2074 6865 206e 756d 6265 7220  ares the number 
+00014520: 6f66 2063 6f6e 636f 7264 616e 740a 2020  of concordant.  
+00014530: 2020 2020 2020 7061 6972 7320 2870 6169        pairs (pai
+00014540: 7273 206f 6620 656c 656d 656e 7473 2074  rs of elements t
+00014550: 6861 7420 6172 6520 696e 2074 6865 2073  hat are in the s
+00014560: 616d 6520 6f72 6465 7220 696e 2062 6f74  ame order in bot
+00014570: 6820 7261 6e6b 696e 6773 2920 746f 2074  h rankings) to t
+00014580: 6865 206e 756d 6265 7220 6f66 2064 6973  he number of dis
+00014590: 636f 7264 616e 7420 7061 6972 730a 2020  cordant pairs.  
+000145a0: 2020 2020 2020 2870 6169 7273 206f 6620        (pairs of 
+000145b0: 656c 656d 656e 7473 2074 6861 7420 6172  elements that ar
+000145c0: 6520 696e 2064 6966 6665 7265 6e74 206f  e in different o
+000145d0: 7264 6572 7320 696e 2074 6865 2072 616e  rders in the ran
+000145e0: 6b69 6e67 7329 2e0a 0a20 2020 2020 2020  kings)...       
+000145f0: 204b 656e 6461 6c6c 2054 6175 2069 7320   Kendall Tau is 
+00014600: 6361 6c63 756c 6174 6564 2075 7369 6e67  calculated using
+00014610: 2074 6865 2066 6f6c 6c6f 7769 6e67 2066   the following f
+00014620: 6f72 6d75 6c61 3a0a 0a20 2020 2020 2020  ormula:..       
+00014630: 202e 2e20 6d61 7468 3a3a 0a0a 2020 2020   .. math::..    
+00014640: 2020 2020 2020 205c 5c74 6175 203d 205c         \\tau = \
+00014650: 5c66 7261 637b 7b5c 5c73 756d 2043 202d  \frac{{\\sum C -
+00014660: 205c 5c73 756d 2044 7d7d 7b7b 5c5c 7375   \\sum D}}{{\\su
+00014670: 6d20 4320 2b20 5c5c 7375 6d20 447d 7d0a  m C + \\sum D}}.
+00014680: 0a20 2020 2020 2020 2077 6865 7265 203a  .        where :
+00014690: 6d61 7468 3a60 4360 2069 7320 7468 6520  math:`C` is the 
+000146a0: 636f 756e 7420 6f66 2063 6f6e 636f 7264  count of concord
+000146b0: 616e 7420 7061 6972 7320 616e 6420 3a6d  ant pairs and :m
+000146c0: 6174 683a 6044 6020 6973 2074 6865 2063  ath:`D` is the c
+000146d0: 6f75 6e74 206f 6620 6469 7363 6f72 6461  ount of discorda
+000146e0: 6e74 2070 6169 7273 2e0a 0a0a 2020 2020  nt pairs....    
+000146f0: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+00014700: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
+00014710: 2046 6972 7374 2031 4420 6172 7261 7920   First 1D array 
+00014720: 7769 7468 2066 6561 7475 7265 2076 616c  with feature val
+00014730: 7565 732e 0a20 2020 2020 2020 203a 7061  ues..        :pa
+00014740: 7261 6d65 7465 7220 6e64 6172 7261 7920  rameter ndarray 
+00014750: 7361 6d70 6c65 5f31 3a20 5365 636f 6e64  sample_1: Second
+00014760: 2031 4420 6172 7261 7920 7769 7468 2066   1D array with f
+00014770: 6561 7475 7265 2076 616c 7565 732e 0a20  eature values.. 
+00014780: 2020 2020 2020 203a 7265 7475 726e 7320         :returns 
+00014790: 5475 706c 655b 666c 6f61 742c 2066 6c6f  Tuple[float, flo
+000147a0: 6174 5d3a 204b 656e 6461 6c6c 2054 6175  at]: Kendall Tau
+000147b0: 2061 6e64 2061 7373 6f63 6961 7465 6420   and associated 
+000147c0: 7a2d 7363 6f72 652e 0a0a 2020 2020 2020  z-score...      
+000147d0: 2020 3a65 7861 6d70 6c65 733a 0a20 2020    :examples:.   
+000147e0: 2020 2020 203e 3e3e 2073 616d 706c 655f       >>> sample_
+000147f0: 3120 3d20 6e70 2e61 7272 6179 285b 342c  1 = np.array([4,
+00014800: 2032 2c20 332c 2034 2c20 352c 2037 5d29   2, 3, 4, 5, 7])
+00014810: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00014820: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
+00014830: 7361 6d70 6c65 5f32 203d 206e 702e 6172  sample_2 = np.ar
+00014840: 7261 7928 5b31 2c20 322c 2033 2c20 342c  ray([1, 2, 3, 4,
+00014850: 2035 2c20 375d 292e 6173 7479 7065 286e   5, 7]).astype(n
+00014860: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+00014870: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+00014880: 7328 292e 6b65 6e64 616c 6c5f 7461 7528  s().kendall_tau(
+00014890: 7361 6d70 6c65 5f31 3d73 616d 706c 655f  sample_1=sample_
+000148a0: 312c 2073 616d 706c 655f 323d 7361 6d70  1, sample_2=samp
+000148b0: 6c65 5f32 290a 2020 2020 2020 2020 3e3e  le_2).        >>
+000148c0: 3e20 2830 2e37 3333 3333 3333 3333 3333  > (0.73333333333
+000148d0: 3333 3333 332c 2032 2e30 3636 3534 3031  33333, 2.0665401
+000148e0: 3630 3538 3039 3932 3829 0a0a 2020 2020  605809928)..    
+000148f0: 2020 2020 5265 6665 7265 6e63 6573 0a20      References. 
+00014900: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00014910: 2d0a 2020 2020 2020 2020 2e2e 205b 315d  -.        .. [1]
+00014920: 2060 5374 6570 6861 6e69 6520 476c 656e   `Stephanie Glen
+00014930: 2c20 224b 656e 6461 6c6c e280 9973 2054  , "Kendall...s T
+00014940: 6175 2028 4b65 6e64 616c 6c20 5261 6e6b  au (Kendall Rank
+00014950: 2043 6f72 7265 6c61 7469 6f6e 2043 6f65   Correlation Coe
+00014960: 6666 6963 6965 6e74 2922 2020 3c68 7474  fficient)"  <htt
+00014970: 7073 3a2f 2f77 7777 2e73 7461 7469 7374  ps://www.statist
+00014980: 6963 7368 6f77 746f 2e63 6f6d 2f6b 656e  icshowto.com/ken
+00014990: 6461 6c6c 732d 7461 752f 3e60 5f5f 2e0a  dalls-tau/>`__..
+000149a0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+000149b0: 2020 2020 2072 6e6b 7320 3d20 6e70 2e61       rnks = np.a
+000149c0: 7267 736f 7274 2873 616d 706c 655f 3129  rgsort(sample_1)
+000149d0: 0a20 2020 2020 2020 2073 315f 726e 6b2c  .        s1_rnk,
+000149e0: 2073 325f 726e 6b20 3d20 7361 6d70 6c65   s2_rnk = sample
+000149f0: 5f31 5b72 6e6b 735d 2c20 7361 6d70 6c65  _1[rnks], sample
+00014a00: 5f32 5b72 6e6b 735d 0a20 2020 2020 2020  _2[rnks].       
+00014a10: 2063 6e63 7264 6e74 5f63 6e74 732c 2064   cncrdnt_cnts, d
+00014a20: 7363 7264 6e74 5f63 6e74 7320 3d20 6e70  scrdnt_cnts = np
+00014a30: 2e66 756c 6c28 2873 315f 726e 6b2e 7368  .full((s1_rnk.sh
+00014a40: 6170 655b 305d 202d 2031 292c 206e 702e  ape[0] - 1), np.
+00014a50: 6e61 6e29 2c20 6e70 2e66 756c 6c28 0a20  nan), np.full(. 
+00014a60: 2020 2020 2020 2020 2020 2028 7331 5f72             (s1_r
+00014a70: 6e6b 2e73 6861 7065 5b30 5d20 2d20 3129  nk.shape[0] - 1)
+00014a80: 2c20 6e70 2e6e 616e 0a20 2020 2020 2020  , np.nan.       
+00014a90: 2029 0a20 2020 2020 2020 2066 6f72 2069   ).        for i
+00014aa0: 2069 6e20 7261 6e67 6528 7332 5f72 6e6b   in range(s2_rnk
+00014ab0: 2e73 6861 7065 5b30 5d20 2d20 3129 3a0a  .shape[0] - 1):.
+00014ac0: 2020 2020 2020 2020 2020 2020 636e 6372              cncr
+00014ad0: 646e 745f 636e 7473 5b69 5d20 3d20 280a  dnt_cnts[i] = (.
+00014ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014af0: 6e70 2e61 7267 7768 6572 6528 7332 5f72  np.argwhere(s2_r
+00014b00: 6e6b 5b69 202b 2031 203a 5d20 3e20 7332  nk[i + 1 :] > s2
+00014b10: 5f72 6e6b 5b69 5d29 2e66 6c61 7474 656e  _rnk[i]).flatten
+00014b20: 2829 2e73 6861 7065 5b30 5d0a 2020 2020  ().shape[0].    
+00014b30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00014b40: 2020 2020 2020 6473 6372 646e 745f 636e        dscrdnt_cn
+00014b50: 7473 5b69 5d20 3d20 280a 2020 2020 2020  ts[i] = (.      
+00014b60: 2020 2020 2020 2020 2020 6e70 2e61 7267            np.arg
+00014b70: 7768 6572 6528 7332 5f72 6e6b 5b69 202b  where(s2_rnk[i +
+00014b80: 2031 203a 5d20 3c20 7332 5f72 6e6b 5b69   1 :] < s2_rnk[i
+00014b90: 5d29 2e66 6c61 7474 656e 2829 2e73 6861  ]).flatten().sha
+00014ba0: 7065 5b30 5d0a 2020 2020 2020 2020 2020  pe[0].          
+00014bb0: 2020 290a 2020 2020 2020 2020 7420 3d20    ).        t = 
+00014bc0: 286e 702e 7375 6d28 636e 6372 646e 745f  (np.sum(cncrdnt_
+00014bd0: 636e 7473 2920 2d20 6e70 2e73 756d 2864  cnts) - np.sum(d
+00014be0: 7363 7264 6e74 5f63 6e74 7329 2920 2f20  scrdnt_cnts)) / 
+00014bf0: 280a 2020 2020 2020 2020 2020 2020 6e70  (.            np
+00014c00: 2e73 756d 2863 6e63 7264 6e74 5f63 6e74  .sum(cncrdnt_cnt
+00014c10: 7329 202b 206e 702e 7375 6d28 6473 6372  s) + np.sum(dscr
+00014c20: 646e 745f 636e 7473 290a 2020 2020 2020  dnt_cnts).      
+00014c30: 2020 290a 2020 2020 2020 2020 7a20 3d20    ).        z = 
+00014c40: 280a 2020 2020 2020 2020 2020 2020 330a  (.            3.
+00014c50: 2020 2020 2020 2020 2020 2020 2a20 740a              * t.
+00014c60: 2020 2020 2020 2020 2020 2020 2a20 286e              * (n
+00014c70: 702e 7371 7274 2873 315f 726e 6b2e 7368  p.sqrt(s1_rnk.sh
+00014c80: 6170 655b 305d 202a 2028 7331 5f72 6e6b  ape[0] * (s1_rnk
+00014c90: 2e73 6861 7065 5b30 5d20 2d20 3129 2929  .shape[0] - 1)))
+00014ca0: 0a20 2020 2020 2020 2020 2020 202f 206e  .            / n
+00014cb0: 702e 7371 7274 2832 202a 2028 2832 202a  p.sqrt(2 * ((2 *
+00014cc0: 2073 315f 726e 6b2e 7368 6170 655b 305d   s1_rnk.shape[0]
+00014cd0: 2920 2b20 3529 290a 2020 2020 2020 2020  ) + 5)).        
+00014ce0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00014cf0: 6e20 742c 207a 0a0a 2020 2020 4073 7461  n t, z..    @sta
+00014d00: 7469 636d 6574 686f 640a 2020 2020 406e  ticmethod.    @n
+00014d10: 6a69 7428 2228 666c 6f61 7433 325b 3a5d  jit("(float32[:]
+00014d20: 2c20 666c 6f61 7433 325b 3a5d 2c20 666c  , float32[:], fl
+00014d30: 6f61 7436 345b 3a5d 2c20 696e 7436 3429  oat64[:], int64)
+00014d40: 2229 0a20 2020 2064 6566 2073 6c69 6469  ").    def slidi
+00014d50: 6e67 5f6b 656e 6461 6c6c 5f74 6175 280a  ng_kendall_tau(.
+00014d60: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
+00014d70: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
+00014d80: 6d70 6c65 5f32 3a20 6e70 2e6e 6461 7272  mple_2: np.ndarr
+00014d90: 6179 2c20 7469 6d65 5f77 696e 646f 7773  ay, time_windows
+00014da0: 3a20 6e70 2e6e 6461 7272 6179 2c20 6670  : np.ndarray, fp
+00014db0: 733a 2066 6c6f 6174 0a20 2020 2029 202d  s: float.    ) -
+00014dc0: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+00014dd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00014de0: 2020 436f 6d70 7574 6520 736c 6964 696e    Compute slidin
+00014df0: 6720 4b65 6e64 616c 6c27 7320 5461 7520  g Kendall's Tau 
+00014e00: 636f 7272 656c 6174 696f 6e20 636f 6566  correlation coef
+00014e10: 6669 6369 656e 742e 0a0a 2020 2020 2020  ficient...      
+00014e20: 2020 4361 6c63 756c 6174 6573 204b 656e    Calculates Ken
+00014e30: 6461 6c6c 2773 2054 6175 2063 6f72 7265  dall's Tau corre
+00014e40: 6c61 7469 6f6e 2063 6f65 6666 6963 6965  lation coefficie
+00014e50: 6e74 2062 6574 7765 656e 2074 776f 2073  nt between two s
+00014e60: 616d 706c 6573 206f 7665 7220 736c 6964  amples over slid
+00014e70: 696e 6720 7469 6d65 2077 696e 646f 7773  ing time windows
+00014e80: 2e20 4b65 6e64 616c 6c27 7320 5461 7520  . Kendall's Tau 
+00014e90: 6973 2061 206d 6561 7375 7265 206f 6620  is a measure of 
+00014ea0: 636f 7272 656c 6174 696f 6e20 6265 7477  correlation betw
+00014eb0: 6565 6e20 7477 6f20 7261 6e6b 6564 2064  een two ranked d
+00014ec0: 6174 6173 6574 732e 0a0a 2020 2020 2020  atasets...      
+00014ed0: 2020 5468 6520 636f 6d70 7574 6174 696f    The computatio
+00014ee0: 6e20 6973 2062 6173 6564 206f 6e20 7468  n is based on th
+00014ef0: 6520 666f 726d 756c 613a 0a0a 2020 2020  e formula:..    
+00014f00: 2020 2020 2e2e 206d 6174 683a 3a0a 0a20      .. math::.. 
+00014f10: 2020 2020 2020 2020 2020 5c5c 7461 7520            \\tau 
+00014f20: 3d20 5c5c 6672 6163 7b7b 5c5c 7465 7874  = \\frac{{\\text
+00014f30: 7b7b 636f 6e63 6f72 6461 6e74 2070 6169  {{concordant pai
+00014f40: 7273 7d7d 202d 205c 5c74 6578 747b 7b64  rs}} - \\text{{d
+00014f50: 6973 636f 7264 616e 7420 7061 6972 737d  iscordant pairs}
+00014f60: 7d7d 7d7b 7b5c 5c74 6578 747b 7b63 6f6e  }}}{{\\text{{con
+00014f70: 636f 7264 616e 7420 7061 6972 737d 7d20  cordant pairs}} 
+00014f80: 2b20 5c5c 7465 7874 7b7b 6469 7363 6f72  + \\text{{discor
+00014f90: 6461 6e74 2070 6169 7273 7d7d 7d7d 0a0a  dant pairs}}}}..
+00014fa0: 2020 2020 2020 2020 7768 6572 6520 636f          where co
+00014fb0: 6e63 6f72 6461 6e74 2070 6169 7273 2061  ncordant pairs a
+00014fc0: 7265 2070 6169 7273 206f 6620 656c 656d  re pairs of elem
+00014fd0: 656e 7473 2077 6974 6820 7468 6520 7361  ents with the sa
+00014fe0: 6d65 206f 7264 6572 2069 6e20 626f 7468  me order in both
+00014ff0: 2073 616d 706c 6573 2c20 616e 6420 6469   samples, and di
+00015000: 7363 6f72 6461 6e74 2070 6169 7273 2061  scordant pairs a
+00015010: 7265 2070 6169 7273 2077 6974 6820 6469  re pairs with di
+00015020: 6666 6572 656e 7420 6f72 6465 7273 2e0a  fferent orders..
+00015030: 0a20 2020 2020 2020 2052 6566 6572 656e  .        Referen
+00015040: 6365 730a 2020 2020 2020 2020 2d2d 2d2d  ces.        ----
+00015050: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 202e  ------.        .
+00015060: 2e20 5b31 5d20 6053 7465 7068 616e 6965  . [1] `Stephanie
+00015070: 2047 6c65 6e2c 2022 4b65 6e64 616c 6ce2   Glen, "Kendall.
+00015080: 8099 7320 5461 7520 284b 656e 6461 6c6c  ..s Tau (Kendall
+00015090: 2052 616e 6b20 436f 7272 656c 6174 696f   Rank Correlatio
+000150a0: 6e20 436f 6566 6669 6369 656e 7429 2220  n Coefficient)" 
+000150b0: 203c 6874 7470 733a 2f2f 7777 772e 7374   <https://www.st
+000150c0: 6174 6973 7469 6373 686f 7774 6f2e 636f  atisticshowto.co
+000150d0: 6d2f 6b65 6e64 616c 6c73 2d74 6175 2f3e  m/kendalls-tau/>
+000150e0: 605f 5f2e 0a0a 0a20 2020 2020 2020 203a  `__....        :
+000150f0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+00015100: 2073 616d 706c 655f 313a 2046 6972 7374   sample_1: First
+00015110: 2073 616d 706c 6520 666f 7220 636f 6d70   sample for comp
+00015120: 6172 6973 6f6e 2e0a 2020 2020 2020 2020  arison..        
+00015130: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+00015140: 7920 7361 6d70 6c65 5f32 3a20 5365 636f  y sample_2: Seco
+00015150: 6e64 2073 616d 706c 6520 666f 7220 636f  nd sample for co
+00015160: 6d70 6172 6973 6f6e 2e0a 2020 2020 2020  mparison..      
+00015170: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+00015180: 7261 7920 7469 6d65 5f77 696e 646f 7773  ray time_windows
+00015190: 3a20 526f 6c6c 696e 6720 7469 6d65 2077  : Rolling time w
+000151a0: 696e 646f 7773 2069 6e20 7365 636f 6e64  indows in second
+000151b0: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+000151c0: 6d20 666c 6f61 7420 6670 733a 2046 7261  m float fps: Fra
+000151d0: 6d65 7320 7065 7220 7365 636f 6e64 2028  mes per second (
+000151e0: 4650 5329 206f 6620 7468 6520 7265 636f  FPS) of the reco
+000151f0: 7264 6564 2076 6964 656f 2e0a 2020 2020  rded video..    
+00015200: 2020 2020 3a72 6574 7572 6e3a 2041 7272      :return: Arr
+00015210: 6179 206f 6620 4b65 6e64 616c 6c27 7320  ay of Kendall's 
+00015220: 5461 7520 636f 7272 656c 6174 696f 6e20  Tau correlation 
+00015230: 636f 6566 6669 6369 656e 7473 2063 6f72  coefficients cor
+00015240: 7265 7370 6f6e 6469 6e67 2074 6f20 6561  responding to ea
+00015250: 6368 2074 696d 6520 7769 6e64 6f77 2e0a  ch time window..
+00015260: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00015270: 2020 2020 2072 6573 756c 7473 203d 206e       results = n
+00015280: 702e 6675 6c6c 2828 7361 6d70 6c65 5f31  p.full((sample_1
+00015290: 2e73 6861 7065 5b30 5d2c 2074 696d 655f  .shape[0], time_
+000152a0: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+000152b0: 292c 2030 2e30 290a 2020 2020 2020 2020  ), 0.0).        
+000152c0: 666f 7220 7469 6d65 5f77 696e 646f 775f  for time_window_
+000152d0: 636e 7420 696e 2072 616e 6765 2874 696d  cnt in range(tim
+000152e0: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
+000152f0: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
+00015300: 2077 696e 646f 775f 7369 7a65 203d 2069   window_size = i
+00015310: 6e74 2874 696d 655f 7769 6e64 6f77 735b  nt(time_windows[
+00015320: 7469 6d65 5f77 696e 646f 775f 636e 745d  time_window_cnt]
+00015330: 202a 2066 7073 290a 2020 2020 2020 2020   * fps).        
+00015340: 2020 2020 666f 7220 6c65 6674 2c20 7269      for left, ri
+00015350: 6768 7420 696e 207a 6970 280a 2020 2020  ght in zip(.    
+00015360: 2020 2020 2020 2020 2020 2020 7261 6e67              rang
+00015370: 6528 302c 2073 616d 706c 655f 312e 7368  e(0, sample_1.sh
+00015380: 6170 655b 305d 202b 2031 292c 0a20 2020  ape[0] + 1),.   
+00015390: 2020 2020 2020 2020 2020 2020 2072 616e               ran
+000153a0: 6765 2877 696e 646f 775f 7369 7a65 2c20  ge(window_size, 
+000153b0: 7361 6d70 6c65 5f31 2e73 6861 7065 5b30  sample_1.shape[0
+000153c0: 5d20 2b20 3129 2c0a 2020 2020 2020 2020  ] + 1),.        
+000153d0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+000153e0: 2020 2020 2020 2073 6c69 6365 645f 7361         sliced_sa
+000153f0: 6d70 6c65 5f31 2c20 736c 6963 6564 5f73  mple_1, sliced_s
+00015400: 616d 706c 655f 3220 3d20 280a 2020 2020  ample_2 = (.    
+00015410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015420: 7361 6d70 6c65 5f31 5b6c 6566 743a 7269  sample_1[left:ri
+00015430: 6768 745d 2c0a 2020 2020 2020 2020 2020  ght],.          
+00015440: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00015450: 5f32 5b6c 6566 743a 7269 6768 745d 2c0a  _2[left:right],.
+00015460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015470: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00015480: 2020 726e 6b73 203d 206e 702e 6172 6773    rnks = np.args
+00015490: 6f72 7428 736c 6963 6564 5f73 616d 706c  ort(sliced_sampl
+000154a0: 655f 3129 0a20 2020 2020 2020 2020 2020  e_1).           
+000154b0: 2020 2020 2073 315f 726e 6b2c 2073 325f       s1_rnk, s2_
+000154c0: 726e 6b20 3d20 736c 6963 6564 5f73 616d  rnk = sliced_sam
+000154d0: 706c 655f 315b 726e 6b73 5d2c 2073 6c69  ple_1[rnks], sli
+000154e0: 6365 645f 7361 6d70 6c65 5f32 5b72 6e6b  ced_sample_2[rnk
+000154f0: 735d 0a20 2020 2020 2020 2020 2020 2020  s].             
+00015500: 2020 2063 6e63 7264 6e74 5f63 6e74 732c     cncrdnt_cnts,
+00015510: 2064 7363 7264 6e74 5f63 6e74 7320 3d20   dscrdnt_cnts = 
+00015520: 6e70 2e66 756c 6c28 0a20 2020 2020 2020  np.full(.       
+00015530: 2020 2020 2020 2020 2020 2020 2028 7331               (s1
+00015540: 5f72 6e6b 2e73 6861 7065 5b30 5d20 2d20  _rnk.shape[0] - 
+00015550: 3129 2c20 6e70 2e6e 616e 0a20 2020 2020  1), np.nan.     
+00015560: 2020 2020 2020 2020 2020 2029 2c20 6e70             ), np
+00015570: 2e66 756c 6c28 2873 315f 726e 6b2e 7368  .full((s1_rnk.sh
+00015580: 6170 655b 305d 202d 2031 292c 206e 702e  ape[0] - 1), np.
+00015590: 6e61 6e29 0a20 2020 2020 2020 2020 2020  nan).           
+000155a0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+000155b0: 6e67 6528 7332 5f72 6e6b 2e73 6861 7065  nge(s2_rnk.shape
+000155c0: 5b30 5d20 2d20 3129 3a0a 2020 2020 2020  [0] - 1):.      
+000155d0: 2020 2020 2020 2020 2020 2020 2020 636e                cn
+000155e0: 6372 646e 745f 636e 7473 5b69 5d20 3d20  crdnt_cnts[i] = 
+000155f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00015600: 2020 2020 2020 2020 2020 6e70 2e61 7267            np.arg
+00015610: 7768 6572 6528 7332 5f72 6e6b 5b69 202b  where(s2_rnk[i +
+00015620: 2031 203a 5d20 3e20 7332 5f72 6e6b 5b69   1 :] > s2_rnk[i
+00015630: 5d29 2e66 6c61 7474 656e 2829 2e73 6861  ]).flatten().sha
+00015640: 7065 5b30 5d0a 2020 2020 2020 2020 2020  pe[0].          
+00015650: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00015660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015670: 6473 6372 646e 745f 636e 7473 5b69 5d20  dscrdnt_cnts[i] 
+00015680: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00015690: 2020 2020 2020 2020 2020 2020 6e70 2e61              np.a
+000156a0: 7267 7768 6572 6528 7332 5f72 6e6b 5b69  rgwhere(s2_rnk[i
+000156b0: 202b 2031 203a 5d20 3c20 7332 5f72 6e6b   + 1 :] < s2_rnk
+000156c0: 5b69 5d29 2e66 6c61 7474 656e 2829 2e73  [i]).flatten().s
+000156d0: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
+000156e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000156f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00015700: 7375 6c74 735b 7269 6768 745d 5b74 696d  sults[right][tim
+00015710: 655f 7769 6e64 6f77 5f63 6e74 5d20 3d20  e_window_cnt] = 
+00015720: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00015730: 2020 2020 2020 6e70 2e73 756d 2863 6e63        np.sum(cnc
+00015740: 7264 6e74 5f63 6e74 7329 202d 206e 702e  rdnt_cnts) - np.
+00015750: 7375 6d28 6473 6372 646e 745f 636e 7473  sum(dscrdnt_cnts
+00015760: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00015770: 2020 2920 2f20 286e 702e 7375 6d28 636e    ) / (np.sum(cn
+00015780: 6372 646e 745f 636e 7473 2920 2b20 6e70  crdnt_cnts) + np
+00015790: 2e73 756d 2864 7363 7264 6e74 5f63 6e74  .sum(dscrdnt_cnt
+000157a0: 7329 290a 0a20 2020 2020 2020 2072 6574  s))..        ret
+000157b0: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
+000157c0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+000157d0: 2020 2064 6566 2066 696e 645f 636f 6c6c     def find_coll
+000157e0: 696e 6561 725f 6665 6174 7572 6573 280a  inear_features(.
+000157f0: 2020 2020 2020 2020 6466 3a20 7064 2e44          df: pd.D
+00015800: 6174 6146 7261 6d65 2c0a 2020 2020 2020  ataFrame,.      
+00015810: 2020 7468 7265 7368 6f6c 643a 2066 6c6f    threshold: flo
+00015820: 6174 2c0a 2020 2020 2020 2020 6d65 7468  at,.        meth
+00015830: 6f64 3a20 4f70 7469 6f6e 616c 5b4c 6974  od: Optional[Lit
+00015840: 6572 616c 5b22 7065 6172 736f 6e22 2c20  eral["pearson", 
+00015850: 2273 7065 6172 6d61 6e22 2c20 226b 656e  "spearman", "ken
+00015860: 6461 6c6c 225d 5d20 3d20 2270 6561 7273  dall"]] = "pears
+00015870: 6f6e 222c 0a20 2020 2020 2020 2076 6572  on",.        ver
+00015880: 626f 7365 3a20 4f70 7469 6f6e 616c 5b62  bose: Optional[b
+00015890: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2020  ool] = False,.  
+000158a0: 2020 2920 2d3e 204c 6973 745b 7374 725d    ) -> List[str]
+000158b0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000158c0: 2020 2020 2020 4964 656e 7469 6679 2063        Identify c
+000158d0: 6f6c 6c69 6e65 6172 2066 6561 7475 7265  ollinear feature
+000158e0: 7320 696e 2074 6865 2064 6174 6166 7261  s in the datafra
+000158f0: 6d65 2062 6173 6564 206f 6e20 7468 6520  me based on the 
+00015900: 7370 6563 6966 6965 6420 636f 7272 656c  specified correl
+00015910: 6174 696f 6e20 6d65 7468 6f64 2061 6e64  ation method and
+00015920: 2074 6872 6573 686f 6c64 2e0a 0a20 2020   threshold...   
+00015930: 2020 2020 203a 7061 7261 6d20 7064 2e44       :param pd.D
+00015940: 6174 6146 7261 6d65 2064 663a 2049 6e70  ataFrame df: Inp
+00015950: 7574 2044 6174 6146 7261 6d65 2063 6f6e  ut DataFrame con
+00015960: 7461 696e 696e 6720 6665 6174 7572 6573  taining features
+00015970: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00015980: 2066 6c6f 6174 2074 6872 6573 686f 6c64   float threshold
+00015990: 3a20 5468 7265 7368 6f6c 6420 7661 6c75  : Threshold valu
+000159a0: 6520 746f 2064 6574 6572 6d69 6e65 2063  e to determine c
+000159b0: 6f6c 6c69 6e65 6172 6974 792e 0a20 2020  ollinearity..   
+000159c0: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+000159d0: 6f6e 616c 5b4c 6974 6572 616c 5b27 7065  onal[Literal['pe
+000159e0: 6172 736f 6e27 2c20 2773 7065 6172 6d61  arson', 'spearma
+000159f0: 6e27 2c20 276b 656e 6461 6c6c 275d 5d20  n', 'kendall']] 
+00015a00: 6d65 7468 6f64 3a20 4d65 7468 6f64 2066  method: Method f
+00015a10: 6f72 2063 616c 6375 6c61 7469 6e67 2063  or calculating c
+00015a20: 6f72 7265 6c61 7469 6f6e 2e20 4465 6661  orrelation. Defa
+00015a30: 756c 7473 2074 6f20 2770 6561 7273 6f6e  ults to 'pearson
+00015a40: 272e 0a20 2020 2020 2020 203a 7265 7475  '..        :retu
+00015a50: 726e 3a20 5365 7420 6f66 2066 6561 7475  rn: Set of featu
+00015a60: 7265 206e 616d 6573 2069 6465 6e74 6966  re names identif
+00015a70: 6965 6420 6173 2063 6f6c 6c69 6e65 6172  ied as collinear
+00015a80: 2e20 5265 7475 726e 7320 6f6e 6520 6665  . Returns one fe
+00015a90: 6174 7572 6520 666f 7220 6576 6572 7920  ature for every 
+00015aa0: 6665 6174 7572 6520 7061 6972 2077 6974  feature pair wit
+00015ab0: 6820 636f 7272 656c 6174 696f 6e20 7661  h correlation va
+00015ac0: 6c75 6520 6162 6f76 6520 7370 6563 6966  lue above specif
+00015ad0: 6965 6420 7468 7265 7368 6f6c 642e 0a0a  ied threshold...
+00015ae0: 2020 2020 2020 2020 3a65 7861 6d70 6c65          :example
+00015af0: 3a0a 2020 2020 2020 2020 3e3e 3e20 7820  :.        >>> x 
+00015b00: 3d20 7064 2e44 6174 6146 7261 6d65 286e  = pd.DataFrame(n
+00015b10: 702e 7261 6e64 6f6d 2e72 616e 6469 6e74  p.random.randint
+00015b20: 2830 2c20 3130 302c 2028 3130 302c 2031  (0, 100, (100, 1
+00015b30: 3030 2929 290a 2020 2020 2020 2020 3e3e  00))).        >>
+00015b40: 3e20 6e61 6d65 7320 3d20 5374 6174 6973  > names = Statis
+00015b50: 7469 6373 2e66 696e 645f 636f 6c6c 696e  tics.find_collin
+00015b60: 6561 725f 6665 6174 7572 6573 2864 663d  ear_features(df=
+00015b70: 782c 2074 6872 6573 686f 6c64 3d30 2e32  x, threshold=0.2
+00015b80: 2c20 6d65 7468 6f64 3d27 7065 6172 736f  , method='pearso
+00015b90: 6e27 2c20 7665 7262 6f73 653d 5472 7565  n', verbose=True
+00015ba0: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
+00015bb0: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
+00015bc0: 6964 5f64 6174 6166 7261 6d65 280a 2020  id_dataframe(.  
+00015bd0: 2020 2020 2020 2020 2020 6466 3d64 662c            df=df,
+00015be0: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00015bf0: 7263 653d 5374 6174 6973 7469 6373 2e66  rce=Statistics.f
+00015c00: 696e 645f 636f 6c6c 696e 6561 725f 6665  ind_collinear_fe
+00015c10: 6174 7572 6573 2e5f 5f6e 616d 655f 5f2c  atures.__name__,
+00015c20: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+00015c30: 6964 5f64 7479 7065 733d 2866 6c6f 6174  id_dtypes=(float
+00015c40: 2c20 696e 742c 206e 702e 666c 6f61 7433  , int, np.float3
+00015c50: 322c 206e 702e 666c 6f61 7436 342c 206e  2, np.float64, n
+00015c60: 702e 696e 7433 322c 206e 702e 696e 7436  p.int32, np.int6
+00015c70: 3429 2c0a 2020 2020 2020 2020 2020 2020  4),.            
+00015c80: 6d69 6e5f 6178 6973 5f31 3d31 2c0a 2020  min_axis_1=1,.  
+00015c90: 2020 2020 2020 2020 2020 6d69 6e5f 6178            min_ax
+00015ca0: 6973 5f30 3d31 2c0a 2020 2020 2020 2020  is_0=1,.        
+00015cb0: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
+00015cc0: 666c 6f61 7428 0a20 2020 2020 2020 2020  float(.         
+00015cd0: 2020 206e 616d 653d 5374 6174 6973 7469     name=Statisti
+00015ce0: 6373 2e66 696e 645f 636f 6c6c 696e 6561  cs.find_collinea
+00015cf0: 725f 6665 6174 7572 6573 2e5f 5f6e 616d  r_features.__nam
+00015d00: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
+00015d10: 2076 616c 7565 3d74 6872 6573 686f 6c64   value=threshold
+00015d20: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
+00015d30: 785f 7661 6c75 653d 312e 302c 0a20 2020  x_value=1.0,.   
+00015d40: 2020 2020 2020 2020 206d 696e 5f76 616c           min_val
+00015d50: 7565 3d30 2e30 2c0a 2020 2020 2020 2020  ue=0.0,.        
+00015d60: 290a 2020 2020 2020 2020 6368 6563 6b5f  ).        check_
+00015d70: 7374 7228 0a20 2020 2020 2020 2020 2020  str(.           
+00015d80: 206e 616d 653d 5374 6174 6973 7469 6373   name=Statistics
+00015d90: 2e66 696e 645f 636f 6c6c 696e 6561 725f  .find_collinear_
+00015da0: 6665 6174 7572 6573 2e5f 5f6e 616d 655f  features.__name_
+00015db0: 5f2c 0a20 2020 2020 2020 2020 2020 2076  _,.            v
+00015dc0: 616c 7565 3d6d 6574 686f 642c 0a20 2020  alue=method,.   
+00015dd0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00015de0: 3d28 2270 6561 7273 6f6e 222c 2022 7370  =("pearson", "sp
+00015df0: 6561 726d 616e 222c 2022 6b65 6e64 616c  earman", "kendal
+00015e00: 6c22 292c 0a20 2020 2020 2020 2029 0a20  l"),.        ). 
+00015e10: 2020 2020 2020 2066 6561 7475 7265 5f6e         feature_n
+00015e20: 616d 6573 203d 2073 6574 2829 0a20 2020  ames = set().   
+00015e30: 2020 2020 2066 6561 7475 7265 5f70 6169       feature_pai
+00015e40: 7273 203d 206c 6973 7428 636f 6d62 696e  rs = list(combin
+00015e50: 6174 696f 6e73 286c 6973 7428 6466 2e63  ations(list(df.c
+00015e60: 6f6c 756d 6e73 292c 2032 2929 0a0a 2020  olumns), 2))..  
+00015e70: 2020 2020 2020 666f 7220 636e 742c 2069        for cnt, i
+00015e80: 2069 6e20 656e 756d 6572 6174 6528 6665   in enumerate(fe
+00015e90: 6174 7572 655f 7061 6972 7329 3a0a 2020  ature_pairs):.  
+00015ea0: 2020 2020 2020 2020 2020 6966 2076 6572            if ver
+00015eb0: 626f 7365 3a0a 2020 2020 2020 2020 2020  bose:.          
+00015ec0: 2020 2020 2020 7072 696e 7428 0a20 2020        print(.   
+00015ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ee0: 2066 2241 6e61 6c79 7a69 6e67 2066 6561   f"Analyzing fea
+00015ef0: 7475 7265 2070 6169 7220 636f 6c6c 696e  ture pair collin
+00015f00: 6561 7269 7479 207b 636e 7420 2b20 317d  earity {cnt + 1}
+00015f10: 2f7b 6c65 6e28 6665 6174 7572 655f 7061  /{len(feature_pa
+00015f20: 6972 7329 7d2e 2e2e 220a 2020 2020 2020  irs)}...".      
+00015f30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00015f40: 2020 2020 2020 2020 6966 2028 695b 305d          if (i[0]
+00015f50: 206e 6f74 2069 6e20 6665 6174 7572 655f   not in feature_
+00015f60: 6e61 6d65 7329 2061 6e64 2028 695b 315d  names) and (i[1]
+00015f70: 206e 6f74 2069 6e20 6665 6174 7572 655f   not in feature_
+00015f80: 6e61 6d65 7329 3a0a 2020 2020 2020 2020  names):.        
+00015f90: 2020 2020 2020 2020 7361 6d70 6c65 5f31          sample_1
+00015fa0: 2c20 7361 6d70 6c65 5f32 203d 2064 665b  , sample_2 = df[
+00015fb0: 695b 305d 5d2e 7661 6c75 6573 2e61 7374  i[0]].values.ast
+00015fc0: 7970 6528 6e70 2e66 6c6f 6174 3332 292c  ype(np.float32),
+00015fd0: 2064 665b 0a20 2020 2020 2020 2020 2020   df[.           
+00015fe0: 2020 2020 2020 2020 2069 5b31 5d0a 2020           i[1].  
+00015ff0: 2020 2020 2020 2020 2020 2020 2020 5d2e                ].
+00016000: 7661 6c75 6573 2e61 7374 7970 6528 6e70  values.astype(np
+00016010: 2e66 6c6f 6174 3332 290a 2020 2020 2020  .float32).      
+00016020: 2020 2020 2020 2020 2020 6966 206d 6574            if met
+00016030: 686f 6420 3d3d 2022 7065 6172 736f 6e22  hod == "pearson"
+00016040: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016050: 2020 2020 2020 7220 3d20 5374 6174 6973        r = Statis
+00016060: 7469 6373 2e70 6561 7273 6f6e 735f 7228  tics.pearsons_r(
+00016070: 7361 6d70 6c65 5f31 3d73 616d 706c 655f  sample_1=sample_
+00016080: 312c 2073 616d 706c 655f 323d 7361 6d70  1, sample_2=samp
+00016090: 6c65 5f32 290a 2020 2020 2020 2020 2020  le_2).          
+000160a0: 2020 2020 2020 656c 6966 206d 6574 686f        elif metho
+000160b0: 6420 3d3d 2022 7370 6561 726d 616e 223a  d == "spearman":
+000160c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000160d0: 2020 2020 2072 203d 2053 7461 7469 7374       r = Statist
+000160e0: 6963 732e 7370 6561 726d 616e 5f72 616e  ics.spearman_ran
+000160f0: 6b5f 636f 7272 656c 6174 696f 6e28 0a20  k_correlation(. 
+00016100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016110: 2020 2020 2020 2073 616d 706c 655f 313d         sample_1=
+00016120: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+00016130: 5f32 3d73 616d 706c 655f 320a 2020 2020  _2=sample_2.    
+00016140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016150: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00016160: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00016170: 2020 2020 2020 2020 2020 2020 7220 3d20              r = 
+00016180: 5374 6174 6973 7469 6373 2e6b 656e 6461  Statistics.kenda
+00016190: 6c6c 5f74 6175 2873 616d 706c 655f 313d  ll_tau(sample_1=
+000161a0: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+000161b0: 5f32 3d73 616d 706c 655f 3229 5b30 5d0a  _2=sample_2)[0].
+000161c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000161d0: 6966 2061 6273 2872 2920 3e20 7468 7265  if abs(r) > thre
+000161e0: 7368 6f6c 643a 0a20 2020 2020 2020 2020  shold:.         
+000161f0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00016200: 7265 5f6e 616d 6573 2e61 6464 2869 5b30  re_names.add(i[0
+00016210: 5d29 0a20 2020 2020 2020 2069 6620 7665  ]).        if ve
+00016220: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
+00016230: 2020 2070 7269 6e74 2822 436f 6c6c 696e     print("Collin
+00016240: 6561 7220 616e 616c 7973 6973 2063 6f6d  ear analysis com
+00016250: 706c 6574 652e 2229 0a20 2020 2020 2020  plete.").       
+00016260: 2072 6574 7572 6e20 6665 6174 7572 655f   return feature_
+00016270: 6e61 6d65 730a 0a20 2020 2040 7374 6174  names..    @stat
+00016280: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+00016290: 206c 6f63 616c 5f6f 7574 6c69 6572 5f66   local_outlier_f
+000162a0: 6163 746f 7228 0a20 2020 2020 2020 2064  actor(.        d
+000162b0: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+000162c0: 0a20 2020 2020 2020 206b 3a20 556e 696f  .        k: Unio
+000162d0: 6e5b 696e 742c 2066 6c6f 6174 5d20 3d20  n[int, float] = 
+000162e0: 352c 0a20 2020 2020 2020 2063 6f6e 7461  5,.        conta
+000162f0: 6d69 6e61 7469 6f6e 3a20 4f70 7469 6f6e  mination: Option
+00016300: 616c 5b66 6c6f 6174 5d20 3d20 3165 2d31  al[float] = 1e-1
+00016310: 302c 0a20 2020 2020 2020 206e 6f72 6d61  0,.        norma
+00016320: 6c69 7a65 3a20 4f70 7469 6f6e 616c 5b62  lize: Optional[b
+00016330: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2020  ool] = False,.  
+00016340: 2020 2020 2020 6772 6f75 7062 795f 6964        groupby_id
+00016350: 783a 204f 7074 696f 6e61 6c5b 696e 745d  x: Optional[int]
+00016360: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+00016370: 3e20 6e70 2e6e 6461 7272 6179 3a0a 2020  > np.ndarray:.  
+00016380: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00016390: 2020 436f 6d70 7574 6520 7468 6520 6c6f    Compute the lo
+000163a0: 6361 6c20 6f75 746c 6965 7220 6661 6374  cal outlier fact
+000163b0: 6f72 206f 6620 6561 6368 206f 6273 6572  or of each obser
+000163c0: 7661 7469 6f6e 2e0a 0a20 2020 2020 2020  vation...       
+000163d0: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
+000163e0: 2020 2020 2020 5468 6520 6669 6e61 6c20        The final 
+000163f0: 4c4f 4620 7363 6f72 6573 2061 7265 206e  LOF scores are n
+00016400: 6567 6174 6564 2e20 5468 7573 2c20 6869  egated. Thus, hi
+00016410: 6768 6572 2076 616c 7565 7320 696e 6469  gher values indi
+00016420: 6361 7465 206d 6f72 6520 6174 7970 6963  cate more atypic
+00016430: 616c 2028 6f75 746c 6965 7229 2064 6174  al (outlier) dat
+00016440: 6120 706f 696e 7473 2e20 5661 6c75 6573  a points. Values
+00016450: 0a20 2020 2020 2020 2020 2020 4d65 7468  .           Meth
+00016460: 6f64 2063 616c 6c73 2060 6073 6b6c 6561  od calls ``sklea
+00016470: 726e 2e6e 6569 6768 626f 7273 2e4c 6f63  rn.neighbors.Loc
+00016480: 616c 4f75 746c 6965 7246 6163 746f 7260  alOutlierFactor`
+00016490: 6020 6469 7265 6374 6c79 2e20 4174 7465  ` directly. Atte
+000164a0: 6d70 7465 6420 746f 2075 7365 206f 776e  mpted to use own
+000164b0: 206a 6974 2063 6f6d 7069 6c65 6420 696d   jit compiled im
+000164c0: 706c 656d 656e 7461 7469 6f6e 2c0a 2020  plementation,.  
+000164d0: 2020 2020 2020 2020 2062 7574 2072 756e           but run
+000164e0: 7469 6d65 2077 6173 2033 782d 6973 6820  time was 3x-ish 
+000164f0: 736c 6f77 6572 2074 6861 6e20 6060 736b  slower than ``sk
+00016500: 6c65 6172 6e2e 6e65 6967 6862 6f72 732e  learn.neighbors.
+00016510: 4c6f 6361 6c4f 7574 6c69 6572 4661 6374  LocalOutlierFact
+00016520: 6f72 6060 2e0a 0a20 2020 2020 2020 2020  or``...         
+00016530: 2020 4966 2067 726f 7570 6279 5f69 6478    If groupby_idx
+00016540: 2069 7320 6e6f 7420 4e6f 6e65 2c20 7468   is not None, th
+00016550: 656e 2074 6865 2069 6e64 6578 2031 206f  en the index 1 o
+00016560: 6620 6060 6461 7461 6060 2061 7272 6179  f ``data`` array
+00016570: 2066 6f72 2077 6869 6368 2074 6f20 6772   for which to gr
+00016580: 6f75 7020 7468 6520 6461 7461 2061 6e64  oup the data and
+00016590: 2063 6f6d 7075 7465 204c 4f46 2077 6974   compute LOF wit
+000165a0: 6869 6e20 6561 6368 2073 6567 6d65 6e74  hin each segment
+000165b0: 2f63 6c75 7374 6572 2e0a 2020 2020 2020  /cluster..      
+000165c0: 2020 2020 2045 2e67 2e2c 2063 616e 2062       E.g., can b
+000165d0: 6520 6669 656c 6420 686f 6c64 696e 6720  e field holding 
+000165e0: 636c 7573 7465 7220 6964 656e 7469 6669  cluster identifi
+000165f0: 6572 2e20 5468 7573 2c20 6f75 746c 6965  er. Thus, outlie
+00016600: 7273 2061 7265 2063 6f6d 7075 7465 6420  rs are computed 
+00016610: 7769 7468 696e 2065 6163 6820 7365 676d  within each segm
+00016620: 656e 742f 636c 7573 7465 722c 2065 6e73  ent/cluster, ens
+00016630: 7572 696e 6720 7468 6174 206f 7468 6572  uring that other
+00016640: 2073 6567 6d65 6e74 7320 6361 6e6e 6f74   segments cannot
+00016650: 2061 6666 6563 740a 2020 2020 2020 2020   affect.        
+00016660: 2020 206f 7574 6c69 6572 2073 636f 7265     outlier score
+00016670: 7320 7769 7468 696e 2065 6163 6820 616e  s within each an
+00016680: 616c 797a 696e 6720 6561 6368 2063 6c75  alyzing each clu
+00016690: 7374 6572 2e0a 0a20 2020 2020 2020 2020  ster...         
+000166a0: 2020 4966 2067 726f 7570 6279 5f69 6478    If groupby_idx
+000166b0: 2069 7320 7072 6f76 6964 6564 2c20 7468   is provided, th
+000166c0: 656e 2061 6c6c 206f 6273 6572 7661 7469  en all observati
+000166d0: 6f6e 7320 7769 7468 2063 6c75 7374 6572  ons with cluster
+000166e0: 2f73 6567 6d65 6e74 2076 6172 6961 626c  /segment variabl
+000166f0: 6520 6060 2d31 6060 2077 696c 6c20 6265  e ``-1`` will be
+00016700: 2074 7265 6174 6564 2061 7320 756e 636c   treated as uncl
+00016710: 7573 7465 7265 6420 616e 6420 6173 7369  ustered and assi
+00016720: 676e 6564 2074 6865 206d 6178 206f 7574  gned the max out
+00016730: 6c69 6572 2073 636f 7265 2066 6f75 6e64  lier score found
+00016740: 2077 6974 6869 696e 2074 6865 2063 6c75   withiin the clu
+00016750: 7374 6572 6564 206f 6273 6572 7661 7469  stered observati
+00016760: 6f6e 732e 0a0a 2020 2020 2020 2020 2e2e  ons...        ..
+00016770: 2069 6d61 6765 3a3a 205f 7374 6174 6963   image:: _static
+00016780: 2f69 6d67 2f6c 6f63 616c 5f6f 7574 6c69  /img/local_outli
+00016790: 6572 5f66 6163 746f 722e 706e 670a 2020  er_factor.png.  
+000167a0: 2020 2020 2020 2020 203a 7769 6474 683a           :width:
+000167b0: 2038 3030 0a20 2020 2020 2020 2020 2020   800.           
+000167c0: 3a61 6c69 676e 3a20 6365 6e74 6572 0a0a  :align: center..
+000167d0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+000167e0: 6461 7272 6179 2064 6174 613a 2032 4420  darray data: 2D 
+000167f0: 6172 7261 7920 7769 7468 2066 6561 7475  array with featu
+00016800: 7265 2076 616c 7565 7320 7768 6572 6520  re values where 
+00016810: 726f 7773 2072 6570 7265 7365 6e74 2066  rows represent f
+00016820: 7261 6d65 7320 616e 6420 636f 6c75 6d6e  rames and column
+00016830: 7320 7265 7072 6573 656e 7420 6665 6174  s represent feat
+00016840: 7572 6573 2e0a 2020 2020 2020 2020 3a70  ures..        :p
+00016850: 6172 616d 2055 6e69 6f6e 5b69 6e74 2c20  aram Union[int, 
+00016860: 666c 6f61 745d 206b 3a20 4e75 6d62 6572  float] k: Number
+00016870: 206f 6620 6e65 6967 6862 6f72 7320 746f   of neighbors to
+00016880: 2065 7661 6c75 6174 6520 666f 7220 6561   evaluate for ea
+00016890: 6368 206f 6273 6572 7661 7469 6f6e 2e20  ch observation. 
+000168a0: 4966 2074 6865 2076 616c 7565 2069 7320  If the value is 
+000168b0: 6120 666c 6f61 742c 2074 6865 6e20 696e  a float, then in
+000168c0: 7465 7270 7265 7465 6420 6173 2074 6865  terpreted as the
+000168d0: 2072 6174 696f 206f 6620 6461 7461 2e73   ratio of data.s
+000168e0: 6861 7065 5b30 5d2e 2049 6620 7468 6520  hape[0]. If the 
+000168f0: 7661 6c75 6520 6973 2061 6e20 696e 7465  value is an inte
+00016900: 6765 722c 2074 6865 6e20 6974 2072 6570  ger, then it rep
+00016910: 7265 7365 6e74 2074 6865 206e 756d 6265  resent the numbe
+00016920: 7220 6f66 206e 6569 6768 626f 7572 7320  r of neighbours 
+00016930: 746f 2065 7661 6c75 6174 652e 0a20 2020  to evaluate..   
+00016940: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+00016950: 6f6e 616c 5b66 6c6f 6174 5d20 636f 6e74  onal[float] cont
+00016960: 616d 696e 6174 696f 6e3a 2053 6d61 6c6c  amination: Small
+00016970: 2070 7365 7564 6f6e 756d 6265 7220 746f   pseudonumber to
+00016980: 2061 766f 6964 2044 6976 6973 696f 6e42   avoid DivisionB
+00016990: 795a 6572 6f20 6572 726f 722e 0a20 2020  yZero error..   
+000169a0: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+000169b0: 6f6e 616c 5b62 6f6f 6c5d 206e 6f72 6d61  onal[bool] norma
+000169c0: 6c69 7a65 3a20 5768 6574 6865 7220 746f  lize: Whether to
+000169d0: 206e 6f72 6d61 6c69 7a65 2074 6865 2064   normalize the d
+000169e0: 6973 7461 6e63 6573 2062 6574 7765 656e  istances between
+000169f0: 2030 2061 6e64 2031 2e20 4465 6661 756c   0 and 1. Defaul
+00016a00: 7473 2074 6f20 4661 6c73 652e 0a20 2020  ts to False..   
+00016a10: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+00016a20: 6f6e 616c 5b69 6e74 5d20 6772 6f75 7062  onal[int] groupb
+00016a30: 795f 6964 783a 2049 6620 696e 742c 2074  y_idx: If int, t
+00016a40: 6865 6e20 7468 6520 696e 6465 7820 3120  hen the index 1 
+00016a50: 6f66 2060 6064 6174 6160 6020 666f 7220  of ``data`` for 
+00016a60: 7768 6963 6820 746f 2067 726f 7570 2074  which to group t
+00016a70: 6865 2064 6174 6120 616e 6420 636f 6d70  he data and comp
+00016a80: 7574 6520 4c4f 4620 6f6e 2065 6163 6820  ute LOF on each 
+00016a90: 7365 676d 656e 742e 2045 2e67 2e2c 2063  segment. E.g., c
+00016aa0: 616e 2062 6520 6669 656c 6420 686f 6c64  an be field hold
+00016ab0: 696e 6720 6120 636c 7573 7465 7220 6964  ing a cluster id
+00016ac0: 656e 7469 6669 6572 2e0a 2020 2020 2020  entifier..      
+00016ad0: 2020 3a72 6574 7572 6e73 206e 702e 6e64    :returns np.nd
+00016ae0: 6172 7261 793a 2041 7272 6179 206f 6620  array: Array of 
+00016af0: 7369 7a65 2064 6174 612e 7368 6170 655b  size data.shape[
+00016b00: 305d 2077 6974 6820 6c6f 6361 6c20 6f75  0] with local ou
+00016b10: 746c 6965 7220 7363 6f72 6573 2e0a 0a20  tlier scores... 
+00016b20: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+00016b30: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+00016b40: 612c 206c 626c 7320 3d20 6d61 6b65 5f62  a, lbls = make_b
+00016b50: 6c6f 6273 286e 5f73 616d 706c 6573 3d32  lobs(n_samples=2
+00016b60: 3030 302c 206e 5f66 6561 7475 7265 733d  000, n_features=
+00016b70: 322c 2063 656e 7465 7273 3d31 302c 2072  2, centers=10, r
+00016b80: 616e 646f 6d5f 7374 6174 653d 3432 290a  andom_state=42).
+00016b90: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
+00016ba0: 203d 206e 702e 6873 7461 636b 2828 6461   = np.hstack((da
+00016bb0: 7461 2c20 6c62 6c73 2e72 6573 6861 7065  ta, lbls.reshape
+00016bc0: 282d 312c 2031 2929 290a 2020 2020 2020  (-1, 1))).      
+00016bd0: 2020 3e3e 3e20 6c6f 6620 3d20 5374 6174    >>> lof = Stat
+00016be0: 6973 7469 6373 2e6c 6f63 616c 5f6f 7574  istics.local_out
+00016bf0: 6c69 6572 5f66 6163 746f 7228 6461 7461  lier_factor(data
+00016c00: 3d64 6174 612c 2067 726f 7570 6279 5f69  =data, groupby_i
+00016c10: 6478 3d32 2c20 6b3d 3130 302c 206e 6f72  dx=2, k=100, nor
+00016c20: 6d61 6c69 7a65 3d54 7275 6529 0a20 2020  malize=True).   
+00016c30: 2020 2020 203e 3e3e 2072 6573 756c 7473       >>> results
+00016c40: 203d 206e 702e 6873 7461 636b 2828 6461   = np.hstack((da
+00016c50: 7461 5b3a 2c20 303a 325d 2c20 6c6f 662e  ta[:, 0:2], lof.
+00016c60: 7265 7368 6170 6528 6c6f 662e 7368 6170  reshape(lof.shap
+00016c70: 655b 305d 2c20 3129 2929 0a20 2020 2020  e[0], 1))).     
+00016c80: 2020 203e 3e3e 2050 6c6f 7474 696e 674d     >>> PlottingM
+00016c90: 6978 696e 2e63 6f6e 7469 6e75 6f75 735f  ixin.continuous_
+00016ca0: 7363 6174 7465 7228 6461 7461 3d72 6573  scatter(data=res
+00016cb0: 756c 7473 2c20 7061 6c65 7474 653d 2773  ults, palette='s
+00016cc0: 6569 736d 6963 272c 2062 675f 636c 723d  eismic', bg_clr=
+00016cd0: 276c 6967 6874 6772 6579 272c 7369 7a65  'lightgrey',size
+00016ce0: 3d33 3029 0a20 2020 2020 2020 2022 2222  =30).        """
+00016cf0: 0a0a 2020 2020 2020 2020 6465 6620 6765  ..        def ge
+00016d00: 745f 6c6f 6628 6461 7461 2c20 6b2c 2063  t_lof(data, k, c
+00016d10: 6f6e 7461 6d69 6e61 7469 6f6e 293a 0a20  ontamination):. 
+00016d20: 2020 2020 2020 2020 2020 2063 6865 636b             check
+00016d30: 5f66 6c6f 6174 286e 616d 653d 6622 7b53  _float(name=f"{S
+00016d40: 7461 7469 7374 6963 732e 6c6f 6361 6c5f  tatistics.local_
+00016d50: 6f75 746c 6965 725f 6661 6374 6f72 2e5f  outlier_factor._
+00016d60: 5f6e 616d 655f 5f7d 206b 222c 2076 616c  _name__} k", val
+00016d70: 7565 3d6b 290a 2020 2020 2020 2020 2020  ue=k).          
+00016d80: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00016d90: 6b2c 2069 6e74 293a 0a20 2020 2020 2020  k, int):.       
+00016da0: 2020 2020 2020 2020 206b 203d 206d 696e           k = min
+00016db0: 286b 2c20 6461 7461 2e73 6861 7065 5b30  (k, data.shape[0
+00016dc0: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
+00016dd0: 6c69 6620 6973 696e 7374 616e 6365 286b  lif isinstance(k
+00016de0: 2c20 666c 6f61 7429 3a0a 2020 2020 2020  , float):.      
+00016df0: 2020 2020 2020 2020 2020 6b20 3d20 696e            k = in
+00016e00: 7428 6461 7461 2e73 6861 7065 5b30 5d20  t(data.shape[0] 
+00016e10: 2a20 6b29 0a20 2020 2020 2020 2020 2020  * k).           
+00016e20: 206c 6f66 5f6d 6f64 656c 203d 204c 6f63   lof_model = Loc
+00016e30: 616c 4f75 746c 6965 7246 6163 746f 7228  alOutlierFactor(
+00016e40: 6e5f 6e65 6967 6862 6f72 733d 6b2c 2063  n_neighbors=k, c
+00016e50: 6f6e 7461 6d69 6e61 7469 6f6e 3d63 6f6e  ontamination=con
+00016e60: 7461 6d69 6e61 7469 6f6e 290a 2020 2020  tamination).    
+00016e70: 2020 2020 2020 2020 5f20 3d20 6c6f 665f          _ = lof_
+00016e80: 6d6f 6465 6c2e 6669 745f 7072 6564 6963  model.fit_predic
+00016e90: 7428 6461 7461 290a 2020 2020 2020 2020  t(data).        
+00016ea0: 2020 2020 7920 3d20 2d6c 6f66 5f6d 6f64      y = -lof_mod
+00016eb0: 656c 2e6e 6567 6174 6976 655f 6f75 746c  el.negative_outl
+00016ec0: 6965 725f 6661 6374 6f72 5f2e 6173 7479  ier_factor_.asty
+00016ed0: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+00016ee0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00016ef0: 726d 616c 697a 653a 0a20 2020 2020 2020  rmalize:.       
+00016f00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00016f10: 2879 202d 206e 702e 6d69 6e28 7929 2920  (y - np.min(y)) 
+00016f20: 2f20 286e 702e 6d61 7828 7929 202d 206e  / (np.max(y) - n
+00016f30: 702e 6d69 6e28 7929 290a 2020 2020 2020  p.min(y)).      
+00016f40: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00016f50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016f60: 726e 2079 0a0a 2020 2020 2020 2020 6966  rn y..        if
+00016f70: 2067 726f 7570 6279 5f69 6478 2069 7320   groupby_idx is 
+00016f80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00016f90: 2020 2020 2020 6368 6563 6b5f 696e 7428        check_int(
+00016fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016fb0: 206e 616d 653d 6622 7b53 7461 7469 7374   name=f"{Statist
+00016fc0: 6963 732e 6c6f 6361 6c5f 6f75 746c 6965  ics.local_outlie
+00016fd0: 725f 6661 6374 6f72 2e5f 5f6e 616d 655f  r_factor.__name_
+00016fe0: 5f7d 2067 726f 7570 6279 5f69 6478 222c  _} groupby_idx",
+00016ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017000: 2076 616c 7565 3d67 726f 7570 6279 5f69   value=groupby_i
+00017010: 6478 2c0a 2020 2020 2020 2020 2020 2020  dx,.            
+00017020: 2020 2020 6d69 6e5f 7661 6c75 653d 302c      min_value=0,
+00017030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017040: 206d 6178 5f76 616c 7565 3d64 6174 612e   max_value=data.
+00017050: 7368 6170 655b 315d 202d 2031 2c0a 2020  shape[1] - 1,.  
+00017060: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00017070: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
+00017080: 6c69 645f 6172 7261 7928 0a20 2020 2020  lid_array(.     
+00017090: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+000170a0: 653d 6622 7b53 7461 7469 7374 6963 732e  e=f"{Statistics.
+000170b0: 6c6f 6361 6c5f 6f75 746c 6965 725f 6661  local_outlier_fa
+000170c0: 6374 6f72 2e5f 5f6e 616d 655f 5f7d 206c  ctor.__name__} l
+000170d0: 6f63 616c 5f6f 7574 6c69 6572 5f66 6163  ocal_outlier_fac
+000170e0: 746f 7222 2c0a 2020 2020 2020 2020 2020  tor",.          
+000170f0: 2020 2020 2020 6461 7461 3d64 6174 612c        data=data,
+00017100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017110: 2061 6363 6570 7465 645f 7369 7a65 733d   accepted_sizes=
+00017120: 5b32 5d2c 0a20 2020 2020 2020 2020 2020  [2],.           
+00017130: 2020 2020 206d 696e 5f61 7869 735f 313d       min_axis_1=
+00017140: 332c 0a20 2020 2020 2020 2020 2020 2029  3,.            )
+00017150: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00017160: 2020 2020 2020 2020 2020 2063 6865 636b             check
+00017170: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
+00017180: 2020 2020 2020 2020 2020 2020 2020 736f                so
+00017190: 7572 6365 3d66 227b 5374 6174 6973 7469  urce=f"{Statisti
+000171a0: 6373 2e6c 6f63 616c 5f6f 7574 6c69 6572  cs.local_outlier
+000171b0: 5f66 6163 746f 722e 5f5f 6e61 6d65 5f5f  _factor.__name__
+000171c0: 7d20 6461 7461 222c 0a20 2020 2020 2020  } data",.       
+000171d0: 2020 2020 2020 2020 2064 6174 613d 6461           data=da
+000171e0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000171f0: 2020 2020 6163 6365 7074 6564 5f73 697a      accepted_siz
+00017200: 6573 3d5b 325d 2c0a 2020 2020 2020 2020  es=[2],.        
+00017210: 2020 2020 2020 2020 6d69 6e5f 6178 6973          min_axis
+00017220: 5f31 3d32 2c0a 2020 2020 2020 2020 2020  _1=2,.          
+00017230: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
+00017240: 6b5f 666c 6f61 7428 0a20 2020 2020 2020  k_float(.       
+00017250: 2020 2020 206e 616d 653d 6622 7b53 7461       name=f"{Sta
+00017260: 7469 7374 6963 732e 6c6f 6361 6c5f 6f75  tistics.local_ou
+00017270: 746c 6965 725f 6661 6374 6f72 2e5f 5f6e  tlier_factor.__n
+00017280: 616d 655f 5f7d 2063 6f6e 7461 6d69 6e61  ame__} contamina
+00017290: 7469 6f6e 222c 0a20 2020 2020 2020 2020  tion",.         
+000172a0: 2020 2076 616c 7565 3d63 6f6e 7461 6d69     value=contami
+000172b0: 6e61 7469 6f6e 2c0a 2020 2020 2020 2020  nation,.        
+000172c0: 2020 2020 6d69 6e5f 7661 6c75 653d 302e      min_value=0.
+000172d0: 302c 0a20 2020 2020 2020 2029 0a0a 2020  0,.        )..  
+000172e0: 2020 2020 2020 6966 2067 726f 7570 6279        if groupby
+000172f0: 5f69 6478 2069 7320 4e6f 6e65 3a0a 2020  _idx is None:.  
+00017300: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00017310: 2067 6574 5f6c 6f66 2864 6174 612c 206b   get_lof(data, k
+00017320: 2c20 636f 6e74 616d 696e 6174 696f 6e29  , contamination)
+00017330: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00017340: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00017350: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+00017360: 2020 2020 6461 7461 5f77 5f69 6478 203d      data_w_idx =
+00017370: 206e 702e 6873 7461 636b 2828 6e70 2e61   np.hstack((np.a
+00017380: 7261 6e67 6528 302c 2064 6174 612e 7368  range(0, data.sh
+00017390: 6170 655b 305d 292e 7265 7368 6170 6528  ape[0]).reshape(
+000173a0: 2d31 2c20 3129 2c20 6461 7461 2929 0a20  -1, 1), data)). 
+000173b0: 2020 2020 2020 2020 2020 2075 6e69 7175             uniqu
+000173c0: 655f 6320 3d20 6e70 2e75 6e69 7175 6528  e_c = np.unique(
+000173d0: 6461 7461 5b3a 2c20 6772 6f75 7062 795f  data[:, groupby_
+000173e0: 6964 785d 292e 6173 7479 7065 286e 702e  idx]).astype(np.
+000173f0: 666c 6f61 7433 3229 0a20 2020 2020 2020  float32).       
+00017400: 2020 2020 2069 6620 2d31 2e30 2069 6e20       if -1.0 in 
+00017410: 756e 6971 7565 5f63 3a0a 2020 2020 2020  unique_c:.      
+00017420: 2020 2020 2020 2020 2020 756e 6971 7565            unique
+00017430: 5f63 203d 2075 6e69 7175 655f 635b 6e70  _c = unique_c[np
+00017440: 2e77 6865 7265 2875 6e69 7175 655f 6320  .where(unique_c 
+00017450: 213d 202d 3129 5d0a 2020 2020 2020 2020  != -1)].        
+00017460: 2020 2020 2020 2020 756e 636c 7573 7465          uncluste
+00017470: 7265 645f 6964 7820 3d20 6e70 2e61 7267  red_idx = np.arg
+00017480: 7768 6572 6528 6461 7461 5b3a 2c20 6772  where(data[:, gr
+00017490: 6f75 7062 795f 6964 785d 203d 3d20 2d31  oupby_idx] == -1
+000174a0: 2e30 292e 666c 6174 7465 6e28 290a 2020  .0).flatten().  
+000174b0: 2020 2020 2020 2020 2020 2020 2020 756e                un
+000174c0: 636c 7573 7465 7265 6420 3d20 6461 7461  clustered = data
+000174d0: 5f77 5f69 6478 5b75 6e63 6c75 7374 6572  _w_idx[uncluster
+000174e0: 6564 5f69 6478 5d0a 2020 2020 2020 2020  ed_idx].        
+000174f0: 2020 2020 2020 2020 6461 7461 5f77 5f69          data_w_i
+00017500: 6478 203d 206e 702e 6465 6c65 7465 2864  dx = np.delete(d
+00017510: 6174 615f 775f 6964 782c 2075 6e63 6c75  ata_w_idx, unclu
+00017520: 7374 6572 6564 5f69 6478 2c20 6178 6973  stered_idx, axis
+00017530: 3d30 290a 2020 2020 2020 2020 2020 2020  =0).            
+00017540: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00017550: 2020 2020 2020 756e 636c 7573 7465 7265        unclustere
+00017560: 6420 3d20 4e6f 6e65 0a20 2020 2020 2020  d = None.       
+00017570: 2020 2020 2066 6f72 2069 2069 6e20 756e       for i in un
+00017580: 6971 7565 5f63 3a0a 2020 2020 2020 2020  ique_c:.        
+00017590: 2020 2020 2020 2020 735f 6461 7461 203d          s_data =
+000175a0: 2064 6174 615f 775f 6964 785b 0a20 2020   data_w_idx[.   
+000175b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000175c0: 206e 702e 6172 6777 6865 7265 2864 6174   np.argwhere(dat
+000175d0: 615f 775f 6964 785b 3a2c 2067 726f 7570  a_w_idx[:, group
+000175e0: 6279 5f69 6478 202b 2031 5d20 3d3d 2069  by_idx + 1] == i
+000175f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00017600: 2020 5d2e 7265 7368 6170 6528 2d31 2c20    ].reshape(-1, 
+00017610: 6461 7461 5f77 5f69 6478 2e73 6861 7065  data_w_idx.shape
+00017620: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+00017630: 2020 2020 2069 6478 203d 2073 5f64 6174       idx = s_dat
+00017640: 615b 3a2c 2030 5d2e 7265 7368 6170 6528  a[:, 0].reshape(
+00017650: 735f 6461 7461 2e73 6861 7065 5b30 5d2c  s_data.shape[0],
+00017660: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+00017670: 2020 2020 735f 6461 7461 203d 206e 702e      s_data = np.
+00017680: 6465 6c65 7465 2873 5f64 6174 612c 205b  delete(s_data, [
+00017690: 302c 2067 726f 7570 6279 5f69 6478 202b  0, groupby_idx +
+000176a0: 2031 5d2c 2031 290a 2020 2020 2020 2020   1], 1).        
+000176b0: 2020 2020 2020 2020 6c6f 6620 3d20 6765          lof = ge
+000176c0: 745f 6c6f 6628 735f 6461 7461 2c20 6b2c  t_lof(s_data, k,
+000176d0: 2063 6f6e 7461 6d69 6e61 7469 6f6e 292e   contamination).
+000176e0: 7265 7368 6170 6528 735f 6461 7461 2e73  reshape(s_data.s
+000176f0: 6861 7065 5b30 5d2c 2031 290a 2020 2020  hape[0], 1).    
+00017700: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00017710: 6c74 732e 6170 7065 6e64 286e 702e 6873  lts.append(np.hs
+00017720: 7461 636b 2828 6964 782c 206c 6f66 2929  tack((idx, lof))
+00017730: 290a 2020 2020 2020 2020 2020 2020 7820  ).            x 
+00017740: 3d20 6e70 2e63 6f6e 6361 7465 6e61 7465  = np.concatenate
+00017750: 2872 6573 756c 7473 2c20 6178 6973 3d30  (results, axis=0
+00017760: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00017770: 2075 6e63 6c75 7374 6572 6564 2069 7320   unclustered is 
+00017780: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00017790: 2020 2020 2020 2020 2020 6d61 785f 6c6f            max_lo
+000177a0: 6620 3d20 6e70 2e66 756c 6c28 2875 6e63  f = np.full((unc
+000177b0: 6c75 7374 6572 6564 2e73 6861 7065 5b30  lustered.shape[0
+000177c0: 5d2c 2031 292c 206e 702e 6d61 7828 785b  ], 1), np.max(x[
+000177d0: 3a2c 202d 315d 2929 0a20 2020 2020 2020  :, -1])).       
+000177e0: 2020 2020 2020 2020 2075 6e63 6c75 7374           unclust
+000177f0: 6572 6564 203d 206e 702e 6873 7461 636b  ered = np.hstack
+00017800: 2828 756e 636c 7573 7465 7265 642c 206d  ((unclustered, m
+00017810: 6178 5f6c 6f66 2929 5b3a 2c20 5b30 2c20  ax_lof))[:, [0, 
+00017820: 2d31 5d5d 0a20 2020 2020 2020 2020 2020  -1]].           
+00017830: 2020 2020 2078 203d 206e 702e 7673 7461       x = np.vsta
+00017840: 636b 2828 782c 2075 6e63 6c75 7374 6572  ck((x, uncluster
+00017850: 6564 2929 0a20 2020 2020 2020 2020 2020  ed)).           
+00017860: 2072 6574 7572 6e20 785b 6e70 2e61 7267   return x[np.arg
+00017870: 736f 7274 2878 5b3a 2c20 305d 295d 5b3a  sort(x[:, 0])][:
+00017880: 2c20 2d31 5d0a 0a20 2020 2040 7374 6174  , -1]..    @stat
+00017890: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+000178a0: 2065 6c6c 6970 7469 635f 656e 7665 6c6f   elliptic_envelo
+000178b0: 7065 280a 2020 2020 2020 2020 6461 7461  pe(.        data
+000178c0: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
+000178d0: 2020 2020 2020 636f 6e74 616d 696e 6174        contaminat
+000178e0: 696f 6e3a 204f 7074 696f 6e61 6c5b 666c  ion: Optional[fl
+000178f0: 6f61 745d 203d 2031 652d 312c 0a20 2020  oat] = 1e-1,.   
+00017900: 2020 2020 206e 6f72 6d61 6c69 7a65 3a20       normalize: 
+00017910: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00017920: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00017930: 6772 6f75 7062 795f 6964 783a 204f 7074  groupby_idx: Opt
+00017940: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
+00017950: 652c 0a20 2020 2029 202d 3e20 6e70 2e6e  e,.    ) -> np.n
+00017960: 6461 7272 6179 3a0a 2020 2020 2020 2020  darray:.        
+00017970: 2222 220a 2020 2020 2020 2020 436f 6d70  """.        Comp
+00017980: 7574 6520 7468 6520 4d61 6861 6c61 6e6f  ute the Mahalano
+00017990: 6269 7320 6469 7374 616e 6365 7320 6f66  bis distances of
+000179a0: 2065 6163 6820 6f62 7365 7276 6174 696f   each observatio
+000179b0: 6e20 696e 2074 6865 2069 6e70 7574 2061  n in the input a
+000179c0: 7272 6179 2075 7369 6e67 2045 6c6c 6970  rray using Ellip
+000179d0: 7469 6320 456e 7665 6c6f 7065 206d 6574  tic Envelope met
+000179e0: 686f 642e 0a0a 2020 2020 2020 2020 2e2e  hod...        ..
+000179f0: 2069 6d61 6765 3a3a 205f 7374 6174 6963   image:: _static
+00017a00: 2f69 6d67 2f45 6c6c 6970 7469 6345 6e76  /img/EllipticEnv
+00017a10: 656c 6f70 652e 706e 670a 2020 2020 2020  elope.png.      
+00017a20: 2020 2020 203a 7769 6474 683a 2037 3030       :width: 700
+00017a30: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+00017a40: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
+00017a50: 2020 2020 2e2e 2069 6d61 6765 3a3a 205f      .. image:: _
+00017a60: 7374 6174 6963 2f69 6d67 2f65 6c6c 6970  static/img/ellip
+00017a70: 7469 635f 656e 7665 6c6f 7065 2e70 6e67  tic_envelope.png
+00017a80: 0a20 2020 2020 2020 2020 2020 3a77 6964  .           :wid
+00017a90: 7468 3a20 3730 300a 2020 2020 2020 2020  th: 700.        
+00017aa0: 2020 203a 616c 6967 6e3a 2063 656e 7465     :align: cente
+00017ab0: 720a 0a20 2020 2020 2020 203a 7061 7261  r..        :para
+00017ac0: 6d20 6461 7461 3a20 496e 7075 7420 6461  m data: Input da
+00017ad0: 7461 2061 7272 6179 206f 6620 7368 6170  ta array of shap
+00017ae0: 6520 286e 5f73 616d 706c 6573 2c20 6e5f  e (n_samples, n_
+00017af0: 6665 6174 7572 6573 292e 0a20 2020 2020  features)..     
+00017b00: 2020 203a 7061 7261 6d20 4f70 7469 6f6e     :param Option
+00017b10: 616c 5b66 6c6f 6174 5d20 636f 6e74 616d  al[float] contam
+00017b20: 696e 6174 696f 6e3a 2054 6865 2070 726f  ination: The pro
+00017b30: 706f 7274 696f 6e20 6f66 206f 7574 6c69  portion of outli
+00017b40: 6572 7320 746f 2062 6520 6173 7375 6d65  ers to be assume
+00017b50: 6420 696e 2074 6865 2064 6174 612e 2044  d in the data. D
+00017b60: 6566 6175 6c74 7320 746f 2030 2e31 2e0a  efaults to 0.1..
+00017b70: 2020 2020 2020 2020 3a70 6172 616d 204f          :param O
+00017b80: 7074 696f 6e61 6c5b 626f 6f6c 5d20 6e6f  ptional[bool] no
+00017b90: 726d 616c 697a 653a 2057 6865 7468 6572  rmalize: Whether
+00017ba0: 2074 6f20 6e6f 726d 616c 697a 6520 7468   to normalize th
+00017bb0: 6520 4d61 6861 6c61 6e6f 6269 7320 6469  e Mahalanobis di
+00017bc0: 7374 616e 6365 7320 6265 7477 6565 6e20  stances between 
+00017bd0: 3020 616e 6420 312e 2044 6566 6175 6c74  0 and 1. Default
+00017be0: 7320 746f 2054 7275 652e 0a20 2020 2020  s to True..     
+00017bf0: 2020 203a 7265 7475 726e 206e 702e 6e64     :return np.nd
+00017c00: 6172 7261 793a 2054 6865 204d 6168 616c  array: The Mahal
+00017c10: 616e 6f62 6973 2064 6973 7461 6e63 6573  anobis distances
+00017c20: 206f 6620 6561 6368 206f 6273 6572 7661   of each observa
+00017c30: 7469 6f6e 2069 6e20 6172 7261 792e 204c  tion in array. L
+00017c40: 6172 6765 7220 7661 6c75 6573 2069 6e64  arger values ind
+00017c50: 6963 6174 6520 6f75 746c 6965 7273 2e0a  icate outliers..
+00017c60: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
+00017c70: 653a 0a20 2020 2020 2020 203e 3e3e 2064  e:.        >>> d
+00017c80: 6174 612c 206c 626c 7320 3d20 6d61 6b65  ata, lbls = make
+00017c90: 5f62 6c6f 6273 286e 5f73 616d 706c 6573  _blobs(n_samples
+00017ca0: 3d32 3030 302c 206e 5f66 6561 7475 7265  =2000, n_feature
+00017cb0: 733d 322c 2063 656e 7465 7273 3d31 2c20  s=2, centers=1, 
+00017cc0: 7261 6e64 6f6d 5f73 7461 7465 3d34 3229  random_state=42)
+00017cd0: 0a20 2020 2020 2020 203e 3e3e 2065 6e76  .        >>> env
+00017ce0: 656c 6f70 655f 7363 6f72 6520 3d20 656c  elope_score = el
+00017cf0: 6c69 7074 6963 5f65 6e76 656c 6f70 6528  liptic_envelope(
+00017d00: 6461 7461 3d64 6174 612c 206e 6f72 6d61  data=data, norma
+00017d10: 6c69 7a65 3d54 7275 6529 0a20 2020 2020  lize=True).     
+00017d20: 2020 203e 3e3e 2072 6573 756c 7473 203d     >>> results =
+00017d30: 206e 702e 6873 7461 636b 2828 6461 7461   np.hstack((data
+00017d40: 5b3a 2c20 303a 325d 2c20 656e 7665 6c6f  [:, 0:2], envelo
+00017d50: 7065 5f73 636f 7265 2e72 6573 6861 7065  pe_score.reshape
+00017d60: 286c 6f66 2e73 6861 7065 5b30 5d2c 2031  (lof.shape[0], 1
+00017d70: 2929 290a 2020 2020 2020 2020 3e3e 3e20  ))).        >>> 
+00017d80: 7265 7375 6c74 7320 3d20 7064 2e44 6174  results = pd.Dat
+00017d90: 6146 7261 6d65 2872 6573 756c 7473 2c20  aFrame(results, 
+00017da0: 636f 6c75 6d6e 733d 5b27 5827 2c20 2759  columns=['X', 'Y
+00017db0: 272c 2027 454e 5645 4c4f 5045 2053 434f  ', 'ENVELOPE SCO
+00017dc0: 5245 275d 290a 2020 2020 2020 2020 3e3e  RE']).        >>
+00017dd0: 3e20 506c 6f74 7469 6e67 4d69 7869 6e2e  > PlottingMixin.
+00017de0: 636f 6e74 696e 756f 7573 5f73 6361 7474  continuous_scatt
+00017df0: 6572 2864 6174 613d 7265 7375 6c74 732c  er(data=results,
+00017e00: 2070 616c 6574 7465 3d27 7365 6973 6d69   palette='seismi
+00017e10: 6327 2c20 6267 5f63 6c72 3d27 6c69 6768  c', bg_clr='ligh
+00017e20: 7467 7265 7927 2c20 636f 6c75 6d6e 733d  tgrey', columns=
+00017e30: 5b27 5827 2c20 2759 272c 2027 454e 5645  ['X', 'Y', 'ENVE
+00017e40: 4c4f 5045 2053 434f 5245 275d 2c73 697a  LOPE SCORE'],siz
+00017e50: 653d 3330 290a 0a20 2020 2020 2020 2022  e=30)..        "
+00017e60: 2222 0a0a 2020 2020 2020 2020 6465 6620  ""..        def 
+00017e70: 6765 745f 656e 7665 6c6f 7065 2864 6174  get_envelope(dat
+00017e80: 612c 2063 6f6e 7461 6d69 6e61 7469 6f6e  a, contamination
+00017e90: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+00017ea0: 0a20 2020 2020 2020 2020 2020 206d 646c  .            mdl
+00017eb0: 203d 2045 6c6c 6970 7469 6345 6e76 656c   = EllipticEnvel
+00017ec0: 6f70 6528 636f 6e74 616d 696e 6174 696f  ope(contaminatio
+00017ed0: 6e3d 636f 6e74 616d 696e 6174 696f 6e29  n=contamination)
+00017ee0: 2e66 6974 2864 6174 6129 0a20 2020 2020  .fit(data).     
+00017ef0: 2020 2020 2020 2079 203d 202d 6d64 6c2e         y = -mdl.
+00017f00: 7363 6f72 655f 7361 6d70 6c65 7328 6461  score_samples(da
+00017f10: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
+00017f20: 6966 206e 6f72 6d61 6c69 7a65 3a0a 2020  if normalize:.  
+00017f30: 2020 2020 2020 2020 2020 2020 2020 7920                y 
+00017f40: 3d20 2879 202d 206e 702e 6d69 6e28 7929  = (y - np.min(y)
+00017f50: 2920 2f20 286e 702e 6d61 7828 7929 202d  ) / (np.max(y) -
+00017f60: 206e 702e 6d69 6e28 7929 290a 2020 2020   np.min(y)).    
+00017f70: 2020 2020 2020 2020 7265 7475 726e 2079          return y
+00017f80: 0a0a 2020 2020 2020 2020 6966 2067 726f  ..        if gro
+00017f90: 7570 6279 5f69 6478 2069 7320 6e6f 7420  upby_idx is not 
+00017fa0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00017fb0: 2020 6368 6563 6b5f 696e 7428 0a20 2020    check_int(.   
+00017fc0: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+00017fd0: 653d 6622 7b53 7461 7469 7374 6963 732e  e=f"{Statistics.
+00017fe0: 656c 6c69 7074 6963 5f65 6e76 656c 6f70  elliptic_envelop
+00017ff0: 652e 5f5f 6e61 6d65 5f5f 7d20 6772 6f75  e.__name__} grou
+00018000: 7062 795f 6964 7822 2c0a 2020 2020 2020  pby_idx",.      
+00018010: 2020 2020 2020 2020 2020 7661 6c75 653d            value=
+00018020: 6772 6f75 7062 795f 6964 782c 0a20 2020  groupby_idx,.   
+00018030: 2020 2020 2020 2020 2020 2020 206d 696e               min
+00018040: 5f76 616c 7565 3d30 2c0a 2020 2020 2020  _value=0,.      
+00018050: 2020 2020 2020 2020 2020 6d61 785f 7661            max_va
+00018060: 6c75 653d 6461 7461 2e73 6861 7065 5b31  lue=data.shape[1
+00018070: 5d20 2d20 312c 0a20 2020 2020 2020 2020  ] - 1,.         
+00018080: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00018090: 2063 6865 636b 5f76 616c 6964 5f61 7272   check_valid_arr
+000180a0: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
+000180b0: 2020 2020 736f 7572 6365 3d66 227b 5374      source=f"{St
+000180c0: 6174 6973 7469 6373 2e65 6c6c 6970 7469  atistics.ellipti
+000180d0: 635f 656e 7665 6c6f 7065 2e5f 5f6e 616d  c_envelope.__nam
+000180e0: 655f 5f7d 206c 6f63 616c 5f6f 7574 6c69  e__} local_outli
+000180f0: 6572 5f66 6163 746f 7222 2c0a 2020 2020  er_factor",.    
+00018100: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00018110: 3d64 6174 612c 0a20 2020 2020 2020 2020  =data,.         
+00018120: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+00018130: 7369 7a65 733d 5b32 5d2c 0a20 2020 2020  sizes=[2],.     
+00018140: 2020 2020 2020 2020 2020 206d 696e 5f61             min_a
+00018150: 7869 735f 313d 332c 0a20 2020 2020 2020  xis_1=3,.       
+00018160: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00018170: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00018180: 2063 6865 636b 5f76 616c 6964 5f61 7272   check_valid_arr
+00018190: 6179 280a 2020 2020 2020 2020 2020 2020  ay(.            
+000181a0: 2020 2020 736f 7572 6365 3d66 227b 5374      source=f"{St
+000181b0: 6174 6973 7469 6373 2e65 6c6c 6970 7469  atistics.ellipti
+000181c0: 635f 656e 7665 6c6f 7065 2e5f 5f6e 616d  c_envelope.__nam
+000181d0: 655f 5f7d 2064 6174 6122 2c0a 2020 2020  e__} data",.    
+000181e0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000181f0: 3d64 6174 612c 0a20 2020 2020 2020 2020  =data,.         
+00018200: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+00018210: 7369 7a65 733d 5b32 5d2c 0a20 2020 2020  sizes=[2],.     
+00018220: 2020 2020 2020 2020 2020 206d 696e 5f61             min_a
+00018230: 7869 735f 313d 322c 0a20 2020 2020 2020  xis_1=2,.       
+00018240: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00018250: 6368 6563 6b5f 666c 6f61 7428 0a20 2020  check_float(.   
+00018260: 2020 2020 2020 2020 206e 616d 653d 6622           name=f"
+00018270: 7b53 7461 7469 7374 6963 732e 656c 6c69  {Statistics.elli
+00018280: 7074 6963 5f65 6e76 656c 6f70 652e 5f5f  ptic_envelope.__
+00018290: 6e61 6d65 5f5f 7d20 636f 6e74 616d 696e  name__} contamin
+000182a0: 6174 696f 6e22 2c0a 2020 2020 2020 2020  ation",.        
+000182b0: 2020 2020 7661 6c75 653d 636f 6e74 616d      value=contam
+000182c0: 696e 6174 696f 6e2c 0a20 2020 2020 2020  ination,.       
+000182d0: 2020 2020 206d 696e 5f76 616c 7565 3d30       min_value=0
+000182e0: 2e30 2c0a 2020 2020 2020 2020 2020 2020  .0,.            
+000182f0: 6d61 785f 7661 6c75 653d 312e 302c 0a20  max_value=1.0,. 
+00018300: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00018310: 2069 6620 6772 6f75 7062 795f 6964 7820   if groupby_idx 
+00018320: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00018330: 2020 2020 2072 6574 7572 6e20 6765 745f       return get_
+00018340: 656e 7665 6c6f 7065 2864 6174 612c 2063  envelope(data, c
+00018350: 6f6e 7461 6d69 6e61 7469 6f6e 290a 2020  ontamination).  
+00018360: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00018370: 2020 2020 2020 2020 7265 7375 6c74 7320          results 
+00018380: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+00018390: 2064 6174 615f 775f 6964 7820 3d20 6e70   data_w_idx = np
+000183a0: 2e68 7374 6163 6b28 286e 702e 6172 616e  .hstack((np.aran
+000183b0: 6765 2830 2c20 6461 7461 2e73 6861 7065  ge(0, data.shape
+000183c0: 5b30 5d29 2e72 6573 6861 7065 282d 312c  [0]).reshape(-1,
+000183d0: 2031 292c 2064 6174 6129 290a 2020 2020   1), data)).    
+000183e0: 2020 2020 2020 2020 756e 6971 7565 5f63          unique_c
+000183f0: 203d 206e 702e 756e 6971 7565 2864 6174   = np.unique(dat
+00018400: 615b 3a2c 2067 726f 7570 6279 5f69 6478  a[:, groupby_idx
+00018410: 5d29 2e61 7374 7970 6528 6e70 2e66 6c6f  ]).astype(np.flo
+00018420: 6174 3332 290a 2020 2020 2020 2020 2020  at32).          
+00018430: 2020 6966 202d 312e 3020 696e 2075 6e69    if -1.0 in uni
+00018440: 7175 655f 633a 0a20 2020 2020 2020 2020  que_c:.         
+00018450: 2020 2020 2020 2075 6e69 7175 655f 6320         unique_c 
+00018460: 3d20 756e 6971 7565 5f63 5b6e 702e 7768  = unique_c[np.wh
+00018470: 6572 6528 756e 6971 7565 5f63 2021 3d20  ere(unique_c != 
+00018480: 2d31 295d 0a20 2020 2020 2020 2020 2020  -1)].           
+00018490: 2020 2020 2075 6e63 6c75 7374 6572 6564       unclustered
+000184a0: 5f69 6478 203d 206e 702e 6172 6777 6865  _idx = np.argwhe
+000184b0: 7265 2864 6174 615b 3a2c 2067 726f 7570  re(data[:, group
+000184c0: 6279 5f69 6478 5d20 3d3d 202d 312e 3029  by_idx] == -1.0)
+000184d0: 2e66 6c61 7474 656e 2829 0a20 2020 2020  .flatten().     
+000184e0: 2020 2020 2020 2020 2020 2075 6e63 6c75             unclu
+000184f0: 7374 6572 6564 203d 2064 6174 615f 775f  stered = data_w_
+00018500: 6964 785b 756e 636c 7573 7465 7265 645f  idx[unclustered_
+00018510: 6964 785d 0a20 2020 2020 2020 2020 2020  idx].           
+00018520: 2020 2020 2064 6174 615f 775f 6964 7820       data_w_idx 
+00018530: 3d20 6e70 2e64 656c 6574 6528 6461 7461  = np.delete(data
+00018540: 5f77 5f69 6478 2c20 756e 636c 7573 7465  _w_idx, uncluste
+00018550: 7265 645f 6964 782c 2061 7869 733d 3029  red_idx, axis=0)
+00018560: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00018570: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00018580: 2020 2075 6e63 6c75 7374 6572 6564 203d     unclustered =
+00018590: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+000185a0: 2020 666f 7220 6920 696e 2075 6e69 7175    for i in uniqu
+000185b0: 655f 633a 0a20 2020 2020 2020 2020 2020  e_c:.           
+000185c0: 2020 2020 2073 5f64 6174 6120 3d20 6461       s_data = da
+000185d0: 7461 5f77 5f69 6478 5b0a 2020 2020 2020  ta_w_idx[.      
+000185e0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+000185f0: 2e61 7267 7768 6572 6528 6461 7461 5f77  .argwhere(data_w
+00018600: 5f69 6478 5b3a 2c20 6772 6f75 7062 795f  _idx[:, groupby_
+00018610: 6964 7820 2b20 315d 203d 3d20 6929 0a20  idx + 1] == i). 
+00018620: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00018630: 2e72 6573 6861 7065 282d 312c 2064 6174  .reshape(-1, dat
+00018640: 615f 775f 6964 782e 7368 6170 655b 315d  a_w_idx.shape[1]
+00018650: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00018660: 2020 6964 7820 3d20 735f 6461 7461 5b3a    idx = s_data[:
+00018670: 2c20 305d 2e72 6573 6861 7065 2873 5f64  , 0].reshape(s_d
+00018680: 6174 612e 7368 6170 655b 305d 2c20 3129  ata.shape[0], 1)
+00018690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000186a0: 2073 5f64 6174 6120 3d20 6e70 2e64 656c   s_data = np.del
+000186b0: 6574 6528 735f 6461 7461 2c20 5b30 2c20  ete(s_data, [0, 
+000186c0: 6772 6f75 7062 795f 6964 7820 2b20 315d  groupby_idx + 1]
+000186d0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
+000186e0: 2020 2020 206c 6f66 203d 2067 6574 5f65       lof = get_e
+000186f0: 6e76 656c 6f70 6528 735f 6461 7461 2c20  nvelope(s_data, 
+00018700: 636f 6e74 616d 696e 6174 696f 6e29 2e72  contamination).r
+00018710: 6573 6861 7065 2873 5f64 6174 612e 7368  eshape(s_data.sh
+00018720: 6170 655b 305d 2c20 3129 0a20 2020 2020  ape[0], 1).     
+00018730: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00018740: 7473 2e61 7070 656e 6428 6e70 2e68 7374  ts.append(np.hst
+00018750: 6163 6b28 2869 6478 2c20 6c6f 6629 2929  ack((idx, lof)))
+00018760: 0a20 2020 2020 2020 2020 2020 2078 203d  .            x =
+00018770: 206e 702e 636f 6e63 6174 656e 6174 6528   np.concatenate(
+00018780: 7265 7375 6c74 732c 2061 7869 733d 3029  results, axis=0)
+00018790: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000187a0: 756e 636c 7573 7465 7265 6420 6973 206e  unclustered is n
+000187b0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000187c0: 2020 2020 2020 2020 206d 6178 5f65 6e76           max_env
+000187d0: 5f73 636f 7265 203d 206e 702e 6675 6c6c  _score = np.full
+000187e0: 2828 756e 636c 7573 7465 7265 642e 7368  ((unclustered.sh
+000187f0: 6170 655b 305d 2c20 3129 2c20 6e70 2e6d  ape[0], 1), np.m
+00018800: 6178 2878 5b3a 2c20 2d31 5d29 290a 2020  ax(x[:, -1])).  
+00018810: 2020 2020 2020 2020 2020 2020 2020 756e                un
+00018820: 636c 7573 7465 7265 6420 3d20 6e70 2e68  clustered = np.h
+00018830: 7374 6163 6b28 2875 6e63 6c75 7374 6572  stack((uncluster
+00018840: 6564 2c20 6d61 785f 656e 765f 7363 6f72  ed, max_env_scor
+00018850: 6529 295b 3a2c 205b 302c 202d 315d 5d0a  e))[:, [0, -1]].
+00018860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018870: 7820 3d20 6e70 2e76 7374 6163 6b28 2878  x = np.vstack((x
+00018880: 2c20 756e 636c 7573 7465 7265 6429 290a  , unclustered)).
+00018890: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000188a0: 726e 2078 5b6e 702e 6172 6773 6f72 7428  rn x[np.argsort(
+000188b0: 785b 3a2c 2030 5d29 5d5b 3a2c 202d 315d  x[:, 0])][:, -1]
+000188c0: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+000188d0: 686f 640a 2020 2020 6465 6620 6973 6f6c  hod.    def isol
+000188e0: 6174 696f 6e5f 666f 7265 7374 280a 2020  ation_forest(.  
+000188f0: 2020 2020 2020 783a 206e 702e 6e64 6172        x: np.ndar
+00018900: 7261 792c 0a20 2020 2020 2020 2065 7374  ray,.        est
+00018910: 696d 6174 6f72 733a 2055 6e69 6f6e 5b69  imators: Union[i
+00018920: 6e74 2c20 666c 6f61 745d 203d 2030 2e32  nt, float] = 0.2
+00018930: 2c0a 2020 2020 2020 2020 6772 6f75 7062  ,.        groupb
+00018940: 795f 6964 783a 204f 7074 696f 6e61 6c5b  y_idx: Optional[
+00018950: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+00018960: 2020 2020 206e 6f72 6d61 6c69 7a65 3a20       normalize: 
+00018970: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00018980: 2046 616c 7365 2c0a 2020 2020 293a 0a20   False,.    ):. 
+00018990: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000189a0: 2020 2041 6e20 696d 706c 656d 656e 7461     An implementa
+000189b0: 7469 6f6e 206f 6620 7468 6520 4973 6f6c  tion of the Isol
+000189c0: 6174 696f 6e20 466f 7265 7374 2061 6c67  ation Forest alg
+000189d0: 6f72 6974 686d 2066 6f72 206f 7574 6c69  orithm for outli
+000189e0: 6572 2064 6574 6563 7469 6f6e 2e0a 0a20  er detection... 
+000189f0: 2020 2020 2020 202e 2e20 696d 6167 653a         .. image:
+00018a00: 3a20 5f73 7461 7469 632f 696d 672f 6973  : _static/img/is
+00018a10: 6f6c 6174 696f 6e5f 666f 7265 7374 2e70  olation_forest.p
+00018a20: 6e67 2e70 6e67 0a20 2020 2020 2020 2020  ng.png.         
+00018a30: 2020 3a77 6964 7468 3a20 3730 300a 2020    :width: 700.  
+00018a40: 2020 2020 2020 2020 203a 616c 6967 6e3a           :align:
+00018a50: 2063 656e 7465 720a 0a20 2020 2020 2020   center..       
+00018a60: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
+00018a70: 2020 2020 2020 5468 6520 6973 6f6c 6174        The isolat
+00018a80: 696f 6e20 666f 7265 7374 2073 636f 7265  ion forest score
+00018a90: 7320 6172 6520 6e65 6761 7465 642e 2054  s are negated. T
+00018aa0: 6875 732c 2068 6967 6865 7220 7661 6c75  hus, higher valu
+00018ab0: 6573 2069 6e64 6963 6174 6520 6d6f 7265  es indicate more
+00018ac0: 2061 7479 7069 6361 6c20 286f 7574 6c69   atypical (outli
+00018ad0: 6572 2920 6461 7461 2070 6f69 6e74 732e  er) data points.
+00018ae0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00018af0: 206e 702e 6e64 6172 7261 7920 783a 2032   np.ndarray x: 2
+00018b00: 2d44 2061 7272 6179 2077 6974 6820 6665  -D array with fe
+00018b10: 6174 7572 6520 7661 6c75 6573 2e0a 2020  ature values..  
+00018b20: 2020 2020 2020 3a70 6172 616d 2055 6e69        :param Uni
+00018b30: 6f6e 5b69 6e74 2c20 666c 6f61 745d 2065  on[int, float] e
+00018b40: 7374 696d 6174 6f72 733a 204e 756d 6265  stimators: Numbe
+00018b50: 7220 6f66 2073 706c 6974 732e 2049 6620  r of splits. If 
+00018b60: 7468 6520 7661 6c75 6520 6973 2061 2066  the value is a f
+00018b70: 6c6f 6174 2c20 7468 656e 2069 6e74 6572  loat, then inter
+00018b80: 7072 6574 6564 2061 7320 7468 6520 7261  preted as the ra
+00018b90: 7469 6f20 6f66 2078 2073 6861 7065 2e0a  tio of x shape..
+00018ba0: 2020 2020 2020 2020 3a70 6172 616d 204f          :param O
+00018bb0: 7074 696f 6e61 6c5b 696e 745d 2067 726f  ptional[int] gro
+00018bc0: 7570 6279 5f69 6478 3a20 4966 2069 6e74  upby_idx: If int
+00018bd0: 2c20 7468 656e 2074 6865 2069 6e64 6578  , then the index
+00018be0: 2031 206f 6620 6060 6461 7461 6060 2066   1 of ``data`` f
+00018bf0: 6f72 2077 6869 6368 2074 6f20 6772 6f75  or which to grou
+00018c00: 7020 7468 6520 6461 7461 2061 6e64 2063  p the data and c
+00018c10: 6f6d 7075 7465 204c 4f46 206f 6e20 6561  ompute LOF on ea
+00018c20: 6368 2073 6567 6d65 6e74 2e20 452e 672e  ch segment. E.g.
+00018c30: 2c20 6361 6e20 6265 2066 6965 6c64 2068  , can be field h
+00018c40: 6f6c 6469 6e67 2061 2063 6c75 7374 6572  olding a cluster
+00018c50: 2069 6465 6e74 6966 6965 722e 0a20 2020   identifier..   
+00018c60: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+00018c70: 6f6e 616c 5b62 6f6f 6c5d 206e 6f72 6d61  onal[bool] norma
+00018c80: 6c69 7a65 3a20 5768 6574 6865 7220 746f  lize: Whether to
+00018c90: 206e 6f72 6d61 6c69 7a65 2074 6865 206f   normalize the o
+00018ca0: 7574 6c69 6572 2073 636f 7265 2062 6574  utlier score bet
+00018cb0: 7765 656e 2030 2061 6e64 2031 2e20 4465  ween 0 and 1. De
+00018cc0: 6661 756c 7473 2074 6f20 4661 6c73 652e  faults to False.
+00018cd0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00018ce0: 3a0a 0a20 2020 2020 2020 203a 6578 616d  :..        :exam
+00018cf0: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00018d00: 2078 2c20 6c62 6c73 203d 206d 616b 655f   x, lbls = make_
+00018d10: 626c 6f62 7328 6e5f 7361 6d70 6c65 733d  blobs(n_samples=
+00018d20: 3130 3030 302c 206e 5f66 6561 7475 7265  10000, n_feature
+00018d30: 733d 322c 2063 656e 7465 7273 3d31 302c  s=2, centers=10,
+00018d40: 2072 616e 646f 6d5f 7374 6174 653d 3432   random_state=42
+00018d50: 290a 2020 2020 2020 2020 3e3e 3e20 7820  ).        >>> x 
+00018d60: 3d20 6e70 2e68 7374 6163 6b28 2878 2c20  = np.hstack((x, 
+00018d70: 6c62 6c73 2e72 6573 6861 7065 282d 312c  lbls.reshape(-1,
+00018d80: 2031 2929 290a 2020 2020 2020 2020 3e3e   1))).        >>
+00018d90: 3e20 7363 6f72 6573 203d 2069 736f 6c61  > scores = isola
+00018da0: 7469 6f6e 5f66 6f72 6573 7428 783d 782c  tion_forest(x=x,
+00018db0: 2065 7374 696d 6174 6f72 733d 3130 2c20   estimators=10, 
+00018dc0: 6e6f 726d 616c 697a 653d 5472 7565 290a  normalize=True).
+00018dd0: 2020 2020 2020 2020 3e3e 3e20 7265 7375          >>> resu
+00018de0: 6c74 7320 3d20 6e70 2e68 7374 6163 6b28  lts = np.hstack(
+00018df0: 2878 5b3a 2c20 303a 325d 2c20 7363 6f72  (x[:, 0:2], scor
+00018e00: 6573 2e72 6573 6861 7065 2873 636f 7265  es.reshape(score
+00018e10: 732e 7368 6170 655b 305d 2c20 3129 2929  s.shape[0], 1)))
+00018e20: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+00018e30: 756c 7473 203d 2070 642e 4461 7461 4672  ults = pd.DataFr
+00018e40: 616d 6528 7265 7375 6c74 732c 2063 6f6c  ame(results, col
+00018e50: 756d 6e73 3d5b 2758 272c 2027 5927 2c20  umns=['X', 'Y', 
+00018e60: 2749 534f 4c41 5449 4f4e 2053 434f 5245  'ISOLATION SCORE
+00018e70: 275d 290a 2020 2020 2020 2020 3e3e 3e20  ']).        >>> 
+00018e80: 506c 6f74 7469 6e67 4d69 7869 6e2e 636f  PlottingMixin.co
+00018e90: 6e74 696e 756f 7573 5f73 6361 7474 6572  ntinuous_scatter
+00018ea0: 2864 6174 613d 7265 7375 6c74 732c 2070  (data=results, p
+00018eb0: 616c 6574 7465 3d27 7365 6973 6d69 6327  alette='seismic'
+00018ec0: 2c20 6267 5f63 6c72 3d27 6c69 6768 7467  , bg_clr='lightg
+00018ed0: 7265 7927 2c20 636f 6c75 6d6e 733d 5b27  rey', columns=['
+00018ee0: 5827 2c20 2759 272c 2027 4953 4f4c 4154  X', 'Y', 'ISOLAT
+00018ef0: 494f 4e20 5343 4f52 4527 5d2c 7369 7a65  ION SCORE'],size
+00018f00: 3d33 3029 0a0a 2020 2020 2020 2020 2222  =30)..        ""
+00018f10: 220a 0a20 2020 2020 2020 2064 6566 2067  "..        def g
+00018f20: 6574 5f69 665f 7363 6f72 6573 2878 3a20  et_if_scores(x: 
+00018f30: 6e70 2e6e 6461 7272 6179 2c20 6573 7469  np.ndarray, esti
+00018f40: 6d61 746f 7273 3a20 6573 7469 6d61 746f  mators: estimato
+00018f50: 7273 293a 0a20 2020 2020 2020 2020 2020  rs):.           
+00018f60: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
+00018f70: 7374 696d 6174 6f72 732c 2066 6c6f 6174  stimators, float
+00018f80: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00018f90: 2020 2063 6865 636b 5f66 6c6f 6174 280a     check_float(.
+00018fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018fb0: 2020 2020 6e61 6d65 3d66 227b 5374 6174      name=f"{Stat
+00018fc0: 6973 7469 6373 2e69 736f 6c61 7469 6f6e  istics.isolation
+00018fd0: 5f66 6f72 6573 742e 5f5f 6e61 6d65 5f5f  _forest.__name__
+00018fe0: 7d20 6573 7469 6d61 746f 7273 222c 0a20  } estimators",. 
+00018ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019000: 2020 2076 616c 7565 3d65 7374 696d 6174     value=estimat
+00019010: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
+00019020: 2020 2020 2020 2020 206d 696e 5f76 616c           min_val
+00019030: 7565 3d31 3065 2d36 2c0a 2020 2020 2020  ue=10e-6,.      
+00019040: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00019050: 785f 7661 6c75 653d 312e 302c 0a20 2020  x_value=1.0,.   
+00019060: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00019070: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00019080: 7374 696d 6174 6f72 7320 3d20 782e 7368  stimators = x.sh
+00019090: 6170 655b 305d 202a 2065 7374 696d 6174  ape[0] * estimat
+000190a0: 6f72 730a 2020 2020 2020 2020 2020 2020  ors.            
+000190b0: 2020 2020 6966 2065 7374 696d 6174 6f72      if estimator
+000190c0: 7320 3c20 313a 0a20 2020 2020 2020 2020  s < 1:.         
+000190d0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+000190e0: 6174 6f72 7320 3d20 310a 2020 2020 2020  ators = 1.      
+000190f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00019100: 2020 2020 2020 2020 2020 2020 6368 6563              chec
+00019110: 6b5f 696e 7428 0a20 2020 2020 2020 2020  k_int(.         
+00019120: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00019130: 6622 7b53 7461 7469 7374 6963 732e 6973  f"{Statistics.is
+00019140: 6f6c 6174 696f 6e5f 666f 7265 7374 2e5f  olation_forest._
+00019150: 5f6e 616d 655f 5f2e 5f5f 6e61 6d65 5f5f  _name__.__name__
+00019160: 7d20 6573 7469 6d61 746f 7273 222c 0a20  } estimators",. 
+00019170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019180: 2020 2076 616c 7565 3d65 7374 696d 6174     value=estimat
+00019190: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
+000191a0: 2020 2020 2020 2020 206d 696e 5f76 616c           min_val
+000191b0: 7565 3d31 2c0a 2020 2020 2020 2020 2020  ue=1,.          
+000191c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000191d0: 2020 2020 6d64 6c20 3d20 4973 6f6c 6174      mdl = Isolat
+000191e0: 696f 6e46 6f72 6573 7428 0a20 2020 2020  ionForest(.     
+000191f0: 2020 2020 2020 2020 2020 206e 5f65 7374             n_est
+00019200: 696d 6174 6f72 733d 6573 7469 6d61 746f  imators=estimato
+00019210: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+00019220: 2020 2020 6e5f 6a6f 6273 3d2d 312c 0a20      n_jobs=-1,. 
+00019230: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00019240: 6568 6176 696f 7572 3d22 6e65 7722 2c0a  ehaviour="new",.
+00019250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019260: 636f 6e74 616d 696e 6174 696f 6e3d 2261  contamination="a
+00019270: 7574 6f22 2c0a 2020 2020 2020 2020 2020  uto",.          
+00019280: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00019290: 7220 3d20 6162 7328 6d64 6c2e 6669 7428  r = abs(mdl.fit(
+000192a0: 7829 2e73 636f 7265 5f73 616d 706c 6573  x).score_samples
+000192b0: 2878 2929 0a20 2020 2020 2020 2020 2020  (x)).           
+000192c0: 2069 6620 6e6f 726d 616c 697a 653a 0a20   if normalize:. 
+000192d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000192e0: 203d 2028 7220 2d20 6e70 2e6d 696e 2872   = (r - np.min(r
+000192f0: 2929 202f 2028 6e70 2e6d 6178 2872 2920  )) / (np.max(r) 
+00019300: 2d20 6e70 2e6d 696e 2872 2929 0a20 2020  - np.min(r)).   
+00019310: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00019320: 720a 0a20 2020 2020 2020 2069 6620 6772  r..        if gr
+00019330: 6f75 7062 795f 6964 7820 6973 204e 6f6e  oupby_idx is Non
+00019340: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+00019350: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+00019360: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00019370: 2020 6461 7461 3d78 2c0a 2020 2020 2020    data=x,.      
+00019380: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00019390: 3d53 7461 7469 7374 6963 732e 6973 6f6c  =Statistics.isol
+000193a0: 6174 696f 6e5f 666f 7265 7374 2e5f 5f6e  ation_forest.__n
+000193b0: 616d 655f 5f2e 5f5f 6e61 6d65 5f5f 2c0a  ame__.__name__,.
+000193c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000193d0: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
+000193e0: 322c 292c 0a20 2020 2020 2020 2020 2020  2,),.           
+000193f0: 2020 2020 206d 696e 5f61 7869 735f 313d       min_axis_1=
+00019400: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
+00019410: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+00019420: 6573 3d28 0a20 2020 2020 2020 2020 2020  es=(.           
+00019430: 2020 2020 2020 2020 206e 702e 696e 7436           np.int6
+00019440: 342c 0a20 2020 2020 2020 2020 2020 2020  4,.             
+00019450: 2020 2020 2020 206e 702e 696e 7433 322c         np.int32,
+00019460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019470: 2020 2020 206e 702e 696e 7438 2c0a 2020       np.int8,.  
+00019480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019490: 2020 6e70 2e66 6c6f 6174 3332 2c0a 2020    np.float32,.  
+000194a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000194b0: 2020 6e70 2e66 6c6f 6174 3634 2c0a 2020    np.float64,.  
+000194c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000194d0: 2020 696e 742c 0a20 2020 2020 2020 2020    int,.         
+000194e0: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
+000194f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00019500: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00019510: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00019520: 6574 7572 6e20 6765 745f 6966 5f73 636f  eturn get_if_sco
+00019530: 7265 7328 783d 782c 2065 7374 696d 6174  res(x=x, estimat
+00019540: 6f72 733d 6573 7469 6d61 746f 7273 290a  ors=estimators).
+00019550: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00019560: 2020 2020 2020 2020 2020 2063 6865 636b             check
+00019570: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
+00019580: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00019590: 7461 3d78 2c0a 2020 2020 2020 2020 2020  ta=x,.          
+000195a0: 2020 2020 2020 736f 7572 6365 3d53 7461        source=Sta
+000195b0: 7469 7374 6963 732e 6973 6f6c 6174 696f  tistics.isolatio
+000195c0: 6e5f 666f 7265 7374 2e5f 5f6e 616d 655f  n_forest.__name_
+000195d0: 5f2e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  _.__name__,.    
+000195e0: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+000195f0: 7074 6564 5f6e 6469 6d73 3d28 322c 292c  pted_ndims=(2,),
+00019600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019610: 206d 696e 5f61 7869 735f 313d 332c 0a20   min_axis_1=3,. 
+00019620: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00019630: 6363 6570 7465 645f 6474 7970 6573 3d28  ccepted_dtypes=(
+00019640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019650: 2020 2020 206e 702e 696e 7436 342c 0a20       np.int64,. 
+00019660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019670: 2020 206e 702e 696e 7433 322c 0a20 2020     np.int32,.   
+00019680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019690: 206e 702e 696e 7438 2c0a 2020 2020 2020   np.int8,.      
+000196a0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+000196b0: 2e66 6c6f 6174 3332 2c0a 2020 2020 2020  .float32,.      
+000196c0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+000196d0: 2e66 6c6f 6174 3634 2c0a 2020 2020 2020  .float64,.      
+000196e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000196f0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00019700: 2020 2020 2020 2066 6c6f 6174 2c0a 2020         float,.  
+00019710: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+00019720: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00019730: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00019740: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+00019750: 2020 2020 6461 7461 5f77 5f69 6478 203d      data_w_idx =
+00019760: 206e 702e 6873 7461 636b 2828 6e70 2e61   np.hstack((np.a
+00019770: 7261 6e67 6528 302c 2078 2e73 6861 7065  range(0, x.shape
+00019780: 5b30 5d29 2e72 6573 6861 7065 282d 312c  [0]).reshape(-1,
+00019790: 2031 292c 2078 2929 0a20 2020 2020 2020   1), x)).       
+000197a0: 2020 2020 2075 6e69 7175 655f 6320 3d20       unique_c = 
+000197b0: 6e70 2e75 6e69 7175 6528 785b 3a2c 2067  np.unique(x[:, g
+000197c0: 726f 7570 6279 5f69 6478 5d29 2e61 7374  roupby_idx]).ast
+000197d0: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+000197e0: 2020 2020 2020 2020 2020 2020 6966 202d              if -
+000197f0: 312e 3020 696e 2075 6e69 7175 655f 633a  1.0 in unique_c:
+00019800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019810: 2075 6e69 7175 655f 6320 3d20 756e 6971   unique_c = uniq
+00019820: 7565 5f63 5b6e 702e 7768 6572 6528 756e  ue_c[np.where(un
+00019830: 6971 7565 5f63 2021 3d20 2d31 295d 0a20  ique_c != -1)]. 
+00019840: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00019850: 6e63 6c75 7374 6572 6564 5f69 6478 203d  nclustered_idx =
+00019860: 206e 702e 6172 6777 6865 7265 2878 5b3a   np.argwhere(x[:
+00019870: 2c20 6772 6f75 7062 795f 6964 785d 203d  , groupby_idx] =
+00019880: 3d20 2d31 2e30 292e 666c 6174 7465 6e28  = -1.0).flatten(
+00019890: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000198a0: 2020 756e 636c 7573 7465 7265 6420 3d20    unclustered = 
+000198b0: 6461 7461 5f77 5f69 6478 5b75 6e63 6c75  data_w_idx[unclu
+000198c0: 7374 6572 6564 5f69 6478 5d0a 2020 2020  stered_idx].    
+000198d0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000198e0: 5f77 5f69 6478 203d 206e 702e 6465 6c65  _w_idx = np.dele
+000198f0: 7465 2864 6174 615f 775f 6964 782c 2075  te(data_w_idx, u
+00019900: 6e63 6c75 7374 6572 6564 5f69 6478 2c20  nclustered_idx, 
+00019910: 6178 6973 3d30 290a 2020 2020 2020 2020  axis=0).        
+00019920: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00019930: 2020 2020 2020 2020 2020 756e 636c 7573            unclus
+00019940: 7465 7265 6420 3d20 4e6f 6e65 0a20 2020  tered = None.   
+00019950: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+00019960: 6e20 756e 6971 7565 5f63 3a0a 2020 2020  n unique_c:.    
+00019970: 2020 2020 2020 2020 2020 2020 735f 6461              s_da
+00019980: 7461 203d 2064 6174 615f 775f 6964 785b  ta = data_w_idx[
+00019990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000199a0: 2020 2020 206e 702e 6172 6777 6865 7265       np.argwhere
+000199b0: 2864 6174 615f 775f 6964 785b 3a2c 2067  (data_w_idx[:, g
+000199c0: 726f 7570 6279 5f69 6478 202b 2031 5d20  roupby_idx + 1] 
+000199d0: 3d3d 2069 290a 2020 2020 2020 2020 2020  == i).          
+000199e0: 2020 2020 2020 5d2e 7265 7368 6170 6528        ].reshape(
+000199f0: 2d31 2c20 6461 7461 5f77 5f69 6478 2e73  -1, data_w_idx.s
+00019a00: 6861 7065 5b31 5d29 0a20 2020 2020 2020  hape[1]).       
+00019a10: 2020 2020 2020 2020 2069 6478 203d 2073           idx = s
+00019a20: 5f64 6174 615b 3a2c 2030 5d2e 7265 7368  _data[:, 0].resh
+00019a30: 6170 6528 735f 6461 7461 2e73 6861 7065  ape(s_data.shape
+00019a40: 5b30 5d2c 2031 290a 2020 2020 2020 2020  [0], 1).        
+00019a50: 2020 2020 2020 2020 735f 6461 7461 203d          s_data =
+00019a60: 206e 702e 6465 6c65 7465 2873 5f64 6174   np.delete(s_dat
+00019a70: 612c 205b 302c 2067 726f 7570 6279 5f69  a, [0, groupby_i
+00019a80: 6478 202b 2031 5d2c 2031 290a 2020 2020  dx + 1], 1).    
+00019a90: 2020 2020 2020 2020 2020 2020 695f 6620              i_f 
+00019aa0: 3d20 6765 745f 6966 5f73 636f 7265 7328  = get_if_scores(
+00019ab0: 735f 6461 7461 2c20 6573 7469 6d61 746f  s_data, estimato
+00019ac0: 7273 292e 7265 7368 6170 6528 735f 6461  rs).reshape(s_da
+00019ad0: 7461 2e73 6861 7065 5b30 5d2c 2031 290a  ta.shape[0], 1).
+00019ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019af0: 7265 7375 6c74 732e 6170 7065 6e64 286e  results.append(n
+00019b00: 702e 6873 7461 636b 2828 6964 782c 2069  p.hstack((idx, i
+00019b10: 5f66 2929 290a 2020 2020 2020 2020 2020  _f))).          
+00019b20: 2020 7820 3d20 6e70 2e63 6f6e 6361 7465    x = np.concate
+00019b30: 6e61 7465 2872 6573 756c 7473 2c20 6178  nate(results, ax
+00019b40: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
+00019b50: 2020 6966 2075 6e63 6c75 7374 6572 6564    if unclustered
+00019b60: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00019b70: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00019b80: 785f 6966 203d 206e 702e 6675 6c6c 2828  x_if = np.full((
+00019b90: 756e 636c 7573 7465 7265 642e 7368 6170  unclustered.shap
+00019ba0: 655b 305d 2c20 3129 2c20 6e70 2e6d 6178  e[0], 1), np.max
+00019bb0: 2878 5b3a 2c20 2d31 5d29 290a 2020 2020  (x[:, -1])).    
+00019bc0: 2020 2020 2020 2020 2020 2020 756e 636c              uncl
+00019bd0: 7573 7465 7265 6420 3d20 6e70 2e68 7374  ustered = np.hst
+00019be0: 6163 6b28 2875 6e63 6c75 7374 6572 6564  ack((unclustered
+00019bf0: 2c20 6d61 785f 6966 2929 5b3a 2c20 5b30  , max_if))[:, [0
+00019c00: 2c20 2d31 5d5d 0a20 2020 2020 2020 2020  , -1]].         
+00019c10: 2020 2020 2020 2078 203d 206e 702e 7673         x = np.vs
+00019c20: 7461 636b 2828 782c 2075 6e63 6c75 7374  tack((x, unclust
+00019c30: 6572 6564 2929 0a20 2020 2020 2020 2020  ered)).         
+00019c40: 2020 2072 6574 7572 6e20 785b 6e70 2e61     return x[np.a
+00019c50: 7267 736f 7274 2878 5b3a 2c20 305d 295d  rgsort(x[:, 0])]
+00019c60: 5b3a 2c20 2d31 5d0a 0a20 2020 2040 7374  [:, -1]..    @st
+00019c70: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
+00019c80: 6a69 7428 6e6f 7079 7468 6f6e 3d54 7275  jit(nopython=Tru
+00019c90: 6529 0a20 2020 2064 6566 205f 6862 6f73  e).    def _hbos
+00019ca0: 5f63 6f6d 7075 7465 280a 2020 2020 2020  _compute(.      
+00019cb0: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
+00019cc0: 6179 2c20 6869 7374 6f67 7261 6d73 3a20  ay, histograms: 
+00019cd0: 7479 7065 642e 4469 6374 2c20 6869 7374  typed.Dict, hist
+00019ce0: 6f67 7261 6d5f 6564 6765 733a 2074 7970  ogram_edges: typ
+00019cf0: 6564 2e44 6963 740a 2020 2020 2920 2d3e  ed.Dict.    ) ->
+00019d00: 206e 702e 6e64 6172 7261 793a 0a20 2020   np.ndarray:.   
+00019d10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00019d20: 204a 6974 7465 6420 6865 6c70 6572 2074   Jitted helper t
+00019d30: 6f20 636f 6d70 7574 6520 4869 7374 6f67  o compute Histog
+00019d40: 7261 6d2d 6261 7365 6420 4f75 746c 6965  ram-based Outlie
+00019d50: 7220 5363 6f72 6520 2848 424f 5329 2063  r Score (HBOS) c
+00019d60: 616c 6c65 6420 6279 2060 6073 696d 6261  alled by ``simba
+00019d70: 2e6d 6978 696e 732e 7374 6174 6973 7469  .mixins.statisti
+00019d80: 6373 5f6d 6978 696e 2e53 7461 7469 7374  cs_mixin.Statist
+00019d90: 6963 732e 6862 6f73 6060 2e0a 0a20 2020  ics.hbos``...   
+00019da0: 2020 2020 203a 7061 7261 6d65 7465 7220       :parameter 
+00019db0: 6e70 2e6e 6461 7272 6179 2064 6174 613a  np.ndarray data:
+00019dc0: 2032 6420 6172 7261 7920 7769 7468 2066   2d array with f
+00019dd0: 7261 6d65 7320 7265 7072 6573 656e 7465  rames represente
+00019de0: 6420 6279 2072 6f77 7320 616e 6420 636f  d by rows and co
+00019df0: 6c75 6d6e 7320 7265 7072 6573 656e 7469  lumns representi
+00019e00: 6e67 2066 6561 7475 7265 2076 616c 7565  ng feature value
+00019e10: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00019e20: 6d65 7465 7220 7479 7065 642e 4469 6374  meter typed.Dict
+00019e30: 2068 6973 746f 6772 616d 733a 204e 756d   histograms: Num
+00019e40: 6261 2074 7970 6564 2e44 6963 7420 7769  ba typed.Dict wi
+00019e50: 7468 2069 6e74 6567 6572 206b 6579 7320  th integer keys 
+00019e60: 2872 6570 7265 7365 6e74 696e 6720 6f72  (representing or
+00019e70: 6465 7220 6f66 2066 6561 7475 7265 2920  der of feature) 
+00019e80: 616e 6420 3164 2061 7272 6179 7320 6173  and 1d arrays as
+00019e90: 2076 616c 7565 7320 7265 7072 6573 656e   values represen
+00019ea0: 7469 6e67 206f 6273 6572 7661 7469 6f6e  ting observation
+00019eb0: 2062 696e 2063 6f75 6e74 732e 0a20 2020   bin counts..   
+00019ec0: 2020 2020 203a 7061 7261 6d65 7465 723a       :parameter:
+00019ed0: 2074 7970 6564 2e44 6963 7420 6869 7374   typed.Dict hist
+00019ee0: 6f67 7261 6d5f 6564 6765 733a 204e 756d  ogram_edges: Num
+00019ef0: 6261 2074 7970 6564 2e44 6963 7420 7769  ba typed.Dict wi
+00019f00: 7468 2069 6e74 6567 6572 206b 6579 7320  th integer keys 
+00019f10: 2872 6570 7265 7365 6e74 696e 6720 6f72  (representing or
+00019f20: 6465 7220 6f66 2066 6561 7475 7265 2920  der of feature) 
+00019f30: 616e 6420 3164 2061 7272 6179 7320 6173  and 1d arrays as
+00019f40: 2076 616c 7565 7320 7265 7072 6573 656e   values represen
+00019f50: 7469 6e67 2062 696e 2065 6467 6573 2e0a  ting bin edges..
+00019f60: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+00019f70: 6e70 2e6e 6461 7272 6179 3a20 4172 7261  np.ndarray: Arra
+00019f80: 7920 6f66 2073 697a 6520 6461 7461 2e73  y of size data.s
+00019f90: 6861 7065 5b30 5d20 7265 7072 6573 656e  hape[0] represen
+00019fa0: 7469 6e67 206f 7574 6c69 6572 2073 636f  ting outlier sco
+00019fb0: 7265 732c 2077 6974 6820 6869 6768 6572  res, with higher
+00019fc0: 2076 616c 7565 7320 7265 7072 6573 656e   values represen
+00019fd0: 7469 6e67 2067 7265 6174 6572 206f 7574  ting greater out
+00019fe0: 6c69 6572 732e 0a20 2020 2020 2020 2022  liers..        "
+00019ff0: 2222 0a0a 2020 2020 2020 2020 7265 7375  ""..        resu
+0001a000: 6c74 7320 3d20 6e70 2e66 756c 6c28 2864  lts = np.full((d
+0001a010: 6174 612e 7368 6170 655b 305d 292c 206e  ata.shape[0]), n
+0001a020: 702e 6e61 6e29 0a20 2020 2020 2020 2064  p.nan).        d
+0001a030: 6174 6120 3d20 6461 7461 2e61 7374 7970  ata = data.astyp
+0001a040: 6528 6e70 2e66 6c6f 6174 3332 290a 2020  e(np.float32).  
+0001a050: 2020 2020 2020 666f 7220 6920 696e 2070        for i in p
+0001a060: 7261 6e67 6528 6461 7461 2e73 6861 7065  range(data.shape
+0001a070: 5b30 5d29 3a0a 2020 2020 2020 2020 2020  [0]):.          
+0001a080: 2020 7363 6f72 6520 3d20 302e 300a 2020    score = 0.0.  
+0001a090: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
+0001a0a0: 696e 2070 7261 6e67 6528 6461 7461 2e73  in prange(data.s
+0001a0b0: 6861 7065 5b31 5d29 3a0a 2020 2020 2020  hape[1]):.      
+0001a0c0: 2020 2020 2020 2020 2020 7661 6c75 652c            value,
+0001a0d0: 2062 696e 5f69 6478 203d 2064 6174 615b   bin_idx = data[
+0001a0e0: 695d 5b6a 5d2c 206e 702e 6e61 6e0a 2020  i][j], np.nan.  
+0001a0f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001a100: 7220 6b20 696e 206e 702e 6172 616e 6765  r k in np.arange
+0001a110: 2868 6973 746f 6772 616d 5f65 6467 6573  (histogram_edges
+0001a120: 5b6a 5d2e 7368 6170 655b 305d 2c20 302c  [j].shape[0], 0,
+0001a130: 202d 3129 3a0a 2020 2020 2020 2020 2020   -1):.          
+0001a140: 2020 2020 2020 2020 2020 6269 6e5f 6d61            bin_ma
+0001a150: 782c 2062 696e 5f6d 696e 203d 2068 6973  x, bin_min = his
+0001a160: 746f 6772 616d 5f65 6467 6573 5b6a 5d5b  togram_edges[j][
+0001a170: 6b5d 2c20 6869 7374 6f67 7261 6d5f 6564  k], histogram_ed
+0001a180: 6765 735b 6a5d 5b6b 202d 2031 5d0a 2020  ges[j][k - 1].  
+0001a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1a0: 2020 6966 2028 7661 6c75 6520 3c3d 2062    if (value <= b
+0001a1b0: 696e 5f6d 6178 2920 616e 6420 2876 616c  in_max) and (val
+0001a1c0: 7565 203e 2062 696e 5f6d 696e 293a 0a20  ue > bin_min):. 
+0001a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1e0: 2020 2020 2020 2062 696e 5f69 6478 203d         bin_idx =
+0001a1f0: 206b 0a20 2020 2020 2020 2020 2020 2020   k.             
+0001a200: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0001a210: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+0001a220: 2020 2020 6966 206e 702e 6973 6e61 6e28      if np.isnan(
+0001a230: 6269 6e5f 6964 7829 3a0a 2020 2020 2020  bin_idx):.      
+0001a240: 2020 2020 2020 2020 2020 2020 2020 6269                bi
+0001a250: 6e5f 6964 7820 3d20 300a 2020 2020 2020  n_idx = 0.      
+0001a260: 2020 2020 2020 2020 2020 7363 6f72 6520            score 
+0001a270: 2b3d 202d 6e70 2e6c 6f67 2868 6973 746f  += -np.log(histo
+0001a280: 6772 616d 735b 6a5d 5b69 6e74 2862 696e  grams[j][int(bin
+0001a290: 5f69 6478 2920 2d20 315d 202b 2031 652d  _idx) - 1] + 1e-
+0001a2a0: 3130 290a 2020 2020 2020 2020 2020 2020  10).            
+0001a2b0: 7265 7375 6c74 735b 695d 203d 2073 636f  results[i] = sco
+0001a2c0: 7265 0a20 2020 2020 2020 2072 6574 7572  re.        retur
+0001a2d0: 6e20 7265 7375 6c74 730a 0a20 2020 2064  n results..    d
+0001a2e0: 6566 2068 626f 7328 0a20 2020 2020 2020  ef hbos(.       
+0001a2f0: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+0001a300: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+0001a310: 0a20 2020 2020 2020 2062 7563 6b65 745f  .        bucket_
+0001a320: 6d65 7468 6f64 3a20 4c69 7465 7261 6c5b  method: Literal[
+0001a330: 0a20 2020 2020 2020 2020 2020 2022 6664  .            "fd
+0001a340: 222c 2022 646f 616e 6522 2c20 2261 7574  ", "doane", "aut
+0001a350: 6f22 2c20 2273 636f 7474 222c 2022 7374  o", "scott", "st
+0001a360: 6f6e 6522 2c20 2272 6963 6522 2c20 2273  one", "rice", "s
+0001a370: 7475 7267 6573 222c 2022 7371 7274 220a  turges", "sqrt".
+0001a380: 2020 2020 2020 2020 5d20 3d20 2261 7574          ] = "aut
+0001a390: 6f22 2c0a 2020 2020 2920 2d3e 206e 702e  o",.    ) -> np.
+0001a3a0: 6e64 6172 7261 793a 0a20 2020 2020 2020  ndarray:.       
+0001a3b0: 2022 2222 0a20 2020 2020 2020 204a 6974   """.        Jit
+0001a3c0: 7465 6420 636f 6d70 7574 6520 6f66 2048  ted compute of H
+0001a3d0: 6973 746f 6772 616d 2d62 6173 6564 204f  istogram-based O
+0001a3e0: 7574 6c69 6572 2053 636f 7265 7320 2848  utlier Scores (H
+0001a3f0: 424f 5329 2e20 4842 4f53 2071 7561 6e74  BOS). HBOS quant
+0001a400: 6966 6965 7320 7468 6520 6162 6e6f 726d  ifies the abnorm
+0001a410: 616c 6974 7920 6f66 2064 6174 6120 706f  ality of data po
+0001a420: 696e 7473 2062 6173 6564 206f 6e20 7468  ints based on th
+0001a430: 6520 6465 6e73 6974 6965 7320 6f66 2074  e densities of t
+0001a440: 6865 6972 2066 6561 7475 7265 2076 616c  heir feature val
+0001a450: 7565 730a 2020 2020 2020 2020 7769 7468  ues.        with
+0001a460: 696e 2074 6865 6972 2072 6573 7065 6374  in their respect
+0001a470: 6976 6520 6275 636b 6574 7320 6f76 6572  ive buckets over
+0001a480: 2061 6c6c 2066 6561 7475 7265 2076 616c   all feature val
+0001a490: 7565 732e 0a0a 2020 2020 2020 2020 3a70  ues...        :p
+0001a4a0: 6172 616d 6574 6572 206e 702e 6e64 6172  arameter np.ndar
+0001a4b0: 7261 7920 6461 7461 3a20 3264 2061 7272  ray data: 2d arr
+0001a4c0: 6179 2077 6974 6820 6672 616d 6573 2072  ay with frames r
+0001a4d0: 6570 7265 7365 6e74 6564 2062 7920 726f  epresented by ro
+0001a4e0: 7773 2061 6e64 2063 6f6c 756d 6e73 2072  ws and columns r
+0001a4f0: 6570 7265 7365 6e74 696e 6720 6665 6174  epresenting feat
+0001a500: 7572 6520 7661 6c75 6573 2e0a 2020 2020  ure values..    
+0001a510: 2020 2020 3a70 6172 616d 6574 6572 204c      :parameter L
+0001a520: 6974 6572 616c 2062 7563 6b65 745f 6d65  iteral bucket_me
+0001a530: 7468 6f64 3a20 4573 7469 6d61 746f 7220  thod: Estimator 
+0001a540: 6465 7465 726d 696e 696e 6720 6f70 7469  determining opti
+0001a550: 6d61 6c20 6275 636b 6574 2063 6f75 6e74  mal bucket count
+0001a560: 2061 6e64 2062 7563 6b65 7420 7769 6474   and bucket widt
+0001a570: 682e 2044 6566 6175 6c74 3a20 5468 6520  h. Default: The 
+0001a580: 6d61 7869 6d75 6d20 6f66 2074 6865 2053  maximum of the S
+0001a590: 7475 7267 6573 2061 6e64 2046 7265 6564  turges and Freed
+0001a5a0: 6d61 6e2d 4469 6163 6f6e 6973 2065 7374  man-Diaconis est
+0001a5b0: 696d 6174 6f72 732e 0a20 2020 2020 2020  imators..       
+0001a5c0: 203a 7265 7475 726e 206e 702e 6e64 6172   :return np.ndar
+0001a5d0: 7261 793a 2041 7272 6179 206f 6620 7369  ray: Array of si
+0001a5e0: 7a65 2064 6174 612e 7368 6170 655b 305d  ze data.shape[0]
+0001a5f0: 2072 6570 7265 7365 6e74 696e 6720 6f75   representing ou
+0001a600: 746c 6965 7220 7363 6f72 6573 2c20 7769  tlier scores, wi
+0001a610: 7468 2068 6967 6865 7220 7661 6c75 6573  th higher values
+0001a620: 2072 6570 7265 7365 6e74 696e 6720 6772   representing gr
+0001a630: 6561 7465 7220 6f75 746c 6965 7273 2e0a  eater outliers..
+0001a640: 0a20 2020 2020 2020 202e 2e20 696d 6167  .        .. imag
+0001a650: 653a 3a20 5f73 7461 7469 632f 696d 672f  e:: _static/img/
+0001a660: 6862 6f73 2e70 6e67 0a20 2020 2020 2020  hbos.png.       
+0001a670: 2020 2020 3a77 6964 7468 3a20 3132 3030      :width: 1200
+0001a680: 0a20 2020 2020 2020 2020 2020 3a61 6c69  .           :ali
+0001a690: 676e 3a20 6365 6e74 6572 0a0a 2020 2020  gn: center..    
+0001a6a0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+0001a6b0: 2020 2020 2020 3e3e 3e20 7361 6d70 6c65        >>> sample
+0001a6c0: 5f31 203d 206e 702e 7261 6e64 6f6d 2e72  _1 = np.random.r
+0001a6d0: 616e 646f 6d5f 696e 7465 6765 7273 286c  andom_integers(l
+0001a6e0: 6f77 3d31 2c20 6869 6768 3d32 2c20 7369  ow=1, high=2, si
+0001a6f0: 7a65 3d28 3130 2c20 3530 2929 2e61 7374  ze=(10, 50)).ast
+0001a700: 7970 6528 6e70 2e66 6c6f 6174 3634 290a  ype(np.float64).
+0001a710: 2020 2020 2020 2020 3e3e 3e20 7361 6d70          >>> samp
+0001a720: 6c65 5f32 203d 206e 702e 7261 6e64 6f6d  le_2 = np.random
+0001a730: 2e72 616e 646f 6d5f 696e 7465 6765 7273  .random_integers
+0001a740: 286c 6f77 3d37 2c20 6869 6768 3d32 302c  (low=7, high=20,
+0001a750: 2073 697a 653d 2832 2c20 3530 2929 2e61   size=(2, 50)).a
+0001a760: 7374 7970 6528 6e70 2e66 6c6f 6174 3634  stype(np.float64
+0001a770: 290a 2020 2020 2020 2020 3e3e 3e20 6461  ).        >>> da
+0001a780: 7461 203d 206e 702e 7673 7461 636b 285b  ta = np.vstack([
+0001a790: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+0001a7a0: 5f32 5d29 0a20 2020 2020 2020 203e 3e3e  _2]).        >>>
+0001a7b0: 2053 7461 7469 7374 6963 7328 292e 6862   Statistics().hb
+0001a7c0: 6f73 2864 6174 613d 6461 7461 290a 2020  os(data=data).  
+0001a7d0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0001a7e0: 2020 2063 6865 636b 5f76 616c 6964 5f61     check_valid_a
+0001a7f0: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
+0001a800: 2020 6461 7461 3d64 6174 612c 0a20 2020    data=data,.   
+0001a810: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+0001a820: 6622 7b53 7461 7469 7374 6963 732e 5f5f  f"{Statistics.__
+0001a830: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+0001a840: 7d20 6461 7461 222c 0a20 2020 2020 2020  } data",.       
+0001a850: 2020 2020 2061 6363 6570 7465 645f 7369       accepted_si
+0001a860: 7a65 733d 5b32 5d2c 0a20 2020 2020 2020  zes=[2],.       
+0001a870: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
+0001a880: 5f73 7472 280a 2020 2020 2020 2020 2020  _str(.          
+0001a890: 2020 6e61 6d65 3d66 227b 5374 6174 6973    name=f"{Statis
+0001a8a0: 7469 6373 2e5f 5f63 6c61 7373 5f5f 2e5f  tics.__class__._
+0001a8b0: 5f6e 616d 655f 5f7d 2062 7563 6b65 745f  _name__} bucket_
+0001a8c0: 6d65 7468 6f64 222c 0a20 2020 2020 2020  method",.       
+0001a8d0: 2020 2020 2076 616c 7565 3d62 7563 6b65       value=bucke
+0001a8e0: 745f 6d65 7468 6f64 2c0a 2020 2020 2020  t_method,.      
+0001a8f0: 2020 2020 2020 6f70 7469 6f6e 733d 4f70        options=Op
+0001a900: 7469 6f6e 732e 4255 434b 4554 5f4d 4554  tions.BUCKET_MET
+0001a910: 484f 4453 2e76 616c 7565 2c0a 2020 2020  HODS.value,.    
+0001a920: 2020 2020 290a 2020 2020 2020 2020 6d69      ).        mi
+0001a930: 6e5f 7661 6c73 2c20 6d61 785f 7661 6c73  n_vals, max_vals
+0001a940: 203d 206e 702e 6d69 6e28 6461 7461 2c20   = np.min(data, 
+0001a950: 6178 6973 3d30 292c 206e 702e 6d61 7828  axis=0), np.max(
+0001a960: 6461 7461 2c20 6178 6973 3d30 290a 2020  data, axis=0).  
+0001a970: 2020 2020 2020 6461 7461 203d 2028 6461        data = (da
+0001a980: 7461 202d 206d 696e 5f76 616c 7329 202f  ta - min_vals) /
+0001a990: 2028 6d61 785f 7661 6c73 202d 206d 696e   (max_vals - min
+0001a9a0: 5f76 616c 7329 202a 2028 3120 2d20 3029  _vals) * (1 - 0)
+0001a9b0: 202b 2030 0a20 2020 2020 2020 2068 6973   + 0.        his
+0001a9c0: 746f 6772 616d 5f65 6467 6573 203d 2074  togram_edges = t
+0001a9d0: 7970 6564 2e44 6963 742e 656d 7074 7928  yped.Dict.empty(
+0001a9e0: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+0001a9f0: 5f74 7970 653d 7479 7065 732e 696e 7436  _type=types.int6
+0001aa00: 342c 2076 616c 7565 5f74 7970 653d 7479  4, value_type=ty
+0001aa10: 7065 732e 666c 6f61 7436 345b 3a5d 0a20  pes.float64[:]. 
+0001aa20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001aa30: 2068 6973 746f 6772 616d 7320 3d20 7479   histograms = ty
+0001aa40: 7065 642e 4469 6374 2e65 6d70 7479 286b  ped.Dict.empty(k
+0001aa50: 6579 5f74 7970 653d 7479 7065 732e 696e  ey_type=types.in
+0001aa60: 7436 342c 2076 616c 7565 5f74 7970 653d  t64, value_type=
+0001aa70: 7479 7065 732e 696e 7436 345b 3a5d 290a  types.int64[:]).
+0001aa80: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0001aa90: 2072 616e 6765 2864 6174 612e 7368 6170   range(data.shap
+0001aaa0: 655b 315d 293a 0a20 2020 2020 2020 2020  e[1]):.         
+0001aab0: 2020 2062 696e 5f77 6964 7468 2c20 6269     bin_width, bi
+0001aac0: 6e5f 636f 756e 7420 3d20 6275 636b 6574  n_count = bucket
+0001aad0: 5f64 6174 6128 0a20 2020 2020 2020 2020  _data(.         
+0001aae0: 2020 2020 2020 2064 6174 613d 6461 7461         data=data
+0001aaf0: 5b3a 2c20 695d 2e66 6c61 7474 656e 2829  [:, i].flatten()
+0001ab00: 2c20 6d65 7468 6f64 3d62 7563 6b65 745f  , method=bucket_
+0001ab10: 6d65 7468 6f64 0a20 2020 2020 2020 2020  method.         
+0001ab20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001ab30: 2068 6973 746f 6772 616d 735b 695d 203d   histograms[i] =
+0001ab40: 2073 656c 662e 5f68 6973 745f 3164 280a   self._hist_1d(.
+0001ab50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ab60: 6461 7461 3d64 6174 615b 3a2c 2069 5d2e  data=data[:, i].
+0001ab70: 666c 6174 7465 6e28 292c 0a20 2020 2020  flatten(),.     
+0001ab80: 2020 2020 2020 2020 2020 2062 696e 5f63             bin_c
+0001ab90: 6f75 6e74 3d62 696e 5f63 6f75 6e74 2c0a  ount=bin_count,.
+0001aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001abb0: 7261 6e67 653d 6e70 2e61 7272 6179 285b  range=np.array([
+0001abc0: 302c 2069 6e74 2862 696e 5f77 6964 7468  0, int(bin_width
+0001abd0: 202a 2062 696e 5f63 6f75 6e74 295d 292c   * bin_count)]),
+0001abe0: 0a20 2020 2020 2020 2020 2020 2029 2e61  .            ).a
+0001abf0: 7374 7970 6528 6e70 2e69 6e74 3634 290a  stype(np.int64).
+0001ac00: 2020 2020 2020 2020 2020 2020 6869 7374              hist
+0001ac10: 6f67 7261 6d5f 6564 6765 735b 695d 203d  ogram_edges[i] =
+0001ac20: 206e 702e 6172 616e 6765 2830 2c20 3120   np.arange(0, 1 
+0001ac30: 2b20 6269 6e5f 7769 6474 682c 2062 696e  + bin_width, bin
+0001ac40: 5f77 6964 7468 292e 6173 7479 7065 280a  _width).astype(.
+0001ac50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac60: 6e70 2e66 6c6f 6174 3634 0a20 2020 2020  np.float64.     
+0001ac70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001ac80: 2072 6573 756c 7473 203d 2073 656c 662e   results = self.
+0001ac90: 5f68 626f 735f 636f 6d70 7574 6528 0a20  _hbos_compute(. 
+0001aca0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+0001acb0: 6461 7461 2c20 6869 7374 6f67 7261 6d73  data, histograms
+0001acc0: 3d68 6973 746f 6772 616d 732c 2068 6973  =histograms, his
+0001acd0: 746f 6772 616d 5f65 6467 6573 3d68 6973  togram_edges=his
+0001ace0: 746f 6772 616d 5f65 6467 6573 0a20 2020  togram_edges.   
+0001acf0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0001ad00: 6574 7572 6e20 7265 7375 6c74 732e 6173  eturn results.as
+0001ad10: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0001ad20: 0a0a 2020 2020 6465 6620 726f 6c6c 696e  ..    def rollin
+0001ad30: 675f 7368 6170 6972 6f5f 7769 6c6b 7328  g_shapiro_wilks(
+0001ad40: 0a20 2020 2020 2020 2073 656c 662c 2064  .        self, d
+0001ad50: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+0001ad60: 2074 696d 655f 7769 6e64 6f77 3a20 666c   time_window: fl
+0001ad70: 6f61 742c 2066 7073 3a20 696e 740a 2020  oat, fps: int.  
+0001ad80: 2020 2920 2d3e 206e 702e 6e64 6172 7261    ) -> np.ndarra
+0001ad90: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
+0001ada0: 2020 2020 2020 2043 6f6d 7075 7465 2053         Compute S
+0001adb0: 6861 7069 726f 2d57 696c 6b73 206e 6f72  hapiro-Wilks nor
+0001adc0: 6d61 6c69 7479 2073 7461 7469 7374 6963  mality statistic
+0001add0: 7320 666f 7220 7365 7175 656e 7469 616c  s for sequential
+0001ade0: 6c79 2062 696e 6e65 6420 7661 6c75 6573  ly binned values
+0001adf0: 2069 6e20 6120 7469 6d65 2d73 6572 6965   in a time-serie
+0001ae00: 732e 2045 2e67 2e2c 2063 6f6d 7075 7465  s. E.g., compute
+0001ae10: 0a20 2020 2020 2020 2074 6865 206e 6f72  .        the nor
+0001ae20: 6d61 6c69 7479 2073 7461 7469 7374 6963  mality statistic
+0001ae30: 7320 6f66 2060 6046 6561 7475 7265 204e  s of ``Feature N
+0001ae40: 6060 2069 6e20 6561 6368 2077 696e 646f  `` in each windo
+0001ae50: 7720 6f66 2060 6074 696d 655f 7769 6e64  w of ``time_wind
+0001ae60: 6f77 6060 2073 6563 6f6e 6473 2e0a 0a20  ow`` seconds... 
+0001ae70: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0001ae80: 7220 6e64 6172 7261 7920 6461 7461 3a20  r ndarray data: 
+0001ae90: 3144 2061 7272 6179 206f 6620 7369 7a65  1D array of size
+0001aea0: 206c 656e 2866 7261 6d65 7329 2072 6570   len(frames) rep
+0001aeb0: 7265 7365 6e74 696e 6720 6665 6174 7572  resenting featur
+0001aec0: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+0001aed0: 2020 3a70 6172 616d 6574 6572 2069 6e74    :parameter int
+0001aee0: 2074 696d 655f 7769 6e64 6f77 3a20 5468   time_window: Th
+0001aef0: 6520 7369 7a65 206f 6620 7468 6520 6275  e size of the bu
+0001af00: 636b 6574 7320 696e 2073 6563 6f6e 6473  ckets in seconds
+0001af10: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001af20: 6574 6572 2069 6e74 2066 7073 3a20 4672  eter int fps: Fr
+0001af30: 616d 652d 7261 7465 206f 6620 7265 636f  ame-rate of reco
+0001af40: 7264 6564 2076 6964 656f 2e0a 2020 2020  rded video..    
+0001af50: 2020 2020 3a72 6574 7572 6e20 6e70 2e6e      :return np.n
+0001af60: 6461 7272 6179 3a20 4172 7261 7920 6f66  darray: Array of
+0001af70: 2073 697a 6520 6461 7461 2e73 6861 7065   size data.shape
+0001af80: 5b30 5d20 7769 7468 2053 6861 7069 726f  [0] with Shapiro
+0001af90: 2d57 696c 6b73 206e 6f72 6d61 6c69 7479  -Wilks normality
+0001afa0: 2073 7461 7469 7374 6963 730a 0a20 2020   statistics..   
+0001afb0: 2020 2020 203a 6578 616d 706c 653a 0a20       :example:. 
+0001afc0: 2020 2020 2020 203e 3e3e 2064 6174 6120         >>> data 
+0001afd0: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+0001afe0: 696e 7428 6c6f 773d 302c 2068 6967 683d  int(low=0, high=
+0001aff0: 3130 302c 2073 697a 653d 2832 3030 2929  100, size=(200))
+0001b000: 2e61 7374 7970 6528 2766 6c6f 6174 3332  .astype('float32
+0001b010: 2729 0a20 2020 2020 2020 203e 3e3e 2072  ').        >>> r
+0001b020: 6573 756c 7473 203d 2073 656c 662e 726f  esults = self.ro
+0001b030: 6c6c 696e 675f 7368 6170 6972 6f5f 7769  lling_shapiro_wi
+0001b040: 6c6b 7328 6461 7461 3d64 6174 612c 2074  lks(data=data, t
+0001b050: 696d 655f 7769 6e64 6f77 3d31 2c20 6670  ime_window=1, fp
+0001b060: 733d 3330 290a 2020 2020 2020 2020 2222  s=30).        ""
+0001b070: 220a 0a20 2020 2020 2020 2063 6865 636b  "..        check
+0001b080: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
+0001b090: 2020 2020 2020 2020 2020 6461 7461 3d64            data=d
+0001b0a0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+0001b0b0: 2073 6f75 7263 653d 6622 7b53 7461 7469   source=f"{Stati
+0001b0c0: 7374 6963 732e 5f5f 636c 6173 735f 5f2e  stics.__class__.
+0001b0d0: 5f5f 6e61 6d65 5f5f 7d20 6461 7461 222c  __name__} data",
+0001b0e0: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+0001b0f0: 6570 7465 645f 7369 7a65 733d 5b31 5d2c  epted_sizes=[1],
+0001b100: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0001b110: 2020 2063 6865 636b 5f66 6c6f 6174 280a     check_float(.
+0001b120: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0001b130: 3d66 227b 5374 6174 6973 7469 6373 2e5f  =f"{Statistics._
+0001b140: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+0001b150: 5f7d 2064 6174 6122 2c0a 2020 2020 2020  _} data",.      
+0001b160: 2020 2020 2020 7661 6c75 653d 7469 6d65        value=time
+0001b170: 5f77 696e 646f 772c 0a20 2020 2020 2020  _window,.       
+0001b180: 2020 2020 206d 696e 5f76 616c 7565 3d30       min_value=0
+0001b190: 2e31 2c0a 2020 2020 2020 2020 290a 2020  .1,.        ).  
+0001b1a0: 2020 2020 2020 6368 6563 6b5f 696e 7428        check_int(
+0001b1b0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+0001b1c0: 653d 6622 7b53 7461 7469 7374 6963 732e  e=f"{Statistics.
+0001b1d0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+0001b1e0: 5f5f 7d20 6461 7461 222c 2076 616c 7565  __} data", value
+0001b1f0: 3d74 696d 655f 7769 6e64 6f77 2c20 6d69  =time_window, mi
+0001b200: 6e5f 7661 6c75 653d 310a 2020 2020 2020  n_value=1.      
+0001b210: 2020 290a 2020 2020 2020 2020 7769 6e64    ).        wind
+0001b220: 6f77 5f73 697a 652c 2072 6573 756c 7473  ow_size, results
+0001b230: 203d 2069 6e74 2874 696d 655f 7769 6e64   = int(time_wind
+0001b240: 6f77 202a 2066 7073 292c 206e 702e 6675  ow * fps), np.fu
+0001b250: 6c6c 2828 6461 7461 2e73 6861 7065 5b30  ll((data.shape[0
+0001b260: 5d29 2c20 2d31 2e30 290a 2020 2020 2020  ]), -1.0).      
+0001b270: 2020 6461 7461 203d 206e 702e 7370 6c69    data = np.spli
+0001b280: 7428 6461 7461 2c20 6c69 7374 2872 616e  t(data, list(ran
+0001b290: 6765 2877 696e 646f 775f 7369 7a65 2c20  ge(window_size, 
+0001b2a0: 6461 7461 2e73 6861 7065 5b30 5d2c 2077  data.shape[0], w
+0001b2b0: 696e 646f 775f 7369 7a65 2929 290a 2020  indow_size))).  
+0001b2c0: 2020 2020 2020 666f 7220 636e 742c 2069        for cnt, i
+0001b2d0: 2069 6e20 656e 756d 6572 6174 6528 7072   in enumerate(pr
+0001b2e0: 616e 6765 2831 2c20 6c65 6e28 6461 7461  ange(1, len(data
+0001b2f0: 2929 293a 0a20 2020 2020 2020 2020 2020  ))):.           
+0001b300: 2073 7461 7274 2c20 656e 6420 3d20 696e   start, end = in
+0001b310: 7428 2863 6e74 202b 2031 2920 2a20 7769  t((cnt + 1) * wi
+0001b320: 6e64 6f77 5f73 697a 6529 2c20 696e 7428  ndow_size), int(
+0001b330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b340: 2028 2863 6e74 202b 2031 2920 2a20 7769   ((cnt + 1) * wi
+0001b350: 6e64 6f77 5f73 697a 6529 202b 2077 696e  ndow_size) + win
+0001b360: 646f 775f 7369 7a65 0a20 2020 2020 2020  dow_size.       
+0001b370: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001b380: 2020 2072 6573 756c 7473 5b73 7461 7274     results[start
+0001b390: 3a65 6e64 5d20 3d20 7374 6174 732e 7368  :end] = stats.sh
+0001b3a0: 6170 6972 6f28 6461 7461 5b69 5d29 5b30  apiro(data[i])[0
+0001b3b0: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+0001b3c0: 2072 6573 756c 7473 0a0a 2020 2020 4073   results..    @s
+0001b3d0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0001b3e0: 406e 6a69 7428 2228 666c 6f61 7433 325b  @njit("(float32[
+0001b3f0: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
+0001b400: 696e 7436 342c 2922 290a 2020 2020 6465  int64,)").    de
+0001b410: 6620 736c 6964 696e 675f 7a5f 7363 6f72  f sliding_z_scor
+0001b420: 6573 280a 2020 2020 2020 2020 6461 7461  es(.        data
+0001b430: 3a20 6e70 2e6e 6461 7272 6179 2c20 7469  : np.ndarray, ti
+0001b440: 6d65 5f77 696e 646f 7773 3a20 6e70 2e6e  me_windows: np.n
+0001b450: 6461 7272 6179 2c20 6670 733a 2069 6e74  darray, fps: int
+0001b460: 0a20 2020 2029 202d 3e20 6e70 2e6e 6461  .    ) -> np.nda
+0001b470: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
+0001b480: 220a 2020 2020 2020 2020 4361 6c63 756c  ".        Calcul
+0001b490: 6174 6520 736c 6964 696e 6720 5a2d 7363  ate sliding Z-sc
+0001b4a0: 6f72 6573 2066 6f72 2061 2067 6976 656e  ores for a given
+0001b4b0: 2064 6174 6120 6172 7261 7920 6f76 6572   data array over
+0001b4c0: 2073 7065 6369 6669 6564 2074 696d 6520   specified time 
+0001b4d0: 7769 6e64 6f77 732e 0a0a 2020 2020 2020  windows...      
+0001b4e0: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+0001b4f0: 636f 6d70 7574 6573 2073 6c69 6469 6e67  computes sliding
+0001b500: 205a 2d73 636f 7265 7320 666f 7220 6120   Z-scores for a 
+0001b510: 3144 2064 6174 6120 6172 7261 7920 6f76  1D data array ov
+0001b520: 6572 2064 6966 6665 7265 6e74 2074 696d  er different tim
+0001b530: 6520 7769 6e64 6f77 732e 2054 6865 2073  e windows. The s
+0001b540: 6c69 6469 6e67 205a 2d73 636f 7265 0a20  liding Z-score. 
+0001b550: 2020 2020 2020 2069 7320 6120 6d65 6173         is a meas
+0001b560: 7572 6520 6f66 2068 6f77 206d 616e 7920  ure of how many 
+0001b570: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
+0001b580: 6f6e 7320 6120 6461 7461 2070 6f69 6e74  ons a data point
+0001b590: 2069 7320 6672 6f6d 2074 6865 206d 6561   is from the mea
+0001b5a0: 6e20 6f66 2074 6865 2073 7572 726f 756e  n of the surroun
+0001b5b0: 6469 6e67 2064 6174 6120 7769 7468 696e  ding data within
+0001b5c0: 0a20 2020 2020 2020 2074 6865 2073 7065  .        the spe
+0001b5d0: 6369 6669 6564 2074 696d 6520 7769 6e64  cified time wind
+0001b5e0: 6f77 2e20 5468 6973 2063 616e 2062 6520  ow. This can be 
+0001b5f0: 7573 6566 756c 2066 6f72 2064 6574 6563  useful for detec
+0001b600: 7469 6e67 2061 6e6f 6d61 6c69 6573 206f  ting anomalies o
+0001b610: 7220 7661 7269 6174 696f 6e73 2069 6e20  r variations in 
+0001b620: 7469 6d65 2d73 6572 6965 7320 6461 7461  time-series data
+0001b630: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001b640: 6d65 7465 7220 6e64 6172 7261 7920 6461  meter ndarray da
+0001b650: 7461 3a20 3144 204e 756d 5079 2061 7272  ta: 1D NumPy arr
+0001b660: 6179 2063 6f6e 7461 696e 696e 6720 7468  ay containing th
+0001b670: 6520 7469 6d65 2d73 6572 6965 7320 6461  e time-series da
+0001b680: 7461 2e0a 2020 2020 2020 2020 3a70 6172  ta..        :par
+0001b690: 616d 6574 6572 206e 6461 7272 6179 2074  ameter ndarray t
+0001b6a0: 696d 655f 7769 6e64 6f77 733a 2031 4420  ime_windows: 1D 
+0001b6b0: 4e75 6d50 7920 6172 7261 7920 7370 6563  NumPy array spec
+0001b6c0: 6966 7969 6e67 2074 6865 2074 696d 6520  ifying the time 
+0001b6d0: 7769 6e64 6f77 7320 696e 2073 6563 6f6e  windows in secon
+0001b6e0: 6473 206f 7665 7220 7768 6963 6820 746f  ds over which to
+0001b6f0: 2063 616c 6375 6c61 7465 2074 6865 205a   calculate the Z
+0001b700: 2d73 636f 7265 732e 0a20 2020 2020 2020  -scores..       
+0001b710: 203a 7061 7261 6d65 7465 7220 696e 7420   :parameter int 
+0001b720: 7469 6d65 5f77 696e 646f 7773 3a20 4672  time_windows: Fr
+0001b730: 616d 6573 2070 6572 2073 6563 6f6e 642c  ames per second,
+0001b740: 2075 7365 6420 746f 2063 6f6e 7665 7274   used to convert
+0001b750: 2074 696d 6520 7769 6e64 6f77 7320 6672   time windows fr
+0001b760: 6f6d 2073 6563 6f6e 6473 2074 6f20 7468  om seconds to th
+0001b770: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+0001b780: 6e75 6d62 6572 206f 6620 6461 7461 2070  number of data p
+0001b790: 6f69 6e74 732e 0a20 2020 2020 2020 203a  oints..        :
+0001b7a0: 7265 7475 726e 7320 6e70 2e6e 6461 7272  returns np.ndarr
+0001b7b0: 6179 3a20 4120 3244 204e 756d 5079 2061  ay: A 2D NumPy a
+0001b7c0: 7272 6179 2063 6f6e 7461 696e 696e 6720  rray containing 
+0001b7d0: 7468 6520 6361 6c63 756c 6174 6564 205a  the calculated Z
+0001b7e0: 2d73 636f 7265 732e 2045 6163 6820 726f  -scores. Each ro
+0001b7f0: 7720 636f 7272 6573 706f 6e64 7320 746f  w corresponds to
+0001b800: 2074 6865 205a 2d73 636f 7265 7320 6361   the Z-scores ca
+0001b810: 6c63 756c 6174 6564 2066 6f72 2061 2073  lculated for a s
+0001b820: 7065 6369 6669 6320 7469 6d65 2077 696e  pecific time win
+0001b830: 646f 772e 2054 6865 2074 696d 6520 7769  dow. The time wi
+0001b840: 6e64 6f77 7320 6172 6520 7265 7072 6573  ndows are repres
+0001b850: 656e 7465 6420 6279 2074 6865 2063 6f6c  ented by the col
+0001b860: 756d 6e73 2e0a 0a20 2020 2020 2020 203a  umns...        :
+0001b870: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+0001b880: 203e 3e3e 2064 6174 6120 3d20 6e70 2e72   >>> data = np.r
+0001b890: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+0001b8a0: 2031 3030 2c20 2831 3030 302c 2929 2e61   100, (1000,)).a
+0001b8b0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+0001b8c0: 290a 2020 2020 2020 2020 3e3e 3e20 7a5f  ).        >>> z_
+0001b8d0: 7363 6f72 6573 203d 2053 7461 7469 7374  scores = Statist
+0001b8e0: 6963 7328 292e 736c 6964 696e 675f 7a5f  ics().sliding_z_
+0001b8f0: 7363 6f72 6573 2864 6174 613d 6461 7461  scores(data=data
+0001b900: 2c20 7469 6d65 5f77 696e 646f 7773 3d6e  , time_windows=n
+0001b910: 702e 6172 7261 7928 5b31 2e30 2c20 322e  p.array([1.0, 2.
+0001b920: 355d 292c 2066 7073 3d31 3029 0a20 2020  5]), fps=10).   
+0001b930: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0001b940: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
+0001b950: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
+0001b960: 305d 2c20 7469 6d65 5f77 696e 646f 7773  0], time_windows
+0001b970: 2e73 6861 7065 5b30 5d29 2c20 302e 3029  .shape[0]), 0.0)
+0001b980: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+0001b990: 6e20 7261 6e67 6528 7469 6d65 5f77 696e  n range(time_win
+0001b9a0: 646f 7773 2e73 6861 7065 5b30 5d29 3a0a  dows.shape[0]):.
+0001b9b0: 2020 2020 2020 2020 2020 2020 7769 6e64              wind
+0001b9c0: 6f77 5f73 697a 6520 3d20 696e 7428 7469  ow_size = int(ti
+0001b9d0: 6d65 5f77 696e 646f 7773 5b69 5d20 2a20  me_windows[i] * 
+0001b9e0: 6670 7329 0a20 2020 2020 2020 2020 2020  fps).           
+0001b9f0: 2066 6f72 2072 6967 6874 2069 6e20 7261   for right in ra
+0001ba00: 6e67 6528 7769 6e64 6f77 5f73 697a 6520  nge(window_size 
+0001ba10: 2d20 312c 2064 6174 612e 7368 6170 655b  - 1, data.shape[
+0001ba20: 305d 293a 0a20 2020 2020 2020 2020 2020  0]):.           
+0001ba30: 2020 2020 206c 6566 7420 3d20 7269 6768       left = righ
+0001ba40: 7420 2d20 7769 6e64 6f77 5f73 697a 6520  t - window_size 
+0001ba50: 2b20 310a 2020 2020 2020 2020 2020 2020  + 1.            
+0001ba60: 2020 2020 7361 6d70 6c65 5f64 6174 6120      sample_data 
+0001ba70: 3d20 6461 7461 5b6c 6566 7420 3a20 7269  = data[left : ri
+0001ba80: 6768 7420 2b20 315d 0a20 2020 2020 2020  ght + 1].       
+0001ba90: 2020 2020 2020 2020 206d 2c20 7320 3d20           m, s = 
+0001baa0: 6e70 2e6d 6561 6e28 7361 6d70 6c65 5f64  np.mean(sample_d
+0001bab0: 6174 6129 2c20 6e70 2e73 7464 2873 616d  ata), np.std(sam
+0001bac0: 706c 655f 6461 7461 290a 2020 2020 2020  ple_data).      
+0001bad0: 2020 2020 2020 2020 2020 7661 6c73 203d            vals =
+0001bae0: 2028 7361 6d70 6c65 5f64 6174 6120 2d20   (sample_data - 
+0001baf0: 6d29 202f 2073 0a20 2020 2020 2020 2020  m) / s.         
+0001bb00: 2020 2020 2020 2072 6573 756c 7473 5b6c         results[l
+0001bb10: 6566 7420 3a20 7269 6768 7420 2b20 312c  eft : right + 1,
+0001bb20: 2069 5d20 3d20 7661 6c73 0a20 2020 2020   i] = vals.     
+0001bb30: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+0001bb40: 730a 0a20 2020 2040 7374 6174 6963 6d65  s..    @staticme
+0001bb50: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+0001bb60: 2869 6e74 3634 5b3a 2c20 3a5d 2c29 2229  (int64[:, :],)")
+0001bb70: 0a20 2020 2064 6566 2070 6869 5f63 6f65  .    def phi_coe
+0001bb80: 6666 6963 6965 6e74 2864 6174 613a 206e  fficient(data: n
+0001bb90: 702e 6e64 6172 7261 7929 202d 3e20 666c  p.ndarray) -> fl
+0001bba0: 6f61 743a 0a20 2020 2020 2020 2022 2222  oat:.        """
+0001bbb0: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
+0001bbc0: 2074 6865 2070 6869 2063 6f65 6666 6963   the phi coeffic
+0001bbd0: 6965 6e74 2066 6f72 2061 204e 7832 2061  ient for a Nx2 a
+0001bbe0: 7272 6179 206f 6620 6269 6e61 7279 2064  rray of binary d
+0001bbf0: 6174 612e 0a0a 2020 2020 2020 2020 5468  ata...        Th
+0001bc00: 6520 7068 6920 636f 6566 6669 6369 656e  e phi coefficien
+0001bc10: 7420 2861 2e6b 2e61 204d 6174 7468 6577  t (a.k.a Matthew
+0001bc20: 7320 436f 7272 656c 6174 696f 6e20 436f  s Correlation Co
+0001bc30: 6566 6669 6369 656e 7420 284d 4343 2929  efficient (MCC))
+0001bc40: 2c20 6973 2061 206d 6561 7375 7265 206f  , is a measure o
+0001bc50: 6620 6173 736f 6369 6174 696f 6e20 666f  f association fo
+0001bc60: 7220 6269 6e61 7279 2064 6174 6120 696e  r binary data in
+0001bc70: 2061 2032 7832 2063 6f6e 7469 6e67 656e   a 2x2 contingen
+0001bc80: 6379 2074 6162 6c65 2e20 4974 2071 7561  cy table. It qua
+0001bc90: 6e74 6966 6965 7320 7468 650a 2020 2020  ntifies the.    
+0001bca0: 2020 2020 6465 6772 6565 206f 6620 6173      degree of as
+0001bcb0: 736f 6369 6174 696f 6e20 6f72 2063 6f72  sociation or cor
+0001bcc0: 7265 6c61 7469 6f6e 2062 6574 7765 656e  relation between
+0001bcd0: 2074 776f 2062 696e 6172 7920 7661 7269   two binary vari
+0001bce0: 6162 6c65 7320 2865 2e67 2e2c 2062 696e  ables (e.g., bin
+0001bcf0: 6172 7920 636c 6173 7369 6669 6361 7469  ary classificati
+0001bd00: 6f6e 2074 6172 6765 7473 292e 0a0a 2020  on targets)...  
+0001bd10: 2020 2020 2020 5468 6520 666f 726d 756c        The formul
+0001bd20: 6120 666f 7220 7468 6520 7068 6920 636f  a for the phi co
+0001bd30: 6566 6669 6369 656e 7420 6973 2064 6566  efficient is def
+0001bd40: 696e 6564 2061 733a 0a0a 2020 2020 2020  ined as:..      
+0001bd50: 2020 2e2e 206d 6174 683a 3a0a 0a20 2020    .. math::..   
+0001bd60: 2020 2020 2020 2020 5c5c 7068 6920 3d20          \\phi = 
+0001bd70: 5c5c 6672 6163 7b7b 2842 4320 2d20 4144  \\frac{{(BC - AD
+0001bd80: 297d 7d7b 7b5c 7371 7274 7b7b 2843 5c5f  )}}{{\sqrt{{(C\_
+0001bd90: 3120 2b20 435c 5f32 2928 525c 5f31 202b  1 + C\_2)(R\_1 +
+0001bda0: 2052 5c5f 3229 2843 5c5f 3120 2b20 525c   R\_2)(C\_1 + R\
+0001bdb0: 5f31 2928 435c 5f32 202b 2052 5c5f 3229  _1)(C\_2 + R\_2)
+0001bdc0: 7d7d 7d7d 0a0a 2020 2020 2020 2020 7768  }}}}..        wh
+0001bdd0: 6572 653a 0a20 2020 2020 2020 2020 2020  ere:.           
+0001bde0: 202d 2042 433a 2048 6974 2072 6174 6520   - BC: Hit rate 
+0001bdf0: 2872 6570 6f6e 7365 2061 6e64 2074 7275  (reponse and tru
+0001be00: 7468 2069 7320 626f 7468 2031 290a 2020  th is both 1).  
+0001be10: 2020 2020 2020 2020 2020 2d20 4144 3a20            - AD: 
+0001be20: 436f 7272 6563 7420 7265 6a65 6374 696f  Correct rejectio
+0001be30: 6e73 2028 7265 7370 6f6e 7365 2061 6e64  ns (response and
+0001be40: 2074 7275 7468 2061 7265 2062 6f74 6820   truth are both 
+0001be50: 3029 0a20 2020 2020 2020 2020 2020 202d  0).            -
+0001be60: 2043 312c 2043 323a 2043 6f75 6e74 7320   C1, C2: Counts 
+0001be70: 6f66 206f 6363 7572 7265 6e63 6573 2077  of occurrences w
+0001be80: 6865 7265 2074 6865 2072 6573 706f 6e73  here the respons
+0001be90: 6520 6973 2031 2061 6e64 2030 2c20 7265  e is 1 and 0, re
+0001bea0: 7370 6563 7469 7665 6c79 2e0a 2020 2020  spectively..    
+0001beb0: 2020 2020 2020 2020 2d20 5231 2c20 5232          - R1, R2
+0001bec0: 3a20 436f 756e 7473 206f 6620 6f63 6375  : Counts of occu
+0001bed0: 7272 656e 6365 7320 7768 6572 6520 7468  rrences where th
+0001bee0: 6520 7472 7574 6820 6973 2031 2061 6e64  e truth is 1 and
+0001bef0: 2030 2c20 7265 7370 6563 7469 7665 6c79   0, respectively
+0001bf00: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001bf10: 6d20 6e70 2e6e 6461 7272 6179 2064 6174  m np.ndarray dat
+0001bf20: 613a 2041 204e 756d 5079 2061 7272 6179  a: A NumPy array
+0001bf30: 2063 6f6e 7461 696e 696e 6720 6269 6e61   containing bina
+0001bf40: 7279 2064 6174 6120 6f72 6761 6e69 7a65  ry data organize
+0001bf50: 6420 696e 2074 776f 2063 6f6c 756d 6e73  d in two columns
+0001bf60: 2e20 4561 6368 2072 6f77 2072 6570 7265  . Each row repre
+0001bf70: 7365 6e74 7320 6120 7061 6972 206f 6620  sents a pair of 
+0001bf80: 6269 6e61 7279 2076 616c 7565 7320 666f  binary values fo
+0001bf90: 7220 7477 6f20 7661 7269 6162 6c65 732e  r two variables.
+0001bfa0: 2043 6f6c 756d 6e73 2072 6570 7265 7365   Columns represe
+0001bfb0: 6e74 2074 776f 2066 6561 7475 7265 7320  nt two features 
+0001bfc0: 6f72 2074 776f 2062 696e 6172 7920 636c  or two binary cl
+0001bfd0: 6173 7369 6669 6361 7469 6f6e 2072 6573  assification res
+0001bfe0: 756c 7473 2e0a 2020 2020 2020 2020 3a70  ults..        :p
+0001bff0: 6172 616d 2066 6c6f 6174 3a20 5468 6520  aram float: The 
+0001c000: 6361 6c63 756c 6174 6564 2070 6869 2063  calculated phi c
+0001c010: 6f65 6666 6963 6965 6e74 2c20 6120 7661  oefficient, a va
+0001c020: 6c75 6520 6265 7477 6565 6e20 3020 616e  lue between 0 an
+0001c030: 6420 312e 2041 2076 616c 7565 206f 6620  d 1. A value of 
+0001c040: 3020 696e 6469 6361 7465 7320 6e6f 2061  0 indicates no a
+0001c050: 7373 6f63 6961 7469 6f6e 2062 6574 7765  ssociation betwe
+0001c060: 656e 2074 6865 2076 6172 6961 626c 6573  en the variables
+0001c070: 2c20 7768 696c 6520 3120 696e 6469 6361  , while 1 indica
+0001c080: 7465 7320 6120 7065 7266 6563 7420 6173  tes a perfect as
+0001c090: 736f 6369 6174 696f 6e2e 0a0a 2020 2020  sociation...    
+0001c0a0: 2020 2020 3a65 7861 6d70 6c65 3a0a 2020      :example:.  
+0001c0b0: 2020 2020 2020 3e3e 3e20 6461 7461 203d        >>> data =
+0001c0c0: 206e 702e 6172 7261 7928 5b5b 302c 2031   np.array([[0, 1
+0001c0d0: 5d2c 205b 312c 2030 5d2c 205b 312c 2030  ], [1, 0], [1, 0
+0001c0e0: 5d2c 205b 312c 2031 5d5d 292e 6173 7479  ], [1, 1]]).asty
+0001c0f0: 7065 286e 702e 696e 7436 3429 0a20 2020  pe(np.int64).   
+0001c100: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
+0001c110: 6963 7328 292e 7068 695f 636f 6566 6669  ics().phi_coeffi
+0001c120: 6369 656e 7428 6461 7461 3d64 6174 6129  cient(data=data)
+0001c130: 0a20 2020 2020 2020 203e 3e3e 2030 2e38  .        >>> 0.8
+0001c140: 3136 3439 3635 3830 3932 3737 3236 310a  164965809277261.
+0001c150: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
+0001c160: 203d 206e 702e 7261 6e64 6f6d 2e72 616e   = np.random.ran
+0001c170: 6469 6e74 2830 2c20 322c 2028 3130 302c  dint(0, 2, (100,
+0001c180: 2032 2929 0a20 2020 2020 2020 203e 3e3e   2)).        >>>
+0001c190: 2072 6573 756c 7420 3d20 5374 6174 6973   result = Statis
+0001c1a0: 7469 6373 2e70 6869 5f63 6f65 6666 6963  tics.phi_coeffic
+0001c1b0: 6965 6e74 2864 6174 613d 6461 7461 290a  ient(data=data).
+0001c1c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001c1d0: 2020 2020 636e 745f 305f 3020 3d20 6c65      cnt_0_0 = le
+0001c1e0: 6e28 6e70 2e61 7267 7768 6572 6528 2864  n(np.argwhere((d
+0001c1f0: 6174 615b 3a2c 2030 5d20 3d3d 2030 2920  ata[:, 0] == 0) 
+0001c200: 2620 2864 6174 615b 3a2c 2031 5d20 3d3d  & (data[:, 1] ==
+0001c210: 2030 2929 2e66 6c61 7474 656e 2829 290a   0)).flatten()).
+0001c220: 2020 2020 2020 2020 636e 745f 305f 3120          cnt_0_1 
+0001c230: 3d20 6c65 6e28 6e70 2e61 7267 7768 6572  = len(np.argwher
+0001c240: 6528 2864 6174 615b 3a2c 2030 5d20 3d3d  e((data[:, 0] ==
+0001c250: 2030 2920 2620 2864 6174 615b 3a2c 2031   0) & (data[:, 1
+0001c260: 5d20 3d3d 2031 2929 2e66 6c61 7474 656e  ] == 1)).flatten
+0001c270: 2829 290a 2020 2020 2020 2020 636e 745f  ()).        cnt_
+0001c280: 315f 3020 3d20 6c65 6e28 6e70 2e61 7267  1_0 = len(np.arg
+0001c290: 7768 6572 6528 2864 6174 615b 3a2c 2030  where((data[:, 0
+0001c2a0: 5d20 3d3d 2031 2920 2620 2864 6174 615b  ] == 1) & (data[
+0001c2b0: 3a2c 2031 5d20 3d3d 2030 2929 2e66 6c61  :, 1] == 0)).fla
+0001c2c0: 7474 656e 2829 290a 2020 2020 2020 2020  tten()).        
+0001c2d0: 636e 745f 315f 3120 3d20 6c65 6e28 6e70  cnt_1_1 = len(np
+0001c2e0: 2e61 7267 7768 6572 6528 2864 6174 615b  .argwhere((data[
+0001c2f0: 3a2c 2030 5d20 3d3d 2031 2920 2620 2864  :, 0] == 1) & (d
+0001c300: 6174 615b 3a2c 2031 5d20 3d3d 2031 2929  ata[:, 1] == 1))
+0001c310: 2e66 6c61 7474 656e 2829 290a 0a20 2020  .flatten())..   
+0001c320: 2020 2020 2042 432c 2041 4420 3d20 636e       BC, AD = cn
+0001c330: 745f 315f 3120 2a20 636e 745f 305f 302c  t_1_1 * cnt_0_0,
+0001c340: 2063 6e74 5f31 5f30 202a 2063 6e74 5f30   cnt_1_0 * cnt_0
+0001c350: 5f31 0a20 2020 2020 2020 206e 6f6d 696e  _1.        nomin
+0001c360: 6174 6f72 203d 2042 4320 2d20 4144 0a20  ator = BC - AD. 
+0001c370: 2020 2020 2020 2064 656e 6f6d 696e 6174         denominat
+0001c380: 6f72 203d 206e 702e 7371 7274 280a 2020  or = np.sqrt(.  
+0001c390: 2020 2020 2020 2020 2020 2863 6e74 5f31            (cnt_1
+0001c3a0: 5f30 202b 2063 6e74 5f31 5f31 290a 2020  _0 + cnt_1_1).  
+0001c3b0: 2020 2020 2020 2020 2020 2a20 2863 6e74            * (cnt
+0001c3c0: 5f30 5f30 202b 2063 6e74 5f30 5f31 290a  _0_0 + cnt_0_1).
+0001c3d0: 2020 2020 2020 2020 2020 2020 2a20 2863              * (c
+0001c3e0: 6e74 5f31 5f30 202b 2063 6e74 5f30 5f30  nt_1_0 + cnt_0_0
+0001c3f0: 290a 2020 2020 2020 2020 2020 2020 2a20  ).            * 
+0001c400: 2863 6e74 5f31 5f31 202a 2063 6e74 5f30  (cnt_1_1 * cnt_0
+0001c410: 5f31 290a 2020 2020 2020 2020 290a 2020  _1).        ).  
+0001c420: 2020 2020 2020 6966 206e 6f6d 696e 6174        if nominat
+0001c430: 6f72 203d 3d20 3020 6f72 2064 656e 6f6d  or == 0 or denom
+0001c440: 696e 6174 6f72 203d 3d20 303a 0a20 2020  inator == 0:.   
+0001c450: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001c460: 312e 300a 2020 2020 2020 2020 656c 7365  1.0.        else
+0001c470: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001c480: 7475 726e 206e 702e 6162 7328 0a20 2020  turn np.abs(.   
+0001c490: 2020 2020 2020 2020 2020 2020 2028 4243               (BC
+0001c4a0: 202d 2041 4429 0a20 2020 2020 2020 2020   - AD).         
+0001c4b0: 2020 2020 2020 202f 206e 702e 7371 7274         / np.sqrt
+0001c4c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001c4d0: 2020 2020 2020 2863 6e74 5f31 5f30 202b        (cnt_1_0 +
+0001c4e0: 2063 6e74 5f31 5f31 290a 2020 2020 2020   cnt_1_1).      
+0001c4f0: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
+0001c500: 2863 6e74 5f30 5f30 202b 2063 6e74 5f30  (cnt_0_0 + cnt_0
+0001c510: 5f31 290a 2020 2020 2020 2020 2020 2020  _1).            
+0001c520: 2020 2020 2020 2020 2a20 2863 6e74 5f31          * (cnt_1
+0001c530: 5f30 202b 2063 6e74 5f30 5f30 290a 2020  _0 + cnt_0_0).  
+0001c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c550: 2020 2a20 2863 6e74 5f31 5f31 202a 2063    * (cnt_1_1 * c
+0001c560: 6e74 5f30 5f31 290a 2020 2020 2020 2020  nt_0_1).        
+0001c570: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001c580: 2020 2020 2020 290a 0a20 2020 2040 7374        )..    @st
+0001c590: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
+0001c5a0: 6e6a 6974 2822 2869 6e74 3332 5b3a 2c20  njit("(int32[:, 
+0001c5b0: 3a5d 2c20 666c 6f61 7436 345b 3a5d 2c20  :], float64[:], 
+0001c5c0: 696e 7436 3429 2229 0a20 2020 2064 6566  int64)").    def
+0001c5d0: 2073 6c69 6469 6e67 5f70 6869 5f63 6f65   sliding_phi_coe
+0001c5e0: 6666 6963 6965 6e74 280a 2020 2020 2020  fficient(.      
+0001c5f0: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
+0001c600: 6179 2c20 7769 6e64 6f77 5f73 697a 6573  ay, window_sizes
+0001c610: 3a20 6e70 2e6e 6461 7272 6179 2c20 7361  : np.ndarray, sa
+0001c620: 6d70 6c65 5f72 6174 653a 2069 6e74 0a20  mple_rate: int. 
+0001c630: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+0001c640: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+0001c650: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
+0001c660: 6520 736c 6964 696e 6720 7068 6920 636f  e sliding phi co
+0001c670: 6566 6669 6369 656e 7473 2066 6f72 2061  efficients for a
+0001c680: 2032 7832 2063 6f6e 7469 6e67 656e 6379   2x2 contingency
+0001c690: 2074 6162 6c65 2064 6572 6976 6564 2066   table derived f
+0001c6a0: 726f 6d20 6269 6e61 7279 2064 6174 612e  rom binary data.
+0001c6b0: 0a0a 2020 2020 2020 2020 436f 6d70 7574  ..        Comput
+0001c6c0: 6573 2073 6c69 6469 6e67 2070 6869 2063  es sliding phi c
+0001c6d0: 6f65 6666 6963 6965 6e74 7320 666f 7220  oefficients for 
+0001c6e0: 6120 3278 3220 636f 6e74 696e 6765 6e63  a 2x2 contingenc
+0001c6f0: 7920 7461 626c 6520 6465 7269 7665 6420  y table derived 
+0001c700: 6672 6f6d 2062 696e 6172 7920 6461 7461  from binary data
+0001c710: 206f 7665 7220 6469 6666 6572 656e 740a   over different.
+0001c720: 2020 2020 2020 2020 7469 6d65 2077 696e          time win
+0001c730: 646f 7773 2e20 5468 6520 7068 6920 636f  dows. The phi co
+0001c740: 6566 6669 6369 656e 7420 6973 2061 206d  efficient is a m
+0001c750: 6561 7375 7265 206f 6620 6173 736f 6369  easure of associ
+0001c760: 6174 696f 6e20 6265 7477 6565 6e20 7477  ation between tw
+0001c770: 6f20 6269 6e61 7279 2076 6172 6961 626c  o binary variabl
+0001c780: 6573 2c20 616e 6420 736c 6964 696e 6720  es, and sliding 
+0001c790: 7068 690a 2020 2020 2020 2020 636f 6566  phi.        coef
+0001c7a0: 6669 6369 656e 7473 2063 616e 2072 6576  ficients can rev
+0001c7b0: 6561 6c20 6368 616e 6765 7320 696e 2061  eal changes in a
+0001c7c0: 7373 6f63 6961 7469 6f6e 206f 7665 7220  ssociation over 
+0001c7d0: 7469 6d65 2e0a 0a20 2020 2020 2020 203a  time...        :
+0001c7e0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+0001c7f0: 2064 6174 613a 2041 2032 4420 4e75 6d50   data: A 2D NumP
+0001c800: 7920 6172 7261 7920 636f 6e74 6169 6e69  y array containi
+0001c810: 6e67 2062 696e 6172 7920 6461 7461 206f  ng binary data o
+0001c820: 7267 616e 697a 6564 2069 6e20 7477 6f20  rganized in two 
+0001c830: 636f 6c75 6d6e 732e 2045 6163 6820 726f  columns. Each ro
+0001c840: 7720 7265 7072 6573 656e 7473 2061 2070  w represents a p
+0001c850: 6169 7220 6f66 2062 696e 6172 7920 7661  air of binary va
+0001c860: 6c75 6573 2066 6f72 2074 776f 2076 6172  lues for two var
+0001c870: 6961 626c 6573 2e0a 2020 2020 2020 2020  iables..        
+0001c880: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+0001c890: 7920 7769 6e64 6f77 5f73 697a 6573 3a20  y window_sizes: 
+0001c8a0: 3144 204e 756d 5079 2061 7272 6179 2073  1D NumPy array s
+0001c8b0: 7065 6369 6679 696e 6720 7468 6520 7469  pecifying the ti
+0001c8c0: 6d65 2077 696e 646f 7773 2028 696e 2073  me windows (in s
+0001c8d0: 6563 6f6e 6473 2920 6f76 6572 2077 6869  econds) over whi
+0001c8e0: 6368 2074 6f20 6361 6c63 756c 6174 6520  ch to calculate 
+0001c8f0: 7468 6520 736c 6964 696e 6720 7068 6920  the sliding phi 
+0001c900: 636f 6566 6669 6369 656e 7473 2e0a 2020  coefficients..  
+0001c910: 2020 2020 2020 3a70 6172 616d 2069 6e74        :param int
+0001c920: 2073 616d 706c 655f 7261 7465 3a20 5468   sample_rate: Th
+0001c930: 6520 7361 6d70 6c69 6e67 2072 6174 6520  e sampling rate 
+0001c940: 6f72 2074 696d 6520 696e 7465 7276 616c  or time interval
+0001c950: 2028 696e 2073 616d 706c 6573 2070 6572   (in samples per
+0001c960: 2073 6563 6f6e 642c 2065 2e67 2e2c 2066   second, e.g., f
+0001c970: 7073 2920 6174 2077 6869 6368 2064 6174  ps) at which dat
+0001c980: 6120 706f 696e 7473 2077 6572 6520 636f  a points were co
+0001c990: 6c6c 6563 7465 642e 0a20 2020 2020 2020  llected..       
+0001c9a0: 203a 7265 7475 726e 7320 6e70 2e6e 6461   :returns np.nda
+0001c9b0: 7272 6179 3a20 4120 3244 204e 756d 5079  rray: A 2D NumPy
+0001c9c0: 2061 7272 6179 2063 6f6e 7461 696e 696e   array containin
+0001c9d0: 6720 7468 6520 6361 6c63 756c 6174 6564  g the calculated
+0001c9e0: 2073 6c69 6469 6e67 2070 6869 2063 6f65   sliding phi coe
+0001c9f0: 6666 6963 6965 6e74 732e 2045 6163 6820  fficients. Each 
+0001ca00: 726f 7720 636f 7272 6573 706f 6e64 7320  row corresponds 
+0001ca10: 746f 2074 6865 2070 6869 2063 6f65 6666  to the phi coeff
+0001ca20: 6963 6965 6e74 7320 6361 6c63 756c 6174  icients calculat
+0001ca30: 6564 2066 6f72 2061 2073 7065 6369 6669  ed for a specifi
+0001ca40: 6320 7469 6d65 2070 6f69 6e74 2c20 7468  c time point, th
+0001ca50: 6520 636f 6c75 6d6e 7320 636f 7272 6573  e columns corres
+0001ca60: 706f 6e64 2074 6f20 7469 6d65 2d77 696e  pond to time-win
+0001ca70: 646f 7773 2e0a 0a20 2020 2020 2020 203a  dows...        :
+0001ca80: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+0001ca90: 203e 3e3e 2064 6174 6120 3d20 6e70 2e72   >>> data = np.r
+0001caa0: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+0001cab0: 2032 2c20 2832 3030 2c20 3229 290a 2020   2, (200, 2)).  
+0001cac0: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
+0001cad0: 7469 6373 2829 2e73 6c69 6469 6e67 5f70  tics().sliding_p
+0001cae0: 6869 5f63 6f65 6666 6963 6965 6e74 2864  hi_coefficient(d
+0001caf0: 6174 613d 6461 7461 2c20 7769 6e64 6f77  ata=data, window
+0001cb00: 5f73 697a 6573 3d6e 702e 6172 7261 7928  _sizes=np.array(
+0001cb10: 5b31 2e30 2c20 342e 305d 292c 2073 616d  [1.0, 4.0]), sam
+0001cb20: 706c 655f 7261 7465 3d31 3029 0a20 2020  ple_rate=10).   
+0001cb30: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+0001cb40: 2020 7265 7375 6c74 7320 3d20 6e70 2e66    results = np.f
+0001cb50: 756c 6c28 2864 6174 612e 7368 6170 655b  ull((data.shape[
+0001cb60: 305d 2c20 7769 6e64 6f77 5f73 697a 6573  0], window_sizes
+0001cb70: 2e73 6861 7065 5b30 5d29 2c20 2d31 2e30  .shape[0]), -1.0
+0001cb80: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
+0001cb90: 696e 2070 7261 6e67 6528 7769 6e64 6f77  in prange(window
+0001cba0: 5f73 697a 6573 2e73 6861 7065 5b30 5d29  _sizes.shape[0])
+0001cbb0: 3a0a 2020 2020 2020 2020 2020 2020 7769  :.            wi
+0001cbc0: 6e64 6f77 5f73 697a 6520 3d20 696e 7428  ndow_size = int(
+0001cbd0: 7769 6e64 6f77 5f73 697a 6573 5b69 5d20  window_sizes[i] 
+0001cbe0: 2a20 7361 6d70 6c65 5f72 6174 6529 0a20  * sample_rate). 
+0001cbf0: 2020 2020 2020 2020 2020 2066 6f72 206c             for l
+0001cc00: 2c20 7220 696e 207a 6970 280a 2020 2020  , r in zip(.    
+0001cc10: 2020 2020 2020 2020 2020 2020 7261 6e67              rang
+0001cc20: 6528 302c 2064 6174 612e 7368 6170 655b  e(0, data.shape[
+0001cc30: 305d 202b 2031 292c 2072 616e 6765 2877  0] + 1), range(w
+0001cc40: 696e 646f 775f 7369 7a65 2c20 6461 7461  indow_size, data
+0001cc50: 2e73 6861 7065 5b30 5d20 2b20 3129 0a20  .shape[0] + 1). 
+0001cc60: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+0001cc70: 2020 2020 2020 2020 2020 2020 2020 7361                sa
+0001cc80: 6d70 6c65 203d 2064 6174 615b 6c3a 722c  mple = data[l:r,
+0001cc90: 203a 5d0a 2020 2020 2020 2020 2020 2020   :].            
+0001cca0: 2020 2020 636e 745f 305f 3020 3d20 6c65      cnt_0_0 = le
+0001ccb0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0001ccc0: 2020 2020 2020 206e 702e 6172 6777 6865         np.argwhe
+0001ccd0: 7265 2828 7361 6d70 6c65 5b3a 2c20 305d  re((sample[:, 0]
+0001cce0: 203d 3d20 3029 2026 2028 7361 6d70 6c65   == 0) & (sample
+0001ccf0: 5b3a 2c20 315d 203d 3d20 3029 292e 666c  [:, 1] == 0)).fl
+0001cd00: 6174 7465 6e28 290a 2020 2020 2020 2020  atten().        
+0001cd10: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001cd20: 2020 2020 2020 2020 2020 636e 745f 305f            cnt_0_
+0001cd30: 3120 3d20 6c65 6e28 0a20 2020 2020 2020  1 = len(.       
+0001cd40: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+0001cd50: 6172 6777 6865 7265 2828 7361 6d70 6c65  argwhere((sample
+0001cd60: 5b3a 2c20 305d 203d 3d20 3029 2026 2028  [:, 0] == 0) & (
+0001cd70: 7361 6d70 6c65 5b3a 2c20 315d 203d 3d20  sample[:, 1] == 
+0001cd80: 3129 292e 666c 6174 7465 6e28 290a 2020  1)).flatten().  
+0001cd90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdb0: 636e 745f 315f 3020 3d20 6c65 6e28 0a20  cnt_1_0 = len(. 
+0001cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdd0: 2020 206e 702e 6172 6777 6865 7265 2828     np.argwhere((
+0001cde0: 7361 6d70 6c65 5b3a 2c20 305d 203d 3d20  sample[:, 0] == 
+0001cdf0: 3129 2026 2028 7361 6d70 6c65 5b3a 2c20  1) & (sample[:, 
+0001ce00: 315d 203d 3d20 3029 292e 666c 6174 7465  1] == 0)).flatte
+0001ce10: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
+0001ce20: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0001ce30: 2020 2020 2020 636e 745f 315f 3120 3d20        cnt_1_1 = 
+0001ce40: 6c65 6e28 0a20 2020 2020 2020 2020 2020  len(.           
+0001ce50: 2020 2020 2020 2020 206e 702e 6172 6777           np.argw
+0001ce60: 6865 7265 2828 7361 6d70 6c65 5b3a 2c20  here((sample[:, 
+0001ce70: 305d 203d 3d20 3129 2026 2028 7361 6d70  0] == 1) & (samp
+0001ce80: 6c65 5b3a 2c20 315d 203d 3d20 3129 292e  le[:, 1] == 1)).
+0001ce90: 666c 6174 7465 6e28 290a 2020 2020 2020  flatten().      
+0001cea0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001ceb0: 2020 2020 2020 2020 2020 2020 4243 2c20              BC, 
+0001cec0: 4144 203d 2063 6e74 5f31 5f31 202a 2063  AD = cnt_1_1 * c
+0001ced0: 6e74 5f30 5f30 2c20 636e 745f 315f 3020  nt_0_0, cnt_1_0 
+0001cee0: 2a20 636e 745f 305f 310a 2020 2020 2020  * cnt_0_1.      
+0001cef0: 2020 2020 2020 2020 2020 6e6f 6d69 6e61            nomina
+0001cf00: 746f 7220 3d20 4243 202d 2041 440a 2020  tor = BC - AD.  
+0001cf10: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0001cf20: 6e6f 6d69 6e61 746f 7220 3d20 6e70 2e73  nominator = np.s
+0001cf30: 7172 7428 0a20 2020 2020 2020 2020 2020  qrt(.           
+0001cf40: 2020 2020 2020 2020 2028 636e 745f 315f           (cnt_1_
+0001cf50: 3020 2b20 636e 745f 315f 3129 0a20 2020  0 + cnt_1_1).   
+0001cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf70: 202a 2028 636e 745f 305f 3020 2b20 636e   * (cnt_0_0 + cn
+0001cf80: 745f 305f 3129 0a20 2020 2020 2020 2020  t_0_1).         
+0001cf90: 2020 2020 2020 2020 2020 202a 2028 636e             * (cn
+0001cfa0: 745f 315f 3020 2b20 636e 745f 305f 3029  t_1_0 + cnt_0_0)
+0001cfb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cfc0: 2020 2020 202a 2028 636e 745f 315f 3120       * (cnt_1_1 
+0001cfd0: 2a20 636e 745f 305f 3129 0a20 2020 2020  * cnt_0_1).     
+0001cfe0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001cff0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001d000: 6e6f 6d69 6e61 746f 7220 3d3d 2030 206f  nominator == 0 o
+0001d010: 7220 6465 6e6f 6d69 6e61 746f 7220 3d3d  r denominator ==
+0001d020: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0001d030: 2020 2020 2020 2020 7265 7375 6c74 735b          results[
+0001d040: 7220 2d20 312c 2069 5d20 3d20 302e 300a  r - 1, i] = 0.0.
+0001d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d060: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001d070: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+0001d080: 735b 7220 2d20 312c 2069 5d20 3d20 6e70  s[r - 1, i] = np
+0001d090: 2e61 6273 280a 2020 2020 2020 2020 2020  .abs(.          
+0001d0a0: 2020 2020 2020 2020 2020 2020 2020 2842                (B
+0001d0b0: 4320 2d20 4144 290a 2020 2020 2020 2020  C - AD).        
+0001d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0d0: 2f20 6e70 2e73 7172 7428 0a20 2020 2020  / np.sqrt(.     
+0001d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0f0: 2020 2020 2020 2028 636e 745f 315f 3020         (cnt_1_0 
+0001d100: 2b20 636e 745f 315f 3129 0a20 2020 2020  + cnt_1_1).     
+0001d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d120: 2020 2020 2020 202a 2028 636e 745f 305f         * (cnt_0_
+0001d130: 3020 2b20 636e 745f 305f 3129 0a20 2020  0 + cnt_0_1).   
+0001d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d150: 2020 2020 2020 2020 202a 2028 636e 745f           * (cnt_
+0001d160: 315f 3020 2b20 636e 745f 305f 3029 0a20  1_0 + cnt_0_0). 
+0001d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d180: 2020 2020 2020 2020 2020 202a 2028 636e             * (cn
+0001d190: 745f 315f 3120 2a20 636e 745f 305f 3129  t_1_1 * cnt_0_1)
+0001d1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d1b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001d1c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001d1d0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0001d1e0: 2072 6573 756c 7473 2e61 7374 7970 6528   results.astype(
+0001d1f0: 6e70 2e66 6c6f 6174 3332 290a 0a20 2020  np.float32)..   
+0001d200: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+0001d210: 2020 2040 6e6a 6974 2822 696e 7436 345b     @njit("int64[
+0001d220: 3a5d 2c20 696e 7436 345b 3a5d 2c22 290a  :], int64[:],").
+0001d230: 2020 2020 6465 6620 636f 6865 6e73 5f68      def cohens_h
+0001d240: 2873 616d 706c 655f 313a 206e 702e 6e64  (sample_1: np.nd
+0001d250: 6172 7261 792c 2073 616d 706c 655f 323a  array, sample_2:
+0001d260: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
+0001d270: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
+0001d280: 2222 0a20 2020 2020 2020 204a 6974 7465  "".        Jitte
+0001d290: 6420 636f 6d70 7574 6520 436f 6865 6e27  d compute Cohen'
+0001d2a0: 7320 6820 6566 6665 6374 2073 697a 6520  s h effect size 
+0001d2b0: 666f 7220 7477 6f20 7361 6d70 6c65 7320  for two samples 
+0001d2c0: 6f66 2062 696e 6172 7920 5b30 2c20 315d  of binary [0, 1]
+0001d2d0: 2076 616c 7565 732e 2043 6f68 656e 2773   values. Cohen's
+0001d2e0: 2068 2069 7320 6120 6d65 6173 7572 6520   h is a measure 
+0001d2f0: 6f66 2065 6666 6563 7420 7369 7a65 0a20  of effect size. 
+0001d300: 2020 2020 2020 2066 6f72 2063 6f6d 7061         for compa
+0001d310: 7269 6e67 2074 776f 2069 6e64 6570 656e  ring two indepen
+0001d320: 6465 6e74 2073 616d 706c 6573 2062 6173  dent samples bas
+0001d330: 6564 206f 6e20 7468 6520 6469 6666 6572  ed on the differ
+0001d340: 656e 6365 7320 696e 2070 726f 706f 7274  ences in proport
+0001d350: 696f 6e73 206f 6620 7468 6520 7477 6f20  ions of the two 
+0001d360: 7361 6d70 6c65 732e 0a0a 2020 2020 2020  samples...      
+0001d370: 2020 2e2e 206e 6f74 653a 0a20 2020 2020    .. note:.     
+0001d380: 2020 2020 2020 4d6f 6469 6669 6564 2066        Modified f
+0001d390: 726f 6d20 6044 4142 4553 5420 3c68 7474  rom `DABEST <htt
+0001d3a0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+0001d3b0: 4143 434c 4142 2f44 4142 4553 542d 7079  ACCLAB/DABEST-py
+0001d3c0: 7468 6f6e 2f62 6c6f 622f 6661 3764 6635  thon/blob/fa7df5
+0001d3d0: 3064 3230 6162 3163 3963 6336 3837 6336  0d20ab1c9cc687c6
+0001d3e0: 3664 6438 6264 6466 3535 6439 6139 6463  6dd8bddf55d9a9dc
+0001d3f0: 6533 2f64 6162 6573 742f 5f73 7461 7473  e3/dabest/_stats
+0001d400: 5f74 6f6f 6c73 2f65 6666 7369 7a65 2e70  _tools/effsize.p
+0001d410: 7923 4c32 3136 3e60 5f0a 2020 2020 2020  y#L216>`_.      
+0001d420: 2020 2020 2060 436f 6865 6e27 7320 6820       `Cohen's h 
+0001d430: 7769 6b69 203c 6874 7470 733a 2f2f 656e  wiki <https://en
+0001d440: 2e77 696b 6970 6564 6961 2e6f 7267 2f77  .wikipedia.org/w
+0001d450: 696b 692f 436f 6865 6e25 3237 735f 683e  iki/Cohen%27s_h>
+0001d460: 605f 0a0a 2020 2020 2020 2020 2e2e 206d  `_..        .. m
+0001d470: 6174 683a 3a0a 0a20 2020 2020 2020 2020  ath::..         
+0001d480: 2020 5c5c 7465 7874 7b43 6f68 656e 2773    \\text{Cohen's
+0001d490: 2068 7d20 3d20 3220 5c5c 6172 6373 696e   h} = 2 \\arcsin
+0001d4a0: 5c5c 6c65 6674 285c 5c73 7172 747b 5c5c  \\left(\\sqrt{\\
+0001d4b0: 6672 6163 7b5c 5c73 756d 5c5c 7465 7874  frac{\\sum\\text
+0001d4c0: 7b73 616d 706c 655c 5f31 7d7d 7b4e 5c5f  {sample\_1}}{N\_
+0001d4d0: 317d 7d5c 5c72 6967 6874 2920 2d20 3220  1}}\\right) - 2 
+0001d4e0: 5c5c 6172 6373 696e 5c5c 6c65 6674 285c  \\arcsin\\left(\
+0001d4f0: 5c73 7172 747b 5c5c 6672 6163 7b5c 5c73  \sqrt{\\frac{\\s
+0001d500: 756d 5c5c 7465 7874 7b73 616d 706c 655c  um\\text{sample\
+0001d510: 5f32 7d7d 7b4e 5c5f 327d 7d5c 5c72 6967  _2}}{N\_2}}\\rig
+0001d520: 6874 290a 0a20 2020 2020 2020 2057 6865  ht)..        Whe
+0001d530: 7265 204e 5f31 2061 6e64 204e 5f32 2061  re N_1 and N_2 a
+0001d540: 7265 2074 6865 2073 616d 706c 6520 7369  re the sample si
+0001d550: 7a65 7320 6f66 2073 616d 706c 655f 3120  zes of sample_1 
+0001d560: 616e 6420 7361 6d70 6c65 5f32 2c20 7265  and sample_2, re
+0001d570: 7370 6563 7469 7665 6c79 2e0a 0a20 2020  spectively...   
+0001d580: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
+0001d590: 6461 7272 6179 2073 616d 706c 655f 313a  darray sample_1:
+0001d5a0: 2031 4420 6172 7261 7920 7769 7468 2062   1D array with b
+0001d5b0: 696e 6172 7920 5b30 2c20 315d 2076 616c  inary [0, 1] val
+0001d5c0: 7565 7320 2865 2e67 2e2c 2066 6972 7374  ues (e.g., first
+0001d5d0: 2063 6c61 7373 6966 6965 7220 696e 6665   classifier infe
+0001d5e0: 7265 6e63 6520 7661 6c75 6573 292e 0a20  rence values).. 
+0001d5f0: 2020 2020 2020 203a 7061 7261 6d20 6e70         :param np
+0001d600: 2e6e 6461 7272 6179 2073 616d 706c 655f  .ndarray sample_
+0001d610: 323a 2031 4420 6172 7261 7920 7769 7468  2: 1D array with
+0001d620: 2062 696e 6172 7920 5b30 2c20 315d 2076   binary [0, 1] v
+0001d630: 616c 7565 7320 2865 2e67 2e2c 2073 6563  alues (e.g., sec
+0001d640: 6f6e 6420 636c 6173 7369 6669 6572 2069  ond classifier i
+0001d650: 6e66 6572 656e 6365 2076 616c 7565 7329  nference values)
+0001d660: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+0001d670: 6e20 666c 6f61 743a 2043 6f68 656e 2773  n float: Cohen's
+0001d680: 2068 2065 6666 6563 7420 7369 7a65 2e0a   h effect size..
+0001d690: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
+0001d6a0: 653a 0a20 2020 2020 2020 203e 3e3e 2073  e:.        >>> s
+0001d6b0: 616d 706c 655f 3120 3d20 6e70 2e61 7272  ample_1 = np.arr
+0001d6c0: 6179 285b 312c 2030 2c20 302c 2031 5d29  ay([1, 0, 0, 1])
+0001d6d0: 0a20 2020 2020 2020 203e 3e3e 2073 616d  .        >>> sam
+0001d6e0: 706c 655f 3220 3d20 6e70 2e61 7272 6179  ple_2 = np.array
+0001d6f0: 285b 312c 2031 2c20 312c 2030 5d29 0a20  ([1, 1, 1, 0]). 
+0001d700: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
+0001d710: 7374 6963 7328 292e 636f 6865 6e73 5f68  stics().cohens_h
+0001d720: 2873 616d 706c 655f 313d 7361 6d70 6c65  (sample_1=sample
+0001d730: 5f31 2c20 7361 6d70 6c65 5f32 3d73 616d  _1, sample_2=sam
+0001d740: 706c 655f 3229 0a20 2020 2020 2020 203e  ple_2).        >
+0001d750: 3e3e 202d 302e 3532 3335 3938 3737 3535  >> -0.5235987755
+0001d760: 3938 3239 3835 0a20 2020 2020 2020 2022  982985.        "
+0001d770: 2222 0a0a 2020 2020 2020 2020 7361 6d70  ""..        samp
+0001d780: 6c65 5f31 5f70 726f 706f 7274 696f 6e20  le_1_proportion 
+0001d790: 3d20 6e70 2e73 756d 2873 616d 706c 655f  = np.sum(sample_
+0001d7a0: 3129 202f 2073 616d 706c 655f 312e 7368  1) / sample_1.sh
+0001d7b0: 6170 655b 305d 0a20 2020 2020 2020 2073  ape[0].        s
+0001d7c0: 616d 706c 655f 325f 7072 6f70 6f72 7469  ample_2_proporti
+0001d7d0: 6f6e 203d 206e 702e 7375 6d28 7361 6d70  on = np.sum(samp
+0001d7e0: 6c65 5f32 2920 2f20 7361 6d70 6c65 5f32  le_2) / sample_2
+0001d7f0: 2e73 6861 7065 5b30 5d0a 2020 2020 2020  .shape[0].      
+0001d800: 2020 7068 695f 7361 6d70 6c65 5f31 203d    phi_sample_1 =
+0001d810: 2032 202a 206e 702e 6172 6373 696e 286e   2 * np.arcsin(n
+0001d820: 702e 7371 7274 2873 616d 706c 655f 315f  p.sqrt(sample_1_
+0001d830: 7072 6f70 6f72 7469 6f6e 2929 0a20 2020  proportion)).   
+0001d840: 2020 2020 2070 6869 5f73 616d 706c 655f       phi_sample_
+0001d850: 3220 3d20 3220 2a20 6e70 2e61 7263 7369  2 = 2 * np.arcsi
+0001d860: 6e28 6e70 2e73 7172 7428 7361 6d70 6c65  n(np.sqrt(sample
+0001d870: 5f32 5f70 726f 706f 7274 696f 6e29 290a  _2_proportion)).
+0001d880: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001d890: 7068 695f 7361 6d70 6c65 5f31 202d 2070  phi_sample_1 - p
+0001d8a0: 6869 5f73 616d 706c 655f 320a 0a20 2020  hi_sample_2..   
+0001d8b0: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+0001d8c0: 2020 2040 6a69 7428 2228 666c 6f61 7433     @jit("(float3
+0001d8d0: 325b 3a5d 2c20 666c 6f61 7436 345b 3a5d  2[:], float64[:]
+0001d8e0: 2c20 696e 7436 342c 2922 290a 2020 2020  , int64,)").    
+0001d8f0: 6465 6620 736c 6964 696e 675f 736b 6577  def sliding_skew
+0001d900: 280a 2020 2020 2020 2020 6461 7461 3a20  (.        data: 
+0001d910: 6e70 2e6e 6461 7272 6179 2c20 7469 6d65  np.ndarray, time
+0001d920: 5f77 696e 646f 7773 3a20 6e70 2e6e 6461  _windows: np.nda
+0001d930: 7272 6179 2c20 7361 6d70 6c65 5f72 6174  rray, sample_rat
+0001d940: 653a 2069 6e74 0a20 2020 2029 202d 3e20  e: int.    ) -> 
+0001d950: 6e70 2e6e 6461 7272 6179 3a0a 2020 2020  np.ndarray:.    
+0001d960: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001d970: 436f 6d70 7574 6520 7468 6520 736b 6577  Compute the skew
+0001d980: 6e65 7373 206f 6620 6120 3144 2061 7272  ness of a 1D arr
+0001d990: 6179 2077 6974 6869 6e20 736c 6964 696e  ay within slidin
+0001d9a0: 6720 7469 6d65 2077 696e 646f 7773 2e0a  g time windows..
+0001d9b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001d9c0: 6e70 2e6e 6461 7272 6179 2064 6174 613a  np.ndarray data:
+0001d9d0: 2049 6e70 7574 2064 6174 6120 6172 7261   Input data arra
+0001d9e0: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+0001d9f0: 6d20 6e70 2e6e 6461 7272 6179 2064 6174  m np.ndarray dat
+0001da00: 613a 2031 4420 6172 7261 7920 6f66 2074  a: 1D array of t
+0001da10: 696d 6520 7769 6e64 6f77 2064 7572 6174  ime window durat
+0001da20: 696f 6e73 2069 6e20 7365 636f 6e64 732e  ions in seconds.
+0001da30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001da40: 6e70 2e6e 6461 7272 6179 2064 6174 613a  np.ndarray data:
+0001da50: 2053 616d 706c 696e 6720 7261 7465 206f   Sampling rate o
+0001da60: 6620 7468 6520 6461 7461 2069 6e20 7361  f the data in sa
+0001da70: 6d70 6c65 7320 7065 7220 7365 636f 6e64  mples per second
+0001da80: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+0001da90: 6e20 6e70 2e6e 6461 7272 6179 3a20 3244  n np.ndarray: 2D
+0001daa0: 2061 7272 6179 206f 6620 736b 6577 6e65   array of skewne
+0001dab0: 7373 6031 2076 616c 7565 7320 7769 7468  ss`1 values with
+0001dac0: 2072 6f77 7320 636f 7272 6573 706f 6e64   rows correspond
+0001dad0: 696e 6720 746f 2064 6174 6120 706f 696e  ing to data poin
+0001dae0: 7473 2061 6e64 2063 6f6c 756d 6e73 2063  ts and columns c
+0001daf0: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
+0001db00: 7469 6d65 2077 696e 646f 7773 2e0a 0a20  time windows... 
+0001db10: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+0001db20: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+0001db30: 6120 3d20 6e70 2e72 616e 646f 6d2e 7261  a = np.random.ra
+0001db40: 6e64 696e 7428 302c 2031 3030 2c20 2831  ndint(0, 100, (1
+0001db50: 302c 2929 0a20 2020 2020 2020 203e 3e3e  0,)).        >>>
+0001db60: 2073 6b65 776e 6573 7320 3d20 5374 6174   skewness = Stat
+0001db70: 6973 7469 6373 2829 2e73 6c69 6469 6e67  istics().sliding
+0001db80: 5f73 6b65 7728 6461 7461 3d64 6174 612e  _skew(data=data.
+0001db90: 6173 7479 7065 286e 702e 666c 6f61 7433  astype(np.float3
+0001dba0: 3229 2c20 7469 6d65 5f77 696e 646f 7773  2), time_windows
+0001dbb0: 3d6e 702e 6172 7261 7928 5b31 2e30 2c20  =np.array([1.0, 
+0001dbc0: 322e 305d 292c 2073 616d 706c 655f 7261  2.0]), sample_ra
+0001dbd0: 7465 3d32 290a 2020 2020 2020 2020 2222  te=2).        ""
+0001dbe0: 220a 0a20 2020 2020 2020 2072 6573 756c  "..        resul
+0001dbf0: 7473 203d 206e 702e 6675 6c6c 2828 6461  ts = np.full((da
+0001dc00: 7461 2e73 6861 7065 5b30 5d2c 2074 696d  ta.shape[0], tim
+0001dc10: 655f 7769 6e64 6f77 732e 7368 6170 655b  e_windows.shape[
+0001dc20: 305d 292c 2030 2e30 290a 2020 2020 2020  0]), 0.0).      
+0001dc30: 2020 666f 7220 6920 696e 2070 7261 6e67    for i in prang
+0001dc40: 6528 7469 6d65 5f77 696e 646f 7773 2e73  e(time_windows.s
+0001dc50: 6861 7065 5b30 5d29 3a0a 2020 2020 2020  hape[0]):.      
+0001dc60: 2020 2020 2020 7769 6e64 6f77 5f73 697a        window_siz
+0001dc70: 6520 3d20 696e 7428 7469 6d65 5f77 696e  e = int(time_win
+0001dc80: 646f 7773 5b69 5d20 2a20 7361 6d70 6c65  dows[i] * sample
+0001dc90: 5f72 6174 6529 0a20 2020 2020 2020 2020  _rate).         
+0001dca0: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
+0001dcb0: 6528 7769 6e64 6f77 5f73 697a 652c 2064  e(window_size, d
+0001dcc0: 6174 612e 7368 6170 655b 305d 202b 2031  ata.shape[0] + 1
+0001dcd0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001dce0: 2020 2073 616d 706c 6520 3d20 6461 7461     sample = data
+0001dcf0: 5b6a 202d 2077 696e 646f 775f 7369 7a65  [j - window_size
+0001dd00: 203a 206a 5d0a 2020 2020 2020 2020 2020   : j].          
+0001dd10: 2020 2020 2020 6d65 616e 2c20 7374 6420        mean, std 
+0001dd20: 3d20 6e70 2e6d 6561 6e28 7361 6d70 6c65  = np.mean(sample
+0001dd30: 292c 206e 702e 7374 6428 7361 6d70 6c65  ), np.std(sample
+0001dd40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001dd50: 2020 7265 7375 6c74 735b 6a20 2d20 315d    results[j - 1]
+0001dd60: 5b69 5d20 3d20 2831 202f 2073 616d 706c  [i] = (1 / sampl
+0001dd70: 652e 7368 6170 655b 305d 2920 2a20 6e70  e.shape[0]) * np
+0001dd80: 2e73 756d 280a 2020 2020 2020 2020 2020  .sum(.          
+0001dd90: 2020 2020 2020 2020 2020 2828 6461 7461            ((data
+0001dda0: 202d 206d 6561 6e29 202f 2073 7464 2920   - mean) / std) 
+0001ddb0: 2a2a 2033 0a20 2020 2020 2020 2020 2020  ** 3.           
+0001ddc0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001ddd0: 7265 7475 726e 2072 6573 756c 7473 0a0a  return results..
+0001dde0: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+0001ddf0: 640a 2020 2020 406a 6974 2822 2866 6c6f  d.    @jit("(flo
+0001de00: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3634  at32[:], float64
+0001de10: 5b3a 5d2c 2069 6e74 3634 2c29 2229 0a20  [:], int64,)"). 
+0001de20: 2020 2064 6566 2073 6c69 6469 6e67 5f6b     def sliding_k
+0001de30: 7572 746f 7369 7328 0a20 2020 2020 2020  urtosis(.       
+0001de40: 2064 6174 613a 206e 702e 6e64 6172 7261   data: np.ndarra
+0001de50: 792c 2074 696d 655f 7769 6e64 6f77 733a  y, time_windows:
+0001de60: 206e 702e 6e64 6172 7261 792c 2073 616d   np.ndarray, sam
+0001de70: 706c 655f 7261 7465 3a20 696e 740a 2020  ple_rate: int.  
+0001de80: 2020 2920 2d3e 206e 702e 6e64 6172 7261    ) -> np.ndarra
+0001de90: 793a 0a20 2020 2020 2020 2022 2222 0a20  y:.        """. 
+0001dea0: 2020 2020 2020 2043 6f6d 7075 7465 2074         Compute t
+0001deb0: 6865 206b 7572 746f 7369 7320 6f66 2061  he kurtosis of a
+0001dec0: 2031 4420 6172 7261 7920 7769 7468 696e   1D array within
+0001ded0: 2073 6c69 6469 6e67 2074 696d 6520 7769   sliding time wi
+0001dee0: 6e64 6f77 732e 0a0a 2020 2020 2020 2020  ndows...        
+0001def0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+0001df00: 7920 6461 7461 3a20 496e 7075 7420 6461  y data: Input da
+0001df10: 7461 2061 7272 6179 2e0a 2020 2020 2020  ta array..      
+0001df20: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+0001df30: 7261 7920 7469 6d65 5f77 696e 646f 7773  ray time_windows
+0001df40: 3a20 3144 2061 7272 6179 206f 6620 7469  : 1D array of ti
+0001df50: 6d65 2077 696e 646f 7720 6475 7261 7469  me window durati
+0001df60: 6f6e 7320 696e 2073 6563 6f6e 6473 2e0a  ons in seconds..
+0001df70: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+0001df80: 702e 6e64 6172 7261 7920 7361 6d70 6c65  p.ndarray sample
+0001df90: 5f72 6174 653a 2053 616d 706c 696e 6720  _rate: Sampling 
+0001dfa0: 7261 7465 206f 6620 7468 6520 6461 7461  rate of the data
+0001dfb0: 2069 6e20 7361 6d70 6c65 7320 7065 7220   in samples per 
+0001dfc0: 7365 636f 6e64 2e0a 2020 2020 2020 2020  second..        
+0001dfd0: 3a72 6574 7572 6e20 6e70 2e6e 6461 7272  :return np.ndarr
+0001dfe0: 6179 3a20 3244 2061 7272 6179 206f 6620  ay: 2D array of 
+0001dff0: 736b 6577 6e65 7373 6031 2076 616c 7565  skewness`1 value
+0001e000: 7320 7769 7468 2072 6f77 7320 636f 7272  s with rows corr
+0001e010: 6573 706f 6e64 696e 6720 746f 2064 6174  esponding to dat
+0001e020: 6120 706f 696e 7473 2061 6e64 2063 6f6c  a points and col
+0001e030: 756d 6e73 2063 6f72 7265 7370 6f6e 6469  umns correspondi
+0001e040: 6e67 2074 6f20 7469 6d65 2077 696e 646f  ng to time windo
+0001e050: 7773 2e0a 0a20 2020 2020 2020 203a 6578  ws...        :ex
+0001e060: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+0001e070: 3e3e 2064 6174 6120 3d20 6e70 2e72 616e  >> data = np.ran
+0001e080: 646f 6d2e 7261 6e64 696e 7428 302c 2031  dom.randint(0, 1
+0001e090: 3030 2c20 2831 302c 2929 0a20 2020 2020  00, (10,)).     
+0001e0a0: 2020 203e 3e3e 206b 7572 746f 7369 7320     >>> kurtosis 
+0001e0b0: 3d20 5374 6174 6973 7469 6373 2829 2e73  = Statistics().s
+0001e0c0: 6c69 6469 6e67 5f6b 7572 746f 7369 7328  liding_kurtosis(
+0001e0d0: 6461 7461 3d64 6174 612e 6173 7479 7065  data=data.astype
+0001e0e0: 286e 702e 666c 6f61 7433 3229 2c20 7469  (np.float32), ti
+0001e0f0: 6d65 5f77 696e 646f 7773 3d6e 702e 6172  me_windows=np.ar
+0001e100: 7261 7928 5b31 2e30 2c20 322e 305d 292c  ray([1.0, 2.0]),
+0001e110: 2073 616d 706c 655f 7261 7465 3d32 290a   sample_rate=2).
+0001e120: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001e130: 2020 2020 7265 7375 6c74 7320 3d20 6e70      results = np
+0001e140: 2e66 756c 6c28 2864 6174 612e 7368 6170  .full((data.shap
+0001e150: 655b 305d 2c20 7469 6d65 5f77 696e 646f  e[0], time_windo
+0001e160: 7773 2e73 6861 7065 5b30 5d29 2c20 302e  ws.shape[0]), 0.
+0001e170: 3029 0a20 2020 2020 2020 2066 6f72 2069  0).        for i
+0001e180: 2069 6e20 7072 616e 6765 2874 696d 655f   in prange(time_
+0001e190: 7769 6e64 6f77 732e 7368 6170 655b 305d  windows.shape[0]
+0001e1a0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
+0001e1b0: 696e 646f 775f 7369 7a65 203d 2074 696d  indow_size = tim
+0001e1c0: 655f 7769 6e64 6f77 735b 695d 202a 2073  e_windows[i] * s
+0001e1d0: 616d 706c 655f 7261 7465 0a20 2020 2020  ample_rate.     
+0001e1e0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
+0001e1f0: 7261 6e67 6528 7769 6e64 6f77 5f73 697a  range(window_siz
+0001e200: 652c 2064 6174 612e 7368 6170 655b 305d  e, data.shape[0]
+0001e210: 202b 2031 293a 0a20 2020 2020 2020 2020   + 1):.         
+0001e220: 2020 2020 2020 2073 616d 706c 6520 3d20         sample = 
+0001e230: 6461 7461 5b6a 202d 2077 696e 646f 775f  data[j - window_
+0001e240: 7369 7a65 203a 206a 5d0a 2020 2020 2020  size : j].      
+0001e250: 2020 2020 2020 2020 2020 6d65 616e 2c20            mean, 
+0001e260: 7374 6420 3d20 6e70 2e6d 6561 6e28 7361  std = np.mean(sa
+0001e270: 6d70 6c65 292c 206e 702e 7374 6428 7361  mple), np.std(sa
+0001e280: 6d70 6c65 290a 2020 2020 2020 2020 2020  mple).          
+0001e290: 2020 2020 2020 7265 7375 6c74 735b 6a20        results[j 
+0001e2a0: 2d20 315d 5b69 5d20 3d20 6e70 2e6d 6561  - 1][i] = np.mea
+0001e2b0: 6e28 2828 6461 7461 202d 206d 6561 6e29  n(((data - mean)
+0001e2c0: 202f 2073 7464 2920 2a2a 2034 2920 2d20   / std) ** 4) - 
+0001e2d0: 330a 2020 2020 2020 2020 7265 7475 726e  3.        return
+0001e2e0: 2072 6573 756c 7473 0a0a 2020 2020 4073   results..    @s
+0001e2f0: 7461 7469 636d 6574 686f 640a 2020 2020  taticmethod.    
+0001e300: 406a 6974 286e 6f70 7974 686f 6e3d 5472  @jit(nopython=Tr
+0001e310: 7565 290a 2020 2020 6465 6620 6b6d 6561  ue).    def kmea
+0001e320: 6e73 5f31 6428 0a20 2020 2020 2020 2064  ns_1d(.        d
+0001e330: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+0001e340: 206b 3a20 696e 742c 206d 6178 5f69 7465   k: int, max_ite
+0001e350: 7273 3a20 696e 742c 2063 616c 635f 6d65  rs: int, calc_me
+0001e360: 6469 616e 733a 2062 6f6f 6c0a 2020 2020  dians: bool.    
+0001e370: 2920 2d3e 2054 7570 6c65 5b6e 702e 6e64  ) -> Tuple[np.nd
+0001e380: 6172 7261 792c 206e 702e 6e64 6172 7261  array, np.ndarra
+0001e390: 792c 2055 6e69 6f6e 5b4e 6f6e 652c 2074  y, Union[None, t
+0001e3a0: 7970 6573 2e44 6963 7454 7970 655d 5d3a  ypes.DictType]]:
+0001e3b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001e3c0: 2020 2020 2050 6572 666f 726d 206b 2d6d       Perform k-m
+0001e3d0: 6561 6e73 2063 6c75 7374 6572 696e 6720  eans clustering 
+0001e3e0: 6f6e 2061 2031 2d64 696d 656e 7369 6f6e  on a 1-dimension
+0001e3f0: 616c 2064 6174 6173 6574 2e0a 0a20 2020  al dataset...   
+0001e400: 2020 2020 202e 2e20 6e6f 7465 3a0a 2020       .. note:.  
+0001e410: 2020 2020 2020 2020 202d 2049 6620 6361           - If ca
+0001e420: 6c63 5f6d 6564 6961 6e73 2069 7320 5472  lc_medians is Tr
+0001e430: 7565 2c20 7468 6520 6675 6e63 7469 6f6e  ue, the function
+0001e440: 2072 6574 7572 6e73 2063 6c75 7374 6572   returns cluster
+0001e450: 206d 6564 6961 6e73 2069 6e20 6164 6469   medians in addi
+0001e460: 7469 6f6e 2074 6f20 6365 6e74 726f 6964  tion to centroid
+0001e470: 7320 616e 6420 6c61 6265 6c73 2e0a 0a20  s and labels... 
+0001e480: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0001e490: 7220 6e70 2e6e 6461 7272 6179 2064 6174  r np.ndarray dat
+0001e4a0: 613a 2031 6420 6172 7261 7920 636f 6e74  a: 1d array cont
+0001e4b0: 6169 6e69 6e67 2066 6561 7475 7265 2076  aining feature v
+0001e4c0: 616c 7565 732e 0a20 2020 2020 2020 203a  alues..        :
+0001e4d0: 7061 7261 6d65 7465 7220 696e 7420 6b3a  parameter int k:
+0001e4e0: 204e 756d 6265 7220 6f66 2063 6c75 7374   Number of clust
+0001e4f0: 6572 732e 0a20 2020 2020 2020 203a 7061  ers..        :pa
+0001e500: 7261 6d65 7465 7220 696e 7420 6d61 785f  rameter int max_
+0001e510: 6974 6572 733a 204d 6178 696d 756d 206e  iters: Maximum n
+0001e520: 756d 6265 7220 6f66 2069 7465 7261 7469  umber of iterati
+0001e530: 6f6e 7320 666f 7220 7468 6520 6b2d 6d65  ons for the k-me
+0001e540: 616e 7320 616c 676f 7269 7468 6d2e 0a20  ans algorithm.. 
+0001e550: 2020 2020 2020 203a 7061 7261 6d65 7465         :paramete
+0001e560: 7220 626f 6f6c 2063 616c 635f 6d65 6469  r bool calc_medi
+0001e570: 616e 733a 2046 6c61 6720 696e 6469 6361  ans: Flag indica
+0001e580: 7469 6e67 2077 6865 7468 6572 2074 6f20  ting whether to 
+0001e590: 6361 6c63 756c 6174 6520 636c 7573 7465  calculate cluste
+0001e5a0: 7220 6d65 6469 616e 732e 0a20 2020 2020  r medians..     
+0001e5b0: 2020 203a 7265 7475 726e 7320 5475 706c     :returns Tupl
+0001e5c0: 653a 2054 7570 6c65 206f 6620 7468 7265  e: Tuple of thre
+0001e5d0: 6520 656c 656d 656e 7473 2e20 4669 6e61  e elements. Fina
+0001e5e0: 6c20 6365 6e74 726f 6964 7320 6f66 2074  l centroids of t
+0001e5f0: 6865 2063 6c75 7374 6572 732e 204c 6162  he clusters. Lab
+0001e600: 656c 7320 6173 7369 676e 6564 2074 6f20  els assigned to 
+0001e610: 6561 6368 2064 6174 6120 706f 696e 7420  each data point 
+0001e620: 6261 7365 6420 6f6e 2063 6c75 7374 6572  based on cluster
+0001e630: 732e 2043 6c75 7374 6572 206d 6564 6961  s. Cluster media
+0001e640: 6e73 2028 6966 2063 616c 635f 6d65 6469  ns (if calc_medi
+0001e650: 616e 7320 6973 2054 7275 6529 2c20 6f74  ans is True), ot
+0001e660: 6865 7277 6973 6520 4e6f 6e65 2e0a 0a20  herwise None... 
+0001e670: 2020 2020 2020 203a 6578 616d 706c 653a         :example:
+0001e680: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+0001e690: 615f 3164 203d 206e 702e 6172 7261 7928  a_1d = np.array(
+0001e6a0: 5b31 2c20 322c 2033 2c20 3535 2c20 3635  [1, 2, 3, 55, 65
+0001e6b0: 2c20 3430 2c20 3433 2c20 3430 5d29 2e61  , 40, 43, 40]).a
+0001e6c0: 7374 7970 6528 6e70 2e66 6c6f 6174 3634  stype(np.float64
+0001e6d0: 290a 2020 2020 2020 2020 3e3e 3e20 6365  ).        >>> ce
+0001e6e0: 6e74 726f 6964 732c 206c 6162 656c 732c  ntroids, labels,
+0001e6f0: 206d 6564 6961 6e73 203d 2053 7461 7469   medians = Stati
+0001e700: 7374 6963 7328 292e 6b6d 6561 6e73 5f31  stics().kmeans_1
+0001e710: 6428 6461 7461 5f31 642c 2032 2c20 3130  d(data_1d, 2, 10
+0001e720: 3030 2c20 5472 7565 290a 2020 2020 2020  00, True).      
+0001e730: 2020 2222 220a 0a20 2020 2020 2020 2064    """..        d
+0001e740: 6174 6120 3d20 6e70 2e61 7363 6f6e 7469  ata = np.asconti
+0001e750: 6775 6f75 7361 7272 6179 2864 6174 6129  guousarray(data)
+0001e760: 0a20 2020 2020 2020 2058 203d 2064 6174  .        X = dat
+0001e770: 612e 7265 7368 6170 6528 2864 6174 612e  a.reshape((data.
+0001e780: 7368 6170 655b 305d 2c20 3129 290a 2020  shape[0], 1)).  
+0001e790: 2020 2020 2020 6c61 6265 6c73 2c20 6d65        labels, me
+0001e7a0: 6469 616e 7320 3d20 4e6f 6e65 2c20 4e6f  dians = None, No
+0001e7b0: 6e65 0a20 2020 2020 2020 2063 656e 7472  ne.        centr
+0001e7c0: 6f69 6473 203d 2058 5b6e 702e 7261 6e64  oids = X[np.rand
+0001e7d0: 6f6d 2e63 686f 6963 6528 6461 7461 2e73  om.choice(data.s
+0001e7e0: 6861 7065 5b30 5d2c 206b 2c20 7265 706c  hape[0], k, repl
+0001e7f0: 6163 653d 4661 6c73 6529 5d2e 636f 7079  ace=False)].copy
+0001e800: 2829 0a20 2020 2020 2020 2066 6f72 205f  ().        for _
+0001e810: 2069 6e20 7261 6e67 6528 6d61 785f 6974   in range(max_it
+0001e820: 6572 7329 3a0a 2020 2020 2020 2020 2020  ers):.          
+0001e830: 2020 6c61 6265 6c73 203d 206e 702e 7a65    labels = np.ze
+0001e840: 726f 7328 582e 7368 6170 655b 305d 2c20  ros(X.shape[0], 
+0001e850: 6474 7970 653d 6e70 2e69 6e74 3634 290a  dtype=np.int64).
+0001e860: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001e870: 6920 696e 2072 616e 6765 2858 2e73 6861  i in range(X.sha
+0001e880: 7065 5b30 5d29 3a0a 2020 2020 2020 2020  pe[0]):.        
+0001e890: 2020 2020 2020 2020 6d69 6e5f 6469 7374          min_dist
+0001e8a0: 203d 206e 702e 696e 660a 2020 2020 2020   = np.inf.      
+0001e8b0: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
+0001e8c0: 696e 2072 616e 6765 286b 293a 0a20 2020  in range(k):.   
+0001e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8e0: 2064 6973 7420 3d20 6e70 2e61 6273 2858   dist = np.abs(X
+0001e8f0: 5b69 5d20 2d20 6365 6e74 726f 6964 735b  [i] - centroids[
+0001e900: 6a5d 290a 2020 2020 2020 2020 2020 2020  j]).            
+0001e910: 2020 2020 2020 2020 6469 7374 5f73 756d          dist_sum
+0001e920: 203d 206e 702e 7375 6d28 6469 7374 290a   = np.sum(dist).
+0001e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e940: 2020 2020 6966 2064 6973 745f 7375 6d20      if dist_sum 
+0001e950: 3c20 6d69 6e5f 6469 7374 3a0a 2020 2020  < min_dist:.    
+0001e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e970: 2020 2020 6d69 6e5f 6469 7374 203d 2064      min_dist = d
+0001e980: 6973 745f 7375 6d0a 2020 2020 2020 2020  ist_sum.        
+0001e990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e9a0: 6c61 6265 6c73 5b69 5d20 3d20 6a0a 0a20  labels[i] = j.. 
+0001e9b0: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
+0001e9c0: 656e 7472 6f69 6473 203d 206e 702e 7a65  entroids = np.ze
+0001e9d0: 726f 735f 6c69 6b65 2863 656e 7472 6f69  ros_like(centroi
+0001e9e0: 6473 290a 2020 2020 2020 2020 2020 2020  ds).            
+0001e9f0: 636f 756e 7473 203d 206e 702e 7a65 726f  counts = np.zero
+0001ea00: 7328 6b2c 2064 7479 7065 3d6e 702e 696e  s(k, dtype=np.in
+0001ea10: 7436 3429 0a20 2020 2020 2020 2020 2020  t64).           
+0001ea20: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0001ea30: 582e 7368 6170 655b 305d 293a 0a20 2020  X.shape[0]):.   
+0001ea40: 2020 2020 2020 2020 2020 2020 2063 6c75               clu
+0001ea50: 7374 6572 203d 206c 6162 656c 735b 695d  ster = labels[i]
+0001ea60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ea70: 206e 6577 5f63 656e 7472 6f69 6473 5b63   new_centroids[c
+0001ea80: 6c75 7374 6572 5d20 2b3d 2058 5b69 5d0a  luster] += X[i].
+0001ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eaa0: 636f 756e 7473 5b63 6c75 7374 6572 5d20  counts[cluster] 
+0001eab0: 2b3d 2031 0a0a 2020 2020 2020 2020 2020  += 1..          
+0001eac0: 2020 666f 7220 6a20 696e 2072 616e 6765    for j in range
+0001ead0: 286b 293a 0a20 2020 2020 2020 2020 2020  (k):.           
+0001eae0: 2020 2020 2069 6620 636f 756e 7473 5b6a       if counts[j
+0001eaf0: 5d20 3e20 303a 0a20 2020 2020 2020 2020  ] > 0:.         
+0001eb00: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
+0001eb10: 656e 7472 6f69 6473 5b6a 5d20 2f3d 2063  entroids[j] /= c
+0001eb20: 6f75 6e74 735b 6a5d 0a0a 2020 2020 2020  ounts[j]..      
+0001eb30: 2020 2020 2020 6966 206e 702e 6172 7261        if np.arra
+0001eb40: 795f 6571 7561 6c28 6365 6e74 726f 6964  y_equal(centroid
+0001eb50: 732c 206e 6577 5f63 656e 7472 6f69 6473  s, new_centroids
+0001eb60: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001eb70: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+0001eb80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001eb90: 2020 2020 2020 2020 2020 2063 656e 7472             centr
+0001eba0: 6f69 6473 203d 206e 6577 5f63 656e 7472  oids = new_centr
+0001ebb0: 6f69 6473 0a0a 2020 2020 2020 2020 6966  oids..        if
+0001ebc0: 2063 616c 635f 6d65 6469 616e 733a 0a20   calc_medians:. 
+0001ebd0: 2020 2020 2020 2020 2020 206c 6162 656c             label
+0001ebe0: 732c 206d 6564 6961 6e73 203d 206c 6162  s, medians = lab
+0001ebf0: 656c 732e 6173 7479 7065 286e 702e 696e  els.astype(np.in
+0001ec00: 7436 3429 2c20 7b7d 0a20 2020 2020 2020  t64), {}.       
+0001ec10: 2020 2020 2066 6f72 2069 2069 6e20 7072       for i in pr
+0001ec20: 616e 6765 2830 2c20 6b2c 2031 293a 0a20  ange(0, k, 1):. 
+0001ec30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0001ec40: 6564 6961 6e73 5b69 5d20 3d20 6e70 2e6d  edians[i] = np.m
+0001ec50: 6564 6961 6e28 6461 7461 5b6e 702e 6172  edian(data[np.ar
+0001ec60: 6777 6865 7265 286c 6162 656c 7320 3d3d  gwhere(labels ==
+0001ec70: 2069 292e 666c 6174 7465 6e28 295d 290a   i).flatten()]).
+0001ec80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001ec90: 6365 6e74 726f 6964 732c 206c 6162 656c  centroids, label
+0001eca0: 732c 206d 6564 6961 6e73 0a0a 2020 2020  s, medians..    
+0001ecb0: 4073 7461 7469 636d 6574 686f 640a 2020  @staticmethod.  
+0001ecc0: 2020 406e 6a69 7428 0a20 2020 2020 2020    @njit(.       
+0001ecd0: 205b 0a20 2020 2020 2020 2020 2020 2028   [.            (
+0001ece0: 696e 7438 5b3a 5d2c 2069 6e74 385b 3a5d  int8[:], int8[:]
+0001ecf0: 2c20 7479 7065 732e 6d69 7363 2e4f 6d69  , types.misc.Omi
+0001ed00: 7474 6564 2876 616c 7565 3d46 616c 7365  tted(value=False
+0001ed10: 292c 2066 6c6f 6174 3332 5b3a 5d29 2c0a  ), float32[:]),.
+0001ed20: 2020 2020 2020 2020 2020 2020 280a 2020              (.  
+0001ed30: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0001ed40: 7438 5b3a 5d2c 0a20 2020 2020 2020 2020  t8[:],.         
+0001ed50: 2020 2020 2020 2069 6e74 385b 3a5d 2c0a         int8[:],.
+0001ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed70: 7479 7065 732e 6d69 7363 2e4f 6d69 7474  types.misc.Omitt
+0001ed80: 6564 2876 616c 7565 3d46 616c 7365 292c  ed(value=False),
+0001ed90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001eda0: 2074 7970 6573 2e6d 6973 632e 4f6d 6974   types.misc.Omit
+0001edb0: 7465 6428 4e6f 6e65 292c 0a20 2020 2020  ted(None),.     
+0001edc0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+0001edd0: 2020 2020 2020 2869 6e74 385b 3a5d 2c20        (int8[:], 
+0001ede0: 696e 7438 5b3a 5d2c 2062 6f6f 6c5f 2c20  int8[:], bool_, 
+0001edf0: 666c 6f61 7433 325b 3a5d 292c 0a20 2020  float32[:]),.   
+0001ee00: 2020 2020 2020 2020 2028 696e 7438 5b3a           (int8[:
+0001ee10: 5d2c 2069 6e74 385b 3a5d 2c20 626f 6f6c  ], int8[:], bool
+0001ee20: 5f2c 2074 7970 6573 2e6d 6973 632e 4f6d  _, types.misc.Om
+0001ee30: 6974 7465 6428 4e6f 6e65 2929 2c0a 2020  itted(None)),.  
+0001ee40: 2020 2020 2020 5d0a 2020 2020 290a 2020        ].    ).  
+0001ee50: 2020 6465 6620 6861 6d6d 696e 675f 6469    def hamming_di
+0001ee60: 7374 616e 6365 280a 2020 2020 2020 2020  stance(.        
+0001ee70: 783a 206e 702e 6e64 6172 7261 792c 0a20  x: np.ndarray,. 
+0001ee80: 2020 2020 2020 2079 3a20 6e70 2e6e 6461         y: np.nda
+0001ee90: 7272 6179 2c0a 2020 2020 2020 2020 736f  rray,.        so
+0001eea0: 7274 3a20 4f70 7469 6f6e 616c 5b62 6f6f  rt: Optional[boo
+0001eeb0: 6c5d 203d 2046 616c 7365 2c0a 2020 2020  l] = False,.    
+0001eec0: 2020 2020 773a 204f 7074 696f 6e61 6c5b      w: Optional[
+0001eed0: 6e70 2e6e 6461 7272 6179 5d20 3d20 4e6f  np.ndarray] = No
+0001eee0: 6e65 2c0a 2020 2020 2920 2d3e 2066 6c6f  ne,.    ) -> flo
+0001eef0: 6174 3a0a 2020 2020 2020 2020 2222 220a  at:.        """.
+0001ef00: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
+0001ef10: 6f6d 7075 7465 206f 6620 7468 6520 4861  ompute of the Ha
+0001ef20: 6d6d 696e 6720 7369 6d69 6c61 7269 7479  mming similarity
+0001ef30: 2062 6574 7765 656e 2074 776f 2076 6563   between two vec
+0001ef40: 746f 7273 2e0a 0a20 2020 2020 2020 2054  tors...        T
+0001ef50: 6865 2048 616d 6d69 6e67 2073 696d 696c  he Hamming simil
+0001ef60: 6172 6974 7920 6d65 6173 7572 6573 2074  arity measures t
+0001ef70: 6865 2073 696d 696c 6172 6974 7920 6265  he similarity be
+0001ef80: 7477 6565 6e20 7477 6f20 6269 6e61 7279  tween two binary
+0001ef90: 2076 6563 746f 7273 2062 7920 636f 756e   vectors by coun
+0001efa0: 7469 6e67 2074 6865 206e 756d 6265 7220  ting the number 
+0001efb0: 6f66 2070 6f73 6974 696f 6e73 2061 7420  of positions at 
+0001efc0: 7768 6963 6820 7468 6520 636f 7272 6573  which the corres
+0001efd0: 706f 6e64 696e 6720 656c 656d 656e 7473  ponding elements
+0001efe0: 2061 7265 2064 6966 6665 7265 6e74 2e0a   are different..
+0001eff0: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+0001f000: 3a3a 0a20 2020 2020 2020 2020 2020 4966  ::.           If
+0001f010: 2077 2069 7320 6e6f 7420 7072 6f76 6964   w is not provid
+0001f020: 6564 2c20 6571 7561 6c20 7765 6967 6874  ed, equal weight
+0001f030: 7320 6172 6520 6173 7375 6d65 642e 2041  s are assumed. A
+0001f040: 6461 7074 6564 2066 726f 6d20 6070 796e  dapted from `pyn
+0001f050: 6e64 6573 6365 6e74 203c 6874 7470 733a  ndescent <https:
+0001f060: 2f2f 7079 6e6e 6465 7363 656e 742e 7265  //pynndescent.re
+0001f070: 6164 7468 6564 6f63 732e 696f 2f65 6e2f  adthedocs.io/en/
+0001f080: 6c61 7465 7374 2f3e 605f 2e0a 0a20 2020  latest/>`_...   
+0001f090: 2020 2020 202e 2e20 6d61 7468 3a3a 0a0a       .. math::..
+0001f0a0: 2020 2020 2020 2020 2020 205c 5c74 6578             \\tex
+0001f0b0: 747b 4861 6d6d 696e 6720 6469 7374 616e  t{Hamming distan
+0001f0c0: 6365 7d28 782c 2079 2920 3d20 5c5c 6672  ce}(x, y) = \\fr
+0001f0d0: 6163 7b7b 5c5c 7375 6d5f 7b69 3d31 7d5e  ac{{\\sum_{i=1}^
+0001f0e0: 7b6e 7d20 775f 697d 7d7b 7b6e 7d7d 0a0a  {n} w_i}}{{n}}..
+0001f0f0: 2020 2020 2020 2020 7768 6572 653a 0a20          where:. 
+0001f100: 2020 2020 2020 2020 2020 2d20 5c28 206e            - \( n
+0001f110: 205c 2920 6973 2074 6865 206c 656e 6774   \) is the lengt
+0001f120: 6820 6f66 2074 6865 2076 6563 746f 7273  h of the vectors
+0001f130: 2c0a 2020 2020 2020 2020 2020 202d 205c  ,.           - \
+0001f140: 2820 775f 6920 5c29 2069 7320 7468 6520  ( w_i \) is the 
+0001f150: 7765 6967 6874 2061 7373 6f63 6961 7465  weight associate
+0001f160: 6420 7769 7468 2074 6865 205c 2820 6920  d with the \( i 
+0001f170: 5c29 7468 2065 6c65 6d65 6e74 206f 6620  \)th element of 
+0001f180: 7468 6520 7665 6374 6f72 732e 0a0a 2020  the vectors...  
+0001f190: 2020 2020 2020 3a70 6172 616d 6574 6572        :parameter
+0001f1a0: 206e 702e 6e64 6172 7261 7920 783a 2046   np.ndarray x: F
+0001f1b0: 6972 7374 2062 696e 6172 7920 7665 6374  irst binary vect
+0001f1c0: 6f72 2e0a 2020 2020 2020 2020 3a70 6172  or..        :par
+0001f1d0: 616d 6574 6572 206e 702e 6e64 6172 7261  ameter np.ndarra
+0001f1e0: 7920 783a 2053 6563 6f6e 6420 6269 6e61  y x: Second bina
+0001f1f0: 7279 2076 6563 746f 722e 0a20 2020 2020  ry vector..     
+0001f200: 2020 203a 7061 7261 6d65 7465 7220 4f70     :parameter Op
+0001f210: 7469 6f6e 616c 5b6e 702e 6e64 6172 7261  tional[np.ndarra
+0001f220: 795d 2077 3a20 4f70 7469 6f6e 616c 2077  y] w: Optional w
+0001f230: 6569 6768 7473 2066 6f72 2065 6163 6820  eights for each 
+0001f240: 656c 656d 656e 742e 2043 616e 2062 6520  element. Can be 
+0001f250: 636c 6173 7369 6669 6361 7469 6f6e 2070  classification p
+0001f260: 726f 6261 6269 6c69 7469 6573 2e20 4966  robabilities. If
+0001f270: 206e 6f74 2070 726f 7669 6465 642c 2065   not provided, e
+0001f280: 7175 616c 2077 6569 6768 7473 2061 7265  qual weights are
+0001f290: 2061 7373 756d 6564 2e0a 2020 2020 2020   assumed..      
+0001f2a0: 2020 3a70 6172 616d 6574 6572 204f 7074    :parameter Opt
+0001f2b0: 696f 6e61 6c5b 626f 6f6c 5d20 736f 7274  ional[bool] sort
+0001f2c0: 3a20 4966 2054 7275 652c 2073 6f72 7473  : If True, sorts
+0001f2d0: 2078 2061 6e64 2079 2070 7269 6f72 2074   x and y prior t
+0001f2e0: 6f20 6861 6d6d 696e 6720 6469 7374 616e  o hamming distan
+0001f2f0: 6365 2063 616c 6375 6c61 7469 6f6e 2e20  ce calculation. 
+0001f300: 4465 6661 756c 742c 2046 616c 7365 2e0a  Default, False..
+0001f310: 0a20 2020 2020 2020 203a 6578 616d 706c  .        :exampl
+0001f320: 653a 0a20 2020 2020 2020 203e 3e3e 2078  e:.        >>> x
+0001f330: 2c20 7920 3d20 6e70 2e72 616e 646f 6d2e  , y = np.random.
+0001f340: 7261 6e64 696e 7428 302c 2032 2c20 2831  randint(0, 2, (1
+0001f350: 302c 2929 2e61 7374 7970 6528 6e70 2e69  0,)).astype(np.i
+0001f360: 6e74 3829 2c20 6e70 2e72 616e 646f 6d2e  nt8), np.random.
+0001f370: 7261 6e64 696e 7428 302c 2032 2c20 2831  randint(0, 2, (1
+0001f380: 302c 2929 2e61 7374 7970 6528 6e70 2e69  0,)).astype(np.i
+0001f390: 6e74 3829 0a20 2020 2020 2020 203e 3e3e  nt8).        >>>
+0001f3a0: 2053 7461 7469 7374 6963 7328 292e 6861   Statistics().ha
+0001f3b0: 6d6d 696e 675f 6469 7374 616e 6365 2878  mming_distance(x
+0001f3c0: 3d78 2c20 793d 7929 0a20 2020 2020 2020  =x, y=y).       
+0001f3d0: 203e 3e3e 2030 2e39 310a 2020 2020 2020   >>> 0.91.      
+0001f3e0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+0001f3f0: 7061 7373 0a20 2020 2020 2020 2069 6620  pass.        if 
+0001f400: 7720 6973 204e 6f6e 653a 0a20 2020 2020  w is None:.     
+0001f410: 2020 2020 2020 2077 203d 206e 702e 6f6e         w = np.on
+0001f420: 6573 2878 2e73 6861 7065 5b30 5d29 2e61  es(x.shape[0]).a
+0001f430: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+0001f440: 290a 0a20 2020 2020 2020 2072 6573 756c  )..        resul
+0001f450: 7473 203d 2030 2e30 0a20 2020 2020 2020  ts = 0.0.       
+0001f460: 2069 6620 736f 7274 3a0a 2020 2020 2020   if sort:.      
+0001f470: 2020 2020 2020 782c 2079 203d 206e 702e        x, y = np.
+0001f480: 736f 7274 2878 292c 206e 702e 736f 7274  sort(x), np.sort
+0001f490: 2879 290a 2020 2020 2020 2020 666f 7220  (y).        for 
+0001f4a0: 6920 696e 2070 7261 6e67 6528 782e 7368  i in prange(x.sh
+0001f4b0: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+0001f4c0: 2020 2020 2069 6620 785b 695d 2021 3d20       if x[i] != 
+0001f4d0: 795b 695d 3a0a 2020 2020 2020 2020 2020  y[i]:.          
+0001f4e0: 2020 2020 2020 7265 7375 6c74 7320 2b3d        results +=
+0001f4f0: 2031 2e30 202a 2077 5b69 5d0a 2020 2020   1.0 * w[i].    
+0001f500: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
+0001f510: 7473 202f 2078 2e73 6861 7065 5b30 5d0a  ts / x.shape[0].
+0001f520: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+0001f530: 6f64 0a20 2020 2040 6e6a 6974 280a 2020  od.    @njit(.  
+0001f540: 2020 2020 2020 5b28 696e 7438 5b3a 5d2c        [(int8[:],
+0001f550: 2069 6e74 385b 3a5d 2c20 666c 6f61 7433   int8[:], float3
+0001f560: 325b 3a5d 292c 2028 696e 7438 5b3a 5d2c  2[:]), (int8[:],
+0001f570: 2069 6e74 385b 3a5d 2c20 7479 7065 732e   int8[:], types.
+0001f580: 6d69 7363 2e4f 6d69 7474 6564 284e 6f6e  misc.Omitted(Non
+0001f590: 6529 295d 0a20 2020 2029 0a20 2020 2064  e))].    ).    d
+0001f5a0: 6566 2079 756c 655f 636f 6566 280a 2020  ef yule_coef(.  
+0001f5b0: 2020 2020 2020 783a 206e 702e 6e64 6172        x: np.ndar
+0001f5c0: 7261 792c 2079 3a20 6e70 2e6e 6461 7272  ray, y: np.ndarr
+0001f5d0: 6179 2c20 773a 204f 7074 696f 6e61 6c5b  ay, w: Optional[
+0001f5e0: 6e70 2e6e 6461 7272 6179 5d20 3d20 4e6f  np.ndarray] = No
+0001f5f0: 6e65 0a20 2020 2029 202d 3e20 666c 6f61  ne.    ) -> floa
+0001f600: 7436 343a 0a20 2020 2020 2020 2022 2222  t64:.        """
+0001f610: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
+0001f620: 6361 6c63 756c 6174 6520 6f66 2074 6865  calculate of the
+0001f630: 2079 756c 6520 636f 6566 6669 6369 656e   yule coefficien
+0001f640: 7420 6265 7477 6565 6e20 7477 6f20 6269  t between two bi
+0001f650: 6e61 7279 2076 6563 746f 7273 2028 652e  nary vectors (e.
+0001f660: 672e 2c20 746f 2063 6c61 7373 6966 6965  g., to classifie
+0001f670: 6420 6265 6861 7669 6f72 7329 2e20 3020  d behaviors). 0 
+0001f680: 7265 7072 6573 656e 7420 696e 6465 7065  represent indepe
+0001f690: 6e64 656e 6365 2c20 3220 7265 7072 6573  ndence, 2 repres
+0001f6a0: 656e 7473 0a20 2020 2020 2020 2063 6f6d  ents.        com
+0001f6b0: 706c 6574 6520 696e 7465 7264 6570 656e  plete interdepen
+0001f6c0: 6465 6e63 652e 0a0a 2020 2020 2020 2020  dence...        
+0001f6d0: 2e2e 206d 6174 683a 3a0a 2020 2020 2020  .. math::.      
+0001f6e0: 2020 2020 2059 756c 6520 436f 6566 6669       Yule Coeffi
+0001f6f0: 6369 656e 7420 3d20 5c5c 6672 6163 7b7b  cient = \\frac{{
+0001f700: 3220 5c63 646f 7420 745f 6620 5c63 646f  2 \cdot t_f \cdo
+0001f710: 7420 665f 747d 7d7b 7b74 5f74 205c 6364  t f_t}}{{t_t \cd
+0001f720: 6f74 2066 5f66 202b 2074 5f66 205c 6364  ot f_f + t_f \cd
+0001f730: 6f74 2066 5f74 7d7d 0a0a 2020 2020 2020  ot f_t}}..      
+0001f740: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
+0001f750: 2020 2020 2020 2041 6461 7074 6564 2066         Adapted f
+0001f760: 726f 6d20 6070 796e 6e64 6573 6365 6e74  rom `pynndescent
+0001f770: 203c 6874 7470 733a 2f2f 7079 6e6e 6465   <https://pynnde
+0001f780: 7363 656e 742e 7265 6164 7468 6564 6f63  scent.readthedoc
+0001f790: 732e 696f 2f65 6e2f 6c61 7465 7374 2f3e  s.io/en/latest/>
+0001f7a0: 605f 2e0a 0a20 2020 2020 2020 203a 7061  `_...        :pa
+0001f7b0: 7261 6d65 7465 7220 6e70 2e6e 6461 7272  rameter np.ndarr
+0001f7c0: 6179 2078 3a20 4669 7273 7420 6269 6e61  ay x: First bina
+0001f7d0: 7279 2076 6563 746f 722e 0a20 2020 2020  ry vector..     
+0001f7e0: 2020 203a 7061 7261 6d65 7465 7220 6e70     :parameter np
+0001f7f0: 2e6e 6461 7272 6179 2078 3a20 5365 636f  .ndarray x: Seco
+0001f800: 6e64 2062 696e 6172 7920 7665 6374 6f72  nd binary vector
+0001f810: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001f820: 6574 6572 204f 7074 696f 6e61 6c5b 6e70  eter Optional[np
+0001f830: 2e6e 6461 7272 6179 5d20 773a 204f 7074  .ndarray] w: Opt
+0001f840: 696f 6e61 6c20 7765 6967 6874 7320 666f  ional weights fo
+0001f850: 7220 6561 6368 2065 6c65 6d65 6e74 2e20  r each element. 
+0001f860: 4361 6e20 6265 2063 6c61 7373 6966 6963  Can be classific
+0001f870: 6174 696f 6e20 7072 6f62 6162 696c 6974  ation probabilit
+0001f880: 6965 732e 2049 6620 6e6f 7420 7072 6f76  ies. If not prov
+0001f890: 6964 6564 2c20 6571 7561 6c20 7765 6967  ided, equal weig
+0001f8a0: 6874 7320 6172 6520 6173 7375 6d65 642e  hts are assumed.
+0001f8b0: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+0001f8c0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+0001f8d0: 7820 3d20 6e70 2e72 616e 646f 6d2e 7261  x = np.random.ra
+0001f8e0: 6e64 696e 7428 302c 2032 2c20 2835 302c  ndint(0, 2, (50,
+0001f8f0: 2929 2e61 7374 7970 6528 6e70 2e69 6e74  )).astype(np.int
+0001f900: 3829 0a20 2020 2020 2020 203e 3e3e 2079  8).        >>> y
+0001f910: 203d 2078 205e 2031 0a20 2020 2020 2020   = x ^ 1.       
+0001f920: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+0001f930: 292e 7975 6c65 5f63 6f65 6628 783d 782c  ).yule_coef(x=x,
+0001f940: 2079 3d79 290a 2020 2020 2020 2020 3e3e   y=y).        >>
+0001f950: 3e20 320a 2020 2020 2020 2020 3e3e 3e20  > 2.        >>> 
+0001f960: 7261 6e64 6f6d 5f69 6e64 6963 6573 203d  random_indices =
+0001f970: 206e 702e 7261 6e64 6f6d 2e63 686f 6963   np.random.choic
+0001f980: 6528 6c65 6e28 7829 2c20 7369 7a65 3d6c  e(len(x), size=l
+0001f990: 656e 2878 292f 2f32 2c20 7265 706c 6163  en(x)//2, replac
+0001f9a0: 653d 4661 6c73 6529 0a20 2020 2020 2020  e=False).       
+0001f9b0: 203e 3e3e 2079 203d 206e 702e 636f 7079   >>> y = np.copy
+0001f9c0: 2878 290a 2020 2020 2020 2020 3e3e 3e20  (x).        >>> 
+0001f9d0: 795b 7261 6e64 6f6d 5f69 6e64 6963 6573  y[random_indices
+0001f9e0: 5d20 3d20 3120 2d20 795b 7261 6e64 6f6d  ] = 1 - y[random
+0001f9f0: 5f69 6e64 6963 6573 5d0a 2020 2020 2020  _indices].      
+0001fa00: 2020 3e3e 3e20 5374 6174 6973 7469 6373    >>> Statistics
+0001fa10: 2829 2e79 756c 655f 636f 6566 2878 3d78  ().yule_coef(x=x
+0001fa20: 2c20 793d 7929 0a20 2020 2020 2020 203e  , y=y).        >
+0001fa30: 3e3e 2030 2e39 390a 2020 2020 2020 2020  >> 0.99.        
+0001fa40: 2222 220a 2020 2020 2020 2020 6966 2077  """.        if w
+0001fa50: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001fa60: 2020 2020 2020 7720 3d20 6e70 2e6f 6e65        w = np.one
+0001fa70: 7328 782e 7368 6170 655b 305d 292e 6173  s(x.shape[0]).as
+0001fa80: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0001fa90: 0a0a 2020 2020 2020 2020 665f 662c 2074  ..        f_f, t
+0001faa0: 5f74 2c20 745f 662c 2066 5f74 203d 2030  _t, t_f, f_t = 0
+0001fab0: 2e30 2c20 302e 302c 2030 2e30 2c20 302e  .0, 0.0, 0.0, 0.
+0001fac0: 300a 2020 2020 2020 2020 666f 7220 6920  0.        for i 
+0001fad0: 696e 2070 7261 6e67 6528 782e 7368 6170  in prange(x.shap
+0001fae0: 655b 305d 293a 0a20 2020 2020 2020 2020  e[0]):.         
+0001faf0: 2020 2069 6620 2878 5b69 5d20 3d3d 2031     if (x[i] == 1
+0001fb00: 2920 616e 6420 2879 5b69 5d20 3d3d 2031  ) and (y[i] == 1
+0001fb10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001fb20: 2020 2074 5f74 202b 3d20 3120 2a20 775b     t_t += 1 * w[
+0001fb30: 695d 0a20 2020 2020 2020 2020 2020 2069  i].            i
+0001fb40: 6620 2878 5b69 5d20 3d3d 2030 2920 616e  f (x[i] == 0) an
+0001fb50: 6420 2879 5b69 5d20 3d3d 2030 293a 0a20  d (y[i] == 0):. 
+0001fb60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001fb70: 5f66 202b 3d20 3120 2a20 775b 695d 0a20  _f += 1 * w[i]. 
+0001fb80: 2020 2020 2020 2020 2020 2069 6620 2878             if (x
+0001fb90: 5b69 5d20 3d3d 2030 2920 616e 6420 2879  [i] == 0) and (y
+0001fba0: 5b69 5d20 3d3d 2031 293a 0a20 2020 2020  [i] == 1):.     
+0001fbb0: 2020 2020 2020 2020 2020 2066 5f74 202b             f_t +
+0001fbc0: 3d20 3120 2a20 775b 695d 0a20 2020 2020  = 1 * w[i].     
+0001fbd0: 2020 2020 2020 2069 6620 2878 5b69 5d20         if (x[i] 
+0001fbe0: 3d3d 2031 2920 616e 6420 2879 5b69 5d20  == 1) and (y[i] 
+0001fbf0: 3d3d 2030 293a 0a20 2020 2020 2020 2020  == 0):.         
+0001fc00: 2020 2020 2020 2074 5f66 202b 3d20 3120         t_f += 1 
+0001fc10: 2a20 775b 695d 0a20 2020 2020 2020 2069  * w[i].        i
+0001fc20: 6620 745f 6620 3d3d 2030 2e30 206f 7220  f t_f == 0.0 or 
+0001fc30: 665f 7420 3d3d 2030 2e30 3a0a 2020 2020  f_t == 0.0:.    
+0001fc40: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+0001fc50: 2e30 0a20 2020 2020 2020 2065 6c73 653a  .0.        else:
+0001fc60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001fc70: 7572 6e20 2832 2e30 202a 2074 5f66 202a  urn (2.0 * t_f *
+0001fc80: 2066 5f74 2920 2f20 2874 5f74 202a 2066   f_t) / (t_t * f
+0001fc90: 5f66 202b 2074 5f66 202a 2066 5f74 290a  _f + t_f * f_t).
+0001fca0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+0001fcb0: 6f64 0a20 2020 2040 6e6a 6974 280a 2020  od.    @njit(.  
+0001fcc0: 2020 2020 2020 5b28 696e 7438 5b3a 5d2c        [(int8[:],
+0001fcd0: 2069 6e74 385b 3a5d 2c20 7479 7065 732e   int8[:], types.
+0001fce0: 6d69 7363 2e4f 6d69 7474 6564 284e 6f6e  misc.Omitted(Non
+0001fcf0: 6529 292c 2028 696e 7438 5b3a 5d2c 2069  e)), (int8[:], i
+0001fd00: 6e74 385b 3a5d 2c20 666c 6f61 7433 325b  nt8[:], float32[
+0001fd10: 3a5d 295d 0a20 2020 2029 0a20 2020 2064  :])].    ).    d
+0001fd20: 6566 2073 6f6b 616c 5f73 6e65 6174 6828  ef sokal_sneath(
+0001fd30: 0a20 2020 2020 2020 2078 3a20 6e70 2e6e  .        x: np.n
+0001fd40: 6461 7272 6179 2c20 793a 206e 702e 6e64  darray, y: np.nd
+0001fd50: 6172 7261 792c 2077 3a20 4f70 7469 6f6e  array, w: Option
+0001fd60: 616c 5b6e 702e 6e64 6172 7261 795d 203d  al[np.ndarray] =
+0001fd70: 204e 6f6e 650a 2020 2020 2920 2d3e 2066   None.    ) -> f
+0001fd80: 6c6f 6174 3634 3a0a 2020 2020 2020 2020  loat64:.        
+0001fd90: 2222 220a 2020 2020 2020 2020 4a69 7474  """.        Jitt
+0001fda0: 6564 2063 616c 6375 6c61 7465 206f 6620  ed calculate of 
+0001fdb0: 7468 6520 736f 6b61 6c20 736e 6561 7468  the sokal sneath
+0001fdc0: 2063 6f65 6666 6963 6965 6e74 2062 6574   coefficient bet
+0001fdd0: 7765 656e 2074 776f 2062 696e 6172 7920  ween two binary 
+0001fde0: 7665 6374 6f72 7320 2865 2e67 2e2c 2074  vectors (e.g., t
+0001fdf0: 6f20 636c 6173 7369 6669 6564 2062 6568  o classified beh
+0001fe00: 6176 696f 7273 292e 2030 2072 6570 7265  aviors). 0 repre
+0001fe10: 7365 6e74 2069 6e64 6570 656e 6465 6e63  sent independenc
+0001fe20: 652c 2031 2072 6570 7265 7365 6e74 7320  e, 1 represents 
+0001fe30: 636f 6d70 6c65 7465 2069 6e74 6572 6465  complete interde
+0001fe40: 7065 6e64 656e 6365 2e0a 0a20 2020 2020  pendence...     
+0001fe50: 2020 202e 2e20 6d61 7468 3a3a 0a20 2020     .. math::.   
+0001fe60: 2020 2020 2020 2020 536f 6b61 6c2d 536e          Sokal-Sn
+0001fe70: 6561 7468 203d 205c 5c66 7261 637b 7b66  eath = \\frac{{f
+0001fe80: 5f74 202b 2074 5f66 7d7d 7b7b 3220 5c63  _t + t_f}}{{2 \c
+0001fe90: 646f 7420 2874 5f7b 7b63 6e74 7d7d 202b  dot (t_{{cnt}} +
+0001fea0: 2066 5f7b 7b63 6e74 7d7d 2920 2b20 665f   f_{{cnt}}) + f_
+0001feb0: 7420 2b20 745f 667d 7d0a 0a20 2020 2020  t + t_f}}..     
+0001fec0: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
+0001fed0: 2020 2020 2020 2020 4164 6170 7465 6420          Adapted 
+0001fee0: 6672 6f6d 2060 7079 6e6e 6465 7363 656e  from `pynndescen
+0001fef0: 7420 3c68 7474 7073 3a2f 2f70 796e 6e64  t <https://pynnd
+0001ff00: 6573 6365 6e74 2e72 6561 6474 6865 646f  escent.readthedo
+0001ff10: 6373 2e69 6f2f 656e 2f6c 6174 6573 742f  cs.io/en/latest/
+0001ff20: 3e60 5f2e 0a0a 2020 2020 2020 2020 3a70  >`_...        :p
+0001ff30: 6172 616d 6574 6572 206e 702e 6e64 6172  arameter np.ndar
+0001ff40: 7261 7920 783a 2046 6972 7374 2062 696e  ray x: First bin
+0001ff50: 6172 7920 7665 6374 6f72 2e0a 2020 2020  ary vector..    
+0001ff60: 2020 2020 3a70 6172 616d 6574 6572 206e      :parameter n
+0001ff70: 702e 6e64 6172 7261 7920 783a 2053 6563  p.ndarray x: Sec
+0001ff80: 6f6e 6420 6269 6e61 7279 2076 6563 746f  ond binary vecto
+0001ff90: 722e 0a20 2020 2020 2020 203a 7061 7261  r..        :para
+0001ffa0: 6d65 7465 7220 4f70 7469 6f6e 616c 5b6e  meter Optional[n
+0001ffb0: 702e 6e64 6172 7261 795d 2077 3a20 4f70  p.ndarray] w: Op
+0001ffc0: 7469 6f6e 616c 2077 6569 6768 7473 2066  tional weights f
+0001ffd0: 6f72 2065 6163 6820 656c 656d 656e 742e  or each element.
+0001ffe0: 2043 616e 2062 6520 636c 6173 7369 6669   Can be classifi
+0001fff0: 6361 7469 6f6e 2070 726f 6261 6269 6c69  cation probabili
+00020000: 7469 6573 2e20 4966 206e 6f74 2070 726f  ties. If not pro
+00020010: 7669 6465 642c 2065 7175 616c 2077 6569  vided, equal wei
+00020020: 6768 7473 2061 7265 2061 7373 756d 6564  ghts are assumed
+00020030: 2e0a 0a20 2020 2020 2020 203a 6578 616d  ...        :exam
+00020040: 706c 653a 0a20 2020 2020 2020 203e 3e3e  ple:.        >>>
+00020050: 2078 203d 206e 702e 6172 7261 7928 5b30   x = np.array([0
+00020060: 2c20 312c 2030 2c20 302c 2031 5d29 2e61  , 1, 0, 0, 1]).a
+00020070: 7374 7970 6528 6e70 2e69 6e74 3829 0a20  stype(np.int8). 
+00020080: 2020 2020 2020 203e 3e3e 2079 203d 206e         >>> y = n
+00020090: 702e 6172 7261 7928 5b31 2c20 302c 2031  p.array([1, 0, 1
+000200a0: 2c20 312c 2030 5d29 2e61 7374 7970 6528  , 1, 0]).astype(
+000200b0: 6e70 2e69 6e74 3829 0a20 2020 2020 2020  np.int8).       
+000200c0: 203e 3e3e 2053 7461 7469 7374 6963 7328   >>> Statistics(
+000200d0: 292e 736f 6b61 6c5f 736e 6561 7468 2878  ).sokal_sneath(x
+000200e0: 2c20 7929 0a20 2020 2020 2020 203e 3e3e  , y).        >>>
+000200f0: 2030 2e30 0a20 2020 2020 2020 2022 2222   0.0.        """
+00020100: 0a20 2020 2020 2020 2069 6620 7720 6973  .        if w is
+00020110: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00020120: 2020 2077 203d 206e 702e 6f6e 6573 2878     w = np.ones(x
+00020130: 2e73 6861 7065 5b30 5d29 2e61 7374 7970  .shape[0]).astyp
+00020140: 6528 666c 6f61 7433 3229 0a20 2020 2020  e(float32).     
+00020150: 2020 2074 5f63 6e74 2c20 665f 636e 742c     t_cnt, f_cnt,
+00020160: 2074 5f66 2c20 665f 7420 3d20 302e 302c   t_f, f_t = 0.0,
+00020170: 2030 2e30 2c20 302e 302c 2030 2e30 0a20   0.0, 0.0, 0.0. 
+00020180: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00020190: 7072 616e 6765 2878 2e73 6861 7065 5b30  prange(x.shape[0
+000201a0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+000201b0: 6966 2028 785b 695d 203d 3d20 3129 2061  if (x[i] == 1) a
+000201c0: 6e64 2028 795b 695d 203d 3d20 3129 3a0a  nd (y[i] == 1):.
+000201d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000201e0: 745f 636e 7420 2b3d 2031 2e30 202a 2077  t_cnt += 1.0 * w
+000201f0: 5b69 5d0a 2020 2020 2020 2020 2020 2020  [i].            
+00020200: 656c 6966 2028 785b 695d 203d 3d20 3029  elif (x[i] == 0)
+00020210: 2061 6e64 2028 795b 695d 203d 3d20 3029   and (y[i] == 0)
+00020220: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00020230: 2020 665f 636e 7420 2b3d 2031 2e30 202a    f_cnt += 1.0 *
+00020240: 2077 5b69 5d0a 2020 2020 2020 2020 2020   w[i].          
+00020250: 2020 656c 6966 2028 785b 695d 203d 3d20    elif (x[i] == 
+00020260: 3029 2061 6e64 2028 795b 695d 203d 3d20  0) and (y[i] == 
+00020270: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+00020280: 2020 2020 665f 7420 2b3d 2031 2e30 202a      f_t += 1.0 *
+00020290: 2077 5b69 5d0a 2020 2020 2020 2020 2020   w[i].          
+000202a0: 2020 656c 6966 2028 785b 695d 203d 3d20    elif (x[i] == 
+000202b0: 3129 2061 6e64 2028 795b 695d 203d 3d20  1) and (y[i] == 
+000202c0: 3029 3a0a 2020 2020 2020 2020 2020 2020  0):.            
+000202d0: 2020 2020 745f 6620 2b3d 2031 2e30 202a      t_f += 1.0 *
+000202e0: 2077 5b69 5d0a 0a20 2020 2020 2020 2069   w[i]..        i
+000202f0: 6620 745f 6620 2b20 665f 7420 3d3d 2030  f t_f + f_t == 0
+00020300: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
+00020310: 7265 7475 726e 2030 2e30 0a20 2020 2020  return 0.0.     
+00020320: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00020330: 2020 2020 2072 6574 7572 6e20 2866 5f74       return (f_t
+00020340: 202b 2074 5f66 2920 2f20 2832 202a 2028   + t_f) / (2 * (
+00020350: 745f 636e 7420 2b20 665f 636e 7429 202b  t_cnt + f_cnt) +
+00020360: 2066 5f74 202b 2074 5f66 290a 0a20 2020   f_t + t_f)..   
+00020370: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
+00020380: 2020 2040 6e6a 6974 285b 2866 6c6f 6174     @njit([(float
+00020390: 3332 5b3a 2c20 3a5d 2c20 666c 6f61 7433  32[:, :], float3
+000203a0: 325b 3a2c 203a 5d29 2c20 2866 6c6f 6174  2[:, :]), (float
+000203b0: 3332 5b3a 2c20 3a5d 2c20 7479 7065 732e  32[:, :], types.
+000203c0: 6d69 7363 2e4f 6d69 7474 6564 284e 6f6e  misc.Omitted(Non
+000203d0: 6529 295d 290a 2020 2020 6465 6620 6272  e))]).    def br
+000203e0: 6179 5f63 7572 7469 735f 6469 7373 696d  ay_curtis_dissim
+000203f0: 696c 6172 6974 7928 0a20 2020 2020 2020  ilarity(.       
+00020400: 2078 3a20 6e70 2e6e 6461 7272 6179 2c20   x: np.ndarray, 
+00020410: 773a 204f 7074 696f 6e61 6c5b 6e70 2e6e  w: Optional[np.n
+00020420: 6461 7272 6179 5d20 3d20 4e6f 6e65 0a20  darray] = None. 
+00020430: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
+00020440: 6179 3a0a 2020 2020 2020 2020 2222 220a  ay:.        """.
+00020450: 2020 2020 2020 2020 4a69 7474 6564 2063          Jitted c
+00020460: 6f6d 7075 7465 206f 6620 7468 6520 4272  ompute of the Br
+00020470: 6179 2d43 7572 7469 7320 6469 7373 696d  ay-Curtis dissim
+00020480: 696c 6172 6974 7920 6d61 7472 6978 2062  ilarity matrix b
+00020490: 6574 7765 656e 2073 616d 706c 6573 2062  etween samples b
+000204a0: 6173 6564 206f 6e20 6665 6174 7572 6520  ased on feature 
+000204b0: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
+000204c0: 2054 6865 2042 7261 792d 4375 7274 6973   The Bray-Curtis
+000204d0: 2064 6973 7369 6d69 6c61 7269 7479 206d   dissimilarity m
+000204e0: 6561 7375 7265 7320 7468 6520 6469 7373  easures the diss
+000204f0: 696d 696c 6172 6974 7920 6265 7477 6565  imilarity betwee
+00020500: 6e20 7477 6f20 7361 6d70 6c65 7320 6261  n two samples ba
+00020510: 7365 6420 6f6e 2074 6865 6972 2066 6561  sed on their fea
+00020520: 7475 7265 2076 616c 7565 732e 0a20 2020  ture values..   
+00020530: 2020 2020 2049 7420 6973 2075 7365 6675       It is usefu
+00020540: 6c20 666f 7220 6669 6e64 696e 6720 7369  l for finding si
+00020550: 6d69 6c61 7220 6672 616d 6573 2062 6173  milar frames bas
+00020560: 6564 206f 6e20 6265 6861 7669 6f72 2e0a  ed on behavior..
+00020570: 0a20 2020 2020 2020 2055 7365 6675 6c20  .        Useful 
+00020580: 666f 7220 6669 6e64 696e 6720 7369 6d69  for finding simi
+00020590: 6c61 7220 6672 616d 6573 2062 6173 6564  lar frames based
+000205a0: 206f 6e20 6265 6861 7669 6f72 2e0a 0a20   on behavior... 
+000205b0: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+000205c0: 0a20 2020 2020 2020 2020 2020 4164 6170  .           Adap
+000205d0: 7465 6420 6672 6f6d 2060 7079 6e6e 6465  ted from `pynnde
+000205e0: 7363 656e 7420 3c68 7474 7073 3a2f 2f70  scent <https://p
+000205f0: 796e 6e64 6573 6365 6e74 2e72 6561 6474  ynndescent.readt
+00020600: 6865 646f 6373 2e69 6f2f 656e 2f6c 6174  hedocs.io/en/lat
+00020610: 6573 742f 3e60 5f2e 0a0a 2020 2020 2020  est/>`_...      
+00020620: 2020 3a70 6172 616d 6574 6572 206e 702e    :parameter np.
+00020630: 6e64 6172 7261 7920 783a 2032 6420 6172  ndarray x: 2d ar
+00020640: 7261 7920 7769 7468 206c 696b 656c 7920  ray with likely 
+00020650: 6e6f 726d 616c 697a 6564 2066 6561 7475  normalized featu
+00020660: 7265 2076 616c 7565 732e 0a20 2020 2020  re values..     
+00020670: 2020 203a 7061 7261 6d65 7465 7220 4f70     :parameter Op
+00020680: 7469 6f6e 616c 5b6e 702e 6e64 6172 7261  tional[np.ndarra
+00020690: 795d 2077 3a20 4f70 7469 6f6e 616c 2032  y] w: Optional 2
+000206a0: 6420 6172 7261 7920 7769 7468 2077 6569  d array with wei
+000206b0: 6768 7473 206f 6620 7361 6d65 2073 697a  ghts of same siz
+000206c0: 6520 6173 2078 2e20 4465 6661 756c 7420  e as x. Default 
+000206d0: 4e6f 6e65 2061 6e64 2061 6c6c 206f 6273  None and all obs
+000206e0: 6572 7661 7469 6f6e 7320 7769 6c6c 2068  ervations will h
+000206f0: 6176 6520 7468 6520 7361 6d65 2077 6569  ave the same wei
+00020700: 6768 742e 0a20 2020 2020 2020 203a 7265  ght..        :re
+00020710: 7475 726e 7320 6e70 2e6e 6461 7272 6179  turns np.ndarray
+00020720: 3a20 3264 2061 7272 6179 2077 6974 6820  : 2d array with 
+00020730: 7361 6d65 2073 697a 6520 6173 2078 2072  same size as x r
+00020740: 6570 7265 7365 6e74 696e 6720 6469 7373  epresenting diss
+00020750: 696d 696c 6172 6974 7920 7661 6c75 6573  imilarity values
+00020760: 2e20 3020 616e 6420 7468 6520 6f62 7365  . 0 and the obse
+00020770: 7276 6174 696f 6e73 2061 7265 2069 6465  rvations are ide
+00020780: 6e74 6963 616c 2061 6e64 2061 7420 3120  ntical and at 1 
+00020790: 7468 6520 6f62 7365 7276 6174 696f 6e73  the observations
+000207a0: 2061 7265 2063 6f6d 706c 6574 6c79 2064   are completly d
+000207b0: 6973 696d 696c 6172 2e0a 0a20 2020 2020  isimilar...     
+000207c0: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
+000207d0: 2020 2020 203e 3e3e 2078 203d 206e 702e       >>> x = np.
+000207e0: 6172 7261 7928 5b5b 312c 2031 2c20 312c  array([[1, 1, 1,
+000207f0: 2031 2c20 315d 2c20 5b30 2c20 302c 2030   1, 1], [0, 0, 0
+00020800: 2c20 302c 2030 5d2c 205b 302c 2030 2c20  , 0, 0], [0, 0, 
+00020810: 302c 2030 2c20 305d 2c20 5b31 2c20 312c  0, 0, 0], [1, 1,
+00020820: 2031 2c20 312c 2031 5d5d 292e 6173 7479   1, 1, 1]]).asty
+00020830: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+00020840: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
+00020850: 7374 6963 7328 292e 6272 6179 5f63 7572  stics().bray_cur
+00020860: 7469 735f 6469 7373 696d 696c 6172 6974  tis_dissimilarit
+00020870: 7928 783d 7829 0a20 2020 2020 2020 203e  y(x=x).        >
+00020880: 3e3e 205b 5b30 2c20 312e 2c20 312e 2c20  >> [[0, 1., 1., 
+00020890: 302e 5d2c 205b 312e 2c20 302e 2c20 302e  0.], [1., 0., 0.
+000208a0: 2c20 312e 5d2c 205b 312e 2c20 302e 2c20  , 1.], [1., 0., 
+000208b0: 302e 2c20 312e 5d2c 205b 302e 2c20 312e  0., 1.], [0., 1.
+000208c0: 2c20 312e 2c20 302e 5d5d 0a20 2020 2020  , 1., 0.]].     
+000208d0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+000208e0: 6620 7720 6973 204e 6f6e 653a 0a20 2020  f w is None:.   
+000208f0: 2020 2020 2020 2020 2077 203d 206e 702e           w = np.
+00020900: 6f6e 6573 2828 782e 7368 6170 655b 305d  ones((x.shape[0]
+00020910: 2c20 782e 7368 6170 655b 305d 2929 2e61  , x.shape[0])).a
+00020920: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+00020930: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
+00020940: 7320 3d20 6e70 2e66 756c 6c28 2878 2e73  s = np.full((x.s
+00020950: 6861 7065 5b30 5d2c 2078 2e73 6861 7065  hape[0], x.shape
+00020960: 5b30 5d29 2c20 302e 3029 0a20 2020 2020  [0]), 0.0).     
+00020970: 2020 2066 6f72 2069 2069 6e20 7072 616e     for i in pran
+00020980: 6765 2878 2e73 6861 7065 5b30 5d29 3a0a  ge(x.shape[0]):.
+00020990: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000209a0: 6a20 696e 2072 616e 6765 2869 202b 2031  j in range(i + 1
+000209b0: 2c20 782e 7368 6170 655b 305d 293a 0a20  , x.shape[0]):. 
+000209c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000209d0: 312c 2073 322c 206e 756d 2c20 6465 6e20  1, s2, num, den 
+000209e0: 3d20 785b 695d 2c20 785b 6a5d 2c20 302e  = x[i], x[j], 0.
+000209f0: 302c 2030 2e30 0a20 2020 2020 2020 2020  0, 0.0.         
+00020a00: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
+00020a10: 7261 6e67 6528 7331 2e73 6861 7065 5b30  range(s1.shape[0
+00020a20: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+00020a30: 2020 2020 2020 2020 6e75 6d20 2b3d 206e          num += n
+00020a40: 702e 6162 7328 7331 5b6b 5d20 2d20 7332  p.abs(s1[k] - s2
+00020a50: 5b6b 5d29 0a20 2020 2020 2020 2020 2020  [k]).           
+00020a60: 2020 2020 2020 2020 2064 656e 202b 3d20           den += 
+00020a70: 6e70 2e61 6273 2873 315b 6b5d 202b 2073  np.abs(s1[k] + s
+00020a80: 325b 6b5d 290a 2020 2020 2020 2020 2020  2[k]).          
+00020a90: 2020 2020 2020 6966 2064 656e 203d 3d20        if den == 
+00020aa0: 302e 303a 0a20 2020 2020 2020 2020 2020  0.0:.           
+00020ab0: 2020 2020 2020 2020 2076 616c 203d 2030           val = 0
+00020ac0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+00020ad0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00020ae0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00020af0: 203d 2028 666c 6f61 7428 6e75 6d29 202f   = (float(num) /
+00020b00: 2064 656e 2920 2a20 775b 692c 206a 5d0a   den) * w[i, j].
+00020b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b20: 7265 7375 6c74 735b 692c 206a 5d20 3d20  results[i, j] = 
+00020b30: 7661 6c0a 2020 2020 2020 2020 2020 2020  val.            
+00020b40: 2020 2020 7265 7375 6c74 735b 6a2c 2069      results[j, i
+00020b50: 5d20 3d20 7661 6c0a 2020 2020 2020 2020  ] = val.        
+00020b60: 7265 7475 726e 2072 6573 756c 7473 2e61  return results.a
+00020b70: 7374 7970 6528 666c 6f61 7433 3229 0a0a  stype(float32)..
+00020b80: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00020b90: 640a 2020 2020 406e 6a69 7428 2866 6c6f  d.    @njit((flo
+00020ba0: 6174 3332 5b3a 5d2c 2066 6c6f 6174 3332  at32[:], float32
+00020bb0: 5b3a 5d29 290a 2020 2020 6465 6620 5f68  [:])).    def _h
+00020bc0: 656c 6c69 6e67 6572 5f68 656c 7065 7228  ellinger_helper(
+00020bd0: 783a 206e 702e 6e64 6172 7261 792c 2079  x: np.ndarray, y
+00020be0: 3a20 6e70 2e6e 6461 7272 6179 293a 0a20  : np.ndarray):. 
+00020bf0: 2020 2020 2020 2022 2222 4a69 7474 6564         """Jitted
+00020c00: 2068 656c 7065 7220 666f 7220 636f 6d70   helper for comp
+00020c10: 7574 696e 6720 4865 6c6c 696e 6765 7220  uting Hellinger 
+00020c20: 6469 7374 616e 6365 7320 6672 6f6d 2060  distances from `
+00020c30: 6068 656c 6c69 6e67 6572 5f64 6973 7461  `hellinger_dista
+00020c40: 6e63 6560 6022 2222 0a20 2020 2020 2020  nce``""".       
+00020c50: 2072 6573 756c 742c 206e 6f72 6d5f 782c   result, norm_x,
+00020c60: 206e 6f72 6d5f 7920 3d20 302e 302c 2030   norm_y = 0.0, 0
+00020c70: 2e30 2c20 302e 300a 2020 2020 2020 2020  .0, 0.0.        
+00020c80: 666f 7220 6920 696e 2072 616e 6765 2878  for i in range(x
+00020c90: 2e73 6861 7065 5b30 5d29 3a0a 2020 2020  .shape[0]):.    
+00020ca0: 2020 2020 2020 2020 7265 7375 6c74 202b          result +
+00020cb0: 3d20 6e70 2e73 7172 7428 785b 695d 202a  = np.sqrt(x[i] *
+00020cc0: 2079 5b69 5d29 0a20 2020 2020 2020 2020   y[i]).         
+00020cd0: 2020 206e 6f72 6d5f 7820 2b3d 2078 5b69     norm_x += x[i
+00020ce0: 5d0a 2020 2020 2020 2020 2020 2020 6e6f  ].            no
+00020cf0: 726d 5f79 202b 3d20 795b 695d 0a20 2020  rm_y += y[i].   
+00020d00: 2020 2020 2069 6620 6e6f 726d 5f78 203d       if norm_x =
+00020d10: 3d20 3020 616e 6420 6e6f 726d 5f79 203d  = 0 and norm_y =
+00020d20: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00020d30: 2072 6574 7572 6e20 302e 300a 2020 2020   return 0.0.    
+00020d40: 2020 2020 656c 6966 206e 6f72 6d5f 7820      elif norm_x 
+00020d50: 3d3d 2030 206f 7220 6e6f 726d 5f79 203d  == 0 or norm_y =
+00020d60: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00020d70: 2072 6574 7572 6e20 312e 300a 2020 2020   return 1.0.    
+00020d80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00020d90: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
+00020da0: 7371 7274 2831 202d 2072 6573 756c 7420  sqrt(1 - result 
+00020db0: 2f20 6e70 2e73 7172 7428 6e6f 726d 5f78  / np.sqrt(norm_x
+00020dc0: 202a 206e 6f72 6d5f 7929 290a 0a20 2020   * norm_y))..   
+00020dd0: 2064 6566 2068 656c 6c69 6e67 6572 5f64   def hellinger_d
+00020de0: 6973 7461 6e63 6528 0a20 2020 2020 2020  istance(.       
+00020df0: 2073 656c 662c 0a20 2020 2020 2020 2078   self,.        x
+00020e00: 3a20 6e70 2e6e 6461 7272 6179 2c0a 2020  : np.ndarray,.  
+00020e10: 2020 2020 2020 793a 206e 702e 6e64 6172        y: np.ndar
+00020e20: 7261 792c 0a20 2020 2020 2020 2062 7563  ray,.        buc
+00020e30: 6b65 745f 6d65 7468 6f64 3a20 4f70 7469  ket_method: Opti
+00020e40: 6f6e 616c 5b0a 2020 2020 2020 2020 2020  onal[.          
+00020e50: 2020 4c69 7465 7261 6c5b 2266 6422 2c20    Literal["fd", 
+00020e60: 2264 6f61 6e65 222c 2022 6175 746f 222c  "doane", "auto",
+00020e70: 2022 7363 6f74 7422 2c20 2273 746f 6e65   "scott", "stone
+00020e80: 222c 2022 7269 6365 222c 2022 7374 7572  ", "rice", "stur
+00020e90: 6765 7322 2c20 2273 7172 7422 5d0a 2020  ges", "sqrt"].  
+00020ea0: 2020 2020 2020 5d20 3d20 2261 7574 6f22        ] = "auto"
+00020eb0: 2c0a 2020 2020 2920 2d3e 2066 6c6f 6174  ,.    ) -> float
+00020ec0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00020ed0: 2020 2020 2020 436f 6d70 7574 6520 7468        Compute th
+00020ee0: 6520 4865 6c6c 696e 6765 7220 6469 7374  e Hellinger dist
+00020ef0: 616e 6365 2062 6574 7765 656e 2074 776f  ance between two
+00020f00: 2076 6563 746f 7220 6469 7374 7269 6269   vector distribi
+00020f10: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+00020f20: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
+00020f30: 2020 2020 2054 6865 2048 656c 6c69 6e67       The Helling
+00020f40: 6572 2064 6973 7461 6e63 6520 6973 2062  er distance is b
+00020f50: 6f75 6e64 6564 2061 6e64 2072 616e 6765  ounded and range
+00020f60: 7320 6672 6f6d 2030 2074 6f20 e288 9a32  s from 0 to ...2
+00020f70: 2e20 4469 7374 616e 6365 206f 6620 e288  . Distance of ..
+00020f80: 9a32 2069 6e64 6963 6174 6573 2074 6861  .2 indicates tha
+00020f90: 7420 7468 6520 7477 6f20 6469 7374 7269  t the two distri
+00020fa0: 6275 7469 6f6e 7320 6172 6520 6d61 7869  butions are maxi
+00020fb0: 6d61 6c6c 7920 6469 7373 696d 696c 6172  mally dissimilar
+00020fc0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00020fd0: 206e 702e 6e64 6172 7261 7920 783a 2046   np.ndarray x: F
+00020fe0: 6972 7374 2031 4420 6172 7261 7920 7265  irst 1D array re
+00020ff0: 7072 6573 656e 7469 6e67 2061 2070 726f  presenting a pro
+00021000: 6261 6269 6c69 7479 2064 6973 7472 6962  bability distrib
+00021010: 7574 696f 6e2e 0a20 2020 2020 2020 203a  ution..        :
+00021020: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+00021030: 2079 3a20 5365 636f 6e64 2031 4420 6172   y: Second 1D ar
+00021040: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
+00021050: 2061 2070 726f 6261 6269 6c69 7479 2064   a probability d
+00021060: 6973 7472 6962 7574 696f 6e2e 0a20 2020  istribution..   
+00021070: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+00021080: 6f6e 616c 5b4c 6974 6572 616c 5b27 6664  onal[Literal['fd
+00021090: 272c 2027 646f 616e 6527 2c20 2761 7574  ', 'doane', 'aut
+000210a0: 6f27 2c20 2773 636f 7474 272c 2027 7374  o', 'scott', 'st
+000210b0: 6f6e 6527 2c20 2772 6963 6527 2c20 2773  one', 'rice', 's
+000210c0: 7475 7267 6573 272c 2027 7371 7274 275d  turges', 'sqrt']
+000210d0: 5d20 6275 636b 6574 5f6d 6574 686f 643a  ] bucket_method:
+000210e0: 204d 6574 686f 6420 666f 7220 636f 6d70   Method for comp
+000210f0: 7574 696e 6720 6869 7374 6f67 7261 6d20  uting histogram 
+00021100: 6269 6e73 2e20 4465 6661 756c 7420 6973  bins. Default is
+00021110: 2027 6175 746f 272e 0a20 2020 2020 2020   'auto'..       
+00021120: 203a 7265 7475 726e 7320 666c 6f61 743a   :returns float:
+00021130: 2048 656c 6c69 6e67 6572 2064 6973 7461   Hellinger dista
+00021140: 6e63 6520 6265 7477 6565 6e20 7468 6520  nce between the 
+00021150: 7477 6f20 696e 7075 7420 7072 6f62 6162  two input probab
+00021160: 696c 6974 7920 6469 7374 7269 6275 7469  ility distributi
+00021170: 6f6e 732e 0a0a 2020 2020 2020 2020 3a65  ons...        :e
+00021180: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+00021190: 3e3e 3e20 7820 3d20 6e70 2e72 616e 646f  >>> x = np.rando
+000211a0: 6d2e 7261 6e64 696e 7428 302c 2039 3030  m.randint(0, 900
+000211b0: 302c 2028 3530 3030 3030 2c29 290a 2020  0, (500000,)).  
+000211c0: 2020 2020 2020 3e3e 3e20 7920 3d20 6e70        >>> y = np
+000211d0: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+000211e0: 302c 2039 3030 302c 2028 3530 3030 3030  0, 9000, (500000
+000211f0: 2c29 290a 2020 2020 2020 2020 3e3e 3e20  ,)).        >>> 
+00021200: 5374 6174 6973 7469 6373 2829 2e68 656c  Statistics().hel
+00021210: 6c69 6e67 6572 5f64 6973 7461 6e63 6528  linger_distance(
+00021220: 783d 782c 2079 3d79 2c20 6275 636b 6574  x=x, y=y, bucket
+00021230: 5f6d 6574 686f 643d 2761 7574 6f27 290a  _method='auto').
+00021240: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00021250: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
+00021260: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
+00021270: 2020 2020 6461 7461 3d78 2c0a 2020 2020      data=x,.    
+00021280: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
+00021290: 7461 7469 7374 6963 732e 6865 6c6c 696e  tatistics.hellin
+000212a0: 6765 725f 6469 7374 616e 6365 2e5f 5f6e  ger_distance.__n
+000212b0: 616d 655f 5f2c 0a20 2020 2020 2020 2020  ame__,.         
+000212c0: 2020 2061 6363 6570 7465 645f 6e64 696d     accepted_ndim
+000212d0: 733d 2831 2c29 2c0a 2020 2020 2020 2020  s=(1,),.        
+000212e0: 2020 2020 6163 6365 7074 6564 5f64 7479      accepted_dty
+000212f0: 7065 733d 280a 2020 2020 2020 2020 2020  pes=(.          
+00021300: 2020 2020 2020 6e70 2e69 6e74 3634 2c0a        np.int64,.
+00021310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021320: 6e70 2e69 6e74 3332 2c0a 2020 2020 2020  np.int32,.      
+00021330: 2020 2020 2020 2020 2020 6e70 2e69 6e74            np.int
+00021340: 382c 0a20 2020 2020 2020 2020 2020 2020  8,.             
+00021350: 2020 206e 702e 666c 6f61 7433 322c 0a20     np.float32,. 
+00021360: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00021370: 702e 666c 6f61 7436 342c 0a20 2020 2020  p.float64,.     
+00021380: 2020 2020 2020 2020 2020 2069 6e74 2c0a             int,.
+00021390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000213a0: 666c 6f61 742c 0a20 2020 2020 2020 2020  float,.         
+000213b0: 2020 2029 2c0a 2020 2020 2020 2020 290a     ),.        ).
+000213c0: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
+000213d0: 6c69 645f 6172 7261 7928 0a20 2020 2020  lid_array(.     
+000213e0: 2020 2020 2020 2064 6174 613d 792c 0a20         data=y,. 
+000213f0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+00021400: 653d 5374 6174 6973 7469 6373 2e68 656c  e=Statistics.hel
+00021410: 6c69 6e67 6572 5f64 6973 7461 6e63 652e  linger_distance.
+00021420: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
+00021430: 2020 2020 2020 6163 6365 7074 6564 5f6e        accepted_n
+00021440: 6469 6d73 3d28 312c 292c 0a20 2020 2020  dims=(1,),.     
+00021450: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+00021460: 6474 7970 6573 3d28 0a20 2020 2020 2020  dtypes=(.       
+00021470: 2020 2020 2020 2020 206e 702e 696e 7436           np.int6
+00021480: 342c 0a20 2020 2020 2020 2020 2020 2020  4,.             
+00021490: 2020 206e 702e 696e 7433 322c 0a20 2020     np.int32,.   
+000214a0: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+000214b0: 696e 7438 2c0a 2020 2020 2020 2020 2020  int8,.          
+000214c0: 2020 2020 2020 6e70 2e66 6c6f 6174 3332        np.float32
+000214d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000214e0: 2020 6e70 2e66 6c6f 6174 3634 2c0a 2020    np.float64,.  
+000214f0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00021500: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00021510: 2020 2066 6c6f 6174 2c0a 2020 2020 2020     float,.      
+00021520: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+00021530: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
+00021540: 5f73 7472 280a 2020 2020 2020 2020 2020  _str(.          
+00021550: 2020 6e61 6d65 3d66 227b 5374 6174 6973    name=f"{Statis
+00021560: 7469 6373 2e68 656c 6c69 6e67 6572 5f64  tics.hellinger_d
+00021570: 6973 7461 6e63 652e 5f5f 6e61 6d65 5f5f  istance.__name__
+00021580: 7d20 6d65 7468 6f64 222c 0a20 2020 2020  } method",.     
+00021590: 2020 2020 2020 2076 616c 7565 3d62 7563         value=buc
+000215a0: 6b65 745f 6d65 7468 6f64 2c0a 2020 2020  ket_method,.    
+000215b0: 2020 2020 2020 2020 6f70 7469 6f6e 733d          options=
+000215c0: 4f70 7469 6f6e 732e 4255 434b 4554 5f4d  Options.BUCKET_M
+000215d0: 4554 484f 4453 2e76 616c 7565 2c0a 2020  ETHODS.value,.  
+000215e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000215f0: 6269 6e5f 7769 6474 682c 2062 696e 5f63  bin_width, bin_c
+00021600: 6f75 6e74 203d 2062 7563 6b65 745f 6461  ount = bucket_da
+00021610: 7461 2864 6174 613d 782c 206d 6574 686f  ta(data=x, metho
+00021620: 643d 6275 636b 6574 5f6d 6574 686f 6429  d=bucket_method)
+00021630: 0a20 2020 2020 2020 2073 315f 6820 3d20  .        s1_h = 
+00021640: 7365 6c66 2e5f 6869 7374 5f31 6428 0a20  self._hist_1d(. 
+00021650: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00021660: 782c 2062 696e 5f63 6f75 6e74 3d62 696e  x, bin_count=bin
+00021670: 5f63 6f75 6e74 2c20 7261 6e67 653d 6e70  _count, range=np
+00021680: 2e61 7272 6179 285b 302c 2069 6e74 2862  .array([0, int(b
+00021690: 696e 5f77 6964 7468 202a 2062 696e 5f63  in_width * bin_c
+000216a0: 6f75 6e74 295d 290a 2020 2020 2020 2020  ount)]).        
+000216b0: 290a 2020 2020 2020 2020 7332 5f68 203d  ).        s2_h =
+000216c0: 2073 656c 662e 5f68 6973 745f 3164 280a   self._hist_1d(.
+000216d0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000216e0: 3d79 2c20 6269 6e5f 636f 756e 743d 6269  =y, bin_count=bi
+000216f0: 6e5f 636f 756e 742c 2072 616e 6765 3d6e  n_count, range=n
+00021700: 702e 6172 7261 7928 5b30 2c20 696e 7428  p.array([0, int(
+00021710: 6269 6e5f 7769 6474 6820 2a20 6269 6e5f  bin_width * bin_
+00021720: 636f 756e 7429 5d29 0a20 2020 2020 2020  count)]).       
+00021730: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+00021740: 6e20 7365 6c66 2e5f 6865 6c6c 696e 6765  n self._hellinge
+00021750: 725f 6865 6c70 6572 280a 2020 2020 2020  r_helper(.      
+00021760: 2020 2020 2020 783d 7331 5f68 2e61 7374        x=s1_h.ast
+00021770: 7970 6528 6e70 2e66 6c6f 6174 3332 292c  ype(np.float32),
+00021780: 2079 3d73 325f 682e 6173 7479 7065 286e   y=s2_h.astype(n
+00021790: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+000217a0: 2020 2029 0a0a 2020 2020 4073 7461 7469     )..    @stati
+000217b0: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
+000217c0: 7428 2228 696e 7436 345b 3a5d 2c20 696e  t("(int64[:], in
+000217d0: 7436 345b 3a5d 2922 290a 2020 2020 6465  t64[:])").    de
+000217e0: 6620 636f 6865 6e73 5f6b 6170 7061 2873  f cohens_kappa(s
+000217f0: 616d 706c 655f 313a 206e 702e 6e64 6172  ample_1: np.ndar
+00021800: 7261 792c 2073 616d 706c 655f 323a 206e  ray, sample_2: n
+00021810: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+00021820: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00021830: 4a69 7474 6564 2063 6f6d 7075 7465 2043  Jitted compute C
+00021840: 6f68 656e 2773 204b 6170 7061 2063 6f65  ohen's Kappa coe
+00021850: 6666 6963 6965 6e74 2066 6f72 2074 776f  fficient for two
+00021860: 2062 696e 6172 7920 7361 6d70 6c65 732e   binary samples.
+00021870: 0a0a 2020 2020 2020 2020 436f 6865 6e27  ..        Cohen'
+00021880: 7320 4b61 7070 6120 636f 6566 6669 6369  s Kappa coeffici
+00021890: 656e 7420 6d65 6173 7572 6573 2074 6865  ent measures the
+000218a0: 2061 6772 6565 6d65 6e74 2062 6574 7765   agreement betwe
+000218b0: 656e 2074 776f 2073 6574 7320 6f66 2062  en two sets of b
+000218c0: 696e 6172 7920 7261 7469 6e67 732c 2074  inary ratings, t
+000218d0: 616b 696e 6720 696e 746f 2061 6363 6f75  aking into accou
+000218e0: 6e74 2061 6772 6565 6d65 6e74 206f 6363  nt agreement occ
+000218f0: 7572 7269 6e67 2062 7920 6368 616e 6365  urring by chance
+00021900: 2e0a 2020 2020 2020 2020 4974 2072 616e  ..        It ran
+00021910: 6765 7320 6672 6f6d 202d 3120 746f 2031  ges from -1 to 1
+00021920: 2c20 7768 6572 6520 3120 696e 6469 6361  , where 1 indica
+00021930: 7465 7320 7065 7266 6563 7420 6167 7265  tes perfect agre
+00021940: 656d 656e 742c 2030 2069 6e64 6963 6174  ement, 0 indicat
+00021950: 6573 2061 6772 6565 6d65 6e74 2062 7920  es agreement by 
+00021960: 6368 616e 6365 2c20 616e 6420 2d31 2069  chance, and -1 i
+00021970: 6e64 6963 6174 6573 2063 6f6d 706c 6574  ndicates complet
+00021980: 6520 6469 7361 6772 6565 6d65 6e74 2e0a  e disagreement..
+00021990: 0a20 2020 2020 2020 202e 2e20 6d61 7468  .        .. math
+000219a0: 3a3a 0a0a 2020 2020 2020 2020 2020 205c  ::..           \
+000219b0: 5c6b 6170 7061 203d 2031 202d 205c 5c66  \kappa = 1 - \\f
+000219c0: 7261 637b 5c73 756d 7b77 5f7b 696a 7d20  rac{\sum{w_{ij} 
+000219d0: 5c5c 6364 6f74 2044 5f7b 696a 7d7d 7d7b  \\cdot D_{ij}}}{
+000219e0: 5c5c 7375 6d7b 775f 7b69 6a7d 205c 5c63  \\sum{w_{ij} \\c
+000219f0: 646f 7420 455f 7b69 6a7d 7d7d 0a0a 2020  dot E_{ij}}}..  
+00021a00: 2020 2020 2020 7768 6572 653a 0a20 2020        where:.   
+00021a10: 2020 2020 2020 2020 202d 205c 2820 5c6b           - \( \k
+00021a20: 6170 7061 205c 2920 6973 2043 6f68 656e  appa \) is Cohen
+00021a30: 2773 204b 6170 7061 2063 6f65 6666 6963  's Kappa coeffic
+00021a40: 6965 6e74 2c0a 2020 2020 2020 2020 2020  ient,.          
+00021a50: 2020 2d20 5c28 2077 5f7b 696a 7d20 5c29    - \( w_{ij} \)
+00021a60: 2061 7265 2074 6865 2077 6569 6768 7473   are the weights
+00021a70: 2c0a 2020 2020 2020 2020 2020 2020 2d20  ,.            - 
+00021a80: 5c28 2044 5f7b 696a 7d20 5c29 2061 7265  \( D_{ij} \) are
+00021a90: 2074 6865 206f 6273 6572 7665 6420 6672   the observed fr
+00021aa0: 6571 7565 6e63 6965 732c 0a20 2020 2020  equencies,.     
+00021ab0: 2020 2020 2020 202d 205c 2820 455f 7b69         - \( E_{i
+00021ac0: 6a7d 205c 2920 6172 6520 7468 6520 6578  j} \) are the ex
+00021ad0: 7065 6374 6564 2066 7265 7175 656e 6369  pected frequenci
+00021ae0: 6573 2e0a 0a20 2020 2020 2020 203a 6578  es...        :ex
+00021af0: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00021b00: 3e3e 2073 616d 706c 655f 3120 3d20 6e70  >> sample_1 = np
+00021b10: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+00021b20: 302c 2032 2c20 7369 7a65 3d28 3130 3030  0, 2, size=(1000
+00021b30: 302c 2929 0a20 2020 2020 2020 203e 3e3e  0,)).        >>>
+00021b40: 2073 616d 706c 655f 3220 3d20 6e70 2e72   sample_2 = np.r
+00021b50: 616e 646f 6d2e 7261 6e64 696e 7428 302c  andom.randint(0,
+00021b60: 2032 2c20 7369 7a65 3d28 3130 3030 302c   2, size=(10000,
+00021b70: 2929 0a20 2020 2020 2020 203e 3e3e 2053  )).        >>> S
+00021b80: 7461 7469 7374 6963 732e 636f 6865 6e73  tatistics.cohens
+00021b90: 5f6b 6170 7061 2873 616d 706c 655f 313d  _kappa(sample_1=
+00021ba0: 7361 6d70 6c65 5f31 2c20 7361 6d70 6c65  sample_1, sample
+00021bb0: 5f32 3d73 616d 706c 655f 3229 290a 2020  _2=sample_2)).  
+00021bc0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00021bd0: 2020 2073 616d 706c 655f 3120 3d20 6e70     sample_1 = np
+00021be0: 2e61 7363 6f6e 7469 6775 6f75 7361 7272  .ascontiguousarr
+00021bf0: 6179 2873 616d 706c 655f 3129 0a20 2020  ay(sample_1).   
+00021c00: 2020 2020 2073 616d 706c 655f 3220 3d20       sample_2 = 
+00021c10: 6e70 2e61 7363 6f6e 7469 6775 6f75 7361  np.ascontiguousa
+00021c20: 7272 6179 2873 616d 706c 655f 3229 0a20  rray(sample_2). 
+00021c30: 2020 2020 2020 2064 6174 6120 3d20 6e70         data = np
+00021c40: 2e68 7374 6163 6b28 2873 616d 706c 655f  .hstack((sample_
+00021c50: 312e 7265 7368 6170 6528 2d31 2c20 3129  1.reshape(-1, 1)
+00021c60: 2c20 7361 6d70 6c65 5f32 2e72 6573 6861  , sample_2.resha
+00021c70: 7065 282d 312c 2031 2929 290a 2020 2020  pe(-1, 1))).    
+00021c80: 2020 2020 7470 203d 206c 656e 286e 702e      tp = len(np.
+00021c90: 6172 6777 6865 7265 2828 6461 7461 5b3a  argwhere((data[:
+00021ca0: 2c20 305d 203d 3d20 3129 2026 2028 6461  , 0] == 1) & (da
+00021cb0: 7461 5b3a 2c20 315d 203d 3d20 3129 292e  ta[:, 1] == 1)).
+00021cc0: 666c 6174 7465 6e28 2929 0a20 2020 2020  flatten()).     
+00021cd0: 2020 2074 6e20 3d20 6c65 6e28 6e70 2e61     tn = len(np.a
+00021ce0: 7267 7768 6572 6528 2864 6174 615b 3a2c  rgwhere((data[:,
+00021cf0: 2030 5d20 3d3d 2030 2920 2620 2864 6174   0] == 0) & (dat
+00021d00: 615b 3a2c 2031 5d20 3d3d 2030 2929 2e66  a[:, 1] == 0)).f
+00021d10: 6c61 7474 656e 2829 290a 2020 2020 2020  latten()).      
+00021d20: 2020 6670 203d 206c 656e 286e 702e 6172    fp = len(np.ar
+00021d30: 6777 6865 7265 2828 6461 7461 5b3a 2c20  gwhere((data[:, 
+00021d40: 305d 203d 3d20 3129 2026 2028 6461 7461  0] == 1) & (data
+00021d50: 5b3a 2c20 315d 203d 3d20 3029 292e 666c  [:, 1] == 0)).fl
+00021d60: 6174 7465 6e28 2929 0a20 2020 2020 2020  atten()).       
+00021d70: 2066 6e20 3d20 6c65 6e28 6e70 2e61 7267   fn = len(np.arg
+00021d80: 7768 6572 6528 2864 6174 615b 3a2c 2030  where((data[:, 0
+00021d90: 5d20 3d3d 2030 2920 2620 2864 6174 615b  ] == 0) & (data[
+00021da0: 3a2c 2031 5d20 3d3d 2031 2929 2e66 6c61  :, 1] == 1)).fla
+00021db0: 7474 656e 2829 290a 2020 2020 2020 2020  tten()).        
+00021dc0: 6461 7461 203d 206e 702e 6172 7261 7928  data = np.array(
+00021dd0: 285b 7470 2c20 6670 5d2c 205b 666e 2c20  ([tp, fp], [fn, 
+00021de0: 746e 5d29 290a 2020 2020 2020 2020 7375  tn])).        su
+00021df0: 6d30 203d 2064 6174 612e 7375 6d28 6178  m0 = data.sum(ax
+00021e00: 6973 3d30 290a 2020 2020 2020 2020 7375  is=0).        su
+00021e10: 6d31 203d 2064 6174 612e 7375 6d28 6178  m1 = data.sum(ax
+00021e20: 6973 3d31 290a 2020 2020 2020 2020 6578  is=1).        ex
+00021e30: 7065 6374 6564 203d 206e 702e 6f75 7465  pected = np.oute
+00021e40: 7228 7375 6d30 2c20 7375 6d31 2920 2f20  r(sum0, sum1) / 
+00021e50: 6e70 2e73 756d 2873 756d 3029 0a20 2020  np.sum(sum0).   
+00021e60: 2020 2020 2077 5f6d 6174 203d 206e 702e       w_mat = np.
+00021e70: 6675 6c6c 2873 6861 7065 3d28 322c 2032  full(shape=(2, 2
+00021e80: 292c 2066 696c 6c5f 7661 6c75 653d 3129  ), fill_value=1)
+00021e90: 0a20 2020 2020 2020 2077 5f6d 6174 5b30  .        w_mat[0
+00021ea0: 2c20 305d 203d 2030 0a20 2020 2020 2020  , 0] = 0.       
+00021eb0: 2077 5f6d 6174 5b31 2c20 315d 203d 2030   w_mat[1, 1] = 0
+00021ec0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021ed0: 3120 2d20 6e70 2e73 756d 2877 5f6d 6174  1 - np.sum(w_mat
+00021ee0: 202a 2064 6174 6129 202f 206e 702e 7375   * data) / np.su
+00021ef0: 6d28 775f 6d61 7420 2a20 6578 7065 6374  m(w_mat * expect
+00021f00: 6564 290a 0a20 2020 2040 7374 6174 6963  ed)..    @static
+00021f10: 6d65 7468 6f64 0a20 2020 2064 6566 2064  method.    def d
+00021f20: 5f70 7269 6d65 280a 2020 2020 2020 2020  _prime(.        
+00021f30: 783a 206e 702e 6e64 6172 7261 792c 0a20  x: np.ndarray,. 
+00021f40: 2020 2020 2020 2079 3a20 6e70 2e6e 6461         y: np.nda
+00021f50: 7272 6179 2c0a 2020 2020 2020 2020 6c6f  rray,.        lo
+00021f60: 7765 725f 6c69 6d69 743a 204f 7074 696f  wer_limit: Optio
+00021f70: 6e61 6c5b 666c 6f61 745d 203d 2030 2e30  nal[float] = 0.0
+00021f80: 3030 312c 0a20 2020 2020 2020 2075 7070  001,.        upp
+00021f90: 6572 5f6c 696d 6974 3a20 4f70 7469 6f6e  er_limit: Option
+00021fa0: 616c 5b66 6c6f 6174 5d20 3d20 302e 3939  al[float] = 0.99
+00021fb0: 3939 2c0a 2020 2020 2920 2d3e 2066 6c6f  99,.    ) -> flo
+00021fc0: 6174 3a0a 2020 2020 2020 2020 2222 220a  at:.        """.
+00021fd0: 2020 2020 2020 2020 436f 6d70 7574 6573          Computes
+00021fe0: 2064 2d70 7269 6d65 2066 726f 6d20 7477   d-prime from tw
+00021ff0: 6f20 426f 6f6c 6561 6e20 3164 2061 7272  o Boolean 1d arr
+00022000: 6179 732c 2065 2e67 2e2c 2062 6574 7765  ays, e.g., betwe
+00022010: 656e 2063 6c61 7373 6966 6963 6174 696f  en classificatio
+00022020: 6e73 2061 6e64 2067 726f 756e 6420 7472  ns and ground tr
+00022030: 7574 682e 0a0a 2020 2020 2020 2020 442d  uth...        D-
+00022040: 7072 696d 6520 2864 2729 2069 7320 6120  prime (d') is a 
+00022050: 6d65 6173 7572 6520 6f66 2073 6967 6e61  measure of signa
+00022060: 6c20 6465 7465 6374 696f 6e20 7065 7266  l detection perf
+00022070: 6f72 6d61 6e63 652c 2069 6e64 6963 6174  ormance, indicat
+00022080: 696e 6720 7468 6520 6162 696c 6974 7920  ing the ability 
+00022090: 746f 2064 6973 6372 696d 696e 6174 6520  to discriminate 
+000220a0: 6265 7477 6565 6e20 7369 676e 616c 2061  between signal a
+000220b0: 6e64 206e 6f69 7365 2e0a 2020 2020 2020  nd noise..      
+000220c0: 2020 4974 2069 7320 636f 6d70 7574 6564    It is computed
+000220d0: 2061 7320 7468 6520 6469 6666 6572 656e   as the differen
+000220e0: 6365 2062 6574 7765 656e 2074 6865 2069  ce between the i
+000220f0: 6e76 6572 7365 2063 756d 756c 6174 6976  nverse cumulativ
+00022100: 6520 6469 7374 7269 6275 7469 6f6e 2066  e distribution f
+00022110: 756e 6374 696f 6e20 2843 4446 2920 6f66  unction (CDF) of
+00022120: 2074 6865 2068 6974 2072 6174 6520 616e   the hit rate an
+00022130: 6420 7468 6520 6661 6c73 6520 616c 6172  d the false alar
+00022140: 6d20 7261 7465 2e0a 0a20 2020 2020 2020  m rate...       
+00022150: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
+00022160: 6179 2078 3a20 426f 6f6c 6561 6e20 3144  ay x: Boolean 1D
+00022170: 2061 7272 6179 206f 6620 7265 7370 6f6e   array of respon
+00022180: 7365 2076 616c 7565 732c 2077 6865 7265  se values, where
+00022190: 2031 2072 6570 7265 7365 6e74 7320 7072   1 represents pr
+000221a0: 6573 656e 6365 2c20 616e 6420 3020 7265  esence, and 0 re
+000221b0: 7072 6573 656e 7469 6e67 2061 6273 656e  presenting absen
+000221c0: 6365 2e0a 2020 2020 2020 2020 3a70 6172  ce..        :par
+000221d0: 616d 206e 702e 6e64 6172 7261 7920 793a  am np.ndarray y:
+000221e0: 2042 6f6f 6c65 616e 2031 4420 6172 7261   Boolean 1D arra
+000221f0: 7920 6f66 2067 726f 756e 6420 7472 7574  y of ground trut
+00022200: 682c 2077 6865 7265 2031 2072 6570 7265  h, where 1 repre
+00022210: 7365 6e74 7320 7072 6573 656e 6365 2c20  sents presence, 
+00022220: 616e 6420 3020 7265 7072 6573 656e 7469  and 0 representi
+00022230: 6e67 2061 6273 656e 6365 2e0a 2020 2020  ng absence..    
+00022240: 2020 2020 3a70 6172 616d 204f 7074 696f      :param Optio
+00022250: 6e61 6c5b 666c 6f61 745d 206c 6f77 6572  nal[float] lower
+00022260: 5f6c 696d 6974 3a20 4c6f 7765 7220 6c69  _limit: Lower li
+00022270: 6d69 7420 746f 2062 6f75 6e64 2068 6974  mit to bound hit
+00022280: 2061 6e64 2066 616c 7365 2061 6c61 726d   and false alarm
+00022290: 2072 6174 6573 2e20 4465 6661 756c 7473   rates. Defaults
+000222a0: 2074 6f20 302e 3030 3031 2e0a 2020 2020   to 0.0001..    
+000222b0: 2020 2020 3a70 6172 616d 204f 7074 696f      :param Optio
+000222c0: 6e61 6c5b 666c 6f61 745d 2075 7070 6572  nal[float] upper
+000222d0: 5f6c 696d 6974 3a20 5570 7065 7220 6c69  _limit: Upper li
+000222e0: 6d69 7420 746f 2062 6f75 6e64 2068 6974  mit to bound hit
+000222f0: 2061 6e64 2066 616c 7365 2061 6c61 726d   and false alarm
+00022300: 2072 6174 6573 2e20 4465 6661 756c 7473   rates. Defaults
+00022310: 2074 6f20 302e 3939 3939 2e0a 2020 2020   to 0.9999..    
+00022320: 2020 2020 3a72 6574 7572 6e20 666c 6f61      :return floa
+00022330: 743a 2054 6865 2063 616c 6375 6c61 7465  t: The calculate
+00022340: 6420 6427 2028 642d 7072 696d 6529 2076  d d' (d-prime) v
+00022350: 616c 7565 2e0a 0a20 2020 2020 2020 203a  alue...        :
+00022360: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+00022370: 203e 3e3e 2078 203d 206e 702e 7261 6e64   >>> x = np.rand
+00022380: 6f6d 2e72 616e 6469 6e74 2830 2c20 322c  om.randint(0, 2,
+00022390: 2028 3130 3030 2c29 290a 2020 2020 2020   (1000,)).      
+000223a0: 2020 3e3e 3e20 7920 3d20 6e70 2e72 616e    >>> y = np.ran
+000223b0: 646f 6d2e 7261 6e64 696e 7428 302c 2032  dom.randint(0, 2
+000223c0: 2c20 2831 3030 302c 2929 0a20 2020 2020  , (1000,)).     
+000223d0: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+000223e0: 732e 645f 7072 696d 6528 783d 782c 2079  s.d_prime(x=x, y
+000223f0: 3d79 290a 2020 2020 2020 2020 2222 220a  =y).        """.
+00022400: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+00022410: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+00022420: 2020 2020 2020 2020 6461 7461 3d78 2c0a          data=x,.
+00022430: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+00022440: 6365 3d53 7461 7469 7374 6963 732e 645f  ce=Statistics.d_
+00022450: 7072 696d 652e 5f5f 6e61 6d65 5f5f 2c0a  prime.__name__,.
+00022460: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+00022470: 7074 6564 5f6e 6469 6d73 3d28 312c 292c  pted_ndims=(1,),
+00022480: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00022490: 6570 7465 645f 6474 7970 6573 3d28 6e70  epted_dtypes=(np
+000224a0: 2e69 6e74 3634 2c20 6e70 2e69 6e74 3332  .int64, np.int32
+000224b0: 2c20 6e70 2e69 6e74 3829 2c0a 2020 2020  , np.int8),.    
+000224c0: 2020 2020 290a 2020 2020 2020 2020 6368      ).        ch
+000224d0: 6563 6b5f 7661 6c69 645f 6172 7261 7928  eck_valid_array(
+000224e0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+000224f0: 613d 792c 0a20 2020 2020 2020 2020 2020  a=y,.           
+00022500: 2073 6f75 7263 653d 5374 6174 6973 7469   source=Statisti
+00022510: 6373 2e64 5f70 7269 6d65 2e5f 5f6e 616d  cs.d_prime.__nam
+00022520: 655f 5f2c 0a20 2020 2020 2020 2020 2020  e__,.           
+00022530: 2061 6363 6570 7465 645f 6e64 696d 733d   accepted_ndims=
+00022540: 2831 2c29 2c0a 2020 2020 2020 2020 2020  (1,),.          
+00022550: 2020 6163 6365 7074 6564 5f64 7479 7065    accepted_dtype
+00022560: 733d 286e 702e 696e 7436 342c 206e 702e  s=(np.int64, np.
+00022570: 696e 7433 322c 206e 702e 696e 7438 292c  int32, np.int8),
+00022580: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00022590: 2020 2069 6620 6c65 6e28 6c69 7374 287b     if len(list({
+000225a0: 782e 7368 6170 655b 305d 2c20 792e 7368  x.shape[0], y.sh
+000225b0: 6170 655b 305d 7d29 2920 213d 2031 3a0a  ape[0]})) != 1:.
+000225c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000225d0: 6520 436f 756e 7445 7272 6f72 280a 2020  e CountError(.  
+000225e0: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
+000225f0: 673d 6622 5468 6520 7477 6f20 6172 7261  g=f"The two arra
+00022600: 7973 2068 6173 2074 6f20 6265 2065 7175  ys has to be equ
+00022610: 616c 206c 656e 6774 6873 2062 7574 2067  al lengths but g
+00022620: 6f74 3a20 7b78 2e73 6861 7065 5b30 5d2c  ot: {x.shape[0],
+00022630: 2079 2e73 6861 7065 5b30 5d7d 222c 0a20   y.shape[0]}",. 
+00022640: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00022650: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
+00022660: 2e64 5f70 7269 6d65 2e5f 5f6e 616d 655f  .d_prime.__name_
+00022670: 5f2c 0a20 2020 2020 2020 2020 2020 2029  _,.            )
+00022680: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00022690: 6e20 5b78 2c20 795d 3a0a 2020 2020 2020  n [x, y]:.      
+000226a0: 2020 2020 2020 6164 6469 7469 6f6e 616c        additional
+000226b0: 203d 206c 6973 7428 7365 7428 6c69 7374   = list(set(list
+000226c0: 286e 702e 736f 7274 286e 702e 756e 6971  (np.sort(np.uniq
+000226d0: 7565 2869 2929 2929 202d 207b 302c 2031  ue(i)))) - {0, 1
+000226e0: 7d29 0a20 2020 2020 2020 2020 2020 2069  }).            i
+000226f0: 6620 6c65 6e28 6164 6469 7469 6f6e 616c  f len(additional
+00022700: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
+00022710: 2020 2020 2020 2072 6169 7365 2049 6e76         raise Inv
+00022720: 616c 6964 496e 7075 7445 7272 6f72 280a  alidInputError(.
+00022730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022740: 2020 2020 6d73 673d 6622 442d 7072 696d      msg=f"D-prim
+00022750: 6520 7265 7175 6972 6573 2062 696e 6172  e requires binar
+00022760: 7920 696e 7075 7420 6461 7461 2062 7574  y input data but
+00022770: 2066 6f75 6e64 207b 6164 6469 7469 6f6e   found {addition
+00022780: 616c 7d22 2c0a 2020 2020 2020 2020 2020  al}",.          
+00022790: 2020 2020 2020 2020 2020 736f 7572 6365            source
+000227a0: 3d53 7461 7469 7374 6963 732e 645f 7072  =Statistics.d_pr
+000227b0: 696d 6528 292e 5f5f 6e61 6d65 5f5f 2c0a  ime().__name__,.
+000227c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000227d0: 290a 2020 2020 2020 2020 7461 7267 6574  ).        target
+000227e0: 5f69 6478 203d 206e 702e 6172 6777 6865  _idx = np.argwhe
+000227f0: 7265 2879 203d 3d20 3129 2e66 6c61 7474  re(y == 1).flatt
+00022800: 656e 2829 0a20 2020 2020 2020 2068 6974  en().        hit
+00022810: 5f72 6174 6520 3d20 6e70 2e73 756d 2878  _rate = np.sum(x
+00022820: 5b6e 702e 6172 6777 6865 7265 2879 203d  [np.argwhere(y =
+00022830: 3d20 3129 5d29 202f 2074 6172 6765 745f  = 1)]) / target_
+00022840: 6964 782e 7368 6170 655b 305d 0a20 2020  idx.shape[0].   
+00022850: 2020 2020 2066 616c 7365 5f61 6c61 726d       false_alarm
+00022860: 5f72 6174 6520 3d20 6e70 2e73 756d 2878  _rate = np.sum(x
+00022870: 5b6e 702e 6172 6777 6865 7265 2879 203d  [np.argwhere(y =
+00022880: 3d20 3029 5d29 202f 2074 6172 6765 745f  = 0)]) / target_
+00022890: 6964 782e 7368 6170 655b 305d 0a20 2020  idx.shape[0].   
+000228a0: 2020 2020 2069 6620 6869 745f 7261 7465       if hit_rate
+000228b0: 203c 206c 6f77 6572 5f6c 696d 6974 3a0a   < lower_limit:.
+000228c0: 2020 2020 2020 2020 2020 2020 6869 745f              hit_
+000228d0: 7261 7465 203d 206c 6f77 6572 5f6c 696d  rate = lower_lim
+000228e0: 6974 0a20 2020 2020 2020 2065 6c69 6620  it.        elif 
+000228f0: 6869 745f 7261 7465 203e 2075 7070 6572  hit_rate > upper
+00022900: 5f6c 696d 6974 3a0a 2020 2020 2020 2020  _limit:.        
+00022910: 2020 2020 6869 745f 7261 7465 203d 2075      hit_rate = u
+00022920: 7070 6572 5f6c 696d 6974 0a20 2020 2020  pper_limit.     
+00022930: 2020 2069 6620 6661 6c73 655f 616c 6172     if false_alar
+00022940: 6d5f 7261 7465 203c 206c 6f77 6572 5f6c  m_rate < lower_l
+00022950: 696d 6974 3a0a 2020 2020 2020 2020 2020  imit:.          
+00022960: 2020 6661 6c73 655f 616c 6172 6d5f 7261    false_alarm_ra
+00022970: 7465 203d 206c 6f77 6572 5f6c 696d 6974  te = lower_limit
+00022980: 0a20 2020 2020 2020 2065 6c69 6620 6661  .        elif fa
+00022990: 6c73 655f 616c 6172 6d5f 7261 7465 203e  lse_alarm_rate >
+000229a0: 2075 7070 6572 5f6c 696d 6974 3a0a 2020   upper_limit:.  
+000229b0: 2020 2020 2020 2020 2020 6661 6c73 655f            false_
+000229c0: 616c 6172 6d5f 7261 7465 203d 2075 7070  alarm_rate = upp
+000229d0: 6572 5f6c 696d 6974 0a20 2020 2020 2020  er_limit.       
+000229e0: 2072 6574 7572 6e20 7374 6174 732e 6e6f   return stats.no
+000229f0: 726d 2e70 7066 2868 6974 5f72 6174 6529  rm.ppf(hit_rate)
+00022a00: 202d 2073 7461 7473 2e6e 6f72 6d2e 7070   - stats.norm.pp
+00022a10: 6628 6661 6c73 655f 616c 6172 6d5f 7261  f(false_alarm_ra
+00022a20: 7465 290a 0a20 2020 2040 7374 6174 6963  te)..    @static
+00022a30: 6d65 7468 6f64 0a20 2020 2064 6566 206d  method.    def m
+00022a40: 636e 656d 6172 280a 2020 2020 2020 2020  cnemar(.        
+00022a50: 783a 206e 702e 6e64 6172 7261 792c 0a20  x: np.ndarray,. 
+00022a60: 2020 2020 2020 2079 3a20 6e70 2e6e 6461         y: np.nda
+00022a70: 7272 6179 2c0a 2020 2020 2020 2020 6772  rray,.        gr
+00022a80: 6f75 6e64 5f74 7275 7468 3a20 6e70 2e6e  ound_truth: np.n
+00022a90: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
+00022aa0: 636f 6e74 696e 7569 7479 5f63 6f72 7265  continuity_corre
+00022ab0: 6374 6564 3a20 4f70 7469 6f6e 616c 5b62  cted: Optional[b
+00022ac0: 6f6f 6c5d 203d 2054 7275 652c 0a20 2020  ool] = True,.   
+00022ad0: 2029 202d 3e20 5475 706c 655b 666c 6f61   ) -> Tuple[floa
+00022ae0: 742c 2066 6c6f 6174 5d3a 0a20 2020 2020  t, float]:.     
+00022af0: 2020 2022 2222 0a20 2020 2020 2020 204d     """.        M
+00022b00: 634e 656d 6172 2773 2074 6573 7420 746f  cNemar's test to
+00022b10: 2063 6f6d 7061 7265 2074 6865 2064 6966   compare the dif
+00022b20: 6665 7265 6e63 6520 696e 2070 7265 6469  ference in predi
+00022b30: 6374 6976 6520 6163 6375 7261 6379 206f  ctive accuracy o
+00022b40: 6620 7477 6f20 6d6f 6465 6c73 2e0a 0a20  f two models... 
+00022b50: 2020 2020 2020 2045 2e67 2e2c 2063 616e         E.g., can
+00022b60: 2062 6520 7573 6564 2074 6f20 636f 6d70   be used to comp
+00022b70: 7574 6520 6966 2074 6865 2061 6363 7572  ute if the accur
+00022b80: 6163 7920 6f66 2074 776f 2063 6c61 7373  acy of two class
+00022b90: 6966 6965 7273 2061 7265 2073 6967 6e69  ifiers are signi
+00022ba0: 6669 6361 6e74 6c79 2064 6966 6665 7265  ficantly differe
+00022bb0: 6e74 2077 6865 6e20 7472 616e 7366 6f72  nt when transfor
+00022bc0: 6d69 6e67 2074 6865 2073 616d 6520 6461  ming the same da
+00022bd0: 7461 2e0a 0a20 2020 2020 2020 202e 2e20  ta...        .. 
+00022be0: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+00022bf0: 2020 4164 6170 7465 6420 6672 6f6d 2060    Adapted from `
+00022c00: 6d6c 6578 7465 6e64 203c 6874 7470 733a  mlextend <https:
+00022c10: 2f2f 6769 7468 7562 2e63 6f6d 2f72 6173  //github.com/ras
+00022c20: 6274 2f6d 6c78 7465 6e64 2f62 6c6f 622f  bt/mlxtend/blob/
+00022c30: 6d61 7374 6572 2f6d 6c78 7465 6e64 2f65  master/mlxtend/e
+00022c40: 7661 6c75 6174 652f 6d63 6e65 6d61 722e  valuate/mcnemar.
+00022c50: 7079 3e60 5f5f 2e0a 0a20 2020 2020 2020  py>`__...       
+00022c60: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
+00022c70: 6179 2078 3a20 312d 6469 6d65 6e73 696f  ay x: 1-dimensio
+00022c80: 6e61 6c20 426f 6f6c 6561 6e20 6172 7261  nal Boolean arra
+00022c90: 7920 7769 7468 2070 7265 6469 6374 696f  y with predictio
+00022ca0: 6e73 206f 6620 7468 6520 6669 7273 7420  ns of the first 
+00022cb0: 6d6f 6465 6c2e 0a20 2020 2020 2020 203a  model..        :
+00022cc0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+00022cd0: 2078 3a20 312d 6469 6d65 6e73 696f 6e61   x: 1-dimensiona
+00022ce0: 6c20 426f 6f6c 6561 6e20 6172 7261 7920  l Boolean array 
+00022cf0: 7769 7468 2070 7265 6469 6374 696f 6e73  with predictions
+00022d00: 206f 6620 7468 6520 7365 636f 6e64 206d   of the second m
+00022d10: 6f64 656c 2e0a 2020 2020 2020 2020 3a70  odel..        :p
+00022d20: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+00022d30: 783a 2031 2d64 696d 656e 7369 6f6e 616c  x: 1-dimensional
+00022d40: 2042 6f6f 6c65 616e 2061 7272 6179 2077   Boolean array w
+00022d50: 6974 6820 6772 6f75 6e64 2074 7275 7468  ith ground truth
+00022d60: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
+00022d70: 203a 7061 7261 6d20 4f70 7469 6f6e 616c   :param Optional
+00022d80: 5b62 6f6f 6c5d 2063 6f6e 7469 6e75 6974  [bool] continuit
+00022d90: 795f 636f 7272 6563 7465 6420 3a20 5768  y_corrected : Wh
+00022da0: 6574 6865 7220 746f 2061 7070 6c79 2063  ether to apply c
+00022db0: 6f6e 7469 6e75 6974 7920 636f 7272 6563  ontinuity correc
+00022dc0: 7469 6f6e 2e20 4465 6661 756c 7420 6973  tion. Default is
+00022dd0: 2054 7275 652e 0a0a 2020 2020 2020 2020   True...        
+00022de0: 3a65 7861 6d70 6c65 3a0a 2020 2020 2020  :example:.      
+00022df0: 2020 3e3e 3e20 7820 3d20 6e70 2e72 616e    >>> x = np.ran
+00022e00: 646f 6d2e 7261 6e64 696e 7428 302c 2032  dom.randint(0, 2
+00022e10: 2c20 2831 3030 3030 302c 2029 290a 2020  , (100000, )).  
+00022e20: 2020 2020 2020 3e3e 3e20 7920 3d20 6e70        >>> y = np
+00022e30: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+00022e40: 302c 2032 2c20 2831 3030 3030 302c 2029  0, 2, (100000, )
+00022e50: 290a 2020 2020 2020 2020 3e3e 3e20 6772  ).        >>> gr
+00022e60: 6f75 6e64 5f74 7275 7468 203d 206e 702e  ound_truth = np.
+00022e70: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
+00022e80: 2c20 322c 2028 3130 3030 3030 2c20 2929  , 2, (100000, ))
+00022e90: 0a20 2020 2020 2020 203e 3e3e 2053 7461  .        >>> Sta
+00022ea0: 7469 7374 6963 732e 6d63 6e65 6d61 7228  tistics.mcnemar(
+00022eb0: 783d 782c 2079 3d79 2c20 6772 6f75 6e64  x=x, y=y, ground
+00022ec0: 5f74 7275 7468 3d67 726f 756e 645f 7472  _truth=ground_tr
+00022ed0: 7574 6829 0a20 2020 2020 2020 2022 2222  uth).        """
+00022ee0: 0a0a 2020 2020 2020 2020 6368 6563 6b5f  ..        check_
+00022ef0: 7661 6c69 645f 6172 7261 7928 0a20 2020  valid_array(.   
+00022f00: 2020 2020 2020 2020 2064 6174 613d 782c           data=x,
+00022f10: 0a20 2020 2020 2020 2020 2020 2073 6f75  .            sou
+00022f20: 7263 653d 5374 6174 6973 7469 6373 2e6d  rce=Statistics.m
+00022f30: 636e 656d 6172 2e5f 5f6e 616d 655f 5f2c  cnemar.__name__,
+00022f40: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
+00022f50: 6570 7465 645f 6e64 696d 733d 2831 2c29  epted_ndims=(1,)
+00022f60: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+00022f70: 6365 7074 6564 5f64 7479 7065 733d 286e  cepted_dtypes=(n
+00022f80: 702e 696e 7436 342c 206e 702e 696e 7433  p.int64, np.int3
+00022f90: 322c 206e 702e 696e 7438 292c 0a20 2020  2, np.int8),.   
+00022fa0: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+00022fb0: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+00022fc0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+00022fd0: 7461 3d79 2c0a 2020 2020 2020 2020 2020  ta=y,.          
+00022fe0: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
+00022ff0: 6963 732e 6d63 6e65 6d61 722e 5f5f 6e61  ics.mcnemar.__na
+00023000: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00023010: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+00023020: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
+00023030: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+00023040: 6573 3d28 6e70 2e69 6e74 3634 2c20 6e70  es=(np.int64, np
+00023050: 2e69 6e74 3332 2c20 6e70 2e69 6e74 3829  .int32, np.int8)
+00023060: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00023070: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+00023080: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+00023090: 2020 2064 6174 613d 6772 6f75 6e64 5f74     data=ground_t
+000230a0: 7275 7468 2c0a 2020 2020 2020 2020 2020  ruth,.          
+000230b0: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
+000230c0: 6963 732e 6d63 6e65 6d61 722e 5f5f 6e61  ics.mcnemar.__na
+000230d0: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+000230e0: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+000230f0: 3d28 312c 292c 0a20 2020 2020 2020 2020  =(1,),.         
+00023100: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+00023110: 6573 3d28 6e70 2e69 6e74 3634 2c20 6e70  es=(np.int64, np
+00023120: 2e69 6e74 3332 2c20 6e70 2e69 6e74 3829  .int32, np.int8)
+00023130: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00023140: 2020 2020 6966 206c 656e 286c 6973 7428      if len(list(
+00023150: 7b78 2e73 6861 7065 5b30 5d2c 2079 2e73  {x.shape[0], y.s
+00023160: 6861 7065 5b30 5d2c 2067 726f 756e 645f  hape[0], ground_
+00023170: 7472 7574 682e 7368 6170 655b 305d 7d29  truth.shape[0]})
+00023180: 2920 213d 2031 3a0a 2020 2020 2020 2020  ) != 1:.        
+00023190: 2020 2020 7261 6973 6520 436f 756e 7445      raise CountE
+000231a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+000231b0: 2020 2020 2020 6d73 673d 6622 5468 6520        msg=f"The 
+000231c0: 7468 7265 6520 6172 7261 7973 2068 6173  three arrays has
+000231d0: 2074 6f20 6265 2065 7175 616c 206c 656e   to be equal len
+000231e0: 6774 6873 2062 7574 2067 6f74 3a20 7b78  gths but got: {x
+000231f0: 2e73 6861 7065 5b30 5d2c 2079 2e73 6861  .shape[0], y.sha
+00023200: 7065 5b30 5d2c 2067 726f 756e 645f 7472  pe[0], ground_tr
+00023210: 7574 682e 7368 6170 655b 305d 7d22 2c0a  uth.shape[0]}",.
+00023220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023230: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+00023240: 732e 6d63 6e65 6d61 722e 5f5f 6e61 6d65  s.mcnemar.__name
+00023250: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
+00023260: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
+00023270: 696e 205b 782c 2079 2c20 6772 6f75 6e64  in [x, y, ground
+00023280: 5f74 7275 7468 5d3a 0a20 2020 2020 2020  _truth]:.       
+00023290: 2020 2020 2061 6464 6974 696f 6e61 6c20       additional 
+000232a0: 3d20 6c69 7374 2873 6574 286c 6973 7428  = list(set(list(
+000232b0: 6e70 2e73 6f72 7428 6e70 2e75 6e69 7175  np.sort(np.uniqu
+000232c0: 6528 6929 2929 2920 2d20 7b30 2c20 317d  e(i)))) - {0, 1}
+000232d0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+000232e0: 206c 656e 2861 6464 6974 696f 6e61 6c29   len(additional)
+000232f0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+00023300: 2020 2020 2020 7261 6973 6520 496e 7661        raise Inva
+00023310: 6c69 6449 6e70 7574 4572 726f 7228 0a20  lidInputError(. 
+00023320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023330: 2020 206d 7367 3d66 224d 636e 656d 6172     msg=f"Mcnemar
+00023340: 2072 6571 7569 7265 7320 6269 6e61 7279   requires binary
+00023350: 2069 6e70 7574 2064 6174 6120 6275 7420   input data but 
+00023360: 666f 756e 6420 7b61 6464 6974 696f 6e61  found {additiona
+00023370: 6c7d 222c 0a20 2020 2020 2020 2020 2020  l}",.           
+00023380: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00023390: 5374 6174 6973 7469 6373 2e6d 636e 656d  Statistics.mcnem
+000233a0: 6172 2e5f 5f6e 616d 655f 5f2c 0a20 2020  ar.__name__,.   
+000233b0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000233c0: 2020 2020 2020 2064 6174 6120 3d20 6e70         data = np
+000233d0: 2e68 7374 6163 6b28 0a20 2020 2020 2020  .hstack(.       
+000233e0: 2020 2020 2028 782e 7265 7368 6170 6528       (x.reshape(
+000233f0: 2d31 2c20 3129 2c20 792e 7265 7368 6170  -1, 1), y.reshap
+00023400: 6528 2d31 2c20 3129 2c20 6772 6f75 6e64  e(-1, 1), ground
+00023410: 5f74 7275 7468 2e72 6573 6861 7065 282d  _truth.reshape(-
+00023420: 312c 2031 2929 0a20 2020 2020 2020 2029  1, 1)).        )
+00023430: 0a20 2020 2020 2020 2062 203d 2028 0a20  .        b = (. 
+00023440: 2020 2020 2020 2020 2020 206e 702e 7768             np.wh
+00023450: 6572 6528 2864 6174 6120 3d3d 2028 302c  ere((data == (0,
+00023460: 2031 2c20 3029 292e 616c 6c28 6178 6973   1, 0)).all(axis
+00023470: 3d31 2929 5b30 5d2e 7368 6170 655b 305d  =1))[0].shape[0]
+00023480: 0a20 2020 2020 2020 2020 2020 202b 206e  .            + n
+00023490: 702e 7768 6572 6528 2864 6174 6120 3d3d  p.where((data ==
+000234a0: 2028 312c 2030 2c20 3129 292e 616c 6c28   (1, 0, 1)).all(
+000234b0: 6178 6973 3d31 2929 5b30 5d2e 7368 6170  axis=1))[0].shap
+000234c0: 655b 305d 0a20 2020 2020 2020 2029 0a20  e[0].        ). 
+000234d0: 2020 2020 2020 2063 203d 2028 0a20 2020         c = (.   
+000234e0: 2020 2020 2020 2020 206e 702e 7768 6572           np.wher
+000234f0: 6528 2864 6174 6120 3d3d 2028 312c 2030  e((data == (1, 0
+00023500: 2c20 3029 292e 616c 6c28 6178 6973 3d31  , 0)).all(axis=1
+00023510: 2929 5b30 5d2e 7368 6170 655b 305d 0a20  ))[0].shape[0]. 
+00023520: 2020 2020 2020 2020 2020 202b 206e 702e             + np.
+00023530: 7768 6572 6528 2864 6174 6120 3d3d 2028  where((data == (
+00023540: 302c 2031 2c20 3129 292e 616c 6c28 6178  0, 1, 1)).all(ax
+00023550: 6973 3d31 2929 5b30 5d2e 7368 6170 655b  is=1))[0].shape[
+00023560: 305d 0a20 2020 2020 2020 2029 0a20 2020  0].        ).   
+00023570: 2020 2020 2069 6620 6e6f 7420 636f 6e74       if not cont
+00023580: 696e 7569 7479 5f63 6f72 7265 6374 6564  inuity_corrected
+00023590: 3a0a 2020 2020 2020 2020 2020 2020 7820  :.            x 
+000235a0: 3d20 286e 702e 7371 7561 7265 2862 202d  = (np.square(b -
+000235b0: 2063 2929 202f 2028 6220 2b20 6329 0a20   c)) / (b + c). 
+000235c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000235d0: 2020 2020 2020 2020 2078 203d 2028 6e70           x = (np
+000235e0: 2e73 7175 6172 6528 6e70 2e61 6273 2862  .square(np.abs(b
+000235f0: 202d 2063 2920 2d20 3129 2920 2f20 2862   - c) - 1)) / (b
+00023600: 202b 2063 290a 2020 2020 2020 2020 7020   + c).        p 
+00023610: 3d20 6368 6932 2e73 6628 782c 2031 290a  = chi2.sf(x, 1).
+00023620: 2020 2020 2020 2020 7265 7475 726e 2078          return x
+00023630: 2c20 700a 0a20 2020 2040 7374 6174 6963  , p..    @static
+00023640: 6d65 7468 6f64 0a20 2020 2064 6566 2063  method.    def c
+00023650: 6f63 6872 616e 735f 7128 6461 7461 3a20  ochrans_q(data: 
+00023660: 6e70 2e6e 6461 7272 6179 2920 2d3e 2054  np.ndarray) -> T
+00023670: 7570 6c65 5b66 6c6f 6174 2c20 666c 6f61  uple[float, floa
+00023680: 745d 3a0a 2020 2020 2020 2020 2222 220a  t]:.        """.
+00023690: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+000236a0: 436f 6368 7261 6e73 2051 2066 6f72 2032  Cochrans Q for 2
+000236b0: 2d64 696d 656e 7369 6f6e 616c 2062 6f6f  -dimensional boo
+000236c0: 6c65 616e 2061 7272 6179 2e0a 0a20 2020  lean array...   
+000236d0: 2020 2020 2043 6f63 6872 616e 2773 2051       Cochran's Q
+000236e0: 2073 7461 7469 7374 6963 2069 7320 7573   statistic is us
+000236f0: 6564 2074 6f20 7465 7374 2066 6f72 2073  ed to test for s
+00023700: 6967 6e69 6669 6361 6e74 2064 6966 6665  ignificant diffe
+00023710: 7265 6e63 6573 2062 6574 7765 656e 206d  rences between m
+00023720: 6f72 6520 7468 616e 2074 776f 2070 726f  ore than two pro
+00023730: 706f 7274 696f 6e73 2e0a 2020 2020 2020  portions..      
+00023740: 2020 4974 2063 616e 2062 6520 7573 6564    It can be used
+00023750: 2074 6f20 6576 616c 7561 7465 2069 6620   to evaluate if 
+00023760: 7468 6520 7065 7266 6f72 6d61 6e63 6520  the performance 
+00023770: 6f66 206d 756c 7469 706c 6520 283e 3d32  of multiple (>=2
+00023780: 2920 636c 6173 7369 6669 6572 7320 6f6e  ) classifiers on
+00023790: 2074 6865 2073 616d 6520 6461 7461 2069   the same data i
+000237a0: 7320 7468 6520 7361 6d65 206f 7220 7369  s the same or si
+000237b0: 676e 6966 6963 616e 746c 7920 6469 6666  gnificantly diff
+000237c0: 6572 656e 742e 0a0a 2020 2020 2020 2020  erent...        
+000237d0: 2e2e 206e 6f74 653a 3a0a 2020 2020 2020  .. note::.      
+000237e0: 2020 2020 2049 6620 7477 6f20 636c 6173       If two clas
+000237f0: 7369 6669 6572 732c 2063 6f6e 7369 6465  sifiers, conside
+00023800: 7220 6060 7369 6d62 612e 6d69 7869 6e73  r ``simba.mixins
+00023810: 2e73 7461 7469 7374 6963 732e 5374 6174  .statistics.Stat
+00023820: 6973 7469 6373 2e6d 636e 656d 6172 6060  istics.mcnemar``
+00023830: 2e0a 0a20 2020 2020 2020 2020 2020 5573  ...           Us
+00023840: 6566 756c 2062 6163 6b67 726f 756e 643a  eful background:
+00023850: 2068 7474 7073 3a2f 2f70 7379 6368 2e75   https://psych.u
+00023860: 6e6c 2e65 6475 2f70 7379 6372 732f 6861  nl.edu/psycrs/ha
+00023870: 6e64 636f 6d70 2f68 6363 6f63 6872 616e  ndcomp/hccochran
+00023880: 2e50 4446 0a0a 2020 2020 2020 2020 3a70  .PDF..        :p
+00023890: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+000238a0: 6461 7461 3a20 5477 6f20 6469 6d65 6e73  data: Two dimens
+000238b0: 696f 6e61 6c20 6172 7261 7920 6f66 2062  ional array of b
+000238c0: 6f6f 6c65 616e 2076 616c 7565 7320 7768  oolean values wh
+000238d0: 6572 6520 6178 6973 2031 2072 6570 7265  ere axis 1 repre
+000238e0: 7365 6e74 7320 636c 6173 7369 6669 6572  sents classifier
+000238f0: 7320 6f72 2066 6561 7475 7265 7320 616e  s or features an
+00023900: 6420 726f 7773 2072 6570 7265 7365 6e74  d rows represent
+00023910: 2066 7261 6d65 732e 0a20 2020 2020 2020   frames..       
+00023920: 203a 7265 7475 726e 2054 7570 6c65 5b66   :return Tuple[f
+00023930: 6c6f 6174 2c20 666c 6f61 745d 3a20 436f  loat, float]: Co
+00023940: 6368 7261 6e27 7320 5120 7374 6174 6973  chran's Q statis
+00023950: 7469 6320 7369 676e 6964 6963 616e 6365  tic signidicance
+00023960: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
+00023970: 203a 6578 616d 706c 653a 0a20 2020 2020   :example:.     
+00023980: 2020 203e 3e3e 2064 6174 6120 3d20 6e70     >>> data = np
+00023990: 2e72 616e 646f 6d2e 7261 6e64 696e 7428  .random.randint(
+000239a0: 302c 2032 2c20 2831 3030 3030 302c 2034  0, 2, (100000, 4
+000239b0: 2929 0a20 2020 2020 2020 203e 3e3e 2053  )).        >>> S
+000239c0: 7461 7469 7374 6963 732e 636f 6368 7261  tatistics.cochra
+000239d0: 6e73 5f71 2864 6174 613d 6461 7461 290a  ns_q(data=data).
+000239e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000239f0: 2020 2020 6368 6563 6b5f 7661 6c69 645f      check_valid_
+00023a00: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+00023a10: 2020 2064 6174 613d 6461 7461 2c20 736f     data=data, so
+00023a20: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
+00023a30: 636f 6368 7261 6e73 5f71 2e5f 5f6e 616d  cochrans_q.__nam
+00023a40: 655f 5f2c 2061 6363 6570 7465 645f 6e64  e__, accepted_nd
+00023a50: 696d 733d 2832 2c29 0a20 2020 2020 2020  ims=(2,).       
+00023a60: 2029 0a20 2020 2020 2020 2061 6464 6974   ).        addit
+00023a70: 696f 6e61 6c20 3d20 6c69 7374 2873 6574  ional = list(set
+00023a80: 286c 6973 7428 6e70 2e73 6f72 7428 6e70  (list(np.sort(np
+00023a90: 2e75 6e69 7175 6528 6461 7461 2929 2929  .unique(data))))
+00023aa0: 202d 207b 302c 2031 7d29 0a20 2020 2020   - {0, 1}).     
+00023ab0: 2020 2069 6620 6c65 6e28 6164 6469 7469     if len(additi
+00023ac0: 6f6e 616c 2920 3e20 303a 0a20 2020 2020  onal) > 0:.     
+00023ad0: 2020 2020 2020 2072 6169 7365 2049 6e76         raise Inv
+00023ae0: 616c 6964 496e 7075 7445 7272 6f72 280a  alidInputError(.
+00023af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b00: 6d73 673d 6622 436f 6368 7261 6e73 2051  msg=f"Cochrans Q
+00023b10: 2072 6571 7569 7265 7320 6269 6e61 7279   requires binary
+00023b20: 2069 6e70 7574 2064 6174 6120 6275 7420   input data but 
+00023b30: 666f 756e 6420 7b61 6464 6974 696f 6e61  found {additiona
+00023b40: 6c7d 222c 0a20 2020 2020 2020 2020 2020  l}",.           
+00023b50: 2020 2020 2073 6f75 7263 653d 5374 6174       source=Stat
+00023b60: 6973 7469 6373 2e63 6f63 6872 616e 735f  istics.cochrans_
+00023b70: 712e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  q.__name__,.    
+00023b80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00023b90: 2020 636f 6c5f 7375 6d73 203d 206e 702e    col_sums = np.
+00023ba0: 7375 6d28 6461 7461 2c20 6178 6973 3d30  sum(data, axis=0
+00023bb0: 290a 2020 2020 2020 2020 726f 775f 7375  ).        row_su
+00023bc0: 6d5f 7375 6d20 3d20 6e70 2e73 756d 286e  m_sum = np.sum(n
+00023bd0: 702e 7375 6d28 6461 7461 2c20 6178 6973  p.sum(data, axis
+00023be0: 3d31 2929 0a20 2020 2020 2020 2072 6f77  =1)).        row
+00023bf0: 5f73 756d 5f73 7175 6172 655f 7375 6d20  _sum_square_sum 
+00023c00: 3d20 6e70 2e73 756d 286e 702e 7371 7561  = np.sum(np.squa
+00023c10: 7265 286e 702e 7375 6d28 6461 7461 2c20  re(np.sum(data, 
+00023c20: 6178 6973 3d31 2929 290a 2020 2020 2020  axis=1))).      
+00023c30: 2020 6b20 3d20 6461 7461 2e73 6861 7065    k = data.shape
+00023c40: 5b31 5d0a 2020 2020 2020 2020 6732 203d  [1].        g2 =
+00023c50: 206e 702e 7375 6d28 7375 6d28 6e70 2e73   np.sum(sum(np.s
+00023c60: 7175 6172 6528 636f 6c5f 7375 6d73 2929  quare(col_sums))
+00023c70: 290a 2020 2020 2020 2020 6e6f 6d69 6e61  ).        nomina
+00023c80: 746f 7220 3d20 286b 202d 2031 2920 2a20  tor = (k - 1) * 
+00023c90: 2828 6b20 2a20 6732 2920 2d20 6e70 2e73  ((k * g2) - np.s
+00023ca0: 7175 6172 6528 6e70 2e73 756d 2863 6f6c  quare(np.sum(col
+00023cb0: 5f73 756d 7329 2929 0a20 2020 2020 2020  _sums))).       
+00023cc0: 2064 656e 6f6d 696e 6174 6f72 203d 2028   denominator = (
+00023cd0: 6b20 2a20 726f 775f 7375 6d5f 7375 6d29  k * row_sum_sum)
+00023ce0: 202d 2072 6f77 5f73 756d 5f73 7175 6172   - row_sum_squar
+00023cf0: 655f 7375 6d0a 2020 2020 2020 2020 6966  e_sum.        if
+00023d00: 206e 6f6d 696e 6174 6f72 203d 3d20 3020   nominator == 0 
+00023d10: 6f72 2064 656e 6f6d 696e 6174 6f72 203d  or denominator =
+00023d20: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00023d30: 2072 6574 7572 6e20 2d31 2e30 2c20 2d31   return -1.0, -1
+00023d40: 2e30 0a20 2020 2020 2020 2065 6c73 653a  .0.        else:
+00023d50: 0a20 2020 2020 2020 2020 2020 2071 203d  .            q =
+00023d60: 2028 6e6f 6d69 6e61 746f 7220 2f20 6465   (nominator / de
+00023d70: 6e6f 6d69 6e61 746f 722c 290a 2020 2020  nominator,).    
+00023d80: 2020 2020 2020 2020 7265 7475 726e 2071          return q
+00023d90: 2c20 7374 6174 732e 6368 6932 2e73 6628  , stats.chi2.sf(
+00023da0: 712c 206b 202d 2031 290a 0a20 2020 2040  q, k - 1)..    @
+00023db0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00023dc0: 2064 6566 2068 6172 746c 6579 5f66 6d61   def hartley_fma
+00023dd0: 7828 783a 206e 702e 6e64 6172 7261 792c  x(x: np.ndarray,
+00023de0: 2079 3a20 6e70 2e6e 6461 7272 6179 2920   y: np.ndarray) 
+00023df0: 2d3e 2066 6c6f 6174 3a0a 2020 2020 2020  -> float:.      
+00023e00: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
+00023e10: 6d70 7574 6520 4861 7274 6c65 7927 7320  mpute Hartley's 
+00023e20: 466d 6178 2073 7461 7469 7374 6963 2074  Fmax statistic t
+00023e30: 6f20 7465 7374 2066 6f72 2065 7175 616c  o test for equal
+00023e40: 6974 7920 6f66 2076 6172 6961 6e63 6573  ity of variances
+00023e50: 2062 6574 7765 656e 2074 776f 2066 6561   between two fea
+00023e60: 7475 7265 7320 6f72 2067 726f 7570 732e  tures or groups.
+00023e70: 0a0a 2020 2020 2020 2020 4861 7274 6c65  ..        Hartle
+00023e80: 7927 7320 466d 6178 2073 7461 7469 7374  y's Fmax statist
+00023e90: 6963 2069 7320 7573 6564 2074 6f20 7465  ic is used to te
+00023ea0: 7374 2077 6865 7468 6572 2074 776f 2073  st whether two s
+00023eb0: 616d 706c 6573 2068 6176 6520 6571 7561  amples have equa
+00023ec0: 6c20 7661 7269 616e 6365 732e 0a20 2020  l variances..   
+00023ed0: 2020 2020 2049 7420 6973 2063 616c 6375       It is calcu
+00023ee0: 6c61 7465 6420 6173 2074 6865 2072 6174  lated as the rat
+00023ef0: 696f 206f 6620 7468 6520 6c61 7267 6573  io of the larges
+00023f00: 7420 7361 6d70 6c65 2076 6172 6961 6e63  t sample varianc
+00023f10: 6520 746f 2074 6865 2073 6d61 6c6c 6573  e to the smalles
+00023f20: 7420 7361 6d70 6c65 2076 6172 6961 6e63  t sample varianc
+00023f30: 652e 0a20 2020 2020 2020 2056 616c 7565  e..        Value
+00023f40: 7320 636c 6f73 6520 746f 206f 6e65 2072  s close to one r
+00023f50: 6570 7265 7365 6e74 2063 6c6f 7365 7220  epresent closer 
+00023f60: 746f 2065 7175 616c 2076 6172 6961 6e63  to equal varianc
+00023f70: 652e 0a0a 2020 2020 2020 2020 2e2e 206d  e...        .. m
+00023f80: 6174 683a 3a0a 0a20 2020 2020 2020 2020  ath::..         
+00023f90: 2020 5c74 6578 747b 4861 7274 6c65 7927    \text{Hartley'
+00023fa0: 7320 466d 6178 7d20 3d20 5c66 7261 637b  s Fmax} = \frac{
+00023fb0: 5c6d 6178 285c 7465 7874 7b56 6172 7d28  \max(\text{Var}(
+00023fc0: 7829 2c20 5c74 6578 747b 5661 727d 2879  x), \text{Var}(y
+00023fd0: 2929 7d7b 5c6d 696e 285c 7465 7874 7b56  ))}{\min(\text{V
+00023fe0: 6172 7d28 7829 2c20 5c74 6578 747b 5661  ar}(x), \text{Va
+00023ff0: 727d 2879 2929 7d0a 0a20 2020 2020 2020  r}(y))}..       
+00024000: 2077 6865 7265 3a0a 2020 2020 2020 2020   where:.        
+00024010: 2020 2020 2d20 5661 7228 7829 2069 7320      - Var(x) is 
+00024020: 7468 6520 7661 7269 616e 6365 206f 6620  the variance of 
+00024030: 7361 6d70 6c65 2078 2c0a 2020 2020 2020  sample x,.      
+00024040: 2020 2020 2020 2d20 5661 7228 7929 2069        - Var(y) i
+00024050: 7320 7468 6520 7661 7269 616e 6365 206f  s the variance o
+00024060: 6620 7361 6d70 6c65 2079 2e0a 0a20 2020  f sample y...   
+00024070: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
+00024080: 6461 7272 6179 2078 3a20 3144 2061 7272  darray x: 1D arr
+00024090: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+000240a0: 6e75 6d65 7269 6320 6461 7461 206f 6620  numeric data of 
+000240b0: 7468 6520 6669 7273 7420 6772 6f75 702f  the first group/
+000240c0: 6665 6174 7572 652e 0a20 2020 2020 2020  feature..       
+000240d0: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
+000240e0: 6179 2078 3a20 3144 2061 7272 6179 2072  ay x: 1D array r
+000240f0: 6570 7265 7365 6e74 696e 6720 6e75 6d65  epresenting nume
+00024100: 7269 6320 6461 7461 206f 6620 7468 6520  ric data of the 
+00024110: 7365 636f 6e64 2067 726f 7570 2f66 6561  second group/fea
+00024120: 7475 7265 2e0a 0a20 2020 2020 2020 203a  ture...        :
+00024130: 6578 616d 706c 653a 0a20 2020 2020 2020  example:.       
+00024140: 203e 3e3e 2078 203d 206e 702e 7261 6e64   >>> x = np.rand
+00024150: 6f6d 2e72 616e 646f 6d28 2831 3030 2c29  om.random((100,)
+00024160: 290a 2020 2020 2020 2020 3e3e 3e20 7920  ).        >>> y 
+00024170: 3d20 6e70 2e72 616e 646f 6d2e 7261 6e64  = np.random.rand
+00024180: 6f6d 2828 3130 302c 2929 0a20 2020 2020  om((100,)).     
+00024190: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+000241a0: 732e 6861 7274 6c65 795f 666d 6178 2878  s.hartley_fmax(x
+000241b0: 3d78 2c20 793d 7929 0a20 2020 2020 2020  =x, y=y).       
+000241c0: 2022 2222 0a20 2020 2020 2020 2063 6865   """.        che
+000241d0: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
+000241e0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000241f0: 3d78 2c0a 2020 2020 2020 2020 2020 2020  =x,.            
+00024200: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+00024210: 732e 6861 7274 6c65 795f 666d 6178 2e5f  s.hartley_fmax._
+00024220: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+00024230: 2020 2020 2061 6363 6570 7465 645f 6e64       accepted_nd
+00024240: 696d 733d 2831 2c29 2c0a 2020 2020 2020  ims=(1,),.      
+00024250: 2020 2020 2020 6163 6365 7074 6564 5f64        accepted_d
+00024260: 7479 7065 733d 286e 702e 666c 6f61 7433  types=(np.float3
+00024270: 322c 206e 702e 666c 6f61 7436 342c 206e  2, np.float64, n
+00024280: 702e 696e 7436 342c 206e 702e 666c 6f61  p.int64, np.floa
+00024290: 7433 3229 2c0a 2020 2020 2020 2020 290a  t32),.        ).
+000242a0: 2020 2020 2020 2020 6368 6563 6b5f 7661          check_va
+000242b0: 6c69 645f 6172 7261 7928 0a20 2020 2020  lid_array(.     
+000242c0: 2020 2020 2020 2064 6174 613d 792c 0a20         data=y,. 
+000242d0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+000242e0: 653d 5374 6174 6973 7469 6373 2e68 6172  e=Statistics.har
+000242f0: 746c 6579 5f66 6d61 782e 5f5f 6e61 6d65  tley_fmax.__name
+00024300: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
+00024310: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
+00024320: 312c 292c 0a20 2020 2020 2020 2020 2020  1,),.           
+00024330: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
+00024340: 3d28 6e70 2e66 6c6f 6174 3332 2c20 6e70  =(np.float32, np
+00024350: 2e66 6c6f 6174 3634 2c20 6e70 2e69 6e74  .float64, np.int
+00024360: 3634 2c20 6e70 2e66 6c6f 6174 3332 292c  64, np.float32),
+00024370: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00024380: 2020 206d 6178 5f76 6172 203d 206e 702e     max_var = np.
+00024390: 6d61 7828 286e 702e 7661 7228 7829 2c20  max((np.var(x), 
+000243a0: 6e70 2e76 6172 2879 2929 290a 2020 2020  np.var(y))).    
+000243b0: 2020 2020 6d69 6e5f 7661 7220 3d20 6e70      min_var = np
+000243c0: 2e6d 696e 2828 6e70 2e76 6172 2878 292c  .min((np.var(x),
+000243d0: 206e 702e 7661 7228 7929 2929 0a20 2020   np.var(y))).   
+000243e0: 2020 2020 2069 6620 286d 6178 5f76 6172       if (max_var
+000243f0: 203d 3d20 3029 206f 7220 286d 696e 5f76   == 0) or (min_v
+00024400: 6172 203d 3d20 3029 3a0a 2020 2020 2020  ar == 0):.      
+00024410: 2020 2020 2020 7265 7475 726e 202d 312e        return -1.
+00024420: 300a 2020 2020 2020 2020 7265 7475 726e  0.        return
+00024430: 206d 6178 5f76 6172 202f 206d 696e 5f76   max_var / min_v
+00024440: 6172 0a0a 2020 2020 4073 7461 7469 636d  ar..    @staticm
+00024450: 6574 686f 640a 2020 2020 6465 6620 6772  ethod.    def gr
+00024460: 7562 6273 5f74 6573 7428 783a 206e 702e  ubbs_test(x: np.
+00024470: 6e64 6172 7261 792c 206c 6566 745f 7461  ndarray, left_ta
+00024480: 696c 3a20 4f70 7469 6f6e 616c 5b62 6f6f  il: Optional[boo
+00024490: 6c5d 203d 2046 616c 7365 2920 2d3e 2066  l] = False) -> f
+000244a0: 6c6f 6174 3a0a 2020 2020 2020 2020 2222  loat:.        ""
+000244b0: 220a 2020 2020 2020 2020 5065 7266 6f72  ".        Perfor
+000244c0: 6d20 4772 7562 6273 2720 7465 7374 2074  m Grubbs' test t
+000244d0: 6f20 6465 7465 6374 206f 7574 6c69 6572  o detect outlier
+000244e0: 7320 6966 2074 6865 206d 696e 696d 756d  s if the minimum
+000244f0: 206f 7220 6d61 7869 6d75 6d20 7661 6c75   or maximum valu
+00024500: 6520 696e 2061 2066 6561 7475 7265 2073  e in a feature s
+00024510: 6572 6965 7320 6973 2061 6e20 6f75 746c  eries is an outl
+00024520: 6965 722e 0a0a 2020 2020 2020 2020 4772  ier...        Gr
+00024530: 7562 6273 2720 7465 7374 2069 7320 6120  ubbs' test is a 
+00024540: 7374 6174 6973 7469 6361 6c20 7465 7374  statistical test
+00024550: 2075 7365 6420 746f 2064 6574 6563 7420   used to detect 
+00024560: 6f75 746c 6965 7273 2069 6e20 6120 756e  outliers in a un
+00024570: 6976 6172 6961 7465 2064 6174 6120 7365  ivariate data se
+00024580: 742e 0a20 2020 2020 2020 2049 7420 6361  t..        It ca
+00024590: 6c63 756c 6174 6573 2074 6865 2047 7275  lculates the Gru
+000245a0: 6262 7327 2074 6573 7420 7374 6174 6973  bbs' test statis
+000245b0: 7469 6320 6173 2074 6865 2061 6273 6f6c  tic as the absol
+000245c0: 7574 6520 6469 6666 6572 656e 6365 2062  ute difference b
+000245d0: 6574 7765 656e 2074 6865 0a20 2020 2020  etween the.     
+000245e0: 2020 2065 7874 7265 6d65 2076 616c 7565     extreme value
+000245f0: 2028 6569 7468 6572 2074 6865 206d 696e   (either the min
+00024600: 696d 756d 206f 7220 6d61 7869 6d75 6d29  imum or maximum)
+00024610: 2061 6e64 2074 6865 2073 616d 706c 6520   and the sample 
+00024620: 6d65 616e 2c20 6469 7669 6465 6420 6279  mean, divided by
+00024630: 2074 6865 2073 616d 706c 6520 7374 616e   the sample stan
+00024640: 6461 7264 2064 6576 6961 7469 6f6e 2e0a  dard deviation..
+00024650: 0a20 2020 2020 2020 202e 2e20 6d61 7468  .        .. math
+00024660: 3a3a 0a0a 2020 2020 2020 2020 2020 205c  ::..           \
+00024670: 7465 7874 7b47 7275 6262 7327 2054 6573  text{Grubbs' Tes
+00024680: 7420 5374 6174 6973 7469 637d 203d 205c  t Statistic} = \
+00024690: 6672 6163 7b7c 5c62 6172 7b78 7d20 2d20  frac{|\bar{x} - 
+000246a0: 785f 7b5c 7465 7874 7b6d 696e 2f6d 6178  x_{\text{min/max
+000246b0: 7d7d 7c7d 7b73 7d0a 0a20 2020 2020 2020  }}|}{s}..       
+000246c0: 2077 6865 7265 3a0a 2020 2020 2020 2020   where:.        
+000246d0: 2020 2020 2d20 5c28 205c 6261 727b 787d      - \( \bar{x}
+000246e0: 205c 2920 6973 2074 6865 2073 616d 706c   \) is the sampl
+000246f0: 6520 6d65 616e 2c0a 2020 2020 2020 2020  e mean,.        
+00024700: 2020 2020 2d20 5c28 2078 5f7b 5c74 6578      - \( x_{\tex
+00024710: 747b 6d69 6e2f 6d61 787d 7d20 5c29 2069  t{min/max}} \) i
+00024720: 7320 7468 6520 6d69 6e69 6d75 6d20 6f72  s the minimum or
+00024730: 206d 6178 696d 756d 2076 616c 7565 206f   maximum value o
+00024740: 6620 7468 6520 7361 6d70 6c65 2028 6465  f the sample (de
+00024750: 7065 6e64 696e 6720 6f6e 2074 6865 2074  pending on the t
+00024760: 6169 6c20 6265 696e 6720 7465 7374 6564  ail being tested
+00024770: 292c 0a20 2020 2020 2020 2020 2020 202d  ),.            -
+00024780: 205c 2820 7320 5c29 2069 7320 7468 6520   \( s \) is the 
+00024790: 7361 6d70 6c65 2073 7461 6e64 6172 6420  sample standard 
+000247a0: 6465 7669 6174 696f 6e2e 0a0a 2020 2020  deviation...    
+000247b0: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+000247c0: 6172 7261 7920 783a 2031 4420 6172 7261  array x: 1D arra
+000247d0: 7920 7265 7072 6573 656e 7469 6e67 206e  y representing n
+000247e0: 756d 6572 6963 2064 6174 612e 0a20 2020  umeric data..   
+000247f0: 2020 2020 203a 7061 7261 6d20 4f70 7469       :param Opti
+00024800: 6f6e 616c 5b62 6f6f 6c5d 206c 6566 745f  onal[bool] left_
+00024810: 7461 696c 3a20 4966 2054 7275 652c 2074  tail: If True, t
+00024820: 6865 2074 6573 7420 6361 6c63 756c 6174  he test calculat
+00024830: 6573 2074 6865 2047 7275 6262 7327 2074  es the Grubbs' t
+00024840: 6573 7420 7374 6174 6973 7469 6320 666f  est statistic fo
+00024850: 7220 7468 6520 6c65 6674 2074 6169 6c20  r the left tail 
+00024860: 286d 696e 696d 756d 2076 616c 7565 292e  (minimum value).
+00024870: 2049 6620 4661 6c73 6520 2864 6566 6175   If False (defau
+00024880: 6c74 292c 2069 7420 6361 6c63 756c 6174  lt), it calculat
+00024890: 6573 2074 6865 2073 7461 7469 7374 6963  es the statistic
+000248a0: 2066 6f72 2074 6865 2072 6967 6874 2074   for the right t
+000248b0: 6169 6c20 286d 6178 696d 756d 2076 616c  ail (maximum val
+000248c0: 7565 292e 0a20 2020 2020 2020 203a 7265  ue)..        :re
+000248d0: 7475 726e 2066 6c6f 6174 3a20 5468 6520  turn float: The 
+000248e0: 636f 6d70 7574 6564 2047 7275 6262 7327  computed Grubbs'
+000248f0: 2074 6573 7420 7374 6174 6973 7469 632e   test statistic.
+00024900: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+00024910: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+00024920: 7820 3d20 6e70 2e72 616e 646f 6d2e 7261  x = np.random.ra
+00024930: 6e64 6f6d 2828 3130 302c 2929 0a20 2020  ndom((100,)).   
+00024940: 2020 2020 203e 3e3e 2053 7461 7469 7374       >>> Statist
+00024950: 6963 732e 6772 7562 6273 5f74 6573 7428  ics.grubbs_test(
+00024960: 783d 7829 0a20 2020 2020 2020 2022 2222  x=x).        """
+00024970: 0a20 2020 2020 2020 2063 6865 636b 5f76  .        check_v
+00024980: 616c 6964 5f61 7272 6179 280a 2020 2020  alid_array(.    
+00024990: 2020 2020 2020 2020 6461 7461 3d78 2c0a          data=x,.
+000249a0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+000249b0: 6365 3d53 7461 7469 7374 6963 732e 6772  ce=Statistics.gr
+000249c0: 7562 6273 5f74 6573 742e 5f5f 6e61 6d65  ubbs_test.__name
+000249d0: 5f5f 2c0a 2020 2020 2020 2020 2020 2020  __,.            
+000249e0: 6163 6365 7074 6564 5f6e 6469 6d73 3d28  accepted_ndims=(
+000249f0: 312c 292c 0a20 2020 2020 2020 2020 2020  1,),.           
+00024a00: 2061 6363 6570 7465 645f 6474 7970 6573   accepted_dtypes
+00024a10: 3d28 6e70 2e66 6c6f 6174 3332 2c20 6e70  =(np.float32, np
+00024a20: 2e66 6c6f 6174 3634 2c20 6e70 2e69 6e74  .float64, np.int
+00024a30: 3634 2c20 6e70 2e66 6c6f 6174 3332 292c  64, np.float32),
+00024a40: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00024a50: 2020 2078 203d 206e 702e 736f 7274 2878     x = np.sort(x
+00024a60: 290a 2020 2020 2020 2020 6966 206c 6566  ).        if lef
+00024a70: 745f 7461 696c 3a0a 2020 2020 2020 2020  t_tail:.        
+00024a80: 2020 2020 7265 7475 726e 2028 6e70 2e6d      return (np.m
+00024a90: 6561 6e28 7829 202d 206e 702e 6d69 6e28  ean(x) - np.min(
+00024aa0: 7829 2920 2f20 6e70 2e73 7464 2878 290a  x)) / np.std(x).
+00024ab0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00024ac0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00024ad0: 2028 6e70 2e6d 6178 2878 2920 2d20 6e70   (np.max(x) - np
+00024ae0: 2e6d 6561 6e28 7829 2920 2f20 6e70 2e73  .mean(x)) / np.s
+00024af0: 7464 2878 290a 0a20 2020 2040 7374 6174  td(x)..    @stat
+00024b00: 6963 6d65 7468 6f64 0a20 2020 2064 6566  icmethod.    def
+00024b10: 2077 696c 636f 786f 6e28 783a 206e 702e   wilcoxon(x: np.
+00024b20: 6e64 6172 7261 792c 2079 3a20 6e70 2e6e  ndarray, y: np.n
+00024b30: 6461 7272 6179 2920 2d3e 2054 7570 6c65  darray) -> Tuple
+00024b40: 5b66 6c6f 6174 2c20 666c 6f61 745d 3a0a  [float, float]:.
+00024b50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00024b60: 2020 2020 5065 7266 6f72 6d20 7468 6520      Perform the 
+00024b70: 5769 6c63 6f78 6f6e 2073 6967 6e65 642d  Wilcoxon signed-
+00024b80: 7261 6e6b 2074 6573 7420 666f 7220 7061  rank test for pa
+00024b90: 6972 6564 2073 616d 706c 6573 2e0a 0a20  ired samples... 
+00024ba0: 2020 2020 2020 2057 696c 636f 786f 6e20         Wilcoxon 
+00024bb0: 7369 676e 6564 2d72 616e 6b20 7465 7374  signed-rank test
+00024bc0: 2069 7320 6120 6e6f 6e2d 7061 7261 6d65   is a non-parame
+00024bd0: 7472 6963 2073 7461 7469 7374 6963 616c  tric statistical
+00024be0: 2068 7970 6f74 6865 7369 7320 7465 7374   hypothesis test
+00024bf0: 2075 7365 640a 2020 2020 2020 2020 746f   used.        to
+00024c00: 2063 6f6d 7061 7265 2074 776f 2072 656c   compare two rel
+00024c10: 6174 6564 2073 616d 706c 6573 2c20 6d61  ated samples, ma
+00024c20: 7463 6865 6420 7361 6d70 6c65 732c 206f  tched samples, o
+00024c30: 7220 7265 7065 6174 6564 206d 6561 7375  r repeated measu
+00024c40: 7265 6d65 6e74 7320 6f6e 2061 2073 696e  rements on a sin
+00024c50: 676c 6520 7361 6d70 6c65 0a20 2020 2020  gle sample.     
+00024c60: 2020 2074 6f20 6173 7365 7373 2077 6865     to assess whe
+00024c70: 7468 6572 2074 6865 6972 2070 6f70 756c  ther their popul
+00024c80: 6174 696f 6e20 6d65 616e 2072 616e 6b73  ation mean ranks
+00024c90: 2064 6966 6665 722e 0a0a 2020 2020 2020   differ...      
+00024ca0: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+00024cb0: 7261 7920 783a 2031 4420 6172 7261 7920  ray x: 1D array 
+00024cc0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+00024cd0: 206f 6273 6572 7661 7469 6f6e 7320 666f   observations fo
+00024ce0: 7220 7468 6520 6669 7273 7420 7361 6d70  r the first samp
+00024cf0: 6c65 2e0a 2020 2020 2020 2020 3a70 6172  le..        :par
+00024d00: 616d 206e 702e 6e64 6172 7261 7920 793a  am np.ndarray y:
+00024d10: 2031 4420 6172 7261 7920 7265 7072 6573   1D array repres
+00024d20: 656e 7469 6e67 2074 6865 206f 6273 6572  enting the obser
+00024d30: 7661 7469 6f6e 7320 666f 7220 7468 6520  vations for the 
+00024d40: 7365 636f 6e64 2073 616d 706c 652e 0a20  second sample.. 
+00024d50: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00024d60: 4120 7475 706c 6520 636f 6e74 6169 6e69  A tuple containi
+00024d70: 6e67 2074 6865 2074 6573 7420 7374 6174  ng the test stat
+00024d80: 6973 7469 6320 287a 2d73 636f 7265 2920  istic (z-score) 
+00024d90: 616e 6420 7468 6520 6566 6665 6374 2073  and the effect s
+00024da0: 697a 6520 2872 292e 0a20 2020 2020 2020  ize (r)..       
+00024db0: 202d 2054 6865 2074 6573 7420 7374 6174   - The test stat
+00024dc0: 6973 7469 6320 287a 2d73 636f 7265 2920  istic (z-score) 
+00024dd0: 6d65 6173 7572 6573 2074 6865 2064 6576  measures the dev
+00024de0: 6961 7469 6f6e 206f 6620 7468 6520 6f62  iation of the ob
+00024df0: 7365 7276 6564 2072 616e 6b73 2073 756d  served ranks sum
+00024e00: 2066 726f 6d20 7468 6520 6578 7065 6374   from the expect
+00024e10: 6564 2073 756d 2e0a 2020 2020 2020 2020  ed sum..        
+00024e20: 2d20 5468 6520 6566 6665 6374 2073 697a  - The effect siz
+00024e30: 6520 2872 2920 6d65 6173 7572 6573 2074  e (r) measures t
+00024e40: 6865 2073 7472 656e 6774 6820 6f66 2061  he strength of a
+00024e50: 7373 6f63 6961 7469 6f6e 2062 6574 7765  ssociation betwe
+00024e60: 656e 2074 6865 2076 6172 6961 626c 6573  en the variables
+00024e70: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00024e80: 2020 2020 2020 2064 6174 6120 3d20 6e70         data = np
+00024e90: 2e68 7374 6163 6b28 2878 2e72 6573 6861  .hstack((x.resha
+00024ea0: 7065 282d 312c 2031 292c 2079 2e72 6573  pe(-1, 1), y.res
+00024eb0: 6861 7065 282d 312c 2031 2929 290a 2020  hape(-1, 1))).  
+00024ec0: 2020 2020 2020 6e20 3d20 6461 7461 2e73        n = data.s
+00024ed0: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
+00024ee0: 6469 6666 203d 206e 702e 6469 6666 2864  diff = np.diff(d
+00024ef0: 6174 6129 2e66 6c61 7474 656e 2829 0a20  ata).flatten(). 
+00024f00: 2020 2020 2020 2064 6966 665f 6162 7320         diff_abs 
+00024f10: 3d20 6e70 2e61 6273 2864 6966 6629 0a20  = np.abs(diff). 
+00024f20: 2020 2020 2020 2072 616e 6b5f 775f 7469         rank_w_ti
+00024f30: 6573 203d 2066 6173 745f 6d65 616e 5f72  es = fast_mean_r
+00024f40: 616e 6b28 6461 7461 3d64 6966 665f 6162  ank(data=diff_ab
+00024f50: 732c 2064 6573 6365 6e64 696e 673d 4661  s, descending=Fa
+00024f60: 6c73 6529 0a20 2020 2020 2020 2073 6967  lse).        sig
+00024f70: 6e65 645f 7261 6e6b 5f77 5f74 6965 7320  ned_rank_w_ties 
+00024f80: 3d20 6e70 2e66 756c 6c28 2872 616e 6b5f  = np.full((rank_
+00024f90: 775f 7469 6573 2e73 6861 7065 5b30 5d29  w_ties.shape[0])
+00024fa0: 2c20 6e70 2e6e 616e 290a 2020 2020 2020  , np.nan).      
+00024fb0: 2020 745f 706c 7573 2c20 745f 6d69 6e75    t_plus, t_minu
+00024fc0: 7320 3d20 302c 2030 0a0a 2020 2020 2020  s = 0, 0..      
+00024fd0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00024fe0: 2864 6966 662e 7368 6170 655b 305d 293a  (diff.shape[0]):
+00024ff0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00025000: 6469 6666 5b69 5d20 3c20 303a 0a20 2020  diff[i] < 0:.   
+00025010: 2020 2020 2020 2020 2020 2020 2073 6967               sig
+00025020: 6e65 645f 7261 6e6b 5f77 5f74 6965 735b  ned_rank_w_ties[
+00025030: 695d 203d 202d 7261 6e6b 5f77 5f74 6965  i] = -rank_w_tie
+00025040: 735b 695d 0a20 2020 2020 2020 2020 2020  s[i].           
+00025050: 2020 2020 2074 5f6d 696e 7573 202b 3d20       t_minus += 
+00025060: 6e70 2e61 6273 2872 616e 6b5f 775f 7469  np.abs(rank_w_ti
+00025070: 6573 5b69 5d29 0a20 2020 2020 2020 2020  es[i]).         
+00025080: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00025090: 2020 2020 2020 2020 2073 6967 6e65 645f           signed_
+000250a0: 7261 6e6b 5f77 5f74 6965 735b 695d 203d  rank_w_ties[i] =
+000250b0: 2072 616e 6b5f 775f 7469 6573 5b69 5d0a   rank_w_ties[i].
+000250c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000250d0: 745f 706c 7573 202b 3d20 6e70 2e61 6273  t_plus += np.abs
+000250e0: 2872 616e 6b5f 775f 7469 6573 5b69 5d29  (rank_w_ties[i])
+000250f0: 0a20 2020 2020 2020 2075 5f77 203d 2028  .        u_w = (
+00025100: 6e20 2a20 286e 202b 2031 2929 202f 2034  n * (n + 1)) / 4
+00025110: 0a20 2020 2020 2020 2073 7464 5f63 6f72  .        std_cor
+00025120: 7265 6374 696f 6e20 3d20 300a 2020 2020  rection = 0.    
+00025130: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00025140: 6765 2873 6967 6e65 645f 7261 6e6b 5f77  ge(signed_rank_w
+00025150: 5f74 6965 732e 7368 6170 655b 305d 293a  _ties.shape[0]):
+00025160: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+00025170: 655f 7261 6e6b 5f6e 203d 2028 0a20 2020  e_rank_n = (.   
+00025180: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+00025190: 6172 6777 6865 7265 2873 6967 6e65 645f  argwhere(signed_
+000251a0: 7261 6e6b 5f77 5f74 6965 7320 3d3d 2073  rank_w_ties == s
+000251b0: 6967 6e65 645f 7261 6e6b 5f77 5f74 6965  igned_rank_w_tie
+000251c0: 735b 695d 290a 2020 2020 2020 2020 2020  s[i]).          
+000251d0: 2020 2020 2020 2e66 6c61 7474 656e 2829        .flatten()
+000251e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000251f0: 202e 7368 6170 655b 305d 0a20 2020 2020   .shape[0].     
+00025200: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00025210: 2020 2020 2069 6620 7361 6d65 5f72 616e       if same_ran
+00025220: 6b5f 6e20 3e20 313a 0a20 2020 2020 2020  k_n > 1:.       
+00025230: 2020 2020 2020 2020 2073 7464 5f63 6f72           std_cor
+00025240: 7265 6374 696f 6e20 2b3d 2028 2873 616d  rection += ((sam
+00025250: 655f 7261 6e6b 5f6e 2a2a 3329 202d 2073  e_rank_n**3) - s
+00025260: 616d 655f 7261 6e6b 5f6e 2920 2f20 320a  ame_rank_n) / 2.
+00025270: 0a20 2020 2020 2020 2073 7464 203d 206e  .        std = n
+00025280: 702e 7371 7274 2828 286e 202a 2028 6e20  p.sqrt(((n * (n 
+00025290: 2b20 3129 2920 2a20 2828 3220 2a20 6e29  + 1)) * ((2 * n)
+000252a0: 202b 2031 2920 2d20 7374 645f 636f 7272   + 1) - std_corr
+000252b0: 6563 7469 6f6e 2920 2f20 3234 290a 2020  ection) / 24).  
+000252c0: 2020 2020 2020 5720 3d20 6e70 2e6d 696e        W = np.min
+000252d0: 2828 745f 706c 7573 2c20 745f 6d69 6e75  ((t_plus, t_minu
+000252e0: 7329 290a 2020 2020 2020 2020 7a20 3d20  s)).        z = 
+000252f0: 2857 202d 2075 5f77 2920 2f20 7374 640a  (W - u_w) / std.
+00025300: 2020 2020 2020 2020 7220 3d20 7a20 2f20          r = z / 
+00025310: 6e70 2e73 7172 7428 6e29 0a20 2020 2020  np.sqrt(n).     
+00025320: 2020 2072 6574 7572 6e20 7a2c 2072 0a0a     return z, r..
+00025330: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00025340: 640a 2020 2020 406e 6a69 7428 0a20 2020  d.    @njit(.   
+00025350: 2020 2020 2022 2866 6c6f 6174 3332 5b3a       "(float32[:
+00025360: 2c3a 5d2c 2029 222c 0a20 2020 2029 0a20  ,:], )",.    ). 
+00025370: 2020 2064 6566 2063 6f76 5f6d 6174 7269     def cov_matri
+00025380: 7828 6461 7461 3a20 6e70 2e6e 6461 7272  x(data: np.ndarr
+00025390: 6179 293a 0a20 2020 2020 2020 2022 2222  ay):.        """
+000253a0: 0a20 2020 2020 2020 204a 6974 7465 6420  .        Jitted 
+000253b0: 6865 6c70 6572 2074 6f20 636f 6d70 7574  helper to comput
+000253c0: 6520 7468 6520 636f 7661 7269 616e 6365  e the covariance
+000253d0: 206d 6174 7269 7820 6f66 2074 6865 2069   matrix of the i
+000253e0: 6e70 7574 2064 6174 612e 2048 656c 7065  nput data. Helpe
+000253f0: 7220 666f 7220 636f 6d70 7574 696e 6720  r for computing 
+00025400: 6372 6f6e 6261 6368 2061 6c70 6861 2c0a  cronbach alpha,.
+00025410: 2020 2020 2020 2020 6d75 6c74 6976 6172          multivar
+00025420: 6961 7465 2061 6e61 6c79 7369 732c 2061  iate analysis, a
+00025430: 6e64 2064 6973 7461 6e63 6520 636f 6d70  nd distance comp
+00025440: 7574 6174 696f 6e73 2e0a 0a20 2020 2020  utations...     
+00025450: 2020 203a 7061 7261 6d20 6e70 2e6e 6461     :param np.nda
+00025460: 7272 6179 2064 6174 613a 2032 2d64 696d  rray data: 2-dim
+00025470: 656e 7369 6f6e 616c 206e 756d 7079 2061  ensional numpy a
+00025480: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+00025490: 6720 7468 6520 696e 7075 7420 6461 7461  g the input data
+000254a0: 2077 6974 6820 7368 6170 6520 286e 2c20   with shape (n, 
+000254b0: 6d29 2c20 7768 6572 6520 6e20 6973 2074  m), where n is t
+000254c0: 6865 206e 756d 6265 7220 6f66 206f 6273  he number of obs
+000254d0: 6572 7661 7469 6f6e 7320 616e 6420 6d20  ervations and m 
+000254e0: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+000254f0: 2066 6561 7475 7265 732e 0a20 2020 2020   features..     
+00025500: 2020 203a 7265 7475 726e 3a20 436f 7661     :return: Cova
+00025510: 7269 616e 6365 206d 6174 7269 7820 6f66  riance matrix of
+00025520: 2074 6865 2069 6e70 7574 2064 6174 6120   the input data 
+00025530: 7769 7468 2073 6861 7065 2028 6d2c 206d  with shape (m, m
+00025540: 292e 2054 6865 2028 692c 206a 292d 7468  ). The (i, j)-th
+00025550: 2065 6c65 6d65 6e74 206f 6620 7468 6520   element of the 
+00025560: 6d61 7472 6978 2072 6570 7265 7365 6e74  matrix represent
+00025570: 7320 7468 6520 636f 7661 7269 616e 6365  s the covariance
+00025580: 2062 6574 7765 656e 2074 6865 2069 2d74   between the i-t
+00025590: 6820 616e 6420 6a2d 7468 2066 6561 7475  h and j-th featu
+000255a0: 7265 7320 696e 2074 6865 2064 6174 612e  res in the data.
+000255b0: 0a0a 2020 2020 2020 2020 3a65 7861 6d70  ..        :examp
+000255c0: 6c65 3a0a 2020 2020 2020 2020 3e3e 3e20  le:.        >>> 
+000255d0: 6461 7461 203d 206e 702e 7261 6e64 6f6d  data = np.random
+000255e0: 2e72 616e 6469 6e74 2830 2c32 2c20 2832  .randint(0,2, (2
+000255f0: 3030 2c20 3430 2929 2e61 7374 7970 6528  00, 40)).astype(
+00025600: 6e70 2e66 6c6f 6174 3332 290a 2020 2020  np.float32).    
+00025610: 2020 2020 3e3e 3e20 636f 7661 7269 616e      >>> covarian
+00025620: 6365 5f6d 6174 7269 7820 3d20 5374 6174  ce_matrix = Stat
+00025630: 6973 7469 6373 2e63 6f76 5f6d 6174 7269  istics.cov_matri
+00025640: 7828 6461 7461 3d64 6174 6129 0a20 2020  x(data=data).   
+00025650: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00025660: 206e 2c20 6d20 3d20 6461 7461 2e73 6861   n, m = data.sha
+00025670: 7065 0a20 2020 2020 2020 2063 6f76 203d  pe.        cov =
+00025680: 206e 702e 6675 6c6c 2828 6d2c 206d 292c   np.full((m, m),
+00025690: 2030 2e30 290a 2020 2020 2020 2020 666f   0.0).        fo
+000256a0: 7220 6920 696e 2070 7261 6e67 6528 6d29  r i in prange(m)
+000256b0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+000256c0: 616e 5f69 203d 206e 702e 7375 6d28 6461  an_i = np.sum(da
+000256d0: 7461 5b3a 2c20 695d 2920 2f20 6e0a 2020  ta[:, i]) / n.  
+000256e0: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
+000256f0: 696e 2072 616e 6765 286d 293a 0a20 2020  in range(m):.   
+00025700: 2020 2020 2020 2020 2020 2020 206d 6561               mea
+00025710: 6e5f 6a20 3d20 6e70 2e73 756d 2864 6174  n_j = np.sum(dat
+00025720: 615b 3a2c 206a 5d29 202f 206e 0a20 2020  a[:, j]) / n.   
+00025730: 2020 2020 2020 2020 2020 2020 2063 6f76               cov
+00025740: 5b69 2c20 6a5d 203d 206e 702e 7375 6d28  [i, j] = np.sum(
+00025750: 2864 6174 615b 3a2c 2069 5d20 2d20 6d65  (data[:, i] - me
+00025760: 616e 5f69 2920 2a20 2864 6174 615b 3a2c  an_i) * (data[:,
+00025770: 206a 5d20 2d20 6d65 616e 5f6a 2929 202f   j] - mean_j)) /
+00025780: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00025790: 2020 2020 2020 206e 202d 2031 0a20 2020         n - 1.   
+000257a0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000257b0: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+000257c0: 760a 0a20 2020 2040 7374 6174 6963 6d65  v..    @staticme
+000257d0: 7468 6f64 0a20 2020 2040 6e6a 6974 2822  thod.    @njit("
+000257e0: 2866 6c6f 6174 3332 5b3a 5d2c 2069 6e74  (float32[:], int
+000257f0: 3634 2c29 2229 0a20 2020 2064 6566 206d  64,)").    def m
+00025800: 6164 5f6d 6564 6961 6e5f 7275 6c65 2864  ad_median_rule(d
+00025810: 6174 613a 206e 702e 6e64 6172 7261 792c  ata: np.ndarray,
+00025820: 206b 3a20 696e 7429 202d 3e20 6e70 2e6e   k: int) -> np.n
+00025830: 6461 7272 6179 3a0a 2020 2020 2020 2020  darray:.        
+00025840: 2222 220a 2020 2020 2020 2020 4465 7465  """.        Dete
+00025850: 6374 206f 7574 6c69 6572 7320 7573 696e  ct outliers usin
+00025860: 6720 7468 6520 4d41 442d 4d65 6469 616e  g the MAD-Median
+00025870: 2052 756c 652e 2052 6574 7572 6e73 2031   Rule. Returns 1
+00025880: 6420 6172 7261 7920 6f66 2073 697a 6520  d array of size 
+00025890: 6461 7461 2e73 6861 7065 5b30 5d20 7769  data.shape[0] wi
+000258a0: 7468 2031 2072 6570 7265 7365 6e74 696e  th 1 representin
+000258b0: 6720 6f75 746c 6965 7220 616e 6420 3020  g outlier and 0 
+000258c0: 7265 7072 6573 656e 7469 6e67 2069 6e6c  representing inl
+000258d0: 6965 722e 0a0a 2020 2020 2020 2020 3a65  ier...        :e
+000258e0: 7861 6d70 6c65 3a0a 2020 2020 2020 2020  xample:.        
+000258f0: 3e3e 3e20 6461 7461 203d 206e 702e 7261  >>> data = np.ra
+00025900: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
+00025910: 3630 302c 2028 3930 3030 3030 302c 2929  600, (9000000,))
+00025920: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00025930: 3332 290a 2020 2020 2020 2020 3e3e 3e20  32).        >>> 
+00025940: 5374 6174 6973 7469 6373 2e6d 6164 5f6d  Statistics.mad_m
+00025950: 6564 6961 6e5f 7275 6c65 2864 6174 613d  edian_rule(data=
+00025960: 6461 7461 2c20 6b3d 3129 0a20 2020 2020  data, k=1).     
+00025970: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00025980: 6d65 6469 616e 203d 206e 702e 6d65 6469  median = np.medi
+00025990: 616e 2864 6174 6129 0a20 2020 2020 2020  an(data).       
+000259a0: 206d 6164 203d 206e 702e 6d65 6469 616e   mad = np.median
+000259b0: 286e 702e 6162 7328 6461 7461 202d 206d  (np.abs(data - m
+000259c0: 6564 6961 6e29 290a 2020 2020 2020 2020  edian)).        
+000259d0: 7468 7265 7368 6f6c 6420 3d20 6b20 2a20  threshold = k * 
+000259e0: 6d61 640a 2020 2020 2020 2020 6f75 746c  mad.        outl
+000259f0: 6965 7273 203d 206e 702e 6162 7328 6461  iers = np.abs(da
+00025a00: 7461 202d 206d 6564 6961 6e29 203e 2074  ta - median) > t
+00025a10: 6872 6573 686f 6c64 0a20 2020 2020 2020  hreshold.       
+00025a20: 2072 6574 7572 6e20 6f75 746c 6965 7273   return outliers
+00025a30: 202a 2031 0a0a 2020 2020 4073 7461 7469   * 1..    @stati
+00025a40: 636d 6574 686f 640a 2020 2020 406e 6a69  cmethod.    @nji
+00025a50: 7428 2228 666c 6f61 7433 325b 3a5d 2c20  t("(float32[:], 
+00025a60: 696e 7436 342c 2066 6c6f 6174 3634 5b3a  int64, float64[:
+00025a70: 5d2c 2066 6c6f 6174 3634 2922 290a 2020  ], float64)").  
+00025a80: 2020 6465 6620 736c 6964 696e 675f 6d61    def sliding_ma
+00025a90: 645f 6d65 6469 616e 5f72 756c 6528 0a20  d_median_rule(. 
+00025aa0: 2020 2020 2020 2064 6174 613a 206e 702e         data: np.
+00025ab0: 6e64 6172 7261 792c 206b 3a20 696e 742c  ndarray, k: int,
+00025ac0: 2074 696d 655f 7769 6e64 6f77 733a 206e   time_windows: n
+00025ad0: 702e 6e64 6172 7261 792c 2066 7073 3a20  p.ndarray, fps: 
+00025ae0: 666c 6f61 740a 2020 2020 2920 2d3e 206e  float.    ) -> n
+00025af0: 702e 6e64 6172 7261 793a 0a20 2020 2020  p.ndarray:.     
+00025b00: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
+00025b10: 6f75 6e74 2074 6865 206e 756d 6265 7220  ount the number 
+00025b20: 6f66 206f 7574 6c69 6572 7320 696e 2061  of outliers in a
+00025b30: 2073 6c69 6469 6e67 2074 696d 652d 7769   sliding time-wi
+00025b40: 6e64 6f77 2075 7369 6e67 2074 6865 204d  ndow using the M
+00025b50: 4144 2d4d 6564 6961 6e20 5275 6c65 2e0a  AD-Median Rule..
+00025b60: 0a20 2020 2020 2020 2054 6865 204d 4144  .        The MAD
+00025b70: 2d4d 6564 6961 6e20 5275 6c65 2069 7320  -Median Rule is 
+00025b80: 6120 726f 6275 7374 206d 6574 686f 6420  a robust method 
+00025b90: 666f 7220 6f75 746c 6965 7220 6465 7465  for outlier dete
+00025ba0: 6374 696f 6e2e 2049 7420 6361 6c63 756c  ction. It calcul
+00025bb0: 6174 6573 2074 6865 206d 6564 6961 6e20  ates the median 
+00025bc0: 6162 736f 6c75 7465 2064 6576 6961 7469  absolute deviati
+00025bd0: 6f6e 2028 4d41 4429 0a20 2020 2020 2020  on (MAD).       
+00025be0: 2061 6e64 2075 7365 7320 6974 2074 6f20   and uses it to 
+00025bf0: 6964 656e 7469 6679 206f 7574 6c69 6572  identify outlier
+00025c00: 7320 6261 7365 6420 6f6e 2061 2074 6872  s based on a thr
+00025c10: 6573 686f 6c64 2064 6566 696e 6564 2061  eshold defined a
+00025c20: 7320 6b20 7469 6d65 7320 7468 6520 4d41  s k times the MA
+00025c30: 442e 0a0a 2020 2020 2020 2020 3a70 6172  D...        :par
+00025c40: 616d 206e 702e 6e64 6172 7261 7920 6461  am np.ndarray da
+00025c50: 7461 3a20 3144 206e 756d 6572 6963 616c  ta: 1D numerical
+00025c60: 2061 7272 6179 2072 6570 7265 7365 6e74   array represent
+00025c70: 696e 6720 6665 6174 7572 652e 0a20 2020  ing feature..   
+00025c80: 2020 2020 203a 7061 7261 6d20 696e 7420       :param int 
+00025c90: 6b3a 2054 6865 206f 7574 6c69 6572 2074  k: The outlier t
+00025ca0: 6872 6573 686f 6c64 2064 6566 696e 6564  hreshold defined
+00025cb0: 2061 7320 6b20 2a20 6d65 6469 616e 2061   as k * median a
+00025cc0: 6273 6f6c 7574 6520 6465 7669 6174 696f  bsolute deviatio
+00025cd0: 6e20 696e 2065 6163 6820 7469 6d65 2077  n in each time w
+00025ce0: 696e 646f 772e 0a20 2020 2020 2020 203a  indow..        :
+00025cf0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+00025d00: 2074 696d 655f 7769 6e64 6f77 733a 2031   time_windows: 1
+00025d10: 4420 6172 7261 7920 6f66 2074 696d 6520  D array of time 
+00025d20: 7769 6e64 6f77 2073 697a 6573 2069 6e20  window sizes in 
+00025d30: 7365 636f 6e64 732e 0a20 2020 2020 2020  seconds..       
+00025d40: 203a 7061 7261 6d20 666c 6f61 7420 6670   :param float fp
+00025d50: 733a 2054 6865 2066 7265 7175 656e 6379  s: The frequency
+00025d60: 206f 6620 7468 6520 7369 676e 616c 2e0a   of the signal..
+00025d70: 2020 2020 2020 2020 3a72 6574 7572 6e20          :return 
+00025d80: 6e70 2e6e 6461 7272 6179 3a20 4172 7261  np.ndarray: Arra
+00025d90: 7920 6f66 2073 697a 6520 2864 6174 612e  y of size (data.
+00025da0: 7368 6170 655b 305d 2c20 7469 6d65 5f77  shape[0], time_w
+00025db0: 696e 646f 7773 2e73 6861 7065 5b30 5d29  indows.shape[0])
+00025dc0: 2077 6974 6820 636f 756e 7473 2069 6620   with counts if 
+00025dd0: 6f75 746c 6965 7273 2064 6574 6563 7465  outliers detecte
+00025de0: 642e 0a0a 2020 2020 2020 2020 3a65 7861  d...        :exa
+00025df0: 6d70 6c65 3a0a 2020 2020 2020 2020 3e3e  mple:.        >>
+00025e00: 3e20 6461 7461 203d 206e 702e 7261 6e64  > data = np.rand
+00025e10: 6f6d 2e72 616e 6469 6e74 2830 2c20 3530  om.randint(0, 50
+00025e20: 2c20 2835 3030 3030 2c29 292e 6173 7479  , (50000,)).asty
+00025e30: 7065 286e 702e 666c 6f61 7433 3229 0a20  pe(np.float32). 
+00025e40: 2020 2020 2020 203e 3e3e 2053 7461 7469         >>> Stati
+00025e50: 7374 6963 732e 736c 6964 696e 675f 6d61  stics.sliding_ma
+00025e60: 645f 6d65 6469 616e 5f72 756c 6528 6461  d_median_rule(da
+00025e70: 7461 3d64 6174 612c 206b 3d32 2c20 7469  ta=data, k=2, ti
+00025e80: 6d65 5f77 696e 646f 7773 3d6e 702e 6172  me_windows=np.ar
+00025e90: 7261 7928 5b32 302e 305d 292c 2066 7073  ray([20.0]), fps
+00025ea0: 3d31 2e30 290a 2020 2020 2020 2020 2222  =1.0).        ""
+00025eb0: 220a 2020 2020 2020 2020 7265 7375 6c74  ".        result
+00025ec0: 7320 3d20 6e70 2e66 756c 6c28 2864 6174  s = np.full((dat
+00025ed0: 612e 7368 6170 655b 305d 2c20 7469 6d65  a.shape[0], time
+00025ee0: 5f77 696e 646f 7773 2e73 6861 7065 5b30  _windows.shape[0
+00025ef0: 5d29 2c20 2d31 290a 2020 2020 2020 2020  ]), -1).        
+00025f00: 666f 7220 7469 6d65 5f77 696e 646f 7720  for time_window 
+00025f10: 696e 2074 696d 655f 7769 6e64 6f77 733a  in time_windows:
+00025f20: 0a20 2020 2020 2020 2020 2020 2077 203d  .            w =
+00025f30: 2069 6e74 2866 7073 202a 2074 696d 655f   int(fps * time_
+00025f40: 7769 6e64 6f77 290a 2020 2020 2020 2020  window).        
+00025f50: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00025f60: 6765 2877 2c20 6461 7461 2e73 6861 7065  ge(w, data.shape
+00025f70: 5b30 5d20 2b20 312c 2031 293a 0a20 2020  [0] + 1, 1):.   
+00025f80: 2020 2020 2020 2020 2020 2020 2077 5f64               w_d
+00025f90: 6174 6120 3d20 6461 7461 5b69 202d 2077  ata = data[i - w
+00025fa0: 203a 2069 5d0a 2020 2020 2020 2020 2020   : i].          
+00025fb0: 2020 2020 2020 6d65 6469 616e 203d 206e        median = n
+00025fc0: 702e 6d65 6469 616e 2877 5f64 6174 6129  p.median(w_data)
+00025fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025fe0: 206d 6164 203d 206e 702e 6d65 6469 616e   mad = np.median
+00025ff0: 286e 702e 6162 7328 775f 6461 7461 202d  (np.abs(w_data -
+00026000: 206d 6564 6961 6e29 290a 2020 2020 2020   median)).      
+00026010: 2020 2020 2020 2020 2020 7468 7265 7368            thresh
+00026020: 6f6c 6420 3d20 6b20 2a20 6d61 640a 2020  old = k * mad.  
+00026030: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
+00026040: 746c 6965 7273 203d 206e 702e 6162 7328  tliers = np.abs(
+00026050: 775f 6461 7461 202d 206d 6564 6961 6e29  w_data - median)
+00026060: 203e 2074 6872 6573 686f 6c64 0a20 2020   > threshold.   
+00026070: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00026080: 756c 7473 5b69 202d 2031 5d20 3d20 6e70  ults[i - 1] = np
+00026090: 2e73 756d 286f 7574 6c69 6572 7320 2a20  .sum(outliers * 
+000260a0: 3129 0a20 2020 2020 2020 2072 6574 7572  1).        retur
+000260b0: 6e20 7265 7375 6c74 730a 0a20 2020 2040  n results..    @
+000260c0: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+000260d0: 2064 6566 2064 756e 6e5f 696e 6465 7828   def dunn_index(
+000260e0: 783a 206e 702e 6e64 6172 7261 792c 2079  x: np.ndarray, y
+000260f0: 3a20 6e70 2e6e 6461 7272 6179 2920 2d3e  : np.ndarray) ->
+00026100: 2066 6c6f 6174 3a0a 2020 2020 2020 2020   float:.        
+00026110: 2222 220a 2020 2020 2020 2020 4361 6c63  """.        Calc
+00026120: 756c 6174 6520 7468 6520 4475 6e6e 2069  ulate the Dunn i
+00026130: 6e64 6578 2074 6f20 6576 616c 7561 7465  ndex to evaluate
+00026140: 2074 6865 2071 7561 6c69 7479 206f 6620   the quality of 
+00026150: 636c 7573 7465 7265 6420 6c61 6265 6c73  clustered labels
+00026160: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
+00026170: 6675 6e63 7469 6f6e 2063 616c 6375 6c61  function calcula
+00026180: 7465 7320 7468 6520 4475 6e6e 2069 6e64  tes the Dunn ind
+00026190: 6578 2c20 7768 6963 6820 6973 2061 206d  ex, which is a m
+000261a0: 6561 7375 7265 206f 6620 636c 7573 7465  easure of cluste
+000261b0: 7269 6e67 2071 7561 6c69 7479 2e0a 2020  ring quality..  
+000261c0: 2020 2020 2020 5468 6520 696e 6465 7820        The index 
+000261d0: 636f 6e73 6964 6572 7320 7468 6520 7261  considers the ra
+000261e0: 7469 6f20 6f66 2074 6865 206d 696e 696d  tio of the minim
+000261f0: 756d 2069 6e74 6572 2d63 6c75 7374 6572  um inter-cluster
+00026200: 2064 6973 7461 6e63 6520 746f 2074 6865   distance to the
+00026210: 206d 6178 696d 756d 0a20 2020 2020 2020   maximum.       
+00026220: 2069 6e74 7261 2d63 6c75 7374 6572 2064   intra-cluster d
+00026230: 6973 7461 6e63 652e 2041 2068 6967 6865  istance. A highe
+00026240: 7220 4475 6e6e 2069 6e64 6578 2069 6e64  r Dunn index ind
+00026250: 6963 6174 6573 2062 6574 7465 7220 636c  icates better cl
+00026260: 7573 7465 7269 6e67 2e0a 0a20 2020 2020  ustering...     
+00026270: 2020 202e 2e20 6e6f 7465 3a3a 0a20 2020     .. note::.   
+00026280: 2020 2020 2020 2020 4d6f 6469 6669 6564          Modified
+00026290: 2066 726f 6d20 606a 716d 7669 6567 6173   from `jqmviegas
+000262a0: 203c 6874 7470 733a 2f2f 6769 7468 7562   <https://github
+000262b0: 2e63 6f6d 2f6a 716d 7669 6567 6173 2f6a  .com/jqmviegas/j
+000262c0: 716d 5f63 7669 2f3e 605f 0a0a 2020 2020  qm_cvi/>`_..    
+000262d0: 2020 2020 2020 2057 696b 6920 6068 7474         Wiki `htt
+000262e0: 7073 3a2f 2f65 6e2e 7769 6b69 7065 6469  ps://en.wikipedi
+000262f0: 612e 6f72 672f 7769 6b69 2f44 756e 6e5f  a.org/wiki/Dunn_
+00026300: 696e 6465 7820 3c68 7474 7073 3a2f 2f65  index <https://e
+00026310: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+00026320: 7769 6b69 2f44 756e 6e5f 696e 6465 783e  wiki/Dunn_index>
+00026330: 605f 0a0a 2020 2020 2020 2020 2020 2055  `_..           U
+00026340: 7365 7320 4575 636c 6964 6561 6e20 6469  ses Euclidean di
+00026350: 7374 616e 6365 732e 0a0a 2020 2020 2020  stances...      
+00026360: 2020 3a70 6172 616d 206e 702e 6e64 6172    :param np.ndar
+00026370: 7261 7920 783a 2032 4420 6172 7261 7920  ray x: 2D array 
+00026380: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+00026390: 2064 6174 6120 706f 696e 7473 2e20 5368   data points. Sh
+000263a0: 6170 6520 286e 5f73 616d 706c 6573 2c20  ape (n_samples, 
+000263b0: 6e5f 6665 6174 7572 6573 292e 0a20 2020  n_features)..   
+000263c0: 2020 2020 203a 7061 7261 6d20 6e70 2e6e       :param np.n
+000263d0: 6461 7272 6179 2079 3a20 3244 2061 7272  darray y: 2D arr
+000263e0: 6179 2072 6570 7265 7365 6e74 696e 6720  ay representing 
+000263f0: 636c 7573 7465 7220 6c61 6265 6c73 2066  cluster labels f
+00026400: 6f72 2065 6163 6820 6461 7461 2070 6f69  or each data poi
+00026410: 6e74 2e20 5368 6170 6520 286e 5f73 616d  nt. Shape (n_sam
+00026420: 706c 6573 2c29 2e0a 2020 2020 2020 2020  ples,)..        
+00026430: 3a72 6574 7572 6e20 666c 6f61 743a 2054  :return float: T
+00026440: 6865 2044 756e 6e20 696e 6465 7820 7661  he Dunn index va
+00026450: 6c75 650a 0a20 2020 2020 2020 203a 6578  lue..        :ex
+00026460: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00026470: 3e3e 2078 203d 206e 702e 7261 6e64 6f6d  >> x = np.random
+00026480: 2e72 616e 6469 6e74 2830 2c20 3130 302c  .randint(0, 100,
+00026490: 2028 3130 302c 2032 2929 0a20 2020 2020   (100, 2)).     
+000264a0: 2020 203e 3e3e 2079 203d 206e 702e 7261     >>> y = np.ra
+000264b0: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
+000264c0: 332c 2028 3130 302c 2929 0a20 2020 2020  3, (100,)).     
+000264d0: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+000264e0: 732e 6475 6e6e 5f69 6e64 6578 2878 3d78  s.dunn_index(x=x
+000264f0: 2c20 793d 7929 0a20 2020 2020 2020 2022  , y=y).        "
+00026500: 2222 0a0a 2020 2020 2020 2020 6368 6563  ""..        chec
+00026510: 6b5f 7661 6c69 645f 6172 7261 7928 0a20  k_valid_array(. 
+00026520: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+00026530: 782c 0a20 2020 2020 2020 2020 2020 2073  x,.            s
+00026540: 6f75 7263 653d 5374 6174 6973 7469 6373  ource=Statistics
+00026550: 2e64 756e 6e5f 696e 6465 782e 5f5f 6e61  .dunn_index.__na
+00026560: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00026570: 2020 6163 6365 7074 6564 5f6e 6469 6d73    accepted_ndims
+00026580: 3d28 322c 292c 0a20 2020 2020 2020 2020  =(2,),.         
+00026590: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+000265a0: 6573 3d28 696e 742c 2066 6c6f 6174 2c20  es=(int, float, 
+000265b0: 6e70 2e66 6c6f 6174 3634 2c20 6e70 2e66  np.float64, np.f
+000265c0: 6c6f 6174 3332 2c20 6e70 2e69 6e74 3634  loat32, np.int64
+000265d0: 2c20 6e70 2e69 6e74 3332 292c 0a20 2020  , np.int32),.   
+000265e0: 2020 2020 2029 0a20 2020 2020 2020 2063       ).        c
+000265f0: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+00026600: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+00026610: 7461 3d79 2c0a 2020 2020 2020 2020 2020  ta=y,.          
+00026620: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
+00026630: 6963 732e 6475 6e6e 5f69 6e64 6578 2e5f  ics.dunn_index._
+00026640: 5f6e 616d 655f 5f2c 0a20 2020 2020 2020  _name__,.       
+00026650: 2020 2020 2061 6363 6570 7465 645f 6e64       accepted_nd
+00026660: 696d 733d 2831 2c29 2c0a 2020 2020 2020  ims=(1,),.      
+00026670: 2020 2020 2020 6163 6365 7074 6564 5f73        accepted_s
+00026680: 6861 7065 733d 5b28 782e 7368 6170 655b  hapes=[(x.shape[
+00026690: 305d 2c29 5d2c 0a20 2020 2020 2020 2020  0],)],.         
+000266a0: 2020 2061 6363 6570 7465 645f 6474 7970     accepted_dtyp
+000266b0: 6573 3d28 696e 742c 2066 6c6f 6174 2c20  es=(int, float, 
+000266c0: 6e70 2e66 6c6f 6174 3634 2c20 6e70 2e66  np.float64, np.f
+000266d0: 6c6f 6174 3332 2c20 6e70 2e69 6e74 3634  loat32, np.int64
+000266e0: 2c20 6e70 2e69 6e74 3332 292c 0a20 2020  , np.int32),.   
+000266f0: 2020 2020 2029 0a20 2020 2020 2020 2064       ).        d
+00026700: 6973 7461 6e63 6573 203d 2046 6561 7475  istances = Featu
+00026710: 7265 4578 7472 6163 7469 6f6e 4d69 7869  reExtractionMixi
+00026720: 6e2e 6364 6973 7428 0a20 2020 2020 2020  n.cdist(.       
+00026730: 2020 2020 2061 7272 6179 5f31 3d78 2e61       array_1=x.a
+00026740: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+00026750: 292c 2061 7272 6179 5f32 3d78 2e61 7374  ), array_2=x.ast
+00026760: 7970 6528 6e70 2e66 6c6f 6174 3332 290a  ype(np.float32).
+00026770: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00026780: 2020 6b73 203d 206e 702e 736f 7274 286e    ks = np.sort(n
+00026790: 702e 756e 6971 7565 2879 2929 2e61 7374  p.unique(y)).ast
+000267a0: 7970 6528 6e70 2e69 6e74 3634 290a 2020  ype(np.int64).  
+000267b0: 2020 2020 2020 6465 6c74 6173 203d 206e        deltas = n
+000267c0: 702e 6675 6c6c 2828 6b73 2e73 6861 7065  p.full((ks.shape
+000267d0: 5b30 5d2c 206b 732e 7368 6170 655b 305d  [0], ks.shape[0]
+000267e0: 292c 206e 702e 696e 6629 0a20 2020 2020  ), np.inf).     
+000267f0: 2020 2062 6967 5f64 656c 7461 7320 3d20     big_deltas = 
+00026800: 6e70 2e7a 6572 6f73 285b 6b73 2e73 6861  np.zeros([ks.sha
+00026810: 7065 5b30 5d2c 2031 5d29 0a20 2020 2020  pe[0], 1]).     
+00026820: 2020 2066 6f72 2069 2c20 6c20 696e 206c     for i, l in l
+00026830: 6973 7428 7065 726d 7574 6174 696f 6e73  ist(permutations
+00026840: 286b 732c 2032 2929 3a0a 2020 2020 2020  (ks, 2)):.      
+00026850: 2020 2020 2020 7661 6c75 6573 203d 2064        values = d
+00026860: 6973 7461 6e63 6573 5b6e 702e 7768 6572  istances[np.wher
+00026870: 6528 2879 203d 3d20 6929 295d 5b3a 2c20  e((y == i))][:, 
+00026880: 6e70 2e77 6865 7265 2828 7920 3d3d 206c  np.where((y == l
+00026890: 2929 5d0a 2020 2020 2020 2020 2020 2020  ))].            
+000268a0: 6465 6c74 6173 5b69 2c20 6c5d 203d 206e  deltas[i, l] = n
+000268b0: 702e 6d69 6e28 7661 6c75 6573 5b6e 702e  p.min(values[np.
+000268c0: 6e6f 6e7a 6572 6f28 7661 6c75 6573 295d  nonzero(values)]
+000268d0: 290a 2020 2020 2020 2020 666f 7220 6b20  ).        for k 
+000268e0: 696e 206b 733a 0a20 2020 2020 2020 2020  in ks:.         
+000268f0: 2020 2076 616c 7565 7320 3d20 6469 7374     values = dist
+00026900: 616e 6365 735b 6e70 2e77 6865 7265 2828  ances[np.where((
+00026910: 7920 3d3d 206b 735b 6b5d 2929 5d5b 3a2c  y == ks[k]))][:,
+00026920: 206e 702e 7768 6572 6528 2879 203d 3d20   np.where((y == 
+00026930: 6b73 5b6b 5d29 295d 0a20 2020 2020 2020  ks[k]))].       
+00026940: 2020 2020 2062 6967 5f64 656c 7461 735b       big_deltas[
+00026950: 6b5d 203d 206e 702e 6d61 7828 7661 6c75  k] = np.max(valu
+00026960: 6573 290a 0a20 2020 2020 2020 2072 6574  es)..        ret
+00026970: 7572 6e20 6e70 2e6d 696e 2864 656c 7461  urn np.min(delta
+00026980: 7329 202f 206e 702e 6d61 7828 6269 675f  s) / np.max(big_
+00026990: 6465 6c74 6173 290a 0a20 2020 2064 6566  deltas)..    def
+000269a0: 2064 6176 6973 5f62 6f75 6c64 696e 2878   davis_bouldin(x
+000269b0: 3a20 6e70 2e6e 6461 7272 6179 2c20 793a  : np.ndarray, y:
+000269c0: 206e 702e 6e64 6172 7261 7929 202d 3e20   np.ndarray) -> 
+000269d0: 666c 6f61 743a 0a20 2020 2020 2020 2022  float:.        "
+000269e0: 2222 0a20 2020 2020 2020 2043 616c 6375  "".        Calcu
+000269f0: 6c61 7465 2074 6865 2044 6176 6973 2d42  late the Davis-B
+00026a00: 6f75 6c64 696e 2069 6e64 6578 2066 6f72  ouldin index for
+00026a10: 2065 7661 6c75 6174 696e 6720 636c 7573   evaluating clus
+00026a20: 7465 7269 6e67 2070 6572 666f 726d 616e  tering performan
+00026a30: 6365 2e0a 0a20 2020 2020 2020 2044 6176  ce...        Dav
+00026a40: 6973 2d42 6f75 6c64 696e 2069 6e64 6578  is-Bouldin index
+00026a50: 206d 6561 7375 7265 7320 7468 6520 636c   measures the cl
+00026a60: 7573 7465 7269 6e67 2071 7561 6c69 7479  ustering quality
+00026a70: 2062 6173 6564 206f 6e20 7468 6520 7769   based on the wi
+00026a80: 7468 696e 2d63 6c75 7374 6572 0a20 2020  thin-cluster.   
+00026a90: 2020 2020 2073 696d 696c 6172 6974 7920       similarity 
+00026aa0: 616e 6420 6265 7477 6565 6e2d 636c 7573  and between-clus
+00026ab0: 7465 7220 6469 7373 696d 696c 6172 6974  ter dissimilarit
+00026ac0: 792e 204c 6f77 6572 2076 616c 7565 7320  y. Lower values 
+00026ad0: 696e 6469 6361 7465 2062 6574 7465 7220  indicate better 
+00026ae0: 636c 7573 7465 7269 6e67 2e0a 0a20 2020  clustering...   
+00026af0: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a20       .. note::. 
+00026b00: 2020 2020 2020 2020 2020 4d6f 6469 6669            Modifi
+00026b10: 6564 2066 726f 6d20 6073 6369 6b69 742d  ed from `scikit-
+00026b20: 6c65 6172 6e20 3c68 7474 7073 3a2f 2f67  learn <https://g
+00026b30: 6974 6875 622e 636f 6d2f 7363 696b 6974  ithub.com/scikit
+00026b40: 2d6c 6561 726e 2f73 6369 6b69 742d 6c65  -learn/scikit-le
+00026b50: 6172 6e2f 626c 6f62 2f66 3037 6530 3133  arn/blob/f07e013
+00026b60: 3862 6665 6534 3163 6432 6330 6135 6430  8bfee41cd2c0a5d0
+00026b70: 3235 3164 6333 6665 3033 6536 6531 3038  251dc3fe03e6e108
+00026b80: 342f 736b 6c65 6172 6e2f 6d65 7472 6963  4/sklearn/metric
+00026b90: 732f 636c 7573 7465 722f 5f75 6e73 7570  s/cluster/_unsup
+00026ba0: 6572 7669 7365 642e 7079 234c 3339 303e  ervised.py#L390>
+00026bb0: 605f 0a0a 2020 2020 2020 2020 3a70 6172  `_..        :par
+00026bc0: 616d 206e 702e 6e64 6172 7261 7920 783a  am np.ndarray x:
+00026bd0: 2032 4420 6172 7261 7920 7265 7072 6573   2D array repres
+00026be0: 656e 7469 6e67 2074 6865 2064 6174 6120  enting the data 
+00026bf0: 706f 696e 7473 2e20 5368 6170 6520 286e  points. Shape (n
+00026c00: 5f73 616d 706c 6573 2c20 6e5f 6665 6174  _samples, n_feat
+00026c10: 7572 6573 2f6e 5f64 696d 656e 7369 6f6e  ures/n_dimension
+00026c20: 292e 0a20 2020 2020 2020 203a 7061 7261  )..        :para
+00026c30: 6d20 6e70 2e6e 6461 7272 6179 2079 3a20  m np.ndarray y: 
+00026c40: 3244 2061 7272 6179 2072 6570 7265 7365  2D array represe
+00026c50: 6e74 696e 6720 636c 7573 7465 7220 6c61  nting cluster la
+00026c60: 6265 6c73 2066 6f72 2065 6163 6820 6461  bels for each da
+00026c70: 7461 2070 6f69 6e74 2e20 5368 6170 6520  ta point. Shape 
+00026c80: 286e 5f73 616d 706c 6573 2c29 2e0a 2020  (n_samples,)..  
+00026c90: 2020 2020 2020 3a72 6574 7572 6e20 666c        :return fl
+00026ca0: 6f61 743a 2044 6176 6973 2d42 6f75 6c64  oat: Davis-Bould
+00026cb0: 696e 2073 636f 7265 2e0a 0a20 2020 2020  in score...     
+00026cc0: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
+00026cd0: 2020 2020 203e 3e3e 2078 203d 206e 702e       >>> x = np.
+00026ce0: 7261 6e64 6f6d 2e72 616e 6469 6e74 2830  random.randint(0
+00026cf0: 2c20 3130 302c 2028 3130 302c 2032 2929  , 100, (100, 2))
+00026d00: 0a20 2020 2020 2020 203e 3e3e 2079 203d  .        >>> y =
+00026d10: 206e 702e 7261 6e64 6f6d 2e72 616e 6469   np.random.randi
+00026d20: 6e74 2830 2c20 332c 2028 3130 302c 2929  nt(0, 3, (100,))
+00026d30: 0a20 2020 2020 2020 203e 3e3e 2053 7461  .        >>> Sta
+00026d40: 7469 7374 6963 732e 6461 7669 735f 626f  tistics.davis_bo
+00026d50: 756c 6469 6e28 783d 782c 2079 3d79 290a  uldin(x=x, y=y).
+00026d60: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00026d70: 2020 2020 2063 6865 636b 5f76 616c 6964       check_valid
+00026d80: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
+00026d90: 2020 2020 6461 7461 3d78 2c0a 2020 2020      data=x,.    
+00026da0: 2020 2020 2020 2020 736f 7572 6365 3d53          source=S
+00026db0: 7461 7469 7374 6963 732e 6461 7669 735f  tatistics.davis_
+00026dc0: 626f 756c 6469 6e2e 5f5f 6e61 6d65 5f5f  bouldin.__name__
+00026dd0: 2c0a 2020 2020 2020 2020 2020 2020 6163  ,.            ac
+00026de0: 6365 7074 6564 5f6e 6469 6d73 3d28 322c  cepted_ndims=(2,
+00026df0: 292c 0a20 2020 2020 2020 2020 2020 2061  ),.            a
+00026e00: 6363 6570 7465 645f 6474 7970 6573 3d28  ccepted_dtypes=(
+00026e10: 696e 742c 2066 6c6f 6174 2c20 6e70 2e66  int, float, np.f
+00026e20: 6c6f 6174 3634 2c20 6e70 2e66 6c6f 6174  loat64, np.float
+00026e30: 3332 2c20 6e70 2e69 6e74 3634 2c20 6e70  32, np.int64, np
+00026e40: 2e69 6e74 3332 292c 0a20 2020 2020 2020  .int32),.       
+00026e50: 2029 0a20 2020 2020 2020 2063 6865 636b   ).        check
+00026e60: 5f76 616c 6964 5f61 7272 6179 280a 2020  _valid_array(.  
+00026e70: 2020 2020 2020 2020 2020 6461 7461 3d79            data=y
+00026e80: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
+00026e90: 7572 6365 3d53 7461 7469 7374 6963 732e  urce=Statistics.
+00026ea0: 6461 7669 735f 626f 756c 6469 6e2e 5f5f  davis_bouldin.__
+00026eb0: 6e61 6d65 5f5f 2c0a 2020 2020 2020 2020  name__,.        
+00026ec0: 2020 2020 6163 6365 7074 6564 5f6e 6469      accepted_ndi
+00026ed0: 6d73 3d28 312c 292c 0a20 2020 2020 2020  ms=(1,),.       
+00026ee0: 2020 2020 2061 6363 6570 7465 645f 7368       accepted_sh
+00026ef0: 6170 6573 3d5b 2878 2e73 6861 7065 5b30  apes=[(x.shape[0
+00026f00: 5d2c 295d 2c0a 2020 2020 2020 2020 2020  ],)],.          
+00026f10: 2020 6163 6365 7074 6564 5f64 7479 7065    accepted_dtype
+00026f20: 733d 2869 6e74 2c20 666c 6f61 742c 206e  s=(int, float, n
+00026f30: 702e 666c 6f61 7436 342c 206e 702e 666c  p.float64, np.fl
+00026f40: 6f61 7433 322c 206e 702e 696e 7436 342c  oat32, np.int64,
+00026f50: 206e 702e 696e 7433 3229 2c0a 2020 2020   np.int32),.    
+00026f60: 2020 2020 290a 2020 2020 2020 2020 6e5f      ).        n_
+00026f70: 6c61 6265 6c73 203d 206e 702e 756e 6971  labels = np.uniq
+00026f80: 7565 2879 292e 7368 6170 655b 305d 0a20  ue(y).shape[0]. 
+00026f90: 2020 2020 2020 206c 6162 656c 7320 3d20         labels = 
+00026fa0: 6e70 2e75 6e69 7175 6528 7929 0a20 2020  np.unique(y).   
+00026fb0: 2020 2020 2069 6e74 7261 5f64 6973 7473       intra_dists
+00026fc0: 203d 206e 702e 6675 6c6c 2828 6e5f 6c61   = np.full((n_la
+00026fd0: 6265 6c73 292c 2030 2e30 290a 2020 2020  bels), 0.0).    
+00026fe0: 2020 2020 6365 6e74 726f 6964 7320 3d20      centroids = 
+00026ff0: 6e70 2e66 756c 6c28 286e 5f6c 6162 656c  np.full((n_label
+00027000: 732c 2078 2e73 6861 7065 5b31 5d29 2c20  s, x.shape[1]), 
+00027010: 302e 3029 0a20 2020 2020 2020 2066 6f72  0.0).        for
+00027020: 206b 2069 6e20 7261 6e67 6528 6e5f 6c61   k in range(n_la
+00027030: 6265 6c73 293a 0a20 2020 2020 2020 2020  bels):.         
+00027040: 2020 2063 6c75 7374 6572 5f6b 203d 2078     cluster_k = x
+00027050: 5b6e 702e 6172 6777 6865 7265 2879 203d  [np.argwhere(y =
+00027060: 3d20 6c61 6265 6c73 5b6b 5d29 5d2e 7265  = labels[k])].re
+00027070: 7368 6170 6528 2d31 2c20 3229 0a20 2020  shape(-1, 2).   
+00027080: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
+00027090: 5f6d 6561 6e20 3d20 6e70 2e66 756c 6c28  _mean = np.full(
+000270a0: 2878 2e73 6861 7065 5b31 5d29 2c20 6e70  (x.shape[1]), np
+000270b0: 2e6e 616e 290a 2020 2020 2020 2020 2020  .nan).          
+000270c0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+000270d0: 2863 6c75 7374 6572 5f6d 6561 6e2e 7368  (cluster_mean.sh
+000270e0: 6170 655b 305d 293a 0a20 2020 2020 2020  ape[0]):.       
+000270f0: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
+00027100: 5f6d 6561 6e5b 695d 203d 206e 702e 6d65  _mean[i] = np.me
+00027110: 616e 2863 6c75 7374 6572 5f6b 5b3a 2c20  an(cluster_k[:, 
+00027120: 695d 2e66 6c61 7474 656e 2829 290a 2020  i].flatten()).  
+00027130: 2020 2020 2020 2020 2020 6365 6e74 726f            centro
+00027140: 6964 735b 6b5d 203d 2063 6c75 7374 6572  ids[k] = cluster
+00027150: 5f6d 6561 6e0a 2020 2020 2020 2020 2020  _mean.          
+00027160: 2020 696e 7472 615f 6469 7374 735b 6b5d    intra_dists[k]
+00027170: 203d 206e 702e 6176 6572 6167 6528 0a20   = np.average(. 
+00027180: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+00027190: 6561 7475 7265 4578 7472 6163 7469 6f6e  eatureExtraction
+000271a0: 4d69 7869 6e2e 6672 616d 6577 6973 655f  Mixin.framewise_
+000271b0: 6575 636c 6964 6561 6e5f 6469 7374 616e  euclidean_distan
+000271c0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+000271d0: 2020 2020 2020 2020 6c6f 6361 7469 6f6e          location
+000271e0: 5f31 3d63 6c75 7374 6572 5f6b 2c0a 2020  _1=cluster_k,.  
+000271f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027200: 2020 6c6f 6361 7469 6f6e 5f32 3d6e 702e    location_2=np.
+00027210: 6675 6c6c 2863 6c75 7374 6572 5f6b 2e73  full(cluster_k.s
+00027220: 6861 7065 2c20 636c 7573 7465 725f 6d65  hape, cluster_me
+00027230: 616e 292c 0a20 2020 2020 2020 2020 2020  an),.           
+00027240: 2020 2020 2020 2020 2070 785f 7065 725f           px_per_
+00027250: 6d6d 3d31 2c0a 2020 2020 2020 2020 2020  mm=1,.          
+00027260: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00027270: 2020 2020 290a 2020 2020 2020 2020 6365      ).        ce
+00027280: 6e74 726f 6964 5f64 6973 7461 6e63 6573  ntroid_distances
+00027290: 203d 2046 6561 7475 7265 4578 7472 6163   = FeatureExtrac
+000272a0: 7469 6f6e 4d69 7869 6e2e 6364 6973 7428  tionMixin.cdist(
+000272b0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+000272c0: 6179 5f31 3d63 656e 7472 6f69 6473 2e61  ay_1=centroids.a
+000272d0: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+000272e0: 292c 2061 7272 6179 5f32 3d63 656e 7472  ), array_2=centr
+000272f0: 6f69 6473 2e61 7374 7970 6528 6e70 2e66  oids.astype(np.f
+00027300: 6c6f 6174 3332 290a 2020 2020 2020 2020  loat32).        
+00027310: 290a 2020 2020 2020 2020 6966 206e 702e  ).        if np.
+00027320: 616c 6c63 6c6f 7365 2869 6e74 7261 5f64  allclose(intra_d
+00027330: 6973 7473 2c20 3029 206f 7220 6e70 2e61  ists, 0) or np.a
+00027340: 6c6c 636c 6f73 6528 6365 6e74 726f 6964  llclose(centroid
+00027350: 5f64 6973 7461 6e63 6573 2c20 3029 3a0a  _distances, 0):.
+00027360: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00027370: 726e 2030 2e30 0a20 2020 2020 2020 2063  rn 0.0.        c
+00027380: 656e 7472 6f69 645f 6469 7374 616e 6365  entroid_distance
+00027390: 735b 6365 6e74 726f 6964 5f64 6973 7461  s[centroid_dista
+000273a0: 6e63 6573 203d 3d20 305d 203d 206e 702e  nces == 0] = np.
+000273b0: 696e 660a 2020 2020 2020 2020 636f 6d62  inf.        comb
+000273c0: 696e 6564 5f69 6e74 7261 5f64 6973 7473  ined_intra_dists
+000273d0: 203d 2069 6e74 7261 5f64 6973 7473 5b3a   = intra_dists[:
+000273e0: 2c20 4e6f 6e65 5d20 2b20 696e 7472 615f  , None] + intra_
+000273f0: 6469 7374 730a 2020 2020 2020 2020 7265  dists.        re
+00027400: 7475 726e 206e 702e 6d65 616e 286e 702e  turn np.mean(np.
+00027410: 6d61 7828 636f 6d62 696e 6564 5f69 6e74  max(combined_int
+00027420: 7261 5f64 6973 7473 202f 2063 656e 7472  ra_dists / centr
+00027430: 6f69 645f 6469 7374 616e 6365 732c 2061  oid_distances, a
+00027440: 7869 733d 3129 290a 0a20 2020 2040 7374  xis=1))..    @st
+00027450: 6174 6963 6d65 7468 6f64 0a20 2020 2040  aticmethod.    @
+00027460: 6e6a 6974 2822 2866 6c6f 6174 3332 5b3a  njit("(float32[:
+00027470: 2c3a 5d2c 2069 6e74 3634 5b3a 5d29 222c  ,:], int64[:])",
+00027480: 2063 6163 6865 3d54 7275 6529 0a20 2020   cache=True).   
+00027490: 2064 6566 2063 616c 696e 736b 695f 6861   def calinski_ha
+000274a0: 7261 6261 737a 2878 3a20 6e70 2e6e 6461  rabasz(x: np.nda
+000274b0: 7272 6179 2c20 793a 206e 702e 6e64 6172  rray, y: np.ndar
+000274c0: 7261 7929 202d 3e20 666c 6f61 743a 0a20  ray) -> float:. 
+000274d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000274e0: 2020 2043 6f6d 7075 7465 2074 6865 2043     Compute the C
+000274f0: 616c 696e 736b 692d 4861 7261 6261 737a  alinski-Harabasz
+00027500: 2073 636f 7265 2074 6f20 6576 616c 7561   score to evalua
+00027510: 7465 2063 6c75 7374 6572 696e 6720 7175  te clustering qu
+00027520: 616c 6974 792e 0a0a 2020 2020 2020 2020  ality...        
+00027530: 5468 6520 4361 6c69 6e73 6b69 2d48 6172  The Calinski-Har
+00027540: 6162 6173 7a20 7363 6f72 6520 6973 2061  abasz score is a
+00027550: 206d 6561 7375 7265 206f 6620 636c 7573   measure of clus
+00027560: 7465 7220 7365 7061 7261 7469 6f6e 2061  ter separation a
+00027570: 6e64 2063 6f6d 7061 6374 6e65 7373 2e0a  nd compactness..
+00027580: 2020 2020 2020 2020 4974 2069 7320 6361          It is ca
+00027590: 6c63 756c 6174 6564 2061 7320 7468 6520  lculated as the 
+000275a0: 7261 7469 6f20 6f66 2074 6865 2062 6574  ratio of the bet
+000275b0: 7765 656e 2d63 6c75 7374 6572 2064 6973  ween-cluster dis
+000275c0: 7065 7273 696f 6e20 746f 2074 6865 0a20  persion to the. 
+000275d0: 2020 2020 2020 2077 6974 6869 6e2d 636c         within-cl
+000275e0: 7573 7465 7220 6469 7370 6572 7369 6f6e  uster dispersion
+000275f0: 2e20 4120 6869 6768 6572 2073 636f 7265  . A higher score
+00027600: 2069 6e64 6963 6174 6573 2062 6574 7465   indicates bette
+00027610: 7220 636c 7573 7465 7269 6e67 2e0a 0a20  r clustering... 
+00027620: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+00027630: 0a20 2020 2020 2020 2020 2020 4d6f 6469  .           Modi
+00027640: 6669 6564 2066 726f 6d20 6073 6369 6b69  fied from `sciki
+00027650: 742d 6c65 6172 6e20 3c68 7474 7073 3a2f  t-learn <https:/
+00027660: 2f67 6974 6875 622e 636f 6d2f 7363 696b  /github.com/scik
+00027670: 6974 2d6c 6561 726e 2f73 6369 6b69 742d  it-learn/scikit-
+00027680: 6c65 6172 6e2f 626c 6f62 2f38 3732 3132  learn/blob/87212
+00027690: 3435 3531 3164 6532 6632 3235 6666 3566  45511de2f225ff5f
+000276a0: 3961 6135 6635 6661 6463 6536 3633 6364  9aa5f5fadce663cd
+000276b0: 3461 332f 736b 6c65 6172 6e2f 6d65 7472  4a3/sklearn/metr
+000276c0: 6963 732f 636c 7573 7465 722f 5f75 6e73  ics/cluster/_uns
+000276d0: 7570 6572 7669 7365 642e 7079 234c 3332  upervised.py#L32
+000276e0: 363e 605f 0a0a 2020 2020 2020 2020 3a70  6>`_..        :p
+000276f0: 6172 616d 2078 3a20 3244 2061 7272 6179  aram x: 2D array
+00027700: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+00027710: 6520 6461 7461 2070 6f69 6e74 732e 2053  e data points. S
+00027720: 6861 7065 2028 6e5f 7361 6d70 6c65 732c  hape (n_samples,
+00027730: 206e 5f66 6561 7475 7265 732f 6e5f 6469   n_features/n_di
+00027740: 6d65 6e73 696f 6e29 2e0a 2020 2020 2020  mension)..      
+00027750: 2020 3a70 6172 616d 2079 3a20 3244 2061    :param y: 2D a
+00027760: 7272 6179 2072 6570 7265 7365 6e74 696e  rray representin
+00027770: 6720 636c 7573 7465 7220 6c61 6265 6c73  g cluster labels
+00027780: 2066 6f72 2065 6163 6820 6461 7461 2070   for each data p
+00027790: 6f69 6e74 2e20 5368 6170 6520 286e 5f73  oint. Shape (n_s
+000277a0: 616d 706c 6573 2c29 2e0a 2020 2020 2020  amples,)..      
+000277b0: 2020 3a72 6574 7572 6e20 666c 6f61 743a    :return float:
+000277c0: 2043 616c 696e 736b 692d 4861 7261 6261   Calinski-Haraba
+000277d0: 737a 2073 636f 7265 2e0a 0a20 2020 2020  sz score...     
+000277e0: 2020 203a 6578 616d 706c 653a 0a20 2020     :example:.   
+000277f0: 2020 2020 203e 3e3e 2078 203d 206e 702e       >>> x = np.
+00027800: 7261 6e64 6f6d 2e72 616e 646f 6d28 2831  random.random((1
+00027810: 3030 2c20 3229 292e 6173 7479 7065 286e  00, 2)).astype(n
+00027820: 702e 666c 6f61 7433 3229 0a20 2020 2020  p.float32).     
+00027830: 2020 203e 3e3e 2079 203d 206e 702e 7261     >>> y = np.ra
+00027840: 6e64 6f6d 2e72 616e 6469 6e74 2830 2c20  ndom.randint(0, 
+00027850: 3130 302c 2028 3130 302c 2929 2e61 7374  100, (100,)).ast
+00027860: 7970 6528 6e70 2e69 6e74 3634 290a 2020  ype(np.int64).  
+00027870: 2020 2020 2020 3e3e 3e20 5374 6174 6973        >>> Statis
+00027880: 7469 6373 2e63 616c 696e 736b 695f 6861  tics.calinski_ha
+00027890: 7261 6261 737a 2878 3d78 2c20 793d 7929  rabasz(x=x, y=y)
+000278a0: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+000278b0: 2020 2020 2020 6e5f 6c61 6265 6c73 203d        n_labels =
+000278c0: 206e 702e 756e 6971 7565 2879 292e 7368   np.unique(y).sh
+000278d0: 6170 655b 305d 0a20 2020 2020 2020 206c  ape[0].        l
+000278e0: 6162 656c 7320 3d20 6e70 2e75 6e69 7175  abels = np.uniqu
+000278f0: 6528 7929 0a20 2020 2020 2020 2065 7874  e(y).        ext
+00027900: 7261 5f64 6973 7065 7273 696f 6e2c 2069  ra_dispersion, i
+00027910: 6e74 7261 5f64 6973 7065 7273 696f 6e20  ntra_dispersion 
+00027920: 3d20 302e 302c 2030 2e30 0a20 2020 2020  = 0.0, 0.0.     
+00027930: 2020 2067 6c6f 6261 6c5f 6d65 616e 203d     global_mean =
+00027940: 206e 702e 6675 6c6c 2828 782e 7368 6170   np.full((x.shap
+00027950: 655b 315d 292c 206e 702e 6e61 6e29 0a20  e[1]), np.nan). 
+00027960: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00027970: 7261 6e67 6528 782e 7368 6170 655b 315d  range(x.shape[1]
+00027980: 293a 0a20 2020 2020 2020 2020 2020 2067  ):.            g
+00027990: 6c6f 6261 6c5f 6d65 616e 5b69 5d20 3d20  lobal_mean[i] = 
+000279a0: 6e70 2e6d 6561 6e28 785b 3a2c 2069 5d2e  np.mean(x[:, i].
+000279b0: 666c 6174 7465 6e28 2929 0a20 2020 2020  flatten()).     
+000279c0: 2020 2066 6f72 206b 2069 6e20 7261 6e67     for k in rang
+000279d0: 6528 6e5f 6c61 6265 6c73 293a 0a20 2020  e(n_labels):.   
+000279e0: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
+000279f0: 5f6b 203d 2078 5b6e 702e 6172 6777 6865  _k = x[np.argwhe
+00027a00: 7265 2879 203d 3d20 6c61 6265 6c73 5b6b  re(y == labels[k
+00027a10: 5d29 2e66 6c61 7474 656e 2829 2c20 3a5d  ]).flatten(), :]
+00027a20: 0a20 2020 2020 2020 2020 2020 206d 6561  .            mea
+00027a30: 6e5f 6b20 3d20 6e70 2e66 756c 6c28 2863  n_k = np.full((c
+00027a40: 6c75 7374 6572 5f6b 2e73 6861 7065 5b31  luster_k.shape[1
+00027a50: 5d29 2c20 6e70 2e6e 616e 290a 2020 2020  ]), np.nan).    
+00027a60: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00027a70: 2072 616e 6765 2863 6c75 7374 6572 5f6b   range(cluster_k
+00027a80: 2e73 6861 7065 5b31 5d29 3a0a 2020 2020  .shape[1]):.    
+00027a90: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
+00027aa0: 5f6b 5b69 5d20 3d20 6e70 2e6d 6561 6e28  _k[i] = np.mean(
+00027ab0: 636c 7573 7465 725f 6b5b 3a2c 2069 5d2e  cluster_k[:, i].
+00027ac0: 666c 6174 7465 6e28 2929 0a20 2020 2020  flatten()).     
+00027ad0: 2020 2020 2020 2065 7874 7261 5f64 6973         extra_dis
+00027ae0: 7065 7273 696f 6e20 2b3d 206c 656e 2863  persion += len(c
+00027af0: 6c75 7374 6572 5f6b 2920 2a20 6e70 2e73  luster_k) * np.s
+00027b00: 756d 2828 6d65 616e 5f6b 202d 2067 6c6f  um((mean_k - glo
+00027b10: 6261 6c5f 6d65 616e 2920 2a2a 2032 290a  bal_mean) ** 2).
+00027b20: 2020 2020 2020 2020 2020 2020 696e 7472              intr
+00027b30: 615f 6469 7370 6572 7369 6f6e 202b 3d20  a_dispersion += 
+00027b40: 6e70 2e73 756d 2828 636c 7573 7465 725f  np.sum((cluster_
+00027b50: 6b20 2d20 6d65 616e 5f6b 2920 2a2a 2032  k - mean_k) ** 2
+00027b60: 290a 0a20 2020 2020 2020 2064 656e 6f6d  )..        denom
+00027b70: 696e 6174 6f72 203d 2069 6e74 7261 5f64  inator = intra_d
+00027b80: 6973 7065 7273 696f 6e20 2a20 286e 5f6c  ispersion * (n_l
+00027b90: 6162 656c 7320 2d20 312e 3029 0a20 2020  abels - 1.0).   
+00027ba0: 2020 2020 2069 6620 6465 6e6f 6d69 6e61       if denomina
+00027bb0: 746f 7220 3d3d 2030 2e30 3a0a 2020 2020  tor == 0.0:.    
+00027bc0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+00027bd0: 2e30 0a20 2020 2020 2020 2065 6c73 653a  .0.        else:
+00027be0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00027bf0: 7572 6e20 6578 7472 615f 6469 7370 6572  urn extra_disper
+00027c00: 7369 6f6e 202a 2028 782e 7368 6170 655b  sion * (x.shape[
+00027c10: 305d 202d 206e 5f6c 6162 656c 7329 202f  0] - n_labels) /
+00027c20: 2064 656e 6f6d 696e 6174 6f72 0a0a 2020   denominator..  
+00027c30: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+00027c40: 2020 2020 6465 6620 6164 6a75 7374 6564      def adjusted
+00027c50: 5f72 616e 6428 783a 206e 702e 6e64 6172  _rand(x: np.ndar
+00027c60: 7261 792c 2079 3a20 6e70 2e6e 6461 7272  ray, y: np.ndarr
+00027c70: 6179 2920 2d3e 2066 6c6f 6174 3a0a 2020  ay) -> float:.  
+00027c80: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00027c90: 2020 4361 6c63 756c 6174 6520 7468 6520    Calculate the 
+00027ca0: 4164 6a75 7374 6564 2052 616e 6420 496e  Adjusted Rand In
+00027cb0: 6465 7820 2841 5249 2920 6265 7477 6565  dex (ARI) betwee
+00027cc0: 6e20 7477 6f20 636c 7573 7465 7269 6e67  n two clustering
+00027cd0: 732e 0a0a 2020 2020 2020 2020 5468 6520  s...        The 
+00027ce0: 4164 6a75 7374 6564 2052 616e 6420 496e  Adjusted Rand In
+00027cf0: 6465 7820 2841 5249 2920 6973 2061 206d  dex (ARI) is a m
+00027d00: 6561 7375 7265 206f 6620 7468 6520 7369  easure of the si
+00027d10: 6d69 6c61 7269 7479 2062 6574 7765 656e  milarity between
+00027d20: 2074 776f 2063 6c75 7374 6572 696e 6773   two clusterings
+00027d30: 2e20 4974 2063 6f6e 7369 6465 7273 2061  . It considers a
+00027d40: 6c6c 2070 6169 7273 206f 6620 7361 6d70  ll pairs of samp
+00027d50: 6c65 7320 616e 6420 636f 756e 7473 2070  les and counts p
+00027d60: 6169 7273 2074 6861 7420 6172 6520 6173  airs that are as
+00027d70: 7369 676e 6564 2074 6f20 7468 6520 7361  signed to the sa
+00027d80: 6d65 206f 7220 6469 6666 6572 656e 7420  me or different 
+00027d90: 636c 7573 7465 7273 2069 6e20 626f 7468  clusters in both
+00027da0: 2074 6865 2074 7275 6520 616e 6420 7072   the true and pr
+00027db0: 6564 6963 7465 6420 636c 7573 7465 7269  edicted clusteri
+00027dc0: 6e67 732e 0a0a 2020 2020 2020 2020 5468  ngs...        Th
+00027dd0: 6520 4152 4920 6973 2064 6566 696e 6564  e ARI is defined
+00027de0: 2061 733a 0a0a 2020 2020 2020 2020 2e2e   as:..        ..
+00027df0: 206d 6174 683a 3a0a 2020 2020 2020 2020   math::.        
+00027e00: 2020 2041 5249 203d 205c 5c66 7261 637b     ARI = \\frac{
+00027e10: 5450 202b 2054 4e7d 7b54 5020 2b20 4650  TP + TN}{TP + FP
+00027e20: 202b 2046 4e20 2b20 544e 7d0a 0a20 2020   + FN + TN}..   
+00027e30: 2020 2020 2077 6865 7265 3a0a 2020 2020       where:.    
+00027e40: 2020 2020 2020 2020 2d20 5450 2028 5472          - TP (Tr
+00027e50: 7565 2050 6f73 6974 6976 6529 2069 7320  ue Positive) is 
+00027e60: 7468 6520 6e75 6d62 6572 206f 6620 7061  the number of pa
+00027e70: 6972 7320 6f66 2065 6c65 6d65 6e74 7320  irs of elements 
+00027e80: 7468 6174 2061 7265 2069 6e20 7468 6520  that are in the 
+00027e90: 7361 6d65 2063 6c75 7374 6572 2069 6e20  same cluster in 
+00027ea0: 626f 7468 2078 2061 6e64 2079 2c0a 2020  both x and y,.  
+00027eb0: 2020 2020 2020 2020 2020 2d20 4650 2028            - FP (
+00027ec0: 4661 6c73 6520 506f 7369 7469 7665 2920  False Positive) 
+00027ed0: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+00027ee0: 2070 6169 7273 206f 6620 656c 656d 656e   pairs of elemen
+00027ef0: 7473 2074 6861 7420 6172 6520 696e 2074  ts that are in t
+00027f00: 6865 2073 616d 6520 636c 7573 7465 7220  he same cluster 
+00027f10: 696e 2079 2062 7574 206e 6f74 2069 6e20  in y but not in 
+00027f20: 782c 0a20 2020 2020 2020 2020 2020 202d  x,.            -
+00027f30: 2046 4e20 2846 616c 7365 204e 6567 6174   FN (False Negat
+00027f40: 6976 6529 2069 7320 7468 6520 6e75 6d62  ive) is the numb
+00027f50: 6572 206f 6620 7061 6972 7320 6f66 2065  er of pairs of e
+00027f60: 6c65 6d65 6e74 7320 7468 6174 2061 7265  lements that are
+00027f70: 2069 6e20 7468 6520 7361 6d65 2063 6c75   in the same clu
+00027f80: 7374 6572 2069 6e20 7820 6275 7420 6e6f  ster in x but no
+00027f90: 7420 696e 2079 2c0a 2020 2020 2020 2020  t in y,.        
+00027fa0: 2020 2020 2d20 544e 2028 5472 7565 204e      - TN (True N
+00027fb0: 6567 6174 6976 6529 2069 7320 7468 6520  egative) is the 
+00027fc0: 6e75 6d62 6572 206f 6620 7061 6972 7320  number of pairs 
+00027fd0: 6f66 2065 6c65 6d65 6e74 7320 7468 6174  of elements that
+00027fe0: 2061 7265 2069 6e20 6469 6666 6572 656e   are in differen
+00027ff0: 7420 636c 7573 7465 7273 2069 6e20 626f  t clusters in bo
+00028000: 7468 2078 2061 6e64 2079 2e0a 0a20 2020  th x and y...   
+00028010: 2020 2020 2054 6865 2041 5249 2076 616c       The ARI val
+00028020: 7565 2072 616e 6765 7320 6672 6f6d 202d  ue ranges from -
+00028030: 3120 746f 2031 2e20 4120 7661 6c75 6520  1 to 1. A value 
+00028040: 6f66 2031 2069 6e64 6963 6174 6573 2070  of 1 indicates p
+00028050: 6572 6665 6374 2063 6c75 7374 6572 696e  erfect clusterin
+00028060: 6720 6167 7265 656d 656e 742c 2030 2069  g agreement, 0 i
+00028070: 6e64 6963 6174 6573 2072 616e 646f 6d20  ndicates random 
+00028080: 636c 7573 7465 7269 6e67 2c20 616e 6420  clustering, and 
+00028090: 6e65 6761 7469 7665 2076 616c 7565 7320  negative values 
+000280a0: 696e 6469 6361 7465 2064 6973 6167 7265  indicate disagre
+000280b0: 656d 656e 7420 6265 7477 6565 6e20 7468  ement between th
+000280c0: 6520 636c 7573 7465 7269 6e67 732e 0a0a  e clusterings...
+000280d0: 2020 2020 2020 2020 2e2e 206e 6f74 653a          .. note:
+000280e0: 3a0a 2020 2020 2020 2020 2020 204d 6f64  :.           Mod
+000280f0: 6966 6965 6420 6672 6f6d 2060 7363 696b  ified from `scik
+00028100: 6974 2d6c 6561 726e 203c 6874 7470 733a  it-learn <https:
+00028110: 2f2f 6769 7468 7562 2e63 6f6d 2f73 6369  //github.com/sci
+00028120: 6b69 742d 6c65 6172 6e2f 7363 696b 6974  kit-learn/scikit
+00028130: 2d6c 6561 726e 2f62 6c6f 622f 3837 3231  -learn/blob/8721
+00028140: 3234 3535 3131 6465 3266 3232 3566 6635  245511de2f225ff5
+00028150: 6639 6161 3566 3566 6164 6365 3636 3363  f9aa5f5fadce663c
+00028160: 6434 6133 2f73 6b6c 6561 726e 2f6d 6574  d4a3/sklearn/met
+00028170: 7269 6373 2f63 6c75 7374 6572 2f5f 7375  rics/cluster/_su
+00028180: 7065 7276 6973 6564 2e70 7923 4c33 3533  pervised.py#L353
+00028190: 3e60 5f0a 0a0a 2020 2020 2020 2020 3a70  >`_...        :p
+000281a0: 6172 616d 206e 702e 6e64 6172 7261 7920  aram np.ndarray 
+000281b0: 783a 2031 4420 6172 7261 7920 7265 7072  x: 1D array repr
+000281c0: 6573 656e 7469 6e67 2074 6865 206c 6162  esenting the lab
+000281d0: 656c 7320 6f66 2074 6865 2066 6972 7374  els of the first
+000281e0: 206d 6f64 656c 2e0a 2020 2020 2020 2020   model..        
+000281f0: 3a70 6172 616d 206e 702e 6e64 6172 7261  :param np.ndarra
+00028200: 7920 793a 2031 4420 6172 7261 7920 7265  y y: 1D array re
+00028210: 7072 6573 656e 7469 6e67 2074 6865 206c  presenting the l
+00028220: 6162 656c 7320 6f66 2074 6865 2073 6563  abels of the sec
+00028230: 6f6e 6420 6d6f 6465 6c2e 0a20 2020 2020  ond model..     
+00028240: 2020 203a 7265 7475 726e 2066 6c6f 6174     :return float
+00028250: 3a20 4120 7661 6c75 6520 6f66 2031 2069  : A value of 1 i
+00028260: 6e64 6963 6174 6573 2070 6572 6665 6374  ndicates perfect
+00028270: 2063 6c75 7374 6572 696e 6720 6167 7265   clustering agre
+00028280: 656d 656e 742c 2061 2076 616c 7565 206f  ement, a value o
+00028290: 6620 3020 696e 6469 6361 7465 7320 7261  f 0 indicates ra
+000282a0: 6e64 6f6d 2063 6c75 7374 6572 696e 672c  ndom clustering,
+000282b0: 2061 6e64 206e 6567 6174 6976 6520 7661   and negative va
+000282c0: 6c75 6573 2069 6e64 6963 6174 6520 6469  lues indicate di
+000282d0: 7361 6772 6565 6d65 6e74 2062 6574 7765  sagreement betwe
+000282e0: 656e 2074 6865 2063 6c75 7374 6572 696e  en the clusterin
+000282f0: 6773 2e0a 0a20 2020 2020 2020 203a 6578  gs...        :ex
+00028300: 616d 706c 653a 0a20 2020 2020 2020 203e  ample:.        >
+00028310: 3e3e 2078 203d 206e 702e 6172 7261 7928  >> x = np.array(
+00028320: 5b30 2c20 302c 2030 2c20 302c 2030 5d29  [0, 0, 0, 0, 0])
+00028330: 0a20 2020 2020 2020 203e 3e3e 2079 203d  .        >>> y =
+00028340: 206e 702e 6172 7261 7928 5b31 2c20 312c   np.array([1, 1,
+00028350: 2031 2c20 312c 2031 5d29 0a20 2020 2020   1, 1, 1]).     
+00028360: 2020 203e 3e3e 2053 7461 7469 7374 6963     >>> Statistic
+00028370: 732e 6164 6a75 7374 6564 5f72 616e 6428  s.adjusted_rand(
+00028380: 783d 782c 2079 3d79 290a 2020 2020 2020  x=x, y=y).      
+00028390: 2020 3e3e 3e20 312e 300a 2020 2020 2020    >>> 1.0.      
+000283a0: 2020 2222 220a 0a20 2020 2020 2020 2063    """..        c
+000283b0: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+000283c0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+000283d0: 7461 3d78 2c0a 2020 2020 2020 2020 2020  ta=x,.          
+000283e0: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
+000283f0: 6963 732e 6164 6a75 7374 6564 5f72 616e  ics.adjusted_ran
+00028400: 642e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  d.__name__,.    
+00028410: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+00028420: 5f6e 6469 6d73 3d28 312c 292c 0a20 2020  _ndims=(1,),.   
+00028430: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00028440: 645f 6474 7970 6573 3d28 6e70 2e69 6e74  d_dtypes=(np.int
+00028450: 3634 2c20 6e70 2e69 6e74 3332 2c20 696e  64, np.int32, in
+00028460: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
+00028470: 6d69 6e5f 6178 6973 5f30 3d31 2c0a 2020  min_axis_0=1,.  
+00028480: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00028490: 6368 6563 6b5f 7661 6c69 645f 6172 7261  check_valid_arra
+000284a0: 7928 0a20 2020 2020 2020 2020 2020 2064  y(.            d
+000284b0: 6174 613d 792c 0a20 2020 2020 2020 2020  ata=y,.         
+000284c0: 2020 2073 6f75 7263 653d 5374 6174 6973     source=Statis
+000284d0: 7469 6373 2e61 646a 7573 7465 645f 7261  tics.adjusted_ra
+000284e0: 6e64 2e5f 5f6e 616d 655f 5f2c 0a20 2020  nd.__name__,.   
+000284f0: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00028500: 645f 6e64 696d 733d 2831 2c29 2c0a 2020  d_ndims=(1,),.  
+00028510: 2020 2020 2020 2020 2020 6163 6365 7074            accept
+00028520: 6564 5f64 7479 7065 733d 286e 702e 696e  ed_dtypes=(np.in
+00028530: 7436 342c 206e 702e 696e 7433 322c 2069  t64, np.int32, i
+00028540: 6e74 292c 0a20 2020 2020 2020 2020 2020  nt),.           
+00028550: 2061 6363 6570 7465 645f 7368 6170 6573   accepted_shapes
+00028560: 3d5b 2878 2e73 6861 7065 5b30 5d2c 295d  =[(x.shape[0],)]
+00028570: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00028580: 2020 2020 7265 7475 726e 2061 646a 7573      return adjus
+00028590: 7465 645f 7261 6e64 5f73 636f 7265 286c  ted_rand_score(l
+000285a0: 6162 656c 735f 7472 7565 3d78 2c20 6c61  abels_true=x, la
+000285b0: 6265 6c73 5f70 7265 643d 7929 0a0a 2020  bels_pred=y)..  
+000285c0: 2020 4073 7461 7469 636d 6574 686f 640a    @staticmethod.
+000285d0: 2020 2020 6465 6620 666f 776c 6b65 735f      def fowlkes_
+000285e0: 6d61 6c6c 6f77 7328 783a 206e 702e 6e64  mallows(x: np.nd
+000285f0: 6172 7261 792c 2079 3a20 6e70 2e6e 6461  array, y: np.nda
+00028600: 7272 6179 2920 2d3e 2066 6c6f 6174 3a0a  rray) -> float:.
+00028610: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00028620: 2020 2020 4361 6c63 756c 6174 6520 7468      Calculate th
+00028630: 6520 466f 776c 6b65 732d 4d61 6c6c 6f77  e Fowlkes-Mallow
+00028640: 7320 496e 6465 7820 2846 4d49 2920 6265  s Index (FMI) be
+00028650: 7477 6565 6e20 7477 6f20 636c 7573 7465  tween two cluste
+00028660: 7269 6e67 732e 0a0a 2020 2020 2020 2020  rings...        
+00028670: 5468 6520 466f 776c 6b65 732d 4d61 6c6c  The Fowlkes-Mall
+00028680: 6f77 7320 696e 6465 7820 2846 4d49 2920  ows index (FMI) 
+00028690: 6973 2061 206d 6561 7375 7265 206f 6620  is a measure of 
+000286a0: 7369 6d69 6c61 7269 7479 2062 6574 7765  similarity betwe
+000286b0: 656e 2074 776f 2063 6c75 7374 6572 696e  en two clusterin
+000286c0: 6773 2e20 4974 2063 6f6d 7061 7265 7320  gs. It compares 
+000286d0: 7468 6520 7369 6d69 6c61 7269 7479 206f  the similarity o
+000286e0: 6620 7468 6520 636c 7573 7465 7273 206f  f the clusters o
+000286f0: 6274 6169 6e65 6420 6279 2074 776f 2064  btained by two d
+00028700: 6966 6665 7265 6e74 2063 6c75 7374 6572  ifferent cluster
+00028710: 696e 6720 616c 676f 7269 7468 6d73 206f  ing algorithms o
+00028720: 7220 7072 6f63 6564 7572 6573 2e0a 0a20  r procedures... 
+00028730: 2020 2020 2020 2054 6865 2069 6e64 6578         The index
+00028740: 2069 7320 6465 6669 6e65 6420 6173 2074   is defined as t
+00028750: 6865 2067 656f 6d65 7472 6963 206d 6561  he geometric mea
+00028760: 6e20 6f66 2074 6865 2070 6169 7277 6973  n of the pairwis
+00028770: 6520 7072 6563 6973 696f 6e20 616e 6420  e precision and 
+00028780: 7265 6361 6c6c 3a0a 0a20 2020 2020 2020  recall:..       
+00028790: 202e 2e20 6d61 7468 3a3a 0a20 2020 2020   .. math::.     
+000287a0: 2020 2020 2020 464d 4920 3d20 5c5c 7371        FMI = \\sq
+000287b0: 7274 7b5c 5c66 7261 637b 5450 7d7b 5450  rt{\\frac{TP}{TP
+000287c0: 202b 2046 507d 205c 5c74 696d 6573 205c   + FP} \\times \
+000287d0: 5c66 7261 637b 5450 7d7b 5450 202b 2046  \frac{TP}{TP + F
+000287e0: 4e7d 7d0a 0a20 2020 2020 2020 2077 6865  N}}..        whe
+000287f0: 7265 3a0a 2020 2020 2020 2020 2d20 5450  re:.        - TP
+00028800: 2028 5472 7565 2050 6f73 6974 6976 6529   (True Positive)
+00028810: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
+00028820: 6620 7061 6972 7320 6f66 2065 6c65 6d65  f pairs of eleme
+00028830: 6e74 7320 7468 6174 2061 7265 2069 6e20  nts that are in 
+00028840: 7468 6520 7361 6d65 2063 6c75 7374 6572  the same cluster
+00028850: 2069 6e20 626f 7468 2078 2061 6e64 2079   in both x and y
+00028860: 2c0a 2020 2020 2020 2020 2d20 4650 2028  ,.        - FP (
+00028870: 4661 6c73 6520 506f 7369 7469 7665 2920  False Positive) 
+00028880: 6973 2074 6865 206e 756d 6265 7220 6f66  is the number of
+00028890: 2070 6169 7273 206f 6620 656c 656d 656e   pairs of elemen
+000288a0: 7473 2074 6861 7420 6172 6520 696e 2074  ts that are in t
+000288b0: 6865 2073 616d 6520 636c 7573 7465 7220  he same cluster 
+000288c0: 696e 2079 2062 7574 206e 6f74 2069 6e20  in y but not in 
+000288d0: 782c 0a20 2020 2020 2020 202d 2046 4e20  x,.        - FN 
+000288e0: 2846 616c 7365 204e 6567 6174 6976 6529  (False Negative)
+000288f0: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
+00028900: 6620 7061 6972 7320 6f66 2065 6c65 6d65  f pairs of eleme
+00028910: 6e74 7320 7468 6174 2061 7265 2069 6e20  nts that are in 
+00028920: 7468 6520 7361 6d65 2063 6c75 7374 6572  the same cluster
+00028930: 2069 6e20 7820 6275 7420 6e6f 7420 696e   in x but not in
+00028940: 2079 2e0a 0a20 2020 2020 2020 202e 2e20   y...        .. 
+00028950: 6e6f 7465 3a3a 0a20 2020 2020 2020 2020  note::.         
+00028960: 2020 4d6f 6469 6669 6564 2066 726f 6d20    Modified from 
+00028970: 6073 6369 6b69 742d 6c65 6172 6e20 3c68  `scikit-learn <h
+00028980: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00028990: 6d2f 7363 696b 6974 2d6c 6561 726e 2f73  m/scikit-learn/s
+000289a0: 6369 6b69 742d 6c65 6172 6e2f 626c 6f62  cikit-learn/blob
+000289b0: 2f38 3732 3132 3435 3531 3164 6532 6632  /8721245511de2f2
+000289c0: 3235 6666 3566 3961 6135 6635 6661 6463  25ff5f9aa5f5fadc
+000289d0: 6536 3633 6364 3461 332f 736b 6c65 6172  e663cd4a3/sklear
+000289e0: 6e2f 6d65 7472 6963 732f 636c 7573 7465  n/metrics/cluste
+000289f0: 722f 5f73 7570 6572 7669 7365 642e 7079  r/_supervised.py
+00028a00: 234c 3131 3834 3e60 5f0a 0a0a 2020 2020  #L1184>`_...    
+00028a10: 2020 2020 3a70 6172 616d 206e 702e 6e64      :param np.nd
+00028a20: 6172 7261 7920 783a 2031 4420 6172 7261  array x: 1D arra
+00028a30: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
+00028a40: 6865 206c 6162 656c 7320 6f66 2074 6865  he labels of the
+00028a50: 2066 6972 7374 206d 6f64 656c 2e0a 2020   first model..  
+00028a60: 2020 2020 2020 3a70 6172 616d 206e 702e        :param np.
+00028a70: 6e64 6172 7261 7920 793a 2031 4420 6172  ndarray y: 1D ar
+00028a80: 7261 7920 7265 7072 6573 656e 7469 6e67  ray representing
+00028a90: 2074 6865 206c 6162 656c 7320 6f66 2074   the labels of t
+00028aa0: 6865 2073 6563 6f6e 6420 6d6f 6465 6c2e  he second model.
+00028ab0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00028ac0: 2066 6c6f 6174 3a20 5363 6f72 6520 6265   float: Score be
+00028ad0: 7477 6565 6e20 3020 616e 6420 312e 2031  tween 0 and 1. 1
+00028ae0: 2069 6e64 6963 6174 6573 2070 6572 6665   indicates perfe
+00028af0: 6374 2063 6c75 7374 6572 696e 6720 6167  ct clustering ag
+00028b00: 7265 656d 656e 742c 2030 2069 6e64 6963  reement, 0 indic
+00028b10: 6174 6573 2072 616e 646f 6d20 636c 7573  ates random clus
+00028b20: 7465 7269 6e67 2e0a 2020 2020 2020 2020  tering..        
+00028b30: 2222 220a 0a20 2020 2020 2020 2063 6865  """..        che
+00028b40: 636b 5f76 616c 6964 5f61 7272 6179 280a  ck_valid_array(.
+00028b50: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00028b60: 3d78 2c0a 2020 2020 2020 2020 2020 2020  =x,.            
+00028b70: 736f 7572 6365 3d53 7461 7469 7374 6963  source=Statistic
+00028b80: 732e 666f 776c 6b65 735f 6d61 6c6c 6f77  s.fowlkes_mallow
+00028b90: 732e 5f5f 6e61 6d65 5f5f 2c0a 2020 2020  s.__name__,.    
+00028ba0: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+00028bb0: 5f6e 6469 6d73 3d28 312c 292c 0a20 2020  _ndims=(1,),.   
+00028bc0: 2020 2020 2020 2020 2061 6363 6570 7465           accepte
+00028bd0: 645f 6474 7970 6573 3d28 6e70 2e69 6e74  d_dtypes=(np.int
+00028be0: 3634 2c20 6e70 2e69 6e74 3332 2c20 696e  64, np.int32, in
+00028bf0: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
+00028c00: 6d69 6e5f 6178 6973 5f30 3d31 2c0a 2020  min_axis_0=1,.  
+00028c10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00028c20: 6368 6563 6b5f 7661 6c69 645f 6172 7261  check_valid_arra
+00028c30: 7928 0a20 2020 2020 2020 2020 2020 2064  y(.            d
+00028c40: 6174 613d 792c 0a20 2020 2020 2020 2020  ata=y,.         
+00028c50: 2020 2073 6f75 7263 653d 5374 6174 6973     source=Statis
+00028c60: 7469 6373 2e66 6f77 6c6b 6573 5f6d 616c  tics.fowlkes_mal
+00028c70: 6c6f 7773 2e5f 5f6e 616d 655f 5f2c 0a20  lows.__name__,. 
+00028c80: 2020 2020 2020 2020 2020 2061 6363 6570             accep
+00028c90: 7465 645f 6e64 696d 733d 2831 2c29 2c0a  ted_ndims=(1,),.
+00028ca0: 2020 2020 2020 2020 2020 2020 6163 6365              acce
+00028cb0: 7074 6564 5f64 7479 7065 733d 286e 702e  pted_dtypes=(np.
+00028cc0: 696e 7436 342c 206e 702e 696e 7433 322c  int64, np.int32,
+00028cd0: 2069 6e74 292c 0a20 2020 2020 2020 2020   int),.         
+00028ce0: 2020 2061 6363 6570 7465 645f 7368 6170     accepted_shap
+00028cf0: 6573 3d5b 2878 2e73 6861 7065 5b30 5d2c  es=[(x.shape[0],
+00028d00: 295d 2c0a 2020 2020 2020 2020 290a 2020  )],.        ).  
+00028d10: 2020 2020 2020 7265 7475 726e 2066 6f77        return fow
+00028d20: 6c6b 6573 5f6d 616c 6c6f 7773 5f73 636f  lkes_mallows_sco
+00028d30: 7265 286c 6162 656c 735f 7472 7565 3d78  re(labels_true=x
+00028d40: 2c20 6c61 6265 6c73 5f70 7265 643d 7929  , labels_pred=y)
+00028d50: 0a0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00028d60: 686f 640a 2020 2020 6465 6620 6164 6a75  hod.    def adju
+00028d70: 7374 6564 5f6d 7574 7561 6c5f 696e 666f  sted_mutual_info
+00028d80: 2878 3a20 6e70 2e6e 6461 7272 6179 2c20  (x: np.ndarray, 
+00028d90: 793a 206e 702e 6e64 6172 7261 7929 202d  y: np.ndarray) -
+00028da0: 3e20 666c 6f61 743a 0a20 2020 2020 2020  > float:.       
+00028db0: 2022 2222 0a20 2020 2020 2020 2043 616c   """.        Cal
+00028dc0: 6375 6c61 7465 2074 6865 2041 646a 7573  culate the Adjus
+00028dd0: 7465 6420 4d75 7475 616c 2049 6e66 6f72  ted Mutual Infor
+00028de0: 6d61 7469 6f6e 2028 414d 4929 2062 6574  mation (AMI) bet
+00028df0: 7765 656e 2074 776f 2063 6c75 7374 6572  ween two cluster
+00028e00: 696e 6773 2061 7320 6120 6d65 6173 7572  ings as a measur
+00028e10: 6520 6f66 2073 696d 696c 6172 6974 792e  e of similarity.
+00028e20: 0a0a 2020 2020 2020 2020 4361 6c63 756c  ..        Calcul
+00028e30: 6174 6573 2074 6865 2041 646a 7573 7465  ates the Adjuste
+00028e40: 6420 4d75 7475 616c 2049 6e66 6f72 6d61  d Mutual Informa
+00028e50: 7469 6f6e 2028 414d 4929 2062 6574 7765  tion (AMI) betwe
+00028e60: 656e 2074 776f 2073 6574 7320 6f66 2063  en two sets of c
+00028e70: 6c75 7374 6572 206c 6162 656c 732e 0a20  luster labels.. 
+00028e80: 2020 2020 2020 2041 4d49 206d 6561 7375         AMI measu
+00028e90: 7265 7320 7468 6520 6167 7265 656d 656e  res the agreemen
+00028ea0: 7420 6265 7477 6565 6e20 7477 6f20 636c  t between two cl
+00028eb0: 7573 7465 7269 6e67 2072 6573 756c 7473  ustering results
+00028ec0: 2c20 6163 636f 756e 7469 6e67 2066 6f72  , accounting for
+00028ed0: 2063 6861 6e63 6520 6167 7265 656d 656e   chance agreemen
+00028ee0: 742e 0a20 2020 2020 2020 2054 6865 2076  t..        The v
+00028ef0: 616c 7565 206f 6620 414d 4920 7261 6e67  alue of AMI rang
+00028f00: 6573 2066 726f 6d20 3020 2869 6e64 6963  es from 0 (indic
+00028f10: 6174 696e 6720 6e6f 2061 6772 6565 6d65  ating no agreeme
+00028f20: 6e74 2920 746f 2031 2028 7065 7266 6563  nt) to 1 (perfec
+00028f30: 7420 6167 7265 656d 656e 7429 2e0a 0a20  t agreement)... 
+00028f40: 2020 2020 2020 202e 2e20 6d61 7468 3a3a         .. math::
+00028f50: 0a0a 2020 2020 2020 2020 2020 205c 7465  ..           \te
+00028f60: 7874 7b41 4d49 7d28 782c 2079 2920 3d20  xt{AMI}(x, y) = 
+00028f70: 5c66 7261 637b 5c74 6578 747b 4d49 7d28  \frac{\text{MI}(
+00028f80: 782c 2079 2920 2d20 4528 5c74 6578 747b  x, y) - E(\text{
+00028f90: 4d49 7d28 782c 2079 2929 7d7b 5c6d 6178  MI}(x, y))}{\max
+00028fa0: 2848 2878 292c 2048 2879 2929 202d 2045  (H(x), H(y)) - E
+00028fb0: 285c 7465 7874 7b4d 497d 2878 2c20 7929  (\text{MI}(x, y)
+00028fc0: 297d 0a0a 2020 2020 2020 2020 7768 6572  )}..        wher
+00028fd0: 653a 0a20 2020 2020 2020 2020 2020 202d  e:.            -
+00028fe0: 205c 7465 7874 7b4d 497d 2878 2c20 7929   \text{MI}(x, y)
+00028ff0: 205c 7465 7874 7b20 6973 2074 6865 206d   \text{ is the m
+00029000: 7574 7561 6c20 696e 666f 726d 6174 696f  utual informatio
+00029010: 6e20 6265 7477 6565 6e20 7d20 7820 5c74  n between } x \t
+00029020: 6578 747b 2061 6e64 207d 2079 2e0a 2020  ext{ and } y..  
+00029030: 2020 2020 2020 2020 2020 2d20 4528 5c74            - E(\t
+00029040: 6578 747b 4d49 7d28 782c 2079 2929 205c  ext{MI}(x, y)) \
+00029050: 7465 7874 7b20 6973 2074 6865 2065 7870  text{ is the exp
+00029060: 6563 7465 6420 6d75 7475 616c 2069 6e66  ected mutual inf
+00029070: 6f72 6d61 7469 6f6e 2e7d 0a20 2020 2020  ormation.}.     
+00029080: 2020 2020 2020 202d 2048 2878 2920 5c74         - H(x) \t
+00029090: 6578 747b 2061 6e64 207d 2048 2879 2920  ext{ and } H(y) 
+000290a0: 5c74 6578 747b 2061 7265 2074 6865 2065  \text{ are the e
+000290b0: 6e74 726f 7069 6573 206f 6620 7d20 7820  ntropies of } x 
+000290c0: 5c74 6578 747b 2061 6e64 207d 2079 2c20  \text{ and } y, 
+000290d0: 5c74 6578 747b 2072 6573 7065 6374 6976  \text{ respectiv
+000290e0: 656c 792e 7d0a 0a20 2020 2020 2020 203a  ely.}..        :
+000290f0: 7061 7261 6d20 6e70 2e6e 6461 7272 6179  param np.ndarray
+00029100: 2078 3a20 3144 2061 7272 6179 2072 6570   x: 1D array rep
+00029110: 7265 7365 6e74 696e 6720 7468 6520 6c61  resenting the la
+00029120: 6265 6c73 206f 6620 7468 6520 6669 7273  bels of the firs
+00029130: 7420 6d6f 6465 6c2e 0a20 2020 2020 2020  t model..       
+00029140: 203a 7061 7261 6d20 6e70 2e6e 6461 7272   :param np.ndarr
+00029150: 6179 2079 3a20 3144 2061 7272 6179 2072  ay y: 1D array r
+00029160: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
+00029170: 6c61 6265 6c73 206f 6620 7468 6520 7365  labels of the se
+00029180: 636f 6e64 206d 6f64 656c 2e0a 2020 2020  cond model..    
+00029190: 2020 2020 3a72 6574 7572 6e20 666c 6f61      :return floa
+000291a0: 743a 2053 636f 7265 2062 6574 7765 656e  t: Score between
+000291b0: 2030 2061 6e64 2031 2c20 7768 6572 6520   0 and 1, where 
+000291c0: 3120 696e 6469 6361 7465 7320 7065 7266  1 indicates perf
+000291d0: 6563 7420 636c 7573 7465 7269 6e67 2061  ect clustering a
+000291e0: 6772 6565 6d65 6e74 2e0a 0a20 2020 2020  greement...     
+000291f0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00029200: 6865 636b 5f76 616c 6964 5f61 7272 6179  heck_valid_array
+00029210: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+00029220: 7461 3d78 2c0a 2020 2020 2020 2020 2020  ta=x,.          
+00029230: 2020 736f 7572 6365 3d53 7461 7469 7374    source=Statist
+00029240: 6963 732e 6164 6a75 7374 6564 5f6d 7574  ics.adjusted_mut
+00029250: 7561 6c5f 696e 666f 2e5f 5f6e 616d 655f  ual_info.__name_
+00029260: 5f2c 0a20 2020 2020 2020 2020 2020 2061  _,.            a
+00029270: 6363 6570 7465 645f 6e64 696d 733d 2831  ccepted_ndims=(1
+00029280: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
+00029290: 6163 6365 7074 6564 5f64 7479 7065 733d  accepted_dtypes=
+000292a0: 286e 702e 696e 7436 342c 206e 702e 696e  (np.int64, np.in
+000292b0: 7433 322c 2069 6e74 292c 0a20 2020 2020  t32, int),.     
+000292c0: 2020 2020 2020 206d 696e 5f61 7869 735f         min_axis_
+000292d0: 303d 312c 0a20 2020 2020 2020 2029 0a20  0=1,.        ). 
+000292e0: 2020 2020 2020 2063 6865 636b 5f76 616c         check_val
+000292f0: 6964 5f61 7272 6179 280a 2020 2020 2020  id_array(.      
+00029300: 2020 2020 2020 6461 7461 3d79 2c0a 2020        data=y,.  
+00029310: 2020 2020 2020 2020 2020 736f 7572 6365            source
+00029320: 3d53 7461 7469 7374 6963 732e 6164 6a75  =Statistics.adju
+00029330: 7374 6564 5f6d 7574 7561 6c5f 696e 666f  sted_mutual_info
+00029340: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+00029350: 2020 2020 2020 2061 6363 6570 7465 645f         accepted_
+00029360: 6e64 696d 733d 2831 2c29 2c0a 2020 2020  ndims=(1,),.    
+00029370: 2020 2020 2020 2020 6163 6365 7074 6564          accepted
+00029380: 5f64 7479 7065 733d 286e 702e 696e 7436  _dtypes=(np.int6
+00029390: 342c 206e 702e 696e 7433 322c 2069 6e74  4, np.int32, int
+000293a0: 292c 0a20 2020 2020 2020 2020 2020 2061  ),.            a
+000293b0: 6363 6570 7465 645f 7368 6170 6573 3d5b  ccepted_shapes=[
+000293c0: 2878 2e73 6861 7065 5b30 5d2c 295d 2c0a  (x.shape[0],)],.
+000293d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000293e0: 2020 7265 7475 726e 2061 646a 7573 7465    return adjuste
+000293f0: 645f 6d75 7475 616c 5f69 6e66 6f5f 7363  d_mutual_info_sc
+00029400: 6f72 6528 6c61 6265 6c73 5f74 7275 653d  ore(labels_true=
+00029410: 782c 206c 6162 656c 735f 7072 6564 3d79  x, labels_pred=y
+00029420: 290a 0a0a 2320 7361 6d70 6c65 5f31 203d  )...# sample_1 =
+00029430: 206e 702e 7261 6e64 6f6d 2e72 616e 646f   np.random.rando
+00029440: 6d5f 696e 7465 6765 7273 286c 6f77 3d31  m_integers(low=1
+00029450: 2c20 6869 6768 3d32 2c20 7369 7a65 3d28  , high=2, size=(
+00029460: 3130 2c20 3530 2929 2e61 7374 7970 6528  10, 50)).astype(
+00029470: 6e70 2e66 6c6f 6174 3634 290a 2320 7361  np.float64).# sa
+00029480: 6d70 6c65 5f32 203d 206e 702e 7261 6e64  mple_2 = np.rand
+00029490: 6f6d 2e72 616e 646f 6d5f 696e 7465 6765  om.random_intege
+000294a0: 7273 286c 6f77 3d37 2c20 6869 6768 3d32  rs(low=7, high=2
+000294b0: 302c 2073 697a 653d 2831 302c 2035 3029  0, size=(10, 50)
+000294c0: 292e 6173 7479 7065 286e 702e 666c 6f61  ).astype(np.floa
+000294d0: 7436 3429 0a23 2064 6174 6120 3d20 6e70  t64).# data = np
+000294e0: 2e76 7374 6163 6b28 5b73 616d 706c 655f  .vstack([sample_
+000294f0: 312c 2073 616d 706c 655f 325d 290a 2320  1, sample_2]).# 
+00029500: 5374 6174 6973 7469 6373 2829 2e68 626f  Statistics().hbo
+00029510: 7328 6461 7461 3d64 6174 6129 0a0a 2320  s(data=data)..# 
+00029520: 7361 6d70 6c65 5f31 203d 206e 702e 7261  sample_1 = np.ra
+00029530: 6e64 6f6d 2e6e 6f72 6d61 6c28 6c6f 633d  ndom.normal(loc=
+00029540: 3130 2c20 7363 616c 653d 322c 2073 697a  10, scale=2, siz
+00029550: 653d 3130 3030 292e 6173 7479 7065 286e  e=1000).astype(n
+00029560: 702e 666c 6f61 7436 3429 0a23 2073 616d  p.float64).# sam
+00029570: 706c 655f 3220 3d20 6e70 2e72 616e 646f  ple_2 = np.rando
+00029580: 6d2e 6e6f 726d 616c 286c 6f63 3d31 322c  m.normal(loc=12,
+00029590: 2073 6361 6c65 3d32 2c20 7369 7a65 3d31   scale=2, size=1
+000295a0: 3030 3030 292e 6173 7479 7065 286e 702e  0000).astype(np.
+000295b0: 666c 6f61 7436 3429 0a0a 2320 7361 6d70  float64)..# samp
+000295c0: 6c65 5f31 203d 206e 702e 7261 6e64 6f6d  le_1 = np.random
+000295d0: 2e72 616e 6469 6e74 2830 2c20 3130 302c  .randint(0, 100,
+000295e0: 2028 3130 302c 2029 292e 6173 7479 7065   (100, )).astype
+000295f0: 286e 702e 666c 6f61 7436 3429 0a23 2073  (np.float64).# s
+00029600: 616d 706c 655f 3220 3d20 6e70 2e72 616e  ample_2 = np.ran
+00029610: 646f 6d2e 7261 6e64 696e 7428 3131 302c  dom.randint(110,
+00029620: 2032 3030 2c20 2831 3030 2c20 2929 2e61   200, (100, )).a
+00029630: 7374 7970 6528 6e70 2e66 6c6f 6174 3634  stype(np.float64
+00029640: 290a 230a 2320 5374 6174 6973 7469 6373  ).#.# Statistics
+00029650: 2829 2e6a 656e 7365 6e5f 7368 616e 6e6f  ().jensen_shanno
+00029660: 6e5f 6469 7665 7267 656e 6365 2873 616d  n_divergence(sam
+00029670: 706c 655f 313d 7361 6d70 6c65 5f31 2c20  ple_1=sample_1, 
+00029680: 7361 6d70 6c65 5f32 3d73 616d 706c 655f  sample_2=sample_
+00029690: 3229 0a                                  2).
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/feature_extraction_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/feature_extraction_mixin.py`

 * *Files 0% similar despite different names*

```diff
@@ -264,15 +264,15 @@
         Jitted helper for frame-wise analysis if animal is inside static rectangular ROI.
 
         .. image:: _static/img/inside_rectangle.png
            :width: 300
            :align: center
 
         :parameter np.ndarray bp_location:  2d numeric np.ndarray size len(frames) x 2
-        :parameter np.ndarray roi_coords: 2d numeric np.ndarray size 1x2 (top left[x, y], bottom right[x, y)
+        :parameter np.ndarray roi_coords: 2d numeric np.ndarray size 2x2 (top left[x, y], bottom right[x, y)
         :return ndarray: 2d numeric boolean np.ndarray size len(frames) x 1 with 0 representing outside the rectangle and 1 representing inside the rectangle
 
         :example:
         >>> bp_loc = np.random.randint(1, 10, size=(6, 2)).astype(np.float32)
         >>> roi_coords = np.random.randint(1, 10, size=(2, 2)).astype(np.float32)
         >>> FeatureExtractionMixin.framewise_inside_rectangle_roi(bp_location=bp_loc, roi_coords=roi_coords)
         >>> [0, 0, 0, 0, 0, 0]
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/plotting_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/plotting_mixin.py`

 * *Files 8% similar despite different names*

```diff
@@ -14,28 +14,31 @@
 import pandas as pd
 import PIL
 import plotly.graph_objs as go
 import plotly.io as pio
 import seaborn as sns
 from matplotlib import cm
 from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas
-from numba import njit
+from numba import bool_, njit, uint8
 from PIL import Image
 
 try:
     from typing import Literal
 except:
     from typing_extensions import Literal
 
 import simba
-from simba.utils.checks import (check_file_exist_and_readable,
-                                check_if_dir_exists, check_instance, check_str,
-                                check_that_column_exist, check_valid_array,
-                                check_valid_lst, check_if_valid_rgb_tuple, check_int, check_float, check_if_keys_exist_in_dict)
-from simba.utils.enums import Formats, Options, TextOptions
+from simba.utils.checks import (check_file_exist_and_readable, check_float,
+                                check_if_dir_exists,
+                                check_if_keys_exist_in_dict,
+                                check_if_valid_rgb_tuple, check_instance,
+                                check_int, check_str, check_that_column_exist,
+                                check_valid_array, check_valid_dataframe,
+                                check_valid_lst)
+from simba.utils.enums import Formats, Keys, Options, TextOptions
 from simba.utils.errors import InvalidInputError
 from simba.utils.lookups import (get_categorical_palettes, get_color_dict,
                                  get_named_colors)
 from simba.utils.printing import SimbaTimer, stdout_success
 from simba.utils.read_write import get_fn_ext, read_frm_of_video
 
 
@@ -585,532 +588,14 @@
         """
         Helper to resize image while retaining aspect ratio.
         """
 
         return imutils.resize(gantt_img, height=img_height)
 
     @staticmethod
-    def roi_feature_visualizer_mp(
-        data: pd.DataFrame,
-        text_locations: dict,
-        scalers: dict,
-        save_temp_dir: str,
-        video_meta_data: dict,
-        shape_info: dict,
-        style_attr: dict,
-        directing_viable: bool,
-        video_path: str,
-        animal_names: list,
-        tracked_bps: dict,
-        animal_bps: dict,
-        directing_data: pd.DataFrame,
-    ):
-
-        fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-        font = cv2.FONT_HERSHEY_COMPLEX
-
-        def __insert_texts(shape_info: dict, img: np.array):
-            for shape_name, shape_info in shape_info.items():
-                for animal_name in animal_names:
-                    shape_color = shape_info["Color BGR"]
-                    cv2.putText(
-                        img,
-                        text_locations[animal_name][shape_name]["in_zone_text"],
-                        text_locations[animal_name][shape_name]["in_zone_text_loc"],
-                        font,
-                        scalers["font_size"],
-                        shape_color,
-                        1,
-                    )
-                    cv2.putText(
-                        img,
-                        text_locations[animal_name][shape_name]["distance_text"],
-                        text_locations[animal_name][shape_name]["distance_text_loc"],
-                        font,
-                        scalers["font_size"],
-                        shape_color,
-                        1,
-                    )
-                    if directing_viable and style_attr["Directionality"]:
-                        cv2.putText(
-                            img,
-                            text_locations[animal_name][shape_name]["directing_text"],
-                            text_locations[animal_name][shape_name][
-                                "directing_text_loc"
-                            ],
-                            font,
-                            scalers["font_size"],
-                            shape_color,
-                            1,
-                        )
-            return img
-
-        def __insert_shapes(img: np.array, shape_info: dict):
-            for shape_name, shape_info in shape_info.items():
-                if shape_info["Shape_type"] == "Rectangle":
-                    cv2.rectangle(
-                        img,
-                        (int(shape_info["topLeftX"]), int(shape_info["topLeftY"])),
-                        (
-                            int(shape_info["Bottom_right_X"]),
-                            int(shape_info["Bottom_right_Y"]),
-                        ),
-                        shape_info["Color BGR"],
-                        int(shape_info["Thickness"]),
-                    )
-                    if style_attr["ROI_centers"]:
-                        center_cord = (
-                            (int(shape_info["topLeftX"] + (shape_info["width"] / 2))),
-                            (int(shape_info["topLeftY"] + (shape_info["height"] / 2))),
-                        )
-                        cv2.circle(
-                            img,
-                            center_cord,
-                            scalers["circle_size"],
-                            shape_info["Color BGR"],
-                            -1,
-                        )
-                    if style_attr["ROI_ear_tags"]:
-                        for tag_data in shape_info["Tags"].values():
-                            cv2.circle(
-                                img,
-                                tag_data,
-                                scalers["circle_size"],
-                                shape_info["Color BGR"],
-                                -1,
-                            )
-
-                if shape_info["Shape_type"] == "Circle":
-                    cv2.circle(
-                        img,
-                        (int(shape_info["centerX"]), int(shape_info["centerY"])),
-                        shape_info["radius"],
-                        shape_info["Color BGR"],
-                        int(shape_info["Thickness"]),
-                    )
-                    if style_attr["ROI_centers"]:
-                        cv2.circle(
-                            img,
-                            (int(shape_info["centerX"]), int(shape_info["centerY"])),
-                            scalers["circle_size"],
-                            shape_info["Color BGR"],
-                            -1,
-                        )
-                    if style_attr["ROI_ear_tags"]:
-                        for tag_data in shape_info["Tags"].values():
-                            cv2.circle(
-                                img,
-                                tag_data,
-                                scalers["circle_size"],
-                                shape_info["Color BGR"],
-                                -1,
-                            )
-
-                if shape_info["Shape_type"] == "Polygon":
-                    cv2.polylines(
-                        img,
-                        [shape_info["vertices"]],
-                        True,
-                        shape_info["Color BGR"],
-                        thickness=int(shape_info["Thickness"]),
-                    )
-                    if style_attr["ROI_centers"]:
-                        cv2.circle(
-                            img,
-                            shape_info["Tags"]["Center_tag"],
-                            scalers["circle_size"],
-                            shape_info["Color BGR"],
-                            -1,
-                        )
-                    if style_attr["ROI_ear_tags"]:
-                        for tag_data in shape_info["Tags"].values():
-                            cv2.circle(
-                                img,
-                                tuple(tag_data),
-                                scalers["circle_size"],
-                                shape_info["Color BGR"],
-                                -1,
-                            )
-
-            return img
-
-        def __insert_directing_line(
-            directing_data: pd.DataFrame,
-            shape_name: str,
-            frame_cnt: int,
-            shape_info: dict,
-            img: np.array,
-            video_name: str,
-            style_attr: dict,
-        ):
-
-            r = directing_data.loc[
-                (directing_data["Video"] == video_name)
-                & (directing_data["ROI"] == shape_name)
-                & (directing_data["Animal"] == animal_name)
-                & (directing_data["Frame"] == frame_cnt)
-            ]
-            if len(r) > 0:
-                clr = shape_info[shape_name]["Color BGR"]
-                thickness = shape_info[shape_name]["Thickness"]
-                if style_attr["Directionality_style"] == "Funnel":
-                    convex_hull_arr = (
-                        np.array(
-                            [
-                                [r["ROI_edge_1_x"], r["ROI_edge_1_y"]],
-                                [r["ROI_edge_2_x"], r["ROI_edge_2_y"]],
-                                [r["Eye_x"], r["Eye_y"]],
-                            ]
-                        )
-                        .reshape(-1, 2)
-                        .astype(int)
-                    )
-                    cv2.fillPoly(img, [convex_hull_arr], clr)
-
-                if style_attr["Directionality_style"] == "Lines":
-                    cv2.line(
-                        img,
-                        (int(r["Eye_x"]), int(r["Eye_y"])),
-                        (int(r["ROI_x"]), int(r["ROI_y"])),
-                        clr,
-                        int(thickness),
-                    )
-
-            return img
-
-        group_cnt = int(data["group"].values[0])
-        start_frm, current_frm, end_frm = data.index[0], data.index[0], data.index[-1]
-        save_path = os.path.join(save_temp_dir, "{}.mp4".format(str(group_cnt)))
-        _, video_name, _ = get_fn_ext(filepath=video_path)
-        writer = cv2.VideoWriter(
-            save_path,
-            fourcc,
-            video_meta_data["fps"],
-            (video_meta_data["width"] * 2, video_meta_data["height"]),
-        )
-
-        cap = cv2.VideoCapture(video_path)
-        cap.set(1, start_frm)
-
-        while current_frm < end_frm:
-            ret, img = cap.read()
-            img = cv2.copyMakeBorder(
-                img,
-                0,
-                0,
-                0,
-                int(video_meta_data["width"]),
-                borderType=cv2.BORDER_CONSTANT,
-                value=style_attr["Border_color"],
-            )
-            img = __insert_texts(shape_info=shape_info, img=img)
-            if style_attr["Pose_estimation"]:
-                for animal, animal_bp_name in tracked_bps.items():
-                    bp_cords = data.loc[current_frm, animal_bp_name].values
-                    cv2.circle(
-                        img,
-                        (int(bp_cords[0]), int(bp_cords[1])),
-                        0,
-                        animal_bps[animal]["colors"][0],
-                        scalers["circle_size"],
-                    )
-                    cv2.putText(
-                        img,
-                        animal,
-                        (int(bp_cords[0]), int(bp_cords[1])),
-                        font,
-                        scalers["font_size"],
-                        animal_bps[animal]["colors"][0],
-                        1,
-                    )
-
-            img = __insert_shapes(img=img, shape_info=shape_info)
-            #
-            for animal_name, shape_name in itertools.product(animal_names, shape_info):
-                in_zone_col_name = f'{shape_name} {animal_name} {"in zone"}'
-                distance_col_name = f'{shape_name} {animal_name} {"distance"}'
-                in_zone_value = str(bool(data.loc[current_frm, in_zone_col_name]))
-                distance_value = str(round(data.loc[current_frm, distance_col_name], 2))
-                cv2.putText(
-                    img,
-                    in_zone_value,
-                    text_locations[animal_name][shape_name]["in_zone_data_loc"],
-                    font,
-                    scalers["font_size"],
-                    shape_info[shape_name]["Color BGR"],
-                    1,
-                )
-                cv2.putText(
-                    img,
-                    distance_value,
-                    text_locations[animal_name][shape_name]["distance_data_loc"],
-                    font,
-                    scalers["font_size"],
-                    shape_info[shape_name]["Color BGR"],
-                    1,
-                )
-                if directing_viable and style_attr["Directionality"]:
-                    facing_col_name = "{} {} {}".format(
-                        shape_name, animal_name, "facing"
-                    )
-                    facing_value = bool(data.loc[current_frm, facing_col_name])
-                    cv2.putText(
-                        img,
-                        str(facing_value),
-                        text_locations[animal_name][shape_name]["directing_data_loc"],
-                        font,
-                        scalers["font_size"],
-                        shape_info[shape_name]["Color BGR"],
-                        1,
-                    )
-                    if facing_value:
-                        img = __insert_directing_line(
-                            directing_data=directing_data,
-                            shape_name=shape_name,
-                            frame_cnt=current_frm,
-                            shape_info=shape_info,
-                            img=img,
-                            video_name=video_name,
-                            style_attr=style_attr,
-                        )
-            writer.write(img)
-            current_frm += 1
-            print(
-                "Multi-processing video frame {} on core {}...".format(
-                    str(current_frm), str(group_cnt)
-                )
-            )
-        cap.release()
-        writer.release()
-
-        return group_cnt
-
-    @staticmethod
-    def directing_animals_mp(
-        data: pd.DataFrame,
-        directionality_data: pd.DataFrame,
-        bp_names: dict,
-        style_attr: dict,
-        save_temp_dir: str,
-        video_path: str,
-        video_meta_data: dict,
-        colors: list,
-    ):
-
-        fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-        group_cnt = int(data.iloc[0]["group"])
-        start_frm, current_frm, end_frm = data.index[0], data.index[0], data.index[-1]
-        save_path = os.path.join(save_temp_dir, "{}.mp4".format(str(group_cnt)))
-        _, video_name, _ = get_fn_ext(filepath=video_path)
-        writer = cv2.VideoWriter(
-            save_path,
-            fourcc,
-            video_meta_data["fps"],
-            (video_meta_data["width"], video_meta_data["height"]),
-        )
-        cap = cv2.VideoCapture(video_path)
-        cap.set(1, start_frm)
-        color = colors[0]
-
-        def __draw_individual_lines(animal_img_data: pd.DataFrame, img: np.array):
-            color = colors[0]
-            for cnt, (i, r) in enumerate(animal_img_data.iterrows()):
-                if style_attr["Direction_color"] == "Random":
-                    color = random.sample(colors[0], 1)[0]
-                cv2.line(
-                    img,
-                    (int(r["Eye_x"]), int(r["Eye_y"])),
-                    (int(r["Animal_2_bodypart_x"]), int(r["Animal_2_bodypart_y"])),
-                    color,
-                    style_attr["Direction_thickness"],
-                )
-                if style_attr["Highlight_endpoints"]:
-                    cv2.circle(
-                        img,
-                        (int(r["Eye_x"]), int(r["Eye_y"])),
-                        style_attr["Pose_circle_size"] + 2,
-                        color,
-                        style_attr["Pose_circle_size"],
-                    )
-                    cv2.circle(
-                        img,
-                        (int(r["Animal_2_bodypart_x"]), int(r["Animal_2_bodypart_y"])),
-                        style_attr["Pose_circle_size"] + 1,
-                        color,
-                        style_attr["Pose_circle_size"],
-                    )
-
-            return img
-
-        while current_frm < end_frm:
-            ret, img = cap.read()
-            try:
-                if ret:
-                    if style_attr["Show_pose"]:
-                        bp_data = data.loc[current_frm]
-                        for cnt, (animal_name, animal_bps) in enumerate(
-                            bp_names.items()
-                        ):
-                            for bp in zip(animal_bps["X_bps"], animal_bps["Y_bps"]):
-                                x_bp, y_bp = bp_data[bp[0]], bp_data[bp[1]]
-                                cv2.circle(
-                                    img,
-                                    (int(x_bp), int(y_bp)),
-                                    style_attr["Pose_circle_size"],
-                                    bp_names[animal_name]["colors"][cnt],
-                                    style_attr["Direction_thickness"],
-                                )
-
-                    if current_frm in list(directionality_data["Frame_#"].unique()):
-                        img_data = directionality_data[
-                            directionality_data["Frame_#"] == current_frm
-                        ]
-                        unique_animals = img_data["Animal_1"].unique()
-                        for animal in unique_animals:
-                            animal_img_data = img_data[
-                                img_data["Animal_1"] == animal
-                            ].reset_index(drop=True)
-                            if style_attr["Polyfill"]:
-                                convex_hull_arr = animal_img_data.loc[
-                                    0, ["Eye_x", "Eye_y"]
-                                ].values.reshape(-1, 2)
-                                for animal_2 in animal_img_data["Animal_2"].unique():
-                                    convex_hull_arr = np.vstack(
-                                        (
-                                            convex_hull_arr,
-                                            animal_img_data[
-                                                [
-                                                    "Animal_2_bodypart_x",
-                                                    "Animal_2_bodypart_y",
-                                                ]
-                                            ][
-                                                animal_img_data["Animal_2"] == animal_2
-                                            ].values,
-                                        )
-                                    ).astype("int")
-                                    convex_hull_arr = np.unique(convex_hull_arr, axis=0)
-                                    if convex_hull_arr.shape[0] >= 3:
-                                        if style_attr["Direction_color"] == "Random":
-                                            color = random.sample(colors[0], 1)[0]
-                                        cv2.fillPoly(img, [convex_hull_arr], color)
-                                    else:
-                                        img = __draw_individual_lines(
-                                            animal_img_data=animal_img_data, img=img
-                                        )
-
-                            else:
-                                img = __draw_individual_lines(
-                                    animal_img_data=animal_img_data, img=img
-                                )
-
-                    img = np.uint8(img)
-
-                    current_frm += 1
-                    writer.write(img)
-                    print(
-                        "Multi-processing video frame {} on core {}...".format(
-                            str(current_frm), str(group_cnt)
-                        )
-                    )
-
-                else:
-                    cap.release()
-                    writer.release()
-                    break
-
-            except IndexError:
-                cap.release()
-                writer.release()
-                break
-
-        return group_cnt
-
-    @staticmethod
-    def distance_plotter_mp(
-        data: np.array,
-        video_setting: bool,
-        frame_setting: bool,
-        video_name: str,
-        video_save_dir: str,
-        frame_folder_dir: str,
-        style_attr: dict,
-        line_attr: dict,
-        fps: int,
-    ):
-
-        group = int(data[0][0])
-        line_data = data[:, 2:]
-        color_dict = get_color_dict()
-        video_writer = None
-        if video_setting:
-            fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-            video_save_path = os.path.join(video_save_dir, "{}.mp4".format(str(group)))
-            video_writer = cv2.VideoWriter(
-                video_save_path,
-                fourcc,
-                fps,
-                (style_attr["width"], style_attr["height"]),
-            )
-
-        for i in range(line_data.shape[0]):
-            frame_id = int(data[i][1])
-            for j in range(line_data.shape[1]):
-                color = color_dict[line_attr[j][-1]][::-1]
-                color = tuple(x / 255 for x in color)
-                plt.plot(
-                    line_data[0:i, j],
-                    color=color,
-                    linewidth=style_attr["line width"],
-                    alpha=style_attr["opacity"],
-                )
-
-            x_ticks_locs = x_lbls = np.round(np.linspace(0, i, 5))
-            x_lbls = np.round((x_lbls / fps), 1)
-            plt.ylim(0, style_attr["max_y"])
-            plt.xlabel("time (s)")
-            plt.ylabel("distance (cm)")
-            plt.xticks(
-                x_ticks_locs,
-                x_lbls,
-                rotation="horizontal",
-                fontsize=style_attr["font size"],
-            )
-            plt.yticks(
-                style_attr["y_ticks_locs"],
-                style_attr["y_ticks_lbls"],
-                fontsize=style_attr["font size"],
-            )
-            plt.suptitle(
-                "Animal distances", x=0.5, y=0.92, fontsize=style_attr["font size"] + 4
-            )
-
-            buffer_ = io.BytesIO()
-            plt.savefig(buffer_, format="png")
-            buffer_.seek(0)
-            img = PIL.Image.open(buffer_)
-            img = np.uint8(cv2.cvtColor(np.asarray(img), cv2.COLOR_RGB2BGR))
-            buffer_.close()
-            plt.close()
-
-            img = cv2.resize(img, (style_attr["width"], style_attr["height"]))
-            if video_setting:
-                video_writer.write(np.uint8(img))
-            if frame_setting:
-                frm_name = os.path.join(frame_folder_dir, str(frame_id) + ".png")
-                cv2.imwrite(frm_name, np.uint8(img))
-
-            print(
-                "Distance frame created: {}, Video: {}, Processing core: {}".format(
-                    str(frame_id + 1), video_name, str(group + 1)
-                )
-            )
-
-        return group
-
-    @staticmethod
     def gantt_creator_mp(
         data: np.array,
         frame_setting: bool,
         video_setting: bool,
         video_save_dir: str,
         frame_folder_dir: str,
         bouts_df: pd.DataFrame,
@@ -1183,191 +668,14 @@
 
         if video_setting:
             video_writer.release()
 
         return group
 
     @staticmethod
-    def roi_plotter_mp(
-        data: pd.DataFrame,
-        loc_dict: dict,
-        scalers: dict,
-        video_meta_data: dict,
-        save_temp_directory: str,
-        shape_meta_data: dict,
-        video_shape_names: list,
-        input_video_path: str,
-        body_part_dict: dict,
-        roi_analyzer_data: object,
-        colors: list,
-        style_attr: dict,
-        animal_ids: list,
-        threshold: float,
-    ):
-
-        def __insert_texts(shape_df):
-            for animal_name in animal_ids:
-                for _, shape in shape_df.iterrows():
-                    shape_name, shape_color = shape["Name"], shape["Color BGR"]
-                    cv2.putText(
-                        border_img,
-                        loc_dict[animal_name][shape_name]["timer_text"],
-                        loc_dict[animal_name][shape_name]["timer_text_loc"],
-                        font,
-                        scalers["font_size"],
-                        shape_color,
-                        TextOptions.TEXT_THICKNESS.value,
-                    )
-                    cv2.putText(
-                        border_img,
-                        loc_dict[animal_name][shape_name]["entries_text"],
-                        loc_dict[animal_name][shape_name]["entries_text_loc"],
-                        font,
-                        scalers["font_size"],
-                        shape_color,
-                        TextOptions.TEXT_THICKNESS.value,
-                    )
-
-            return border_img
-
-        font = cv2.FONT_HERSHEY_TRIPLEX
-        fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-        group_cnt = int(data["group"].values[0])
-        start_frm, current_frm, end_frm = data.index[0], data.index[0], data.index[-1]
-        save_path = os.path.join(save_temp_directory, "{}.mp4".format(str(group_cnt)))
-        writer = cv2.VideoWriter(
-            save_path,
-            fourcc,
-            video_meta_data["fps"],
-            (video_meta_data["width"] * 2, video_meta_data["height"]),
-        )
-        cap = cv2.VideoCapture(input_video_path)
-        cap.set(1, start_frm)
-
-        while current_frm <= end_frm:
-            ret, img = cap.read()
-            border_img = cv2.copyMakeBorder(
-                img,
-                0,
-                0,
-                0,
-                int(video_meta_data["width"]),
-                borderType=cv2.BORDER_CONSTANT,
-                value=[0, 0, 0],
-            )
-            border_img = __insert_texts(roi_analyzer_data.video_recs)
-            border_img = __insert_texts(roi_analyzer_data.video_circs)
-            border_img = __insert_texts(roi_analyzer_data.video_polys)
-
-            for _, row in roi_analyzer_data.video_recs.iterrows():
-                top_left_x, top_left_y, shape_name = (
-                    row["topLeftX"],
-                    row["topLeftY"],
-                    row["Name"],
-                )
-                bottom_right_x, bottom_right_y = (
-                    row["Bottom_right_X"],
-                    row["Bottom_right_Y"],
-                )
-                thickness, color = row["Thickness"], row["Color BGR"]
-                cv2.rectangle(
-                    border_img,
-                    (int(top_left_x), int(top_left_y)),
-                    (int(bottom_right_x), int(bottom_right_y)),
-                    color,
-                    int(thickness),
-                )
-
-            for _, row in roi_analyzer_data.video_circs.iterrows():
-                center_x, center_y, radius, shape_name = (
-                    row["centerX"],
-                    row["centerY"],
-                    row["radius"],
-                    row["Name"],
-                )
-                thickness, color = row["Thickness"], row["Color BGR"]
-                cv2.circle(
-                    border_img, (center_x, center_y), radius, color, int(thickness)
-                )
-
-            for _, row in roi_analyzer_data.video_polys.iterrows():
-                vertices, shape_name = row["vertices"], row["Name"]
-                thickness, color = row["Thickness"], row["Color BGR"]
-                cv2.polylines(
-                    border_img, [vertices], True, color, thickness=int(thickness)
-                )
-
-            for animal_cnt, animal_name in enumerate(animal_ids):
-                if style_attr["Show_body_part"] or style_attr["Show_animal_name"]:
-                    bp_data = data.loc[current_frm, body_part_dict[animal_name]].values
-                    if threshold < bp_data[2]:
-                        if style_attr["Show_body_part"]:
-                            cv2.circle(
-                                border_img,
-                                (int(bp_data[0]), int(bp_data[1])),
-                                scalers["circle_size"],
-                                colors[animal_cnt],
-                                -1,
-                            )
-                        if style_attr["Show_animal_name"]:
-                            cv2.putText(
-                                border_img,
-                                animal_name,
-                                (int(bp_data[0]), int(bp_data[1])),
-                                font,
-                                scalers["font_size"],
-                                colors[animal_cnt],
-                                TextOptions.TEXT_THICKNESS.value,
-                            )
-
-                for shape_name in video_shape_names:
-                    timer = round(
-                        data.loc[
-                            current_frm,
-                            "{}_{}_cum_sum_time".format(animal_name, shape_name),
-                        ],
-                        2,
-                    )
-                    entries = data.loc[
-                        current_frm,
-                        "{}_{}_cum_sum_entries".format(animal_name, shape_name),
-                    ]
-                    cv2.putText(
-                        border_img,
-                        str(timer),
-                        loc_dict[animal_name][shape_name]["timer_data_loc"],
-                        font,
-                        scalers["font_size"],
-                        shape_meta_data[shape_name]["Color BGR"],
-                        TextOptions.TEXT_THICKNESS.value,
-                    )
-                    cv2.putText(
-                        border_img,
-                        str(entries),
-                        loc_dict[animal_name][shape_name]["entries_data_loc"],
-                        font,
-                        scalers["font_size"],
-                        shape_meta_data[shape_name]["Color BGR"],
-                        TextOptions.TEXT_THICKNESS.value,
-                    )
-
-            writer.write(border_img)
-            current_frm += 1
-            print(
-                "Multi-processing video frame {} on core {}...".format(
-                    str(current_frm), str(group_cnt)
-                )
-            )
-
-        cap.release()
-        writer.release()
-
-        return group_cnt
-
-    @staticmethod
     def bbox_mp(
         frm_range: list,
         polygon_data: dict,
         animal_bp_dict: dict,
         data_df: Optional[pd.DataFrame],
         intersection_data_df: Optional[pd.DataFrame],
         roi_attributes: dict,
@@ -1665,25 +973,37 @@
         figure_FSCTT.figure.set_size_inches(img_size)
         figure_FSCTT.figure.savefig(save_path, bbox_inches="tight")
         stdout_success(
             msg=f"Violin plot saved at {save_path}", source=self.__class__.__name__
         )
 
     @staticmethod
-    @njit("(uint8[:,:,:],)")
-    def rotate_img(img: np.ndarray):
+    @njit([(uint8[:, :, :], bool_)])
+    def rotate_img(img: np.ndarray, right: bool) -> np.ndarray:
         """
-        Jitted helper to flip image 90 degrees.
+        Flip a color image 90 degrees to the left or right
+
+        .. image:: _static/img/rotate_img.png
+           :width: 600
+           :align: center
+
+        :param np.ndarray img: Input image as numpy array in uint8 format.
+        :param bool right: If True, flips to the right. If False, flips to the left.
+        :returns: The rotated image as a numpy array of uint8 format.
 
         :example:
-        >>> img = cv2.imread('/Users/simon/Desktop/sliding_line_length.png')
-        >>> rotated_img = PlottingMixin().rotate_img(img)
+        >>> img = cv2.imread('/Users/simon/Desktop/test.png')
+        >>> rotated_img = PlottingMixin.rotate_img(img=img, right=False)
         """
-        rotated_image = np.transpose(img, (1, 0, 2))
-        return np.ascontiguousarray(np.fliplr(rotated_image).astype(np.uint8))
+
+        if right:
+            img = np.transpose(img[:, ::-1, :], axes=(1, 0, 2))
+        else:
+            img = np.transpose(img[::-1, :, :], axes=(1, 0, 2))
+        return np.ascontiguousarray(img).astype(np.uint8)
 
     @staticmethod
     def continuous_scatter(
         data: Union[np.ndarray, pd.DataFrame],
         columns: Optional[List[str]] = ("X", "Y", "Cluster"),
         palette: Optional[str] = "magma",
         show_box: Optional[bool] = False,
@@ -1753,15 +1073,30 @@
         columns: Optional[List[str]] = ("X", "Y", "Cluster"),
         palette: Optional[str] = "Set1",
         show_box: Optional[bool] = False,
         size: Optional[int] = 10,
         title: Optional[str] = None,
         save_path: Optional[Union[str, os.PathLike]] = None,
     ):
-        """Create a 2D scatterplot with a categorical legend"""
+        """
+        Create a 2D scatterplot with a categorical legend.
+
+        .. image:: _static/img/categorical_scatter.png
+           :width: 400
+           :align: center
+
+        :param Union[np.ndarray, pd.DataFrame] data: Input data, either a NumPy array or a pandas DataFrame.
+        :param Optional[List[str]] columns: A list of column names for the x-axis, y-axis, and the categorical variable respectively. Default is ["X", "Y", "Cluster"].
+        :param Optional[str] palette: The color palette to be used for the categorical variable. Default is "Set1".
+        :param Optional[bool] show_box: Whether to display the plot axis. Default is False.
+        :param Optional[int] size: Size of markers in the scatterplot. Default is 10.
+        :param Optional[str] title: Title for the plot. Default is None.
+        :param Optional[Union[str, os.PathLike]] save_path: The path where the plot will be saved. Default is None which returns the image.
+        :returns matplotlib.axes._subplots.AxesSubplot or None: The scatterplot if 'save_path' is not provided, otherwise None.
+        """
         cmaps = get_categorical_palettes()
         if palette not in cmaps:
             raise InvalidInputError(
                 msg=f"{palette} is not a valid palette. Accepted options: {cmaps}.",
                 source=PlottingMixin.categorical_scatter.__name__,
             )
         check_instance(
@@ -1784,18 +1119,18 @@
                 max_axis_1=len(columns),
                 min_axis_1=len(columns),
             )
             data = pd.DataFrame(data, columns=list(columns))
 
         if not show_box:
             plt.axis("off")
-        pct_x = np.percentile(data[columns[0]].values, 75)
-        pct_y = np.percentile(data[columns[1]].values, 75)
-        plt.xlim(data[columns[0]].min() - pct_x, data[columns[0]].max() + pct_x)
-        plt.ylim(data[columns[1]].min() - pct_y, data[columns[1]].max() + pct_y)
+        # pct_x = np.percentile(data[columns[0]].values, 75)
+        # pct_y = np.percentile(data[columns[1]].values, 75)
+        # plt.xlim(data[columns[0]].min() - pct_x, data[columns[0]].max() + pct_x)
+        # plt.ylim(data[columns[1]].min() - pct_y, data[columns[1]].max() + pct_y)
 
         plot = sns.scatterplot(
             data=data,
             x=columns[0],
             y=columns[1],
             hue=columns[2],
             palette=sns.color_palette(palette, len(data[columns[2]].unique())),
@@ -1822,18 +1157,35 @@
         palette: Optional[str] = "Set1",
         kind: Optional[str] = "scatter",
         size: Optional[int] = 10,
         title: Optional[str] = None,
         save_path: Optional[Union[str, os.PathLike]] = None,
     ):
         """
+        Generate a joint plot.
+
+        Useful when visualizing embedded behavior data latent spaces with dense and overlapping scatters.
+
+        .. image:: _static/img/joint_plot.png
+           :width: 700
+           :align: center
+
+        :param Union[np.ndarray, pd.DataFrame] data: Input data, either a NumPy array or a pandas DataFrame.
+        :param Optional[List[str]] columns: Names of columns if input is dataframe, default is ["X", "Y", "Cluster"].
+        :param Optional[str] palette: Palette for the plot, default is "Set1".
+        :param Optional[str] kind: Type of plot ("scatter", "kde", "hist", or "reg"), default is "scatter".
+        :param Optional[int] size: Size of markers for scatter plot, default is 10.
+        :param Optional[str] title: Title of the plot, default is None.
+        :param Optional[Union[str, os.PathLike]] save_path: Path to save the plot image, default is None.
+        :returns sns.JointGrid or None: JointGrid object if save_path is None, else None.
+
         :example:
-        >>> x = np.hstack([np.random.normal(loc=10, scale=4, size=(100, 2)), np.random.randint(0, 1, size=(100, 1))])
-        >>> y = np.hstack([np.random.normal(loc=25, scale=4, size=(100, 2)), np.random.randint(1, 2, size=(100, 1))])
-        >>> plot = PlottingMixin.joint_plot(data=np.vstack([x, y]), columns=['X', 'Y', 'Cluster'], title='The plot')
+        >>> data, lbls = make_blobs(n_samples=100000, n_features=2, centers=10, random_state=42)
+        >>> data = np.hstack((data, lbls.reshape(-1, 1)))
+        >>> PlottingMixin.joint_plot(data=data, columns=['X', 'Y', 'Cluster'], title='The plot')
         """
 
         cmaps = get_categorical_palettes()
         if palette not in cmaps:
             raise InvalidInputError(
                 msg=f"{palette} is not a valid palette. Accepted options: {cmaps}",
                 source=PlottingMixin.joint_plot.__name__,
@@ -2052,14 +1404,18 @@
         .. note::
            Plotly can be more reliable than matplotlib on some systems when accessed through multprocessing calls.
 
            If **not** called though multiprocessing, consider using ``simba.mixins.plotting_mixin.PlottingMixin.make_line_plot()``
 
            Uses ``kaleido`` for transform image to numpy array or save to disk.
 
+        .. image:: _static/img/make_line_plot_plotly.png
+           :width: 500
+           :align: center
+
         :param List[np.ndarray] data: List of 1D numpy arrays representing lines.
         :param List[str] colors: List of named colors of size len(data).
         :param bool show_box: Whether to show the plot box (axes, title, etc.).
         :param bool show_grid: Whether to show gridlines on the plot.
         :param int width: Width of the plot in pixels.
         :param int height: Height of the plot in pixels.
         :param int line_width: Width of the lines in the plot.
@@ -2152,28 +1508,29 @@
         else:
             img_bytes = fig.to_image(format="png")
             img = PIL.Image.open(io.BytesIO(img_bytes))
             fig = None
             return np.array(img).astype(np.uint8)
 
     @staticmethod
-    def make_path_plot(data: List[np.ndarray],
-                       colors: List[Tuple[int, int, int]],
-                       width: Optional[int] = 640,
-                       height: Optional[int] = 480,
-                       max_lines: Optional[int] = None,
-                       bg_clr: Optional[Union[Tuple[int, int, int], np.ndarray]] = (255, 255, 255),
-                       circle_size: Optional[Union[int, None]] = 3,
-                       font_size: Optional[float] = 2.0,
-                       font_thickness: Optional[int] = 2,
-                       line_width: Optional[int] = 2,
-                       animal_names: Optional[List[str]] = None,
-                       clf_attr: Optional[Dict[str, Any]] = None,
-                       save_path: Optional[Union[str, os.PathLike]] = None) -> Union[None, np.ndarray]:
-
+    def make_path_plot(
+        data: List[np.ndarray],
+        colors: List[Tuple[int, int, int]],
+        width: Optional[int] = 640,
+        height: Optional[int] = 480,
+        max_lines: Optional[int] = None,
+        bg_clr: Optional[Union[Tuple[int, int, int], np.ndarray]] = (255, 255, 255),
+        circle_size: Optional[Union[int, None]] = 3,
+        font_size: Optional[float] = 2.0,
+        font_thickness: Optional[int] = 2,
+        line_width: Optional[int] = 2,
+        animal_names: Optional[List[str]] = None,
+        clf_attr: Optional[Dict[str, Any]] = None,
+        save_path: Optional[Union[str, os.PathLike]] = None,
+    ) -> Union[None, np.ndarray]:
         """
         Creates a path plot visualization from the given data.
 
         .. image:: _static/img/make_path_plot.png
            :width: 500
            :align: center
 
@@ -2199,53 +1556,464 @@
         >>> position_data = np.random.randint(0, 500, (100, 2))
         >>> clf_data_1 = np.random.randint(0, 2, (100,))
         >>> clf_data_2 = np.random.randint(0, 2, (100,))
         >>> clf_data = {'Attack': {'color': (155, 1, 10), 'size': 30, 'positions': position_data, 'clfs': clf_data_1},  'Sniffing': {'color': (155, 90, 10), 'size': 30, 'positions': position_data, 'clfs': clf_data_2}}
         >>> PlottingMixin.make_path_plot(data=[x, y], colors=[(0, 255, 0), (255, 0, 0)], clf_attr=clf_data)
         """
 
-        check_valid_lst(data=data, source=PlottingMixin.make_path_plot.__name__, valid_dtypes=(np.ndarray,), min_len=1)
-        for i in data: check_valid_array(data=i, source=PlottingMixin.make_path_plot.__name__, accepted_ndims=(2,),
-                                         accepted_axis_1_shape=(2,),
-                                         accepted_dtypes=(int, float, np.int32, np.int64, np.float32, np.float64))
-        check_valid_lst(data=colors, source=PlottingMixin.make_path_plot.__name__, valid_dtypes=(tuple,), exact_len=len(data))
-        for i in colors: check_if_valid_rgb_tuple(data=i)
-        check_instance(source='bg_clr', instance=bg_clr, accepted_types=(np.ndarray, tuple))
+        check_valid_lst(
+            data=data,
+            source=PlottingMixin.make_path_plot.__name__,
+            valid_dtypes=(np.ndarray,),
+            min_len=1,
+        )
+        for i in data:
+            check_valid_array(
+                data=i,
+                source=PlottingMixin.make_path_plot.__name__,
+                accepted_ndims=(2,),
+                accepted_axis_1_shape=(2,),
+                accepted_dtypes=(
+                    int,
+                    float,
+                    np.int32,
+                    np.int64,
+                    np.float32,
+                    np.float64,
+                ),
+            )
+        check_valid_lst(
+            data=colors,
+            source=PlottingMixin.make_path_plot.__name__,
+            valid_dtypes=(tuple,),
+            exact_len=len(data),
+        )
+        for i in colors:
+            check_if_valid_rgb_tuple(data=i)
+        check_instance(
+            source="bg_clr", instance=bg_clr, accepted_types=(np.ndarray, tuple)
+        )
         if isinstance(bg_clr, tuple):
             check_if_valid_rgb_tuple(data=bg_clr)
-        check_int(name=f'{PlottingMixin.make_path_plot.__name__} height', value=height, min_value=1)
-        check_int(name=f'{PlottingMixin.make_path_plot.__name__} height', value=width, min_value=1)
-        check_float(name=f'{PlottingMixin.make_path_plot.__name__} font_size', value=font_size)
-        check_int(name=f'{PlottingMixin.make_path_plot.__name__} font_thickness', value=font_thickness)
-        check_int(name=f'{PlottingMixin.make_path_plot.__name__} line_width', value=line_width)
+        check_int(
+            name=f"{PlottingMixin.make_path_plot.__name__} height",
+            value=height,
+            min_value=1,
+        )
+        check_int(
+            name=f"{PlottingMixin.make_path_plot.__name__} height",
+            value=width,
+            min_value=1,
+        )
+        check_float(
+            name=f"{PlottingMixin.make_path_plot.__name__} font_size", value=font_size
+        )
+        check_int(
+            name=f"{PlottingMixin.make_path_plot.__name__} font_thickness",
+            value=font_thickness,
+        )
+        check_int(
+            name=f"{PlottingMixin.make_path_plot.__name__} line_width", value=line_width
+        )
         timer = SimbaTimer(start=True)
         img = np.zeros((height, width, 3))
         img[:] = bg_clr
         for line_cnt in range(len(data)):
             clr = colors[line_cnt]
             line_data = data[line_cnt]
             if max_lines is not None:
-                check_int(name=f'{PlottingMixin.make_path_plot.__name__} max_lines', value=max_lines, min_value=1)
+                check_int(
+                    name=f"{PlottingMixin.make_path_plot.__name__} max_lines",
+                    value=max_lines,
+                    min_value=1,
+                )
                 line_data = line_data[-max_lines:]
             for i in range(1, line_data.shape[0]):
-                cv2.line(img, tuple(line_data[i]), tuple(line_data[i - 1]), clr, line_width)
+                cv2.line(
+                    img, tuple(line_data[i]), tuple(line_data[i - 1]), clr, line_width
+                )
             if circle_size is not None:
                 cv2.circle(img, tuple(line_data[-1]), 0, clr, circle_size)
             if animal_names is not None:
-                cv2.putText(img, animal_names[line_cnt], tuple(line_data[-1]), cv2.FONT_HERSHEY_COMPLEX, font_size, clr,
-                            font_thickness)
+                cv2.putText(
+                    img,
+                    animal_names[line_cnt],
+                    tuple(line_data[-1]),
+                    cv2.FONT_HERSHEY_COMPLEX,
+                    font_size,
+                    clr,
+                    font_thickness,
+                )
         if clf_attr is not None:
-            check_instance(source=PlottingMixin.make_path_plot.__name__, instance=clf_attr, accepted_types=(dict,))
+            check_instance(
+                source=PlottingMixin.make_path_plot.__name__,
+                instance=clf_attr,
+                accepted_types=(dict,),
+            )
             for k, v in clf_attr.items():
-                check_if_keys_exist_in_dict(data=v, key=['color', 'size', 'positions', 'clfs'], name='clf_attr')
+                check_if_keys_exist_in_dict(
+                    data=v, key=["color", "size", "positions", "clfs"], name="clf_attr"
+                )
             for clf_name, clf_data in clf_attr.items():
-                clf_positions = clf_data['positions'][np.argwhere(clf_data['clfs'] == 1).flatten()]
+                clf_positions = clf_data["positions"][
+                    np.argwhere(clf_data["clfs"] == 1).flatten()
+                ]
                 for i in clf_positions:
-                    cv2.circle(img, tuple(i), 0, clf_data['color'], clf_data['size'])
+                    cv2.circle(img, tuple(i), 0, clf_data["color"], clf_data["size"])
         img = cv2.resize(img, (width, height)).astype(np.uint8)
         if save_path is not None:
             check_if_dir_exists(in_dir=os.path.dirname(save_path))
             timer.stop_timer()
             cv2.imwrite(save_path, img)
-            stdout_success(msg=f"Path plot saved at {save_path}", elapsed_time=timer.elapsed_time_str, source=PlottingMixin.make_path_plot.__name__, )
+            stdout_success(
+                msg=f"Path plot saved at {save_path}",
+                elapsed_time=timer.elapsed_time_str,
+                source=PlottingMixin.make_path_plot.__name__,
+            )
         else:
             return img
+
+    @staticmethod
+    def rectangles_onto_image(
+        img: np.ndarray,
+        rectangles: pd.DataFrame,
+        show_center: Optional[bool] = False,
+        show_tags: Optional[bool] = False,
+        circle_size: Optional[int] = 2,
+    ) -> np.ndarray:
+
+        check_valid_array(data=img, source=PlottingMixin.rectangles_onto_image.__name__)
+        check_valid_dataframe(
+            df=rectangles,
+            source=PlottingMixin.rectangles_onto_image.__name__,
+            required_fields=[
+                "topLeftX",
+                "topLeftY",
+                "Bottom_right_X",
+                "Bottom_right_Y",
+                "Color BGR",
+                "Thickness",
+                "Center_X",
+                "Center_Y",
+                "Tags",
+            ],
+        )
+        check_int(
+            name=PlottingMixin.rectangles_onto_image.__name__,
+            value=circle_size,
+            min_value=1,
+        )
+        for _, row in rectangles.iterrows():
+            img = cv2.rectangle(
+                img,
+                (int(row["topLeftX"]), int(row["topLeftY"])),
+                (int(row["Bottom_right_X"]), int(row["Bottom_right_Y"])),
+                row["Color BGR"],
+                int(row["Thickness"]),
+            )
+            if show_center:
+                img = cv2.circle(
+                    img,
+                    (int(row["Center_X"]), int(row["Center_Y"])),
+                    circle_size,
+                    row["Color BGR"],
+                    -1,
+                )
+            if show_tags:
+                for tag_name, tag_data in row["Tags"].items():
+                    img = cv2.circle(
+                        img, tuple(tag_data), circle_size, row["Color BGR"], -1
+                    )
+        return img
+
+    @staticmethod
+    def circles_onto_image(
+        img: np.ndarray,
+        circles: pd.DataFrame,
+        show_center: Optional[bool] = False,
+        show_tags: Optional[bool] = False,
+        circle_size: Optional[int] = 2,
+    ) -> np.ndarray:
+
+        check_valid_array(data=img, source=PlottingMixin.circles_onto_image.__name__)
+        check_valid_dataframe(
+            df=circles,
+            source=PlottingMixin.circles_onto_image.__name__,
+            required_fields=[
+                "centerX",
+                "centerY",
+                "radius",
+                "Color BGR",
+                "Thickness",
+                "Tags",
+            ],
+        )
+        check_int(
+            name=PlottingMixin.circles_onto_image.__name__,
+            value=circle_size,
+            min_value=1,
+        )
+        for _, row in circles.iterrows():
+            img = cv2.circle(
+                img,
+                (int(row["centerX"]), int(row["centerY"])),
+                row["radius"],
+                row["Color BGR"],
+                int(row["Thickness"]),
+            )
+            if show_center:
+                img = cv2.circle(
+                    img,
+                    (int(row["Center_X"]), int(row["Center_Y"])),
+                    circle_size,
+                    row["Color BGR"],
+                    -1,
+                )
+            if show_tags:
+                for tag_data in row["Tags"].values():
+                    img = cv2.circle(
+                        img, tuple(tag_data), circle_size, row["Color BGR"], -1
+                    )
+        return img
+
+    @staticmethod
+    def polygons_onto_image(
+        img: np.ndarray,
+        polygons: pd.DataFrame,
+        show_center: Optional[bool] = False,
+        show_tags: Optional[bool] = False,
+        circle_size: Optional[int] = 2,
+    ) -> np.ndarray:
+        """
+        Helper to insert polygon overlays onto an image.
+
+        :param np.ndarray img:
+        :param polygons:
+        :param show_center:
+        :param show_tags:
+        :param circle_size:
+        :return:
+        """
+
+        check_valid_array(
+            data=img, source=f"{PlottingMixin.polygons_onto_image.__name__} img"
+        )
+        check_valid_dataframe(
+            df=polygons,
+            source=f"{PlottingMixin.polygons_onto_image.__name__} polygons",
+            required_fields=[
+                "vertices",
+                "Center_X",
+                "Center_Y",
+                "Color BGR",
+                "Thickness",
+                "Tags",
+            ],
+        )
+        check_int(
+            name=PlottingMixin.polygons_onto_image.__name__,
+            value=circle_size,
+            min_value=1,
+        )
+        for _, row in polygons.iterrows():
+            img = cv2.polylines(
+                img,
+                [row["vertices"].astype(int)],
+                True,
+                row["Color BGR"],
+                thickness=int(row["Thickness"]),
+            )
+            if show_center:
+                img = cv2.circle(
+                    img,
+                    (int(row["Center_X"]), int(row["Center_Y"])),
+                    circle_size,
+                    row["Color BGR"],
+                    -1,
+                )
+            if show_tags:
+                for tag_data in row["vertices"]:
+                    img = cv2.circle(
+                        img, tuple(tag_data), circle_size, row["Color BGR"], -1
+                    )
+        return img
+
+    @staticmethod
+    def roi_dict_onto_img(
+        img: np.ndarray,
+        roi_dict: Dict[str, pd.DataFrame],
+        circle_size: Optional[int] = 2,
+        show_center: Optional[bool] = False,
+        show_tags: Optional[bool] = False,
+    ) -> np.ndarray:
+
+        check_valid_array(
+            data=img, source=f"{PlottingMixin.roi_dict_onto_img.__name__} img"
+        )
+        check_if_keys_exist_in_dict(
+            data=roi_dict,
+            key=[
+                Keys.ROI_POLYGONS.value,
+                Keys.ROI_CIRCLES.value,
+                Keys.ROI_RECTANGLES.value,
+            ],
+            name=PlottingMixin.roi_dict_onto_img.__name__,
+        )
+        img = PlottingMixin.rectangles_onto_image(
+            img=img,
+            rectangles=roi_dict[Keys.ROI_RECTANGLES.value],
+            circle_size=circle_size,
+            show_center=show_center,
+            show_tags=show_tags,
+        )
+        img = PlottingMixin.circles_onto_image(
+            img=img,
+            circles=roi_dict[Keys.ROI_CIRCLES.value],
+            circle_size=circle_size,
+            show_center=show_center,
+            show_tags=show_tags,
+        )
+        img = PlottingMixin.polygons_onto_image(
+            img=img,
+            polygons=roi_dict[Keys.ROI_POLYGONS.value],
+            circle_size=circle_size,
+            show_center=show_center,
+            show_tags=show_tags,
+        )
+        return img
+
+    @staticmethod
+    def insert_directing_line(
+        directing_df: pd.DataFrame,
+        img: np.ndarray,
+        shape_name: str,
+        animal_name: str,
+        frame_id: int,
+        color: Optional[Tuple[int]] = (0, 0, 255),
+        thickness: Optional[int] = 2,
+        style: Optional[str] = "lines",
+    ) -> np.ndarray:
+        """
+        Helper to insert lines between the actor 'eye' and the ROI centers.
+
+        :param directing_df: Dataframe containing eye and ROI locations. Stored as ``results`` in  instance of ``simba.roi_tools.ROI_directing_analyzer.DirectingROIAnalyzer``.
+        :param np.ndarray img: The image to draw the line on.
+        :param str shape_name: The name of the shape to draw the line to.
+        :param str animal_name: The name of the animal
+        :param int frame_id: The frame number in the video
+        :param Optional[Tuple[int]] color: The color of the line
+        :param Optional[int] thickness: The thickness of the line.
+        :param Optional[str] style: The style of the line. "lines" or "funnel".
+        :return np.ndarray: The input image with the line.
+        """
+
+        check_valid_array(data=img, source=PlottingMixin.insert_directing_line.__name__)
+        check_valid_dataframe(
+            df=directing_df,
+            source=PlottingMixin.rectangles_onto_image.__name__,
+            required_fields=[
+                "ROI",
+                "Animal",
+                "Frame",
+                "ROI_edge_1_x",
+                "ROI_edge_1_y",
+                "ROI_edge_2_x",
+                "ROI_edge_2_y",
+            ],
+        )
+        r = directing_df.loc[
+            (directing_df["ROI"] == shape_name)
+            & (directing_df["Animal"] == animal_name)
+            & (directing_df["Frame"] == frame_id)
+        ].reset_index(drop=True)
+        if style == "funnel":
+            convex_hull_arr = (
+                np.array(
+                    [
+                        [r["ROI_edge_1_x"], r["ROI_edge_1_y"]],
+                        [r["ROI_edge_2_x"], r["ROI_edge_2_y"]],
+                        [r["Eye_x"], r["Eye_y"]],
+                    ]
+                )
+                .reshape(-1, 2)
+                .astype(int)
+            )
+            img = cv2.fillPoly(img, [convex_hull_arr], color)
+        else:
+            img = cv2.line(
+                img,
+                (int(r["Eye_x"]), int(r["Eye_y"])),
+                (int(r["ROI_x"]), int(r["ROI_y"])),
+                color,
+                thickness,
+            )
+        return img
+
+    @staticmethod
+    def draw_lines_on_img(
+        img: np.ndarray,
+        start_positions: np.ndarray,
+        end_positions: np.ndarray,
+        color: Tuple[int, int, int],
+        highlight_endpoint: Optional[bool] = False,
+        thickness: Optional[int] = 2,
+        circle_size: Optional[int] = 2,
+    ) -> np.ndarray:
+        """
+        Helper to draw a set of lines onto an image.
+
+        :param np.ndarray img: The image to draw the lines on.
+        :param np.ndarray start_positions: 2D numpy array representing the start positions of the lines in x, y format.
+        :param np.ndarray end_positions: 2D numpy array representing the end positions of the lines in x, y format.
+        :param Tuple[int, int, int] color: The color of the lines in BGR format.
+        :param Optional[bool] highlight_endpoint: If True, highlights the ends of the lines with circles.
+        :param Optional[int] thickness: The thickness of the lines.
+        :param Optional[int] circle_size: If ``highlight_endpoint`` is True, the size of the highlighted points.
+
+        :return np.ndarray: The image with the lines overlayed.
+        """
+
+        check_valid_array(
+            data=start_positions,
+            source=f"{PlottingMixin.draw_lines_on_img.__name__} img",
+        )
+        check_valid_array(
+            data=start_positions,
+            source=f"{PlottingMixin.draw_lines_on_img.__name__} start_positions",
+            accepted_ndims=(2,),
+            accepted_dtypes=(np.int64,),
+            min_axis_0=1,
+        )
+        check_valid_array(
+            data=end_positions,
+            source=f"{PlottingMixin.draw_lines_on_img.__name__} end_positions",
+            accepted_shapes=[
+                (start_positions.shape[0], 2),
+            ],
+        )
+        check_if_valid_rgb_tuple(data=color)
+        for i in range(start_positions.shape[0]):
+            cv2.line(
+                img,
+                (start_positions[i][0], start_positions[i][1]),
+                (end_positions[i][0], end_positions[i][1]),
+                color,
+                thickness,
+            )
+            if highlight_endpoint:
+                cv2.circle(
+                    img,
+                    (end_positions[i][0], end_positions[i][1]),
+                    circle_size,
+                    color,
+                    -1,
+                )
+        return img
+
+
+# from sklearn.datasets import make_blobs
+# #from sklearn.datasets import ma
+#
+# x, lbls = make_blobs(n_samples=10000, n_features=2, centers=10, random_state=42)
+# x = np.hstack((x, lbls.reshape(-1, 1)))
+#
+# PlottingMixin.categorical_scatter(data=x, columns=('X', 'Y', 'MY CLUSTERS'), save_path='/Users/simon/Desktop/make_line_plot_plotly.png', show_box=True)
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/image_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/image_mixin.py`

 * *Files 5% similar despite different names*

```diff
@@ -531,58 +531,114 @@
         lower_thresh: Optional[int] = 20,
         upper_thresh: Optional[int] = 250,
         invert: Optional[bool] = True,
     ) -> np.ndarray:
         """
         Convert an image to black and white (binary).
 
+        .. image:: _static/img/img_to_bw.png
+           :width: 600
+           :align: center
+
+        .. note::
+           If converting multiple images from colour to black and white, consider ``simba.mixins.image_mixin.ImageMixin.img_stack_to_bw()``
+
+
         :param np.ndarray img: Input image as a NumPy array.
         :param Optional[int] lower_thresh: Lower threshold value for binary conversion. Pixels below this value become black. Default is 20.
         :param Optional[int] upper_thresh: Upper threshold value for binary conversion. Pixels above this value become white. Default is 250.
         :param Optional[bool] invert: Flag indicating whether to invert the binary image (black becomes white and vice versa). Default is True.
         :return np.ndarray: Binary black and white image.
         """
-        check_if_valid_img(
-            data=img, source=ImageMixin().segment_img_horizontal.__name__
-        )
+        check_if_valid_img(data=img, source=ImageMixin().img_to_bw.__name__)
         check_int(
-            name=f"{ImageMixin().segment_img_horizontal.__name__} lower_thresh",
+            name=f"{ImageMixin().img_to_bw.__name__} lower_thresh",
             value=lower_thresh,
             max_value=255,
             min_value=1,
         )
         check_int(
-            name=f"{ImageMixin().segment_img_horizontal.__name__} upper_thresh",
+            name=f"{ImageMixin().img_to_bw.__name__} upper_thresh",
             value=upper_thresh,
             max_value=255,
             min_value=1,
         )
         if len(img) > 2:
             img = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
         if not invert:
             return cv2.threshold(img, lower_thresh, upper_thresh, cv2.THRESH_BINARY)[1]
         else:
             return ~cv2.threshold(img, lower_thresh, upper_thresh, cv2.THRESH_BINARY)[1]
 
     @staticmethod
+    @jit(nopython=True)
+    def img_stack_to_bw(
+        imgs: np.ndarray, lower_thresh: int, upper_thresh: int, invert: bool
+    ):
+        """
+        Convert a stack of color images into black and white format.
+
+        .. note::
+           If converting a single image, consider ``simba.mixins.image_mixin.ImageMixin.img_to_bw()``
+
+        :param np.ndarray img: 4-dimensional array of color images.
+        :param Optional[int] lower_thresh: Lower threshold value for binary conversion. Pixels below this value become black. Default is 20.
+        :param Optional[int] upper_thresh: Upper threshold value for binary conversion. Pixels above this value become white. Default is 250.
+        :param Optional[bool] invert: Flag indicating whether to invert the binary image (black becomes white and vice versa). Default is True.
+        :return np.ndarray: 4-dimensional array with black and white image.
+
+        :example:
+        >>> imgs = ImageMixin.read_img_batch_from_video(video_path='/Users/simon/Downloads/3A_Mouse_5-choice_MouseTouchBasic_a1.mp4', start_frm=0, end_frm=100)
+        >>> imgs = np.stack(imgs.values(), axis=0)
+        >>> bw_imgs = ImageMixin.img_stack_to_bw(imgs=imgs, upper_thresh=255, lower_thresh=20, invert=False)
+        """
+
+        results = np.full((imgs.shape[:3]), np.nan)
+        for cnt in range(imgs.shape[0]):
+            arr = imgs[cnt]
+            m, n, _ = arr.shape
+            img_mean = np.zeros((m, n))
+            for i in range(m):
+                for j in range(n):
+                    total = 0.0
+                    for k in range(arr.shape[2]):
+                        total += arr[i, j, k]
+                    img_mean[i, j] = total / arr.shape[2]
+            img = np.where(img_mean < lower_thresh, 0, img_mean)
+            img = np.where(img > upper_thresh, 1, img)
+            if invert:
+                img = 1 - img
+            results[cnt] = img
+        return results
+
+    @staticmethod
     def segment_img_horizontal(
         img: np.ndarray,
         pct: int,
         lower: Optional[bool] = True,
         both: Optional[bool] = False,
     ) -> np.ndarray:
         """
         Segment a horizontal part of the input image.
 
         This function segments either the lower, upper, or both lower and upper part of the input image based on the specified percentage.
 
+        .. image:: _static/img/segment_img_horizontal.png
+           :width: 800
+           :align: center
+
         :param np.ndarray img: Input image as a NumPy array.
         :param int pct: Percentage of the image to be segmented. If `lower` is True, it represents the lower part; if False, it represents the upper part.
         :param Optional[bool] lower: Flag indicating whether to segment the lower part (True) or upper part (False) of the image. Default is True.
+        :param Optional[bool] both: If True, **removes** both the upper pct and lower pct and keeps middle part.
         :return np.array: Segmented part of the image.
+
+        :example:
+        >>> img = cv2.imread('/Users/simon/Desktop/test.png')
+        >>> img = ImageMixin.segment_img_horizontal(img=img, pct=10, both=True)
         """
 
         check_if_valid_img(
             data=img, source=ImageMixin().segment_img_horizontal.__name__
         )
         check_int(
             name=f"{ImageMixin().segment_img_horizontal.__name__} pct",
@@ -595,28 +651,64 @@
             return img[sliced_height : img.shape[0] - sliced_height, :]
         elif lower:
             return img[img.shape[0] - sliced_height :, :]
         else:
             return img[:sliced_height, :]
 
     @staticmethod
+    @jit(nopython=True, parallel=True)
+    def segment_img_stack_horizontal(
+        imgs: np.ndarray, pct: int, lower: bool, both: bool
+    ) -> np.ndarray:
+        """
+        Segment a horizontal part of all images in stack.
+
+        :example:
+        >>> imgs = ImageMixin.read_img_batch_from_video(video_path='/Users/simon/Downloads/3A_Mouse_5-choice_MouseTouchBasic_a1.mp4', start_frm=0, end_frm=400)
+        >>> imgs = np.stack(imgs.values(), axis=0)
+        >>> sliced_imgs = ImageMixin.segment_img_stack_horizontal(imgs=imgs, pct=50, lower=True, both=False)
+        """
+        results = []
+        for cnt in range(imgs.shape[0]):
+            img = imgs[cnt]
+            sliced_height = int(img.shape[0] * pct / 100)
+            if both:
+                sliced_img = img[sliced_height : img.shape[0] - sliced_height, :]
+            elif lower:
+                sliced_img = img[img.shape[0] - sliced_height :, :]
+            else:
+                sliced_img = img[:sliced_height, :]
+            results.append(sliced_img)
+        stacked_results = np.full(
+            (len(results), results[0].shape[0], results[0].shape[1], 3), np.nan
+        )
+        for i in prange(len(results)):
+            stacked_results[i] = results[i]
+        return results
+
+    @staticmethod
     def segment_img_vertical(
         img: np.ndarray,
         pct: int,
         left: Optional[bool] = True,
         both: Optional[bool] = False,
     ) -> np.ndarray:
         """
         Segment a vertical part of the input image.
 
         This function segments either the left, right or both the left and right part of  input image based on the specified percentage.
 
+        .. image:: _static/img/segment_img_vertical.png
+           :width: 800
+           :align: center
+
         :param np.ndarray img: Input image as a NumPy array.
         :param int pct: Percentage of the image to be segmented. If `lower` is True, it represents the lower part; if False, it represents the upper part.
         :param Optional[bool] lower: Flag indicating whether to segment the lower part (True) or upper part (False) of the image. Default is True.
+        :param Optional[bool] both: If True, **removes** both the left pct and right pct and keeps middle part.
         :return np.array: Segmented part of the image.
         """
 
         check_if_valid_img(data=img, source=ImageMixin().segment_img_vertical.__name__)
         check_int(
             name=f"{ImageMixin().segment_img_vertical.__name__} pct",
             value=pct,
@@ -732,15 +824,17 @@
     @staticmethod
     @njit([(uint8[:, :, :, :], uint8[:, :, :, :]), (uint8[:, :, :], uint8[:, :, :])])
     def img_stack_mse(imgs_1: np.ndarray, imgs_2: np.ndarray) -> np.ndarray:
         """
         Pairwise comparison of images in two stacks of equal length using mean squared errors.
 
         .. note::
-           Images has to be in uint8 format.
+           Useful for noting subtle changes, each imgs_2 equals imgs_1 with images shifted by 1. Images has to be in uint8 format.
+           Also see ``img_sliding_mse``.
+
 
         :param np.ndarray imgs_1: First three (non-color) or four (color) dimensional stack of images in array format.
         :param np.ndarray imgs_1: Second three (non-color) or four (color) dimensional stack of images in array format.
         :return np.ndarray: Array of size len(imgs_1) comparing ``imgs_1`` and ``imgs_2`` at each index using mean squared errors at each pixel location.
 
         :example:
         >>> img_1 = cv2.imread('/Users/simon/Desktop/envs/troubleshooting/khan/project_folder/videos/stitched_frames/0.png').astype(np.uint8)
@@ -903,15 +997,22 @@
             lowerBound=lower_bound,
         )[0]
 
     @staticmethod
     @jit(nopython=True)
     def img_matrix_mse(imgs: np.ndarray) -> np.ndarray:
         """
-        Jitted compute mean squared error matrix table for a stack of images.
+        Compute the mean squared error (MSE) matrix table for a stack of images.
+
+        This function calculates the MSE between each pair of images in the input array
+        and returns a symmetric matrix where each element (i, j) represents the MSE
+        between the i-th and j-th images. Useful for image similarities and anomalities.
+
+        :param np.ndarray imgs: A stack of images represented as a numpy array.
+        :return np.ndarray: The MSE matrix table.
 
         :example:
         >>> imgs = ImageMixin().read_img_batch_from_video(video_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/videos/Together_1.avi', start_frm=0, end_frm=50)
         >>> imgs = np.stack(list(imgs.values()))
         >>> ImageMixin().img_matrix_mse(imgs=imgs)
         """
         results = np.full((imgs.shape[0], imgs.shape[0]), 0.0)
@@ -926,21 +1027,25 @@
 
     @staticmethod
     @njit("(uint8[:, :, :, :],)", fastmath=True)
     def img_stack_to_greyscale(imgs: np.ndarray):
         """
         Jitted conversion of a 4D stack of color images (RGB format) to grayscale.
 
+        .. image:: _static/img/img_stack_to_greyscale.png
+           :width: 600
+           :align: center
+
         :parameter np.ndarray imgs: A 4D array representing color images. It should have the shape (num_images, height, width, 3) where the last dimension represents the color channels (R, G, B).
         :returns np.ndarray: A 3D array containing the grayscale versions of the input images. The shape of the output array is (num_images, height, width).
 
         :example:
         >>> imgs = ImageMixin().read_img_batch_from_video( video_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/videos/Together_1.avi', start_frm=0, end_frm=100)
         >>> imgs = np.stack(list(imgs.values()))
-        >>> imgs_gray = img_stack_to_greyscale(imgs=imgs)
+        >>> imgs_gray = ImageMixin.img_stack_to_greyscale(imgs=imgs)
         """
         results = np.full((imgs.shape[0], imgs.shape[1], imgs.shape[2]), np.nan).astype(
             np.uint8
         )
         for i in prange(imgs.shape[0]):
             vals = (
                 0.07 * imgs[i][:, :, 2]
@@ -1210,14 +1315,28 @@
         stdout_success(
             msg="Geometry image slicing complete.",
             elapsed_time=timer.elapsed_time_str,
             source=self.__class__.__name__,
         )
         return results
 
+    #
+    # def segment_img_horizontal(img: np.ndarray, pct: int, lower: Optional[bool] = True,
+    #                            both: Optional[bool] = False
+
+
+# img = cv2.imread('/Users/simon/Desktop/test.png')
+# img = ImageMixin.segment_img_vertical(img=img, pct=20, both=True)
+# cv2.imshow('sdsdf', img)
+# cv2.waitKey(5000)
+
+
+# bw_img = ImageMixin.img_to_bw(img=img, invert=False)
+# cv2.imshow('sdsdf', bw_img)
+# cv2.waitKey(5000)
 
 # imgs = ImageMixin().read_img_batch_from_video( video_path='/Users/simon/Desktop/envs/troubleshooting/Emergence/project_folder/videos/Example_1.mp4', start_frm=0, end_frm=10)
 # imgs = np.stack(list(imgs.values()))
 # imgs_gray = ImageMixin().img_stack_to_greyscale(imgs=imgs)
 # data = pd.read_csv('/Users/simon/Desktop/envs/troubleshooting/Emergence/project_folder/csv/outlier_corrected_movement_location/Example_1.csv', nrows=11).fillna(-1)
 # nose_array, tail_array = data.loc[0:10, ['Nose_x', 'Nose_y']].values.astype(np.float32), data.loc[0:10, ['Tail_base_x', 'Tail_base_y']].values.astype(np.float32)
 # nose_shapes, tail_shapes = [], []
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/unsupervised_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/unsupervised_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/train_model_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/train_model_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/geometry_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/geometry_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/mixins/feature_extraction_circular_mixin.py` & `Simba-UW-tf-dev-1.90.5/simba/mixins/feature_extraction_circular_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/deepethogram_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/deepethogram_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/BORIS_appender.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/BORIS_appender.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/observer_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/observer_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/boris_source_cleaner.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/boris_source_cleaner.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/tools.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/third_party_appender.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/third_party_appender.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/ethovision_import.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/ethovision_import.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/BENTO_appender.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/BENTO_appender.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/third_party_label_appenders/solomon_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/third_party_label_appenders/solomon_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_clf_statistics.py` & `Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_clf_statistics.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_analyzer.py` & `Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_analyzer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_menues.py` & `Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_menues.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_tools.py` & `Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_visualizer.py` & `Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/cue_light_tools/cue_light_movement_statistics.py` & `Simba-UW-tf-dev-1.90.5/simba/cue_light_tools/cue_light_movement_statistics.py`

 * *Files 0% similar despite different names*

```diff
@@ -68,15 +68,15 @@
             for c in ["_x", "_y", "_p"]:
                 self.bp_dict[animal].append(bp_name + c)
                 self.bp_columns.append(bp_name + c)
         print("Analyzing {} files...".format(str(len(self.files_found))))
 
         if roi_setting:
             self.roi_analyzer = ROIAnalyzer(
-                ini_path=self.config_path,
+                config_path=self.config_path,
                 data_path=os.path.join(
                     self.project_path, "csv", "outlier_corrected_movement_location"
                 ),
                 calculate_distances=False,
             )
             self.roi_analyzer.run()
             # self.entries_exits_df = pd.DataFrame.from_dict(self.roi_analyzer.detailed_df, orient='index')
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/config_creator.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/config_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/enums.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/enums.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/custom_feature_extractor.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/custom_feature_extractor.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/utils/.DS_Store`

 * *Files 4% similar despite different names*

```diff
@@ -29,23 +29,23 @@
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000200: 0000 0000 0000 0000 0000 0008 0000 000b  ................
 00000210: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00000220: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00000230: 0000 0003 7649 0000 000b 005f 005f 0070  ....vI....._._.p
+00000230: 0000 0003 9fdc 0000 000b 005f 005f 0070  ..........._._.p
 00000240: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00000250: 6d6f 4444 626c 6f62 0000 0008 96a4 54c3  moDDblob......T.
-00000260: 4dda c541 0000 000b 005f 005f 0070 0079  M..A....._._.p.y
+00000250: 6d6f 4444 626c 6f62 0000 0008 b120 2cc5  moDDblob..... ,.
+00000260: a9ec c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
 00000270: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00000280: 6444 626c 6f62 0000 0008 4c2f 2c47 3ad6  dDblob....L/,G:.
+00000280: 6444 626c 6f62 0000 0008 b120 2cc5 a9ec  dDblob..... ,...
 00000290: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000002a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
-000002b0: 636f 6d70 0000 0000 0003 f000 0000 0003  comp............
+000002b0: 636f 6d70 0000 0000 0004 2000 0000 0003  comp...... .....
 000002c0: 0063 006c 0069 6c67 3153 636f 6d70 0000  .c.l.ilg1Scomp..
 000002d0: 0000 0000 309c 0000 0003 0063 006c 0069  ....0......c.l.i
 000002e0: 6d6f 4444 626c 6f62 0000 0008 7200 dae9  moDDblob....r...
 000002f0: 04ba c541 0000 0003 0063 006c 0069 6d6f  ...A.....c.l.imo
 00000300: 6444 626c 6f62 0000 0008 7200 dae9 04ba  dDblob....r.....
 00000310: c541 0000 0003 0063 006c 0069 7068 3153  .A.....c.l.iph1S
 00000320: 636f 6d70 0000 0000 0000 6000 0000 0000  comp......`.....
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/warnings.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/warnings.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/checks.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/checks.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,28 +4,29 @@
 import glob
 import os
 import re
 import subprocess
 from pathlib import Path
 from typing import Any, Dict, Iterable, List, Optional, Tuple, Union
 
+import cv2
 import numpy as np
 import pandas as pd
 import trafaret as t
 
 from simba.utils.enums import Keys, Options, UMAPParam
 from simba.utils.errors import (ArrayError, ColumnNotFoundError,
                                 CorruptedFileError, CountError,
                                 DirectoryNotEmptyError, FFMPEGNotFoundError,
-                                FloatError, IntegerError, InvalidFilepathError,
-                                InvalidInputError, NoDataError,
-                                NoFilesFoundError, NoROIDataError,
+                                FloatError, FrameRangeError, IntegerError,
+                                InvalidFilepathError, InvalidInputError,
+                                NoDataError, NoFilesFoundError, NoROIDataError,
                                 NotDirectoryError, ParametersFileError,
                                 StringError)
-from simba.utils.warnings import NoDataFoundWarning
+from simba.utils.warnings import FrameRangeWarning, NoDataFoundWarning
 
 
 def check_file_exist_and_readable(file_path: Union[str, os.PathLike]) -> None:
     """
     Checks if a path points to a readable file.
 
     :param str file_path: Path to file on disk.
@@ -1280,7 +1281,73 @@
         dtypes = list(set([type(v) for v in x]))
         additional = [x for x in dtypes if x not in valid_dtypes]
         if len(additional) > 0:
             raise InvalidInputError(
                 msg=f"The tuple {source} has invalid data format(s) {additional}. Valid: {valid_dtypes}",
                 source=source,
             )
+
+
+def check_video_and_data_frm_count_align(
+    video: Union[str, os.PathLike, cv2.VideoCapture],
+    data: Union[str, os.PathLike, pd.DataFrame],
+    name: Optional[str] = "",
+    raise_error: Optional[bool] = True,
+) -> None:
+    """
+    Check if the frame count of a video matches the row count of a data file.
+
+    :param Union[str, os.PathLike, cv2.VideoCapture] video: Path to the video file or cv2.VideoCapture object.
+    :param Union[str, os.PathLike, pd.DataFrame] data: Path to the data file or DataFrame containing the data.
+    :param Optional[str] name: Name of the video (optional for interpretable error msgs).
+    :param Optional[bool] raise_error: Whether to raise an error if the counts don't align (default is True). If False, prints warning.
+    :return None:
+
+    :example:
+    >>> data_1 = '/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/csv/outlier_corrected_movement_location/SI_DAY3_308_CD1_PRESENT.csv'
+    >>> video_1 = '/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/frames/output/ROI_analysis/SI_DAY3_308_CD1_PRESENT.mp4'
+    >>> check_video_and_data_frm_count_align(video=video_1, data=data_1, raise_error=True)
+    """
+
+    def _count_generator(reader):
+        b = reader(1024 * 1024)
+        while b:
+            yield b
+            b = reader(1024 * 1024)
+
+    check_instance(
+        source=f"{check_video_and_data_frm_count_align.__name__} video",
+        instance=video,
+        accepted_types=(str, cv2.VideoCapture),
+    )
+    check_instance(
+        source=f"{check_video_and_data_frm_count_align.__name__} data",
+        instance=data,
+        accepted_types=(str, pd.DataFrame),
+    )
+    check_str(
+        name=f"{check_video_and_data_frm_count_align.__name__} name",
+        value=name,
+        allow_blank=True,
+    )
+    if isinstance(video, str):
+        check_file_exist_and_readable(file_path=video)
+        video = cv2.VideoCapture(video)
+    video_count = int(video.get(cv2.CAP_PROP_FRAME_COUNT))
+    if isinstance(data, str):
+        check_file_exist_and_readable(file_path=data)
+        with open(data, "rb") as fp:
+            c_generator = _count_generator(fp.raw.read)
+            data_count = (sum(buffer.count(b"\n") for buffer in c_generator)) - 1
+    else:
+        data_count = len(data)
+    if data_count != video_count:
+        if not raise_error:
+            FrameRangeWarning(
+                msg=f"The video {name} has {video_count} frames, but the associated data file for this video has {data_count} rows",
+                source=check_video_and_data_frm_count_align.__name__,
+            )
+        else:
+            raise FrameRangeError(
+                msg=f"The video {name} has {video_count} frames, but the associated data file for this video has {data_count} rows",
+                source=check_video_and_data_frm_count_align.__name__,
+            )
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/read_write.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/read_write.py`

 * *Files 1% similar despite different names*

```diff
@@ -1947,7 +1947,62 @@
     check_int(
         name=f"{seconds_to_timestamp.__name__} seconds", value=seconds, min_value=0
     )
     hours = int(seconds / 3600)
     minutes = int((seconds % 3600) / 60)
     seconds = int(seconds % 60)
     return "{:02d}:{:02d}:{:02d}".format(hours, minutes, seconds)
+
+
+def read_data_paths(
+    path: Union[str, os.PathLike],
+    default: List[Union[str, os.PathLike]],
+    default_name: Optional[str] = "",
+    file_type: Optional[str] = "csv",
+) -> List[str]:
+
+    if path is None:
+        if len(default) == 0:
+            raise NoFilesFoundError(
+                msg=f"No files in format found in {default_name}",
+                source=read_data_paths.__name__,
+            )
+        else:
+            for i in default:
+                check_file_exist_and_readable(file_path=i)
+            data_paths = default
+    elif isinstance(path, str):
+        if os.path.isfile(path):
+            check_file_exist_and_readable(file_path=path)
+            data_paths = [path]
+        elif os.path.isdir(s=path):
+            data_paths = find_files_of_filetypes_in_directory(
+                directory=path, extensions=[f".{file_type}"], raise_error=True
+            )
+            if len(data_paths) == 0:
+                raise NoFilesFoundError(
+                    msg=f"No files in format {file_type} found in {default_name}",
+                    source=read_data_paths.__name__,
+                )
+        else:
+            raise NoFilesFoundError(
+                msg=f"{path} is not a valid path string",
+                source=read_data_paths.__name__,
+            )
+    elif isinstance(path, (list, tuple)):
+        check_valid_lst(
+            data=path,
+            source=f"{read_data_paths.__name__} path",
+            valid_dtypes=(str,),
+            min_len=1,
+        )
+        data_paths = []
+        for i in path:
+            check_file_exist_and_readable(file_path=i)
+            data_paths.append(i)
+    else:
+        raise NoFilesFoundError(
+            msg=f"{type(path)} is not a valid type for path",
+            source=read_data_paths.__name__,
+        )
+
+    return data_paths
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/lookups.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/lookups.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/cli/cli_tools.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/cli/cli_tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/errors.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/errors.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/data.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/data.py`

 * *Files 2% similar despite different names*

```diff
@@ -21,21 +21,22 @@
 try:
     from typing import Literal
 except:
     from typing_extensions import Literal
 
 from simba.utils.checks import (check_file_exist_and_readable, check_float,
                                 check_if_dir_exists,
+                                check_if_keys_exist_in_dict,
                                 check_if_module_has_import,
                                 check_if_string_value_is_valid_video_timestamp,
                                 check_instance, check_int, check_str,
                                 check_that_column_exist,
                                 check_that_hhmmss_start_is_before_end,
                                 check_valid_array, check_valid_dataframe)
-from simba.utils.enums import ConfigKey, Dtypes, Options
+from simba.utils.enums import ConfigKey, Dtypes, Keys, Options
 from simba.utils.errors import (BodypartColumnNotFoundError, CountError,
                                 InvalidFileTypeError, InvalidInputError,
                                 NoFilesFoundError)
 from simba.utils.printing import stdout_success, stdout_warning
 from simba.utils.read_write import (find_video_of_file, get_fn_ext,
                                     get_video_meta_data, read_config_entry,
                                     read_config_file, read_df,
@@ -643,14 +644,49 @@
             df.to_csv(file_save_path)
             stdout_success(
                 msg=f"SIMBA COMPLETE: {file_save_path} successfully saved!",
                 source=convert_roi_definitions.__name__,
             )
 
 
+def slice_roi_dict_for_video(
+    data: Dict[str, pd.DataFrame], video_name: str
+) -> Tuple[Dict[str, pd.DataFrame], List[str]]:
+    """
+    Given a dictionary of dataframes representing different ROIs (created by ``simba.mixins.config_reader.ConfigReader.read_roi_data``),
+    retain only the ROIs belonging to the specified video.
+    """
+    check_if_keys_exist_in_dict(
+        data=data,
+        key=[
+            Keys.ROI_RECTANGLES.value,
+            Keys.ROI_CIRCLES.value,
+            Keys.ROI_POLYGONS.value,
+        ],
+        name=slice_roi_dict_for_video.__name__,
+    )
+    new_data, shape_names = {}, []
+    for k, v in data.items():
+        check_instance(
+            source=f"{slice_roi_dict_for_video.__name__} {k}",
+            instance=v,
+            accepted_types=(pd.DataFrame,),
+        )
+        check_that_column_exist(
+            df=v, column_name="Video", file_name=slice_roi_dict_for_video.__name__
+        )
+        check_that_column_exist(
+            df=v, column_name="Name", file_name=slice_roi_dict_for_video.__name__
+        )
+        v = v[v["Video"] == video_name]
+        new_data[k] = v.reset_index(drop=True)
+        shape_names.extend((list(v["Name"].unique())))
+    return new_data, shape_names
+
+
 def freedman_diaconis(data: np.array) -> (float, int):
     """
     Use Freedman-Diaconis rule to compute optimal count of histogram bins and their width.
 
     .. note::
        Can also use ``simba.utils.data.bucket_data`` passing method ``fd``.
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/utils/printing.py` & `Simba-UW-tf-dev-1.90.5/simba/utils/printing.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/SimBA_logo.ico` & `Simba-UW-tf-dev-1.90.5/simba/SimBA_logo.ico`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_processors/reorganize_keypoint.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_processors/reorganize_keypoint.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_processors/remove_keypoints.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_processors/remove_keypoints.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_processors/pose_reset.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_processors/pose_reset.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_processors/reverse_pose.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_processors/reverse_pose.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/doctests.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/doctests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_3.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/dprime.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/dprime.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/linear_fretchet.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/linear_fretchet.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/read_in_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/read_in_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324 3.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324 3.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/dunn_index.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/dunn_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/hausdorff.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/hausdorff.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/peaks.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/peaks.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2022.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2022.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/colinear_features.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/colinear_features.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/spontaneous_alternation_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/spontaneous_alternation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/horizontal_videos_concat.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/horizontal_videos_concat.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/convex_hull_3_scratch_3.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/convex_hull_3_scratch_3.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/silhouette_score.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/silhouette_score.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/two_fish_feature_extractor_040924.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/two_fish_feature_extractor_040924.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/cuda_jit.ipynb` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/cuda_jit.ipynb`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/convex_hull_scratch_1.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/convex_hull_scratch_1.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/directed_hausdorff.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/directed_hausdorff.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/shannon_diversity_index.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/shannon_diversity_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/sequential_lag_analysis.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/sequential_lag_analysis.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/wilcoxon.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/wilcoxon.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/.DS_Store`

 * *Files 4% similar despite different names*

```diff
@@ -13,23 +13,23 @@
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0000 0000 0000 0000 0000 0004 0000 000b  ................
 00000110: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00000120: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00000130: 0000 0001 1263 0000 000b 005f 005f 0070  .....c....._._.p
+00000130: 0000 0001 ecf2 0000 000b 005f 005f 0070  ..........._._.p
 00000140: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00000150: 6d6f 4444 626c 6f62 0000 0008 acfd 3341  moDDblob......3A
-00000160: c3e2 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
+00000150: 6d6f 4444 626c 6f62 0000 0008 eea0 f79b  moDDblob........
+00000160: 00d9 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
 00000170: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00000180: 6444 626c 6f62 0000 0008 acfd 3341 c3e2  dDblob......3A..
+00000180: 6444 626c 6f62 0000 0008 210d 800b fdd6  dDblob....!.....
 00000190: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000001a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
-000001b0: 636f 6d70 0000 0000 0001 5000 0000 0000  comp......P.....
+000001b0: 636f 6d70 0000 0000 0002 6000 0000 0000  comp......`.....
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/data.npy` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/data.npy`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/distances.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/distances.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_2.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/cohens_kappa.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/cohens_kappa.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/paths.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/paths.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/outliers_tietjen.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/outliers_tietjen.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/train_model.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/train_model.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/amber_tests.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/amber_tests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/line_locate_point.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/line_locate_point.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/multifrm_to_points.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/multifrm_to_points.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/two_fish_feature_extractor_040924.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/two_fish_feature_extractor_040924.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/egocentrical_aligner.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/egocentrical_aligner.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/add_body_part.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/add_body_part.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/grubbs_test.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/grubbs_test.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/slide_circ_mean.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/slide_circ_mean.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/calinski_harabasz.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/calinski_harabasz.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_feature_visualizer_example.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_feature_visualizer_example.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/spontaneuous_alternation_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/spontaneuous_alternation_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/runs_test.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/runs_test.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/pct_counts_in_top_N.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/pct_counts_in_top_N.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/total_variation_distance.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/total_variation_distance.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/crop_single_polygon.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/crop_single_polygon.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/joint_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/joint_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/clip_multiple_videos_by_frame_numbers.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/clip_multiple_videos_by_frame_numbers.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/elliptic_envelope.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/elliptic_envelope.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_definition_csvs_to_h5.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_definition_csvs_to_h5.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/add_body_part.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/add_body_part.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_feature_visualizer_example.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_feature_visualizer_example.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/sliding_crosscorrelation.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/sliding_crosscorrelation.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/count_values_in_range.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/count_values_in_range.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/roi_definition_csvs_to_h5.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/roi_definition_csvs_to_h5.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/distance_velocity.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/distance_velocity.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/graph_creator.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/graph_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/line_plot_plotly.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/line_plot_plotly.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/termite_rois.csv` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/termite_rois.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/unsupervised_lof.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/unsupervised_lof.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/siegel_tukey.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/siegel_tukey.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/berger_parker.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/berger_parker.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/isolation_forest.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/isolation_forest.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/davis_bouldin.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/davis_bouldin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/vertical_video_concatenator.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/vertical_video_concatenator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/batch_video_to_greyscale.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/batch_video_to_greyscale.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/crop_circles_pop_up.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/crop_circles_pop_up.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/heading.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/heading.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324 2.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324 2.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/mutual_exclusive.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/mutual_exclusive.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/grangercausalitytests.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/grangercausalitytests.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/multiframe_is_shape_covered.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/multiframe_is_shape_covered.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/redis.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/redis.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/video_color.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/video_color.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/graph_3d_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/graph_3d_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/video_rotator.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/video_rotator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/hartley_fmax.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/hartley_fmax.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/fix_clahe.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/fix_clahe.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/cochran_q.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/cochran_q.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/menhinicks_index.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/menhinicks_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/add_probability_cnt_features.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/add_probability_cnt_features.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/spontanous_alternations.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/spontanous_alternations.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/velocity_aggregator.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/velocity_aggregator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/make_splash.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/make_splash.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/abod.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/abod.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_5.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_5.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/simpson_diversity_index.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/simpson_diversity_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/clip_videos_by_frm.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/clip_videos_by_frm.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/piotr_120324 4.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/piotr_120324 4.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/geometry_ex.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/geometry_ex.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/time_stamp_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/time_stamp_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/line_plot.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/line_plot.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/video_rotator_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/video_rotator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/unsupervised_outliers.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/unsupervised_outliers.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/statistics_ex.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/statistics_ex.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/sliding_displacement.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/sliding_displacement.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/wald_wolfowitz.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/wald_wolfowitz.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/sliding_autoc.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/sliding_autoc.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/linestring_path.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/linestring_path.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/cronbach_alpha.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/cronbach_alpha.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/mcnamar.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/mcnamar.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/fish_feature_extractor_2023_version_4.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/fish_feature_extractor_2023_version_4.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/AmberFeatureExtractor.py.zip` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/AmberFeatureExtractor.py.zip`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/mosaic.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/mosaic.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/amber_featurizer.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/amber_featurizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/make_path_plot.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/make_path_plot.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/margalef_diversification_index.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/margalef_diversification_index.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/biweight_midcorrelation.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/biweight_midcorrelation.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/madmedianrule.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/madmedianrule.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/adjusted_rand_score.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/adjusted_rand_score.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/convex_hull_scratch_2.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/convex_hull_scratch_2.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/sandbox/plotly_gantt.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/plotly_gantt.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/directing_animals_to_bodypart_visualizer.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/directing_animals_to_bodypart_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/gantt_creator.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/gantt_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/tools/tkinter_tools.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/tools/tkinter_tools.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/ROI_plotter_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/ROI_plotter.py`

 * *Files 18% similar despite different names*

```diff
@@ -1,425 +1,263 @@
 __author__ = "Simon Nilsson"
 
-
-import functools
-import itertools
-import multiprocessing
 import os
-import platform
-from copy import deepcopy
-from pathlib import Path
-from typing import Optional, Union
+from typing import Tuple, Optional, Union, Dict, List
+import itertools
 
 import cv2
-import numpy as np
-import pandas as pd
-
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.plotting_mixin import PlottingMixin
 from simba.roi_tools.ROI_analyzer import ROIAnalyzer
-from simba.utils.data import create_color_palettes, detect_bouts
-from simba.utils.enums import Paths, TagNames, TextOptions
-from simba.utils.errors import DuplicationError, NoFilesFoundError
+from simba.utils.data import create_color_palettes, slice_roi_dict_for_video, detect_bouts
+from simba.utils.checks import check_float, check_if_keys_exist_in_dict, check_file_exist_and_readable, check_video_and_data_frm_count_align, check_valid_lst
+from simba.utils.enums import Formats, Paths, TagNames, TextOptions, Keys
+from simba.utils.errors import DuplicationError, NoFilesFoundError, CountError, BodypartColumnNotFoundError, ROICoordinatesNotFoundError
 from simba.utils.printing import SimbaTimer, log_event, stdout_success
-from simba.utils.read_write import (concatenate_videos_in_folder, get_fn_ext,
-                                    get_video_meta_data)
+from simba.utils.read_write import (get_fn_ext, get_video_meta_data)
 from simba.utils.warnings import DuplicateNamesWarning
 
-pd.options.mode.chained_assignment = None
+SHOW_BODY_PARTS = 'show_body_part'
+SHOW_ANIMAL_NAMES = 'show_animal_name'
+STYLE_KEYS = [SHOW_BODY_PARTS, SHOW_ANIMAL_NAMES]
 
 
-class ROIPlotMultiprocess(ConfigReader, PlottingMixin):
+class ROIPlot(ConfigReader):
     """
-    Visualize the ROI data (number of entries/exits, time-spent-in etc).
+    Visualize the ROI data (number of entries/exits, time-spent in ROIs etc).
 
     .. note::
        `ROI tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial_new.md>`__.
-        .. image:: _static/img/roi_visualize.png
-           :width: 400
-           :align: center
-
-    :param str config_path: Path to SimBA project config file in Configparser format
-    :param str video_path: Name of video to create ROI visualizations for
-    :param dict style_attr: User-defined visualization settings.
-    :param int core_cnt: Number of cores to use.
-
 
+       Use :meth:`simba.plotting.ROI_plotter_mp.ROIPlotMultiprocess` for improved run-time.
 
-
-    Examples
-    ----------
-    >>> roi_visualizer = ROIPlotMultiprocess(ini_path=r'MyProjectConfig', video_path="MyVideo.mp4")
-    >>> roi_visualizer.run()
+    .. image:: _static/img/ROIPlot_1.png
+       :width: 800
+       :align: center
+
+    .. image:: _static/img/ROIPlot_1.gif
+       :width: 800
+       :align: center
+
+    :param Union[str, os.PathLike] config_path: Path to SimBA project config file in Configparser format
+    :param Union[str, os.PathLike] video_path: Name of video to create ROI visualizations for
+    :param Dict[str, bool] style_attr: User-defined visualization settings.
+    :param List[str] body_parts: List of the body-parts to use as proxy for animal locations.
+    :param Optional[float] threshold: Float between 0 and 1. Body-part locations detected below this confidence threshold are filtered. Default: 0.0.
+
+    :example:
+    >>> test = ROIPlot(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/project_config.ini',
+    >>>                video_path="/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/videos/SI_DAY3_308_CD1_PRESENT.mp4",
+    >>>                body_parts=['Nose'],
+    >>>                style_attr={'show_body_part': True, 'show_animal_name': True})
+    >>> test.run()
     """
 
-    def __init__(
-        self,
-        ini_path: Union[str, os.PathLike],
-        video_path: Union[str, os.PathLike],
-        core_cnt: int,
-        style_attr: dict,
-        body_parts: Optional[dict] = None,
-        threshold: Optional[float] = None,
-    ):
-
-        ConfigReader.__init__(self, config_path=ini_path)
-        PlottingMixin.__init__(self)
-        log_event(
-            logger_name=str(__class__.__name__),
-            log_type=TagNames.CLASS_INIT.value,
-            msg=self.create_log_msg_from_init_args(locals=locals()),
-        )
-        if platform.system() == "Darwin":
-            multiprocessing.set_start_method("spawn", force=True)
-
-        settings = None
-        if body_parts:
-            settings = {"body_parts": body_parts}
-            if threshold:
-                settings["threshold"] = threshold
-            else:
-                settings["threshold"] = 0.0
-            self.animal_id_lst = list(body_parts.keys())
-        self.roi_analyzer = ROIAnalyzer(
-            ini_path=ini_path,
-            data_path="outlier_corrected_movement_location",
-            settings=settings,
-        )
-        if not body_parts:
-            self.animal_id_lst = self.roi_analyzer.multi_animal_id_list
-        if threshold:
-            self.threshold = threshold
-        else:
-            self.threshold = 0.0
-
-        self.video_path = os.path.join(self.video_dir, video_path)
+    def __init__(self,
+                 config_path: Union[str, os.PathLike],
+                 video_path: Union[str, os.PathLike],
+                 style_attr: Dict[str, bool],
+                 body_parts: List[str],
+                 threshold: Optional[float] = 0.0):
+
+        check_float(name=f'{self.__class__.__name__} threshold', value=threshold, min_value=0.0, max_value=1.0)
+        check_if_keys_exist_in_dict(data=style_attr, key=STYLE_KEYS, name=f'{self.__class__.__name__} style_attr')
+        check_file_exist_and_readable(file_path=video_path)
         _, self.video_name, _ = get_fn_ext(video_path)
-        self.core_cnt = core_cnt
-        self.roi_analyzer.files_found = [
-            os.path.join(
-                self.roi_analyzer.input_folder,
-                self.video_name + "." + self.roi_analyzer.file_type,
-            )
-        ]
-        if not os.path.isfile(self.roi_analyzer.files_found[0]):
-            raise NoFilesFoundError(
-                msg=f"SIMBA ERROR: Could not find the file at path {self.roi_analyzer.files_found[0]}. Please make sure you have corrected body-part outliers or indicated that you want to skip outlier correction",
-                source=self.__class__.__name__,
-            )
+        ConfigReader.__init__(self, config_path=config_path)
+        if not os.path.isfile(self.roi_coordinates_path):
+            raise ROICoordinatesNotFoundError(expected_file_path=self.roi_coordinates_path)
+        self.data_path = os.path.join(self.outlier_corrected_dir, f'{self.video_name}.{self.file_type}')
+        if not os.path.isfile(self.data_path):
+            raise NoFilesFoundError( msg=f"SIMBA ERROR: Could not find the file at path {self.data_path}. Make sure the data file exist to create ROI visualizations", source=self.__class__.__name__)
+        log_event(logger_name=str(__class__.__name__), log_type=TagNames.CLASS_INIT.value, msg=self.create_log_msg_from_init_args(locals=locals()))
+        check_valid_lst(data=body_parts, source=f'{self.__class__.__name__} body-parts', valid_dtypes=(str,), min_len=1)
+        if len(set(body_parts)) != len(body_parts):
+            raise DuplicationError(msg=f'All body-part entries have to be unique. Got {body_parts}', source=self.__class__.__name__)
+        for bp in body_parts:
+            if bp not in self.body_parts_lst:
+                raise BodypartColumnNotFoundError(msg=f'The body-part {bp} is not a valid body-part in the SimBA project. Options: {self.body_parts_lst}', source=self.__class__.__name__)
+
+        self.roi_analyzer = ROIAnalyzer(config_path=self.config_path, data_path=self.data_path,  detailed_bout_data=True, threshold=threshold, body_parts=body_parts)
         self.roi_analyzer.run()
         self.roi_entries_df = self.roi_analyzer.detailed_df
         self.data_df, self.style_attr = self.roi_analyzer.data_df, style_attr
-        self.out_parent_dir = os.path.join(
-            self.roi_analyzer.project_path, Paths.ROI_ANALYSIS.value
-        )
-        if not os.path.exists(self.out_parent_dir):
-            os.makedirs(self.out_parent_dir)
-        self.video_save_path = os.path.join(
-            self.out_parent_dir, self.video_name + ".mp4"
-        )
-        self.video_shapes = list(
-            itertools.chain(
-                self.roi_analyzer.video_recs["Name"].unique(),
-                self.roi_analyzer.video_circs["Name"].unique(),
-                self.roi_analyzer.video_polys["Name"].unique(),
-            )
-        )
-        if len(list(set(self.video_shapes))) != len(self.video_shapes):
-            raise DuplicationError(
-                msg="Some SIMBA ROI shapes have identical names. Please use unique names to visualize ROI data.",
-                source=self.__class__.__name__,
-            )
-        self.roi_analyzer.video_recs = self.add_missing_ROI_cols(
-            self.roi_analyzer.video_recs
-        )
-        self.roi_analyzer.video_circs = self.add_missing_ROI_cols(
-            self.roi_analyzer.video_circs
-        )
-        self.roi_analyzer.video_polys = self.add_missing_ROI_cols(
-            self.roi_analyzer.video_polys
-        )
-
-        self.shape_dicts = {}
-        for df in [
-            self.roi_analyzer.video_recs,
-            self.roi_analyzer.video_circs,
-            self.roi_analyzer.video_polys,
-        ]:
-            if not df["Name"].is_unique:
-                df = df.drop_duplicates(subset=["Name"], keep="first")
-                DuplicateNamesWarning(
-                    'Some of your ROIs with the same shape has the same names. E.g., you have two rectangles named "My rectangle". SimBA prefers ROI shapes with unique names. SimBA will keep one of the unique shape names and drop the rest.',
-                    source=self.__class__.__name__,
-                )
-            d = df.set_index("Name").to_dict(orient="index")
-            self.shape_dicts = {**self.shape_dicts, **d}
-
+        self.save_dir = os.path.join(self.project_path, Paths.ROI_ANALYSIS.value)
+        if not os.path.exists(self.save_dir): os.makedirs(self.save_dir)
+        self.video_save_path = os.path.join(self.save_dir, f"{self.video_name}.mp4")
+        self.read_roi_data()
         self.shape_columns = []
-        for animal in self.animal_id_lst:
-            for shape_name in self.video_shapes:
-                self.data_df[animal + "_" + shape_name] = 0
-                self.shape_columns.append(animal + "_" + shape_name)
+        self.roi_dict, self.shape_names = slice_roi_dict_for_video(data=self.roi_dict, video_name=self.video_name)
+        if len(self.shape_names) == 0:
+            raise CountError(msg=f'No drawn ROIs detected for video {self.video_name}, please draw ROIs on this video before visualizing ROIs', source=self.__class__.__name__)
+        self.animal_names = [self.find_animal_name_from_body_part_name(bp_name=x, bp_dict=self.animal_bp_dict) for x in body_parts]
+        for x in itertools.product(self.animal_names, self.shape_names):
+            self.data_df[f"{x[0]}_{x[1]}"] = 0; self.shape_columns.append(f"{x[0]}_{x[1]}")
         self.bp_dict = self.roi_analyzer.bp_dict
-        self.output_folder = os.path.join(
-            self.roi_analyzer.project_path, Paths.ROI_ANALYSIS.value
-        )
-        if not os.path.exists(self.output_folder):
-            os.makedirs(self.output_folder)
-        self.insert_data()
-
-    def insert_data(self):
-        self.roi_entries_dict = self.roi_entries_df[
-            ["ANIMAL", "SHAPE", "ENTRY FRAMES", "EXIT FRAMES"]
-        ].to_dict(orient="records")
-        for entry_dict in self.roi_entries_dict:
-            entry, exit = int(entry_dict["ENTRY FRAMES"]), int(
-                entry_dict["EXIT FRAMES"]
-            )
+        self.__insert_data()
+        self.video_path = video_path
+        self.cap = cv2.VideoCapture(self.video_path)
+        self.video_meta_data = get_video_meta_data(self.video_path)
+        self.threshold, self.body_parts = threshold, body_parts
+
+    def __insert_data(self):
+        roi_entries_dict = self.roi_entries_df[["ANIMAL", "SHAPE NAME", "START FRAME", "END FRAME"]].to_dict(orient="records")
+        for entry_dict in roi_entries_dict:
+            entry, exit = int(entry_dict["START FRAME"]), int(entry_dict["END FRAME"])
             entry_dict["frame_range"] = list(range(entry, exit + 1))
-            col_name = entry_dict["ANIMAL"] + "_" + entry_dict["SHAPE"]
-            self.data_df[col_name][
-                self.data_df.index.isin(entry_dict["frame_range"])
-            ] = 1
-
-    def __calc_text_locs(self):
-        self.loc_dict = {}
-        line_spacer = deepcopy(TextOptions.FIRST_LINE_SPACING.value)
-        for animal_cnt, animal_name in enumerate(self.animal_id_lst):
-            self.loc_dict[animal_name] = {}
-            for shape in self.video_shapes:
-                self.loc_dict[animal_name][shape] = {}
-                self.loc_dict[animal_name][shape]["timer_text"] = "{} {} {}".format(
-                    shape, animal_name, "timer:"
-                )
-                self.loc_dict[animal_name][shape]["entries_text"] = "{} {} {}".format(
-                    shape, animal_name, "entries:"
-                )
-                self.loc_dict[animal_name][shape]["timer_text_loc"] = (
-                    (self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value),
-                    (
-                        self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.scalers["space_size"] * line_spacer
-                    ),
-                )
-                self.loc_dict[animal_name][shape]["timer_data_loc"] = (
-                    int(self.border_img_w - (self.border_img_w / 8)),
-                    (
-                        self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.scalers["space_size"] * line_spacer
-                    ),
-                )
+            col_name =  f'{entry_dict["ANIMAL"]}_{entry_dict["SHAPE NAME"]}'
+            self.data_df[col_name][self.data_df.index.isin(entry_dict["frame_range"])] = 1
+
+    def __calc_text_locs(self) -> dict:
+        loc_dict = {}
+        line_spacer = TextOptions.FIRST_LINE_SPACING.value
+        for animal_cnt, animal_name in enumerate(self.animal_names):
+            loc_dict[animal_name] = {}
+            for shape in self.shape_names:
+                loc_dict[animal_name][shape] = {}
+                loc_dict[animal_name][shape]["timer_text"] = f"{shape} {animal_name} timer:"
+                loc_dict[animal_name][shape]["entries_text"] = f"{shape} {animal_name} entries:"
+                loc_dict[animal_name][shape]["timer_text_loc"] = ((self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value), (self.video_meta_data["height"] - (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
+                loc_dict[animal_name][shape]["timer_data_loc"] = (int(self.border_img_w - (self.border_img_w / 8)), (self.video_meta_data["height"] - (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
                 line_spacer += TextOptions.LINE_SPACING.value
-                self.loc_dict[animal_name][shape]["entries_text_loc"] = (
-                    (self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value),
-                    (
-                        self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.scalers["space_size"] * line_spacer
-                    ),
-                )
-                self.loc_dict[animal_name][shape]["entries_data_loc"] = (
-                    int(self.border_img_w - (self.border_img_w / 8)),
-                    (
-                        self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.scalers["space_size"] * line_spacer
-                    ),
-                )
+                loc_dict[animal_name][shape]["entries_text_loc"] = ((self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value), (self.video_meta_data["height"] - (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
+                loc_dict[animal_name][shape]["entries_data_loc"] = (int(self.border_img_w - (self.border_img_w / 8)), (self.video_meta_data["height"]- (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
                 line_spacer += TextOptions.LINE_SPACING.value
+        return loc_dict
 
-    def __create_counters(self):
-        self.cnt_dict = {}
-        for animal_cnt, animal_name in enumerate(self.animal_id_lst):
-            self.cnt_dict[animal_name] = {}
-            for shape in self.video_shapes:
-                self.cnt_dict[animal_name][shape] = {}
-                self.cnt_dict[animal_name][shape]["timer"] = 0
-                self.cnt_dict[animal_name][shape]["entries"] = 0
-                self.cnt_dict[animal_name][shape]["entry_status"] = False
+    def __insert_texts(self, shape_df):
+        for animal_name in self.animal_names:
+            for _, shape in shape_df.iterrows():
+                shape_name, shape_color = shape["Name"], shape["Color BGR"]
+                cv2.putText(self.border_img, self.loc_dict[animal_name][shape_name]["timer_text"], self.loc_dict[animal_name][shape_name]["timer_text_loc"], TextOptions.FONT.value, self.scalers["font_size"], shape_color, TextOptions.TEXT_THICKNESS.value)
+                cv2.putText(self.border_img, self.loc_dict[animal_name][shape_name]["entries_text"], self.loc_dict[animal_name][shape_name]["entries_text_loc"], TextOptions.FONT.value, self.scalers["font_size"], shape_color, TextOptions.TEXT_THICKNESS.value)
+
+    def __create_counters(self) -> dict:
+        cnt_dict = {}
+        for animal_cnt, animal_name in enumerate(self.animal_names):
+            cnt_dict[animal_name] = {}
+            for shape in self.shape_names:
+                cnt_dict[animal_name][shape] = {}
+                cnt_dict[animal_name][shape]["timer"] = 0
+                cnt_dict[animal_name][shape]["entries"] = 0
+                cnt_dict[animal_name][shape]["entry_status"] = False
+        return cnt_dict
 
     def __calculate_cumulative(self):
-        for animal in self.animal_id_lst:
-            for shape in self.video_shapes:
-                self.data_df["{}_{}_cum_sum_time".format(animal, shape)] = (
-                    self.data_df["{}_{}".format(animal, shape)].cumsum() / self.fps
-                )
-                roi_bouts = list(
-                    detect_bouts(
-                        data_df=self.data_df,
-                        target_lst=["{}_{}".format(animal, shape)],
-                        fps=self.fps,
-                    )["Start_frame"]
-                )
-                self.data_df["{}_{}_entry".format(animal, shape)] = 0
-                self.data_df.loc[roi_bouts, "{}_{}_entry".format(animal, shape)] = 1
-                self.data_df["{}_{}_cum_sum_entries".format(animal, shape)] = (
-                    self.data_df["{}_{}_entry".format(animal, shape)].cumsum()
-                )
-
-    def __update_video_meta_data(self):
-        new_cap = cv2.VideoCapture(self.video_path)
-        new_cap.set(1, 1)
+        for animal_name in self.animal_names:
+            for shape in self.shape_names:
+                self.data_df[f"{animal_name}_{shape}_cum_sum_time"] = (self.data_df[f"{animal_name}_{shape}"].cumsum() / self.video_meta_data['fps'])
+                roi_bouts = list(detect_bouts(data_df=self.data_df, target_lst=[f"{animal_name}_{shape}"], fps=self.video_meta_data['fps'])["Start_frame"])
+                self.data_df[f"{animal_name}_{shape}_entry"] = 0
+                self.data_df.loc[roi_bouts, f"{animal_name}_{shape}_entry"] = 1
+                self.data_df[f"{animal_name}_{shape}_cum_sum_entries"] = (self.data_df[f"{animal_name}_{shape}_entry"].cumsum())
+
+    def __create_shape_dicts(self):
+        shape_dicts = {}
+        for shape, df in self.roi_dict.items():
+            if not df["Name"].is_unique:
+                df = df.drop_duplicates(subset=["Name"], keep="first")
+                DuplicateNamesWarning(f'Some of your ROIs with the same shape ({shape}) has the same names for video {self.video_name}. E.g., you have two rectangles named "My rectangle". SimBA prefers ROI shapes with unique names. SimBA will keep one of the unique shape names and drop the rest.', source=self.__class__.__name__)
+            d = df.set_index("Name").to_dict(orient="index")
+            shape_dicts = {**shape_dicts, **d}
+        return shape_dicts
+
+    def __get_bordered_img_size(self) -> Tuple[int, int]:
+        cap = cv2.VideoCapture(self.video_path)
+        cap.set(1, 1)
         _, img = self.cap.read()
-        bordered_img = cv2.copyMakeBorder(
-            img,
-            0,
-            0,
-            0,
-            int(self.video_meta_data["width"]),
-            borderType=cv2.BORDER_CONSTANT,
-            value=[0, 0, 0],
-        )
-        self.border_img_h, self.border_img_w = (
-            bordered_img.shape[0],
-            bordered_img.shape[1],
-        )
-        new_cap.release()
+        self.base_img = cv2.copyMakeBorder(img, 0, 0, 0, int(self.video_meta_data["width"]), borderType=cv2.BORDER_CONSTANT, value=[0, 0, 0])
+        self.base_img_h, self.base_img_w = self.base_img.shape[0], self.base_img.shape[1]
+        cap.release()
+        return self.base_img_h, self.base_img_w
 
     def run(self):
-        """
-        Method to visualize ROI data. Results are stored in the `project_folder/frames/output/ROI_analysis`
-        directory of the SimBA project.
-
-        Returns
-        -------
-        None
-        """
-
         video_timer = SimbaTimer(start=True)
-        self.cap = cv2.VideoCapture(self.video_path)
-        self.video_meta_data = get_video_meta_data(self.video_path)
-        video_settings, pix_per_mm, self.fps = self.read_video_info(
-            video_name=self.video_name
-        )
-        self.space_scale, radius_scale, res_scale, font_scale = 25, 10, 1500, 0.8
         max_dim = max(self.video_meta_data["width"], self.video_meta_data["height"])
         self.scalers = {}
-        self.scalers["circle_size"] = int(
-            TextOptions.RADIUS_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / max_dim)
-        )
-        self.scalers["font_size"] = float(
-            TextOptions.FONT_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / max_dim)
-        )
-        self.scalers["space_size"] = int(
-            TextOptions.SPACE_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / max_dim)
-        )
-        color_lst = create_color_palettes(
-            self.roi_analyzer.animal_cnt, int((len(self.roi_analyzer.bp_names) / 3))
-        )[0]
-        self.temp_folder = os.path.join(self.out_parent_dir, self.video_name, "temp")
-        if not os.path.exists(self.temp_folder):
-            os.makedirs(self.temp_folder)
-        self.__update_video_meta_data()
-        self.__calc_text_locs()
-        self.__create_counters()
+        self.scalers["circle_size"] = int(TextOptions.RADIUS_SCALER.value / (TextOptions.RESOLUTION_SCALER.value / max_dim))
+        self.scalers["font_size"] = float(TextOptions.FONT_SCALER.value / (TextOptions.RESOLUTION_SCALER.value / max_dim))
+        self.scalers["space_size"] = int(TextOptions.SPACE_SCALER.value / (TextOptions.RESOLUTION_SCALER.value / max_dim))
+        color_lst = create_color_palettes(self.roi_analyzer.animal_cnt, len(self.body_parts))[0]
+        self.border_img_h, self.border_img_w = self.__get_bordered_img_size()
+        fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
+        writer = cv2.VideoWriter(self.video_save_path, fourcc, self.video_meta_data["fps"], (self.border_img_w, self.border_img_h))
+        self.loc_dict = self.__calc_text_locs()
+        self.cnt_dict = self.__create_counters()
+        self.shape_dicts = self.__create_shape_dicts()
         self.__calculate_cumulative()
+        check_video_and_data_frm_count_align(video=self.video_path, data=self.data_df, name=self.video_name, raise_error=False)
+        frame_cnt = 0
+        while self.cap.isOpened():
+            ret, img = self.cap.read()
+            if ret:
+                self.border_img = cv2.copyMakeBorder(img, 0, 0, 0, int(self.video_meta_data["width"]),  borderType=cv2.BORDER_CONSTANT, value=[0, 0, 0])
+                self.__insert_texts(self.roi_dict[Keys.ROI_RECTANGLES.value])
+                self.__insert_texts(self.roi_dict[Keys.ROI_CIRCLES.value])
+                self.__insert_texts(self.roi_dict[Keys.ROI_POLYGONS.value])
+                self.img_w_border = PlottingMixin.roi_dict_onto_img(img=self.border_img, roi_dict=self.roi_dict)
+                for animal_cnt, animal_name in enumerate(self.animal_names):
+                    bp_data = (self.data_df.loc[frame_cnt, self.bp_dict[animal_name]].fillna(0.0).values)
+                    if self.threshold < bp_data[2]:
+                        if self.style_attr[SHOW_BODY_PARTS]:
+                            cv2.circle(self.border_img, (int(bp_data[0]), int(bp_data[1])), self.scalers["circle_size"], color_lst[animal_cnt], -1)
+                        if self.style_attr[SHOW_ANIMAL_NAMES]:
+                            cv2.putText(self.border_img, animal_name, (int(bp_data[0]), int(bp_data[1])), self.font, self.scalers["font_size"], color_lst[animal_cnt], TextOptions.TEXT_THICKNESS.value)
+                for animal_cnt, animal_name in enumerate(self.animal_names):
+                    for shape in self.shape_names:
+                        time = str(round(self.data_df.loc[frame_cnt, f"{animal_name}_{shape}_cum_sum_time"], 2))
+                        entries = str(int(self.data_df.loc[frame_cnt, f"{animal_name}_{shape}_cum_sum_entries"]))
+                        cv2.putText(self.border_img, time, self.loc_dict[animal_name][shape]["timer_data_loc"], self.font, self.scalers["font_size"], self.shape_dicts[shape]["Color BGR"], TextOptions.TEXT_THICKNESS.value)
+                        cv2.putText(self.border_img, entries, self.loc_dict[animal_name][shape]["entries_data_loc"], self.font, self.scalers["font_size"], self.shape_dicts[shape]["Color BGR"], TextOptions.TEXT_THICKNESS.value)
+                writer.write(self.border_img)
+                print(f"Frame: {frame_cnt+1} / {self.video_meta_data['frame_count']}, Video: {self.video_name}.")
+                frame_cnt += 1
+            else:
+                break
+        writer.release()
+        video_timer.stop_timer()
+        stdout_success(msg=f"Video {self.video_name} created. Video saved at {self.video_save_path}", elapsed_time=video_timer.elapsed_time_str, source=self.__class__.__name__)
+
 
-        data_arr = np.array_split(self.data_df.fillna(0), self.core_cnt)
-        for df_cnt in range(len(data_arr)):
-            data_arr[df_cnt]["group"] = df_cnt
-        frm_per_core = len(data_arr[0])
-
-        print(
-            f"Creating ROI images, multiprocessing (determined chunksize: {self.multiprocess_chunksize}, cores: {self.core_cnt})..."
-        )
-        del self.roi_analyzer.logger
-        with multiprocessing.Pool(
-            self.core_cnt, maxtasksperchild=self.maxtasksperchild
-        ) as pool:
-            constants = functools.partial(
-                self.roi_plotter_mp,
-                loc_dict=self.loc_dict,
-                scalers=self.scalers,
-                video_meta_data=self.video_meta_data,
-                save_temp_directory=self.temp_folder,
-                body_part_dict=self.bp_dict,
-                input_video_path=self.video_path,
-                roi_analyzer_data=self.roi_analyzer,
-                video_shape_names=self.video_shapes,
-                colors=color_lst,
-                shape_meta_data=self.shape_dicts,
-                style_attr=self.style_attr,
-                animal_ids=self.animal_id_lst,
-                threshold=self.threshold,
-            )
-            for cnt, result in enumerate(
-                pool.imap(constants, data_arr, chunksize=self.multiprocess_chunksize)
-            ):
-                print(
-                    "Image {}/{}, Video {}...".format(
-                        str(int(frm_per_core * (result + 1))),
-                        str(len(self.data_df)),
-                        self.video_name,
-                    )
-                )
-            print("Joining {} multi-processed video...".format(self.video_name))
-            concatenate_videos_in_folder(
-                in_folder=self.temp_folder,
-                save_path=self.video_save_path,
-                video_format="mp4",
-            )
-            video_timer.stop_timer()
-            pool.terminate()
-            pool.join()
-            stdout_success(
-                msg=f"Video {self.video_name} created. Video saved in project_folder/frames/output/ROI_analysis",
-                elapsed_time=video_timer.elapsed_time_str,
-                source=self.__class__.__name__,
-            )
-
-
-#
-# test = ROIPlotMultiprocess(ini_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/project_config.ini',
-#                video_path="2022-06-20_NOB_DOT_4.mp4",
-#                core_cnt=7,
-#                style_attr={'Show_body_part': True, 'Show_animal_name': True}, body_parts={'Animal_1': 'Nose'})
+
+# test = ROIPlot(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/project_config.ini',
+#                video_path="/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/videos/2022-06-20_NOB_DOT_4.mp4",
+#                body_parts=['Nose'],
+#                style_attr={'show_body_part': True, 'show_animal_name': False})
 # test.run()
-#
 
-#
-# test = ROIPlotMultiprocess(ini_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/spontenous_alternation/project_folder/project_config.ini',
-#                video_path="F1 HAB.mp4",
-#                core_cnt=5,
-#                style_attr={'Show_body_part': True, 'Show_animal_name': True})
+
+# test = ROIPlot(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/project_config.ini',
+#                video_path="/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/videos/SI_DAY3_308_CD1_PRESENT.mp4",
+#                body_parts=['Nose'],
+#                style_attr={'show_body_part': True, 'show_animal_name': True})
 # test.run()
-#
-# get_video_meta_data(video_path='/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/frames/output/ROI_analysis/2022-06-20_NOB_DOT_4.mp4')
-# get_video_meta_data(video_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi')
 
-# test = ROIPlot(ini_path=r'/Users/simon/Desktop/troubleshooting/train_model_project/project_folder/project_config.ini', video_path=r"Together_1.avi")
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
+#                video_path="termite_test.mp4",
+#                style_attr={'Show_body_part': True, 'Show_animal_name': True})
 # test.insert_data()
 # test.visualize_ROI_data()
 
-# test = ROIPlot(ini_path=r"Z:\DeepLabCut\DLC_extract\Troubleshooting\ROI_2_animals\project_folder\project_config.ini", video_path=r"Z:\DeepLabCut\DLC_extract\Troubleshooting\ROI_2_animals\project_folder\videos\Video7.mp4")
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini', video_path="termite_test.mp4")
+# test.insert_data()
+# test.visualize_ROI_data()
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/troubleshooting/train_model_project/project_folder/project_config.ini', video_path=r"Together_1.avi")
 # test.insert_data()
 # test.visualize_ROI_data()
-#
-# test = ROIPlotMultiprocess(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                            video_path="Together_1.avi",
-#                            style_attr={'Show_body_part': True, 'Show_animal_name': False},
-#                            core_cnt=5)
-# test.run()
 
 
-# test = ROIPlotMultiprocess(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/DLC_2_Black_animals/project_folder/project_config.ini',
-#                            video_path="Together_1.avi",
-#                            style_attr={'Show_body_part': True, 'Show_animal_name': False},
-#                            core_cnt=5)
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                video_path="Together_1.avi",
+#                style_attr={'Show_body_part': True, 'Show_animal_name': False},
+#                body_parts={f'Simon': 'Ear_left_1'})
+# test.insert_data()
+# test.run()
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
+#                video_path="termite_test.mp4",
+#                style_attr={'Show_body_part': True, 'Show_animal_name': True},
+#                body_parts={f'Simon': 'Termite_1_Head_1'})
+# test.insert_data()
 # test.run()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/plotting/.DS_Store`

 * *Files 20% similar despite different names*

```diff
@@ -29,23 +29,23 @@
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000200: 0000 0000 0000 0000 0000 0008 0000 000b  ................
 00000210: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00000220: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00000230: 0000 0007 d24a 0000 000b 005f 005f 0070  .....J....._._.p
+00000230: 0000 0008 095c 0000 000b 005f 005f 0070  .....\....._._.p
 00000240: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00000250: 6d6f 4444 626c 6f62 0000 0008 f8ee 4f55  moDDblob......OU
-00000260: cbd9 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
+00000250: 6d6f 4444 626c 6f62 0000 0008 beca a727  moDDblob.......'
+00000260: 4bed c541 0000 000b 005f 005f 0070 0079  K..A....._._.p.y
 00000270: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00000280: 6444 626c 6f62 0000 0008 f8ee 4f55 cbd9  dDblob......OU..
+00000280: 6444 626c 6f62 0000 0008 26c2 5502 3ced  dDblob....&.U.<.
 00000290: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000002a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
-000002b0: 636f 6d70 0000 0000 0009 d000 0000 0005  comp............
+000002b0: 636f 6d70 0000 0000 000a 0000 0000 0005  comp............
 000002c0: 0074 006f 006f 006c 0073 6c67 3153 636f  .t.o.o.l.slg1Sco
 000002d0: 6d70 0000 0000 0000 4075 0000 0005 0074  mp......@u.....t
 000002e0: 006f 006f 006c 0073 6d6f 4444 626c 6f62  .o.o.l.smoDDblob
 000002f0: 0000 0008 cdae 4e7e 0aba c541 0000 0005  ......N~...A....
 00000300: 0074 006f 006f 006c 0073 6d6f 6444 626c  .t.o.o.l.smodDbl
 00000310: 6f62 0000 0008 cdae 4e7e 0aba c541 0000  ob......N~...A..
 00000320: 0005 0074 006f 006f 006c 0073 7068 3153  ...t.o.o.l.sph1S
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/shap_agg_stats_visualizer.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/shap_agg_stats_visualizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/gantt_creator_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/gantt_creator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_clf_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_clf_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/probability_plot_creator.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/probability_plot_creator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/circular_plotting.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/circular_plotting.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/plot_clf_results.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/plot_clf_results.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/plot_clf_results_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/plot_clf_results_mp.py`

 * *Files 0% similar despite different names*

```diff
@@ -173,15 +173,15 @@
 
 
 class PlotSklearnResultsMultiProcess(ConfigReader, TrainModelMixin, PlottingMixin):
     """
     Plot classification results on videos. Results are stored in the
     `project_folder/frames/output/sklearn_results` directory of the SimBA project.
 
-    .. seelalso::
+    .. seealso::
        `Tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-10-sklearn-visualization__.
         For non-multiptocess class, see :meth:`simba.plotting.plot_clf_results.PlotSklearnResultsSingleCore`.
 
     .. image:: _static/img/sklearn_visualization.gif
        :width: 600
        :align: center
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_location.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_location.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/probability_plot_creator_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/probability_plot_creator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/interactive_probability_grapher.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/interactive_probability_grapher.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/plot_pose_in_dir.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/plot_pose_in_dir.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/single_run_model_validation_video.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/single_run_model_validation_video.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/frame_mergerer_ffmpeg.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/frame_mergerer_ffmpeg.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/pose_plotter_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/pose_plotter_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/directing_animals_visualizer_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/ez_path_plot.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,204 +1,222 @@
 __author__ = "Simon Nilsson"
 
-import functools
-import multiprocessing
 import os
-import platform
+from copy import deepcopy
+from typing import Optional, Tuple, Union
 
 import cv2
+import numpy as np
+import pandas as pd
 
-from simba.data_processors.directing_other_animals_calculator import \
-    DirectingOtherAnimalsAnalyzer
-from simba.mixins.config_reader import ConfigReader
-from simba.mixins.plotting_mixin import PlottingMixin
-from simba.utils.checks import check_file_exist_and_readable
-from simba.utils.data import create_color_palettes
-from simba.utils.enums import Paths
-from simba.utils.lookups import get_color_dict
+from simba.utils.checks import (check_file_exist_and_readable,
+                                check_if_dir_exists, check_if_valid_rgb_tuple,
+                                check_int, check_valid_tuple)
+from simba.utils.errors import (DataHeaderError, DuplicationError,
+                                InvalidFileTypeError, InvalidInputError)
 from simba.utils.printing import SimbaTimer, stdout_success
-from simba.utils.read_write import (concatenate_videos_in_folder, get_fn_ext,
-                                    get_video_meta_data, read_df)
-from simba.utils.warnings import NoDataFoundWarning
+from simba.utils.read_write import (get_fn_ext,
+                                    get_number_of_header_columns_in_df,
+                                    get_video_meta_data, read_config_file,
+                                    read_df)
 
+H5 = ".h5"
+CSV = ".csv"
 
-class DirectingOtherAnimalsVisualizerMultiprocess(ConfigReader, PlottingMixin):
-    """
-    Class for visualizing when animals are directing towards body-parts of other animals using multiprocessing.
 
-    .. important::
-       Requires the pose-estimation data for the left ear, right ears and nose of individual animals.
+class EzPathPlot(object):
+    """
+    Create a simpler path plot for a single path in a single video.
 
     .. note::
-        `Example of expected output <https://www.youtube.com/watch?v=d6pAatreb1E&list=PLi5Vwf0hhy1R6NDQJ3U28MOUJPfl2YWYl&index=22`_.
-
-        `Tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#visualizing-data-tables`>_.
-
-        .. image:: _static/img/directing_other_animals.png
-           :width: 450
-           :align: center
-
-
-    :parameter str config_path: path to SimBA project config file in Configparser format
-    :parameter str video_name: Video to visualize directionality for in the project_folder/videos directory (e.g., ``My_video.mp4``)
-    :parameter dict style_attr: Video style attribitions (colors and sizes etc.)
-    :parameter dict core_cnt: How many cores to use to create the video.
+       For more refined / complex path plots with/without multiprocessing for inproved speed, see ``simba.plotting.path_plotter.PathPlotterSingleCore`` and ``simba.plotting.path_plotter_mp.PathPlotterMulticore``.
 
-    Examples
-    -----
-    >>> style_attr = {'Show_pose': True, 'Pose_circle_size': 3, "Direction_color": 'Random', 'Direction_thickness': 4, 'Highlight_endpoints': True}
-    >>> directing_visualizer = DirectingOtherAnimalsVisualizerMultiprocess(config_path='project_folder/project_config.ini', video_name='Testing_Video_3.mp4', style_attr=style_attr)
-    >>> directing_visualizer.run()
+    .. image:: _static/img/EzPathPlot.gif
+       :width: 500
+       :align: center
+
+    .. image:: _static/img/EzPathPlot_2.gif
+       :width: 500
+       :align: center
+
+    :param Union[str, os.PathLike] data_path: The path to the data file in H5c or CSV format containing the pose estimation coordinates.
+    :param Optional[Union[str, os.PathLike]] video_path: The path to the video file. Optional. If provided, the FPS and size is grabbed from the metadata of the video file. If None, then pass ``fps`` and ``size``.
+    :param Optional[Tuple[int, int]] size: Size of the path plot (width, height). Used if video_path is None.
+    :param Optional[int] fps: The FPS of the path plot. Used if video_path is None.
+    :param str body_part: The specific body part to plot the path for.
+    :param Optional[bool] last_frm_only: If True, creates just a single .png image representing the full path in last image in the video.
+    :param Optional[Tuple[int, int, int]] bg_color: The background color of the plot. Defaults to (255, 255, 255).
+    :param Optional[Tuple[int, int, int]] line_color: The color of the path line. Defaults to (147, 20, 255).
+    :param Optional[int] line_thickness: The thickness of the path line. Defaults to 10.
+    :param Optional[int] circle_size: The size of the circle indicating each data point. Defaults to 5.
+    :param Optional[Union[str, os.PathLike]] save_path: The location to store the path plot. If None, then use the same path as the data path with ``_line_plot`` suffix.
+
+
+    :example I:
+    >>> path_plotter = EzPathPlot(data_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/h5/Together_1DLC_resnet50_two_black_mice_DLC_052820May27shuffle1_150000_el.h5', video_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi', body_part='Mouse_1_Nose', bg_color=(255, 255, 255), line_color=(147,20,255))
+    >>> path_plotter.run()
+
+    :example II:
+    >>> path_plotter = EzPathPlot(data_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/h5/Together_1DLC_resnet50_two_black_mice_DLC_052820May27shuffle1_150000_el.h5', size=(2056, 1549), fps=30, body_part='Mouse_1_Nose', bg_color=(255, 255, 255), line_color=(147,20,255))
+    >>> path_plotter.run()
     """
 
     def __init__(
-        self, config_path: str, data_path: str, style_attr: dict, core_cnt: int
+        self,
+        data_path: Union[str, os.PathLike],
+        body_part: str,
+        bg_color: Optional[Tuple[int, int, int]] = (255, 255, 255),
+        line_color: Optional[Tuple[int, int, int]] = (147, 20, 255),
+        video_path: Optional[Union[str, os.PathLike]] = None,
+        size: Optional[Tuple[int, int]] = None,
+        fps: Optional[int] = None,
+        line_thickness: Optional[int] = 10,
+        circle_size: Optional[int] = 5,
+        last_frm_only: Optional[bool] = False,
+        save_path: Optional[Union[str, os.PathLike]] = None,
     ):
-        ConfigReader.__init__(self, config_path=config_path)
-        PlottingMixin.__init__(self)
-        if platform.system() == "Darwin":
-            multiprocessing.set_start_method("spawn", force=True)
-
-        self.data_path = data_path
-        _, self.video_name, _ = get_fn_ext(self.data_path)
-        self.direction_analyzer = DirectingOtherAnimalsAnalyzer(
-            config_path=config_path,
-            bool_tables=False,
-            summary_tables=False,
-            aggregate_statistics_tables=False,
+
+        check_file_exist_and_readable(file_path=data_path)
+        check_if_valid_rgb_tuple(data=bg_color)
+        check_if_valid_rgb_tuple(data=line_color)
+        check_int(
+            name=f"{self.__class__.__name__} line_thickness",
+            value=line_thickness,
+            min_value=1,
+        )
+        check_int(
+            name=f"{self.__class__.__name__} circle_size",
+            value=circle_size,
+            min_value=1,
         )
-        self.direction_analyzer.outlier_corrected_paths = [data_path]
-        self.direction_analyzer.run()
-        self.direction_analyzer._transpose_results_to_df()
-        self.style_attr, self.pose_colors, self.core_cnt = style_attr, [], core_cnt
-        self.colors = get_color_dict()
-        if self.style_attr["Show_pose"]:
-            self.pose_colors = create_color_palettes(
-                self.animal_cnt, int(len(self.x_cols) + 1)
+        if save_path is not None:
+            check_if_dir_exists(
+                in_dir=os.path.dirname(save_path), create_if_not_exist=True
+            )
+        if line_color == bg_color:
+            raise DuplicationError(
+                msg=f"The line and background cannot be identical - ({line_color})",
+                source=self.__class__.__name__,
+            )
+        if video_path is not None:
+            video_meta_data = get_video_meta_data(video_path=video_path)
+            self.height, self.width = int(video_meta_data["height"]), int(
+                video_meta_data["width"]
             )
-        if self.style_attr["Direction_color"] == "Random":
-            self.direction_colors = create_color_palettes(1, int(self.animal_cnt**2))
+            self.fps = int(video_meta_data["fps"])
         else:
-            self.direction_colors = [self.colors[self.style_attr["Direction_color"]]]
-        self.data_dict = self.direction_analyzer.directionality_df_dict
-        self.video_path = self.find_video_of_file(self.video_dir, self.video_name)
-        self.save_directory = os.path.join(
-            self.project_path, Paths.DIRECTING_BETWEEN_ANIMALS_OUTPUT_PATH.value
-        )
-        if not os.path.exists(self.save_directory):
-            os.makedirs(self.save_directory)
-        self.data_path = os.path.join(
-            self.outlier_corrected_dir, self.video_name + "." + self.file_type
-        )
-        check_file_exist_and_readable(file_path=self.data_path)
-        print(f"Processing video {self.video_name}...")
-
-    def run(self):
-        """
-        Method to create directionality videos. Results are stored in
-        the `project_folder/frames/output/ROI_directionality_visualize` directory of the SimBA project
-
-        Returns
-        ----------
-        None
-        """
-
-        self.data_df = read_df(self.data_path, file_type=self.file_type).fillna(0)
-        self.save_path = os.path.join(self.save_directory, self.video_name + ".mp4")
-        self.save_temp_path = os.path.join(self.save_directory, "temp")
-        if os.path.exists(self.save_temp_path):
-            self.remove_a_folder(folder_dir=self.save_temp_path)
-        os.makedirs(self.save_temp_path)
-        self.cap = cv2.VideoCapture(self.video_path)
-        self.video_meta_data = get_video_meta_data(self.video_path)
-        self.video_data = self.data_dict[self.video_name]
-        if self.video_name in list(self.video_data["Video"]):
-            self.__create_video()
+            if (size is None) or (fps is None):
+                raise InvalidInputError(
+                    msg="If video path is None, then pass size and fps",
+                    source=self.__class__.__name__,
+                )
+            check_valid_tuple(
+                x=size,
+                source=f"{self.__class__.__name__} size",
+                accepted_lengths=(2,),
+                valid_dtypes=(int,),
+            )
+            self.height, self.width = size[1], size[0]
+            check_int(name=f"{self.__class__.__name__} fps", value=fps, min_value=1)
+            self.fps = int(fps)
+        dir, file_name, ext = get_fn_ext(filepath=data_path)
+        if ext.lower() == H5:
+            self.data = pd.read_hdf(data_path)
+            headers = []
+            if len(self.data.columns[0]) == 4:
+                for c in self.data.columns:
+                    headers.append("{}_{}_{}".format(c[1], c[2], c[3]))
+            elif len(self.data.columns[0]) == 3:
+                for c in self.data.columns:
+                    headers.append("{}_{}".format(c[2], c[3]))
+            self.data.columns = headers
+        elif ext.lower() == CSV:
+            self.data = pd.read_csv(data_path)
         else:
-            NoDataFoundWarning(
-                msg=f"SimBA skipping video {self.video_name}: No animals are directing each other in the video."
+            raise InvalidFileTypeError(
+                msg=f"File type {ext} is not supported (OPTIONS: h5 or csv)"
             )
-
-    def __create_video(self):
-        video_timer = SimbaTimer(start=True)
-        data_arr, frm_per_core = self.split_and_group_df(
-            df=self.data_df, splits=self.core_cnt, include_split_order=True
+        if len(self.data.columns[0]) == 4:
+            self.data = self.data.loc[3:]
+        elif len(self.data.columns[0]) == 3:
+            self.data = self.data.loc[2:]
+        body_parts_available = list(set([x[:-2] for x in self.data.columns]))
+        if body_part not in body_parts_available:
+            raise DataHeaderError(
+                msg=f"Body-part {body_part} is not present in the data file. The body-parts available are: {body_parts_available}",
+                source=self.__class__.__name__,
+            )
+        bps = [f"{body_part}_x", f"{body_part}_y"]
+        if (bps[0] not in self.data.columns) or (bps[1] not in self.data.columns):
+            raise DataHeaderError(
+                msg=f"Could not finc column {bps[0]} and/or column {bps[1]} in the data file {data_path}",
+                source=self.__class__.__name__,
+            )
+        self.data = (
+            self.data[bps]
+            .fillna(method="ffill")
+            .astype(int)
+            .reset_index(drop=True)
+            .values
         )
-        print(
-            "Creating directing images, multiprocessing (determined chunksize: {}, cores: {})...".format(
-                str(self.multiprocess_chunksize), str(self.core_cnt)
-            )
+        if (save_path is None) and (not last_frm_only):
+            self.save_name = os.path.join(dir, f"{file_name}_line_plot.mp4")
+        elif (save_path is None) and (last_frm_only):
+            self.save_name = os.path.join(dir, f"{file_name}_line_plot.png")
+        else:
+            self.save_name = save_path
+        self.bg_img = np.zeros([self.height, self.width, 3])
+        self.bg_img[:] = [bg_color]
+        self.line_color, self.line_thickness, self.circle_size, self.last_frm = (
+            line_color,
+            line_thickness,
+            circle_size,
+            last_frm_only,
         )
-        with multiprocessing.Pool(
-            self.core_cnt, maxtasksperchild=self.maxtasksperchild
-        ) as pool:
-            constants = functools.partial(
-                self.directing_animals_mp,
-                directionality_data=self.video_data,
-                video_meta_data=self.video_meta_data,
-                style_attr=self.style_attr,
-                save_temp_dir=self.save_temp_path,
-                video_path=self.video_path,
-                bp_names=self.animal_bp_dict,
-                colors=self.direction_colors,
-            )
-            for cnt, result in enumerate(
-                pool.imap(constants, data_arr, chunksize=self.multiprocess_chunksize)
-            ):
-                print(
-                    "Image {}/{}, Video {}...".format(
-                        str(int(frm_per_core * (result + 1))),
-                        str(len(self.data_df)),
-                        self.video_name,
+        self.timer = SimbaTimer(start=True)
+
+    def run(self):
+        if not self.last_frm:
+            self.writer = cv2.VideoWriter(
+                self.save_name, 0x7634706D, self.fps, (self.width, self.height)
+            )
+            for i in range(1, self.data.shape[0] + 1):
+                line_data = self.data[: i + 1]
+                img = deepcopy(self.bg_img)
+                for j in range(1, line_data.shape[0]):
+                    x1, y1 = line_data[j - 1][0], line_data[j - 1][1]
+                    x2, y2 = line_data[j][0], line_data[j][1]
+                    cv2.line(
+                        img, (x1, y1), (x2, y2), self.line_color, self.line_thickness
                     )
+                cv2.circle(
+                    img,
+                    (line_data[-1][0], line_data[-1][1]),
+                    self.circle_size,
+                    self.line_color,
+                    -1,
                 )
-
-            concatenate_videos_in_folder(
-                in_folder=self.save_temp_path,
-                save_path=self.save_path,
-                video_format="mp4",
-            )
-            video_timer.stop_timer()
-            pool.terminate()
-            pool.join()
-            self.timer.stop_timer()
-            stdout_success(
-                msg=f"Video {self.video_name} created. Video saved at {self.save_path}",
-                elapsed_time=self.timer.elapsed_time_str,
-            )
+                self.writer.write(img.astype(np.uint8))
+                print(f"Frame {i}/{len(self.data)} complete...")
+            self.writer.release()
+        else:
+            img = deepcopy(self.bg_img)
+            for j in range(1, self.data.shape[0]):
+                x1, y1 = self.data[j - 1][0], self.data[j - 1][1]
+                x2, y2 = self.data[j][0], self.data[j][1]
+                cv2.line(img, (x1, y1), (x2, y2), self.line_color, self.line_thickness)
+            cv2.imwrite(filename=self.save_name, img=img)
+        self.timer.stop_timer()
+        stdout_success(
+            msg=f"Path plot saved at {self.save_name}",
+            elapsed_time=self.timer.elapsed_time_str,
+        )
 
 
-# style_attr = {'Show_pose': True,
-#               'Pose_circle_size': 4,
-#               "Direction_color": 'Random',
-#               'Direction_thickness': 5,
-#               'Highlight_endpoints': True,
-#               'Polyfill': False}
-# test = DirectingOtherAnimalsVisualizerMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/khan/project_folder/project_config.ini',
-#                                                    data_path='/Users/simon/Desktop/envs/troubleshooting/khan/project_folder/csv/outlier_corrected_movement_location/stitched.csv',
-#                                                    style_attr=style_attr,
-#                                                    core_cnt=5)
-#
-# test.run()
-
-
-# style_attr = {'Show_pose': True,
-#               'Pose_circle_size': 3,
-#               "Direction_color": 'Random',
-#               'Direction_thickness': 4,
-#               'Highlight_endpoints': True,
-#               'Polyfill': True}
-# test = DirectingOtherAnimalsVisualizerMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/sleap_5_animals/project_folder/project_config.ini',
-#                                                    data_path='/Users/simon/Desktop/envs/troubleshooting/sleap_5_animals/project_folder/csv/outlier_corrected_movement_location/Testing_Video_3.csv',
-#                                                    style_attr=style_attr,
-#                                                    core_cnt=5)
-#
-# test.run()
-
-
-# style_attr = {'Show_pose': True, 'Pose_circle_size': 3, "Direction_color": 'Random', 'Direction_thickness': 4, 'Highlight_endpoints': True, 'Polyfill': True}
-# test = DirectingOtherAnimalsVisualizerMultiprocess(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                                        data_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/outlier_corrected_movement_location/Together_1.csv',
-#                                        style_attr=style_attr,
-#                                                    core_cnt=5)
-#
-# test.run()
+# path_plotter = EzPathPlot(data_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/h5/Together_1DLC_resnet50_two_black_mice_DLC_052820May27shuffle1_150000_el.h5',
+#                           size=(2056, 1549),
+#                           fps=30,
+#                           body_part='Mouse_1_Nose',
+#                           bg_color=(255, 255, 255),
+#                           last_frm_only=False,
+#                           line_color=(147,20,255))
+# path_plotter.run()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/clf_validator.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/clf_validator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/path_plotter_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/path_plotter_mp.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,92 +1,109 @@
 __author__ = "Simon Nilsson"
 
 import functools
 import multiprocessing
 import os
 import platform
 from copy import deepcopy
-from typing import Dict, List, Optional, Union, Any, Tuple
+from typing import Any, Dict, List, Optional, Tuple, Union
+
 import cv2
 import numpy as np
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.plotting_mixin import PlottingMixin
 from simba.utils.checks import (check_file_exist_and_readable,
                                 check_if_keys_exist_in_dict,
-                                check_if_valid_rgb_str, check_int,
-                                check_that_column_exist, check_valid_lst, check_instance)
+                                check_if_valid_rgb_str, check_instance,
+                                check_int, check_that_column_exist,
+                                check_valid_lst)
 from simba.utils.data import find_frame_numbers_from_time_stamp
 from simba.utils.enums import Formats, TagNames
 from simba.utils.errors import FrameRangeError, NoSpecifiedOutputError
 from simba.utils.printing import SimbaTimer, log_event, stdout_success
 from simba.utils.read_write import (concatenate_videos_in_folder,
                                     find_core_cnt, find_video_of_file,
                                     get_fn_ext, get_video_meta_data, read_df,
                                     read_frm_of_video, remove_a_folder)
-from simba.mixins.plotting_mixin import PlottingMixin
 
 
-def path_plot_mp(frm_rng: np.ndarray,
-                 data: np.array,
-                 colors: List[Tuple],
-                 video_setting: bool,
-                 frame_setting: bool,
-                 video_save_dir: str,
-                 video_name: str,
-                 frame_folder_dir: str,
-                 style_attr: dict,
-                 animal_names: Union[None, List[str]],
-                 fps: int,
-                 clf_attr: dict,
-                 input_style_attr: dict,
-                 video_path: Optional[Union[str, os.PathLike]] = None):
+def path_plot_mp(
+    frm_rng: np.ndarray,
+    data: np.array,
+    colors: List[Tuple],
+    video_setting: bool,
+    frame_setting: bool,
+    video_save_dir: str,
+    video_name: str,
+    frame_folder_dir: str,
+    style_attr: dict,
+    animal_names: Union[None, List[str]],
+    fps: int,
+    clf_attr: dict,
+    input_style_attr: dict,
+    video_path: Optional[Union[str, os.PathLike]] = None,
+):
 
     batch_id, frm_rng = frm_rng[0], frm_rng[1]
     if video_setting:
         fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
         video_save_path = os.path.join(video_save_dir, f"{batch_id}.mp4")
-        video_writer = cv2.VideoWriter(video_save_path, fourcc, fps, (style_attr["width"], style_attr["height"]))
+        video_writer = cv2.VideoWriter(
+            video_save_path, fourcc, fps, (style_attr["width"], style_attr["height"])
+        )
 
     if input_style_attr is not None:
-        if (isinstance(input_style_attr["bg color"], dict)) and (input_style_attr["bg color"]["type"]) == "moving":
+        if (isinstance(input_style_attr["bg color"], dict)) and (
+            input_style_attr["bg color"]["type"]
+        ) == "moving":
             check_file_exist_and_readable(file_path=video_path)
             video_cap = cv2.VideoCapture(video_path)
 
     bg_clr = style_attr["bg color"]
     for frame_id in frm_rng:
-        if (isinstance(style_attr["bg color"], dict)) and (style_attr["bg color"]["type"]) == "moving":
-            bg_clr = read_frm_of_video(video_path=video_cap, opacity=style_attr["bg color"]["opacity"],frame_index=frame_id)
+        if (isinstance(style_attr["bg color"], dict)) and (
+            style_attr["bg color"]["type"]
+        ) == "moving":
+            bg_clr = read_frm_of_video(
+                video_path=video_cap,
+                opacity=style_attr["bg color"]["opacity"],
+                frame_index=frame_id,
+            )
         plot_arrs = [x[:frame_id, :] for x in data]
 
         clf_attr_cpy = deepcopy(clf_attr)
         if clf_attr is not None:
             for k, v in clf_attr.items():
-                clf_attr_cpy[k]['clfs'][frame_id + 1:] = 0
+                clf_attr_cpy[k]["clfs"][frame_id + 1 :] = 0
 
-        img = PlottingMixin.make_path_plot(data=plot_arrs,
-                             colors=colors,
-                             width=style_attr['width'],
-                             height=style_attr['height'],
-                             max_lines=style_attr['max lines'],
-                             bg_clr=bg_clr,
-                             circle_size=style_attr["circle size"],
-                             font_size=style_attr["font size"],
-                             font_thickness=style_attr["font thickness"],
-                             line_width=style_attr["line width"],
-                             animal_names=animal_names,
-                             clf_attr=clf_attr_cpy,
-                             save_path=None)
+        img = PlottingMixin.make_path_plot(
+            data=plot_arrs,
+            colors=colors,
+            width=style_attr["width"],
+            height=style_attr["height"],
+            max_lines=style_attr["max lines"],
+            bg_clr=bg_clr,
+            circle_size=style_attr["circle size"],
+            font_size=style_attr["font size"],
+            font_thickness=style_attr["font thickness"],
+            line_width=style_attr["line width"],
+            animal_names=animal_names,
+            clf_attr=clf_attr_cpy,
+            save_path=None,
+        )
 
         if video_setting:
             video_writer.write(np.uint8(img))
         if frame_setting:
             frm_name = os.path.join(frame_folder_dir, f"{frame_id}.png")
             cv2.imwrite(frm_name, np.uint8(img))
-        print(f"Path frame created: {frame_id}, Video: {video_name}, Processing core: {batch_id}")
+        print(
+            f"Path frame created: {frame_id}, Video: {video_name}, Processing core: {batch_id}"
+        )
     if video_setting:
         video_writer.release()
     return batch_id
 
 
 class PathPlotterMulticore(ConfigReader, PlottingMixin):
     """
@@ -119,188 +136,310 @@
     >>> input_style_attr = {'width': 'As input', 'height': 'As input', 'line width': 5, 'font size': 5, 'font thickness': 2, 'circle size': 5, 'bg color': 'White', 'max lines': 100}
     >>> animal_attr = {0: ['Ear_right_1', 'Red']}
     >>> input_clf_attr = {0: ['Attack', 'Black', 'Size: 30'], 1: ['Sniffing', 'Red', 'Size: 30']}
     >>> path_plotter = PathPlotterMulticore(config_path=r'MyConfigPath', frame_setting=False, video_setting=True, style_attr=style_attr, animal_attr=animal_attr, files_found=['project_folder/csv/machine_results/MyVideo.csv'], cores=5, clf_attr=clf_attr, print_animal_names=True)
     >>> path_plotter.run()
     """
 
-    def __init__(self,
-                 config_path: Union[str, os.PathLike],
-                 files_found: List[str],
-                 frame_setting: Optional[bool] = False,
-                 video_setting: Optional[bool] = False,
-                 last_frame: Optional[bool] = True,
-                 cores: Optional[int] = -1,
-                 print_animal_names: Optional[bool] = False,
-                 input_style_attr: Optional[Dict] = None,
-                 animal_attr: Dict[int, Any] = None,
-                 clf_attr: Optional[Dict[int, List[str]]] = None,
-                 slicing: Optional[Dict[str, str]] = None):
+    def __init__(
+        self,
+        config_path: Union[str, os.PathLike],
+        files_found: List[str],
+        frame_setting: Optional[bool] = False,
+        video_setting: Optional[bool] = False,
+        last_frame: Optional[bool] = True,
+        cores: Optional[int] = -1,
+        print_animal_names: Optional[bool] = False,
+        input_style_attr: Optional[Dict] = None,
+        animal_attr: Dict[int, Any] = None,
+        clf_attr: Optional[Dict[int, List[str]]] = None,
+        slicing: Optional[Dict[str, str]] = None,
+    ):
 
         if platform.system() == "Darwin":
             multiprocessing.set_start_method("spawn", force=True)
         if (not frame_setting) and (not video_setting) and (not last_frame):
-            raise NoSpecifiedOutputError(msg="SIMBA ERROR: Please choice to create path frames and/or video path plots", source=self.__class__.__name__)
-        check_valid_lst(data=files_found, source=self.__class__.__name__, valid_dtypes=(str,))
-
-        check_int(name=f"{self.__class__.__name__} core_cnt", value=cores, min_value=-1, max_value=find_core_cnt()[0])
-        if cores == -1: cores = find_core_cnt()[0]
+            raise NoSpecifiedOutputError(
+                msg="SIMBA ERROR: Please choice to create path frames and/or video path plots",
+                source=self.__class__.__name__,
+            )
+        check_valid_lst(
+            data=files_found, source=self.__class__.__name__, valid_dtypes=(str,)
+        )
+
+        check_int(
+            name=f"{self.__class__.__name__} core_cnt",
+            value=cores,
+            min_value=-1,
+            max_value=find_core_cnt()[0],
+        )
+        if cores == -1:
+            cores = find_core_cnt()[0]
 
         ConfigReader.__init__(self, config_path=config_path)
         PlottingMixin.__init__(self)
-        log_event(logger_name=str(__class__.__name__), log_type=TagNames.CLASS_INIT.value, msg=self.create_log_msg_from_init_args(locals=locals()))
-        self.video_setting, self.frame_setting, self.input_style_attr, self.files_found, self.animal_attr, self.input_clf_attr, self.last_frame, self.cores = video_setting,frame_setting,input_style_attr,files_found,animal_attr,clf_attr,last_frame,cores
-        self.print_animal_names, self.clf_attr, self.slicing = print_animal_names, clf_attr, slicing
+        log_event(
+            logger_name=str(__class__.__name__),
+            log_type=TagNames.CLASS_INIT.value,
+            msg=self.create_log_msg_from_init_args(locals=locals()),
+        )
+        (
+            self.video_setting,
+            self.frame_setting,
+            self.input_style_attr,
+            self.files_found,
+            self.animal_attr,
+            self.input_clf_attr,
+            self.last_frame,
+            self.cores,
+        ) = (
+            video_setting,
+            frame_setting,
+            input_style_attr,
+            files_found,
+            animal_attr,
+            clf_attr,
+            last_frame,
+            cores,
+        )
+        self.print_animal_names, self.clf_attr, self.slicing = (
+            print_animal_names,
+            clf_attr,
+            slicing,
+        )
         if not os.path.exists(self.path_plot_dir):
             os.makedirs(self.path_plot_dir)
         print(f"Processing {len(self.files_found)} videos...")
 
     def __get_styles(self):
         self.style_attr = {}
         if self.input_style_attr is not None:
             self.style_attr["bg color"] = self.input_style_attr["bg color"]
             if self.input_style_attr["max lines"] == "entire video":
                 self.style_attr["max lines"] = len(self.data_df)
             else:
-                self.style_attr["max lines"] = max(1, int(int(self.input_style_attr["max lines"] / 1000) * (int(self.video_info["fps"].values[0]))))
+                self.style_attr["max lines"] = max(
+                    1,
+                    int(
+                        int(self.input_style_attr["max lines"] / 1000)
+                        * (int(self.video_info["fps"].values[0]))
+                    ),
+                )
             self.style_attr["font thickness"] = self.input_style_attr["font thickness"]
             self.style_attr["line width"] = self.input_style_attr["line width"]
             self.style_attr["font size"] = self.input_style_attr["font size"]
             self.style_attr["circle size"] = self.input_style_attr["circle size"]
             self.style_attr["print_animal_names"] = self.print_animal_names
             if self.input_style_attr["width"] == "As input":
-                self.style_attr["width"], self.style_attr["height"] = int(self.video_info["Resolution_width"].values[0]), int(self.video_info["Resolution_height"].values[0])
+                self.style_attr["width"], self.style_attr["height"] = int(
+                    self.video_info["Resolution_width"].values[0]
+                ), int(self.video_info["Resolution_height"].values[0])
             else:
                 pass
         else:
             space_scaler, radius_scaler, res_scaler, font_scaler = 25, 10, 1500, 0.8
-            self.style_attr["width"] = int(self.video_info["Resolution_width"].values[0])
-            self.style_attr["height"] = int(self.video_info["Resolution_height"].values[0])
+            self.style_attr["width"] = int(
+                self.video_info["Resolution_width"].values[0]
+            )
+            self.style_attr["height"] = int(
+                self.video_info["Resolution_height"].values[0]
+            )
             max_res = max(self.style_attr["width"], self.style_attr["height"])
             self.style_attr["circle size"] = int(radius_scaler / (res_scaler / max_res))
             self.style_attr["font size"] = font_scaler / (res_scaler / max_res)
             self.style_attr["bg color"] = self.color_dict["White"]
             self.style_attr["print_animal_names"] = self.print_animal_names
             self.style_attr["max lines"] = len(self.data_df)
             self.style_attr["font thickness"] = 2
             self.style_attr["line width"] = 2
 
     def run(self):
         for file_cnt, file_path in enumerate(self.files_found):
             video_timer = SimbaTimer(start=True)
             _, self.video_name, _ = get_fn_ext(file_path)
-            self.video_info, _, self.fps = self.read_video_info(video_name=self.video_name)
+            self.video_info, _, self.fps = self.read_video_info(
+                video_name=self.video_name
+            )
             self.data_df = read_df(file_path, self.file_type)
             line_data, colors, animal_names = [], [], []
             for k, v in self.animal_attr.items():
-                check_if_keys_exist_in_dict(data=v, key=['bp', 'color'], name=f'animal attr {k}')
-                line_data.append(self.data_df[[f'{v["bp"]}_x', f'{v["bp"]}_y']].values.astype(np.int64))
-                colors.append(v['color'])
+                check_if_keys_exist_in_dict(
+                    data=v, key=["bp", "color"], name=f"animal attr {k}"
+                )
+                line_data.append(
+                    self.data_df[[f'{v["bp"]}_x', f'{v["bp"]}_y']].values.astype(
+                        np.int64
+                    )
+                )
+                colors.append(v["color"])
                 if self.print_animal_names:
-                    animal_names.append(self.find_animal_name_from_body_part_name(bp_name=v["bp"], bp_dict=self.animal_bp_dict))
-            if not self.print_animal_names: animal_names = None
+                    animal_names.append(
+                        self.find_animal_name_from_body_part_name(
+                            bp_name=v["bp"], bp_dict=self.animal_bp_dict
+                        )
+                    )
+            if not self.print_animal_names:
+                animal_names = None
             if self.slicing:
-                check_if_keys_exist_in_dict(data=self.slicing, key=['start_time', 'end_time'], name='slicing')
-                frm_numbers = find_frame_numbers_from_time_stamp(start_time=self.slicing["start_time"], end_time=self.slicing["end_time"], fps=self.fps,)
+                check_if_keys_exist_in_dict(
+                    data=self.slicing, key=["start_time", "end_time"], name="slicing"
+                )
+                frm_numbers = find_frame_numbers_from_time_stamp(
+                    start_time=self.slicing["start_time"],
+                    end_time=self.slicing["end_time"],
+                    fps=self.fps,
+                )
                 if len(set(frm_numbers) - set(self.data_df.index)) > 0:
-                    raise FrameRangeError(msg=f'The chosen time-period ({self.slicing["start_time"]} - {self.slicing["end_time"]}) does not exist in {self.video_name}.', source=self.__class__.__name__)
+                    raise FrameRangeError(
+                        msg=f'The chosen time-period ({self.slicing["start_time"]} - {self.slicing["end_time"]}) does not exist in {self.video_name}.',
+                        source=self.__class__.__name__,
+                    )
                 for i in range(len(line_data)):
                     line_data[i] = line_data[i][frm_numbers, :]
             self.__get_styles()
 
             self.temp_folder = os.path.join(self.path_plot_dir, self.video_name, "temp")
-            self.save_frame_folder_dir = os.path.join(self.path_plot_dir, self.video_name)
+            self.save_frame_folder_dir = os.path.join(
+                self.path_plot_dir, self.video_name
+            )
 
             if self.frame_setting:
                 if os.path.exists(self.save_frame_folder_dir):
                     remove_a_folder(self.save_frame_folder_dir)
                 os.makedirs(self.save_frame_folder_dir)
 
             if self.video_setting:
                 self.video_folder = os.path.join(self.path_plot_dir, self.video_name)
                 if os.path.exists(self.temp_folder):
                     remove_a_folder(self.temp_folder)
                     remove_a_folder(self.video_folder)
                 os.makedirs(self.temp_folder)
-                self.save_video_path = os.path.join(self.path_plot_dir, f"{self.video_name}.mp4")
+                self.save_video_path = os.path.join(
+                    self.path_plot_dir, f"{self.video_name}.mp4"
+                )
 
             if self.clf_attr is not None:
                 self.clf_attr_appended = {}
-                check_instance(source=self.__class__.__name__, instance=self.clf_attr, accepted_types=(dict,))
+                check_instance(
+                    source=self.__class__.__name__,
+                    instance=self.clf_attr,
+                    accepted_types=(dict,),
+                )
                 for k, v in self.clf_attr.items():
-                    check_if_keys_exist_in_dict(data=v, key=['color', 'size'], name=f'clf_attr {k}')
-                    check_that_column_exist(df=self.data_df, column_name=k, file_name=file_path)
+                    check_if_keys_exist_in_dict(
+                        data=v, key=["color", "size"], name=f"clf_attr {k}"
+                    )
+                    check_that_column_exist(
+                        df=self.data_df, column_name=k, file_name=file_path
+                    )
                     self.clf_attr_appended[k] = self.clf_attr[k]
-                    self.clf_attr_appended[k]["clfs"] = self.data_df[k].values.astype(np.int8)
+                    self.clf_attr_appended[k]["clfs"] = self.data_df[k].values.astype(
+                        np.int8
+                    )
                     self.clf_attr_appended[k]["positions"] = self.data_df[
-                        [self.animal_attr[0]['bp'] + "_x", self.animal_attr[0]['bp'] + "_y"]].values.astype(np.int64)
-                self.clf_attr = deepcopy(self.clf_attr_appended); del self.clf_attr_appended
+                        [
+                            self.animal_attr[0]["bp"] + "_x",
+                            self.animal_attr[0]["bp"] + "_y",
+                        ]
+                    ].values.astype(np.int64)
+                self.clf_attr = deepcopy(self.clf_attr_appended)
+                del self.clf_attr_appended
 
             bg_clr = self.style_attr["bg color"]
             self.video_path = None
             if isinstance(self.style_attr["bg color"], dict):
-                self.video_path = find_video_of_file(video_dir=self.video_dir, filename=self.video_name, raise_error=True)
+                self.video_path = find_video_of_file(
+                    video_dir=self.video_dir, filename=self.video_name, raise_error=True
+                )
                 if "frame_index" in self.style_attr["bg color"].keys():
-                    check_int(name="Static frame index", value=self.style_attr["bg color"]["frame_index"], min_value=0)
+                    check_int(
+                        name="Static frame index",
+                        value=self.style_attr["bg color"]["frame_index"],
+                        min_value=0,
+                    )
                     frame_index = self.style_attr["bg color"]["frame_index"]
                 else:
                     video_meta_data = get_video_meta_data(video_path=self.video_path)
                     frame_index = video_meta_data["frame_count"] - 1
-                bg_clr = read_frm_of_video(video_path=self.video_path,
-                                                                opacity=self.style_attr["bg color"]["opacity"],
-                                                                frame_index=frame_index)
+                bg_clr = read_frm_of_video(
+                    video_path=self.video_path,
+                    opacity=self.style_attr["bg color"]["opacity"],
+                    frame_index=frame_index,
+                )
 
             if self.last_frame:
-                PlottingMixin.make_path_plot(data=line_data,
-                               colors=colors,
-                               width=self.style_attr['width'],
-                               height=self.style_attr['height'],
-                               max_lines=self.style_attr['max lines'],
-                               bg_clr=bg_clr,
-                               circle_size=self.style_attr["circle size"],
-                               font_size=self.style_attr["font size"],
-                               font_thickness=self.style_attr["font thickness"],
-                               line_width=self.style_attr["line width"],
-                               animal_names=animal_names,
-                               clf_attr=self.clf_attr,
-                               save_path=os.path.join(self.path_plot_dir, f"{self.video_name}_final_frame.png"))
+                PlottingMixin.make_path_plot(
+                    data=line_data,
+                    colors=colors,
+                    width=self.style_attr["width"],
+                    height=self.style_attr["height"],
+                    max_lines=self.style_attr["max lines"],
+                    bg_clr=bg_clr,
+                    circle_size=self.style_attr["circle size"],
+                    font_size=self.style_attr["font size"],
+                    font_thickness=self.style_attr["font thickness"],
+                    line_width=self.style_attr["line width"],
+                    animal_names=animal_names,
+                    clf_attr=self.clf_attr,
+                    save_path=os.path.join(
+                        self.path_plot_dir, f"{self.video_name}_final_frame.png"
+                    ),
+                )
 
             if self.video_setting or self.frame_setting:
                 frm_range = np.arange(1, line_data[0].shape[0])
                 frm_range = np.array_split(frm_range, self.cores)
                 frm_range = [(cnt, x) for cnt, x in enumerate(frm_range)]
-                print(f"Creating path plots, multiprocessing (chunksize: {self.multiprocess_chunksize}, cores: {self.cores})...")
-                with multiprocessing.Pool(self.cores, maxtasksperchild=self.maxtasksperchild) as pool:
-                    constants = functools.partial(path_plot_mp,
-                                                  data=line_data,
-                                                  colors=colors,
-                                                  video_setting=self.video_setting,
-                                                  video_name=self.video_name,
-                                                  frame_setting=self.frame_setting,
-                                                  video_save_dir=self.temp_folder,
-                                                  frame_folder_dir=self.save_frame_folder_dir,
-                                                  style_attr=self.style_attr,
-                                                  animal_names=animal_names,
-                                                  fps=self.fps,
-                                                  clf_attr=self.clf_attr,
-                                                  input_style_attr=self.input_style_attr,
-                                                  video_path=self.video_path)
-                    for cnt, result in enumerate(pool.imap(constants, frm_range, chunksize=self.multiprocess_chunksize)):
+                print(
+                    f"Creating path plots, multiprocessing (chunksize: {self.multiprocess_chunksize}, cores: {self.cores})..."
+                )
+                with multiprocessing.Pool(
+                    self.cores, maxtasksperchild=self.maxtasksperchild
+                ) as pool:
+                    constants = functools.partial(
+                        path_plot_mp,
+                        data=line_data,
+                        colors=colors,
+                        video_setting=self.video_setting,
+                        video_name=self.video_name,
+                        frame_setting=self.frame_setting,
+                        video_save_dir=self.temp_folder,
+                        frame_folder_dir=self.save_frame_folder_dir,
+                        style_attr=self.style_attr,
+                        animal_names=animal_names,
+                        fps=self.fps,
+                        clf_attr=self.clf_attr,
+                        input_style_attr=self.input_style_attr,
+                        video_path=self.video_path,
+                    )
+                    for cnt, result in enumerate(
+                        pool.imap(
+                            constants, frm_range, chunksize=self.multiprocess_chunksize
+                        )
+                    ):
                         print(f"Path batch {result+1}/{self.cores} complete...")
                     pool.terminate()
                     pool.join()
 
                 if self.video_setting:
                     print(f"Joining {self.video_name} multiprocessed video...")
-                    concatenate_videos_in_folder(in_folder=self.temp_folder, save_path=self.save_video_path)
+                    concatenate_videos_in_folder(
+                        in_folder=self.temp_folder, save_path=self.save_video_path
+                    )
                 video_timer.stop_timer()
-                print(f"Path plot video {self.video_name} complete (elapsed time: {video_timer.elapsed_time_str}s) ...")
+                print(
+                    f"Path plot video {self.video_name} complete (elapsed time: {video_timer.elapsed_time_str}s) ..."
+                )
 
         self.timer.stop_timer()
-        stdout_success(msg=f"Path plot visualizations for {len(self.files_found)} videos created in {self.path_plot_dir} directory", elapsed_time=self.timer.elapsed_time_str, source=self.__class__.__name__)
+        stdout_success(
+            msg=f"Path plot visualizations for {len(self.files_found)} videos created in {self.path_plot_dir} directory",
+            elapsed_time=self.timer.elapsed_time_str,
+            source=self.__class__.__name__,
+        )
 
 
 # animal_attr = {0: {'bp': 'Ear_right_1', 'color': (255, 0, 0)}, 1: {'bp': 'Ear_right_2', 'color': (0, 0, 255)}}  #['Ear_right_1', 'Red'], 1: ['Ear_right_2', 'Green']}
 # style_attr = {'width': 'As input',
 #               'height': 'As input',
 #               'line width': 2,
 #               'font size': 0.9,
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/ROI_feature_visualizer_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/ROI_plotter.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,306 +1,255 @@
 __author__ = "Simon Nilsson"
 
-import functools
 import itertools
-import multiprocessing
 import os
-import platform
-from typing import Any, Dict, Optional, Union
+from copy import deepcopy
+from typing import Tuple, Optional, Union, Dict
 
 import cv2
+import numpy as np
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.plotting_mixin import PlottingMixin
-from simba.roi_tools.ROI_feature_analyzer import ROIFeatureCreator
-from simba.utils.checks import (check_file_exist_and_readable, check_instance,
-                                check_int)
-from simba.utils.enums import TextOptions
-from simba.utils.printing import SimbaTimer, stdout_success
-from simba.utils.read_write import (concatenate_videos_in_folder,
-                                    find_core_cnt, get_fn_ext,
-                                    get_video_meta_data, read_df,
-                                    remove_a_folder)
+from simba.roi_tools.ROI_analyzer import ROIAnalyzer
+from simba.utils.data import create_color_palettes, slice_roi_dict_for_video, detect_bouts
+from simba.utils.checks import check_float, check_if_keys_exist_in_dict, check_file_exist_and_readable, check_video_and_data_frm_count_align
+from simba.utils.enums import Formats, Paths, TagNames, TextOptions
+from simba.utils.errors import DuplicationError, NoFilesFoundError
+from simba.utils.printing import SimbaTimer, log_event, stdout_success
+from simba.utils.read_write import (get_fn_ext, get_video_meta_data)
+from simba.utils.warnings import DuplicateNamesWarning
+
+SHOW_BODY_PARTS = 'show_body_part'
+SHOW_ANIMAL_NAMES = 'show_animal_name'
+STYLE_KEYS = [SHOW_BODY_PARTS, SHOW_ANIMAL_NAMES]
 
 
-class ROIfeatureVisualizerMultiprocess(ConfigReader, PlottingMixin):
+class ROIPlot(ConfigReader, PlottingMixin):
     """
-    Visualize features that depend on the relationships between the location of the animals and user-defined
-    ROIs. E.g., distances to centroids of ROIs, cumulative time spent in ROIs, if animals are directing towards ROIs
-    etc.
+    Visualize the ROI data (number of entries/exits, time-spent in ROIs etc).
+
+    .. note::
+       `ROI tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial_new.md>`__.
+
+       Use :meth:`simba.plotting.ROI_plotter_mp.ROIPlotMultiprocess` for improved run-time.
 
     :param str config_path: Path to SimBA project config file in Configparser format
-    :param str video_name: Name of video to create feature visualizations for.
-    :param dict style_attr: User-defined styles (sizes, colors etc.)
-    :param int cores: Number of cores to use.
-
-    .. note:
-       `Tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial.md#part-5-visualizing-roi-features>`__.
-
-    Examples
-    ----------
-    >>> style_attr = {'ROI_centers': True, 'ROI_ear_tags': True, 'Directionality': True, 'Directionality_style': 'Funnel', 'Border_color': (0, 128, 0), 'Pose_estimation': True}
-    >>> _ = ROIfeatureVisualizerMultiprocess(config_path='test_/project_folder/project_config.ini', video_name='Together_1.avi', style_attr=style_attr, core_cnt=3).run()
-    """
+    :param str video_path: Name of video to create ROI visualizations for
+    :param dict style_attr: User-defined visualization settings.
 
-    def __init__(
-        self,
-        config_path: Union[str, os.PathLike],
-        video_name: str,
-        style_attr: Dict[str, Any],
-        core_cnt: Optional[int] = -1,
-    ):
+    :example:
+    >>> settings = {'show_body_parts': True, 'show_animal_name': True}
+    >>> roi_visualizer = ROIPlot(ini_path=r'MyProjectConfig', video_path="MyVideo.mp4", settings=settings)
+    >>> roi_visualizer.insert_data()
+    >>> roi_visualizer.run()
+    """
 
+    def __init__(self,
+                 config_path: Union[str, os.PathLike],
+                 video_path: Union[str, os.PathLike],
+                 style_attr: Dict[str, bool],
+                 body_parts: Optional[Dict[str, str]] = None,
+                 threshold: Optional[float] = 0.0):
+
+        check_float(name=f'{self.__class__.__name__} threshold', value=threshold, min_value=0.0, max_value=1.0)
+        check_if_keys_exist_in_dict(data=style_attr, key=STYLE_KEYS, name=f'{self.__class__.__name__} style_attr')
+        check_file_exist_and_readable(file_path=video_path)
         ConfigReader.__init__(self, config_path=config_path)
         PlottingMixin.__init__(self)
-        check_int(
-            name=f"{self.__class__.__name__} core_cnt",
-            value=core_cnt,
-            min_value=-1,
-            max_value=find_core_cnt()[0],
-        )
-        check_instance(
-            source=f"{self.__class__.__name__} core_cnt",
-            instance=style_attr,
-            accepted_types=(dict,),
-        )
-        if platform.system() == "Darwin":
-            multiprocessing.set_start_method("spawn", force=True)
-        _, self.video_name, _ = get_fn_ext(video_name)
-        self.core_cnt, self.style_attr = core_cnt, style_attr
-        self.save_path = os.path.join(
-            self.roi_features_save_dir, f"{self.video_name}.mp4"
-        )
-        if not os.path.exists(self.roi_features_save_dir):
-            os.makedirs(self.roi_features_save_dir)
-        self.save_temp_dir = os.path.join(self.roi_features_save_dir, "temp")
-        if os.path.exists(self.save_temp_dir):
-            remove_a_folder(folder_dir=self.save_temp_dir)
-        os.makedirs(self.save_temp_dir)
-        self.roi_feature_creator = ROIFeatureCreator(config_path=config_path)
-        self.file_in_path = os.path.join(
-            self.outlier_corrected_dir, f"{self.video_name}.{self.file_type}"
-        )
-        self.video_path = os.path.join(self.project_path, "videos", video_name)
-        check_file_exist_and_readable(file_path=self.file_in_path)
-        self.roi_feature_creator.features_files = [self.file_in_path]
-        self.roi_feature_creator.files_found = [self.file_in_path]
-        self.roi_feature_creator.run()
+        log_event(logger_name=str(__class__.__name__), log_type=TagNames.CLASS_INIT.value, msg=self.create_log_msg_from_init_args(locals=locals()))
+        settings = None
+        if body_parts: settings = {"body_parts": body_parts, 'threshold': threshold}
+        self.roi_analyzer = ROIAnalyzer(ini_path=config_path, data_path="outlier_corrected_movement_location", settings=settings)
+        if not body_parts: self.animal_id_lst = self.roi_analyzer.multi_animal_id_list
+        else: self.animal_id_lst = list(body_parts.keys())
+        _, self.video_name, _ = get_fn_ext(video_path)
+        self.roi_analyzer.files_found = [os.path.join(self.roi_analyzer.input_folder, f"{self.video_name}.{self.roi_analyzer.file_type}")]
+        if not os.path.isfile(self.roi_analyzer.files_found[0]):
+            raise NoFilesFoundError( msg=f"SIMBA ERROR: Could not find the file at path {self.roi_analyzer.files_found[0]}. Please make sure you have corrected body-part outliers or indicated that you want to skip outlier correction", source=self.__class__.__name__, )
+        self.roi_analyzer.run()
+        self.roi_entries_df = self.roi_analyzer.detailed_df
+        self.data_df, self.style_attr = self.roi_analyzer.data_df, style_attr
+        self.save_dir = os.path.join(self.project_path, Paths.ROI_ANALYSIS.value)
+        if not os.path.exists(self.save_dir): os.makedirs(self.save_dir)
+        self.video_save_path = os.path.join(self.save_dir, f"{self.video_name}.mp4")
+        self.read_roi_data()
+        self.shape_columns = []
+        _, self.shape_names = slice_roi_dict_for_video(data=self.roi_dict, video_name=self.video_name)
+        for animal in self.animal_id_lst:
+            for shape_name in self.shape_names:
+                self.data_df[f"{animal}_{shape_name}"] = 0; self.shape_columns.append(f"{animal}_{shape_name}")
+        self.bp_dict = self.roi_analyzer.bp_dict
+        self.__insert_data()
+        self.video_path = video_path
+        self.cap = cv2.VideoCapture(self.video_path)
         self.video_meta_data = get_video_meta_data(self.video_path)
-        self.scalers = {}
-        self.max_dim = max(
-            self.video_meta_data["width"], self.video_meta_data["height"]
-        )
-        self.scalers["circle_size"] = int(
-            TextOptions.RADIUS_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / self.max_dim)
-        )
-        self.scalers["font_size"] = float(
-            TextOptions.FONT_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / self.max_dim)
-        )
-        self.scalers["spacing_size"] = int(
-            TextOptions.SPACE_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / self.max_dim)
-        )
-        self.data_df = read_df(self.file_in_path, self.file_type)
-        self.bp_names = self.roi_feature_creator.roi_analyzer.bp_dict
-        self.video_recs = self.roi_feature_creator.roi_analyzer.video_recs
-        self.video_circs = self.roi_feature_creator.roi_analyzer.video_circs
-        self.video_polys = self.roi_feature_creator.roi_analyzer.video_polys
-        self.shape_dicts = {}
-        for df in [self.video_recs, self.video_circs, self.video_polys]:
+        self.threshold = threshold
+
+    def __insert_data(self):
+        roi_entries_dict = self.roi_entries_df[["ANIMAL", "SHAPE", "ENTRY FRAMES", "EXIT FRAMES"]].to_dict(orient="records")
+        for entry_dict in roi_entries_dict:
+            entry, exit = int(entry_dict["ENTRY FRAMES"]), int(entry_dict["EXIT FRAMES"])
+            entry_dict["frame_range"] = list(range(entry, exit + 1))
+            col_name = entry_dict["ANIMAL"] + "_" + entry_dict["SHAPE"]
+            self.data_df[col_name][self.data_df.index.isin(entry_dict["frame_range"])] = 1
+
+    def __calc_text_locs(self) -> dict:
+        loc_dict = {}
+        line_spacer = TextOptions.FIRST_LINE_SPACING.value
+        for animal_cnt, animal_name in enumerate(self.animal_id_lst):
+            loc_dict[animal_name] = {}
+            for shape in self.shape_names:
+                loc_dict[animal_name][shape] = {}
+                loc_dict[animal_name][shape]["timer_text"] = f"{shape} {animal_name} timer:"
+                loc_dict[animal_name][shape]["entries_text"] = f"{shape} {animal_name} entries:"
+                loc_dict[animal_name][shape]["timer_text_loc"] = ((self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value), (self.video_meta_data["height"] - (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
+                loc_dict[animal_name][shape]["timer_data_loc"] = (int(self.border_img_w - (self.border_img_w / 8)), (self.video_meta_data["height"] - (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
+                line_spacer += TextOptions.LINE_SPACING.value
+                loc_dict[animal_name][shape]["entries_text_loc"] = ((self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value), (self.video_meta_data["height"] - (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
+                loc_dict[animal_name][shape]["entries_data_loc"] = (int(self.border_img_w - (self.border_img_w / 8)), (self.video_meta_data["height"]- (self.video_meta_data["height"] + TextOptions.BORDER_BUFFER_Y.value) + self.scalers["space_size"] * line_spacer))
+                line_spacer += TextOptions.LINE_SPACING.value
+        return loc_dict
+
+    def __insert_texts(self, shape_df):
+        for animal_name in self.animal_id_lst:
+            for _, shape in shape_df.iterrows():
+                shape_name, shape_color = shape["Name"], shape["Color BGR"]
+                cv2.putText(self.border_img, self.loc_dict[animal_name][shape_name]["timer_text"], self.loc_dict[animal_name][shape_name]["timer_text_loc"], TextOptions.FONT.value, self.scalers["font_size"], shape_color, TextOptions.TEXT_THICKNESS.value)
+                cv2.putText(self.border_img, self.loc_dict[animal_name][shape_name]["entries_text"], self.loc_dict[animal_name][shape_name]["entries_text_loc"], TextOptions.FONT.value, self.scalers["font_size"], shape_color, TextOptions.TEXT_THICKNESS.value)
+
+    def __create_counters(self) -> dict:
+        cnt_dict = {}
+        for animal_cnt, animal_name in enumerate(self.animal_id_lst):
+            cnt_dict[animal_name] = {}
+            for shape in self.shape_names:
+                cnt_dict[animal_name][shape] = {}
+                cnt_dict[animal_name][shape]["timer"] = 0
+                cnt_dict[animal_name][shape]["entries"] = 0
+                cnt_dict[animal_name][shape]["entry_status"] = False
+        return cnt_dict
+
+    def __calculate_cumulative(self):
+        for animal_name in self.animal_id_lst:
+            for shape in self.shape_names:
+                self.data_df[f"{animal_name}_{shape}_cum_sum_time"] = (self.data_df[f"{animal_name}_{shape}"].cumsum() / self.video_meta_data['fps'])
+                roi_bouts = list(detect_bouts(data_df=self.data_df, target_lst=[f"{animal_name}_{shape}"], fps=self.video_meta_data['fps'])["Start_frame"])
+                self.data_df[f"{animal_name}_{shape}_entry"] = 0
+                self.data_df.loc[roi_bouts, f"{animal_name}_{shape}_entry"] = 1
+                self.data_df[f"{animal_name}_{shape}_cum_sum_entries"] = (self.data_df[f"{animal_name}_{shape}_entry"].cumsum())
+
+    def __create_shape_dicts(self):
+        shape_dicts = {}
+        for df in [self.roi_analyzer.video_recs, self.roi_analyzer.video_circs, self.roi_analyzer.video_polys]:
+            if not df["Name"].is_unique:
+                df = df.drop_duplicates(subset=["Name"], keep="first")
+                DuplicateNamesWarning('Some of your ROIs with the same shape has the same names. E.g., you have two rectangles named "My rectangle". SimBA prefers ROI shapes with unique names. SimBA will keep one of the unique shape names and drop the rest.', source=self.__class__.__name__)
             d = df.set_index("Name").to_dict(orient="index")
-            self.shape_dicts = {**self.shape_dicts, **d}
-        self.video_shapes = list(
-            itertools.chain(
-                self.video_recs["Name"].unique(),
-                self.video_circs["Name"].unique(),
-                self.video_polys["Name"].unique(),
-            )
-        )
-        self.roi_directing_viable = self.roi_feature_creator.roi_directing_viable
-        if self.roi_directing_viable:
-            self.directing_data = self.roi_feature_creator.directing_analyzer.results_df
-            self.directing_data = self.directing_data[
-                self.directing_data["Video"] == self.video_name
-            ]
-            if ("Directionality_roi_subset" in style_attr.keys()) and (
-                type(style_attr["Directionality_roi_subset"]) == list
-            ):
-                self.directing_data = self.directing_data[
-                    self.directing_data["ROI"].isin(
-                        style_attr["Directionality_roi_subset"]
-                    )
-                ].reset_index(drop=True)
-        else:
-            self.directing_data = None
-        self.roi_feature_creator.out_df.fillna(0, inplace=True)
-
-    def __calc_text_locs(self):
-        add_spacer = 2
-        self.loc_dict = {}
-        self.cap = cv2.VideoCapture(self.video_path)
-        self.cap.set(0, 1)
-        ret, img = self.cap.read()
-        self.img_w_border = cv2.copyMakeBorder(
-            img,
-            0,
-            0,
-            0,
-            int(self.video_meta_data["width"]),
-            borderType=cv2.BORDER_CONSTANT,
-            value=[0, 0, 0],
-        )
-        self.img_w_border_h, self.img_w_border_w = (
-            self.img_w_border.shape[0],
-            self.img_w_border.shape[1],
-        )
-
-        for animal_cnt, animal_name in enumerate(self.multi_animal_id_list):
-            self.loc_dict[animal_name] = {}
-            for shape in self.video_shapes:
-                self.loc_dict[animal_name][shape] = {}
-                self.loc_dict[animal_name][shape]["in_zone_text"] = "{} {} {}".format(
-                    shape, animal_name, "in zone"
-                )
-                self.loc_dict[animal_name][shape]["distance_text"] = "{} {} {}".format(
-                    shape, animal_name, "distance"
-                )
-                self.loc_dict[animal_name][shape]["in_zone_text_loc"] = (
-                    (self.video_meta_data["width"] + 5),
-                    (
-                        self.video_meta_data["height"]
-                        - (self.video_meta_data["height"] + 10)
-                        + self.scalers["spacing_size"] * add_spacer
-                    ),
-                )
-                self.loc_dict[animal_name][shape]["in_zone_data_loc"] = (
-                    int(self.img_w_border_w - (self.img_w_border_w / 8)),
-                    (
-                        self.video_meta_data["height"]
-                        - (self.video_meta_data["height"] + 10)
-                        + self.scalers["spacing_size"] * add_spacer
-                    ),
-                )
-                add_spacer += 1
-                self.loc_dict[animal_name][shape]["distance_text_loc"] = (
-                    (self.video_meta_data["width"] + 5),
-                    (
-                        self.video_meta_data["height"]
-                        - (self.video_meta_data["height"] + 10)
-                        + self.scalers["spacing_size"] * add_spacer
-                    ),
-                )
-                self.loc_dict[animal_name][shape]["distance_data_loc"] = (
-                    int(self.img_w_border_w - (self.img_w_border_w / 8)),
-                    (
-                        self.video_meta_data["height"]
-                        - (self.video_meta_data["height"] + 10)
-                        + self.scalers["spacing_size"] * add_spacer
-                    ),
-                )
-                add_spacer += 1
-                if self.roi_directing_viable and self.style_attr["Directionality"]:
-                    self.loc_dict[animal_name][shape]["directing_text"] = (
-                        "{} {} {}".format(shape, animal_name, "facing")
-                    )
-                    self.loc_dict[animal_name][shape]["directing_text_loc"] = (
-                        (self.video_meta_data["width"] + 5),
-                        (
-                            self.video_meta_data["height"]
-                            - (self.video_meta_data["height"] + 10)
-                            + self.scalers["spacing_size"] * add_spacer
-                        ),
-                    )
-                    self.loc_dict[animal_name][shape]["directing_data_loc"] = (
-                        int(self.img_w_border_w - (self.img_w_border_w / 8)),
-                        (
-                            self.video_meta_data["height"]
-                            - (self.video_meta_data["height"] + 10)
-                            + self.scalers["spacing_size"] * add_spacer
-                        ),
-                    )
-                    add_spacer += 1
+            shape_dicts = {**shape_dicts, **d}
+        return shape_dicts
 
-    def run(self):
+    def __get_bordered_img_size(self) -> Tuple[int, int]:
+        cap = cv2.VideoCapture(self.video_path)
+        cap.set(1, 1)
+        _, img = self.cap.read()
+        self.base_img = cv2.copyMakeBorder(img, 0, 0, 0, int(self.video_meta_data["width"]), borderType=cv2.BORDER_CONSTANT, value=[0, 0, 0])
+        self.base_img_h, self.base_img_w = self.base_img.shape[0], self.base_img.shape[1]
+        cap.release()
+        return self.base_img_h, self.base_img_w
 
-        self.timer = SimbaTimer(start=True)
-        self.__calc_text_locs()
-        data_arr, frm_per_core = self.split_and_group_df(
-            df=self.roi_feature_creator.out_df,
-            splits=self.core_cnt,
-            include_split_order=True,
-        )
-        print(
-            f"Creating ROI feature images, multiprocessing (determined chunksize: {self.multiprocess_chunksize}, cores: {self.core_cnt})..."
-        )
-        with multiprocessing.Pool(
-            self.core_cnt, maxtasksperchild=self.maxtasksperchild
-        ) as pool:
-            constants = functools.partial(
-                self.roi_feature_visualizer_mp,
-                text_locations=self.loc_dict,
-                scalers=self.scalers,
-                video_meta_data=self.video_meta_data,
-                shape_info=self.shape_dicts,
-                style_attr=self.style_attr,
-                save_temp_dir=self.save_temp_dir,
-                directing_data=self.directing_data,
-                video_path=self.video_path,
-                directing_viable=self.roi_directing_viable,
-                animal_names=self.multi_animal_id_list,
-                tracked_bps=self.bp_names,
-                animal_bps=self.animal_bp_dict,
-            )
-            for cnt, result in enumerate(
-                pool.imap(constants, data_arr, chunksize=self.multiprocess_chunksize)
-            ):
-                print(
-                    f"Image {int(frm_per_core * (result + 1))}/{len(self.data_df)}, Video {self.video_name}..."
-                )
-            print(f"Joining {self.video_name} multi-processed video...")
-            concatenate_videos_in_folder(
-                in_folder=self.save_temp_dir,
-                save_path=self.save_path,
-                video_format="mp4",
-                remove_splits=True,
-            )
-            self.timer.stop_timer()
-            pool.terminate()
-            pool.join()
-            stdout_success(
-                msg=f"Video {self.video_name} complete. Video saved in project_folder/frames/output/ROI_features.",
-                elapsed_time=self.timer.elapsed_time_str,
-            )
-
-
-# style_attr = {'ROI_centers': True,
-#               'ROI_ear_tags': True,
-#               'Directionality': True,
-#               'Directionality_style': 'Funnel',
-#               'Border_color': (0, 128, 0),
-#               'Pose_estimation': True,
-#               'Directionality_roi_subset': ['My_polygon']}
-
-# roi_feature_visualizer = ROIfeatureVisualizerMultiprocess(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                                                           video_name='Together_1.avi',
-#                                                           style_attr=style_attr,
-#                                                           core_cnt=3)
-# roi_feature_visualizer.run()
-
-
-# style_attr = {'ROI_centers': True,
-#               'ROI_ear_tags': True,
-#               'Directionality': True,
-#               'Directionality_style': 'Funnel',
-#               'Border_color': (0, 128, 0),
-#               'Pose_estimation': True}
-# roi_feature_visualizer = ROIfeatureVisualizerMultiprocess(config_path='/Users/simon/Desktop/envs/simba_dev/tests/test_data/mouse_open_field/project_folder/project_config.ini',
-#                                                           video_name='Video1.mp4',
-#                                                           style_attr=style_attr,
-#                                                           core_cnt=3)
-# roi_feature_visualizer.create_visualization()
-#
-# style_attr = {'ROI_centers': True, 'ROI_ear_tags': True, 'Directionality': True, 'Directionality_style': 'Funnel', 'Border_color': (0, 128, 0), 'Pose_estimation': True}
-# test = ROIfeatureVisualizerMultiprocess(config_path='/Users/simon/Desktop/envs/simba_dev/tests/test_data/mouse_open_field/project_folder/project_config.ini', video_name='Video1.mp4', style_attr=style_attr, core_cnt=5)
-# test.create_visualization()
+    def run(self):
+        video_timer = SimbaTimer(start=True)
+        max_dim = max(self.video_meta_data["width"], self.video_meta_data["height"])
+        self.scalers = {}
+        self.scalers["circle_size"] = int(TextOptions.RADIUS_SCALER.value / (TextOptions.RESOLUTION_SCALER.value / max_dim))
+        self.scalers["font_size"] = float(TextOptions.FONT_SCALER.value / (TextOptions.RESOLUTION_SCALER.value / max_dim))
+        self.scalers["space_size"] = int(TextOptions.SPACE_SCALER.value / (TextOptions.RESOLUTION_SCALER.value / max_dim))
+        color_lst = create_color_palettes(self.roi_analyzer.animal_cnt, int((len(self.roi_analyzer.bp_names) / 3)))[0]
+        self.border_img_h, self.border_img_w = self.__get_bordered_img_size()
+        fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
+        writer = cv2.VideoWriter(self.video_save_path, fourcc, self.video_meta_data["fps"], (self.border_img_w, self.border_img_h))
+        self.loc_dict = self.__calc_text_locs()
+        self.cnt_dict = self.__create_counters()
+        self.shape_dicts = self.__create_shape_dicts()
+        self.__calculate_cumulative()
+        check_video_and_data_frm_count_align(video=self.video_path, data=self.data_df, name=self.video_name, raise_error=False)
+        frame_cnt = 0
+        while self.cap.isOpened():
+            ret, img = self.cap.read()
+            if ret:
+                self.border_img = cv2.copyMakeBorder(img, 0, 0, 0, int(self.video_meta_data["width"]),  borderType=cv2.BORDER_CONSTANT, value=[0, 0, 0])
+                self.__insert_texts(self.roi_analyzer.video_recs)
+                self.__insert_texts(self.roi_analyzer.video_circs)
+                self.__insert_texts(self.roi_analyzer.video_polys)
+                for _, row in self.roi_analyzer.video_recs.iterrows():
+                    top_left_x, top_left_y, shape_name = (row["topLeftX"], row["topLeftY"], row["Name"])
+                    bottom_right_x, bottom_right_y = (row["Bottom_right_X"], row["Bottom_right_Y"])
+                    thickness, color = row["Thickness"], row["Color BGR"]
+                    cv2.rectangle(self.border_img, (int(top_left_x), int(top_left_y)), (int(bottom_right_x), int(bottom_right_y)), color,int(thickness))
+                for _, row in self.roi_analyzer.video_circs.iterrows():
+                    center_x, center_y, radius, shape_name = (row["centerX"],row["centerY"],row["radius"],row["Name"])
+                    thickness, color = row["Thickness"], row["Color BGR"]
+                    cv2.circle(self.border_img,(center_x, center_y),radius,color,int(thickness))
+                for _, row in self.roi_analyzer.video_polys.iterrows():
+                    vertices, shape_name = row["vertices"], row["Name"]
+                    thickness, color = row["Thickness"], row["Color BGR"]
+                    cv2.polylines(self.border_img,[vertices],True,color,thickness=int(thickness))
+                for animal_cnt, animal_name in enumerate(self.animal_id_lst):
+                    bp_data = (self.data_df.loc[frame_cnt, self.bp_dict[animal_name]].fillna(0.0).values)
+                    if self.threshold < bp_data[2]:
+                        if self.style_attr[SHOW_BODY_PARTS]:
+                            cv2.circle(self.border_img, (int(bp_data[0]), int(bp_data[1])), self.scalers["circle_size"], color_lst[animal_cnt], -1)
+                        if self.style_attr[SHOW_ANIMAL_NAMES]:
+                            cv2.putText(self.border_img, animal_name, (int(bp_data[0]), int(bp_data[1])), self.font, self.scalers["font_size"], color_lst[animal_cnt], TextOptions.TEXT_THICKNESS.value)
+                for animal_cnt, animal_name in enumerate(self.animal_id_lst):
+                    for shape in self.shape_names:
+                        time = str(round(self.data_df.loc[frame_cnt, f"{animal_name}_{shape}_cum_sum_time"], 2))
+                        entries = str(int(self.data_df.loc[frame_cnt, f"{animal_name}_{shape}_cum_sum_entries"]))
+                        cv2.putText(self.border_img, time, self.loc_dict[animal_name][shape]["timer_data_loc"], self.font, self.scalers["font_size"], self.shape_dicts[shape]["Color BGR"], TextOptions.TEXT_THICKNESS.value)
+                        cv2.putText(self.border_img, entries, self.loc_dict[animal_name][shape]["entries_data_loc"], self.font, self.scalers["font_size"], self.shape_dicts[shape]["Color BGR"], TextOptions.TEXT_THICKNESS.value)
+                writer.write(self.border_img)
+                print(f"Frame: {frame_cnt+1} / {self.video_meta_data['frame_count']}, Video: {self.video_name}.")
+                frame_cnt += 1
+            else:
+                break
+        writer.release()
+        video_timer.stop_timer()
+        stdout_success(msg=f"Video {self.video_name} created. Video saved at {self.video_save_path}", elapsed_time=video_timer.elapsed_time_str, source=self.__class__.__name__)
+
+
+# test = ROIPlot(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/project_config.ini',
+#                video_path="/Users/simon/Desktop/envs/simba/troubleshooting/mouse_open_field/project_folder/videos/SI_DAY3_308_CD1_PRESENT.mp4",
+#                style_attr={'show_body_part': True, 'show_animal_name': True})
+# test.run()
+
+
+
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
+#                video_path="termite_test.mp4",
+#                style_attr={'Show_body_part': True, 'Show_animal_name': True})
+# test.insert_data()
+# test.visualize_ROI_data()
+
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini', video_path="termite_test.mp4")
+# test.insert_data()
+# test.visualize_ROI_data()
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/troubleshooting/train_model_project/project_folder/project_config.ini', video_path=r"Together_1.avi")
+# test.insert_data()
+# test.visualize_ROI_data()
+
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                video_path="Together_1.avi",
+#                style_attr={'Show_body_part': True, 'Show_animal_name': False},
+#                body_parts={f'Simon': 'Ear_left_1'})
+# test.insert_data()
+# test.run()
+
+# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
+#                video_path="termite_test.mp4",
+#                style_attr={'Show_body_part': True, 'Show_animal_name': True},
+#                body_parts={f'Simon': 'Termite_1_Head_1'})
+# test.insert_data()
+# test.run()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/data_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/data_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/spontaneous_alternation_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/spontaneous_alternation_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/path_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/path_plotter.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,22 +1,22 @@
 __author__ = "Simon Nilsson"
 
 import os
 import shutil
 from copy import deepcopy
-from typing import Dict, List, Optional, Union, Any
-
+from typing import Any, Dict, List, Optional, Union
 
 import cv2
 import numpy as np
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.plotting_mixin import PlottingMixin
 from simba.utils.checks import (
-    check_all_file_names_are_represented_in_video_log, check_if_keys_exist_in_dict,
+    check_all_file_names_are_represented_in_video_log,
+    check_if_keys_exist_in_dict,
     check_if_string_value_is_valid_video_timestamp, check_if_valid_rgb_str,
     check_instance, check_int, check_that_column_exist,
     check_that_hhmmss_start_is_before_end, check_valid_lst)
 from simba.utils.data import find_frame_numbers_from_time_stamp
 from simba.utils.enums import Formats, TagNames
 from simba.utils.errors import FrameRangeError, NoSpecifiedOutputError
 from simba.utils.printing import SimbaTimer, log_event, stdout_success
@@ -39,25 +39,25 @@
     STYLE_FONT_SIZE,
     STYLE_FONT_THICKNESS,
     STYLE_CIRCLE_SIZE,
     STYLE_MAX_LINES,
 ]
 
 
-
-
 class PathPlotterSingleCore(ConfigReader, PlottingMixin):
     """
-    Create "path plots" videos and/or images detailing the movement paths of
-    individual animals in SimBA.
+    Create "path plots" videos and/or images detailing the movement paths of individual animals in SimBA.
 
     .. note::
         For improved run-time, see :meth:`simba.path_plotter_mp.PathPlotterMulticore` for multiprocess class.
+
        `Visualization tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/tutorial.md#step-11-visualizations>`__.
 
+       `Notebook example <https://simba-uw-tf-dev.readthedocs.io/en/latest/nb/path_plots.html>`__.
+
     .. image:: _static/img/path_plot.png
        :width: 300
        :align: center
 
     :param str config_path: Path to SimBA project config file in Configparser format
     :param bool frame_setting: If True, individual frames will be created.
     :param bool video_setting: If True, compressed videos will be created.
@@ -71,204 +71,352 @@
 
     :examples:
     >>> style_attr = {'width': 'As input', 'height': 'As input', 'line width': 5, 'font size': 5, 'font thickness': 2, 'circle size': 5, 'bg color': 'White', 'max lines': 100, 'animal_names': True}
     >>> animal_attr = {0: ['Ear_right_1', 'Red']}
     >>> path_plotter = PathPlotterSingleCore(config_path=r'MyConfigPath', frame_setting=False, video_setting=True, style_attr=style_attr, animal_attr=animal_attr, files_found=['project_folder/csv/machine_results/MyVideo.csv'], print_animal_names=True).run()
     """
 
-    def __init__(self,
-                 config_path: Union[str, os.PathLike],
-                 files_found: List[Union[str, os.PathLike]],
-                 animal_attr: dict,
-                 input_style_attr: Optional[Union[Dict[str, Any], None]] = None,
-                 clf_attr: Optional[Dict[int, List[str]]] = None,
-                 frame_setting: Union[bool] = False,
-                 video_setting: Union[bool] = False,
-                 last_frame: Union[bool] = False,
-                 print_animal_names: Optional[bool] = True,
-                 slicing: Optional[Dict] = None):
-
-        log_event(logger_name=str(__class__.__name__), log_type=TagNames.CLASS_INIT.value, msg=self.create_log_msg_from_init_args(locals=locals()))
+    def __init__(
+        self,
+        config_path: Union[str, os.PathLike],
+        files_found: List[Union[str, os.PathLike]],
+        animal_attr: dict,
+        input_style_attr: Optional[Union[Dict[str, Any], None]] = None,
+        clf_attr: Optional[Dict[int, List[str]]] = None,
+        frame_setting: Union[bool] = False,
+        video_setting: Union[bool] = False,
+        last_frame: Union[bool] = False,
+        print_animal_names: Optional[bool] = True,
+        slicing: Optional[Dict] = None,
+    ):
+
+        log_event(
+            logger_name=str(__class__.__name__),
+            log_type=TagNames.CLASS_INIT.value,
+            msg=self.create_log_msg_from_init_args(locals=locals()),
+        )
         if (not frame_setting) and (not video_setting) and (not last_frame):
-            raise NoSpecifiedOutputError(msg="SIMBA ERROR: Please choice to create path frames and/or video path plots", source=self.__class__.__name__,)
-        check_valid_lst(data=files_found, source=self.__class__.__name__, valid_dtypes=(str,), min_len=1)
-        if input_style_attr is not None: check_if_keys_exist_in_dict(data=input_style_attr, key=STYLE_KEYS, name="input_style_attr")
+            raise NoSpecifiedOutputError(
+                msg="SIMBA ERROR: Please choice to create path frames and/or video path plots",
+                source=self.__class__.__name__,
+            )
+        check_valid_lst(
+            data=files_found,
+            source=self.__class__.__name__,
+            valid_dtypes=(str,),
+            min_len=1,
+        )
+        if input_style_attr is not None:
+            check_if_keys_exist_in_dict(
+                data=input_style_attr, key=STYLE_KEYS, name="input_style_attr"
+            )
         ConfigReader.__init__(self, config_path=config_path)
         PlottingMixin.__init__(self)
-        self.video_setting, self.frame_setting, self.input_style_attr, self.files_found, self.animal_attr, self.clf_attr, self.last_frame = video_setting, frame_setting, input_style_attr, files_found, animal_attr, clf_attr, last_frame
+        (
+            self.video_setting,
+            self.frame_setting,
+            self.input_style_attr,
+            self.files_found,
+            self.animal_attr,
+            self.clf_attr,
+            self.last_frame,
+        ) = (
+            video_setting,
+            frame_setting,
+            input_style_attr,
+            files_found,
+            animal_attr,
+            clf_attr,
+            last_frame,
+        )
         self.print_animal_names, self.slicing = print_animal_names, slicing
         if not os.path.exists(self.path_plot_dir):
             os.makedirs(self.path_plot_dir)
         print(f"Processing {len(self.files_found)} videos...")
 
     def __get_styles(self):
         self.style_attr = {}
         if self.input_style_attr is not None:
             self.style_attr["bg color"] = self.input_style_attr["bg color"]
             if self.input_style_attr["max lines"] == "entire video":
                 self.style_attr["max lines"] = len(self.data_df)
             else:
-                self.style_attr["max lines"] = max(1, int(int(self.input_style_attr["max lines"] / 1000) * (int(self.video_info["fps"].values[0]))))
+                self.style_attr["max lines"] = max(
+                    1,
+                    int(
+                        int(self.input_style_attr["max lines"] / 1000)
+                        * (int(self.video_info["fps"].values[0]))
+                    ),
+                )
             self.style_attr["font thickness"] = self.input_style_attr["font thickness"]
             self.style_attr["line width"] = self.input_style_attr["line width"]
             self.style_attr["font size"] = self.input_style_attr["font size"]
             self.style_attr["circle size"] = self.input_style_attr["circle size"]
             self.style_attr["print_animal_names"] = self.print_animal_names
             if self.input_style_attr["width"] == "As input":
-                self.style_attr["width"], self.style_attr["height"] = int(self.video_info["Resolution_width"].values[0]), int(self.video_info["Resolution_height"].values[0])
+                self.style_attr["width"], self.style_attr["height"] = int(
+                    self.video_info["Resolution_width"].values[0]
+                ), int(self.video_info["Resolution_height"].values[0])
             else:
                 pass
         else:
             space_scaler, radius_scaler, res_scaler, font_scaler = 25, 10, 1500, 0.8
-            self.style_attr["width"] = int(self.video_info["Resolution_width"].values[0])
-            self.style_attr["height"] = int(self.video_info["Resolution_height"].values[0])
+            self.style_attr["width"] = int(
+                self.video_info["Resolution_width"].values[0]
+            )
+            self.style_attr["height"] = int(
+                self.video_info["Resolution_height"].values[0]
+            )
             max_res = max(self.style_attr["width"], self.style_attr["height"])
             self.style_attr["circle size"] = int(radius_scaler / (res_scaler / max_res))
-            self.style_attr["font size"] = min(0.5, (font_scaler / (res_scaler / max_res)))
+            self.style_attr["font size"] = min(
+                0.5, (font_scaler / (res_scaler / max_res))
+            )
             self.style_attr["bg color"] = self.color_dict["White"]
             self.style_attr["print_animal_names"] = self.print_animal_names
             self.style_attr["max lines"] = len(self.data_df)
             self.style_attr["font thickness"] = 2
             self.style_attr["line width"] = 2
 
     def run(self):
-        check_all_file_names_are_represented_in_video_log(video_info_df=self.video_info_df, data_paths=self.files_found)
+        check_all_file_names_are_represented_in_video_log(
+            video_info_df=self.video_info_df, data_paths=self.files_found
+        )
         for file_cnt, file_path in enumerate(self.files_found):
             video_timer = SimbaTimer(start=True)
             _, self.video_name, _ = get_fn_ext(file_path)
-            self.video_info, _, self.fps = self.read_video_info(video_name=self.video_name)
+            self.video_info, _, self.fps = self.read_video_info(
+                video_name=self.video_name
+            )
             self.data_df = read_df(file_path, self.file_type)
             line_data, colors, animal_names = [], [], []
             for k, v in self.animal_attr.items():
-                check_if_keys_exist_in_dict(data=v, key=['bp', 'color'], name=f'animal attr {k}')
-                line_data.append(self.data_df[[f'{v["bp"]}_x', f'{v["bp"]}_y']].values.astype(np.int64))
-                colors.append(v['color'])
+                check_if_keys_exist_in_dict(
+                    data=v, key=["bp", "color"], name=f"animal attr {k}"
+                )
+                line_data.append(
+                    self.data_df[[f'{v["bp"]}_x', f'{v["bp"]}_y']].values.astype(
+                        np.int64
+                    )
+                )
+                colors.append(v["color"])
                 if self.print_animal_names:
-                    animal_names.append(self.find_animal_name_from_body_part_name(bp_name=v["bp"], bp_dict=self.animal_bp_dict))
-            if not self.print_animal_names: animal_names = None
+                    animal_names.append(
+                        self.find_animal_name_from_body_part_name(
+                            bp_name=v["bp"], bp_dict=self.animal_bp_dict
+                        )
+                    )
+            if not self.print_animal_names:
+                animal_names = None
 
             if self.slicing:
-                check_if_keys_exist_in_dict(data=self.slicing, key=["start_time", "end_time"])
-                check_if_string_value_is_valid_video_timestamp(value=self.slicing["start_time"], name="slice start time")
-                check_if_string_value_is_valid_video_timestamp(value=self.slicing["end_time"], name="slice end time")
-                check_that_hhmmss_start_is_before_end(start_time=self.slicing["start_time"], end_time=self.slicing["end_time"], name="slice times")
-                frm_numbers = find_frame_numbers_from_time_stamp(start_time=self.slicing["start_time"], end_time=self.slicing["end_time"], fps=self.fps)
+                check_if_keys_exist_in_dict(
+                    data=self.slicing, key=["start_time", "end_time"]
+                )
+                check_if_string_value_is_valid_video_timestamp(
+                    value=self.slicing["start_time"], name="slice start time"
+                )
+                check_if_string_value_is_valid_video_timestamp(
+                    value=self.slicing["end_time"], name="slice end time"
+                )
+                check_that_hhmmss_start_is_before_end(
+                    start_time=self.slicing["start_time"],
+                    end_time=self.slicing["end_time"],
+                    name="slice times",
+                )
+                frm_numbers = find_frame_numbers_from_time_stamp(
+                    start_time=self.slicing["start_time"],
+                    end_time=self.slicing["end_time"],
+                    fps=self.fps,
+                )
                 if len(set(frm_numbers) - set(self.data_df.index)) > 0:
-                    raise FrameRangeError(msg=f'The chosen time-period ({self.slicing["start_time"]} - {self.slicing["end_time"]}) does not exist in {self.video_name}.', source=self.__class__.__name__)
+                    raise FrameRangeError(
+                        msg=f'The chosen time-period ({self.slicing["start_time"]} - {self.slicing["end_time"]}) does not exist in {self.video_name}.',
+                        source=self.__class__.__name__,
+                    )
                 for i in range(len(line_data)):
-                    line_data[i] = line_data[i][frm_numbers,:]
+                    line_data[i] = line_data[i][frm_numbers, :]
             self.__get_styles()
 
             if self.video_setting:
-                self.video_save_path = os.path.join(self.path_plot_dir, f"{self.video_name}.mp4")
+                self.video_save_path = os.path.join(
+                    self.path_plot_dir, f"{self.video_name}.mp4"
+                )
                 self.fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-                self.writer = cv2.VideoWriter(self.video_save_path, self.fourcc, self.fps, (self.style_attr["width"], self.style_attr["height"]))
+                self.writer = cv2.VideoWriter(
+                    self.video_save_path,
+                    self.fourcc,
+                    self.fps,
+                    (self.style_attr["width"], self.style_attr["height"]),
+                )
             if self.frame_setting:
-                self.save_video_folder = os.path.join(self.path_plot_dir, self.video_name)
+                self.save_video_folder = os.path.join(
+                    self.path_plot_dir, self.video_name
+                )
                 if os.path.exists(self.save_video_folder):
                     shutil.rmtree(path=self.save_video_folder)
                 os.makedirs(self.save_video_folder)
 
             if self.clf_attr is not None:
                 self.clf_attr_appended = {}
-                check_instance(source=self.__class__.__name__, instance=self.clf_attr, accepted_types=(dict,))
+                check_instance(
+                    source=self.__class__.__name__,
+                    instance=self.clf_attr,
+                    accepted_types=(dict,),
+                )
                 for k, v in self.clf_attr.items():
-                    check_if_keys_exist_in_dict(data=v, key=['color', 'size'], name=f'clf_attr {k}')
-                    check_that_column_exist(df=self.data_df, column_name=k, file_name=file_path)
+                    check_if_keys_exist_in_dict(
+                        data=v, key=["color", "size"], name=f"clf_attr {k}"
+                    )
+                    check_that_column_exist(
+                        df=self.data_df, column_name=k, file_name=file_path
+                    )
                     self.clf_attr_appended[k] = self.clf_attr[k]
-                    self.clf_attr_appended[k]["clfs"] = self.data_df[k].values.astype(np.int8)
-                    self.clf_attr_appended[k]["positions"] = self.data_df[[self.animal_attr[0]['bp'] + "_x", self.animal_attr[0]['bp'] + "_y"]].values.astype(np.int64)
-                self.clf_attr = deepcopy(self.clf_attr_appended); del self.clf_attr_appended
+                    self.clf_attr_appended[k]["clfs"] = self.data_df[k].values.astype(
+                        np.int8
+                    )
+                    self.clf_attr_appended[k]["positions"] = self.data_df[
+                        [
+                            self.animal_attr[0]["bp"] + "_x",
+                            self.animal_attr[0]["bp"] + "_y",
+                        ]
+                    ].values.astype(np.int64)
+                self.clf_attr = deepcopy(self.clf_attr_appended)
+                del self.clf_attr_appended
 
             self.video_path = None
             if type(self.style_attr["bg color"]) == dict:
-                check_if_keys_exist_in_dict(data=self.style_attr["bg color"],key=["type", "opacity", "frame_index"],)
-                self.video_path = find_video_of_file(video_dir=self.video_dir, filename=self.video_name, raise_error=True)
+                check_if_keys_exist_in_dict(
+                    data=self.style_attr["bg color"],
+                    key=["type", "opacity", "frame_index"],
+                )
+                self.video_path = find_video_of_file(
+                    video_dir=self.video_dir, filename=self.video_name, raise_error=True
+                )
                 video_meta_data = get_video_meta_data(video_path=self.video_path)
                 if "frame_index" in self.style_attr["bg color"].keys():
-                    check_int(name="Static frame index", value=self.style_attr["bg color"]["frame_index"], min_value=0)
+                    check_int(
+                        name="Static frame index",
+                        value=self.style_attr["bg color"]["frame_index"],
+                        min_value=0,
+                    )
                     frame_index = self.style_attr["bg color"]["frame_index"]
                 else:
                     frame_index = video_meta_data["frame_count"] - 1
-                self.style_attr["bg color"] = read_frm_of_video(video_path=self.video_path, opacity=self.style_attr["bg color"]["opacity"], frame_index=frame_index)
+                self.style_attr["bg color"] = read_frm_of_video(
+                    video_path=self.video_path,
+                    opacity=self.style_attr["bg color"]["opacity"],
+                    frame_index=frame_index,
+                )
 
             if self.last_frame:
-                PlottingMixin.make_path_plot(data=line_data,
-                               colors=colors,
-                               width=self.style_attr['width'],
-                               height=self.style_attr['height'],
-                               max_lines=self.style_attr['max lines'],
-                               bg_clr=self.style_attr["bg color"],
-                               circle_size=self.style_attr["circle size"],
-                               font_size=self.style_attr["font size"],
-                               font_thickness=self.style_attr["font thickness"],
-                               line_width=self.style_attr["line width"],
-                               animal_names=animal_names,
-                               clf_attr=self.clf_attr,
-                               save_path=os.path.join(self.path_plot_dir, f"{self.video_name}_final_frame.png"))
+                PlottingMixin.make_path_plot(
+                    data=line_data,
+                    colors=colors,
+                    width=self.style_attr["width"],
+                    height=self.style_attr["height"],
+                    max_lines=self.style_attr["max lines"],
+                    bg_clr=self.style_attr["bg color"],
+                    circle_size=self.style_attr["circle size"],
+                    font_size=self.style_attr["font size"],
+                    font_thickness=self.style_attr["font thickness"],
+                    line_width=self.style_attr["line width"],
+                    animal_names=animal_names,
+                    clf_attr=self.clf_attr,
+                    save_path=os.path.join(
+                        self.path_plot_dir, f"{self.video_name}_final_frame.png"
+                    ),
+                )
 
             bg = self.style_attr["bg color"]
             if self.video_setting or self.frame_setting:
                 if self.input_style_attr is not None:
                     self.capture = cv2.VideoCapture(self.video_path)
-                    if (type(self.input_style_attr["bg color"]) == dict) and (self.input_style_attr["bg color"]["type"]) == "static":
-                        bg = read_frm_of_video(video_path=self.capture, opacity=self.input_style_attr["bg color"]["opacity"], frame_index=self.input_style_attr["bg color"]["frame_index"])
+                    if (type(self.input_style_attr["bg color"]) == dict) and (
+                        self.input_style_attr["bg color"]["type"]
+                    ) == "static":
+                        bg = read_frm_of_video(
+                            video_path=self.capture,
+                            opacity=self.input_style_attr["bg color"]["opacity"],
+                            frame_index=self.input_style_attr["bg color"][
+                                "frame_index"
+                            ],
+                        )
 
                 for frm_cnt in range(1, line_data[0].shape[0]):
                     plot_arrs = [x[:frm_cnt, :] for x in line_data]
                     if self.input_style_attr is not None:
-                        if (type(self.input_style_attr["bg color"]) == dict) and (self.input_style_attr["bg color"]["type"] == "moving"):
-                            bg = read_frm_of_video(video_path=self.capture, opacity=self.input_style_attr["bg color"]["opacity"], frame_index=frm_cnt)
+                        if (type(self.input_style_attr["bg color"]) == dict) and (
+                            self.input_style_attr["bg color"]["type"] == "moving"
+                        ):
+                            bg = read_frm_of_video(
+                                video_path=self.capture,
+                                opacity=self.input_style_attr["bg color"]["opacity"],
+                                frame_index=frm_cnt,
+                            )
 
                     self.clf_attr_cpy = deepcopy(self.clf_attr)
                     if self.clf_attr is not None:
                         for k, v in self.clf_attr.items():
-                            self.clf_attr_cpy[k]['clfs'][frm_cnt + 1:] = 0
+                            self.clf_attr_cpy[k]["clfs"][frm_cnt + 1 :] = 0
 
-                    img = PlottingMixin.make_path_plot(data=plot_arrs,
-                                         colors=colors,
-                                         width=self.style_attr['width'],
-                                         height=self.style_attr['height'],
-                                         max_lines=self.style_attr['max lines'],
-                                         bg_clr=bg,
-                                         circle_size=self.style_attr["circle size"],
-                                         font_size=self.style_attr["font size"],
-                                         font_thickness=self.style_attr["font thickness"],
-                                         line_width=self.style_attr["line width"],
-                                         animal_names=animal_names,
-                                         clf_attr=self.clf_attr_cpy,
-                                         save_path=None)
+                    img = PlottingMixin.make_path_plot(
+                        data=plot_arrs,
+                        colors=colors,
+                        width=self.style_attr["width"],
+                        height=self.style_attr["height"],
+                        max_lines=self.style_attr["max lines"],
+                        bg_clr=bg,
+                        circle_size=self.style_attr["circle size"],
+                        font_size=self.style_attr["font size"],
+                        font_thickness=self.style_attr["font thickness"],
+                        line_width=self.style_attr["line width"],
+                        animal_names=animal_names,
+                        clf_attr=self.clf_attr_cpy,
+                        save_path=None,
+                    )
 
                     if self.video_setting:
                         self.writer.write(np.uint8(img))
                     if self.frame_setting:
-                        frm_name = os.path.join(self.save_video_folder, str() + f"{frm_cnt}.png")
+                        frm_name = os.path.join(
+                            self.save_video_folder, str() + f"{frm_cnt}.png"
+                        )
                         cv2.imwrite(frm_name, np.uint8(img))
-                    print(f"Path frame: {frm_cnt + 1} / {line_data[0].shape[0]}) created. Video: {self.video_name} ({str(file_cnt + 1)}/{len(self.files_found)})")
+                    print(
+                        f"Path frame: {frm_cnt + 1} / {line_data[0].shape[0]}) created. Video: {self.video_name} ({str(file_cnt + 1)}/{len(self.files_found)})"
+                    )
                 if self.video_setting:
                     self.writer.release()
                 video_timer.stop_timer()
-                print(f"Path visualization for video {self.video_name} saved (elapsed time {video_timer.elapsed_time_str}s)...")
+                print(
+                    f"Path visualization for video {self.video_name} saved (elapsed time {video_timer.elapsed_time_str}s)..."
+                )
 
         self.timer.stop_timer()
-        stdout_success(msg=f"Path visualizations for {len(self.files_found)} video(s) saved in {self.path_plot_dir} directory", elapsed_time=self.timer.elapsed_time_str, source=self.__class__.__name__,)
+        stdout_success(
+            msg=f"Path visualizations for {len(self.files_found)} video(s) saved in {self.path_plot_dir} directory",
+            elapsed_time=self.timer.elapsed_time_str,
+            source=self.__class__.__name__,
+        )
+
 
 #
 # style_attr = {'width': 'As input',
 #               'height': 'As input',
 #               'line width': 2,
 #               'font size': 0.9,
 #               'font thickness': 2,
 #               'circle size': 5,
 #               'bg color': {'type': 'moving', 'opacity': 50, 'frame_index': 200}, #{'type': 'static', 'opacity': 100, 'frame_index': 200}
 #               'max lines': 'entire video'}
 # #
-#animal_attr = {0: {'bp': 'Ear_right_1', 'color': (255, 0, 0)}, 1: {'bp': 'Ear_right_2', 'color': (0, 0, 255)}}  #['Ear_right_1', 'Red'], 1: ['Ear_right_2', 'Green']}
-#clf_attr = {'Nose to Nose': {'color': (155, 1, 10), 'size': 30}, 'Nose to Tailbase': {'color': (155, 90, 10), 'size': 30}}
-#style_attr = None
+# animal_attr = {0: {'bp': 'Ear_right_1', 'color': (255, 0, 0)}, 1: {'bp': 'Ear_right_2', 'color': (0, 0, 255)}}  #['Ear_right_1', 'Red'], 1: ['Ear_right_2', 'Green']}
+# clf_attr = {'Nose to Nose': {'color': (155, 1, 10), 'size': 30}, 'Nose to Tailbase': {'color': (155, 90, 10), 'size': 30}}
+# style_attr = None
 # test = PathPlotterSingleCore(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/beepboop174/project_folder/project_config.ini',
 #                              frame_setting=True,
 #                              video_setting=True,
 #                              last_frame=True,
 #                              slicing=None,#{'start_time': '00:00:00', 'end_time': '00:00:05'}, #{'start_time': '00:00:00', 'end_time': '00:00:50'}, #{'start_time': '00:00:00', 'end_time': '00:00:01'},, #{'start_time': '00:00:00', 'end_time': '00:00:01'}, #{'start_time': '00:00:00', 'end_time': '00:00:01'},
 #                              input_style_attr=style_attr,
 #                              animal_attr=animal_attr,
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/distance_plotter_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/distance_plotter_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/ROI_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/ROI_feature_visualizer.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,530 +1,459 @@
 __author__ = "Simon Nilsson"
 
 import itertools
 import os
-from copy import deepcopy
-from typing import List, Optional, Union
+from typing import Any, Dict, List, Union
 
 import cv2
 import numpy as np
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.plotting_mixin import PlottingMixin
-from simba.roi_tools.ROI_analyzer import ROIAnalyzer
-from simba.utils.data import create_color_palettes
-from simba.utils.enums import Formats, Paths, TagNames, TextOptions
-from simba.utils.errors import DuplicationError, NoFilesFoundError
-from simba.utils.printing import SimbaTimer, log_event, stdout_success
-from simba.utils.read_write import (get_fn_ext, get_video_meta_data,
-                                    read_config_entry)
+from simba.roi_tools.ROI_feature_analyzer import ROIFeatureCreator
+from simba.utils.checks import (check_file_exist_and_readable,
+                                check_if_keys_exist_in_dict, check_int,
+                                check_valid_array, check_valid_dataframe,
+                                check_valid_lst,
+                                check_video_and_data_frm_count_align)
+from simba.utils.data import slice_roi_dict_for_video
+from simba.utils.enums import Formats, Keys, TextOptions
+from simba.utils.errors import (BodypartColumnNotFoundError, NoFilesFoundError,
+                                ROICoordinatesNotFoundError)
+from simba.utils.printing import stdout_success
+from simba.utils.read_write import get_fn_ext, get_video_meta_data, read_df
 from simba.utils.warnings import DuplicateNamesWarning
 
+ROI_CENTERS = "roi_centers"
+ROI_EAR_TAGS = "roi_ear_tags"
+DIRECTIONALITY = "directionality"
+DIRECTIONALITY_STYLE = "directionality_style"
+BORDER_COLOR = "border_color"
+POSE = "pose_estimation"
+ANIMAL_NAMES = "animal_names"
+
+STYLE_KEYS = [
+    ROI_CENTERS,
+    ROI_EAR_TAGS,
+    DIRECTIONALITY,
+    BORDER_COLOR,
+    POSE,
+    DIRECTIONALITY_STYLE,
+    ANIMAL_NAMES,
+]
 
-class ROIPlot(ConfigReader, PlottingMixin):
+
+class ROIfeatureVisualizer(ConfigReader):
     """
-    Visualize the ROI data (number of entries/exits, time-spent in ROIs etc).
+    Visualizing features that depend on the relationships between the location of the animals and user-defined
+    ROIs. E.g., distances to centroids of ROIs, if animals are directing towards ROIs, and if animals are within ROIs.
 
     .. note::
-       `ROI tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial_new.md>`__.
-
-       Use :meth:`simba.plotting.ROI_plotter_mp.ROIPlotMultiprocess` for improved run-time.
-
+       For improved run-time, see :meth:`simba.ROI_feature_visualizer_mp.ROIfeatureVisualizerMultiprocess` for multiprocess class.
+       `Tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial.md#part-5-visualizing-roi-features>`__.
 
-
-    :param str config_path: Path to SimBA project config file in Configparser format
-    :param str video_path: Name of video to create ROI visualizations for
-    :param dict style_attr: User-defined visualization settings.
-
-    Examples
-    ----------
-    >>> settings = {'Show_body_part': True, 'Show_animal_name': True}
-    >>> roi_visualizer = ROIPlot(ini_path=r'MyProjectConfig', video_path="MyVideo.mp4", settings=settings)
-    >>> roi_visualizer.insert_data()
-    >>> roi_visualizer.run()
+    .. image:: _static/img/roi_visualize.png
+       :width: 400
+       :align: center
+
+    .. image:: _static/img/ROIfeatureVisualizer_1.png
+       :width: 700
+       :align: center
+
+    .. image:: _static/img/ROIfeatureVisualizer_2.png
+       :width: 700
+       :align: center
+
+    :param Union[str, os.PathLike] config_path: Path to SimBA project config file in Configparser format
+    :param Union[str, os.PathLike] video_path: Path to video file to overlay ROI features on.
+    :param List[str] body_parts: List of body-parts to use as proxy for animal location(s).
+    :param Dict[str, Any] style_attr: User-defined styles (sizes, colors etc.)
+
+    :example:
+    >>> style_attr = {'roi_centers': True, 'roi_ear_tags': True, 'directionality': True, 'directionality_style': 'funnel', 'border_color': (0, 0, 0), 'pose_estimation': True, 'animal_names': True}
+    >>> test = ROIfeatureVisualizer(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/project_config.ini', video_path='/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/videos/2022-06-20_NOB_DOT_4.mp4', style_attr=style_attr, body_parts=['Nose'])
+    >>> test.run()
     """
 
     def __init__(
         self,
-        ini_path: Union[str, os.PathLike],
+        config_path: Union[str, os.PathLike],
         video_path: Union[str, os.PathLike],
-        style_attr: dict,
-        body_parts: Optional[dict] = None,
-        threshold: Optional[float] = None,
+        body_parts: List[str],
+        style_attr: Dict[str, Any],
     ):
 
-        ConfigReader.__init__(self, config_path=ini_path)
-        PlottingMixin.__init__(self)
-        log_event(
-            logger_name=str(__class__.__name__),
-            log_type=TagNames.CLASS_INIT.value,
-            msg=self.create_log_msg_from_init_args(locals=locals()),
+        check_file_exist_and_readable(file_path=config_path)
+        check_file_exist_and_readable(file_path=video_path)
+        check_if_keys_exist_in_dict(
+            data=style_attr,
+            key=STYLE_KEYS,
+            name=f"{self.__class__.__name__} style_attr",
         )
-
-        settings = None
-        if body_parts:
-            settings = {"body_parts": body_parts}
-            if threshold:
-                settings["threshold"] = threshold
-            else:
-                settings["threshold"] = 0.0
-            self.animal_id_lst = list(body_parts.keys())
-        if threshold:
-            self.threshold = threshold
-        else:
-            self.threshold = 0.0
-
-        self.roi_analyzer = ROIAnalyzer(
-            ini_path=ini_path,
-            data_path="outlier_corrected_movement_location",
-            settings=settings,
-        )
-        if not body_parts:
-            self.animal_id_lst = self.roi_analyzer.multi_animal_id_list
-        self.video_dir_path = os.path.join(self.roi_analyzer.project_path, "videos")
-        self.video_path = os.path.join(self.video_dir_path, video_path)
         _, self.video_name, _ = get_fn_ext(video_path)
-        self.roi_analyzer.files_found = [
-            os.path.join(
-                self.roi_analyzer.input_folder,
-                self.video_name + "." + self.roi_analyzer.file_type,
+        ConfigReader.__init__(self, config_path=config_path)
+        if not os.path.isfile(self.roi_coordinates_path):
+            raise ROICoordinatesNotFoundError(
+                expected_file_path=self.roi_coordinates_path
             )
-        ]
-        if not os.path.isfile(self.roi_analyzer.files_found[0]):
+        self.read_roi_data()
+        self.roi_dict, shape_names = slice_roi_dict_for_video(
+            data=self.roi_dict, video_name=self.video_name
+        )
+        self.data_path = os.path.join(
+            self.outlier_corrected_dir, f"{self.video_name}.{self.file_type}"
+        )
+        if not os.path.isfile(self.data_path):
             raise NoFilesFoundError(
-                msg="SIMBA ERROR: Could not find the file at path {}. Please make sure you have corrected body-part outliers or indicated that you want to skip outlier correction".format(
-                    self.roi_analyzer.files_found[0]
-                ),
+                msg=f"SIMBA ERROR: Could not find the file at path {self.data_path}. Make sure the data file exist to create ROI visualizations",
                 source=self.__class__.__name__,
             )
-        self.roi_analyzer.run()
-        self.roi_entries_df = self.roi_analyzer.detailed_df
-        self.data_df, self.style_attr = self.roi_analyzer.data_df, style_attr
-        self.video_shapes = list(
-            itertools.chain(
-                self.roi_analyzer.video_recs["Name"].unique(),
-                self.roi_analyzer.video_circs["Name"].unique(),
-                self.roi_analyzer.video_polys["Name"].unique(),
-            )
+        if not os.path.exists(self.roi_features_save_dir):
+            os.makedirs(self.roi_features_save_dir)
+        self.save_path = os.path.join(
+            self.roi_features_save_dir, f"{self.video_name}.mp4"
+        )
+        check_valid_lst(
+            data=body_parts,
+            source=f"{self.__class__.__name__} body-parts",
+            valid_dtypes=(str,),
+            min_len=1,
+        )
+        for bp in body_parts:
+            if bp not in self.body_parts_lst:
+                raise BodypartColumnNotFoundError(
+                    msg=f"The body-part {bp} is not a valid body-part in the SimBA project. Options: {self.body_parts_lst}",
+                    source=self.__class__.__name__,
+                )
+        self.roi_feature_creator = ROIFeatureCreator(
+            config_path=config_path,
+            body_parts=body_parts,
+            append_data=False,
+            data_path=self.data_path,
+        )
+        self.roi_feature_creator.run()
+        self.bp_lk = self.roi_feature_creator.bp_lk
+        self.animal_bp_names = [f"{v[0]} {v[1]}" for v in self.bp_lk.values()]
+        self.animal_names = [v[0] for v in self.bp_lk.values()]
+        self.video_meta_data = get_video_meta_data(video_path)
+        self.fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
+        self.cap = cv2.VideoCapture(video_path)
+        self.max_dim = max(
+            self.video_meta_data["width"], self.video_meta_data["height"]
         )
-        if len(list(set(self.video_shapes))) != len(self.video_shapes):
-            raise DuplicationError(
-                msg="Some SIMBA ROI shapes have identical names. Please use unique names to visualize ROI data.",
-                source=self.__class__.__name__,
-            )
-        self.roi_analyzer.video_recs = self.add_missing_ROI_cols(
-            self.roi_analyzer.video_recs
+        self.circle_size = int(
+            TextOptions.RADIUS_SCALER.value
+            / (TextOptions.RESOLUTION_SCALER.value / self.max_dim)
         )
-        self.roi_analyzer.video_circs = self.add_missing_ROI_cols(
-            self.roi_analyzer.video_circs
+        self.font_size = float(
+            TextOptions.FONT_SCALER.value
+            / (TextOptions.RESOLUTION_SCALER.value / self.max_dim)
         )
-        self.roi_analyzer.video_polys = self.add_missing_ROI_cols(
-            self.roi_analyzer.video_polys
+        self.spacing_scale = int(
+            TextOptions.SPACE_SCALER.value
+            / (TextOptions.RESOLUTION_SCALER.value / self.max_dim)
         )
-
-        self.shape_dicts = {}
-        for df in [
-            self.roi_analyzer.video_recs,
-            self.roi_analyzer.video_circs,
-            self.roi_analyzer.video_polys,
-        ]:
-            if not df["Name"].is_unique:
-                df = df.drop_duplicates(subset=["Name"], keep="first")
-                DuplicateNamesWarning(
-                    msg='Some of your ROIs with the same shape (i.e., circle, rectangle, polygon) has the same names. E.g., you have two rectangles named "My rectangle". SimBA prefers ROI shapes with unique names. SimBA will keep one of the unique shape names and drop the rest.',
-                    source=self.__class__.__name__,
-                )
-            d = df.set_index("Name").to_dict(orient="index")
-            self.shape_dicts = {**self.shape_dicts, **d}
-
-        self.shape_columns = []
-        for animal in self.animal_id_lst:
-            for shape_name in self.video_shapes:
-                self.data_df[animal + "_" + shape_name] = 0
-                self.shape_columns.append(animal + "_" + shape_name)
-        self.bp_dict = self.roi_analyzer.bp_dict
-        self.output_folder = os.path.join(
-            self.roi_analyzer.project_path, Paths.ROI_ANALYSIS.value
-        )
-        if not os.path.exists(self.output_folder):
-            os.makedirs(self.output_folder)
-        self.timer = SimbaTimer(start=True)
-
-    def insert_data(self):
-        """
-        Method to concat ROI and pose-estimation data.
-
-        Returns
-        -------
-        Attribute: pd.Dataframe
-            data_df
-
-        """
-        self.roi_entries_dict = self.roi_entries_df[
-            ["ANIMAL", "SHAPE", "ENTRY FRAMES", "EXIT FRAMES"]
-        ].to_dict(orient="records")
-        for entry_dict in self.roi_entries_dict:
-            entry, exit = int(entry_dict["ENTRY FRAMES"]), int(
-                entry_dict["EXIT FRAMES"]
-            )
-            entry_dict["frame_range"] = list(range(entry, exit + 1))
-            col_name = entry_dict["ANIMAL"] + "_" + entry_dict["SHAPE"]
-            self.data_df[col_name][
-                self.data_df.index.isin(entry_dict["frame_range"])
-            ] = 1
+        check_video_and_data_frm_count_align(
+            video=video_path, data=self.data_path, name=video_path, raise_error=False
+        )
+        self.style_attr = style_attr
+        self.direct_viable = self.roi_feature_creator.roi_directing_viable
+        self.data_df = read_df(file_path=self.data_path, file_type=self.file_type)
+        self.shape_dicts = self.__create_shape_dicts()
+        self.directing_df = self.roi_feature_creator.dr
 
     def __calc_text_locs(self):
-        line_spacer = deepcopy(TextOptions.FIRST_LINE_SPACING.value)
+        add_spacer = TextOptions.FIRST_LINE_SPACING.value
         self.loc_dict = {}
-        for animal_cnt, animal_name in enumerate(self.animal_id_lst):
+        for animal_cnt, animal_data in self.bp_lk.items():
+            animal, animal_bp, _ = animal_data
+            animal_name = f"{animal} {animal_bp}"
             self.loc_dict[animal_name] = {}
-            for shape in self.video_shapes:
+            self.loc_dict[animal] = {}
+            for shape in self.shape_names:
                 self.loc_dict[animal_name][shape] = {}
-                self.loc_dict[animal_name][shape]["timer_text"] = "{} {} {}".format(
-                    shape, animal_name, "timer:"
-                )
-                self.loc_dict[animal_name][shape]["entries_text"] = "{} {} {}".format(
-                    shape, animal_name, "entries:"
-                )
-                self.loc_dict[animal_name][shape]["timer_text_loc"] = (
-                    (self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value),
+                self.loc_dict[animal_name][shape][
+                    "in_zone_text"
+                ] = f"{shape} {animal_name} in zone"
+                self.loc_dict[animal_name][shape][
+                    "distance_text"
+                ] = f"{shape} {animal_name} distance"
+                self.loc_dict[animal_name][shape]["in_zone_text_loc"] = (
+                    (self.video_meta_data["width"] + 5),
                     (
                         self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.spacing_scaler * line_spacer
+                        - (self.video_meta_data["height"] + 10)
+                        + self.spacing_scale * add_spacer
                     ),
                 )
-                self.loc_dict[animal_name][shape]["timer_data_loc"] = (
-                    int(self.border_img_w - (self.border_img_w / 8)),
+                self.loc_dict[animal_name][shape]["in_zone_data_loc"] = (
+                    int(self.img_w_border_w - (self.img_w_border_w / 8)),
                     (
                         self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.spacing_scaler * line_spacer
+                        - (self.video_meta_data["height"] + 10)
+                        + self.spacing_scale * add_spacer
                     ),
                 )
-                line_spacer += 1
-                self.loc_dict[animal_name][shape]["entries_text_loc"] = (
-                    (self.video_meta_data["width"] + TextOptions.BORDER_BUFFER_X.value),
+                add_spacer += 1
+                self.loc_dict[animal_name][shape]["distance_text_loc"] = (
+                    (self.video_meta_data["width"] + 5),
                     (
                         self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.spacing_scaler * line_spacer
+                        - (self.video_meta_data["height"] + 10)
+                        + self.spacing_scale * add_spacer
                     ),
                 )
-                self.loc_dict[animal_name][shape]["entries_data_loc"] = (
-                    int(self.border_img_w - (self.border_img_w / 8)),
+                self.loc_dict[animal_name][shape]["distance_data_loc"] = (
+                    int(self.img_w_border_w - (self.img_w_border_w / 8)),
                     (
                         self.video_meta_data["height"]
-                        - (
-                            self.video_meta_data["height"]
-                            + TextOptions.BORDER_BUFFER_Y.value
-                        )
-                        + self.spacing_scaler * line_spacer
+                        - (self.video_meta_data["height"] + 10)
+                        + self.spacing_scale * add_spacer
                     ),
                 )
-                line_spacer += 1
+                add_spacer += 1
+                if self.direct_viable and self.style_attr[DIRECTIONALITY]:
+                    self.loc_dict[animal][shape] = {}
+                    self.loc_dict[animal][shape][
+                        "directing_text"
+                    ] = f"{shape} {animal} facing"
+                    self.loc_dict[animal][shape]["directing_text_loc"] = (
+                        (self.video_meta_data["width"] + 5),
+                        (
+                            self.video_meta_data["height"]
+                            - (self.video_meta_data["height"] + 10)
+                            + self.spacing_scale * add_spacer
+                        ),
+                    )
+                    self.loc_dict[animal][shape]["directing_data_loc"] = (
+                        int(self.img_w_border_w - (self.img_w_border_w / 8)),
+                        (
+                            self.video_meta_data["height"]
+                            - (self.video_meta_data["height"] + 10)
+                            + self.spacing_scale * add_spacer
+                        ),
+                    )
+                    add_spacer += 1
+
+    def __create_shape_dicts(self):
+        shape_dicts = {}
+        for shape, df in self.roi_dict.items():
+            if not df["Name"].is_unique:
+                df = df.drop_duplicates(subset=["Name"], keep="first")
+                DuplicateNamesWarning(
+                    msg=f'Some of your ROIs with the same shape ({shape}) has the same names for video {self.video_name}. E.g., you have two rectangles named "My rectangle". SimBA prefers ROI shapes with unique names. SimBA will keep one of the unique shape names and drop the rest.',
+                    source=self.__class__.__name__,
+                )
+            d = df.set_index("Name").to_dict(orient="index")
+            shape_dicts = {**shape_dicts, **d}
+        return shape_dicts
 
     def __insert_texts(self, shape_df):
-        for animal_name in self.animal_id_lst:
+        for cnt, animal_data in self.bp_lk.items():
+            animal, animal_bp, _ = animal_data
+            animal_name = f"{animal} {animal_bp}"
             for _, shape in shape_df.iterrows():
                 shape_name, shape_color = shape["Name"], shape["Color BGR"]
                 cv2.putText(
-                    self.border_img,
-                    self.loc_dict[animal_name][shape_name]["timer_text"],
-                    self.loc_dict[animal_name][shape_name]["timer_text_loc"],
+                    self.img_w_border,
+                    self.loc_dict[animal_name][shape_name]["in_zone_text"],
+                    self.loc_dict[animal_name][shape_name]["in_zone_text_loc"],
                     self.font,
                     self.font_size,
                     shape_color,
-                    TextOptions.TEXT_THICKNESS.value,
+                    1,
                 )
                 cv2.putText(
-                    self.border_img,
-                    self.loc_dict[animal_name][shape_name]["entries_text"],
-                    self.loc_dict[animal_name][shape_name]["entries_text_loc"],
+                    self.img_w_border,
+                    self.loc_dict[animal_name][shape_name]["distance_text"],
+                    self.loc_dict[animal_name][shape_name]["distance_text_loc"],
                     self.font,
                     self.font_size,
                     shape_color,
-                    TextOptions.TEXT_THICKNESS.value,
+                    1,
                 )
-
-    def __create_counters(self):
-        self.cnt_dict = {}
-        for animal_cnt, animal_name in enumerate(self.animal_id_lst):
-            self.cnt_dict[animal_name] = {}
-            for shape in self.video_shapes:
-                self.cnt_dict[animal_name][shape] = {}
-                self.cnt_dict[animal_name][shape]["timer"] = 0
-                self.cnt_dict[animal_name][shape]["entries"] = 0
-                self.cnt_dict[animal_name][shape]["entry_status"] = False
-
-    def __update_video_meta_data(self):
-        new_cap = cv2.VideoCapture(self.video_path)
-        new_cap.set(1, 1)
-        _, img = self.cap.read()
-        bordered_img = cv2.copyMakeBorder(
-            img,
-            0,
-            0,
-            0,
-            int(self.video_meta_data["width"]),
-            borderType=cv2.BORDER_CONSTANT,
-            value=[0, 0, 0],
-        )
-        self.border_img_h, self.border_img_w = (
-            bordered_img.shape[0],
-            bordered_img.shape[1],
-        )
-        new_cap.release()
+                if self.direct_viable:
+                    cv2.putText(
+                        self.img_w_border,
+                        self.loc_dict[animal][shape_name]["directing_text"],
+                        self.loc_dict[animal][shape_name]["directing_text_loc"],
+                        self.font,
+                        self.font_size,
+                        shape_color,
+                        1,
+                    )
 
     def run(self):
-        """
-        Method to visualize ROI data. Results are stored in the `project_folder/frames/output/ROI_analysis`
-        directroy of the SimBA project.
-
-        Returns
-        -------
-        None
-        """
-
-        save_path = os.path.join(self.output_folder, self.video_name + ".avi")
-        self.cap = cv2.VideoCapture(self.video_path)
-        self.video_meta_data = get_video_meta_data(self.video_path)
-        video_settings, pix_per_mm, fps = self.read_video_info(
-            video_name=self.video_name
-        )
-        self.space_scale, radius_scale, res_scale, font_scale = 25, 10, 1500, 0.8
-        max_dim = max(self.video_meta_data["width"], self.video_meta_data["height"])
-        self.font = Formats.FONT.value
-        draw_scale = int(
-            TextOptions.RADIUS_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / max_dim)
-        )
-        self.font_size = float(
-            TextOptions.FONT_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / max_dim)
-        )
-        self.spacing_scaler = int(
-            TextOptions.SPACE_SCALER.value
-            / (TextOptions.RESOLUTION_SCALER.value / max_dim)
-        )
-        fourcc = cv2.VideoWriter_fourcc(*Formats.AVI_CODEC.value)
-        writer = cv2.VideoWriter(
-            save_path,
-            fourcc,
-            fps,
-            (self.video_meta_data["width"] * 2, self.video_meta_data["height"]),
-        )
-        color_lst = create_color_palettes(
-            self.roi_analyzer.animal_cnt, int((len(self.roi_analyzer.bp_names) / 3))
-        )[0]
-        self.__update_video_meta_data()
-        self.__calc_text_locs()
-        self.__create_counters()
-
-        frame_cnt = 0
+        self.frame_cnt = 0
         while self.cap.isOpened():
-            ret, img = self.cap.read()
+            ret, self.img = self.cap.read()
             if ret:
-                self.border_img = cv2.copyMakeBorder(
-                    img,
+                self.img_w_border = cv2.copyMakeBorder(
+                    self.img,
                     0,
                     0,
                     0,
-                    int(self.video_meta_data["width"]),
+                    self.video_meta_data["width"],
                     borderType=cv2.BORDER_CONSTANT,
-                    value=[0, 0, 0],
+                    value=self.style_attr[BORDER_COLOR],
                 )
-                self.border_img_h, self.border_img_w = (
-                    self.border_img.shape[0],
-                    self.border_img.shape[1],
-                )
-                self.__insert_texts(self.roi_analyzer.video_recs)
-                self.__insert_texts(self.roi_analyzer.video_circs)
-                self.__insert_texts(self.roi_analyzer.video_polys)
-                for _, row in self.roi_analyzer.video_recs.iterrows():
-                    top_left_x, top_left_y, shape_name = (
-                        row["topLeftX"],
-                        row["topLeftY"],
-                        row["Name"],
-                    )
-                    bottom_right_x, bottom_right_y = (
-                        row["Bottom_right_X"],
-                        row["Bottom_right_Y"],
-                    )
-                    thickness, color = row["Thickness"], row["Color BGR"]
-                    cv2.rectangle(
-                        self.border_img,
-                        (int(top_left_x), int(top_left_y)),
-                        (int(bottom_right_x), int(bottom_right_y)),
-                        color,
-                        int(thickness),
-                    )
-                for _, row in self.roi_analyzer.video_circs.iterrows():
-                    center_x, center_y, radius, shape_name = (
-                        row["centerX"],
-                        row["centerY"],
-                        row["radius"],
-                        row["Name"],
+                if self.frame_cnt == 0:
+                    self.img_w_border_h, self.img_w_border_w = (
+                        self.img_w_border.shape[0],
+                        self.img_w_border.shape[1],
                     )
-                    thickness, color = row["Thickness"], row["Color BGR"]
-                    cv2.circle(
-                        self.border_img,
-                        (center_x, center_y),
-                        radius,
-                        color,
-                        int(thickness),
+                    self.__calc_text_locs()
+                    self.writer = cv2.VideoWriter(
+                        self.save_path,
+                        self.fourcc,
+                        self.video_meta_data["fps"],
+                        (self.img_w_border_w, self.img_w_border_h),
                     )
-                for _, row in self.roi_analyzer.video_polys.iterrows():
-                    vertices, shape_name = row["vertices"], row["Name"]
-                    thickness, color = row["Thickness"], row["Color BGR"]
-                    cv2.polylines(
-                        self.border_img,
-                        [vertices],
-                        True,
-                        color,
-                        thickness=int(thickness),
-                    )
-                for animal_cnt, animal_name in enumerate(self.animal_id_lst):
-                    bp_data = (
-                        self.data_df.loc[frame_cnt, self.bp_dict[animal_name]]
-                        .fillna(0.0)
-                        .values
-                    )
-                    if self.threshold < bp_data[2]:
-                        if self.style_attr["Show_body_part"]:
+                self.__insert_texts(self.roi_dict[Keys.ROI_RECTANGLES.value])
+                self.__insert_texts(self.roi_dict[Keys.ROI_CIRCLES.value])
+                self.__insert_texts(self.roi_dict[Keys.ROI_POLYGONS.value])
+                if self.style_attr[POSE]:
+                    for animal_name, bp_data in self.animal_bp_dict.items():
+                        for bp_cnt, bp in enumerate(
+                            zip(bp_data["X_bps"], bp_data["Y_bps"])
+                        ):
+                            bp_cords = self.data_df.loc[
+                                self.frame_cnt, list(bp)
+                            ].values.astype(np.int64)
                             cv2.circle(
-                                self.border_img,
-                                (int(bp_data[0]), int(bp_data[1])),
-                                draw_scale,
-                                color_lst[animal_cnt],
-                                -1,
-                            )
-                        if self.style_attr["Show_animal_name"]:
-                            cv2.putText(
-                                self.border_img,
-                                animal_name,
-                                (int(bp_data[0]), int(bp_data[1])),
-                                self.font,
-                                self.font_size,
-                                color_lst[animal_cnt],
-                                TextOptions.TEXT_THICKNESS.value,
+                                self.img_w_border,
+                                (bp_cords[0], bp_cords[1]),
+                                0,
+                                self.animal_bp_dict[animal_name]["colors"][bp_cnt],
+                                self.circle_size,
                             )
-                        for shape_name in self.video_shapes:
-                            if (
-                                self.data_df.loc[
-                                    frame_cnt, animal_name + "_" + shape_name
-                                ]
-                                == 1
-                            ):
-                                self.cnt_dict[animal_name][shape_name]["timer"] += (
-                                    1 / fps
-                                )
-                                if not self.cnt_dict[animal_name][shape_name][
-                                    "entry_status"
-                                ]:
-                                    self.cnt_dict[animal_name][shape_name][
-                                        "entry_status"
-                                    ] = True
-                                    self.cnt_dict[animal_name][shape_name][
-                                        "entries"
-                                    ] += 1
-                            else:
-                                self.cnt_dict[animal_name][shape_name][
-                                    "entry_status"
-                                ] = False
-                for animal_cnt, animal_name in enumerate(self.animal_id_lst):
-                    for shape_name in self.video_shapes:
+                if self.style_attr[ANIMAL_NAMES]:
+                    for animal_name, bp_data in self.animal_bp_dict.items():
+                        headers = [bp_data["X_bps"][-1], bp_data["Y_bps"][-1]]
+                        bp_cords = self.data_df.loc[
+                            self.frame_cnt, headers
+                        ].values.astype(np.int64)
                         cv2.putText(
-                            self.border_img,
-                            str(
-                                round(
-                                    self.cnt_dict[animal_name][shape_name]["timer"], 2
-                                )
-                            ),
-                            self.loc_dict[animal_name][shape_name]["timer_data_loc"],
+                            self.img_w_border,
+                            animal_name,
+                            (bp_cords[0], bp_cords[1]),
                             self.font,
                             self.font_size,
-                            self.shape_dicts[shape_name]["Color BGR"],
-                            TextOptions.TEXT_THICKNESS.value,
+                            self.animal_bp_dict[animal_name]["colors"][0],
+                            1,
+                        )
+
+                self.img_w_border = PlottingMixin.roi_dict_onto_img(
+                    img=self.img_w_border,
+                    roi_dict=self.roi_dict,
+                    circle_size=self.circle_size,
+                    show_tags=self.style_attr[ROI_EAR_TAGS],
+                    show_center=self.style_attr[ROI_CENTERS],
+                )
+
+                for animal_name, shape_name in itertools.product(
+                    self.animal_bp_names, self.shape_names
+                ):
+                    in_zone_col_name = f"{shape_name} {animal_name} in zone"
+                    distance_col_name = f"{shape_name} {animal_name} distance"
+                    in_zone_value = str(
+                        bool(
+                            self.roi_feature_creator.out_df.loc[
+                                self.frame_cnt, in_zone_col_name
+                            ]
                         )
+                    )
+                    distance_value = round(
+                        self.roi_feature_creator.out_df.loc[
+                            self.frame_cnt, distance_col_name
+                        ],
+                        2,
+                    )
+                    cv2.putText(
+                        self.img_w_border,
+                        in_zone_value,
+                        self.loc_dict[animal_name][shape_name]["in_zone_data_loc"],
+                        self.font,
+                        self.font_size,
+                        self.shape_dicts[shape_name]["Color BGR"],
+                        1,
+                    )
+                    cv2.putText(
+                        self.img_w_border,
+                        str(distance_value),
+                        self.loc_dict[animal_name][shape_name]["distance_data_loc"],
+                        self.font,
+                        self.font_size,
+                        self.shape_dicts[shape_name]["Color BGR"],
+                        1,
+                    )
+                if self.direct_viable and self.style_attr[DIRECTIONALITY]:
+                    for animal_name, shape_name in itertools.product(
+                        self.animal_names, self.shape_names
+                    ):
+                        facing_col_name = f"{shape_name} {animal_name} facing"
+                        facing_value = self.roi_feature_creator.out_df.loc[
+                            self.frame_cnt, facing_col_name
+                        ]
                         cv2.putText(
-                            self.border_img,
-                            str(self.cnt_dict[animal_name][shape_name]["entries"]),
-                            self.loc_dict[animal_name][shape_name]["entries_data_loc"],
+                            self.img_w_border,
+                            str(bool(facing_value)),
+                            self.loc_dict[animal_name][shape_name][
+                                "directing_data_loc"
+                            ],
                             self.font,
                             self.font_size,
                             self.shape_dicts[shape_name]["Color BGR"],
-                            TextOptions.TEXT_THICKNESS.value,
+                            1,
                         )
-                writer.write(np.uint8(self.border_img))
-                # cv2.imshow('Window', self.border_img)
-                # key = cv2.waitKey(3000)
-                # if key == 27:
-                #     cv2.destroyAllWindows()
-                print(
-                    "Frame: {} / {}, Video: {}.".format(
-                        str(frame_cnt),
-                        str(self.video_meta_data["frame_count"]),
-                        self.video_name,
-                    )
-                )
-                frame_cnt += 1
-
-            if img is None:
-                self.timer.stop_timer()
+                        if facing_value:
+                            self.img_w_border = PlottingMixin.insert_directing_line(
+                                directing_df=self.directing_df,
+                                img=self.img_w_border,
+                                shape_name=shape_name,
+                                animal_name=animal_name,
+                                frame_id=self.frame_cnt,
+                                color=self.shape_dicts[shape_name]["Color BGR"],
+                                thickness=self.shape_dicts[shape_name]["Thickness"],
+                                style=self.style_attr[DIRECTIONALITY_STYLE],
+                            )
+                self.frame_cnt += 1
+                self.writer.write(np.uint8(self.img_w_border))
                 print(
-                    f"SIMBA COMPLETE: Video {self.video_name} saved at {save_path} (elapsed time: {self.timer.elapsed_time_str}s)."
+                    f"Frame: {self.frame_cnt} / {self.video_meta_data['frame_count']}. Video: {self.video_name} ..."
                 )
-                self.cap.release()
+            else:
                 break
 
-            # except Exception as e:
-            #     writer.release()
-            #     print(e.args)
-            #     print('NOTE: index error / keyerror. Some frames of the video may be missing. Make sure you are running latest version of SimBA with pip install simba-uw-tf-dev')
-            #     break
-
-        writer.release()
+        self.timer.stop_timer()
+        self.cap.release()
+        self.writer.release()
         stdout_success(
-            msg=f"Video {self.video_name} created. Video saved in project_folder/frames/output/ROI_analysis",
-            source=self.__class__.__name__,
+            msg=f"Feature video {self.video_name} saved in {self.save_path} directory ...",
+            elapsed_time=self.timer.elapsed_time_str,
         )
 
 
-# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
-#                video_path="termite_test.mp4",
-#                style_attr={'Show_body_part': True, 'Show_animal_name': True})
-# test.insert_data()
-# test.visualize_ROI_data()
-
+# style_attr = {'roi_centers': True, 'roi_ear_tags': True, 'directionality': True, 'directionality_style': 'lines', 'border_color': (0, 0, 0), 'pose_estimation': True, 'animal_names': True}
+# test = ROIfeatureVisualizer(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/project_config.ini',
+#                             video_path='/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/videos/2022-06-20_NOB_DOT_4.mp4',
+#                             style_attr=style_attr,
+#                             body_parts=['Nose'])
+# test.run()
 
-# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini', video_path="termite_test.mp4")
-# test.insert_data()
-# test.visualize_ROI_data()
 
-# test = ROIPlot(ini_path=r'/Users/simon/Desktop/troubleshooting/train_model_project/project_folder/project_config.ini', video_path=r"Together_1.avi")
-# test.insert_data()
-# test.visualize_ROI_data()
+# style_attr = {'roi_centers': True, 'roi_ear_tags': True, 'directionality': True, 'directionality_style': 'funnel', 'border_color': (0, 128, 0), 'pose_estimation': True, 'animal_names': True}
+# test = ROIfeatureVisualizer(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                             video_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi',
+#                             style_attr=style_attr,
+#                             body_parts=['Nose_1', 'Nose_2'])
+# test.run()
 
 
-# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
-#                video_path="Together_1.avi",
-#                style_attr={'Show_body_part': True, 'Show_animal_name': False},
-#                body_parts={f'Simon': 'Ear_left_1'})
-# test.insert_data()
+# style_attr = {'ROI_centers': True, 'ROI_ear_tags': True, 'Directionality': True, 'Directionality_style': 'Line', 'Border_color': (0, 128, 0), 'Pose_estimation': True}
+# test = ROIfeatureVisualizer(config_path='/Users/simon/Desktop/envs/simba_dev/tests/test_data/mouse_open_field/project_folder/project_config.ini', video_name='Video1.mp4', style_attr=style_attr)
 # test.run()
 
-# test = ROIPlot(ini_path=r'/Users/simon/Desktop/envs/troubleshooting/Termites_5/project_folder/project_config.ini',
-#                video_path="termite_test.mp4",
-#                style_attr={'Show_body_part': True, 'Show_animal_name': True},
-#                body_parts={f'Simon': 'Termite_1_Head_1'})
-# test.insert_data()
+
+# test = ROIfeatureVisualizer(config_path='/Users/simon/Desktop/train_model_project/project_folder/project_config.ini', video_name='Together_1.avi')
 # test.run()
+# test.save_new_features_files()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/geometry_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/geometry_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/clf_validator_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/clf_validator_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_clf.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_clf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/distance_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/distance_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/single_run_model_validation_video_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/single_run_model_validation_video_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/directing_animals_visualizer.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/directing_animals_visualizer.py`

 * *Files 18% similar despite different names*

```diff
@@ -1,27 +1,47 @@
 __author__ = "Simon Nilsson"
 
 import os
-import random
+from typing import Any, Dict, Union
 
 import cv2
 import numpy as np
-import pandas as pd
 
 from simba.data_processors.directing_other_animals_calculator import \
     DirectingOtherAnimalsAnalyzer
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.plotting_mixin import PlottingMixin
+from simba.utils.checks import (check_file_exist_and_readable,
+                                check_if_keys_exist_in_dict,
+                                check_if_valid_rgb_tuple, check_valid_array,
+                                check_valid_lst,
+                                check_video_and_data_frm_count_align)
 from simba.utils.data import create_color_palettes
-from simba.utils.enums import Formats
-from simba.utils.lookups import get_color_dict
-from simba.utils.printing import SimbaTimer, stdout_success
+from simba.utils.enums import Formats, TextOptions
+from simba.utils.errors import AnimalNumberError, NoFilesFoundError
+from simba.utils.printing import stdout_success
 from simba.utils.read_write import get_fn_ext, get_video_meta_data, read_df
 from simba.utils.warnings import NoDataFoundWarning
 
+DIRECTION_THICKNESS = "direction_thickness"
+DIRECTIONALITY_COLOR = "directionality_color"
+CIRCLE_SIZE = "circle_size"
+HIGHLIGHT_ENDPOINTS = "highlight_endpoints"
+SHOW_POSE = "show_pose"
+ANIMAL_NAMES = "animal_names"
+
+STYLE_ATTR = [
+    DIRECTION_THICKNESS,
+    DIRECTIONALITY_COLOR,
+    CIRCLE_SIZE,
+    HIGHLIGHT_ENDPOINTS,
+    SHOW_POSE,
+    ANIMAL_NAMES,
+]
+
 
 class DirectingOtherAnimalsVisualizer(ConfigReader, PlottingMixin):
     """
     Visualize when animals are directing towards body-parts of other animals.
 
     .. important::
        Requires the pose-estimation data for the left ear, right ears and nose of individual animals.
@@ -32,224 +52,201 @@
 
         `Tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#visualizing-data-tables`>_.
 
         .. image:: _static/img/directing_other_animals.png
            :width: 450
            :align: center
 
-    :parameter str config_path: path to SimBA project config file in Configparser format
-    :parameter str data_path: path to data file
-    :parameter dict style_attr: Visualisation attributes (colors and sizes etc.)
-
+    :parameter Union[str, os.PathLike] config_path: path to SimBA project config file in Configparser format
+    :parameter Union[str, os.PathLike] video_path: Path to video for to visualize directionality.
+    :parameter Dict[str, Any] style_attr: Video style attributes (colors and sizes etc.)
+
+    :example:
+    >>> style_attr = {'show_pose': True, 'animal_names': True, 'circle_size': 3, 'directionality_color': [(255, 0, 0), (0, 0, 255)], 'direction_thickness': 10, 'highlight_endpoints': True}
+    >>> test = DirectingOtherAnimalsVisualizer(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', video_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi', style_attr=style_attr)
+    >>> test.run()
 
-    Examples
-    -----
-    >>> style_attr = {'Show_pose': True,
-    >>>               'Pose_circle_size': 3,
-    >>>               "Direction_color": 'Random',
-    >>>               'Direction_thickness': 4, 'Highlight_endpoints': True}
-    >>> _ = DirectingOtherAnimalsVisualizer(config_path='/Users/simon/Desktop/envs/troubleshooting/sleap_5_animals/project_folder/project_config.ini', video_name='Testing_Video_3.mp4', style_attr=style_attr).run()
     """
 
-    def __init__(self, config_path: str, data_path: str, style_attr: dict):
+    def __init__(
+        self,
+        config_path: Union[str, os.PathLike],
+        video_path: Union[str, os.PathLike],
+        style_attr: Dict[str, Any],
+    ):
+
+        check_file_exist_and_readable(file_path=video_path)
+        check_file_exist_and_readable(file_path=config_path)
+        check_if_keys_exist_in_dict(
+            data=style_attr,
+            key=STYLE_ATTR,
+            name=f"{self.__class__.__name__} style_attr",
+        )
         ConfigReader.__init__(self, config_path=config_path)
         PlottingMixin.__init__(self)
-
-        self.data_path = data_path
-        _, self.video_name, _ = get_fn_ext(self.data_path)
+        if self.animal_cnt < 2:
+            raise AnimalNumberError(
+                "Cannot analyze directionality between animals in a project with less than two animals.",
+                source=self.__class__.__name__,
+            )
+        self.animal_names = [k for k in self.animal_bp_dict.keys()]
+        _, self.video_name, _ = get_fn_ext(video_path)
+        self.data_path = os.path.join(
+            self.outlier_corrected_dir, f"{self.video_name}.{self.file_type}"
+        )
+        if not os.path.isfile(self.data_path):
+            raise NoFilesFoundError(
+                msg=f"SIMBA ERROR: Could not find the file at path {self.data_path}. Make sure the data file exist to create directionality visualizations",
+                source=self.__class__.__name__,
+            )
         self.direction_analyzer = DirectingOtherAnimalsAnalyzer(
             config_path=config_path,
             bool_tables=False,
             summary_tables=False,
             aggregate_statistics_tables=False,
+            data_paths=self.data_path,
         )
-        self.direction_analyzer.outlier_corrected_paths = [data_path]
         self.direction_analyzer.run()
-        self.direction_analyzer._transpose_results_to_df()
+        self.direction_analyzer.transpose_results()
         self.fourcc = cv2.VideoWriter_fourcc(*Formats.MP4_CODEC.value)
-        self.style_attr, self.pose_colors = style_attr, []
-        self.colors = get_color_dict()
-        if self.style_attr["Show_pose"]:
-            self.pose_colors = create_color_palettes(
-                self.animal_cnt, int(len(self.x_cols) + 1)
+        self.style_attr = style_attr
+        self.direction_colors = {}
+        if isinstance(self.style_attr[DIRECTIONALITY_COLOR], list):
+            check_valid_lst(
+                data=self.style_attr[DIRECTIONALITY_COLOR],
+                source=f"{self.__class__.__name__} colors",
+                valid_dtypes=(tuple,),
+                min_len=self.animal_cnt,
             )
-        if self.style_attr["Direction_color"] == "Random":
-            self.direction_colors = create_color_palettes(1, int(self.animal_cnt**2))
+            for i in range(len(self.animal_names)):
+                check_if_valid_rgb_tuple(data=self.style_attr[DIRECTIONALITY_COLOR][i])
+                self.direction_colors[self.animal_names[i]] = self.style_attr[
+                    DIRECTIONALITY_COLOR
+                ][i]
+        if isinstance(self.style_attr[DIRECTIONALITY_COLOR], tuple):
+            check_if_valid_rgb_tuple(self.style_attr[DIRECTIONALITY_COLOR])
+            for i in range(len(self.animal_names)):
+                self.direction_colors[self.animal_names[i]] = self.style_attr[
+                    DIRECTIONALITY_COLOR
+                ]
         else:
-            self.direction_colors = [self.colors[self.style_attr["Direction_color"]]]
+            self.random_colors = create_color_palettes(1, int(self.animal_cnt**2))[0]
+            self.random_colors = [
+                [int(item) for item in sublist] for sublist in self.random_colors
+            ]
+            for cnt in range(len(self.animal_names)):
+                self.direction_colors[self.animal_names[cnt]] = self.random_colors[cnt]
         self.data_dict = self.direction_analyzer.directionality_df_dict
-        self.video_path = self.find_video_of_file(
-            video_dir=self.video_dir, filename=self.video_name
-        )
         if not os.path.exists(self.directing_animals_video_output_path):
             os.makedirs(self.directing_animals_video_output_path)
-        print(f"Processing video {self.video_name}...")
-
-    def run(self):
-        """
-        Method to create directionality videos. Results are stored in
-        the `project_folder/frames/output/ROI_directionality_visualize` directory of the SimBA project
-
-        Returns
-        ----------
-        None
-        """
-
         self.data_df = read_df(self.data_path, file_type=self.file_type)
         self.video_save_path = os.path.join(
-            self.directing_animals_video_output_path, self.video_name + ".mp4"
+            self.directing_animals_video_output_path, f"{self.video_name}.mp4"
         )
-        self.cap = cv2.VideoCapture(self.video_path)
-        self.video_meta_data = get_video_meta_data(self.video_path)
-        self.video_data = self.data_dict[self.video_name]
+        self.cap = cv2.VideoCapture(video_path)
+        self.video_meta_data = get_video_meta_data(video_path)
+        check_video_and_data_frm_count_align(
+            video=video_path, data=self.data_path, name=video_path, raise_error=False
+        )
+        print(f"Processing video {self.video_name}...")
+
+    def run(self):
+        video_data = self.data_dict[self.video_name]
         self.writer = cv2.VideoWriter(
             self.video_save_path,
             self.fourcc,
             self.video_meta_data["fps"],
             (self.video_meta_data["width"], self.video_meta_data["height"]),
         )
-        if self.video_name in list(self.video_data["Video"]):
-            self.__create_video()
-        else:
+        if len(video_data) < 1:
             NoDataFoundWarning(
                 msg=f"SimBA skipping video {self.video_name}: No animals are directing each other in the video."
             )
-        self.timer.stop_timer()
-
-    def __draw_individual_lines(self, animal_img_data: pd.DataFrame, img: np.array):
-        color = self.direction_colors[0]
-        for cnt, (i, r) in enumerate(animal_img_data.iterrows()):
-            if self.style_attr["Direction_color"] == "Random":
-                color = random.sample(self.direction_colors[0], 1)[0]
-            cv2.line(
-                img,
-                (int(r["Eye_x"]), int(r["Eye_y"])),
-                (int(r["Animal_2_bodypart_x"]), int(r["Animal_2_bodypart_y"])),
-                color,
-                self.style_attr["Direction_thickness"],
-            )
-            if self.style_attr["Highlight_endpoints"]:
-                cv2.circle(
-                    img,
-                    (int(r["Eye_x"]), int(r["Eye_y"])),
-                    self.style_attr["Pose_circle_size"] + 2,
-                    color,
-                    self.style_attr["Pose_circle_size"],
-                )
-                cv2.circle(
-                    img,
-                    (int(r["Animal_2_bodypart_x"]), int(r["Animal_2_bodypart_y"])),
-                    self.style_attr["Pose_circle_size"] + 1,
-                    color,
-                    self.style_attr["Pose_circle_size"],
-                )
-
-        return img
-
-    def __create_video(self):
-        img_cnt = 0
-        video_timer = SimbaTimer(start=True)
-        video_timer.start_timer()
-        color = self.direction_colors[0]
-        while self.cap.isOpened():
-            ret, img = self.cap.read()
-            try:
+        else:
+            frm_cnt = 0
+            while self.cap.isOpened():
+                ret, img = self.cap.read()
                 if ret:
-                    if self.style_attr["Show_pose"]:
-                        bp_data = self.data_df.iloc[img_cnt]
-                        for cnt, (animal_name, animal_bps) in enumerate(
+                    bp_data = self.data_df.iloc[frm_cnt]
+                    if self.style_attr[SHOW_POSE]:
+                        for animal_cnt, (animal_name, animal_bps) in enumerate(
                             self.animal_bp_dict.items()
                         ):
-                            for bp in zip(animal_bps["X_bps"], animal_bps["Y_bps"]):
+                            for bp_cnt, bp in enumerate(
+                                zip(animal_bps["X_bps"], animal_bps["Y_bps"])
+                            ):
                                 x_bp, y_bp = bp_data[bp[0]], bp_data[bp[1]]
                                 cv2.circle(
                                     img,
                                     (int(x_bp), int(y_bp)),
-                                    self.style_attr["Pose_circle_size"],
-                                    self.animal_bp_dict[animal_name]["colors"][cnt],
-                                    self.style_attr["Direction_thickness"],
+                                    self.style_attr[CIRCLE_SIZE],
+                                    self.animal_bp_dict[animal_name]["colors"][bp_cnt],
+                                    -1,
                                 )
-
-                    if img_cnt in list(self.video_data["Frame_#"].unique()):
-                        img_data = self.video_data[
-                            self.video_data["Frame_#"] == img_cnt
-                        ]
-                        unique_animals = img_data["Animal_1"].unique()
-                        for animal in unique_animals:
+                    if self.style_attr[ANIMAL_NAMES]:
+                        for animal_name, bp_v in self.animal_bp_dict.items():
+                            headers = [bp_v["X_bps"][-1], bp_v["Y_bps"][-1]]
+                            bp_cords = self.data_df.loc[frm_cnt, headers].values.astype(
+                                np.int64
+                            )
+                            cv2.putText(
+                                img,
+                                animal_name,
+                                (bp_cords[0], bp_cords[1]),
+                                TextOptions.FONT.value,
+                                2,
+                                self.animal_bp_dict[animal_name]["colors"][0],
+                                1,
+                            )
+
+                    if frm_cnt in list(video_data["Frame_#"].unique()):
+                        img_data = video_data[video_data["Frame_#"] == frm_cnt]
+                        for animal_name in img_data["Animal_1"].unique():
                             animal_img_data = img_data[
-                                img_data["Animal_1"] == animal
+                                img_data["Animal_1"] == animal_name
                             ].reset_index(drop=True)
-                            if self.style_attr["Polyfill"]:
-                                convex_hull_arr = animal_img_data.loc[
-                                    0, ["Eye_x", "Eye_y"]
-                                ].values.reshape(-1, 2)
-                                for animal_2 in animal_img_data["Animal_2"].unique():
-                                    convex_hull_arr = np.vstack(
-                                        (
-                                            convex_hull_arr,
-                                            animal_img_data[
-                                                [
-                                                    "Animal_2_bodypart_x",
-                                                    "Animal_2_bodypart_y",
-                                                ]
-                                            ][
-                                                animal_img_data["Animal_2"] == animal_2
-                                            ].values,
-                                        )
-                                    ).astype("int")
-                                    convex_hull_arr = np.unique(convex_hull_arr, axis=0)
-                                    if convex_hull_arr.shape[0] >= 3:
-                                        if (
-                                            self.style_attr["Direction_color"]
-                                            == "Random"
-                                        ):
-                                            color = random.sample(
-                                                self.direction_colors[0], 1
-                                            )[0]
-                                        cv2.fillPoly(img, [convex_hull_arr], color)
-                                    else:
-                                        img = self.__draw_individual_lines(
-                                            animal_img_data=animal_img_data, img=img
-                                        )
-
-                            else:
-                                img = self.__draw_individual_lines(
-                                    animal_img_data=animal_img_data, img=img
-                                )
-
-                    img_cnt += 1
+                            img = PlottingMixin.draw_lines_on_img(
+                                img=img,
+                                start_positions=animal_img_data[
+                                    ["Eye_x", "Eye_y"]
+                                ].values.astype(np.int64),
+                                end_positions=animal_img_data[
+                                    ["Animal_2_bodypart_x", "Animal_2_bodypart_y"]
+                                ].values.astype(np.int64),
+                                color=tuple(self.direction_colors[animal_name]),
+                                highlight_endpoint=self.style_attr[HIGHLIGHT_ENDPOINTS],
+                                thickness=self.style_attr[DIRECTION_THICKNESS],
+                                circle_size=self.style_attr[CIRCLE_SIZE],
+                            )
+                    frm_cnt += 1
                     self.writer.write(np.uint8(img))
                     print(
-                        "Frame: {} / {}. Video: {}".format(
-                            str(img_cnt),
-                            str(self.video_meta_data["frame_count"]),
-                            self.video_name,
-                        )
+                        f"Frame: {frm_cnt} / {self.video_meta_data['frame_count']}. Video: {self.video_name}"
                     )
                 else:
-                    self.cap.release()
-                    self.writer.release()
                     break
-
-            except IndexError:
-                self.cap.release()
-                self.writer.release()
-
-        video_timer.stop_timer()
-        stdout_success(
-            msg=f"Directionality video {self.video_name} saved in {self.directing_animals_video_output_path} directory",
-            elapsed_time=video_timer.elapsed_time_str,
-        )
+            self.writer.release()
+            self.timer.stop_timer()
+            stdout_success(
+                msg=f"Directionality video {self.video_name} saved in {self.directing_animals_video_output_path} directory",
+                elapsed_time=self.timer.elapsed_time_str,
+            )
 
 
-# style_attr = {'Show_pose': True, 'Pose_circle_size': 3, "Direction_color": 'Random', 'Direction_thickness': 4, 'Highlight_endpoints': True, 'Polyfill': True}
-# test = DirectingOtherAnimalsVisualizer(config_path='/Users/simon/Desktop/envs/troubleshooting/sleap_5_animals/project_folder/project_config.ini',
-#                                        data_path='/Users/simon/Desktop/envs/troubleshooting/sleap_5_animals/project_folder/csv/outlier_corrected_movement_location/Testing_Video_3.csv',
-#                                        style_attr=style_attr)
+# style_attr = {SHOW_POSE: True,
+#               ANIMAL_NAMES: True,
+#               CIRCLE_SIZE: 3,
+#               DIRECTIONALITY_COLOR: [(255, 0, 0), (0, 0, 255)],
+#               DIRECTION_THICKNESS: 10,
+#               HIGHLIGHT_ENDPOINTS: True}
 #
+# test = DirectingOtherAnimalsVisualizer(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                                        video_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/videos/Together_1.avi',
+#                                        style_attr=style_attr)
+# #
 # test.run()
 
 
 # style_attr = {'Show_pose': True, 'Pose_circle_size': 3, "Direction_color": 'Random', 'Direction_thickness': 4, 'Highlight_endpoints': True, 'Polyfill': True}
 # test = DirectingOtherAnimalsVisualizer(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
 #                                        data_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/outlier_corrected_movement_location/Together_1.csv',
 #                                        style_attr=style_attr)
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/circular_feature_overlay_plotter.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/circular_feature_overlay_plotter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/plotting/heat_mapper_location_mp.py` & `Simba-UW-tf-dev-1.90.5/simba/plotting/heat_mapper_location_mp.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/dash_app/SimBA_dash_app.py` & `Simba-UW-tf-dev-1.90.5/simba/dash_app/SimBA_dash_app.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/dash_app/run_dash_tkinter.py` & `Simba-UW-tf-dev-1.90.5/simba/dash_app/run_dash_tkinter.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/dash_app/dash_app.py` & `Simba-UW-tf-dev-1.90.5/simba/dash_app/dash_app.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/spontaneous_alternation_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/spontaneous_alternation_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/agg_clf_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/agg_clf_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/.DS_Store`

 * *Files 4% similar despite different names*

```diff
@@ -13,20 +13,20 @@
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0000 0000 0000 0000 0000 0004 0000 000b  ................
 00000110: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00000120: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00000130: 0000 0003 7b85 0000 000b 005f 005f 0070  ....{......_._.p
+00000130: 0000 0003 7c40 0000 000b 005f 005f 0070  ....|@....._._.p
 00000140: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00000150: 6d6f 4444 626c 6f62 0000 0008 1164 1137  moDDblob.....d.7
-00000160: 53da c541 0000 000b 005f 005f 0070 0079  S..A....._._.p.y
+00000150: 6d6f 4444 626c 6f62 0000 0008 7b86 6f48  moDDblob....{.oH
+00000160: 1dea c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
 00000170: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00000180: 6444 626c 6f62 0000 0008 6e0d 7883 fbd6  dDblob....n.x...
+00000180: 6444 626c 6f62 0000 0008 93f6 32cf c8e8  dDblob......2...
 00000190: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000001a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
 000001b0: 636f 6d70 0000 0000 0004 a000 0000 0000  comp............
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/severity_bout_based_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/severity_bout_based_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/interpolation_smoothing.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/interpolation_smoothing.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/directing_animal_to_bodypart.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/directing_animal_to_bodypart.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/timebins_clf_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/timebins_clf_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/fsttc_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/fsttc_calculator.py`

 * *Files 1% similar despite different names*

```diff
@@ -411,14 +411,24 @@
         stdout_success(
             msg=f"FSTTC data saved at {self.file_save_path}",
             elapsed_time=self.timer.elapsed_time_str,
             source=self.__class__.__name__,
         )
 
 
+#
+#
+# test = FSTTCCalculator(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                        time_window=10000,
+#                         behavior_lst=['Attack', 'Sniffing'],
+#                         create_graphs=True)
+# test.run()
+#
+
+
 # test = FSTTCCalculator(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
 #                        time_window=60000,
 #                        join_bouts_within_delta=True,
 #                        time_delta_at_onset=True,
 #                        behavior_lst=['licking_grooming', 'active_nursing', 'nest_attendance'], #'passive_nursing', 'nest_attendance'
 #                        create_graphs=True)
 # test.run()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/boolean_conditional_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/boolean_conditional_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/interpolate_pose.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/interpolate_pose.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/directing_other_animals_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/directing_other_animals_calculator.py`

 * *Files 4% similar despite different names*

```diff
@@ -5,20 +5,22 @@
 from typing import Optional, Union
 
 import numpy as np
 import pandas as pd
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
-from simba.utils.checks import (check_if_filepath_list_is_empty,
-                                check_that_dir_has_list_of_filenames)
+from simba.utils.checks import (
+    check_all_file_names_are_represented_in_video_log,
+    check_file_exist_and_readable, check_that_dir_has_list_of_filenames)
 from simba.utils.enums import TagNames
 from simba.utils.errors import AnimalNumberError, CountError, InvalidInputError
 from simba.utils.printing import SimbaTimer, log_event, stdout_success
-from simba.utils.read_write import get_fn_ext, read_df, write_df
+from simba.utils.read_write import (get_fn_ext, read_data_paths, read_df,
+                                    write_df)
 
 
 class DirectingOtherAnimalsAnalyzer(ConfigReader, FeatureExtractionMixin):
     """
     Calculate when animals are directing towards body-parts of other animals. Results are stored in
     the ``project_folder/logs/directionality_dataframes`` directory of the SimBA project.
 
@@ -41,100 +43,112 @@
     >>> directing_analyzer = DirectingOtherAnimalsAnalyzer(config_path='MyProjectConfig')
     >>> directing_analyzer.run()
     """
 
     def __init__(
         self,
         config_path: Union[str, os.PathLike],
+        data_paths: Optional[Union[str, os.PathLike, None]] = None,
         bool_tables: Optional[bool] = True,
         summary_tables: Optional[bool] = False,
         append_bool_tables_to_features: Optional[bool] = False,
         aggregate_statistics_tables: Optional[bool] = False,
     ):
 
-        super().__init__(config_path=config_path)
+        check_file_exist_and_readable(file_path=config_path)
+        ConfigReader.__init__(self, config_path=config_path)
+        FeatureExtractionMixin.__init__(self, config_path=config_path)
+        data_paths = read_data_paths(
+            path=data_paths,
+            default=self.outlier_corrected_paths,
+            default_name=self.outlier_corrected_dir,
+            file_type=self.file_type,
+        )
         log_event(
             logger_name=str(self.__class__.__name__),
             log_type=TagNames.CLASS_INIT.value,
             msg=self.create_log_msg_from_init_args(locals=locals()),
         )
         if self.animal_cnt < 2:
             raise AnimalNumberError(
-                "Cannot analyze directionality between animals in a 1 animal project.",
+                "Cannot analyze directionality between animals in a project with less than two animals.",
                 source=self.__class__.__name__,
             )
-        check_if_filepath_list_is_empty(
-            filepaths=self.outlier_corrected_paths,
-            error_msg=f"SIMBA ERROR: No data found in the {self.outlier_corrected_dir} directory",
-        )
         self.animal_permutations = list(itertools.permutations(self.animal_bp_dict, 2))
         (
             self.bool_tables,
             self.summary_tables,
             self.aggregate_statistics_tables,
             self.append_bool_tables_to_features,
         ) = (
             bool_tables,
             summary_tables,
             aggregate_statistics_tables,
             append_bool_tables_to_features,
         )
+        self.data_paths = data_paths
         if self.append_bool_tables_to_features:
             check_that_dir_has_list_of_filenames(
                 dir=self.features_dir,
                 file_name_lst=self.outlier_corrected_paths,
                 file_type=self.file_type,
             )
-        print(f"Processing {str(len(self.outlier_corrected_paths))} video(s)...")
+        print(f"Processing {len(self.data_paths)} video(s)...")
+        if not self.check_directionality_viable()[0]:
+            raise InvalidInputError(
+                msg="You are not tracking the necessary body-parts to calculate direction.",
+                source=self.__class__.__name__,
+            )
 
+    #
     def run(self):
-        self.results_dict = {}
-        for file_cnt, file_path in enumerate(self.outlier_corrected_paths):
+        if self.aggregate_statistics_tables:
+            check_all_file_names_are_represented_in_video_log(
+                video_info_df=self.video_info_df, data_paths=self.data_paths
+            )
+        self.results = {}
+        for file_cnt, file_path in enumerate(self.data_paths):
             video_timer = SimbaTimer(start=True)
             _, video_name, _ = get_fn_ext(file_path)
+            self.results[video_name] = {}
             print(f"Analyzing directionality between animals in video {video_name}...")
-            self.results_dict[video_name] = {}
-            data_df = read_df(file_path, self.file_type)
+            data_df = read_df(file_path=file_path, file_type=self.file_type)
             direct_bp_dict = self.check_directionality_cords()
             for animal_permutation in self.animal_permutations:
-                self.results_dict[video_name][
-                    "{} {} {}".format(
-                        animal_permutation[0],
-                        "directing towards",
-                        animal_permutation[1],
-                    )
+                self.results[video_name][
+                    f"{animal_permutation[0]} directing towards {animal_permutation[1]}"
                 ] = {}
                 first_animal_bps, second_animal_bps = (
                     direct_bp_dict[animal_permutation[0]],
                     self.animal_bp_dict[animal_permutation[1]],
                 )
                 first_ear_left_arr = data_df[
                     [
                         first_animal_bps["Ear_left"]["X_bps"],
                         first_animal_bps["Ear_left"]["Y_bps"],
                     ]
-                ].to_numpy()
+                ].values
                 first_ear_right_arr = data_df[
                     [
                         first_animal_bps["Ear_right"]["X_bps"],
                         first_animal_bps["Ear_right"]["Y_bps"],
                     ]
-                ].to_numpy()
+                ].values
                 first_nose_arr = data_df[
                     [
                         first_animal_bps["Nose"]["X_bps"],
                         first_animal_bps["Nose"]["Y_bps"],
                     ]
-                ].to_numpy()
-                other_animal_x_bps, other_animal_y_bps = (
+                ].values
+                second_animal_x_bps, second_animal_y_bps = (
                     second_animal_bps["X_bps"],
                     second_animal_bps["Y_bps"],
                 )
-                for x_bp, y_bp in zip(other_animal_x_bps, other_animal_y_bps):
-                    target_cord_arr = data_df[[x_bp, y_bp]].to_numpy()
+                for x_bp, y_bp in zip(second_animal_x_bps, second_animal_y_bps):
+                    target_cord_arr = data_df[[x_bp, y_bp]].values
                     direction_data = self.jitted_line_crosses_to_nonstatic_targets(
                         left_ear_array=first_ear_left_arr,
                         right_ear_array=first_ear_right_arr,
                         nose_array=first_nose_arr,
                         target_array=target_cord_arr,
                     )
                     x_min = np.minimum(direction_data[:, 1], first_nose_arr[:, 0])
@@ -158,90 +172,129 @@
                     bp_data.insert(loc=0, column="Animal_2_body_part", value=x_bp[:-2])
                     bp_data.insert(
                         loc=0, column="Animal_2", value=animal_permutation[1]
                     )
                     bp_data.insert(
                         loc=0, column="Animal_1", value=animal_permutation[0]
                     )
-                    self.results_dict[video_name][
-                        "{} {} {}".format(
-                            animal_permutation[0],
-                            "directing towards",
-                            animal_permutation[1],
-                        )
+                    self.results[video_name][
+                        f"{animal_permutation[0]} directing towards {animal_permutation[1]}"
                     ][x_bp[:-2]] = bp_data
             video_timer.stop_timer()
             print(
                 f"Direction analysis complete for video {video_name} ({file_cnt + 1}/{len(self.outlier_corrected_paths)}, elapsed time: {video_timer.elapsed_time_str}s)..."
             )
-        if self.bool_tables:
-            self.create_bool_tables()
-        if self.summary_tables:
-            self._transpose_results_to_df()
-            self._save_directionality_dfs()
-        if self.aggregate_statistics_tables:
-            self.summary_statistics()
 
-    def create_bool_tables(self):
-        save_dir = os.path.join(
-            self.logs_path, f"Animal_directing_animal_booleans_{self.datetime}"
-        )
-        if not os.path.isdir(save_dir):
-            os.makedirs(save_dir)
-        for video_cnt, (video_name, video_data) in enumerate(self.results_dict.items()):
-            video_df = pd.DataFrame()
-            print(
-                f"Saving boolean directing tables for video {video_name} (Video {video_cnt+1}/{len(self.results_dict.keys())})..."
+        if self.bool_tables:
+            save_dir = os.path.join(
+                self.logs_path, f"Animal_directing_animal_booleans_{self.datetime}"
             )
-            for animal_permutation, animal_permutation_data in video_data.items():
-                for body_part_name, body_part_data in animal_permutation_data.items():
-                    video_df[f"{animal_permutation}_{body_part_name}"] = body_part_data[
-                        "Directing_BOOL"
-                    ]
-            if self.append_bool_tables_to_features:
+            if not os.path.isdir(save_dir):
+                os.makedirs(save_dir)
+            for video_cnt, (video_name, video_data) in enumerate(self.results.items()):
                 print(
-                    f"Adding directionality tables to features data for video {video_name}..."
-                )
-                df = read_df(
-                    file_path=os.path.join(
-                        self.features_dir, f"{video_name}.{self.file_type}"
-                    ),
-                    file_type=self.file_type,
+                    f"Saving boolean directing tables for video {video_name} (Video {video_cnt + 1}/{len(self.results.keys())})..."
                 )
-                if len(df) != len(video_df):
-                    raise CountError(
-                        msg=f"Failed to join data files as they contains different number of frames: the file representing video {video_name} in directory {self.outlier_corrected_dir} contains {len(video_df)} frames, and the file representing video {video_name} in directory {self.features_dir} contains {len(df)} frames."
+                video_df = pd.DataFrame()
+                for animal_permutation, animal_permutation_data in video_data.items():
+                    for (
+                        body_part_name,
+                        body_part_data,
+                    ) in animal_permutation_data.items():
+                        video_df[f"{animal_permutation}_{body_part_name}"] = (
+                            body_part_data["Directing_BOOL"]
+                        )
+                if self.append_bool_tables_to_features:
+                    print(
+                        f"Adding directionality tables to features data for video {video_name}..."
                     )
-                else:
-                    df = pd.concat(
-                        [df.reset_index(drop=True), video_df.reset_index(drop=True)],
-                        axis=1,
+                    df = read_df(
+                        file_path=os.path.join(
+                            self.features_dir, f"{video_name}.{self.file_type}"
+                        ),
+                        file_type=self.file_type,
                     )
+                    if len(df) != len(video_df):
+                        raise CountError(
+                            msg=f"Failed to join data files as they contains different number of frames: the file representing video {video_name} in directory {self.outlier_corrected_dir} contains {len(video_df)} frames, and the file representing video {video_name} in directory {self.features_dir} contains {len(df)} frames."
+                        )
+                    else:
+                        df = pd.concat(
+                            [
+                                df.reset_index(drop=True),
+                                video_df.reset_index(drop=True),
+                            ],
+                            axis=1,
+                        )
                     write_df(
                         df=df,
                         file_type=self.file_type,
                         save_path=os.path.join(
                             self.features_dir, f"{video_name}.{self.file_type}"
                         ),
                     )
-            video_df.to_csv(os.path.join(save_dir, f"{video_name}.csv"))
+                video_df.to_csv(os.path.join(save_dir, f"{video_name}.csv"))
+            stdout_success(
+                msg=f"All boolean tables saved in {save_dir}!",
+                source=self.__class__.__name__,
+            )
+
+        if self.aggregate_statistics_tables:
+            print("Computing summary statistics...")
+            save_path = os.path.join(
+                self.logs_path, f"Direction_aggregate_summary_data_{self.datetime}.csv"
+            )
+            out_df = pd.DataFrame(columns=["VIDEO", "ANIMAL PERMUTATION", "VALUE (S)"])
+            for video_name, video_data in self.results.items():
+                _, _, fps = self.read_video_info(video_name=video_name)
+                for animal_permutation, permutation_data in video_data.items():
+                    idx_directing = set()
+                    for bp_name, bp_data in permutation_data.items():
+                        idx_directing.update(
+                            list(bp_data.index[bp_data["Directing_BOOL"] == 1])
+                        )
+                    value = round(len(idx_directing) / fps, 3)
+                    out_df.loc[len(out_df)] = [video_name, animal_permutation, value]
+
+            self.out_df = out_df.sort_values(
+                by=["VIDEO", "ANIMAL PERMUTATION"]
+            ).set_index("VIDEO")
+            self.out_df.to_csv(save_path)
+            stdout_success(
+                msg=f"Summary directional statistics saved at {save_path}",
+                source=self.__class__.__name__,
+            )
+
+        if self.summary_tables:
+            self.transpose_results()
+            save_dir = os.path.join(
+                self.logs_path,
+                f"detailed_directionality_summary_dataframes_{self.datetime}",
+            )
+            if not os.path.exists(save_dir):
+                os.makedirs(save_dir)
+            for video_cnt, (video_name, video_data) in enumerate(
+                self.directionality_df_dict.items()
+            ):
+                save_name = os.path.join(save_dir, f"{video_name}.csv")
+                video_data.to_csv(save_name)
+            stdout_success(
+                f"All detailed directional data saved in the {save_dir} directory!",
+                source=self.__class__.__name__,
+            )
+        self.timer.stop_timer()
         stdout_success(
-            msg=f"All boolean tables saved in {save_dir}!",
+            msg="All directional data saved in SimBA project",
+            elapsed_time=self.timer.elapsed_time_str,
             source=self.__class__.__name__,
         )
 
-    def _transpose_results_to_df(self):
-        """
-        Privet method to transpose results created by :meth:`~simba.DirectingOtherAnimalsAnalyzer.process_directionality`.
-        into dict of dataframes.
-        """
-
-        print("Transposing directionality data for summary tables...")
+    def transpose_results(self):
         self.directionality_df_dict = {}
-        for video_name, video_data in self.results_dict.items():
+        for video_name, video_data in self.results.items():
             out_df_lst = []
             for animal_permutation, permutation_data in video_data.items():
                 for bp_name, bp_data in permutation_data.items():
                     directing_df = (
                         bp_data[bp_data["Directing_BOOL"] == 1]
                         .reset_index()
                         .rename(
@@ -254,80 +307,15 @@
                     )
                     directing_df.insert(loc=0, column="Video", value=video_name)
                     out_df_lst.append(directing_df)
             self.directionality_df_dict[video_name] = pd.concat(
                 out_df_lst, axis=0
             ).drop("Directing_BOOL", axis=1)
 
-    def _save_directionality_dfs(self):
-        """
-        Privat method to save result created by :meth:`~simba.DirectingOtherAnimalsAnalyzer.create_directionality_dfs`.
-        into CSV files on disk. Results are stored in `project_folder/logs` directory of the SimBA project.
-        """
-        save_dir = os.path.join(
-            self.logs_path,
-            f"detailed_directionality_summary_dataframes_{self.datetime}",
-        )
-        if not os.path.exists(save_dir):
-            os.makedirs(save_dir)
-        for video_cnt, (video_name, video_data) in enumerate(
-            self.directionality_df_dict.items()
-        ):
-            save_name = os.path.join(save_dir, f"{video_name}.csv")
-            video_data.to_csv(save_name)
-            print(
-                f"Detailed directional summary tables saved for video {video_name} (Video {video_cnt+1}/{len(list(self.directionality_df_dict.keys()))})..."
-            )
-        stdout_success(
-            f"All detailed directional data saved in the {save_dir} directory!",
-            source=self.__class__.__name__,
-        )
-
-    def summary_statistics(self):
-        """
-        Method to save aggregate statistics of data created by :meth:`~simba.DirectingOtherAnimalsAnalyzer.create_directionality_dfs`.
-        into CSV files on disk. Results are stored in `project_folder/logs` directory of the SimBA project.
-        """
-        print("Computing summary statistics...")
-        out_df_lst = []
-        for video_name, video_data in self.results_dict.items():
-            _, _, fps = self.read_video_info(video_name=video_name)
-            for animal_permutation, permutation_data in video_data.items():
-                idx_directing = set()
-                for bp_name, bp_data in permutation_data.items():
-                    idx_directing.update(
-                        list(bp_data.index[bp_data["Directing_BOOL"] == 1])
-                    )
-                value = round(len(idx_directing) / fps, 3)
-                out_df_lst.append(
-                    pd.DataFrame(
-                        [[video_name, animal_permutation, value]],
-                        columns=["Video", "Animal permutation", "Value (s)"],
-                    )
-                )
-        self.summary_df = (
-            pd.concat(out_df_lst, axis=0)
-            .sort_values(by=["Video", "Animal permutation"])
-            .set_index("Video")
-        )
-        self.save_path = os.path.join(
-            self.logs_path, f"Direction_aggregate_summary_data_{self.datetime}.csv"
-        )
-        self.summary_df.to_csv(self.save_path)
-        self.timer.stop_timer()
-        stdout_success(
-            msg=f"Summary directional statistics saved at {self.save_path}",
-            source=self.__class__.__name__,
-        )
-        stdout_success(
-            msg="All directional data saved in SimBA project",
-            elapsed_time=self.timer.elapsed_time_str,
-            source=self.__class__.__name__,
-        )
-
 
-# test = DirectingOtherAnimalsAnalyzer(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+# test = DirectingOtherAnimalsAnalyzer(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
 #                                      bool_tables=True,
-#                                      summary_tables=False,
-#                                      aggregate_statistics_tables=False,
-#                                      append_bool_tables_to_features=True)
+#                                      summary_tables=True,
+#                                      aggregate_statistics_tables=True,
+#                                      append_bool_tables_to_features=False,
+#                                      data_paths=None)
 # test.run()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/gibbs_sampler.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/gibbs_sampler.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/timebins_movement_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/timebins_movement_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/severity_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/severity_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/pup_retrieval_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/pup_retrieval_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/pybursts_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/pybursts_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/severity_frame_based_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/severity_frame_based_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/mutual_exclusivity_corrector.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/mutual_exclusivity_corrector.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/kleinberg_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/kleinberg_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/data_processors/movement_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/data_processors/movement_calculator.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/train_rf.py` & `Simba-UW-tf-dev-1.90.5/simba/model/train_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/inference_batch.py` & `Simba-UW-tf-dev-1.90.5/simba/model/inference_batch.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/train_multiclass_rf.py` & `Simba-UW-tf-dev-1.90.5/simba/model/train_multiclass_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/inference_multiclass_batch.py` & `Simba-UW-tf-dev-1.90.5/simba/model/inference_multiclass_batch.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/grid_search_multiclass_rf.py` & `Simba-UW-tf-dev-1.90.5/simba/model/grid_search_multiclass_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/grid_search_rf.py` & `Simba-UW-tf-dev-1.90.5/simba/model/grid_search_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/inference_validation.py` & `Simba-UW-tf-dev-1.90.5/simba/model/inference_validation.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/model/train_multilabel_rf.py` & `Simba-UW-tf-dev-1.90.5/simba/model/train_multilabel_rf.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_time_bin_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_location_advanced.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,279 +1,299 @@
-import itertools
+__author__ = "Simon Nilsson"
+
+import glob
 import os
-import statistics
-from typing import List, Optional, Union
+from copy import deepcopy
+from typing import Union
 
 import numpy as np
 import pandas as pd
+from numba import jit, prange
 
-from simba.data_processors.timebins_movement_calculator import \
-    TimeBinsMovementCalculator
 from simba.mixins.config_reader import ConfigReader
-from simba.mixins.feature_extraction_supplement_mixin import \
-    FeatureExtractionSupplemental
-from simba.roi_tools.ROI_analyzer import ROIAnalyzer
-from simba.utils.checks import check_float, check_if_filepath_list_is_empty
-from simba.utils.enums import DirNames
-from simba.utils.errors import FrameRangeError, ROICoordinatesNotFoundError
-from simba.utils.printing import SimbaTimer, stdout_success
-from simba.utils.read_write import get_fn_ext, read_df
+from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
+from simba.utils.enums import TagNames
+from simba.utils.errors import InvalidInputError, NoFilesFoundError
+from simba.utils.printing import SimbaTimer, log_event, stdout_success
+from simba.utils.read_write import (find_files_of_filetypes_in_directory,
+                                    get_fn_ext, read_df, write_df)
 
 
-class ROITimebinCalculator(ConfigReader):
+class OutlierCorrecterLocationAdvanced(ConfigReader, FeatureExtractionMixin):
     """
-    Compute how much time and how many entries animals are making into user-defined ROIs
-    within user-defined time bins. Also compute the average velocity and distance moved within user-defined ROIs
-    split by time-bins.
-
-    Results are stored in the ``project_folder/logs`` directory of
-    the SimBA project.
-
-    :param Union[str, os.PathLike] config_path: path to SimBA project config file in Configparser format
-    :param float bin_length: length of time bins in seconds.
-    :param List[str] body_parts: List of body-parts to use as proxy of animal locations.
-    :param float threshold: Filter pose-estimation data detected below defined threshold.
-    :param Optional[bool] movement: If True, compute the distances and velocities within time-bins. Default False.
+    Performs location outlier correction that allows different heuristic outlier criteria for different animals or body-parts.
+    For example, correct some outlier body-parts with a location heuristic criteria of 4x above the mean movement,
+    and other body-parts with a heuristic critera of 2x above the mean movement.
 
     .. note::
-       `Example anticipated ROI time-bins entry results <https://github.com/sgoldenlab/simba/blob/master/misc/ROI_time_bins_5.2s_entry_data_20240331125343.csv>`__.
-       `Example anticipated ROI time-bins latency results <https://github.com/sgoldenlab/simba/blob/master/misc/ROI_time_bins_5.2s_time_data_20240331125343.csv>`__.
-       `Example anticipated movement results <https://github.com/sgoldenlab/simba/blob/master/misc/Time_bins_0.5s_movement_results_20240330143150.csv>`__.
+       See `notebook <https://simba-uw-tf-dev.readthedocs.io/en/latest/nb/advanced_outlier_correction.html>`__. for example use-case.
+
+    .. image:: _static/img/location_outlier.png
+       :width: 400
+       :align: center
+
+    :parameter str config_path: path to SimBA project config file in Configparser format.
+    :parameter str input_dir: Directory containing input files. E.g., `project_folder/csv/input_csv` directory.
+    :parameter Literal['animal', 'body-part'] type: If the rules are defined on animal or body-part level. E.g., If one heuristic rule per animal then `animal`. If one heurstic rule prr body-part then `body-parts`
+    :parameter Literal['mean', 'median'] agg_method: If to use the mean or median to compute criterion.
+    :parameter dict criterion_body_parts: The body-parts used to calculate the size of the animals.
+    :parameter dict settings: The heuristic multiplier rules to use for each body part or animal.
 
     :example:
-    >>> calculator = ROITimebinCalculator(config_path=r"/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini", bin_length=1.0, body_parts=['Nose_1'], threshold=0.00, movement=True)
-    >>> calculator.run()
-    >>> calculator.save()
+    >>> settings = {'Simon': 1.1, 'JJ': 1.2}
+    >>> criterion_body_parts = {'Simon': ['Nose_1', 'Tail_base_1'], 'JJ': ['Nose_2', 'Tail_base_2']}
+    >>> outlier_corrector = OutlierCorrecterLocationAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='animal', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
+    >>> outlier_corrector.run()
+    >>> settings = {'Simon': {'Ear_left_1': 1.1, 'Ear_right_1': 5.1, 'Nose_1': 2.1, 'Center_1': 1.5, 'Lat_left_1': 3.1, 'Lat_right_1': 1.9, 'Tail_base_1': 2.3, 'Tail_end_1': 1.4}, 'JJ': {'Ear_left_2': 1.2, 'Ear_right_2': 1.2, 'Nose_2': 2, 'Center_2': 4.1, 'Lat_left_2': 9, 'Lat_right_2': 1.2, 'Tail_base_2': 1.6, 'Tail_end_2': 2.2}}
+    >>> outlier_corrector = OutlierCorrecterLocationAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='body-part', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
     """
 
     def __init__(
         self,
         config_path: Union[str, os.PathLike],
-        bin_length: float,
-        body_parts: List[str],
-        threshold: float,
-        movement: Optional[bool] = False,
+        input_dir: Union[str, os.PathLike],
+        type: str,
+        agg_method: str,
+        criterion_body_parts: dict,
+        settings: dict,
     ):
-
         ConfigReader.__init__(self, config_path=config_path)
-        if not os.path.isfile(self.roi_coordinates_path):
-            raise ROICoordinatesNotFoundError(
-                expected_file_path=self.roi_coordinates_path
-            )
-        check_float(name="bin_length", value=bin_length, min_value=10e-6)
-        check_float(name="threshold", value=threshold, min_value=0.0, max_value=1.0)
-        self.read_roi_data()
-        self.bin_length, self.body_parts, self.threshold = (
-            bin_length,
-            body_parts,
-            threshold,
-        )
-        self.save_path_time = os.path.join(
-            self.logs_path, f"ROI_time_bins_{bin_length}s_time_data_{self.datetime}.csv"
-        )
-        self.save_path_entries = os.path.join(
-            self.logs_path,
-            f"ROI_time_bins_{bin_length}s_entry_data_{self.datetime}.csv",
-        )
-        self.settings = {"threshold": threshold, "body_parts": {}}
-        for i in body_parts:
-            animal_name = self.find_animal_name_from_body_part_name(
-                bp_name=i, bp_dict=self.animal_bp_dict
+        FeatureExtractionMixin.__init__(self)
+        log_event(
+            logger_name=str(self.__class__.__name__),
+            log_type=TagNames.CLASS_INIT.value,
+            msg=self.create_log_msg_from_init_args(locals=locals()),
+        )
+        self.data_files = find_files_of_filetypes_in_directory(
+            directory=input_dir, extensions=["." + self.file_type]
+        )
+        if len(self.data_files) == 0:
+            raise NoFilesFoundError(
+                msg=f"No data of filetype {input_dir} for in directory {self.file_type}",
+                source=self.__class__.__name__,
             )
-            self.settings["body_parts"][animal_name] = i
-        self.roi_analyzer = ROIAnalyzer(
-            ini_path=self.config_path,
-            data_path=DirNames.OUTLIER_MOVEMENT_LOCATION.value,
-            calculate_distances=False,
-            settings=self.settings,
-        )
-        self.roi_analyzer.run()
-        self.animal_names = list(self.roi_analyzer.bp_dict.keys())
-        self.entries_exits_df = self.roi_analyzer.detailed_df
-        self.movement = movement
-        if movement:
-            self.save_path_movement_velocity = os.path.join(
-                self.logs_path,
-                f"ROI_time_bins_{bin_length}s_movement_velocity_data_{self.datetime}.csv",
+        if type not in ["animal", "body-parts"]:
+            raise InvalidInputError(
+                msg=f"Type {type} not supported. Valid options: {['animal', 'body-parts']}",
+                source=self.__class__.__name__,
             )
-            self.movement_timebins = TimeBinsMovementCalculator(
-                config_path=config_path,
-                bin_length=bin_length,
-                body_parts=body_parts,
-                plots=False,
+        if agg_method not in ["mean", "median"]:
+            raise InvalidInputError(
+                msg=f"Aggregation method {agg_method} not supported. Valid options: {['mean', 'median']}",
+                source=self.__class__.__name__,
             )
-            self.movement_timebins.run()
+        self.settings, self.type, self.agg_method, self.criterion_body_parts = (
+            settings,
+            type,
+            agg_method,
+            criterion_body_parts,
+        )
+
+    def fix_settings_for_animal_input(self):
+        new_settings = {}
+        for animal_name, animal_bps in self.animal_bp_dict.items():
+            if animal_name in self.settings.keys():
+                if animal_name not in new_settings.keys():
+                    new_settings[animal_name] = {}
+                for body_part in animal_bps["X_bps"]:
+                    new_settings[animal_name][body_part[:-2]] = self.settings[
+                        animal_name
+                    ]
+        self.settings = new_settings
 
-    def run(self):
-        self.results_entries = pd.DataFrame(
-            columns=[
-                "VIDEO",
-                "SHAPE",
-                "ANIMAL",
-                "BODY-PART",
-                "TIME BIN #",
-                "ENTRY COUNT",
-            ]
-        )
-        self.results_time = pd.DataFrame(
-            columns=[
-                "VIDEO",
-                "SHAPE",
-                "ANIMAL",
-                "BODY-PART",
-                "TIME BIN #",
-                "TIME INSIDE SHAPE (S)",
-            ]
-        )
-        self.results_movement_velocity = pd.DataFrame(
+    @staticmethod
+    @jit(nopython=True)
+    def three_dim_cdist(data: np.ndarray) -> np.ndarray:
+        results = np.full((data.shape[0], data.shape[1], data.shape[1]), np.nan)
+        for i in prange(data.shape[0]):
+            for j in prange(data[i].shape[0]):
+                for k in prange(data[i].shape[0]):
+                    results[i][j][k] = np.linalg.norm(data[i][j] - data[i][k])
+
+        return results
+
+    def _save_data_log(self, data_log: dict):
+        out = pd.DataFrame(
             columns=[
                 "VIDEO",
-                "SHAPE",
                 "ANIMAL",
                 "BODY-PART",
-                "TIME BIN #",
-                "DISTANCE (CM)",
-                "VELOCITY (CM/S)",
+                "OUTLIER COUNT",
+                "OUTLIER RATIO (%)",
             ]
         )
-        check_if_filepath_list_is_empty(
-            filepaths=self.outlier_corrected_paths,
-            error_msg=f"No data files found in {self.outlier_corrected_dir}",
+        save_path = os.path.join(
+            self.logs_path, f"location_outliers_{self.datetime}.csv"
         )
-        print(
-            f"Analyzing time-bin data for {len(self.outlier_corrected_paths)} video(s)..."
+        for video_name, video_data in data_log.items():
+            for animal_name, animal_data in video_data.items():
+                for body_part_name, body_part_data in animal_data.items():
+                    out.loc[len(out)] = [
+                        video_name,
+                        animal_name,
+                        body_part_name,
+                        body_part_data["outlier_cnt"],
+                        body_part_data["outlier_ratio"],
+                    ]
+        write_df(df=out, file_type="csv", save_path=save_path)
+        stdout_success(
+            msg=f"Location outlier log saved at {save_path}",
+            source=self.__class__.__name__,
         )
-        for file_cnt, file_path in enumerate(self.outlier_corrected_paths):
-            video_timer = SimbaTimer(start=True)
-            _, self.video_name, _ = get_fn_ext(filepath=file_path)
-            _, px_per_mm, fps = self.read_video_info(video_name=self.video_name)
-            frames_per_bin = int(fps * self.bin_length)
-            if frames_per_bin == 0:
-                raise FrameRangeError(
-                    msg=f"The specified time-bin length of {self.bin_length} is TOO SHORT for video {self.video_name} which has a specified FPS of {fps}. This results in time bins that are LESS THAN a single frame.",
-                    source=self.__class__.__name__,
+
+    def run(self):
+        data_log = {}
+        if self.type == "animal":
+            self.fix_settings_for_animal_input()
+
+        for file_cnt, file_path in enumerate(self.data_files):
+            video_timer, video_log = SimbaTimer(start=True), {}
+            _, self.video_name, _ = get_fn_ext(file_path)
+            print(
+                "Processing video {}. Video {}/{}...".format(
+                    self.video_name, str(file_cnt + 1), str(len(self.data_files))
                 )
-            video_frms = list(
-                range(0, len(read_df(file_path=file_path, file_type=self.file_type)))
             )
-            frame_bins = [
-                video_frms[i : i + (frames_per_bin)]
-                for i in range(0, len(video_frms), frames_per_bin)
-            ]
-            self.video_data = self.entries_exits_df[
-                self.entries_exits_df["VIDEO"] == self.video_name
-            ]
-            for animal_name, shape_name in list(
-                itertools.product(self.animal_names, self.shape_names)
-            ):
-                body_part = self.settings["body_parts"][animal_name]
-                data_df = self.video_data.loc[
-                    (self.video_data["SHAPE"] == shape_name)
-                    & (self.video_data["ANIMAL"] == animal_name)
-                ]
-                entry_frms = list(data_df["ENTRY FRAMES"])
-                inside_shape_frms = [
-                    list(range(x, y))
-                    for x, y in zip(
-                        list(data_df["ENTRY FRAMES"].astype(int)),
-                        list(data_df["EXIT FRAMES"].astype(int) + 1),
-                    )
-                ]
-                inside_shape_frms = [i for s in inside_shape_frms for i in s]
-                for bin_cnt, bin_frms in enumerate(frame_bins):
-                    frms_inside_roi_in_timebin = [
-                        x for x in inside_shape_frms if x in bin_frms
+            self.data_df = read_df(file_path, self.file_type, check_multiindex=True)
+            self.data_df = self.insert_column_headers_for_outlier_correction(
+                data_df=self.data_df, new_headers=self.bp_headers, filepath=file_path
+            )
+            self.results = deepcopy(self.data_df)
+            self.data_df_combined = self.create_shifted_df(df=self.data_df)
+            animal_movement_agg = {}
+            for animal_name, animal_bps in self.animal_bp_dict.items():
+                if animal_name in self.criterion_body_parts.keys():
+                    animal_criterion_bps = self.criterion_body_parts[animal_name]
+                    bp_1_headers = [
+                        animal_criterion_bps[0] + "_x",
+                        animal_criterion_bps[0] + "_y",
                     ]
-                    entry_roi_in_timebin = [x for x in entry_frms if x in bin_frms]
-                    self.results_time.loc[len(self.results_time)] = [
-                        self.video_name,
-                        shape_name,
-                        animal_name,
-                        body_part,
-                        bin_cnt,
-                        len(frms_inside_roi_in_timebin) / fps,
+                    bp_2_headers = [
+                        animal_criterion_bps[1] + "_x",
+                        animal_criterion_bps[1] + "_y",
                     ]
-                    self.results_entries.loc[len(self.results_entries)] = [
-                        self.video_name,
-                        shape_name,
-                        animal_name,
-                        body_part,
-                        bin_cnt,
-                        len(entry_roi_in_timebin),
+                    distances = self.framewise_euclidean_distance(
+                        location_1=self.data_df[bp_1_headers].values,
+                        location_2=self.data_df[bp_2_headers].values,
+                        px_per_mm=1,
+                    )
+                    if self.agg_method == "mean":
+                        animal_movement_agg[animal_name] = np.mean(distances).astype(
+                            int
+                        )
+                    if self.agg_method == "median":
+                        animal_movement_agg[animal_name] = np.median(distances).astype(
+                            int
+                        )
+
+            for animal_name, animal_bps in self.settings.items():
+                video_log[animal_name] = {}
+                animal_bp_headers = np.array(
+                    [
+                        item
+                        for pair in zip(
+                            self.animal_bp_dict[animal_name]["X_bps"],
+                            self.animal_bp_dict[animal_name]["Y_bps"],
+                        )
+                        for item in pair
                     ]
-                    if self.movement:
-                        if len(frms_inside_roi_in_timebin) > 0:
-                            bin_move = (
-                                self.movement_timebins.movement_dict[self.video_name]
-                                .iloc[frms_inside_roi_in_timebin]
-                                .values.flatten()
-                                .astype(np.float32)
-                            )
-                            _, velocity = (
-                                FeatureExtractionSupplemental.distance_and_velocity(
-                                    x=bin_move,
-                                    fps=fps,
-                                    pixels_per_mm=1,
-                                    centimeters=False,
-                                )
-                            )
-                            self.results_movement_velocity.loc[
-                                len(self.results_movement_velocity)
-                            ] = [
-                                self.video_name,
-                                shape_name,
-                                animal_name,
-                                body_part,
-                                bin_cnt,
-                                bin_move[1:].sum(),
-                                velocity,
-                            ]
-                        else:
-                            self.results_movement_velocity.loc[
-                                len(self.results_movement_velocity)
-                            ] = [
-                                self.video_name,
-                                shape_name,
-                                animal_name,
-                                body_part,
-                                bin_cnt,
-                                0,
-                                0,
-                            ]
+                )
+                animal_body_part_names = [
+                    x[:-2] for x in self.animal_bp_dict[animal_name]["X_bps"]
+                ]
+                animal_body_part_dict = {
+                    k: v
+                    for (v, k) in zip(
+                        animal_body_part_names, range(0, len(animal_body_part_names))
+                    )
+                }
+                animal_arr = self.data_df[animal_bp_headers].values.reshape(
+                    len(self.data_df), -1, 2
+                )
+                data = self.three_dim_cdist(data=animal_arr)
+                df = (
+                    pd.concat(
+                        [pd.DataFrame(arr) for arr in data], keys=np.arange(len(data))
+                    )
+                    .reset_index()
+                    .rename(columns={"level_0": "frame", "level_1": "body_part"})
+                )
+                df["body_part"] = df["body_part"].map(animal_body_part_dict)
+                above_criterion_dict = {}
+                for bp, criterion_multiplier in animal_bps.items():
+                    if animal_name in animal_movement_agg.keys():
+                        bp_criterion = (
+                            animal_movement_agg[animal_name] * criterion_multiplier
+                        )
+                        bp_df = df[df["body_part"] == bp]
+                        bp_df["counts_above_criterion"] = self.count_values_in_range(
+                            data=bp_df.drop(["frame", "body_part"], axis=1).values,
+                            ranges=np.array([[bp_criterion, np.inf]]),
+                        )
+                        above_criterion_dict[bp] = list(
+                            bp_df["frame"][bp_df["counts_above_criterion"] > 1]
+                        )
+
+                for (
+                    bp,
+                    body_part_frames_above_criterion,
+                ) in above_criterion_dict.items():
+                    self.results.loc[
+                        body_part_frames_above_criterion, [f"{bp}_x", f"{bp}_y"]
+                    ] = np.nan
+                    self.results[[f"{bp}_x", f"{bp}_y"]] = (
+                        self.results[[f"{bp}_x", f"{bp}_y"]].ffill().bfill().astype(int)
+                    )
+                    video_log[animal_name][bp] = {
+                        "outlier_cnt": len(body_part_frames_above_criterion),
+                        "outlier_ratio": len(body_part_frames_above_criterion)
+                        / len(self.results),
+                    }
+
+            df_save_path = os.path.join(
+                self.outlier_corrected_dir, self.video_name + f"{self.file_type}."
+            )
+            write_df(df=self.results, file_type=self.file_type, save_path=df_save_path)
             video_timer.stop_timer()
-            print(
-                f"Video {self.video_name} complete (elapsed time {video_timer.elapsed_time_str}s)"
+            stdout_success(
+                msg=f"Location outliers complete for video {self.video_name}.",
+                elapsed_time=video_timer.elapsed_time_str,
+                source=self.__class__.__name__,
             )
+            data_log[self.video_name] = video_log
 
-    def save(self):
-        self.results_time.sort_values(
-            by=["VIDEO", "SHAPE", "ANIMAL", "TIME BIN #"]
-        ).set_index("VIDEO").to_csv(self.save_path_time)
-        self.results_entries.sort_values(
-            by=["VIDEO", "SHAPE", "ANIMAL", "TIME BIN #"]
-        ).set_index("VIDEO").to_csv(self.save_path_entries)
-        self.timer.stop_timer()
-        stdout_success(
-            msg=f"ROI time bin entry data saved at {self.save_path_entries}",
-            elapsed_time=self.timer.elapsed_time_str,
-        )
+        self._save_data_log(data_log=data_log)
         stdout_success(
-            msg=f"ROI time bin time data saved at {self.save_path_time}",
-            elapsed_time=self.timer.elapsed_time_str,
+            msg=f"{len(self.data_files)} video(s) corrected for location outliers. Saved in {self.outlier_corrected_dir}",
+            source=self.__class__.__name__,
         )
-        if self.movement:
-            self.results_movement_velocity.sort_values(
-                by=["VIDEO", "SHAPE", "ANIMAL", "TIME BIN #"]
-            ).set_index("VIDEO").to_csv(self.save_path_movement_velocity)
-            stdout_success(
-                msg=f"ROI time-bin movement data saved at {self.save_path_movement_velocity}",
-                elapsed_time=self.timer.elapsed_time_str,
-            )
 
 
-# test = ROITimebinCalculator(config_path=r"/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini",
-#                             bin_length=1,
-#                             body_parts=['Nose_1'],
-#                             threshold=0.00,
-#                             movement=True)
+# settings = {'Simon': 2.5} #
+# # settings = {'Simon': {'Ear_left_1': 1.1,
+# #                       'Ear_right_1': 5.1,
+# #                       'Nose_1': 2.1,
+# #                       'Center_1': 1.5,
+# #                       'Lat_left_1': 3.1,
+# #                       'Lat_right_1': 1.9,
+# #                       'Tail_base_1': 2.3},
+# #                       #'Tail_end_1': 1.4},
+# #                'JJ': {'Ear_left_2': 1.2,
+# #                       'Ear_right_2': 1.2,
+# #                       'Nose_2': 2,
+# #                       'Center_2': 4.1,
+# #                       'Lat_left_2': 9,
+# #                       'Lat_right_2': 1.2,
+# #                       'Tail_base_2': 1.6,
+# #                       'Tail_end_2': 2.2}}
+# criterion_body_parts = {'Simon': ['Nose_1', 'Tail_base_1'], } #'JJ': ['Nose_2', 'Tail_base_2']
+# test = OutlierCorrecterLocationAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                                         input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv',
+#                                         type='animal',
+#                                         agg_method='mean',
+#                                         criterion_body_parts=criterion_body_parts,
+#                                         settings=settings)
 # test.run()
-# test.save()
+
+
+# test = OutlierCorrecterLocation(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+# test.correct_location_outliers()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/sandbox/.DS_Store`

 * *Files 4% similar despite different names*

```diff
@@ -13,23 +13,23 @@
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0000 0000 0000 0000 0000 0004 0000 000b  ................
 00000110: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00000120: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00000130: 0000 0003 92eb 0000 000b 005f 005f 0070  ..........._._.p
+00000130: 0000 0001 b9ab 0000 000b 005f 005f 0070  ..........._._.p
 00000140: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00000150: 6d6f 4444 626c 6f62 0000 0008 dcf7 0247  moDDblob.......G
-00000160: 8bd5 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
+00000150: 6d6f 4444 626c 6f62 0000 0008 0578 8bd3  moDDblob.....x..
+00000160: a2ec c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
 00000170: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00000180: 6444 626c 6f62 0000 0008 dcf7 0247 8bd5  dDblob.......G..
+00000180: 6444 626c 6f62 0000 0008 0578 8bd3 a2ec  dDblob.....x....
 00000190: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000001a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
-000001b0: 636f 6d70 0000 0000 0004 a000 0000 0000  comp............
+000001b0: 636f 6d70 0000 0000 0002 2000 0000 0000  comp...... .....
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_define.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_define.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_reset.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_reset.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_size_standardizer.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_size_standardizer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_feature_analyzer.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_clf_calculator.py`

 * *Files 18% similar despite different names*

```diff
@@ -1,348 +1,343 @@
 __author__ = "Simon Nilsson"
 
-import glob
-import itertools
 import os
-from copy import deepcopy
-from typing import Dict, Optional
 
 import numpy as np
 import pandas as pd
+from shapely import geometry
+from shapely.geometry import Point, Polygon
 
 from simba.mixins.config_reader import ConfigReader
-from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
-from simba.roi_tools.ROI_analyzer import ROIAnalyzer
-from simba.roi_tools.ROI_directing_analyzer import DirectingROIAnalyzer
-from simba.utils.enums import ConfigKey, TagNames
-from simba.utils.errors import NoFilesFoundError, NoROIDataError
-from simba.utils.printing import SimbaTimer, log_event, stdout_success
-from simba.utils.read_write import get_fn_ext, read_df, write_df
-from simba.utils.warnings import NoDataFoundWarning, NoFileFoundWarning
+from simba.utils.checks import (check_if_filepath_list_is_empty,
+                                check_that_column_exist)
+from simba.utils.data import detect_bouts
+from simba.utils.errors import NoChoosenClassifierError, NoROIDataError
+from simba.utils.printing import stdout_success
+from simba.utils.read_write import get_fn_ext, read_config_entry, read_df
+from simba.utils.warnings import NoDataFoundWarning, ROIWarning
 
 
-class ROIFeatureCreator(ConfigReader, FeatureExtractionMixin):
+class ROIClfCalculator(ConfigReader):
     """
-    Compute features based on the relationships between the location of the animals and the location of
-    user-defined ROIs.
+    Compute aggregate statistics of classification results within user-defined ROIs.
+    Results are stored in `project_folder/logs` directory of the SimBA project.
 
-    :param str config_path: Path to SimBA project config file in Configparser format
-    :param Optional[dict] settings: If dict, the animal body-parts and the probability threshold. If None, then the data is read from the
-        project_config.ini. Defalt: None. Example:
+    :param str config_path: path to SimBA project config file in Configparser format
 
-    .. note::
-        `ROI tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial_new.md>`__.
+    .. note:
+       'GitHub tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#part-4--analyze-machine-results`__.
 
     Examples
-    ----------
-    >>> settings = {'body_parts': {'Simon': 'Ear_left_1', 'JJ': 'Ear_left_2'}, 'threshold': 0.4}
-    >>> roi_featurizer = ROIFeatureCreator(config_path='MyProjectConfig', settings=settings)
-    >>> roi_featurizer.run()
-    >>> roi_featurizer.save()
-
+    -----
+    >>> clf_ROI_analyzer = ROIClfCalculator(config_ini="MyConfigPath")
+    >>> clf_ROI_analyzer.run(behavior_list=['Attack', 'Sniffing'], ROI_dict_lists={'Rectangle': ['rec'], 'Circle': ['Stimulus 1', 'Stimulus 2', 'Stimulus 3']}, body_part_list=['Nose_1'], measurements=['Total time by ROI (s)', 'Started bouts by ROI (count)', 'Ended bouts by ROI (count)'])
     """
 
-    def __init__(self, config_path: str, settings: Optional[Dict] = None):
-        ConfigReader.__init__(self, config_path=config_path)
-        FeatureExtractionMixin.__init__(self, config_path=config_path)
-        self.roi_directing_viable = self.check_directionality_viable()[0]
-        log_event(
-            logger_name=str(__class__.__name__),
-            log_type=TagNames.CLASS_INIT.value,
-            msg=self.create_log_msg_from_init_args(locals=locals()),
-        )
-        self.settings = settings
-        if self.roi_directing_viable:
-            print("Directionality calculations are VIABLE.")
-            self.directing_analyzer = DirectingROIAnalyzer(
-                config_path=config_path,
-                data_path=self.outlier_corrected_dir,
-                settings=settings,
-            )
+    def __init__(self, config_ini: str):
+        ConfigReader.__init__(self, config_path=config_ini)
+        self.read_roi_data()
+
+    def __inside_rectangle(
+        self, bp_x, bp_y, top_left_x, top_left_y, bottom_right_x, bottom_right_y
+    ):
+        """
+        Private helper to calculate if body-part is inside a rectangle.
+        """
+        if ((top_left_x) <= bp_x <= (bottom_right_x)) and (
+            (top_left_y) <= bp_y <= (bottom_right_y)
+        ):
+            return 1
         else:
-            self.directing_analyzer = None
+            return 0
 
-        self.tracked_animal_bps = []
-        for animal in range(self.animal_cnt):
-            if self.config.has_option(
-                ConfigKey.ROI_SETTINGS.value, f"animal_{animal + 1}_bp"
-            ):
-                bp = self.config.get(
-                    "ROI settings", "animal_{}_bp".format(str(animal + 1))
-                )
-                if len(bp) == 0:
-                    raise NoROIDataError(
-                        msg="Please analyze ROI data for all animals before appending ROI features . No body-part setting found in config file [ROI settings][animal_{}_bp]",
-                        source=self.__class__.__name__,
+    def __inside_circle(self, bp_x, bp_y, center_x, center_y, radius):
+        """
+        Private helper to calculate if body-part is inside a circle.
+        """
+        px_dist = int(np.sqrt((bp_x - center_x) ** 2 + (bp_y - center_y) ** 2))
+        if px_dist <= radius:
+            return 1
+        else:
+            return 0
+
+    def __inside_polygon(self, bp_x, bp_y, polygon):
+        """
+        Private helper to calculate if body-part is inside a polygon.
+        """
+        if polygon.contains(Point(int(bp_x), int(bp_y))):
+            return 1
+        else:
+            return 0
+
+    def __compute_agg_statistics(self, data: pd.DataFrame):
+        """
+
+        Parameters
+        ----------
+        data: pd.DataFrame
+            Dataframe with boolean columns representing behaviors (behavior present: 1, behavior absent: 0)
+            and ROI data (inside ROI: 1, outside ROI: 0).
+
+        """
+        self.results_dict[self.video_name] = {}
+        for clf in self.behavior_list:
+            self.results_dict[self.video_name][clf] = {}
+            for roi in self.found_rois:
+                self.results_dict[self.video_name][clf][roi] = {}
+                if "Total time by ROI (s)" in self.measurements:
+                    frame_cnt = len(data.loc[(data[clf] == 1) & (data[roi] == 1)])
+                    if frame_cnt > 0:
+                        self.results_dict[self.video_name][clf][roi][
+                            "Total time by ROI (s)"
+                        ] = (frame_cnt / self.fps)
+                    else:
+                        self.results_dict[self.video_name][clf][roi][
+                            "Total time (s)"
+                        ] = 0
+                if "Started bouts by ROI (count)" in self.measurements:
+                    start_frames = list(
+                        detect_bouts(data_df=data, target_lst=[clf], fps=int(self.fps))[
+                            "Start_frame"
+                        ]
+                    )
+                    self.results_dict[self.video_name][clf][roi][
+                        "Started bouts by ROI (count)"
+                    ] = len(data[(data.index.isin(start_frames)) & (data[roi] == 1)])
+                if "Ended bouts by ROI (count)" in self.measurements:
+                    start_frames = list(
+                        detect_bouts(data_df=data, target_lst=[clf], fps=int(self.fps))[
+                            "End_frame"
+                        ]
                     )
-                else:
-                    self.tracked_animal_bps.append([bp + "_x", bp + "_y"])
+                    self.results_dict[self.video_name][clf][roi][
+                        "Ended bouts by ROI (count)"
+                    ] = len(data[(data.index.isin(start_frames)) & (data[roi] == 1)])
 
-        self.files_found = glob.glob(
-            self.outlier_corrected_dir + "/*." + self.file_type
+    def __print_missing_roi_warning(self, roi_type: str, roi_name: str):
+        """
+        Private helper to print warnings when ROI shapes have been defined in some videos but missing in others.
+        """
+        names = "None"
+        ROIWarning(
+            msg=f'ROI named "{roi_name}" of shape type "{roi_type}" not found for video {self.video_name}. Skipping shape...'
         )
-        if len(self.files_found) == 0:
-            raise NoFilesFoundError(
-                msg=f"SIMBA ERROR: No data files found in {self.outlier_corrected_dir}",
-                source=self.__class__.__name__,
+        if roi_type.lower() == "rectangle":
+            names = list(
+                self.rectangles_df["Name"][
+                    self.rectangles_df["Video"] == self.video_name
+                ]
             )
-        self.features_files = glob.glob(self.features_dir + "/*." + self.file_type)
-        if len(self.features_files) == 0:
-            NoFileFoundWarning(
-                msg=f"No data files found in {self.features_dir}",
-                source=self.__class__.__name__,
+        elif roi_type.lower() == "circle":
+            names = list(
+                self.circles_df["Name"][self.circles_df["Video"] == self.video_name]
             )
-        print(
-            "Processing {} videos for ROI features...".format(
-                str(len(self.files_found))
+        elif roi_type.lower() == "polygon":
+            names = list(
+                self.polygon_df["Name"][self.polygon_df["Video"] == self.video_name]
             )
+        ROIWarning(
+            msg=f"NOTE: Video {self.video_name} has the following {roi_type} shape names: {names}"
         )
 
-    def run(self):
+    def run(
+        self,
+        ROI_dict_lists: dict,
+        measurements: list,
+        behavior_list: list,
+        body_part_list: list,
+    ):
         """
-        Method to run the ROI feature analysis
-
-        Returns
-        -------
-        Attribute: dict
-            data
+        Parameters
+        ----------
+        ROI_dict_lists: dict
+            A dictionary with the shape type as keys (i.e., Rectangle, Circle, Polygon) and lists of shape names
+            as values.
+        measurements: list
+            Measurements to calculate aggregate statistics for. E.g., ['Total time by ROI (s)', 'Started bouts', 'Ended bouts']
+        behavior_list: list
+            Classifier names to calculate ROI statistics. E.g., ['Attack', 'Sniffing']
+        body_part_list: list
+            Body-part names to use to infer animal location. Eg., ['Nose_1'].
         """
 
-        self.roi_analyzer = ROIAnalyzer(
-            ini_path=self.config_path,
-            data_path=self.outlier_corrected_dir,
-            calculate_distances=True,
-            settings=self.settings,
+        self.ROI_dict_lists, self.behavior_list, self.measurements = (
+            ROI_dict_lists,
+            self.clf_names,
+            measurements,
         )
-        self.roi_analyzer.files_found = self.files_found
-        self.all_shape_names = self.roi_analyzer.shape_names
-        self.roi_analyzer.run()
-        self.roi_analyzer.compute_framewise_distance_to_roi_centroids()
-        self.roi_distances_dict = self.roi_analyzer.roi_centroid_distance
-        self.roi_entries_df = self.roi_analyzer.detailed_df
-        if self.roi_directing_viable:
-            self.directing_analyzer.run()
-            self.roi_direction_df = self.directing_analyzer.results_df
-
-        self.data, self.summary = {}, {}
-        for file_cnt, file_path in enumerate(self.features_files):
-            _, self.video_name, _ = get_fn_ext(file_path)
-            _, _, self.fps = self.read_video_info(video_name=self.video_name)
+        self.file_type = read_config_entry(
+            config=self.config,
+            section="General settings",
+            option="workflow_file_type",
+            data_type="str",
+        )
+        check_if_filepath_list_is_empty(
+            filepaths=self.machine_results_paths,
+            error_msg="SIMBA ERROR: No machine learning results found in the project_folder/csv/machine_results directory. Create machine classifications before analyzing classifications by ROI",
+        )
+        if len(behavior_list) == 0:
+            raise NoChoosenClassifierError()
+        print(f"Analyzing {str(len(self.machine_results_paths))} files...")
+        body_part_col_names = []
+        body_part_col_names_x, body_part_col_names_y = [], []
+        for body_part in body_part_list:
+            body_part_col_names.extend(
+                (body_part + "_x", body_part + "_y", body_part + "_p")
+            )
+            body_part_col_names_x.append(body_part + "_x")
+            body_part_col_names_y.append(body_part + "_y")
+        all_columns = body_part_col_names + self.behavior_list
+        self.results_dict = {}
+
+        self.frame_counter_dict = {}
+        for file_cnt, file_path in enumerate(self.machine_results_paths):
+            _, self.video_name, ext = get_fn_ext(file_path)
+            print("Analyzing {}....".format(self.video_name))
             data_df = read_df(file_path, self.file_type)
-            self.out_df = deepcopy(data_df)
-            self.original_feature_names = data_df.columns
-            self.__process_within_rois()
-            self.__distance_to_roi_centroids()
-            if self.roi_directing_viable:
-                self.__process_directionality()
-            self.data[self.video_name] = self.out_df
-            self.__summarize_roi_results()
-
-    def __process_within_rois(self):
-        self.inside_roi_columns = []
-        if not self.settings:
-            for animal_name, shape_name in itertools.product(
-                self.multi_animal_id_list, self.all_shape_names
-            ):
-                column_name = "{} {} {}".format(shape_name, animal_name, "in zone")
-                self.inside_roi_columns.append(column_name)
-                video_animal_shape_df = self.roi_entries_df.loc[
-                    (self.roi_entries_df["VIDEO"] == self.video_name)
-                    & (self.roi_entries_df["SHAPE"] == shape_name)
-                    & (self.roi_entries_df["ANIMAL"] == animal_name)
-                ]
-                self.out_df[column_name] = 0
-                if len(video_animal_shape_df) > 0:
-                    inside_roi_idx = list(
-                        video_animal_shape_df.apply(
-                            lambda x: list(
-                                range(int(x["ENTRY FRAMES"]), int(x["EXIT FRAMES"]) + 1)
-                            ),
-                            1,
-                        )
-                    )
-                    inside_roi_idx = [x for xs in inside_roi_idx for x in xs]
-                    self.out_df.loc[inside_roi_idx, column_name] = 1
-                self.out_df[column_name + "_cumulative_time"] = self.out_df[
-                    column_name
-                ].cumsum() * float(1 / self.fps)
-                self.out_df[column_name + "_cumulative_percent"] = self.out_df[
-                    column_name
-                ].cumsum() / (self.out_df.index + 1)
-                self.out_df.replace([np.inf, -np.inf], 1, inplace=True)
-        else:
-            for animal_cnt, shape_name in itertools.product(
-                list(self.settings["body_parts"].keys()), self.all_shape_names
-            ):
-                bp_name = self.settings["body_parts"][animal_cnt]
-                animal_name = self.find_animal_name_from_body_part_name(
-                    bp_name=self.settings["body_parts"][animal_cnt],
-                    bp_dict=self.animal_bp_dict,
+            for column in all_columns:
+                check_that_column_exist(
+                    file_name=self.video_name, df=data_df, column_name=column
                 )
-                column_name = "{} {} {} {}".format(
-                    shape_name, animal_name, bp_name, "zone"
+            data_df = data_df[all_columns]
+            self.results = data_df[self.behavior_list]
+            shapes_in_video = (
+                len(
+                    self.rectangles_df.loc[
+                        (self.rectangles_df["Video"] == self.video_name)
+                    ]
                 )
-                self.inside_roi_columns.append(column_name)
-                video_body_part_shape_df = self.roi_entries_df.loc[
-                    (self.roi_entries_df["VIDEO"] == self.video_name)
-                    & (self.roi_entries_df["SHAPE"] == shape_name)
-                    & (self.roi_entries_df["ANIMAL"] == animal_name)
-                    & (self.roi_entries_df["BODY-PART"] == bp_name)
-                ]
-                self.out_df[column_name] = 0
-                if len(video_body_part_shape_df) > 0:
-                    inside_roi_idx = list(
-                        video_body_part_shape_df.apply(
-                            lambda x: list(
-                                range(int(x["ENTRY FRAMES"]), int(x["EXIT FRAMES"]) + 1)
-                            ),
-                            1,
-                        )
-                    )
-                    inside_roi_idx = [x for xs in inside_roi_idx for x in xs]
-                    self.out_df.loc[inside_roi_idx, column_name] = 1
-                self.out_df[column_name + "_cumulative_time"] = self.out_df[
-                    column_name
-                ].cumsum() * float(1 / self.fps)
-                self.out_df[column_name + "_cumulative_percent"] = self.out_df[
-                    column_name
-                ].cumsum() / (self.out_df.index + 1)
-                self.out_df.replace([np.inf, -np.inf], 1, inplace=True)
-
-    def __distance_to_roi_centroids(self):
-        self.roi_distance_columns = []
-        video_distances = self.roi_distances_dict[self.video_name]
-        if not self.settings:
-            for animal_name, shape_name in itertools.product(
-                self.multi_animal_id_list, self.all_shape_names
-            ):
-                column_name = "{} {} {}".format(shape_name, animal_name, "distance")
-                if animal_name in list(video_distances.keys()):
-                    if shape_name in list(video_distances[animal_name].keys()):
-                        self.roi_distance_columns.append(column_name)
-                        self.out_df[column_name] = video_distances[animal_name][
-                            shape_name
-                        ]
-                    else:
-                        raise NoROIDataError(
-                            msg=f"The ROI named {shape_name} could not be find in video {self.video_name}. Draw the shape or remove the file from the SimBA project",
-                            source=self.__class__.__name__,
-                        )
-                else:
-                    pass
-
-        else:
-            for animal_cnt, shape_name in itertools.product(
-                list(self.settings["body_parts"].keys()), self.all_shape_names
-            ):
-                bp_name = self.settings["body_parts"][animal_cnt]
-                animal_name = self.find_animal_name_from_body_part_name(
-                    bp_name=self.settings["body_parts"][animal_cnt],
-                    bp_dict=self.animal_bp_dict,
+                + len(
+                    self.circles_df.loc[(self.circles_df["Video"] == self.video_name)]
                 )
-                column_name = "{} {} {} {}".format(
-                    shape_name, animal_name, bp_name, "distance"
+                + len(
+                    self.polygon_df.loc[(self.polygon_df["Video"] == self.video_name)]
                 )
-                self.roi_distance_columns.append(column_name)
-                try:
-                    video_animal_shape_df = video_distances[animal_cnt][shape_name]
-                except KeyError:
-                    raise NoROIDataError(
-                        msg=f"The ROI named {shape_name} could not be find in video {self.video_name}",
-                        source=self.__class__.__name__,
-                    )
-                self.out_df[column_name] = video_animal_shape_df
-
-    def __process_directionality(self):
-        self.roi_directing_columns = []
-        video_directionality = self.roi_direction_df[
-            self.roi_direction_df["Video"] == self.video_name
-        ]
-        for animal_name, shape_name in itertools.product(
-            self.multi_animal_id_list, self.all_shape_names
-        ):
-            column_name = "{} {} {}".format(shape_name, animal_name, "facing")
-            self.roi_directing_columns.append(column_name)
-            video_animal_shape_df = video_directionality.loc[
-                (video_directionality["ROI"] == shape_name)
-                & (video_directionality["Animal"] == animal_name)
-            ]
-            if len(video_animal_shape_df) > 0:
-                directing_idx = list(video_animal_shape_df["Frame"])
-                self.out_df.loc[directing_idx, column_name] = 1
-            else:
-                self.out_df[column_name] = 0
-
-    def __summarize_roi_results(self):
-        self.summary[self.video_name] = {}
-        for roi_feature in self.roi_distance_columns:
-            self.summary[self.video_name][f"{roi_feature} mean (mm)"] = (
-                self.out_df[roi_feature].mean().round(4)
             )
-        if self.roi_directing_viable:
-            for roi_feature in self.roi_directing_columns:
-                self.summary[self.video_name][f"{roi_feature} sum (s)"] = round(
-                    (self.out_df[roi_feature].sum() / self.fps), 4
+            if shapes_in_video == 0:
+                NoDataFoundWarning(
+                    msg="Skipping {self.video_name}: Video {self.video_name} has 0 user-defined ROI shapes."
                 )
+                continue
+            _, _, self.fps = self.read_video_info(video_name=self.video_name)
+            self.found_rois = []
+            for roi_type, roi_data in self.ROI_dict_lists.items():
+                shape_info = pd.DataFrame()
+                for roi_name in roi_data:
+                    if roi_type.lower() == "rectangle":
+                        shape_info = self.rectangles_df.loc[
+                            (self.rectangles_df["Video"] == self.video_name)
+                            & (self.rectangles_df["Shape_type"] == roi_type)
+                            & (self.rectangles_df["Name"] == roi_name)
+                        ]
+                    elif roi_type.lower() == "circle":
+                        shape_info = self.circles_df.loc[
+                            (self.circles_df["Video"] == self.video_name)
+                            & (self.circles_df["Shape_type"] == roi_type)
+                            & (self.circles_df["Name"] == roi_name)
+                        ]
+                    elif roi_type.lower() == "polygon":
+                        shape_info = self.polygon_df.loc[
+                            (self.polygon_df["Video"] == self.video_name)
+                            & (self.polygon_df["Shape_type"] == roi_type)
+                            & (self.polygon_df["Name"] == roi_name)
+                        ]
+                    if len(shape_info) == 0:
+                        self.__print_missing_roi_warning(
+                            roi_type=roi_type, roi_name=roi_name
+                        )
+                        continue
+                    if roi_type.lower() == "rectangle":
+                        data_df["top_left_x"], data_df["top_left_y"] = (
+                            shape_info["topLeftX"].values[0],
+                            shape_info["topLeftY"].values[0],
+                        )
+                        data_df["bottom_right_x"], data_df["bottom_right_y"] = (
+                            shape_info["Bottom_right_X"].values[0],
+                            shape_info["Bottom_right_Y"].values[0],
+                        )
+                        self.results[roi_name] = data_df.apply(
+                            lambda x: self.__inside_rectangle(
+                                bp_x=x[body_part_col_names_x[0]],
+                                bp_y=x[body_part_col_names_y[0]],
+                                top_left_x=x["top_left_x"],
+                                top_left_y=x["top_left_y"],
+                                bottom_right_x=x["bottom_right_x"],
+                                bottom_right_y=x["bottom_right_y"],
+                            ),
+                            axis=1,
+                        )
+                        self.found_rois.append(roi_name)
+                    elif roi_type.lower() == "circle":
+                        data_df["center_x"], data_df["center_y"], data_df["radius"] = (
+                            shape_info["centerX"].values[0],
+                            shape_info["centerY"].values[0],
+                            shape_info["radius"].values[0],
+                        )
+                        self.results[roi_name] = data_df.apply(
+                            lambda x: self.__inside_circle(
+                                bp_x=x[body_part_col_names_x[0]],
+                                bp_y=x[body_part_col_names_y[0]],
+                                center_x=x["center_x"],
+                                center_y=x["center_y"],
+                                radius=x["radius"],
+                            ),
+                            axis=1,
+                        )
+                        self.found_rois.append(roi_name)
+                    elif roi_type.lower() == "polygon":
+                        polygon_vertices = []
+                        for i in shape_info["vertices"].values[0]:
+                            polygon_vertices.append(geometry.Point(i))
+                        polygon = Polygon([[p.x, p.y] for p in polygon_vertices])
+                        self.results[roi_name] = data_df.apply(
+                            lambda x: self.__inside_polygon(
+                                bp_x=x[body_part_col_names_x[0]],
+                                bp_y=x[body_part_col_names_y[0]],
+                                polygon=polygon,
+                            ),
+                            axis=1,
+                        )
+                        self.found_rois.append(roi_name)
+                self.__compute_agg_statistics(data=self.results)
+        self.__organize_output_data()
 
-    def save(self):
+    def __organize_output_data(self):
         """
-        Method to save new featurized files inside the ``project_folder/csv/features_extracted`` directory
-        of the SimBA project
-
-        > Note: Method **overwrites** existing files in the project_folder/csv/features_extracted directory.
-
-        Returns
-        -------
-        None
-
+        Helper to organize the results[dict] into a human-readable CSV file.
         """
-
-        for video_name, video_data in self.data.items():
-            save_path = os.path.join(
-                self.features_dir, video_name + "." + self.file_type
+        if len(self.results_dict.keys()) == 0:
+            raise NoROIDataError(
+                msg="ZERO ROIs found the videos represented in the project_folder/csv/machine_results directory"
             )
-            write_df(
-                df=video_data.fillna(0), file_type=self.file_type, save_path=save_path
-            )
-            print("Created additional ROI features for {}...".format(video_name))
+        out_df = pd.DataFrame(
+            columns=["VIDEO", "CLASSIFIER", "ROI", "MEASUREMENT", "VALUE"]
+        )
+        for video_name, video_data in self.results_dict.items():
+            for clf, clf_data in video_data.items():
+                for roi_name, roi_data in clf_data.items():
+                    for measurement_name, mesurement_value in roi_data.items():
+                        out_df.loc[len(out_df)] = [
+                            video_name,
+                            clf,
+                            roi_name,
+                            measurement_name,
+                            mesurement_value,
+                        ]
+        out_path = os.path.join(
+            self.logs_path, f"Classification_time_by_ROI_{self.datetime}.csv"
+        )
+        out_df.to_csv(out_path)
         self.timer.stop_timer()
         stdout_success(
-            msg="Created additional ROI features for files within the project_folder/csv/features_extracted directory",
+            msg=f"Classification data by ROIs saved in {out_path}.",
             elapsed_time=self.timer.elapsed_time_str,
-            source=self.__class__.__name__,
         )
 
-        if len(list(self.summary.keys())) > 0:
-            summary_timer = SimbaTimer(start=True)
-            save_path = os.path.join(
-                self.logs_path, f"ROI_features_summary_{self.datetime}.csv"
-            )
-            summary_out_df = pd.DataFrame(columns=["VIDEO", "MEASURE", "VALUE"])
-            for video_name, video_data in self.summary.items():
-                for video_measure, val in video_data.items():
-                    summary_out_df.loc[len(summary_out_df)] = [
-                        video_name,
-                        video_measure,
-                        val,
-                    ]
-            summary_out_df.to_csv(
-                os.path.join(
-                    self.logs_path, f"ROI_features_summary_{self.datetime}.csv"
-                )
-            )
-            summary_timer.stop_timer()
-            stdout_success(
-                msg=f"ROI feature summary data saved at {save_path}",
-                elapsed_time=summary_timer.elapsed_time_str,
-            )
-
-
-# roi_featurizer = ROIFeatureCreator(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
-# roi_featurizer.roi_directing_viable
-# roi_featurizer.run()
-# roi_featurizer.save()
 
+#
+# clf_ROI_analyzer = clf_within_ROI(config_ini="/Users/simon/Desktop/troubleshooting/train_model_project/project_folder/project_config.ini")
+# clf_ROI_analyzer.run(behavior_list=['Attack', 'Sniffing'], ROI_dict_lists={'Rectangle': ['rec'], 'Circle': ['Stimulus 1', 'Stimulus 2', 'Stimulus 3']}, body_part_list=['Nose_1'], measurements=['Total time by ROI (s)', 'Started bouts by ROI (count)', 'Ended bouts by ROI (count)'])
+#
 
-# roi_featurizer = ROIFeatureCreator(config_path='/Users/simon/Desktop/envs/troubleshooting/two_animals_16bp_032023/project_folder/project_config.ini')
-# roi_featurizer.run()
-# roi_featurizer.save()
+# test = ROIClfCalculator(config_ini="/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini")
+# test.run(behavior_list=['Attack', 'Sniffing'], ROI_dict_lists={'Rectangle': ['DAMN'], 'Circle': [], 'Polygon': ['YOU_SUCK_SIMON']}, body_part_list=['Nose_1'], measurements=['Total time by ROI (s)', 'Started bouts by ROI (count)', 'Ended bouts by ROI (count)'])
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_multiply.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_multiply.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_size_calculations.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_size_calculations.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_zoom.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_zoom.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_directing_analyzer.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_directing_analyzer.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,76 +1,99 @@
 __author__ = "Simon Nilsson"
 
-from copy import deepcopy
-from typing import Dict, Optional
+import os
+from typing import Optional, Union
 
 import numpy as np
 import pandas as pd
 from numba import jit, prange
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
-from simba.roi_tools.ROI_analyzer import ROIAnalyzer
-from simba.utils.read_write import get_fn_ext
+from simba.utils.checks import check_file_exist_and_readable
+from simba.utils.data import slice_roi_dict_for_video
+from simba.utils.errors import InvalidInputError, ROICoordinatesNotFoundError
+from simba.utils.printing import SimbaTimer, stdout_success
+from simba.utils.read_write import get_fn_ext, read_data_paths, read_df
 
 
 class DirectingROIAnalyzer(ConfigReader, FeatureExtractionMixin):
     """
     Compute aggregate statistics for animals directing towards ROIs.
 
     :param str config_path: Path to SimBA project config file in Configparser format
-    :param Optional[dict] settings: If dict, the animal body-parts and the probability threshold. If None, then the data is read from the
-        project_config.ini. Defalt: None.
+    :param Optional[Union[str, os.PathLike]] data_path: Path to folder or file holding the data used to calculate ROI aggregate statistics. If None, then defaults to the `project_folder/csv/outlier_corrected_movement_location` directory of the SimBA project. Default: None.
 
     .. note::
        `ROI tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial_new.md>`__.
 
-    Examples
-    ----------
-    >>> settings = {'body_parts': {'Simon': 'Ear_left_1', 'JJ': 'Ear_left_2'}, 'threshold': 0.4}
-    >>> _ = DirectingROIAnalyzer(config_path='MyProjectConfig', settings=settings).run()
+       `Example expected output file <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial_new.md>`__.
+
+    :example:
+    >>> test = DirectingROIAnalyzer(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+    >>> test.run()
+    >>> test.save()
     """
 
     def __init__(
         self,
-        config_path: str,
-        data_path: Optional[str] = None,
-        settings: Optional[dict] = None,
+        config_path: Union[str, os.PathLike],
+        data_path: Optional[Union[str, os.PathLike]] = None,
     ):
+
+        check_file_exist_and_readable(file_path=config_path)
         ConfigReader.__init__(self, config_path=config_path)
         FeatureExtractionMixin.__init__(self, config_path=config_path)
-        self.roi_analyzer = ROIAnalyzer(
-            ini_path=config_path,
-            data_path="outlier_corrected_movement_location",
-            settings=settings,
+        self.data_paths = read_data_paths(
+            path=data_path,
+            default=self.outlier_corrected_paths,
+            default_name=self.outlier_corrected_dir,
+            file_type=self.file_type,
         )
-        self.files_found = deepcopy(self.roi_analyzer.files_found)
+        if not os.path.isfile(self.roi_coordinates_path):
+            raise ROICoordinatesNotFoundError(
+                expected_file_path=self.roi_coordinates_path
+            )
+        if not self.check_directionality_viable()[0]:
+            raise InvalidInputError(
+                msg="Cannot compute directionality towards ROIs. The ear and nose data is tracked in the project",
+                source=self.__class__.__name__,
+            )
+        self.read_roi_data()
         self.direct_bp_dict = self.check_directionality_cords()
 
-    def __format_direction_data(self):
-        x_min = np.minimum(self.direction_data[:, 1], self.nose_arr[:, 0])
-        y_min = np.minimum(self.direction_data[:, 2], self.nose_arr[:, 1])
-        delta_x = abs((self.direction_data[:, 1] - self.nose_arr[:, 0]) / 2)
-        delta_y = abs((self.direction_data[:, 2] - self.nose_arr[:, 1]) / 2)
+    def __format_direction_data(
+        self,
+        direction_data: np.ndarray,
+        nose_arr: np.ndarray,
+        roi_center: np.ndarray,
+        animal_name: str,
+        shape_name: str,
+    ) -> pd.DataFrame:
+
+        x_min = np.minimum(direction_data[:, 1], nose_arr[:, 0])
+        y_min = np.minimum(direction_data[:, 2], nose_arr[:, 1])
+        delta_x = abs((direction_data[:, 1] - nose_arr[:, 0]) / 2)
+        delta_y = abs((direction_data[:, 2] - nose_arr[:, 1]) / 2)
         x_middle, y_middle = np.add(x_min, delta_x), np.add(y_min, delta_y)
         direction_data = np.concatenate(
-            (y_middle.reshape(-1, 1), self.direction_data), axis=1
+            (y_middle.reshape(-1, 1), direction_data), axis=1
         )
         direction_data = np.concatenate(
             (x_middle.reshape(-1, 1), direction_data), axis=1
         )
         direction_data = np.delete(direction_data, [2, 3, 4], 1)
         bp_data = pd.DataFrame(
             direction_data, columns=["Eye_x", "Eye_y", "Directing_BOOL"]
         )
-        bp_data["ROI_x"] = self.center_cord[0]
-        bp_data["ROI_y"] = self.center_cord[1]
+        bp_data["ROI_x"] = roi_center[0]
+        bp_data["ROI_y"] = roi_center[1]
         bp_data = bp_data[["Eye_x", "Eye_y", "ROI_x", "ROI_y", "Directing_BOOL"]]
-        bp_data.insert(loc=0, column="ROI", value=self.shape_info["Name"])
-        bp_data.insert(loc=0, column="Animal", value=self.animal_name)
+        bp_data.insert(loc=0, column="ROI", value=shape_name)
+        bp_data.insert(loc=0, column="Animal", value=animal_name)
         bp_data.insert(loc=0, column="Video", value=self.video_name)
         bp_data = bp_data.reset_index().rename(columns={"index": "Frame"})
         bp_data = bp_data[bp_data["Directing_BOOL"] == 1].reset_index(drop=True)
         return bp_data
 
     @staticmethod
     @jit(nopython=True, fastmath=True)
@@ -113,188 +136,141 @@
                         )
                         if distance < min_distance:
                             results[i] = roi_lines[j]
                             min_distance = distance
 
         return results
 
-    def __find_roi_intersections(self):
-        eye_lines = self.bp_data[["Eye_x", "Eye_y", "ROI_x", "ROI_y"]].values.astype(
-            int
-        )
+    def __find_roi_intersections(self, bp_data: pd.DataFrame, shape_info: dict):
+
+        eye_lines = bp_data[["Eye_x", "Eye_y", "ROI_x", "ROI_y"]].values.astype(int)
         roi_lines = None
-        if self.shape_info["Shape_type"] == "Rectangle":
-            top_left_x, top_left_y = (
-                self.shape_info["topLeftX"],
-                self.shape_info["topLeftY"],
-            )
+        if shape_info["Shape_type"] == "Rectangle":
+            top_left_x, top_left_y = (shape_info["topLeftX"], shape_info["topLeftY"])
             bottom_right_x, bottom_right_y = (
-                self.shape_info["Bottom_right_X"],
-                self.shape_info["Bottom_right_Y"],
+                shape_info["Bottom_right_X"],
+                shape_info["Bottom_right_Y"],
             )
-            top_right_x, top_right_y = top_left_x + self.shape_info["width"], top_left_y
+            top_right_x, top_right_y = top_left_x + shape_info["width"], top_left_y
             bottom_left_x, bottom_left_y = (
-                bottom_right_x - self.shape_info["width"],
+                bottom_right_x - shape_info["width"],
                 bottom_right_y,
             )
             roi_lines = np.array(
                 [
                     [top_left_x, top_left_y, bottom_left_x, bottom_left_y],
                     [bottom_left_x, bottom_left_y, bottom_right_x, bottom_right_y],
                     [bottom_right_x, bottom_right_y, top_right_x, top_right_y],
                     [top_right_x, top_right_y, top_left_x, top_left_y],
                 ]
             )
 
-        elif self.shape_info["Shape_type"] == "Polygon":
-            roi_lines = np.full((self.shape_info["vertices"].shape[0], 4), np.nan)
+        elif shape_info["Shape_type"] == "Polygon":
+            roi_lines = np.full((shape_info["vertices"].shape[0], 4), np.nan)
             roi_lines[-1] = np.hstack(
-                (self.shape_info["vertices"][0], self.shape_info["vertices"][-1])
+                (shape_info["vertices"][0], shape_info["vertices"][-1])
             )
-            for i in range(self.shape_info["vertices"].shape[0] - 1):
+            for i in range(shape_info["vertices"].shape[0] - 1):
                 roi_lines[i] = np.hstack(
-                    (self.shape_info["vertices"][i], self.shape_info["vertices"][i + 1])
+                    (shape_info["vertices"][i], shape_info["vertices"][i + 1])
                 )
 
-        elif self.shape_info["Shape_type"] == "Circle":
-            center = self.shape_info[["centerX", "centerY"]].values.astype(int)
+        elif shape_info["Shape_type"] == "Circle":
+            center = shape_info[["centerX", "centerY"]].values.astype(int)
             roi_lines = np.full((2, 4), np.nan)
             roi_lines[0] = np.array(
                 [
                     center[0],
-                    center[1] - self.shape_info["radius"],
+                    center[1] - shape_info["radius"],
                     center[0],
-                    center[1] + self.shape_info["radius"],
+                    center[1] + shape_info["radius"],
                 ]
             )
             roi_lines[1] = np.array(
                 [
-                    center[0] - self.shape_info["radius"],
+                    center[0] - shape_info["radius"],
                     center[1],
-                    center[0] + self.shape_info["radius"],
+                    center[0] + shape_info["radius"],
                     center[1],
                 ]
             )
 
         return self.ccw(
             roi_lines=roi_lines,
             eye_lines=eye_lines,
-            shape_type=self.shape_info["Shape_type"],
+            shape_type=shape_info["Shape_type"],
         )
 
     def run(self):
-        """
-        Method to calculate directing-towards ROI data
-        """
-
-        self.results_lst = []
-        for file_cnt, file_path in enumerate(self.files_found):
+        self.results = []
+        for file_cnt, file_path in enumerate(self.data_paths):
             _, self.video_name, _ = get_fn_ext(file_path)
-            self.roi_analyzer.files_found = [file_path]
-            self.roi_analyzer.run()
-            video_data_df = self.roi_analyzer.data_df
-            for animal_name in self.roi_analyzer.multi_animal_id_list:
-                self.animal_name = animal_name
-                animal_bp_names = (
-                    self.animal_bp_dict[animal_name]["X_bps"]
-                    + self.animal_bp_dict[animal_name]["Y_bps"]
-                )
-                animal_data_df = video_data_df[animal_bp_names]
-                animal_direct_bps = self.direct_bp_dict[animal_name]
-                self.ear_left_arr = animal_data_df[
-                    [
-                        animal_direct_bps["Ear_left"]["X_bps"],
-                        animal_direct_bps["Ear_left"]["Y_bps"],
-                    ]
-                ].to_numpy()
-                self.ear_right_arr = animal_data_df[
-                    [
-                        animal_direct_bps["Ear_right"]["X_bps"],
-                        animal_direct_bps["Ear_right"]["Y_bps"],
-                    ]
-                ].to_numpy()
-                self.nose_arr = animal_data_df[
-                    [
-                        animal_direct_bps["Nose"]["X_bps"],
-                        animal_direct_bps["Nose"]["Y_bps"],
-                    ]
-                ].to_numpy()
-                for _, row in self.roi_analyzer.video_recs.iterrows():
-                    self.shape_info = row
-                    center_cord = (
-                        (int(row["topLeftX"] + (row["width"] / 2))),
-                        (int(row["topLeftY"] + (row["height"] / 2))),
-                    )
-                    self.center_cord = np.asarray(center_cord)
-                    self.direction_data = self.jitted_line_crosses_to_static_targets(
-                        left_ear_array=self.ear_left_arr,
-                        right_ear_array=self.ear_right_arr,
-                        nose_array=self.nose_arr,
-                        target_array=self.center_cord,
-                    )
-                    self.bp_data = self.__format_direction_data()
-                    eye_roi_intersections = pd.DataFrame(
-                        self.__find_roi_intersections(),
-                        columns=[
-                            "ROI_edge_1_x",
-                            "ROI_edge_1_y",
-                            "ROI_edge_2_x",
-                            "ROI_edge_2_y",
-                        ],
-                    )
-                    self.bp_data = pd.concat(
-                        [self.bp_data, eye_roi_intersections], axis=1
-                    )
-                    self.results_lst.append(self.bp_data)
-                for _, row in self.roi_analyzer.video_circs.iterrows():
-                    self.shape_info = row
-                    self.center_cord = np.asarray((row["centerX"], row["centerY"]))
-                    self.direction_data = self.jitted_line_crosses_to_static_targets(
-                        left_ear_array=self.ear_left_arr,
-                        right_ear_array=self.ear_right_arr,
-                        nose_array=self.nose_arr,
-                        target_array=self.center_cord,
-                    )
-                    self.bp_data = self.__format_direction_data()
-                    eye_roi_intersections = pd.DataFrame(
-                        self.__find_roi_intersections(),
-                        columns=[
-                            "ROI_edge_1_x",
-                            "ROI_edge_1_y",
-                            "ROI_edge_2_x",
-                            "ROI_edge_2_y",
-                        ],
-                    )
-                    self.bp_data = pd.concat(
-                        [self.bp_data, eye_roi_intersections], axis=1
-                    )
-                    self.results_lst.append(self.bp_data)
-                for _, row in self.roi_analyzer.video_polys.iterrows():
-                    self.shape_info = row
-                    self.center_cord = np.asarray((row["Center_X"], row["Center_Y"]))
-                    self.direction_data = self.jitted_line_crosses_to_static_targets(
-                        left_ear_array=self.ear_left_arr,
-                        right_ear_array=self.ear_right_arr,
-                        nose_array=self.nose_arr,
-                        target_array=self.center_cord,
-                    )
-                    self.bp_data = self.__format_direction_data()
-                    eye_roi_intersections = pd.DataFrame(
-                        self.__find_roi_intersections(),
-                        columns=[
-                            "ROI_edge_1_x",
-                            "ROI_edge_1_y",
-                            "ROI_edge_2_x",
-                            "ROI_edge_2_y",
-                        ],
-                    )
-                    self.bp_data = pd.concat(
-                        [self.bp_data, eye_roi_intersections], axis=1
-                    )
-                    self.results_lst.append(self.bp_data)
-        self.results_df = pd.concat(self.results_lst, axis=0)
+            video_timer = SimbaTimer(start=True)
+            print(f"Analyzing ROI directionality in video {self.video_name}...")
+            data_df = read_df(file_path=file_path, file_type=self.file_type)
+            video_roi_dict, shape_names = slice_roi_dict_for_video(
+                data=self.roi_dict, video_name=self.video_name
+            )
+            for animal_name, bps in self.direct_bp_dict.items():
+                ear_left_arr = data_df[
+                    [bps["Ear_left"]["X_bps"], bps["Ear_left"]["Y_bps"]]
+                ].values
+                ear_right_arr = data_df[
+                    [bps["Ear_right"]["X_bps"], bps["Ear_right"]["Y_bps"]]
+                ].values
+                nose_arr = data_df[[bps["Nose"]["X_bps"], bps["Nose"]["Y_bps"]]].values
+                for roi_type, roi_type_data in video_roi_dict.items():
+                    for _, row in roi_type_data.iterrows():
+                        roi_center = np.array([row["Center_X"], row["Center_Y"]])
+                        roi_name = row["Name"]
+                        direction_data = FeatureExtractionMixin.jitted_line_crosses_to_static_targets(
+                            left_ear_array=ear_left_arr,
+                            right_ear_array=ear_right_arr,
+                            nose_array=nose_arr,
+                            target_array=roi_center,
+                        )
+                        bp_data = self.__format_direction_data(
+                            direction_data=direction_data,
+                            nose_arr=nose_arr,
+                            roi_center=roi_center,
+                            animal_name=animal_name,
+                            shape_name=roi_name,
+                        )
+
+                        eye_roi_intersections = pd.DataFrame(
+                            self.__find_roi_intersections(
+                                bp_data=bp_data, shape_info=row
+                            ),
+                            columns=[
+                                "ROI_edge_1_x",
+                                "ROI_edge_1_y",
+                                "ROI_edge_2_x",
+                                "ROI_edge_2_y",
+                            ],
+                        )
+                        self.results.append(
+                            pd.concat([bp_data, eye_roi_intersections], axis=1)
+                        )
+            video_timer.stop_timer()
+            print(
+                f"ROI directionality analyzed in video {self.video_name}... (elapsed time: {video_timer.elapsed_time_str}s)"
+            )
+        self.results_df = pd.concat(self.results, axis=0)
+
+    def save(self, path: Optional[Union[str, os.PathLike]] = None):
+        if not hasattr(self, "results_df"):
+            raise InvalidInputError(msg="Run the ROI direction analyzer before saving")
+        if path is None:
+            path = os.path.join(
+                self.logs_path, f"ROI_directionality_summary_{self.datetime}.csv"
+            )
+        self.results_df.to_csv(path)
+        stdout_success(
+            msg=f"Detailed ROI directionality data saved in {path}",
+            source=self.__class__.__name__,
+        )
 
 
 #
-# test = DirectingROIAnalyzer(config_path='/Users/simon/Desktop/envs/simba_dev/tests/test_data/mouse_open_field/project_folder/project_config.ini')
+# test = DirectingROIAnalyzer(config_path=r'/Users/simon/Desktop/envs/simba/troubleshooting/RAT_NOR/project_folder/project_config.ini')
 # test.run()
-#
+# test.save()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_move_shape.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_move_shape.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_menus.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_menus.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_clf_calculator.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_feature_analyzer.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,343 +1,316 @@
 __author__ = "Simon Nilsson"
 
 import os
+from typing import List, Optional, Union
 
 import numpy as np
 import pandas as pd
-from shapely import geometry
-from shapely.geometry import Point, Polygon
 
 from simba.mixins.config_reader import ConfigReader
-from simba.utils.checks import (check_if_filepath_list_is_empty,
-                                check_that_column_exist)
-from simba.utils.data import detect_bouts
-from simba.utils.errors import NoChoosenClassifierError, NoROIDataError
-from simba.utils.printing import stdout_success
-from simba.utils.read_write import get_fn_ext, read_config_entry, read_df
-from simba.utils.warnings import NoDataFoundWarning, ROIWarning
+from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
+from simba.roi_tools.ROI_directing_analyzer import DirectingROIAnalyzer
+from simba.utils.checks import (
+    check_all_file_names_are_represented_in_video_log,
+    check_file_exist_and_readable, check_that_column_exist, check_valid_lst)
+from simba.utils.data import slice_roi_dict_for_video
+from simba.utils.enums import Keys, TagNames
+from simba.utils.errors import (BodypartColumnNotFoundError, CountError,
+                                NoFilesFoundError, ROICoordinatesNotFoundError)
+from simba.utils.printing import SimbaTimer, log_event, stdout_success
+from simba.utils.read_write import (find_files_of_filetypes_in_directory,
+                                    get_fn_ext, read_data_paths, read_df,
+                                    write_df)
 
 
-class ROIClfCalculator(ConfigReader):
+class ROIFeatureCreator(ConfigReader, FeatureExtractionMixin):
     """
-    Compute aggregate statistics of classification results within user-defined ROIs.
-    Results are stored in `project_folder/logs` directory of the SimBA project.
+    Compute features based on the relationships between the location of the animals and the location of
+    user-defined ROIs. This includes the distance to the ROIs, if the animals are inside the ROIs, and if the
+    animals are directing towards the ROIs (if viable)
 
-    :param str config_path: path to SimBA project config file in Configparser format
+    .. note::
+        `ROI tutorials <https://github.com/sgoldenlab/simba/blob/master/docs/ROI_tutorial_new.md>`__.
 
-    .. note:
-       'GitHub tutorial <https://github.com/sgoldenlab/simba/blob/master/docs/Scenario2.md#part-4--analyze-machine-results`__.
 
-    Examples
-    -----
-    >>> clf_ROI_analyzer = ROIClfCalculator(config_ini="MyConfigPath")
-    >>> clf_ROI_analyzer.run(behavior_list=['Attack', 'Sniffing'], ROI_dict_lists={'Rectangle': ['rec'], 'Circle': ['Stimulus 1', 'Stimulus 2', 'Stimulus 3']}, body_part_list=['Nose_1'], measurements=['Total time by ROI (s)', 'Started bouts by ROI (count)', 'Ended bouts by ROI (count)'])
-    """
-
-    def __init__(self, config_ini: str):
-        ConfigReader.__init__(self, config_path=config_ini)
-        self.read_roi_data()
+    :param Union[str, os.PathLike] config_path: Path to SimBA project config file in Configparser format.
+    :param List[str] body_parts: List of the body-parts to use as proxy for animal location(s).
+    :param Optional[Union[str, os.PathLike]] data_path: Path to folder or file holding the data used to calculate ROI aggregate statistics. If None, then defaults to the `project_folder/csv/outlier_corrected_movement_location` directory of the SimBA project. Default: None.
+    :param Optional[bool] append_data: If True, adds the features to the data in the `project_folder/csv/features_extracted` directory. Else, held in memory.
 
-    def __inside_rectangle(
-        self, bp_x, bp_y, top_left_x, top_left_y, bottom_right_x, bottom_right_y
-    ):
-        """
-        Private helper to calculate if body-part is inside a rectangle.
-        """
-        if ((top_left_x) <= bp_x <= (bottom_right_x)) and (
-            (top_left_y) <= bp_y <= (bottom_right_y)
-        ):
-            return 1
-        else:
-            return 0
 
-    def __inside_circle(self, bp_x, bp_y, center_x, center_y, radius):
-        """
-        Private helper to calculate if body-part is inside a circle.
-        """
-        px_dist = int(np.sqrt((bp_x - center_x) ** 2 + (bp_y - center_y) ** 2))
-        if px_dist <= radius:
-            return 1
-        else:
-            return 0
-
-    def __inside_polygon(self, bp_x, bp_y, polygon):
-        """
-        Private helper to calculate if body-part is inside a polygon.
-        """
-        if polygon.contains(Point(int(bp_x), int(bp_y))):
-            return 1
-        else:
-            return 0
+    :example:
+    >>> roi_featurizer = ROIFeatureCreator(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+    >>>                                    body_parts=['Nose_1', 'Nose_2'])
+    >>> roi_featurizer.run()
+    >>> roi_featurizer.save()
+    """
 
-    def __compute_agg_statistics(self, data: pd.DataFrame):
-        """
+    def __init__(
+        self,
+        config_path: Union[str, os.PathLike],
+        body_parts: List[str],
+        data_path: Optional[Union[str, os.PathLike]] = None,
+        append_data: Optional[bool] = False,
+    ):
 
-        Parameters
-        ----------
-        data: pd.DataFrame
-            Dataframe with boolean columns representing behaviors (behavior present: 1, behavior absent: 0)
-            and ROI data (inside ROI: 1, outside ROI: 0).
-
-        """
-        self.results_dict[self.video_name] = {}
-        for clf in self.behavior_list:
-            self.results_dict[self.video_name][clf] = {}
-            for roi in self.found_rois:
-                self.results_dict[self.video_name][clf][roi] = {}
-                if "Total time by ROI (s)" in self.measurements:
-                    frame_cnt = len(data.loc[(data[clf] == 1) & (data[roi] == 1)])
-                    if frame_cnt > 0:
-                        self.results_dict[self.video_name][clf][roi][
-                            "Total time by ROI (s)"
-                        ] = (frame_cnt / self.fps)
-                    else:
-                        self.results_dict[self.video_name][clf][roi][
-                            "Total time (s)"
-                        ] = 0
-                if "Started bouts by ROI (count)" in self.measurements:
-                    start_frames = list(
-                        detect_bouts(data_df=data, target_lst=[clf], fps=int(self.fps))[
-                            "Start_frame"
-                        ]
-                    )
-                    self.results_dict[self.video_name][clf][roi][
-                        "Started bouts by ROI (count)"
-                    ] = len(data[(data.index.isin(start_frames)) & (data[roi] == 1)])
-                if "Ended bouts by ROI (count)" in self.measurements:
-                    start_frames = list(
-                        detect_bouts(data_df=data, target_lst=[clf], fps=int(self.fps))[
-                            "End_frame"
-                        ]
-                    )
-                    self.results_dict[self.video_name][clf][roi][
-                        "Ended bouts by ROI (count)"
-                    ] = len(data[(data.index.isin(start_frames)) & (data[roi] == 1)])
-
-    def __print_missing_roi_warning(self, roi_type: str, roi_name: str):
-        """
-        Private helper to print warnings when ROI shapes have been defined in some videos but missing in others.
-        """
-        names = "None"
-        ROIWarning(
-            msg=f'ROI named "{roi_name}" of shape type "{roi_type}" not found for video {self.video_name}. Skipping shape...'
+        check_valid_lst(
+            data=body_parts,
+            source=f"{self.__class__.__name__} body-parts",
+            valid_dtypes=(str,),
+            min_len=1,
         )
-        if roi_type.lower() == "rectangle":
-            names = list(
-                self.rectangles_df["Name"][
-                    self.rectangles_df["Video"] == self.video_name
-                ]
+        if len(set(body_parts)) != len(body_parts):
+            raise CountError(
+                msg=f"All body-part entries have to be unique. Got {body_parts}",
+                source=self.__class__.__name__,
             )
-        elif roi_type.lower() == "circle":
-            names = list(
-                self.circles_df["Name"][self.circles_df["Video"] == self.video_name]
+        log_event(
+            logger_name=str(__class__.__name__),
+            log_type=TagNames.CLASS_INIT.value,
+            msg=self.create_log_msg_from_init_args(locals=locals()),
+        )
+        ConfigReader.__init__(self, config_path=config_path)
+        FeatureExtractionMixin.__init__(self, config_path=config_path)
+        self.read_roi_data()
+        if not os.path.isfile(self.roi_coordinates_path):
+            raise ROICoordinatesNotFoundError(
+                expected_file_path=self.roi_coordinates_path
             )
-        elif roi_type.lower() == "polygon":
-            names = list(
-                self.polygon_df["Name"][self.polygon_df["Video"] == self.video_name]
+        for bp in body_parts:
+            if bp not in self.body_parts_lst:
+                raise BodypartColumnNotFoundError(
+                    msg=f"The body-part {bp} is not a valid body-part in the SimBA project. Options: {self.body_parts_lst}",
+                    source=self.__class__.__name__,
+                )
+        self.bp_lk = {}
+        for cnt, bp in enumerate(body_parts):
+            animal = self.find_animal_name_from_body_part_name(
+                bp_name=bp, bp_dict=self.animal_bp_dict
             )
-        ROIWarning(
-            msg=f"NOTE: Video {self.video_name} has the following {roi_type} shape names: {names}"
+            self.bp_lk[cnt] = [
+                animal,
+                bp,
+                [f'{bp}_{"x"}', f'{bp}_{"y"}', f'{bp}_{"p"}'],
+            ]
+        self.roi_directing_viable = self.check_directionality_viable()[0]
+        log_event(
+            logger_name=str(__class__.__name__),
+            log_type=TagNames.CLASS_INIT.value,
+            msg=self.create_log_msg_from_init_args(locals=locals()),
         )
-
-    def run(
-        self,
-        ROI_dict_lists: dict,
-        measurements: list,
-        behavior_list: list,
-        body_part_list: list,
-    ):
-        """
-        Parameters
-        ----------
-        ROI_dict_lists: dict
-            A dictionary with the shape type as keys (i.e., Rectangle, Circle, Polygon) and lists of shape names
-            as values.
-        measurements: list
-            Measurements to calculate aggregate statistics for. E.g., ['Total time by ROI (s)', 'Started bouts', 'Ended bouts']
-        behavior_list: list
-            Classifier names to calculate ROI statistics. E.g., ['Attack', 'Sniffing']
-        body_part_list: list
-            Body-part names to use to infer animal location. Eg., ['Nose_1'].
-        """
-
-        self.ROI_dict_lists, self.behavior_list, self.measurements = (
-            ROI_dict_lists,
-            self.clf_names,
-            measurements,
+        self.data_paths = read_data_paths(
+            path=data_path,
+            default=self.outlier_corrected_paths,
+            default_name=self.outlier_corrected_dir,
+            file_type=self.file_type,
+        )
+        if self.roi_directing_viable:
+            print("Directionality calculations are VIABLE.")
+            self.directing_analyzer = DirectingROIAnalyzer(
+                config_path=config_path, data_path=self.data_paths
+            )
+            self.directing_analyzer.run()
+            self.dr = self.directing_analyzer.results_df
+        else:
+            self.directing_analyzer = None
+            self.dr = None
+        if len(self.outlier_corrected_paths) == 0:
+            raise NoFilesFoundError(
+                msg=f"No data found in the {self.outlier_corrected_dir} directory",
+                source=self.__class__.__name__,
+            )
+        if len(self.feature_file_paths) == 0:
+            raise NoFilesFoundError(
+                msg=f"No data found in the {self.features_dir} directory",
+                source=self.__class__.__name__,
+            )
+        self.append_data = append_data
+        print(
+            f"Processing {len(self.outlier_corrected_paths)} video(s) for ROI features..."
         )
-        self.file_type = read_config_entry(
-            config=self.config,
-            section="General settings",
-            option="workflow_file_type",
-            data_type="str",
+
+    def run(self):
+        check_all_file_names_are_represented_in_video_log(
+            video_info_df=self.video_info_df, data_paths=self.outlier_corrected_paths
         )
-        check_if_filepath_list_is_empty(
-            filepaths=self.machine_results_paths,
-            error_msg="SIMBA ERROR: No machine learning results found in the project_folder/csv/machine_results directory. Create machine classifications before analyzing classifications by ROI",
+        self.summary = pd.DataFrame(
+            columns=["VIDEO", "ANIMAL", "SHAPE NAME", "MEASUREMENT", "VALUE"]
         )
-        if len(behavior_list) == 0:
-            raise NoChoosenClassifierError()
-        print(f"Analyzing {str(len(self.machine_results_paths))} files...")
-        body_part_col_names = []
-        body_part_col_names_x, body_part_col_names_y = [], []
-        for body_part in body_part_list:
-            body_part_col_names.extend(
-                (body_part + "_x", body_part + "_y", body_part + "_p")
-            )
-            body_part_col_names_x.append(body_part + "_x")
-            body_part_col_names_y.append(body_part + "_y")
-        all_columns = body_part_col_names + self.behavior_list
-        self.results_dict = {}
-
-        self.frame_counter_dict = {}
-        for file_cnt, file_path in enumerate(self.machine_results_paths):
-            _, self.video_name, ext = get_fn_ext(file_path)
-            print("Analyzing {}....".format(self.video_name))
-            data_df = read_df(file_path, self.file_type)
-            for column in all_columns:
-                check_that_column_exist(
-                    file_name=self.video_name, df=data_df, column_name=column
-                )
-            data_df = data_df[all_columns]
-            self.results = data_df[self.behavior_list]
-            shapes_in_video = (
-                len(
-                    self.rectangles_df.loc[
-                        (self.rectangles_df["Video"] == self.video_name)
-                    ]
-                )
-                + len(
-                    self.circles_df.loc[(self.circles_df["Video"] == self.video_name)]
-                )
-                + len(
-                    self.polygon_df.loc[(self.polygon_df["Video"] == self.video_name)]
+        if self.append_data:
+            _o_paths = set([get_fn_ext(x)[1] for x in self.outlier_corrected_paths])
+            _f_paths = set([get_fn_ext(x)[1] for x in self.feature_file_paths])
+            o_paths = _o_paths.difference(_f_paths)
+            f_paths = _f_paths.difference(_o_paths)
+            if len(o_paths) != 0 or len(f_paths) != 0:
+                raise NoFilesFoundError(
+                    msg=f"Before appending ROI features, make sure each video is represented in both the {self.outlier_corrected_dir} and {self.features_dir} directory, you have data files that are only represented in one folder {o_paths} {f_paths}",
+                    source=self.__class__.__name__,
                 )
+        for file_cnt, file_path in enumerate(self.data_paths):
+            video_timer = SimbaTimer(start=True)
+            _, self.video_name, _ = get_fn_ext(file_path)
+            features_file_path = os.path.join(
+                self.features_dir, f"{self.video_name}.{self.file_type}"
             )
-            if shapes_in_video == 0:
-                NoDataFoundWarning(
-                    msg="Skipping {self.video_name}: Video {self.video_name} has 0 user-defined ROI shapes."
+            self.out_df = read_df(
+                file_path=features_file_path, file_type=self.file_type
+            )
+            _, self.pixels_per_mm, self.fps = self.read_video_info(
+                video_name=self.video_name
+            )
+            data_df = read_df(file_path=file_path, file_type=self.file_type)
+            self.video_roi_dict, self.shape_names = slice_roi_dict_for_video(
+                data=self.roi_dict, video_name=self.video_name
+            )
+            for animal_cnt, animal_data in self.bp_lk.items():
+                animal_name, body_part_name, bp_cols = animal_data
+                check_that_column_exist(
+                    df=data_df, column_name=bp_cols, file_name=file_path
                 )
-                continue
-            _, _, self.fps = self.read_video_info(video_name=self.video_name)
-            self.found_rois = []
-            for roi_type, roi_data in self.ROI_dict_lists.items():
-                shape_info = pd.DataFrame()
-                for roi_name in roi_data:
-                    if roi_type.lower() == "rectangle":
-                        shape_info = self.rectangles_df.loc[
-                            (self.rectangles_df["Video"] == self.video_name)
-                            & (self.rectangles_df["Shape_type"] == roi_type)
-                            & (self.rectangles_df["Name"] == roi_name)
+                animal_df = data_df[bp_cols]
+                for _, row in self.video_roi_dict[Keys.ROI_RECTANGLES.value].iterrows():
+                    roi_border = np.array(
+                        [
+                            [row["topLeftX"], row["topLeftY"]],
+                            [row["Bottom_right_X"], row["Bottom_right_Y"]],
                         ]
-                    elif roi_type.lower() == "circle":
-                        shape_info = self.circles_df.loc[
-                            (self.circles_df["Video"] == self.video_name)
-                            & (self.circles_df["Shape_type"] == roi_type)
-                            & (self.circles_df["Name"] == roi_name)
-                        ]
-                    elif roi_type.lower() == "polygon":
-                        shape_info = self.polygon_df.loc[
-                            (self.polygon_df["Video"] == self.video_name)
-                            & (self.polygon_df["Shape_type"] == roi_type)
-                            & (self.polygon_df["Name"] == roi_name)
-                        ]
-                    if len(shape_info) == 0:
-                        self.__print_missing_roi_warning(
-                            roi_type=roi_type, roi_name=roi_name
-                        )
-                        continue
-                    if roi_type.lower() == "rectangle":
-                        data_df["top_left_x"], data_df["top_left_y"] = (
-                            shape_info["topLeftX"].values[0],
-                            shape_info["topLeftY"].values[0],
+                    )
+                    roi_name = row["Name"]
+                    roi_center = np.array([row["Center_X"], row["Center_Y"]])
+                    c = f"{roi_name} {animal_name} {body_part_name} distance"
+                    self.out_df[c] = (
+                        FeatureExtractionMixin.framewise_euclidean_distance_roi(
+                            location_1=animal_df.values[:, 0:2],
+                            location_2=roi_center,
+                            px_per_mm=self.pixels_per_mm,
                         )
-                        data_df["bottom_right_x"], data_df["bottom_right_y"] = (
-                            shape_info["Bottom_right_X"].values[0],
-                            shape_info["Bottom_right_Y"].values[0],
+                    )
+                    self.summary.loc[len(self.summary)] = [
+                        self.video_name,
+                        animal_name,
+                        roi_name,
+                        "Average distance (mm)",
+                        self.out_df[c].mean().round(4),
+                    ]
+                    c = f"{roi_name} {animal_name} {body_part_name} in zone"
+                    self.out_df[c] = (
+                        FeatureExtractionMixin.framewise_inside_rectangle_roi(
+                            bp_location=animal_df.values[:, 0:2], roi_coords=roi_border
                         )
-                        self.results[roi_name] = data_df.apply(
-                            lambda x: self.__inside_rectangle(
-                                bp_x=x[body_part_col_names_x[0]],
-                                bp_y=x[body_part_col_names_y[0]],
-                                top_left_x=x["top_left_x"],
-                                top_left_y=x["top_left_y"],
-                                bottom_right_x=x["bottom_right_x"],
-                                bottom_right_y=x["bottom_right_y"],
-                            ),
-                            axis=1,
+                    )
+                for _, row in self.video_roi_dict[Keys.ROI_CIRCLES.value].iterrows():
+                    roi_center = np.array([row["centerX"], row["centerY"]])
+                    roi_name, radius = row["Name"], row["radius"]
+                    c = f"{roi_name} {animal_name} {body_part_name} distance"
+                    self.out_df[c] = (
+                        FeatureExtractionMixin.framewise_euclidean_distance_roi(
+                            location_1=animal_df.values[:, 0:2],
+                            location_2=roi_center,
+                            px_per_mm=self.pixels_per_mm,
                         )
-                        self.found_rois.append(roi_name)
-                    elif roi_type.lower() == "circle":
-                        data_df["center_x"], data_df["center_y"], data_df["radius"] = (
-                            shape_info["centerX"].values[0],
-                            shape_info["centerY"].values[0],
-                            shape_info["radius"].values[0],
+                    )
+                    self.summary.loc[len(self.summary)] = [
+                        self.video_name,
+                        animal_name,
+                        roi_name,
+                        "Average distance (mm)",
+                        self.out_df[c].mean().round(4),
+                    ]
+                    in_zone = f"{roi_name} {animal_name} {body_part_name} in zone"
+                    self.out_df[in_zone] = 0
+                    self.out_df.loc[self.out_df[c] <= row["radius"], in_zone] = 1
+                for _, row in self.roi_dict[Keys.ROI_POLYGONS.value].iterrows():
+                    roi_coords = np.array(
+                        list(zip(row["vertices"][:, 0], row["vertices"][:, 1]))
+                    )
+                    roi_center = np.array([row["Center_X"], row["Center_Y"]])
+                    roi_name = row["Name"]
+                    c = f"{roi_name} {animal_name} {body_part_name} distance"
+                    self.out_df[c] = (
+                        FeatureExtractionMixin.framewise_euclidean_distance_roi(
+                            location_1=animal_df.values[:, 0:2],
+                            location_2=roi_center,
+                            px_per_mm=self.pixels_per_mm,
                         )
-                        self.results[roi_name] = data_df.apply(
-                            lambda x: self.__inside_circle(
-                                bp_x=x[body_part_col_names_x[0]],
-                                bp_y=x[body_part_col_names_y[0]],
-                                center_x=x["center_x"],
-                                center_y=x["center_y"],
-                                radius=x["radius"],
-                            ),
-                            axis=1,
+                    )
+                    self.summary.loc[len(self.summary)] = [
+                        self.video_name,
+                        animal_name,
+                        roi_name,
+                        "Average distance (mm)",
+                        self.out_df[c].mean().round(4),
+                    ]
+                    c = f"{roi_name} {animal_name} {body_part_name} in zone"
+                    self.out_df[c] = (
+                        FeatureExtractionMixin.framewise_inside_polygon_roi(
+                            bp_location=animal_df.values[:, 0:2], roi_coords=roi_coords
                         )
-                        self.found_rois.append(roi_name)
-                    elif roi_type.lower() == "polygon":
-                        polygon_vertices = []
-                        for i in shape_info["vertices"].values[0]:
-                            polygon_vertices.append(geometry.Point(i))
-                        polygon = Polygon([[p.x, p.y] for p in polygon_vertices])
-                        self.results[roi_name] = data_df.apply(
-                            lambda x: self.__inside_polygon(
-                                bp_x=x[body_part_col_names_x[0]],
-                                bp_y=x[body_part_col_names_y[0]],
-                                polygon=polygon,
-                            ),
-                            axis=1,
+                    )
+                if self.roi_directing_viable:
+                    animal_dr = self.dr.loc[
+                        (self.dr["Video"] == self.video_name)
+                        & (self.dr["Animal"] == animal_name)
+                    ]
+                    for shape_name in self.shape_names:
+                        c = f"{shape_name} {animal_name} facing"
+                        animal_shape_idx = list(
+                            animal_dr.loc[
+                                (animal_dr["ROI"] == shape_name)
+                                & (animal_dr["Directing_BOOL"] == 1)
+                            ]["Frame"]
                         )
-                        self.found_rois.append(roi_name)
-                self.__compute_agg_statistics(data=self.results)
-        self.__organize_output_data()
-
-    def __organize_output_data(self):
-        """
-        Helper to organize the results[dict] into a human-readable CSV file.
-        """
-        if len(self.results_dict.keys()) == 0:
-            raise NoROIDataError(
-                msg="ZERO ROIs found the videos represented in the project_folder/csv/machine_results directory"
-            )
-        out_df = pd.DataFrame(
-            columns=["VIDEO", "CLASSIFIER", "ROI", "MEASUREMENT", "VALUE"]
-        )
-        for video_name, video_data in self.results_dict.items():
-            for clf, clf_data in video_data.items():
-                for roi_name, roi_data in clf_data.items():
-                    for measurement_name, mesurement_value in roi_data.items():
-                        out_df.loc[len(out_df)] = [
-                            video_name,
-                            clf,
-                            roi_name,
-                            measurement_name,
-                            mesurement_value,
+                        self.out_df[c] = 0
+                        self.out_df.loc[animal_shape_idx, c] = 1
+                        self.summary.loc[len(self.summary)] = [
+                            self.video_name,
+                            animal_name,
+                            shape_name,
+                            "Total direction time (s)",
+                            round((self.out_df[c].sum() / self.fps), 4),
                         ]
-        out_path = os.path.join(
-            self.logs_path, f"Classification_time_by_ROI_{self.datetime}.csv"
+            video_timer.stop_timer()
+            if self.append_data:
+                write_df(
+                    df=self.out_df,
+                    file_type=self.file_type,
+                    save_path=features_file_path,
+                )
+                print(
+                    f"New file with ROI features created at  {features_file_path} saved (File {file_cnt+1}/{len(self.outlier_corrected_paths)}), elapsed time: {video_timer.elapsed_time_str}s"
+                )
+
+        self.timer.stop_timer()
+        stdout_success(
+            msg=f"ROI features analysed for {len(self.data_paths)} videos",
+            elapsed_time=self.timer.elapsed_time_str,
+        )
+
+    def save(self):
+        save_path = os.path.join(
+            self.logs_path, f"ROI_features_summary_{self.datetime}.csv"
         )
-        out_df.to_csv(out_path)
+        self.summary.to_csv(save_path)
+        print(f"ROI feature summary data saved at {save_path}")
         self.timer.stop_timer()
         stdout_success(
-            msg=f"Classification data by ROIs saved in {out_path}.",
+            msg=f"{len(self.outlier_corrected_paths)} new files with ROI features saved in {self.features_dir}",
             elapsed_time=self.timer.elapsed_time_str,
         )
 
 
 #
-# clf_ROI_analyzer = clf_within_ROI(config_ini="/Users/simon/Desktop/troubleshooting/train_model_project/project_folder/project_config.ini")
-# clf_ROI_analyzer.run(behavior_list=['Attack', 'Sniffing'], ROI_dict_lists={'Rectangle': ['rec'], 'Circle': ['Stimulus 1', 'Stimulus 2', 'Stimulus 3']}, body_part_list=['Nose_1'], measurements=['Total time by ROI (s)', 'Started bouts by ROI (count)', 'Ended bouts by ROI (count)'])
-#
+# roi_featurizer = ROIFeatureCreator(config_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+#                                    body_parts=['Nose_1', 'Nose_2'],
+#                                    data_path='/Users/simon/Desktop/envs/simba/troubleshooting/two_black_animals_14bp/project_folder/csv/outlier_corrected_movement_location/Together_1.csv')
+# roi_featurizer.run()
+
+
+# roi_featurizer = ROIFeatureCreator(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
+# roi_featurizer.roi_directing_viable
+# roi_featurizer.run()
+# roi_featurizer.save()
+
 
-# test = ROIClfCalculator(config_ini="/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini")
-# test.run(behavior_list=['Attack', 'Sniffing'], ROI_dict_lists={'Rectangle': ['DAMN'], 'Circle': [], 'Polygon': ['YOU_SUCK_SIMON']}, body_part_list=['Nose_1'], measurements=['Total time by ROI (s)', 'Started bouts by ROI (count)', 'Ended bouts by ROI (count)'])
+# roi_featurizer = ROIFeatureCreator(config_path='/Users/simon/Desktop/envs/troubleshooting/two_animals_16bp_032023/project_folder/project_config.ini')
+# roi_featurizer.run()
+# roi_featurizer.save()
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/roi_tools/ROI_image.py` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/ROI_image.py`

 * *Files 1% similar despite different names*

```diff
@@ -4,22 +4,20 @@
 import threading
 from copy import deepcopy
 
 import cv2
 import numpy as np
 import pandas as pd
 
-# from simba.roi_tools import ROI_define
 from simba.roi_tools.ROI_move_shape import move_edge, move_edge_align
 from simba.roi_tools.ROI_zoom import zoom_in
 from simba.utils.data import add_missing_ROI_cols
 from simba.utils.enums import ConfigKey, Keys, Paths
 from simba.utils.errors import InvalidInputError
-# from simba.utils.keyboard_listener import KeyboardListener
-from simba.utils.read_write import get_fn_ext, read_config_file  # kbd_listener
+from simba.utils.read_write import get_fn_ext, read_config_file
 
 
 class ROI_image_class:
 
     def __init__(
         self,
         config_path: str,
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/sleap_csv_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/sleap_csv_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/misc/apt_trk_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/misc/apt_trk_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/read_DANNCE_mat.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/read_DANNCE_mat.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/sleap_h5_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/sleap_h5_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/madlc_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/madlc_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/sleap_slp_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/sleap_slp_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/import_mars.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/import_mars.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/dlc_importer_csv.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/dlc_importer_csv.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_importers/trk_importer.py` & `Simba-UW-tf-dev-1.90.5/simba/pose_importers/trk_importer.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/bp_names/bp_names.csv` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/bp_names/bp_names.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/8.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/8.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/9.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/9.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/12.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/12.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/13.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/13.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/11.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/11.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/10.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/10.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/4.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/4.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/5.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/5.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/7.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/7.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/6.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/6.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/2.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/3.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/3.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/pose_configurations/schematics/1.png` & `Simba-UW-tf-dev-1.90.5/simba/pose_configurations/schematics/1.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/video_processing.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/video_processing.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/roi_tools/.DS_Store`

 * *Files 24% similar despite different names*

```diff
@@ -13,23 +13,23 @@
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0000 0000 0000 0000 0000 0004 0000 000b  ................
 00000110: 005f 005f 0070 0079 0063 0061 0063 0068  ._._.p.y.c.a.c.h
 00000120: 0065 005f 005f 6c67 3153 636f 6d70 0000  .e._._lg1Scomp..
-00000130: 0000 0001 ecf2 0000 000b 005f 005f 0070  ..........._._.p
+00000130: 0000 0003 8659 0000 000b 005f 005f 0070  .....Y....._._.p
 00000140: 0079 0063 0061 0063 0068 0065 005f 005f  .y.c.a.c.h.e._._
-00000150: 6d6f 4444 626c 6f62 0000 0008 eea0 f79b  moDDblob........
-00000160: 00d9 c541 0000 000b 005f 005f 0070 0079  ...A....._._.p.y
+00000150: 6d6f 4444 626c 6f62 0000 0008 a7f6 efc9  moDDblob........
+00000160: 4fed c541 0000 000b 005f 005f 0070 0079  O..A....._._.p.y
 00000170: 0063 0061 0063 0068 0065 005f 005f 6d6f  .c.a.c.h.e._._mo
-00000180: 6444 626c 6f62 0000 0008 210d 800b fdd6  dDblob....!.....
+00000180: 6444 626c 6f62 0000 0008 a7f6 efc9 4fed  dDblob........O.
 00000190: c541 0000 000b 005f 005f 0070 0079 0063  .A....._._.p.y.c
 000001a0: 0061 0063 0068 0065 005f 005f 7068 3153  .a.c.h.e._._ph1S
-000001b0: 636f 6d70 0000 0000 0002 6000 0000 0000  comp......`.....
+000001b0: 636f 6d70 0000 0000 0004 a000 0000 0000  comp............
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/roi_selector_circle.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/roi_selector_circle.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/px_to_mm.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/px_to_mm.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/batch_process_menus.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/batch_process_menus.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/multi_cropper.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/multi_cropper.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/extract_frames.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/extract_frames.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/roi_selector.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/roi_selector.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/calculate_px_dist.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/calculate_px_dist.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/roi_selector_polygon.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/roi_selector_polygon.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/extract_seqframes.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/extract_seqframes.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/video_processors/batch_process_create_ffmpeg_commands.py` & `Simba-UW-tf-dev-1.90.5/simba/video_processors/batch_process_create_ffmpeg_commands.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/outlier_tools/outlier_corrector_movement.py` & `Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_movement.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/outlier_tools/outlier_corrector_location_advanced.py` & `Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_movement_advanced.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,94 +1,95 @@
 __author__ = "Simon Nilsson"
 
-import glob
 import os
-from copy import deepcopy
 from typing import Union
 
 import numpy as np
 import pandas as pd
-from numba import jit, prange
+
+try:
+    from typing import Literal
+except:
+    from typing_extensions import Literal
+
+from copy import deepcopy
 
 from simba.mixins.config_reader import ConfigReader
 from simba.mixins.feature_extraction_mixin import FeatureExtractionMixin
 from simba.utils.enums import TagNames
 from simba.utils.errors import InvalidInputError, NoFilesFoundError
 from simba.utils.printing import SimbaTimer, log_event, stdout_success
 from simba.utils.read_write import (find_files_of_filetypes_in_directory,
                                     get_fn_ext, read_df, write_df)
 
 
-class OutlierCorrecterLocationAdvanced(ConfigReader, FeatureExtractionMixin):
+class OutlierCorrecterMovementAdvanced(ConfigReader, FeatureExtractionMixin):
     """
-    Performs location outlier correction that allows different heuristic outlier criteria for different animals or body-parts.
-    For example, correct some outlier body-parts with a location heuristic criteria of 4x above the mean movement,
-    and other body-parts with a heuristic critera of 2x above the mean movement.
+    Performs outlier correction that allows different heuristic outlier criteria for different animals or body-parts.
+    For example, correct some outlier body-parts with a movement heuristic criteria of 2x above the mean movement,
+    and other body-parts with a heuristic critera of 1.5x above the mean movement.
 
     .. note::
        See `notebook <https://simba-uw-tf-dev.readthedocs.io/en/latest/nb/advanced_outlier_correction.html>`__. for example use-case.
 
-    .. image:: _static/img/location_outlier.png
+    .. image:: _static/img/movement_outlier.png
        :width: 400
        :align: center
 
     :parameter str config_path: path to SimBA project config file in Configparser format.
     :parameter str input_dir: Directory containing input files. E.g., `project_folder/csv/input_csv` directory.
     :parameter Literal['animal', 'body-part'] type: If the rules are defined on animal or body-part level. E.g., If one heuristic rule per animal then `animal`. If one heurstic rule prr body-part then `body-parts`
     :parameter Literal['mean', 'median'] agg_method: If to use the mean or median to compute criterion.
     :parameter dict criterion_body_parts: The body-parts used to calculate the size of the animals.
     :parameter dict settings: The heuristic multiplier rules to use for each body part or animal.
 
     :example:
     >>> settings = {'Simon': 1.1, 'JJ': 1.2}
     >>> criterion_body_parts = {'Simon': ['Nose_1', 'Tail_base_1'], 'JJ': ['Nose_2', 'Tail_base_2']}
-    >>> outlier_corrector = OutlierCorrecterLocationAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='animal', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
+    >>> outlier_corrector = OutlierCorrecterMovementAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='animal', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
     >>> outlier_corrector.run()
     >>> settings = {'Simon': {'Ear_left_1': 1.1, 'Ear_right_1': 5.1, 'Nose_1': 2.1, 'Center_1': 1.5, 'Lat_left_1': 3.1, 'Lat_right_1': 1.9, 'Tail_base_1': 2.3, 'Tail_end_1': 1.4}, 'JJ': {'Ear_left_2': 1.2, 'Ear_right_2': 1.2, 'Nose_2': 2, 'Center_2': 4.1, 'Lat_left_2': 9, 'Lat_right_2': 1.2, 'Tail_base_2': 1.6, 'Tail_end_2': 2.2}}
-    >>> outlier_corrector = OutlierCorrecterLocationAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='body-part', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
+    >>> outlier_corrector = OutlierCorrecterMovementAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini', input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv', type='body-part', agg_method='mean', criterion_body_parts=criterion_body_parts, settings=settings)
     """
 
     def __init__(
         self,
         config_path: Union[str, os.PathLike],
         input_dir: Union[str, os.PathLike],
-        type: str,
-        agg_method: str,
         criterion_body_parts: dict,
+        type: Literal["animal", "body-part"],
+        agg_method: Literal["mean", "median"],
         settings: dict,
     ):
         ConfigReader.__init__(self, config_path=config_path)
         FeatureExtractionMixin.__init__(self)
         log_event(
             logger_name=str(self.__class__.__name__),
             log_type=TagNames.CLASS_INIT.value,
             msg=self.create_log_msg_from_init_args(locals=locals()),
         )
+        if type not in ["animal", "body-parts"]:
+            raise InvalidInputError(
+                msg=f"Type {type} not supported. Valid options: {['animal', 'body-parts']}"
+            )
+        if agg_method not in ["mean", "median"]:
+            raise InvalidInputError(
+                msg=f"Aggregation method {agg_method} not supported. Valid options: {['mean', 'median']}"
+            )
         self.data_files = find_files_of_filetypes_in_directory(
             directory=input_dir, extensions=["." + self.file_type]
         )
         if len(self.data_files) == 0:
             raise NoFilesFoundError(
                 msg=f"No data of filetype {input_dir} for in directory {self.file_type}",
                 source=self.__class__.__name__,
             )
-        if type not in ["animal", "body-parts"]:
-            raise InvalidInputError(
-                msg=f"Type {type} not supported. Valid options: {['animal', 'body-parts']}",
-                source=self.__class__.__name__,
-            )
-        if agg_method not in ["mean", "median"]:
-            raise InvalidInputError(
-                msg=f"Aggregation method {agg_method} not supported. Valid options: {['mean', 'median']}",
-                source=self.__class__.__name__,
-            )
-        self.settings, self.type, self.agg_method, self.criterion_body_parts = (
-            settings,
-            type,
-            agg_method,
+        self.settings, self.type, self.agg_method = settings, type, agg_method
+        self.save_path, self.criterion_body_parts = (
+            self.outlier_corrected_movement_dir,
             criterion_body_parts,
         )
 
     def fix_settings_for_animal_input(self):
         new_settings = {}
         for animal_name, animal_bps in self.animal_bp_dict.items():
             if animal_name in self.settings.keys():
@@ -96,59 +97,47 @@
                     new_settings[animal_name] = {}
                 for body_part in animal_bps["X_bps"]:
                     new_settings[animal_name][body_part[:-2]] = self.settings[
                         animal_name
                     ]
         self.settings = new_settings
 
-    @staticmethod
-    @jit(nopython=True)
-    def three_dim_cdist(data: np.ndarray) -> np.ndarray:
-        results = np.full((data.shape[0], data.shape[1], data.shape[1]), np.nan)
-        for i in prange(data.shape[0]):
-            for j in prange(data[i].shape[0]):
-                for k in prange(data[i].shape[0]):
-                    results[i][j][k] = np.linalg.norm(data[i][j] - data[i][k])
-
-        return results
-
     def _save_data_log(self, data_log: dict):
         out = pd.DataFrame(
             columns=[
                 "VIDEO",
                 "ANIMAL",
                 "BODY-PART",
                 "OUTLIER COUNT",
                 "OUTLIER RATIO (%)",
             ]
         )
         save_path = os.path.join(
-            self.logs_path, f"location_outliers_{self.datetime}.csv"
+            self.logs_path, f"movement_outliers_{self.datetime}.csv"
         )
         for video_name, video_data in data_log.items():
             for animal_name, animal_data in video_data.items():
                 for body_part_name, body_part_data in animal_data.items():
                     out.loc[len(out)] = [
                         video_name,
                         animal_name,
                         body_part_name,
                         body_part_data["outlier_cnt"],
                         body_part_data["outlier_ratio"],
                     ]
         write_df(df=out, file_type="csv", save_path=save_path)
         stdout_success(
-            msg=f"Location outlier log saved at {save_path}",
+            msg=f"Movement outlier log saved at {save_path}",
             source=self.__class__.__name__,
         )
 
     def run(self):
         data_log = {}
         if self.type == "animal":
             self.fix_settings_for_animal_input()
-
         for file_cnt, file_path in enumerate(self.data_files):
             video_timer, video_log = SimbaTimer(start=True), {}
             _, self.video_name, _ = get_fn_ext(file_path)
             print(
                 "Processing video {}. Video {}/{}...".format(
                     self.video_name, str(file_cnt + 1), str(len(self.data_files))
                 )
@@ -156,123 +145,103 @@
             self.data_df = read_df(file_path, self.file_type, check_multiindex=True)
             self.data_df = self.insert_column_headers_for_outlier_correction(
                 data_df=self.data_df, new_headers=self.bp_headers, filepath=file_path
             )
             self.results = deepcopy(self.data_df)
             self.data_df_combined = self.create_shifted_df(df=self.data_df)
             animal_movement_agg = {}
+            self.movements = pd.DataFrame()
             for animal_name, animal_bps in self.animal_bp_dict.items():
                 if animal_name in self.criterion_body_parts.keys():
+                    animal_bp_headers = np.array(
+                        [
+                            item
+                            for pair in zip(animal_bps["X_bps"], animal_bps["Y_bps"])
+                            for item in pair
+                        ]
+                    ).reshape(len(animal_bps["X_bps"]), 2)
                     animal_criterion_bps = self.criterion_body_parts[animal_name]
                     bp_1_headers = [
                         animal_criterion_bps[0] + "_x",
                         animal_criterion_bps[0] + "_y",
                     ]
                     bp_2_headers = [
                         animal_criterion_bps[1] + "_x",
                         animal_criterion_bps[1] + "_y",
                     ]
+                    print(self.data_df.columns)
                     distances = self.framewise_euclidean_distance(
                         location_1=self.data_df[bp_1_headers].values,
                         location_2=self.data_df[bp_2_headers].values,
                         px_per_mm=1,
                     )
                     if self.agg_method == "mean":
                         animal_movement_agg[animal_name] = np.mean(distances).astype(
                             int
                         )
                     if self.agg_method == "median":
                         animal_movement_agg[animal_name] = np.median(distances).astype(
                             int
                         )
+                    for bps in animal_bp_headers:
+                        bp_name = bps[0][:-2]
+                        shifted_bps = [bps[0] + "_shifted", bps[1] + "_shifted"]
+                        distances = self.framewise_euclidean_distance(
+                            location_1=self.data_df_combined[bps].values,
+                            location_2=self.data_df_combined[shifted_bps].values,
+                            px_per_mm=1,
+                        )
+                        self.movements[bp_name] = distances
 
             for animal_name, animal_bps in self.settings.items():
                 video_log[animal_name] = {}
-                animal_bp_headers = np.array(
-                    [
-                        item
-                        for pair in zip(
-                            self.animal_bp_dict[animal_name]["X_bps"],
-                            self.animal_bp_dict[animal_name]["Y_bps"],
-                        )
-                        for item in pair
-                    ]
-                )
-                animal_body_part_names = [
-                    x[:-2] for x in self.animal_bp_dict[animal_name]["X_bps"]
-                ]
-                animal_body_part_dict = {
-                    k: v
-                    for (v, k) in zip(
-                        animal_body_part_names, range(0, len(animal_body_part_names))
-                    )
-                }
-                animal_arr = self.data_df[animal_bp_headers].values.reshape(
-                    len(self.data_df), -1, 2
-                )
-                data = self.three_dim_cdist(data=animal_arr)
-                df = (
-                    pd.concat(
-                        [pd.DataFrame(arr) for arr in data], keys=np.arange(len(data))
-                    )
-                    .reset_index()
-                    .rename(columns={"level_0": "frame", "level_1": "body_part"})
-                )
-                df["body_part"] = df["body_part"].map(animal_body_part_dict)
-                above_criterion_dict = {}
                 for bp, criterion_multiplier in animal_bps.items():
                     if animal_name in animal_movement_agg.keys():
                         bp_criterion = (
                             animal_movement_agg[animal_name] * criterion_multiplier
                         )
-                        bp_df = df[df["body_part"] == bp]
-                        bp_df["counts_above_criterion"] = self.count_values_in_range(
-                            data=bp_df.drop(["frame", "body_part"], axis=1).values,
-                            ranges=np.array([[bp_criterion, np.inf]]),
+                        over_criterion_idx = list(
+                            self.movements.index[self.movements[bp] > bp_criterion]
                         )
-                        above_criterion_dict[bp] = list(
-                            bp_df["frame"][bp_df["counts_above_criterion"] > 1]
+                        video_log[animal_name][bp] = {
+                            "outlier_cnt": len(over_criterion_idx),
+                            "outlier_ratio": len(over_criterion_idx)
+                            / len(self.movements),
+                        }
+                        self.results.loc[over_criterion_idx, [bp + "_x", bp + "_y"]] = (
+                            np.nan
+                        )
+                        self.results[[bp + "_x", bp + "_y"]] = (
+                            self.results[[bp + "_x", bp + "_y"]]
+                            .ffill()
+                            .bfill()
+                            .astype(int)
                         )
-
-                for (
-                    bp,
-                    body_part_frames_above_criterion,
-                ) in above_criterion_dict.items():
-                    self.results.loc[
-                        body_part_frames_above_criterion, [f"{bp}_x", f"{bp}_y"]
-                    ] = np.nan
-                    self.results[[f"{bp}_x", f"{bp}_y"]] = (
-                        self.results[[f"{bp}_x", f"{bp}_y"]].ffill().bfill().astype(int)
-                    )
-                    video_log[animal_name][bp] = {
-                        "outlier_cnt": len(body_part_frames_above_criterion),
-                        "outlier_ratio": len(body_part_frames_above_criterion)
-                        / len(self.results),
-                    }
 
             df_save_path = os.path.join(
-                self.outlier_corrected_dir, self.video_name + f"{self.file_type}."
+                self.outlier_corrected_movement_dir,
+                self.video_name + f".{self.file_type}",
             )
             write_df(df=self.results, file_type=self.file_type, save_path=df_save_path)
             video_timer.stop_timer()
             stdout_success(
-                msg=f"Location outliers complete for video {self.video_name}.",
+                msg=f"Movement outliers complete for video {self.video_name}.",
                 elapsed_time=video_timer.elapsed_time_str,
                 source=self.__class__.__name__,
             )
             data_log[self.video_name] = video_log
-
         self._save_data_log(data_log=data_log)
         stdout_success(
-            msg=f"{len(self.data_files)} video(s) corrected for location outliers. Saved in {self.outlier_corrected_dir}",
+            msg=f"{len(self.data_files)} video(s) corrected for movement outliers. Saved in {self.outlier_corrected_movement_dir}",
             source=self.__class__.__name__,
         )
 
 
-# settings = {'Simon': 2.5} #
+#
+# settings = {'Simon': 2.5} #'JJ': 1.2
 # # settings = {'Simon': {'Ear_left_1': 1.1,
 # #                       'Ear_right_1': 5.1,
 # #                       'Nose_1': 2.1,
 # #                       'Center_1': 1.5,
 # #                       'Lat_left_1': 3.1,
 # #                       'Lat_right_1': 1.9,
 # #                       'Tail_base_1': 2.3},
@@ -281,19 +250,19 @@
 # #                       'Ear_right_2': 1.2,
 # #                       'Nose_2': 2,
 # #                       'Center_2': 4.1,
 # #                       'Lat_left_2': 9,
 # #                       'Lat_right_2': 1.2,
 # #                       'Tail_base_2': 1.6,
 # #                       'Tail_end_2': 2.2}}
-# criterion_body_parts = {'Simon': ['Nose_1', 'Tail_base_1'], } #'JJ': ['Nose_2', 'Tail_base_2']
-# test = OutlierCorrecterLocationAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
+# criterion_body_parts = {'Simon': ['Nose_1', 'Tail_base_1']} #'JJ': ['Nose_2', 'Tail_base_2']
+#
+#
+# test = OutlierCorrecterMovementAdvanced(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini',
 #                                         input_dir='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/csv/input_csv',
+#                                         criterion_body_parts=criterion_body_parts,
 #                                         type='animal',
 #                                         agg_method='mean',
-#                                         criterion_body_parts=criterion_body_parts,
 #                                         settings=settings)
 # test.run()
 
-
-# test = OutlierCorrecterLocation(config_path='/Users/simon/Desktop/envs/troubleshooting/two_black_animals_14bp/project_folder/project_config.ini')
-# test.correct_location_outliers()
+#
```

### Comparing `Simba-UW-tf-dev-1.90.4/simba/outlier_tools/outlier_corrector_location.py` & `Simba-UW-tf-dev-1.90.5/simba/outlier_tools/outlier_corrector_location.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/outlier_tools/skip_outlier_correction.py` & `Simba-UW-tf-dev-1.90.5/simba/outlier_tools/skip_outlier_correction.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/SimBA.py` & `Simba-UW-tf-dev-1.90.5/simba/SimBA.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/unsupervised/model_names.parquet` & `Simba-UW-tf-dev-1.90.5/simba/assets/unsupervised/model_names.parquet`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/unsupervised/features.csv` & `Simba-UW-tf-dev-1.90.5/simba/assets/unsupervised/features.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/down_arrow.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/down_arrow.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/intruder_shape.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/intruder_shape.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/feature_categories/shap_feature_categories.csv` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/feature_categories/shap_feature_categories.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_shape.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_shape.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_intruder_shape.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_intruder_shape.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/animal_distances.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/animal_distances.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/baseline_scale.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/baseline_scale.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/ubuntu.regular.ttf` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/ubuntu.regular.ttf`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/side_scale.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/side_scale.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/UbuntuMono-Regular.ttf` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/UbuntuMono-Regular.ttf`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/side_scale_5.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/side_scale_5.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/intruder_movement.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/intruder_movement.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_movement.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_movement.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/color_bar.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/color_bar.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/shap/resident_intruder_movement.jpg` & `Simba-UW-tf-dev-1.90.5/simba/assets/shap/resident_intruder_movement.jpg`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/assets/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/lookups/model_names.parquet` & `Simba-UW-tf-dev-1.90.5/simba/assets/lookups/model_names.parquet`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/lookups/feature_extraction_headers.csv` & `Simba-UW-tf-dev-1.90.5/simba/assets/lookups/feature_extraction_headers.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/lookups/critical_values_05.pickle` & `Simba-UW-tf-dev-1.90.5/simba/assets/lookups/critical_values_05.pickle`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/lookups/features.csv` & `Simba-UW-tf-dev-1.90.5/simba/assets/lookups/features.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/lookups/unsupervised_example_x.csv` & `Simba-UW-tf-dev-1.90.5/simba/assets/lookups/unsupervised_example_x.csv`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/stl/operant_tray.stl` & `Simba-UW-tf-dev-1.90.5/simba/assets/stl/operant_tray.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/stl/operant_lever.stl` & `Simba-UW-tf-dev-1.90.5/simba/assets/stl/operant_lever.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/stl/operant_walls.stl` & `Simba-UW-tf-dev-1.90.5/simba/assets/stl/operant_walls.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/stl/grid_floor.stl` & `Simba-UW-tf-dev-1.90.5/simba/assets/stl/grid_floor.stl`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/img/splash_2024.mp4` & `Simba-UW-tf-dev-1.90.5/simba/assets/img/splash_2024.mp4`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/img/bg_2024.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/img/bg_2024.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/img/about_me.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/img/about_me.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/img/splash.mp4` & `Simba-UW-tf-dev-1.90.5/simba/assets/img/splash.mp4`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/img/bg_2.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/img/bg_2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/img/splash.pptx` & `Simba-UW-tf-dev-1.90.5/simba/assets/img/splash.pptx`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/img/bg.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/img/bg.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/UbuntuMono-Regular.ttf` & `Simba-UW-tf-dev-1.90.5/simba/assets/UbuntuMono-Regular.ttf`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/factory.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/factory.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/cluster.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/cluster.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/load.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/load.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/gif.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/gif.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/pose.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/pose.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/features.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/features.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/.DS_Store` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/.DS_Store`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/settings.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/settings.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/stopwatch.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/stopwatch.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/link.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/link.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/dash_simba.css` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/dash_simba.css`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/documentation.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/documentation.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/fps.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/fps.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/dimensionality_reduction.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/dimensionality_reduction.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/roi.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/roi.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/simba_logo_2.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/simba_logo_2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/superimpose.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/superimpose.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/label.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/label.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/change.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/change.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/readthedocs_logo.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/readthedocs_logo.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/crop.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/crop.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/rotate.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/rotate.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/circle.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/circle.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/path.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/path.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/polygon.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/polygon.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/clip.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/clip.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/restart.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/restart.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/calipher.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/calipher.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/add_on.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/add_on.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/create.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/create.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/SimBA_logo.ico` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/SimBA_logo.ico`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/print.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/print.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/clf.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/clf.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/mosaic.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/mosaic.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/vertical.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/vertical.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/horizontal.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/horizontal.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat_icons/mixed_mosaic.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat_icons/mixed_mosaic.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/merge.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/merge.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/clean.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/clean.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/clf_2.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/clf_2.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/visualize.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/visualize.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/concat.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/concat.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/boris.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/boris.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/frames.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/frames.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/video.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/video.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/sample.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/sample.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/metrics.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/metrics.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/grey.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/grey.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/exit.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/exit.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/outlier.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/outlier.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/clahe.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/clahe.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/trash.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/trash.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/about.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/about.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/convert.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/convert.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/SimBA_logo.icns` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/SimBA_logo.icns`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/reorganize.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/reorganize.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/browse.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/browse.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/SimBA_logo.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/SimBA_logo.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/ethovision.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/ethovision.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/icons/close.png` & `Simba-UW-tf-dev-1.90.5/simba/assets/icons/close.png`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/dash_simba_base.css` & `Simba-UW-tf-dev-1.90.5/simba/assets/dash_simba_base.css`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/simba/assets/TheGoldenLab.PNG` & `Simba-UW-tf-dev-1.90.5/simba/assets/TheGoldenLab.PNG`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/PKG-INFO` & `Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Simba-UW-tf-dev
-Version: 1.90.4
+Version: 1.90.5
 Summary: Toolkit for computer classification of behaviors in experimental animals
 Home-page: https://github.com/sgoldenlab/simba
 Author: Simon Nilsson, Jia Jie Choong, Sophia Hwang
 Author-email: sronilsson@gmail.com
 License: GNU Lesser General Public License v3 (LGPLv3)
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

### Comparing `Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/SOURCES.txt` & `Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/SOURCES.txt`

 * *Files 2% similar despite different names*

```diff
@@ -247,15 +247,15 @@
 simba/plotting/clf_validator_mp.py
 simba/plotting/data_plotter.py
 simba/plotting/directing_animals_to_bodypart_visualizer.py
 simba/plotting/directing_animals_visualizer.py
 simba/plotting/directing_animals_visualizer_mp.py
 simba/plotting/distance_plotter.py
 simba/plotting/distance_plotter_mp.py
-simba/plotting/ez_lineplot.py
+simba/plotting/ez_path_plot.py
 simba/plotting/frame_mergerer_ffmpeg.py
 simba/plotting/gantt_creator.py
 simba/plotting/gantt_creator_mp.py
 simba/plotting/geometry_plotter.py
 simba/plotting/heat_mapper_clf.py
 simba/plotting/heat_mapper_clf_mp.py
 simba/plotting/heat_mapper_location.py
@@ -318,43 +318,47 @@
 simba/roi_tools/ROI_clf_calculator.py
 simba/roi_tools/ROI_define.py
 simba/roi_tools/ROI_directing_analyzer.py
 simba/roi_tools/ROI_feature_analyzer.py
 simba/roi_tools/ROI_image.py
 simba/roi_tools/ROI_menus.py
 simba/roi_tools/ROI_move_shape.py
-simba/roi_tools/ROI_movement_analyzer.py
 simba/roi_tools/ROI_multiply.py
 simba/roi_tools/ROI_reset.py
 simba/roi_tools/ROI_size_calculations.py
 simba/roi_tools/ROI_size_standardizer.py
 simba/roi_tools/ROI_time_bin_calculator.py
 simba/roi_tools/ROI_zoom.py
 simba/roi_tools/__init__.py
 simba/sandbox/.DS_Store
 simba/sandbox/AmberFeatureExtractor.py.zip
+simba/sandbox/ROI_analyzer.py
+simba/sandbox/ROI_plotter.py
+simba/sandbox/ROI_plotter_mp.py
 simba/sandbox/__init__.py
 simba/sandbox/abod.py
 simba/sandbox/add_body_part.py
 simba/sandbox/add_body_part.py.zip
 simba/sandbox/add_probability_cnt_features.py
 simba/sandbox/adjusted_rand_score.py
 simba/sandbox/amber_featurizer.py
 simba/sandbox/amber_tests.py
 simba/sandbox/batch_video_to_greyscale.py
 simba/sandbox/berger_parker.py
 simba/sandbox/biweight_midcorrelation.py
 simba/sandbox/bouts_df
+simba/sandbox/brillouins_index.py
 simba/sandbox/calc_N_degree_direction_switches.py
 simba/sandbox/calinski_harabasz.py
 simba/sandbox/clip_multiple_videos_by_frame_numbers.py
 simba/sandbox/clip_videos_by_frm.py
 simba/sandbox/cochran_q.py
 simba/sandbox/cohens_kappa.py
 simba/sandbox/colinear_features.py
+simba/sandbox/concordance_ratio.py
 simba/sandbox/convex_hull_3_scratch_3.py
 simba/sandbox/convex_hull_scratch_1.py
 simba/sandbox/convex_hull_scratch_2.py
 simba/sandbox/count_values_in_range.py
 simba/sandbox/cronbach_alpha.py
 simba/sandbox/crop_circles_pop_up.py
 simba/sandbox/crop_single_polygon.py
@@ -365,14 +369,15 @@
 simba/sandbox/distance_velocity.py
 simba/sandbox/distances.py
 simba/sandbox/doctests.py
 simba/sandbox/dprime.py
 simba/sandbox/dunn_index.py
 simba/sandbox/egocentrical_aligner.py
 simba/sandbox/elliptic_envelope.py
+simba/sandbox/ez_path_plot.py
 simba/sandbox/fish_feature_extractor_2022.py
 simba/sandbox/fish_feature_extractor_2023_version_2.py
 simba/sandbox/fish_feature_extractor_2023_version_3.py
 simba/sandbox/fish_feature_extractor_2023_version_4.py
 simba/sandbox/fish_feature_extractor_2023_version_5.py
 simba/sandbox/fix_clahe.py
 simba/sandbox/geometry_ex.py
@@ -380,14 +385,15 @@
 simba/sandbox/graph_3d_plotter.py
 simba/sandbox/graph_creator.py
 simba/sandbox/grubbs_test.py
 simba/sandbox/hartley_fmax.py
 simba/sandbox/hausdorff.py
 simba/sandbox/heading.py
 simba/sandbox/horizontal_videos_concat.py
+simba/sandbox/img_stack_to_bw.py
 simba/sandbox/isolation_forest.py
 simba/sandbox/joint_plotter.py
 simba/sandbox/lcs.py
 simba/sandbox/line_locate_point.py
 simba/sandbox/line_plot.py
 simba/sandbox/line_plot_plotly.py
 simba/sandbox/linear_fretchet.py
@@ -399,14 +405,15 @@
 simba/sandbox/mcnamar.py
 simba/sandbox/menhinicks_index.py
 simba/sandbox/mosaic.py
 simba/sandbox/multiframe_is_shape_covered.py
 simba/sandbox/multifrm_to_points.py
 simba/sandbox/mutual_exclusive.py
 simba/sandbox/outliers_tietjen.py
+simba/sandbox/path_plots.py
 simba/sandbox/paths.py
 simba/sandbox/pct_counts_in_top_N.py
 simba/sandbox/peaks.py
 simba/sandbox/piotr_120324 2.py.zip
 simba/sandbox/piotr_120324 3.py.zip
 simba/sandbox/piotr_120324 4.py.zip
 simba/sandbox/piotr_120324.py
@@ -414,24 +421,27 @@
 simba/sandbox/plotly_gantt.py
 simba/sandbox/read_in_mp.py
 simba/sandbox/redis.py
 simba/sandbox/roi_definition_csvs_to_h5.py
 simba/sandbox/roi_definition_csvs_to_h5.py.zip
 simba/sandbox/roi_feature_visualizer_example.py
 simba/sandbox/roi_feature_visualizer_example.py.zip
+simba/sandbox/rotate image.py
 simba/sandbox/runs_test.py
+simba/sandbox/segment_image_horizontal.py
 simba/sandbox/sequential_lag_analysis.py
 simba/sandbox/shannon_diversity_index.py
 simba/sandbox/siegel_tukey.py
 simba/sandbox/silhouette_score.py
 simba/sandbox/simpson_diversity_index.py
 simba/sandbox/slide_circ_mean.py
 simba/sandbox/sliding_autoc.py
 simba/sandbox/sliding_crosscorrelation.py
 simba/sandbox/sliding_displacement.py
+simba/sandbox/sorensen_dice_coefficient.py
 simba/sandbox/spontaneous_alternation_calculator.py
 simba/sandbox/spontaneuous_alternation_plotter.py
 simba/sandbox/spontanous_alternations.py
 simba/sandbox/statistics_ex.py
 simba/sandbox/termite_rois.csv
 simba/sandbox/time_stamp_calculator.py
 simba/sandbox/total_variation_distance.py
@@ -441,14 +451,15 @@
 simba/sandbox/unsupervised_lof.py
 simba/sandbox/unsupervised_outliers.py
 simba/sandbox/velocity_aggregator.py
 simba/sandbox/vertical_video_concatenator.py
 simba/sandbox/video_color.py
 simba/sandbox/video_rotator.py
 simba/sandbox/video_rotator_mp.py
+simba/sandbox/violin.py
 simba/sandbox/wald_wolfowitz.py
 simba/sandbox/wilcoxon.py
 simba/third_party_label_appenders/.DS_Store
 simba/third_party_label_appenders/BENTO_appender.py
 simba/third_party_label_appenders/BORIS_appender.py
 simba/third_party_label_appenders/__init__.py
 simba/third_party_label_appenders/boris_source_cleaner.py
@@ -556,15 +567,14 @@
 simba/utils/__init__.py
 simba/utils/checks.py
 simba/utils/config_creator.py
 simba/utils/custom_feature_extractor.py
 simba/utils/data.py
 simba/utils/enums.py
 simba/utils/errors.py
-simba/utils/keyboard_listener.py
 simba/utils/lookups.py
 simba/utils/printing.py
 simba/utils/read_write.py
 simba/utils/warnings.py
 simba/utils/cli/__init__.py
 simba/utils/cli/cli_tools.py
 simba/video_processors/.DS_Store
```

### Comparing `Simba-UW-tf-dev-1.90.4/Simba_UW_tf_dev.egg-info/requires.txt` & `Simba-UW-tf-dev-1.90.5/Simba_UW_tf_dev.egg-info/requires.txt`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/LICENSE` & `Simba-UW-tf-dev-1.90.5/LICENSE`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_data_processors.py` & `Simba-UW-tf-dev-1.90.5/tests/test_data_processors.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_circlular_stats.py` & `Simba-UW-tf-dev-1.90.5/tests/test_circlular_stats.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_stats.py` & `Simba-UW-tf-dev-1.90.5/tests/test_stats.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_train_model_mixin.py` & `Simba-UW-tf-dev-1.90.5/tests/test_train_model_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_feature_extraction_mixin.py` & `Simba-UW-tf-dev-1.90.5/tests/test_feature_extraction_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_utils_data.py` & `Simba-UW-tf-dev-1.90.5/tests/test_utils_data.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_config_reader_mixin.py` & `Simba-UW-tf-dev-1.90.5/tests/test_config_reader_mixin.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_outlier_correctors.py` & `Simba-UW-tf-dev-1.90.5/tests/test_outlier_correctors.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_visualize_directing_animals.py` & `Simba-UW-tf-dev-1.90.5/tests/test_visualize_directing_animals.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_featurizers.py` & `Simba-UW-tf-dev-1.90.5/tests/test_featurizers.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_video_processors.py` & `Simba-UW-tf-dev-1.90.5/tests/test_video_processors.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_thirdparty_appenders.py` & `Simba-UW-tf-dev-1.90.5/tests/test_thirdparty_appenders.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_validation_clips.py` & `Simba-UW-tf-dev-1.90.5/tests/test_validation_clips.py`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/tests/test_roi_tools.py` & `Simba-UW-tf-dev-1.90.5/tests/test_roi_tools.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,14 +1,13 @@
 import pytest
 import numpy as np
 from simba.roi_tools.ROI_analyzer import ROIAnalyzer
 from simba.roi_tools.ROI_clf_calculator import ROIClfCalculator
 from simba.roi_tools.ROI_directing_analyzer import DirectingROIAnalyzer
 from simba.roi_tools.ROI_feature_analyzer import ROIFeatureCreator
-from simba.roi_tools.ROI_movement_analyzer import ROIMovementAnalyzer
 from simba.roi_tools.ROI_size_calculations import rectangle_size_calc, circle_size_calc, polygon_size_calc
 from simba.roi_tools.ROI_time_bin_calculator import ROITimebinCalculator
 
 
 @pytest.fixture(params=['tests/data/test_projects/two_c57/project_folder/project_config.ini'])
 def config_path_args(request):
     return request
@@ -16,21 +15,21 @@
 @pytest.fixture(params=['tests/data/test_projects/two_c57/project_folder/project_config.ini',
                         'tests/data/test_projects/mouse_open_field/project_folder/project_config.ini',
                         'tests/data/test_projects/zebrafish/project_folder/project_config.ini'])
 def all_config_path_args(request):
     return request
 
 
-@pytest.mark.parametrize("calculate_distances", [True, False])
-def test_roi_analyser(all_config_path_args, calculate_distances):
-    roi_analyzer = ROIAnalyzer(ini_path=all_config_path_args.param,
-                               data_path="outlier_corrected_movement_location",
-                               calculate_distances=calculate_distances)
-    roi_analyzer.run()
-    roi_analyzer.save()
+# @pytest.mark.parametrize("calculate_distances", [True, False])
+# def test_roi_analyser(all_config_path_args, calculate_distances):
+#     roi_analyzer = ROIAnalyzer(config_path=all_config_path_args.param,
+#                                data_path=None,
+#                                calculate_distances=calculate_distances)
+#     roi_analyzer.run()
+#     roi_analyzer.save()
 
 def test_roi_clf_calculator(config_path_args):
     clf_ROI_analyzer = ROIClfCalculator(config_ini=config_path_args.param)
     clf_ROI_analyzer.run(behavior_list=['Attack', 'Sniffing'], ROI_dict_lists={'Rectangle': ['Rectangle_1']}, body_part_list=['Nose_1'], measurements=['Total time by ROI (s)', 'Started bouts by ROI (count)', 'Ended bouts by ROI (count)'])
 
 # @pytest.mark.parametrize("config_path, settings", [('tests/data/test_projects/two_c57/project_folder/project_config.ini', {'body_parts': {'Simon': 'Ear_left_1', 'JJ': 'Ear_left_2'}, 'threshold': 0.4})])
 # def test_roi_directing_analyzer(config_path, settings):
@@ -38,16 +37,16 @@
 #     directing_analyzer.run()
 
 # @pytest.mark.parametrize("config_path, settings", [('tests/data/test_projects/two_c57/project_folder/project_config.ini', {'body_parts': {'Simon': 'Ear_left_1', 'JJ': 'Ear_left_2'}, 'threshold': 0.4})])
 # def test_roi_feature_creator(config_path, settings):
 #     roi_featurizer = ROIFeatureCreator(config_path=config_path, settings=settings)
 #     roi_featurizer.run()
 
-def test_roi_movement_analyzer(all_config_path_args):
-    _ = ROIMovementAnalyzer(config_path=all_config_path_args.param)
+# def test_roi_movement_analyzer(all_config_path_args):
+#     _ = ROIMovementAnalyzer(config_path=all_config_path_args.param)
 
 @pytest.mark.parametrize("rectangle_dict, px_mm, expected_area", [({'height': 500, 'width': 500}, 10, 25), ({'height': 500, 'width': 500}, 5, 100)])
 def test_rectangle_size_calc(rectangle_dict, px_mm, expected_area):
     results = rectangle_size_calc(rectangle_dict=rectangle_dict, px_mm=px_mm)
     assert int(results['area_cm']) == int(expected_area)
 
 @pytest.mark.parametrize("circle_dict, px_mm, expected_area", [({'radius': 100}, 5, 12.57)])
```

### Comparing `Simba-UW-tf-dev-1.90.4/README.md` & `Simba-UW-tf-dev-1.90.5/README.md`

 * *Files identical despite different names*

### Comparing `Simba-UW-tf-dev-1.90.4/setup.py` & `Simba-UW-tf-dev-1.90.5/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -13,15 +13,15 @@
 with open("requirements.txt", "r") as f:
     requirements = f.read().splitlines()
 
 exclusion_patterns = ["pose_configurations_archive"]
 
 setuptools.setup(
     name="Simba-UW-tf-dev",
-    version="1.90.4",
+    version="1.90.5",
     author="Simon Nilsson, Jia Jie Choong, Sophia Hwang",
     author_email="sronilsson@gmail.com",
     description="Toolkit for computer classification of behaviors in experimental animals",
     long_description=long_description,
     long_description_content_type="text/markdown",
     url="https://github.com/sgoldenlab/simba",
     install_requires=requirements,
```

